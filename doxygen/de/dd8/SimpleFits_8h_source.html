<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>SimpleFits.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_fe4ed3495e8c1bfd3f631e23a0a133d5.html">lardata</a></li><li class="navelem"><a class="el" href="../../dir_274a115a2bf96921f748c34772980eec.html">lardata</a></li><li class="navelem"><a class="el" href="../../dir_9aadffe628da9b8079d0bee9a06dcd06.html">Utilities</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimpleFits.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../de/dd8/SimpleFits_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file    SimpleFits.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief   Classes performing simple fits</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author  Gianluca Petrillo (petrillo@fnal.gov)</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * @date    March 31st, 2015</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * Currently includes:</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  - LinearFit</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  -</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifndef SIMPLEFITS_H</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define SIMPLEFITS_H 1</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// C/C++ standard libraries</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span> <span class="comment">// std::sqrt()</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span> <span class="comment">// std::begin(), std::end()</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::for_each()</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span> <span class="comment">// std::enable_if&lt;&gt;, std::is_const&lt;&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span> <span class="comment">// std::range_error</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;ostream&gt;</span> <span class="comment">// std::endl</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d87/StatCollector_8h.html">lardataalg/Utilities/StatCollector.h</a>&quot;</span> <span class="comment">// lar::util::identity</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d0e/FastMatrixMathHelper_8h.html">lardata/Utilities/FastMatrixMathHelper.h</a>&quot;</span> <span class="comment">// lar::util::details::FastMatrixOperations</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span>lar {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keyword">namespace </span>util {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">namespace </span>details {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">      /// Class providing data collection for the simple polynomial fitters</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">   37</a></span>&#160;      <span class="keyword">class </span><a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">FitDataCollector</a> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">         * @details</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">         * The &quot;extractor&quot; is just a C++ trick to replace a statement like:</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">         *     (N == 0)? weight.Weights(): sums.template SumN&lt;N&gt;()</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">         * where N is a constexpr number. The problem is that SumN&lt;0&gt; is not</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">         * valid (in our case, it raises a static assertion). The analysis of</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">         * the full statement shows that it would not be a problem, since the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">         * compiler could remove the ternary operator since it always knows</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">         * whether N is 0 or not. Matter of fact, the compiler can also choose</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">         * to be dumb and compile the whole thing, including a SumN&lt;0&gt;.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">         * The trick is in the form of a class that gets specialized for N = 0.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">         * A long list of limitations in C++ (up to 2014 at least) forces the</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">         * implementation in a struct.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Power, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N&gt;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">   57</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">SumExtractor</a> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          <span class="keyword">static</span> T <a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html#a72ddd47480f6b3d639ef0c2eadedec5b">Sum</a></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html#a72ddd47480f6b3d639ef0c2eadedec5b">   59</a></span>&#160;            (<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html">WeightTracker&lt;T&gt;</a> <span class="keyword">const</span>&amp;, <a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">DataTracker&lt;Power, T&gt;</a> <span class="keyword">const</span>&amp; sums)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            { <span class="keywordflow">return</span> sums.template SumN&lt;N&gt;(); }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }; <span class="comment">// SumExtractor</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">// specialization</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Power&gt;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d9/d08/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor_3_01Power_00_010U_01_4.html">   65</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">SumExtractor</a>&lt;Power, 0U&gt; {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="keyword">static</span> T <a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html#a72ddd47480f6b3d639ef0c2eadedec5b">Sum</a></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d9/d08/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor_3_01Power_00_010U_01_4.html#adea947cc1d97ebfd4d2b292334feee9d">   67</a></span>&#160;            (<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html">WeightTracker&lt;T&gt;</a> <span class="keyword">const</span>&amp; weight, <a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">DataTracker&lt;Power, T&gt;</a> <span class="keyword">const</span>&amp;)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            { <span class="keywordflow">return</span> weight.<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#ac38af994023dd3e09ec4df16c83eba09">Weights</a>(); }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }; <span class="comment">// SumExtractor&lt;&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">        /// Degree of the fit</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a1cb256534b87f3ef231340196b8ea420">   73</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a1cb256534b87f3ef231340196b8ea420">Degree</a> = D;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a8dbfa4229999e183dde5bd4533b301e1">   74</a></span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a8dbfa4229999e183dde5bd4533b301e1">NParams</a> = <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a1cb256534b87f3ef231340196b8ea420">Degree</a> + 1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">   76</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> = T; <span class="comment">///&lt; type of the data</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">        /// type of measurement without uncertainty</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0c3d305f74b0220c9e366ab52519fd1a">   79</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0c3d305f74b0220c9e366ab52519fd1a">Measurement_t</a> = std::tuple&lt;Data_t, Data_t&gt;;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">        /// type of measurement with uncertainty</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a11d623ec40d4c92ed9c00d41bac610a7">   82</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a11d623ec40d4c92ed9c00d41bac610a7">MeasurementAndUncertainty_t</a> = std::tuple&lt;Data_t, Data_t, Data_t&gt;;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">// default constructor, destructor and all the rest</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">        /// @name Add elements</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">         * @brief Adds one entry with specified x, y and uncertainty</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">         * @param x value of x</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">         * @param y value of y</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">         * @param sy value of uncertainty on y (1 by default)</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">         * @return whether the point was added</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">         * If the uncertainty is exactly 0, the entry is ignored and not added.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a638cc4667a3926bdfab2ea3679ba95b8">x</a>, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a4a449166ad96fcd28c44ce5182a7c0b2">y</a>, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> sy = <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a>(1.0));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">         * @brief Adds one entry with specified x, y and uncertainty</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">         * @param value the ( x ; y ) pair</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">         * @param sy value of uncertainty on y (1 by default)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">         * @return whether the point was added</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">         * If the uncertainty is exactly 0, the entry is ignored and not added.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0216904d6589fe893c7b4feb7dcb7a01">  108</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0216904d6589fe893c7b4feb7dcb7a01">add</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0c3d305f74b0220c9e366ab52519fd1a">Measurement_t</a> <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a>, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> sy = <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a>(1.0))</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(std::get&lt;0&gt;(value), std::get&lt;1&gt;(value), sy); }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">         * @brief Adds one entry with specified x, y and uncertainty</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">         * @param value ( x ; y ; sy ), sy being the uncertainty on y</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">         * @return whether the point was added</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">         * If the uncertainty is exactly 0, the entry is ignored and not added.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a5ecf0a1ebde715c54df255f3ba48fb58">  118</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a5ecf0a1ebde715c54df255f3ba48fb58">add</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a11d623ec40d4c92ed9c00d41bac610a7">MeasurementAndUncertainty_t</a> value)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;              <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(std::get&lt;0&gt;(value), std::get&lt;1&gt;(value), std::get&lt;2&gt;(value));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">         * @brief Adds measurements from a sequence, with no uncertainty</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">         * @tparam Iter forward iterator to the pairs to be added</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">         * @param begin iterator pointing to the first element to be added</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">         * @param end iterator pointing after the last element to be added</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">         * The value pointed by the iterator must be a tuple with types compatible</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">         * with Measurement_t.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">  135</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          {  <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(begin, end, <a class="code" href="../../dd/d5e/structlar_1_1util_1_1identity.html">identity</a>()); }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">         * @brief Adds measurements from a sequence with no uncertainty</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">         * @tparam Iter forward iterator to the elements to be added</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">         * @tparam Pred a predicate to extract the element from iterator value</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">         * @param begin iterator pointing to the first element to be added</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">         * @param end iterator pointing after the last element to be added</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">         * @param extractor the predicate extracting the value to be inserted</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">         * The predicate is required to react to a call like with:</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">         *     Measurement_t Pred::operator() (typename Iter::value_type);</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, Pred extractor);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">         * @brief Adds all measurements from a container, with no uncertainty</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">         * @tparam Cont type of container of the elements to be added</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">         * @tparam Pred a predicate to extract the element from iterator value</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">         * @param cont container of the elements to be added</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">         * @param extractor the predicate extracting the value to be inserted</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">         * The predicate is required to react to a call like with:</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">         *     Measurement_t Pred::operator() (typename Cont::value_type);</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">         * The container must support the range-based for loop syntax, that is</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">         * is must have std::begin&lt;Cont&gt;() and std::end&lt;Cont&gt;() defined.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a44950067dbbf37e1522454c0b3fa928f">  169</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a44950067dbbf37e1522454c0b3fa928f">add_without_uncertainty</a>(Cont cont, Pred extractor)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          { <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont), extractor); }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">         * @brief Adds all measurements from a container, with no uncertainty</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">         * @tparam Cont type of container of the elements to be added</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">         * @param cont container of the elements to be added</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">         * The container must support the range-based for loop syntax, that is</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">         * is must have std::begin&lt;Cont&gt;() and std::end&lt;Cont&gt;() defined.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">         * The value in the container must be convertible to the Measurement_t</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">         * type.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad27b630119749ab8829fa0f164aef283">  183</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad27b630119749ab8829fa0f164aef283">add_without_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          { <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont)); }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">         * @brief Adds measurements with uncertainties from a sequence</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">         * @tparam VIter forward iterator to the elements to be added</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">         * @tparam UIter forward iterator to the uncertainties</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">         * @tparam VPred predicate to extract the measurement from iterator value</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">         * @tparam UPred predicate to extract the uncertainty from iterator value</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">         * @param begin_value iterator to the first measurement to be added</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">         * @param end_value iterator after the last measurement to be added</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">         * @param begin_uncertainty iterator to the uncertainty of first measurement</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">         * @param value_extractor predicate extracting the measurement to be inserted</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">         * @param uncertainty_extractor predicate extracting the uncertainty</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">         * @return number of points added</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">         * Each element is added with the uncertainty pointed by the matching</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">         * element in the list pointed by begin_weight: the @f$ y @f$ measurement</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">         * of `*(begin_value)` will have uncertainty `*(begin_uncertainty)`, the</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">         * next measurement `*(begin_value + 1)` will have uncertainty</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">         * `*(begin_uncertainty + 1)`, etc.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">         * The predicates are required to react to a call like with:</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">         *     Measurement_t VPred::operator() (typename VIter::value_type);</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">         *     Data_t UPred::operator() (typename UIter::value_type);</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">         * Points with zero or infinite uncertainty are ignored and not added.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keyword">typename</span> VIter, <span class="keyword">typename</span> UIter,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred = <a class="code" href="../../dd/d5e/structlar_1_1util_1_1identity.html">identity</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          &gt;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          VIter begin_value, VIter end_value,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          UIter begin_uncertainty,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          VPred value_extractor,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          UPred uncertainty_extractor = UPred()</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          );</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">         * @brief Adds measurements with uncertainties from a sequence</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">         * @tparam Iter forward iterator to MeasurementAndUncertainty_t to be added</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">         * @param begin iterator pointing to the first measurement to be added</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">         * @param end iterator pointing after the last measurement to be added</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">         * @return number of points added</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">         * The value pointed by the iterator must be a MeasurementAndUncertainty_t</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">         * or something with elements convertible to its own (Data_t triplet).</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">         * For more complicate structures, use the version with two predicates</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">         * (using the uncertainty iterator the same as the measurement iterator).</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">         * Points with zero or infinite uncertainty are ignored and not added.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">         * @brief Adds measurements with uncertainties from a container</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">         * @tparam Cont type of container of MeasurementAndUncertainty_t elements</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">         * @param cont container of MeasurementAndUncertainty_t to be added</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">         * @return number of points added</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">         * The values in the container must be tuples with each element</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">         * convertible to Data_t.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">         * Points with zero or infinite uncertainty are ignored and not added.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad91db52e3c42b241530d6b7017f3f1d5">  254</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad91db52e3c42b241530d6b7017f3f1d5">add_with_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont)); }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">        ///@}</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">        /// Clears all the statistics</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9bc3d800d3e435afbcf66d0ff66f6adc">clear</a>();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        /// @name Statistic retrieval</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">        /// Returns the number of entries added</span></div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3d0f30878e869b34592a564d50118efb">  266</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3d0f30878e869b34592a564d50118efb">N</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">s2</a>.<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#a0ea887fc54de99e26df4acd9365389ad">N</a>(); }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">         * @brief Returns an average of the uncertainties</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">         * @return the uncertainty average</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">         * @throws std::range_error if no entry was added</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">         * The average is the square root of the harmonic average of the variances</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">         * (that is, the errors squared):</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">         * @f$ \bar{s}^{-2} = \frac{1}{N} \sum_{i=1}^{N} s_{y}^{-2} @f$</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3954611eb63affe1913f53ce3671eaeb">  277</a></span>&#160;        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3954611eb63affe1913f53ce3671eaeb">AverageUncertainty</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3ffc00b73ada60025f8593a7553477e4">WeightToUncertainty</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">s2</a>.<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#a21cf0e4be6cfbf1fac2b2a5650f5500c">AverageWeight</a>()); }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">        /// Returns the square of the specified value</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt;</div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#abcee99c58b01642177b6c7a5a0c88eb2">  283</a></span>&#160;        <span class="keyword">static</span> constexpr <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#abcee99c58b01642177b6c7a5a0c88eb2">sqr</a>(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a> <span class="keyword">const</span>&amp; v) { <span class="keywordflow">return</span> v*v; }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">        /// Returns the weighted sum of x^n</span></div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9d78d4ffd495c6c3acd7ed6b57eed8c8">  287</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9d78d4ffd495c6c3acd7ed6b57eed8c8">XN</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> (n == 0)? <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">s2</a>.<a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#ac38af994023dd3e09ec4df16c83eba09">Weights</a>(): x.Sum(n); }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">        /// Returns the weighted sum of x^n y</span></div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad9d2dd0bd8aa5f7cfc461b4be05b0b61">  291</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad9d2dd0bd8aa5f7cfc461b4be05b0b61">XNY</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> (n == 0)? y.Weights(): <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a123689f5219e4dfa8b382d57a60d95c0">xy</a>.<a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html#abc738b4b828c01db8821c0c5e4653b05">Sum</a>(n); }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">        /// Returns the weighted sum of x^N</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a28bf5ae226ecb32f9d77e8ff3122c8b0">  297</a></span>&#160;        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a28bf5ae226ecb32f9d77e8ff3122c8b0">XN</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">SumExtractor&lt;decltype(x)::Power, N&gt;::Sum</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">s2</a>, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a638cc4667a3926bdfab2ea3679ba95b8">x</a>); }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">        /// Returns the weighted sum of x^N y</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#aa47c53891635ba0c368f25e097be62c6">  302</a></span>&#160;        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#aa47c53891635ba0c368f25e097be62c6">XNY</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">SumExtractor&lt;decltype(xy)::Power, N&gt;::Sum</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a4a449166ad96fcd28c44ce5182a7c0b2">y</a>, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a123689f5219e4dfa8b382d57a60d95c0">xy</a>); }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">        /// Returns the weighted sum of y^2</span></div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a67a9ecb3326bf44dd204c1a6a7dad7af">  307</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a67a9ecb3326bf44dd204c1a6a7dad7af">Y2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a503408a5316325f66b0a2b35243a61b4">y2</a>.template SumN&lt;1&gt;(); }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">        /// @}</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">        /// Prints the statistics into a stream</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Stream&gt;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9b55ce81a1f76de70228e0298ae54e85">Print</a>(<a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#a9cafae22b6225844ee0cdf5ea57176ff">Stream</a>&amp; out) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">        /// Transforms an uncertainty into a weight (@f$ s^{-2} @f$)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a039e303e0f690f7fffd3f472a267e468">  317</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a039e303e0f690f7fffd3f472a267e468">UncertaintyToWeight</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a>(1.)/<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#abcee99c58b01642177b6c7a5a0c88eb2">sqr</a>(s); }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">        /// Transforms a weight back to an uncertainty (@f$ s^{-1/2} @f$)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3ffc00b73ada60025f8593a7553477e4">  321</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3ffc00b73ada60025f8593a7553477e4">WeightToUncertainty</a>(<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a>(1.)/std::sqrt(w); }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">  327</a></span>&#160;        <a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html">WeightTracker&lt;Data_t&gt;</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">s2</a>;        <span class="comment">///&lt; accumulator for uncertainty</span></div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a638cc4667a3926bdfab2ea3679ba95b8">  328</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">DataTracker&lt;Degree*2, Data_t&gt;</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a638cc4667a3926bdfab2ea3679ba95b8">x</a>; <span class="comment">///&lt; accumulator for variable x^k</span></div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a4a449166ad96fcd28c44ce5182a7c0b2">  329</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html">WeightTracker&lt;Data_t&gt;</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a4a449166ad96fcd28c44ce5182a7c0b2">y</a>;         <span class="comment">///&lt; accumulator for y</span></div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a503408a5316325f66b0a2b35243a61b4">  330</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">DataTracker&lt;1, Data_t&gt;</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a503408a5316325f66b0a2b35243a61b4">y2</a>;       <span class="comment">///&lt; accumulator for y2</span></div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a123689f5219e4dfa8b382d57a60d95c0">  331</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">DataTracker&lt;Degree, Data_t&gt;</a> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a123689f5219e4dfa8b382d57a60d95c0">xy</a>;  <span class="comment">///&lt; accumulator for variable xy</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      }; <span class="comment">// class FitDataCollector&lt;&gt;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keyword">inline</span> std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="../../d4/d45/namespacelar_1_1util_1_1details.html#a9ed0cdc2fa7a41912676bcceb59d966b">  338</a></span>&#160;        (std::ostream&amp; out, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">FitDataCollector&lt;T, D&gt;</a> <span class="keyword">const</span>&amp; stats)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        { stats.Print(out); <span class="keywordflow">return</span> out; }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">      /// Base class providing data collection for the simple polynomial fitters</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">  344</a></span>&#160;      <span class="keyword">class </span><a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">SimplePolyFitterDataBase</a> {</div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac79cc8fa7c717be49cf2dcac2498b7db">  345</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">Collector_t</a> = <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">FitDataCollector&lt;T, D&gt;</a>; <span class="comment">///&lt; class storing input</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">        /// Degree of the fit</span></div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a45d61916db41f358569ca76d77a09501">  349</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a45d61916db41f358569ca76d77a09501">Degree</a> = <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a1cb256534b87f3ef231340196b8ea420">Collector_t::Degree</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">  351</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Collector_t::Data_t</a>; <span class="comment">///&lt; type of the data</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">        /// type of measurement without uncertainty</span></div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">  354</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">Measurement_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0c3d305f74b0220c9e366ab52519fd1a">Collector_t::Measurement_t</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">        /// type of measurement with uncertainty</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">MeasurementAndUncertainty_t</a></div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">  358</a></span>&#160;          = <span class="keyword">typename</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a11d623ec40d4c92ed9c00d41bac610a7">Collector_t::MeasurementAndUncertainty_t</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// default constructor, destructor and all the rest</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">        /// @name Add elements</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">        /// @see FitDataCollector</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa856c76df4b43666b625b4e2b9e351f5">  366</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa856c76df4b43666b625b4e2b9e351f5">add</a>(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> x, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> y, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> sy = <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(1.0))</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(x, y, sy); }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4536c7581f4576bf9f02dbf81739414a">  369</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4536c7581f4576bf9f02dbf81739414a">add</a>(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">Measurement_t</a> value, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> sy = <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(1.0))</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(value, sy); }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af425a07c655332d711b5ebbb31b1c456">  372</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af425a07c655332d711b5ebbb31b1c456">add</a>(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">MeasurementAndUncertainty_t</a> value)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">add</a>(value); }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac610ac111a4363cc4d363574092c5b5b">  377</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac610ac111a4363cc4d363574092c5b5b">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          { <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(begin, end); }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a430de9ce64e6a16b75a447cfb21c68fd">  381</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a430de9ce64e6a16b75a447cfb21c68fd">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, Pred extractor)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          { <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(begin, end, extractor); }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad48b203783a6c80cdca6c4f8dd44e549">  385</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad48b203783a6c80cdca6c4f8dd44e549">add_without_uncertainty</a>(Cont cont, Pred extractor)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          { <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(cont, extractor); }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a8cae9e596a0ecc842d73928ea19350f7">  389</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a8cae9e596a0ecc842d73928ea19350f7">add_without_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          { <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">add_without_uncertainty</a>(cont); }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="keyword">typename</span> VIter, <span class="keyword">typename</span> UIter,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred = <a class="code" href="../../dd/d5e/structlar_1_1util_1_1identity.html">identity</a></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          &gt;</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abf6938c3e80be0da03f634b27c11f537">  397</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abf6938c3e80be0da03f634b27c11f537">add_with_uncertainty</a>(</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          VIter begin_value, VIter end_value,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          UIter begin_uncertainty,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          VPred value_extractor,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          UPred uncertainty_extractor = UPred()</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          )</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;              begin_value, end_value, begin_uncertainty,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;              value_extractor, uncertainty_extractor);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd3e077bae3e45c414127589c60d8989">  411</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd3e077bae3e45c414127589c60d8989">add_with_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(begin, end); }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa4e78098f8018a494156c09516feb50e">  415</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa4e78098f8018a494156c09516feb50e">add_with_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">add_with_uncertainty</a>(cont); }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">        ///@}</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">        /// Clears all the statistics</span></div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4891d1b53962c0c5432caefd700a4213">  421</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4891d1b53962c0c5432caefd700a4213">clear</a>() { <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9bc3d800d3e435afbcf66d0ff66f6adc">clear</a>(); }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">        /// @name Statistic retrieval</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">        /// @see FitDataCollector</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd1e361440cfbcf3c4834a7dc043f12e">  427</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd1e361440cfbcf3c4834a7dc043f12e">N</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3d0f30878e869b34592a564d50118efb">N</a>(); }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad622458251ea68f076bf81d91190e685">  429</a></span>&#160;        <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad622458251ea68f076bf81d91190e685">AverageUncertainty</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3954611eb63affe1913f53ce3671eaeb">AverageUncertainty</a>(); }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">        /// @}</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">        /// Prints the collected statistics into a stream</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Stream&gt;</div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af1ed8d3e064a52cf1ee95e85a99dbe2a">  436</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af1ed8d3e064a52cf1ee95e85a99dbe2a">PrintStats</a>(<a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#a9cafae22b6225844ee0cdf5ea57176ff">Stream</a>&amp; out)<span class="keyword"> const </span>{ <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9b55ce81a1f76de70228e0298ae54e85">Print</a>(out); }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">        /// Returns the square of the specified value</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span>        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt;</div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">  441</a></span>&#160;        <span class="keyword">static</span> constexpr <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">sqr</a>(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a> <span class="keyword">const</span>&amp; v) { <span class="keywordflow">return</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#abcee99c58b01642177b6c7a5a0c88eb2">Collector_t::sqr</a>(v); }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">  444</a></span>&#160;        <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">Collector_t</a> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>; <span class="comment">///&lt; statistics collected from fit data input</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">        /// Returns the weighted sum of x^n</span></div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ae5a969956136114896c3b079df978eb1">  447</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ae5a969956136114896c3b079df978eb1">XN</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9d78d4ffd495c6c3acd7ed6b57eed8c8">XN</a>(n); }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">        /// Returns the weighted sum of x^n y</span></div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a483618f5c31f72f3545c681c783dbbac">  450</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a483618f5c31f72f3545c681c783dbbac">XNY</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad9d2dd0bd8aa5f7cfc461b4be05b0b61">XNY</a>(n); }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      }; <span class="comment">// class SimplePolyFitterDataBase&lt;&gt;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">      /// Simple fitter abstract interface</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N&gt;</div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">  458</a></span>&#160;      <span class="keyword">class </span><a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">SimpleFitterInterface</a> {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keyword">public</span>:</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">        /// Number of parameters in the fit</span></div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">  462</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">NParams</a> = <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">  464</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> = T; <span class="comment">///&lt; type of the data</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a577be549a1b8f9f7f31a54fe22c8d003">  466</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html">MatrixOps</a> = <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html">FastMatrixOperations&lt;Data_t, NParams&gt;</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">        /// type of set of fit parameters</span></div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">  469</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> = std::array&lt;Data_t, NParams&gt;;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">        /// type of matrix for covariance (a std::array)</span></div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">  472</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#a2648e1625dc3754c74c0b62ae96be064">MatrixOps::Matrix_t</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">        /// Virtual destructor: compiler&#39;s default</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a330b13d0a2f0ef6874e6cabea1f9a317">~SimpleFitterInterface</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">         * @brief Returns if the fit has valid results</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">         * @return if the fit has valid results</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">         * The fit has no valid results if:</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">         * 1. insufficient data has been add()ed (no more than the fit Degree)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">         * 2. if input points are vertically aligned</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">         * Note that checking point 2 is expensive in terms of time.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a08a8105f4a8c69a529b330229bbef836">isValid</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">        /// @name Fitting</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">         * @brief Computes and returns all the parameters of the fit result</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">         * @return the full set of parameters of the fit</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">         * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5d81341ab4870034823963a45b995b3e">FitParameters</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">         * @brief Computes and returns all the parameter errors of the fit result</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">         * @return the full set of parameter errors of the fit</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">         * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a08bf827c2a4f88030c025064483ed59a">FitParameterErrors</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">         * @brief Computes and returns all the covariance matrix of the fit result</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">         * @return the the covariance matrix of the fit</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">         * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">         * The matrix is symmetric, and stored in a linear way (say, first row,</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">         * then second row).</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6d268d6f084a6f0e5d7f524304db557c">FitParameterCovariance</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">         * @brief Returns the parameter n of the fit result</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">         * @param n degree of the parameter; must be no larger than Degree</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">         * @return the parameter of the fit, in y/x^n units</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">         * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#af0595a4b25e61e68c6d50f95f945d97a">  524</a></span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#af0595a4b25e61e68c6d50f95f945d97a">FitParameter</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5d81341ab4870034823963a45b995b3e">FitParameters</a>()[<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>]; }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">         * @brief Returns the error on parameter n of the fit result</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">         * @param n degree of the parameter; must be no larger than Degree</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">         * @return the error on the parameter of the fit, in y/x^n units</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">         * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a1492f85d4cba91b82298a105e4889bb8">  533</a></span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a1492f85d4cba91b82298a105e4889bb8">FitParameterError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> std::sqrt(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6d268d6f084a6f0e5d7f524304db557c">FitParameterCovariance</a>()[n * (<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">NParams</a> + 1)]); }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">         * @brief Returns the @f$ \chi^{2} @f$ of the fit</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">         * @return the @f$ \chi^{2} @f$ of the fit (not divided by NDF())</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#aeaa6a12c696704611d5712118158cacc">ChiSquare</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">         * @brief Returns the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">         * @return the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">         * The return value may be 0 or negative if insufficient points have been</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">         * added.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a51556ffbc848f3b78121d6606a2b9d24">NDF</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">        /// @}</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">         * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">         * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">         * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3dab9ea4282ef37bba12e8ca2c532fe4">FillResults</a>(</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a>&amp; params,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a>&amp; det, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          ) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">         * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">         * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">         * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3dab9ea4282ef37bba12e8ca2c532fe4">FillResults</a>(</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a>&amp; params, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a>&amp; paramerrors,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a>&amp; det, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          ) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">         * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3dab9ea4282ef37bba12e8ca2c532fe4">FillResults</a></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          (<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a>&amp; params, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a>&amp; paramerrors) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">         * @brief Evaluates the fitted function at the specified point</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">         * @param x the point where to evaluate the fit function</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">         * @return the value of the fit function</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">         * No check is performed whether the fit is valid.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a43e6304f681bcd8d5ae34881a5531514">Evaluate</a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> x) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">        /// Evaluates the fitted function; alias of Evaluate()</span></div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e7f08c98bb23604598d94dc44efbd37">  603</a></span>&#160;<span class="comment"></span>        <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e7f08c98bb23604598d94dc44efbd37">operator() </a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a43e6304f681bcd8d5ae34881a5531514">Evaluate</a>(x); }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">        /// Returns the square of the specified data value</span></div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e5c8d99d2caf110f42dddbba2501e5e">  607</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e5c8d99d2caf110f42dddbba2501e5e">sqr</a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> v) { <span class="keywordflow">return</span> v*v; }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">        /// Returns the cube of the specified data value</span></div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ae127d0760150b1e158b8c4853c644dad">  610</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ae127d0760150b1e158b8c4853c644dad">cube</a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> v) { <span class="keywordflow">return</span> v*v*v; }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">        /// Computes the determinant of a matrix</span></div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6f434f79e36905d633fa70be5a90bc21">  615</a></span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6f434f79e36905d633fa70be5a90bc21">Determinant</a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <span class="keyword">const</span>&amp; mat)<span class="keyword"> const</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#ad29d6a2ce302b7d345fa1f1755b7af73">MatrixOps::Determinant</a>(mat); }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">        /// Computes the inverse of a matrix (using provided determinant)</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ade3dcb77d39f876e6f42f72b3f40a63a">InvertMatrix</a></div>
<div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ade3dcb77d39f876e6f42f72b3f40a63a">  620</a></span>&#160;          (<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <span class="keyword">const</span>&amp; mat, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Data_t</a> det) <span class="keyword">const</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#a7e51e12fd87a611610e3165f03a331ec">MatrixOps::InvertSymmetricMatrix</a>(mat, det); }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">        /// Computes the inverse of a matrix</span></div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ab084657b6ccb739647ad9cbd13d7324c">  624</a></span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ab084657b6ccb739647ad9cbd13d7324c">InvertMatrix</a>(<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <span class="keyword">const</span>&amp; mat)<span class="keyword"> const</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#a7e51e12fd87a611610e3165f03a331ec">MatrixOps::InvertSymmetricMatrix</a>(mat); }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">        /// Computes the product of a FitMatrix_t and a FitParameters_t</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ad259e7c33a704282f3e0a2aea96011a3">MatrixProduct</a></div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ad259e7c33a704282f3e0a2aea96011a3">  629</a></span>&#160;          (<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <span class="keyword">const</span>&amp; mat, <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <span class="keyword">const</span>&amp; vec) <span class="keyword">const</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d0/dfb/structlar_1_1util_1_1details_1_1FastMatrixOperationsBase.html#a50691cd4ea489da5d9c1bb811193e775">MatrixOps::MatrixVectorProduct</a>(mat, vec); }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      }; <span class="comment">// class SimpleFitterInterface&lt;&gt;</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">      /// Base class providing virtual fitting interface for polynomial fitters</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">  637</a></span>&#160;      <span class="keyword">class </span><a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">SimplePolyFitterBase</a>:</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keyword">public</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">SimpleFitterInterface</a>&lt;T, D + 1&gt;,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keyword">public</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">SimplePolyFitterDataBase</a>&lt;T, D&gt;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      {</div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaef59d76c371ed8ff91e9c2c399a3913">  641</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">Interface_t</a> = <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">SimpleFitterInterface&lt;T, D + 1&gt;</a>; <span class="comment">///&lt; interface</span></div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a092f76a84e6554d3ca5bf6bd25632948">  642</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">Base_t</a> = <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">SimplePolyFitterDataBase&lt;T, D&gt;</a>; <span class="comment">///&lt; class storing input</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keyword">public</span>:</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">Base_t::sqr</a>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">        /// Degree of the fit</span></div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a403adaeef013d290bb38246e905557fb">  648</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a403adaeef013d290bb38246e905557fb">Degree</a> = <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a45d61916db41f358569ca76d77a09501">Base_t::Degree</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">        /// Number of parameters in the fit</span></div>
<div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">  651</a></span>&#160;<span class="comment"></span>        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">NParams</a> = <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">Interface_t::NParams</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">  653</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Base_t::Data_t</a>; <span class="comment">///&lt; type of the data</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">        /// type of set of fit parameters</span></div>
<div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">  656</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">Interface_t::FitParameters_t</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">        /// type of matrix for covariance (a std::array)</span></div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">  659</a></span>&#160;<span class="comment"></span>        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">Interface_t::FitMatrix_t</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">         * @brief Returns if the fit has valid results</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">         * @return if the fit has valid results</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">         * The fit has no valid results if:</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">         * 1. insufficient data has been add()ed (no more than the fit Degree)</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">         * 2. if input points are vertically aligned</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">         * Note that checking point 2 is expensive in terms of time.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae5e857b88e1c1e5b31e512ba0ed5a34d">isValid</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">        /// @{</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">        /// @name Fitting</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">         * @brief Computes and returns all the parameters of the fit result</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">         * @return the full set of parameters of the fit</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">         * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">FitParameters</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">         * @brief Computes and returns all the parameter errors of the fit result</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">         * @return the full set of parameter errors of the fit</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">         * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab425fab187edeb678899b16b33be3fbf">FitParameterErrors</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">         * @brief Computes and returns all the covariance matrix of the fit result</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">         * @return the the covariance matrix of the fit</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">         * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">         * The matrix is symmetric, and stored in a linear way (say, first row,</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">         * then second row).</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a3388e3f7e748ff75fdfe1a0be195c9a0">FitParameterCovariance</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">         * @brief Returns the parameter n of the fit result</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">         * @param n degree of the parameter; must be no larger than Degree</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">         * @return the parameter of the fit, in y/x^n units</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">         * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104">FitParameter</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">         * @brief Returns the error on parameter n of the fit result</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">         * @param n degree of the parameter; must be no larger than Degree</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">         * @return the error on the parameter of the fit, in y/x^n units</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">         * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b">FitParameterError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">         * @brief Returns the @f$ \chi^{2} @f$ of the fit</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">         * @return the @f$ \chi^{2} @f$ of the fit (not divided by NDF())</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae812ba5cd684f8a6c7f8a9217fa32c25">ChiSquare</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">         * @brief Returns the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">         * @return the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">         * The return value may be 0 or negative if insufficient points have been</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">         * added.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aad5aa30de4b0390798c2be2e22e54a33">  731</a></span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aad5aa30de4b0390798c2be2e22e54a33">NDF</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd1e361440cfbcf3c4834a7dc043f12e">Base_t::N</a>() - <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">NParams</a>; }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">        /// @}</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">         * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">         * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">         * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">FillResults</a>(</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a>&amp; det, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          ) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">         * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">         * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">         * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">         * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">FillResults</a>(</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; paramerrors,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a>&amp; det, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          ) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">         * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">         * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">         * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">         * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">FillResults</a></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          (<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; paramerrors)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;          <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">         * @brief Evaluates the fitted function at the specified point</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">         * @param x the point where to evaluate the fit function</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">         * @return the value of the fit function</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">         * No check is performed whether the fit is valid.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a5248460746943b74c089d75dbabf2df1">Evaluate</a>(<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> x) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">        /// Extracts parameter errors from diagonal of the covarriance matrix</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span>        <span class="keyword">static</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a063a75ce9b914bbe7b9efc6adb7a2e7a">ExtractParameterErrors</a>(<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Smat);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">        /// Fills and returns the matrix of x^n sum coefficients ( { x^(i+j) } )</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a8c15bf4e1cffb5f948e2cc0593b5bf59">MakeMatrixX</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">        /// Fills and returns the matrix (vector) of x^n y sum coefficients</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#afe61d8fd0065ea31105af6eead27bac3">MakeMatrixY</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">        /// Computes and returns all the parameter errors of the fit result</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab425fab187edeb678899b16b33be3fbf">FitParameterErrors</a></div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a271a5ebaf1c359516a6477d3d5d1986a">  798</a></span>&#160;          (<a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">FitMatrix_t</a> <span class="keyword">const</span>&amp; Smat) <span class="keyword">const</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a063a75ce9b914bbe7b9efc6adb7a2e7a">ExtractParameterErrors</a>(Smat); }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">        //@{</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"></span><span class="comment">        /// Returns the fitted parameters using the provided information</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">FitParameters</a>(<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">FitParameters</a></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          (<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Smat, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> <span class="comment">/* det */</span>) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">        //@}</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">        //@{</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"></span><span class="comment">        /// Computes a single fit parameter using the given information</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514">Param</a></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514">Param</a></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> detXmat) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">        //@}</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">// import the declaration from the interface</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6f434f79e36905d633fa70be5a90bc21">Interface_t::Determinant</a>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ade3dcb77d39f876e6f42f72b3f40a63a">Interface_t::InvertMatrix</a>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ad259e7c33a704282f3e0a2aea96011a3">Interface_t::MatrixProduct</a>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      }; <span class="comment">// class SimplePolyFitterBase&lt;&gt;</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    } <span class="comment">// namespace details</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">    /** ************************************************************************</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">     * @brief Performs a linear regression of data</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">     * @tparam T type of the quantities</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">     * @tparam W type of the weight (as T by default)</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">     * The linear regression connects measurements</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">     * @f$ ( y_{i} \pm \sigma_{y,i} ) @f$ with a parameter @f$ ( x_{i} ) @f$</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">     * not affected by uncertainty.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">     * The returned parameters describe a straight line @f$ y = a x + b @f$</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">     * obtained by minimization of</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">     * @f$ \chi^{2} = \sum_{i} \frac{ \left(y_{i} - a x_{i} - b \right)^{2} }{ \sigma^{2}_{y,i} }@f$</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">     * This saves having to link to ROOT for the simplest cases.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">     * This simple linear fitter does not store any result: each time a result</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">     * is requested, it is computed anew.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">     * In particular that is true also for ChiSquare(), that requires the full</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">     * parameters set and therefore reruns the full fit (FitParameters())</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">     * and for the covariance matrix of the parameters.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html">  849</a></span>&#160;    <span class="keyword">class </span><a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html">LinearFit</a>: <span class="keyword">public</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">details::SimplePolyFitterBase</a>&lt;T, 1U&gt; {</div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#afd75466196cc368627eca58ccc58d0da">  850</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">Base_t</a> = <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">details::SimplePolyFitterBase&lt;T, 1U&gt;</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a403adaeef013d290bb38246e905557fb">Base_t::Degree</a>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">Base_t::NParams</a>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Base_t::Data_t</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">      /// type of measurement without uncertainty</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">Base_t::Measurement_t</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">      /// type of measurement with uncertainty</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">Base_t::MeasurementAndUncertainty_t</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">Base_t::sqr</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">      /// type of set of fit parameters</span></div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1e9cd10f407a1a9386838bdb2bef1f11">  866</a></span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1e9cd10f407a1a9386838bdb2bef1f11">FitParameters_t</a> = std::array&lt;Data_t, NParams&gt;;</div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a99bd817c34f06f535f974e68e47ea84f">  867</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a99bd817c34f06f535f974e68e47ea84f">FitMatrix_t</a> = std::array&lt;Data_t, sqr(NParams)&gt;;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="comment">// default constructor, destructor and all the rest</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">       * @brief Returns the intercept of the fit</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">       * @return the intercept of the fit, in y units</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">       * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00877"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adb062aeb049cd93d201b30eedba813be">  877</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adb062aeb049cd93d201b30eedba813be">Intercept</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104">FitParameter</a>(0); }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">       * @brief Returns the slope of the fit</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">       * @return the slope of the fit, in y/x units</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">       * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#ac4d1e5c9f8997e754f1ff8419f5555af">  884</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#ac4d1e5c9f8997e754f1ff8419f5555af">Slope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104">FitParameter</a>(1); }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">       * @brief Returns the error on intercept of the fit</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">       * @return the error on intercept of the fit, in y units</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">       * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a7f5f89da4d9e8eb6d8dc6895cae02639">  891</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a7f5f89da4d9e8eb6d8dc6895cae02639">InterceptError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b">FitParameterError</a>(0); }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">       * @brief Returns the error in slope of the fit</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">       * @return the error on slope of the fit, in y/x units</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">       * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#af72192678e8b18720e8e717a3aeacfb5">  898</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#af72192678e8b18720e8e717a3aeacfb5">SlopeError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b">FitParameterError</a>(1); }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">       * @brief Returns the covariance between intercept and slope of the fit</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">       * @return the covariance between intercept and slope of the fit, in y^2 units</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">       * @throws std::range_error if there is no unique solution</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a31b277799350e6a2a27beec6f994c233">  905</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a31b277799350e6a2a27beec6f994c233">InterceptSlopeCovariance</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keyword">        </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a3388e3f7e748ff75fdfe1a0be195c9a0">FitParameterCovariance</a>()[0 * <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">NParams</a> + 1]; }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">       * @brief Returns the @f$ \chi^{2} @f$ of the fit</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">       * @return the @f$ \chi^{2} @f$ of the fit (not divided by NDF())</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a5e3a2a3a0b13dde0e958e3cbba67f5db">ChiSquare</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">      //@{</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"></span><span class="comment">      /// Aliases</span></div>
<div class="line"><a name="l00920"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a8a81b255dd75fc336b7ccc38502ef1be">  920</a></span>&#160;<span class="comment"></span>      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a8a81b255dd75fc336b7ccc38502ef1be">I</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;0&gt;(); }</div>
<div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a16b22ddaf83811695a85fc2942aac908">  921</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a16b22ddaf83811695a85fc2942aac908">X</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;1&gt;(); }</div>
<div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1a77d4ae72485eac9b9bcf85234d4de0">  922</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1a77d4ae72485eac9b9bcf85234d4de0">X2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;2&gt;(); }</div>
<div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a439050e55109f795d68d94b1291b377b">  923</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a439050e55109f795d68d94b1291b377b">Y</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XNY&lt;0&gt;(); }</div>
<div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a128fb909d713f604ae4ee55491dc6ac8">  924</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a128fb909d713f604ae4ee55491dc6ac8">XY</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XNY&lt;1&gt;(); }</div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adf138b348f0f949b9db767773733814a">  925</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adf138b348f0f949b9db767773733814a">Y2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a67a9ecb3326bf44dd204c1a6a7dad7af">Y2</a>(); }<span class="comment"></span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">      //@}</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }; <span class="comment">// class LinearFit&lt;&gt;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">    /** ************************************************************************</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">     * @brief Performs a second-degree fit of data</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">     * @tparam T type of the quantities</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">     * @tparam W type of the weight (as T by default)</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">     * The quadratic fit connects measurements</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">     * @f$ ( y_{i} \pm \sigma_{y,i} ) @f$ with a parameter @f$ ( x_{i} ) @f$</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">     * not affected by uncertainty.</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">     * The returned parameters describe a quadratic curve</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">     * @f$ f(x) = a_{0} + a_{1} x + a_{2} x^{2} @f$ obtained by minimization of</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">     * @f$ \chi^{2} = \sum_{i} \frac{ \left(y_{i} - f(x_{i}) \right)^{2} }{ \sigma^{2}_{y,i} }@f$</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">     * This saves having to link to ROOT for the simplest cases.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">     * This simple quadratic fitter does not store any result: each time a</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">     * result is requested, it is computed anew.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">     * In particular that is true also for ChiSquare(), that requires the full</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">     * parameters set and therefore reruns the full fit (FitParameters())</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">     * and for the covariance matrix of the parameters.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">  953</a></span>&#160;    <span class="keyword">class </span><a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">QuadraticFit</a>: <span class="keyword">public</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">details::SimplePolyFitterBase</a>&lt;T, 2U&gt; {</div>
<div class="line"><a name="l00954"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#afb68ba9e57660585f3519e0afc7a99b6">  954</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">Base_t</a> = <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">details::SimplePolyFitterBase&lt;T, 2U&gt;</a>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a403adaeef013d290bb38246e905557fb">Base_t::Degree</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">Base_t::NParams</a>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">Base_t::Data_t</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">      /// type of measurement without uncertainty</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">Base_t::Measurement_t</a>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">      /// type of measurement with uncertainty</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">Base_t::MeasurementAndUncertainty_t</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">Base_t::sqr</a>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">      /// type of set of fit parameters</span></div>
<div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a66369cf17abc77f70ba79ece4cb5e6ec">  970</a></span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a66369cf17abc77f70ba79ece4cb5e6ec">FitParameters_t</a> = std::array&lt;Data_t, NParams&gt;;</div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1f7b06960ec67ad2da1032cee9cc4409">  971</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1f7b06960ec67ad2da1032cee9cc4409">FitMatrix_t</a> = std::array&lt;Data_t, sqr(NParams)&gt;;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="comment">// default constructor, destructor and all the rest</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">       * @brief Returns the @f$ \chi^{2} @f$ of the fit</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">       * @return the @f$ \chi^{2} @f$ of the fit (not divided by NDF())</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a950aea2d9a641d91f023752dd436cbac">ChiSquare</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">      //@{</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"></span><span class="comment">      /// Aliases</span></div>
<div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a73cf8964153186e7f7edca034fee1703">  987</a></span>&#160;<span class="comment"></span>      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a73cf8964153186e7f7edca034fee1703">I</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;0&gt;(); }</div>
<div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a193e5368304049d6ed47870040d38f12">  988</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a193e5368304049d6ed47870040d38f12">X</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;1&gt;(); }</div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a248b2be108e07c2482280ae7bbfc93f1">  989</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a248b2be108e07c2482280ae7bbfc93f1">X2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;2&gt;(); }</div>
<div class="line"><a name="l00990"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a330346b7f83f740f4e3273b7c37fed33">  990</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a330346b7f83f740f4e3273b7c37fed33">X3</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;3&gt;(); }</div>
<div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1bcda569b4c46c16da384062f0e4a266">  991</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1bcda569b4c46c16da384062f0e4a266">X4</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XN&lt;4&gt;(); }</div>
<div class="line"><a name="l00992"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a421b70dcaafc9fa9c0aaf157eabd2403">  992</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a421b70dcaafc9fa9c0aaf157eabd2403">Y</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XNY&lt;0&gt;(); }</div>
<div class="line"><a name="l00993"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aea7a7562e33591741b641e6ba634337b">  993</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aea7a7562e33591741b641e6ba634337b">XY</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XNY&lt;1&gt;(); }</div>
<div class="line"><a name="l00994"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a5594d0b6fea6ee3b30a1da69e10b4ced">  994</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a5594d0b6fea6ee3b30a1da69e10b4ced">X2Y</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.template XNY&lt;2&gt;(); }</div>
<div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aa699fcf9f17e6ba01bf98d74c77991ca">  995</a></span>&#160;      <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aa699fcf9f17e6ba01bf98d74c77991ca">Y2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">Base_t::stats</a>.<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a67a9ecb3326bf44dd204c1a6a7dad7af">Y2</a>(); }<span class="comment"></span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">      //@}</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }; <span class="comment">// class QuadraticFit&lt;&gt;</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">    /** **********************************************************************</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">     * @brief &quot;Fast&quot; Gaussian fit</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">     * @tparam T data type</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">     * This class performs a Gaussian fit on demand.</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">     * This fit translates the data to its logarithm and then internally</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">     * performs a quadratic fit.</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">     * Note that as a consequence this fitter does not accept negative values</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">     * for the y variable.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">     * Negative values in input will be completely ignored.</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">     * Methods that do not change functionality respect to the base class are</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">     * not documented here -- see the base class(es) documentation</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">     * (mostly SimplePolyFitterBase).</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html"> 1018</a></span>&#160;    <span class="keyword">class </span><a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html">GaussianFit</a>: <span class="keyword">public</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">details::SimpleFitterInterface</a>&lt;T, 3&gt; {</div>
<div class="line"><a name="l01019"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#af134e6700307c1642613bdbb64e433b9"> 1019</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">Base_t</a> = <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">details::SimpleFitterInterface&lt;T, 3&gt;</a>; <span class="comment">///&lt; base class</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#adb1e7ff7ee7e6492f9e2a92759e7d6ab"> 1020</a></span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">Fitter_t</a> = <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">QuadraticFit&lt;T&gt;</a>; <span class="comment">///&lt; base class</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">      /// Number of parameters in the fit</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a44f5b4df159e9690a32ce3d3474460e8"> 1024</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a44f5b4df159e9690a32ce3d3474460e8">NParams</a> = <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">Base_t::NParams</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f"> 1026</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">Base_t::Data_t</a>; <span class="comment">///&lt; type of the data</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">      /// type of measurement without uncertainty</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69"> 1029</a></span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">Fitter_t::Measurement_t</a>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">      /// type of measurement with uncertainty</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment"></span>      <span class="keyword">using</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a></div>
<div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631"> 1033</a></span>&#160;        = <span class="keyword">typename</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">Fitter_t::MeasurementAndUncertainty_t</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e"> 1035</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a66369cf17abc77f70ba79ece4cb5e6ec">Fitter_t::FitParameters_t</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe"> 1036</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> = <span class="keyword">typename</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1f7b06960ec67ad2da1032cee9cc4409">Fitter_t::FitMatrix_t</a>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e5c8d99d2caf110f42dddbba2501e5e">Base_t::sqr</a>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ae127d0760150b1e158b8c4853c644dad">Base_t::cube</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="comment">// default constructor, destructor and all the rest</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">      /// @{</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">      /// @name Add elements</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">      /// @see FitDataCollector</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8">add</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> x, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> y, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> sy = <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>(1.0));</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3d9be0c8d4964334103140c74d9790be"> 1050</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3d9be0c8d4964334103140c74d9790be">add</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a> value, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> sy = <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>(1.0))</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8">add</a>(std::get&lt;0&gt;(value), std::get&lt;1&gt;(value), sy); }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a690421ae11ed311f948c68699e70c9c5"> 1053</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a690421ae11ed311f948c68699e70c9c5">add</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a> value)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8">add</a>(std::get&lt;0&gt;(value), std::get&lt;1&gt;(value), std::get&lt;2&gt;(value));</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b"> 1061</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        {  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">add_without_uncertainty</a>(begin, end, <a class="code" href="../../dd/d5e/structlar_1_1util_1_1identity.html">identity</a>()); }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">add_without_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, Pred extractor);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac6219e5dc485a719393b107e5f88187f"> 1068</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac6219e5dc485a719393b107e5f88187f">add_without_uncertainty</a>(Cont cont, Pred extractor)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        { <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">add_without_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont), extractor); }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l01072"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f510fe6d0cac9f3bd45b3eef1d4db1e"> 1072</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f510fe6d0cac9f3bd45b3eef1d4db1e">add_without_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        { <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">add_without_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont)); }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keyword">typename</span> VIter, <span class="keyword">typename</span> UIter,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred = <a class="code" href="../../dd/d5e/structlar_1_1util_1_1identity.html">identity</a></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        &gt;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">add_with_uncertainty</a>(</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        VIter begin_value, VIter end_value,</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        UIter begin_uncertainty,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        VPred value_extractor,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        UPred uncertainty_extractor = UPred()</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        );</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">add_with_uncertainty</a>(Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Cont&gt;</div>
<div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a17c3417bb84bd323dacd81f2dbc63cb2"> 1092</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a17c3417bb84bd323dacd81f2dbc63cb2">add_with_uncertainty</a>(Cont cont)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">add_with_uncertainty</a>(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(cont), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(cont)); }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">      /// Clears all the input statistics</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a9c99455132b4ede84de6e73fc5a9738f"> 1097</a></span>&#160;<span class="comment"></span>      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a9c99455132b4ede84de6e73fc5a9738f">clear</a>() { <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4891d1b53962c0c5432caefd700a4213">clear</a>(); }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">      /// Returns the number of (valid) points added</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac1cd3eb680bd5c9aff08a7bfa55ed9a3"> 1100</a></span>&#160;<span class="comment"></span>      <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac1cd3eb680bd5c9aff08a7bfa55ed9a3">N</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd1e361440cfbcf3c4834a7dc043f12e">N</a>(); }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">      /// Prints the collected statistics into a stream</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Stream&gt;</div>
<div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a7537924ed971ce2868e570993c7244e5"> 1105</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a7537924ed971ce2868e570993c7244e5">PrintStats</a>(<a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#a9cafae22b6225844ee0cdf5ea57176ff">Stream</a>&amp; out)<span class="keyword"> const </span>{ <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af1ed8d3e064a52cf1ee95e85a99dbe2a">PrintStats</a>(out); }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">      ///@}</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">      /// @{</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">      /// @name Fitting</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment"></span><span class="comment">      /**</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">       * @brief Returns if the fit has valid results</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">       * @return if the fit has valid results</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">       * The fit has no valid results if:</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">       * 1. insufficient data has been add()ed (no more than the fit Degree)</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">       * 2. if input points are vertically aligned</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">       * Note that checking point 2 is expensive in terms of time.</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f6a4b59feda3dc4f21275ba417c5d5b"> 1122</a></span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f6a4b59feda3dc4f21275ba417c5d5b">isValid</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae5e857b88e1c1e5b31e512ba0ed5a34d">isValid</a>(); }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">      /// @{</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">      /// @name Fitting</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">       * @brief Computes and returns all the parameters of the fit result</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">       * @return the full set of parameters of the fit</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">       * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a14cfdfe79c0db43c93ed48c1a5c72008">FitParameters</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">       * @brief Computes and returns all the parameter errors of the fit result</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">       * @return the full set of parameter errors of the fit</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">       * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa3922f3581c63ecd8e144cb2c98a09ef">FitParameterErrors</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">       * @brief Computes and returns all the covariance matrix of the fit result</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">       * @return the the covariance matrix of the fit</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">       * @throws std::runtime_error if there is no unique solution</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">       * Not supported.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">       * It&#39;s fairly too complicate to fill the whole matrix.</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">       * Doable, on request.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab7cc52876d6e9a87d422334c494c59bf">FitParameterCovariance</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">       * @brief Returns the @f$ \chi^{2} @f$ of the original fit</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">       * @return the @f$ \chi^{2} @f$ of the original fit (not divided by NDF())</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">       * This is not defined in the space of the Gaussian, but in the space of</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">       * the internal quadratic fit. Where one is minimum, the other also is,</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">       * but the actual value is different.</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3f712f3b4f6d75ccba0ccec5a86d7212"> 1161</a></span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3f712f3b4f6d75ccba0ccec5a86d7212">ChiSquare</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a950aea2d9a641d91f023752dd436cbac">ChiSquare</a>(); }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">       * @brief Returns the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">       * @return the degrees of freedom in the determination of the fit</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">       * The return value may be 0 or negative if insufficient points have been</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">       * added.</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a0c7d8282cee71e74462ead6919c21b4a"> 1170</a></span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a0c7d8282cee71e74462ead6919c21b4a">NDF</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>.<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aad5aa30de4b0390798c2be2e22e54a33">NDF</a>(); }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">      /// @}</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">       * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">       * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">       * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">       * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">       * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">       * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">       * Unsupported.</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">FillResults</a>(</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; det, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        ) <span class="keyword">const override</span>;<span class="comment"></span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">       * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">       * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">       * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">       * @param Xmat the matrix of the x^n/s^2 sums</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">       * @param Smat the covariance matrix</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">       * @param det the determinant of Xmat</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">       * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">       * Unsupported.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">FillResults</a>(</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors,</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; det, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        ) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">       * @brief Fills the specified parameters</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">       * @param params the fitted values of the parameters</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">       * @param paramerrors the uncertainty on the fitted parameters</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">       * @return true if the fit is valid (i.e. if a unique solution exists)</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">       * Only the version returning the parameters and errors is supported.</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">FillResults</a></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">       * @brief Evaluates the fitted function at the specified point</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">       * @param x the point where to evaluate the fit function</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">       * @return the value of the fit function</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">       * No check is performed whether the fit is valid.</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69"> 1225</a></span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69">Evaluate</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> x)<span class="keyword"> const override</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="keyword">        </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69">Evaluate</a>(x, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a14cfdfe79c0db43c93ed48c1a5c72008">FitParameters</a>().data()); }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">      /// Returns the internal fitter (mostly for debugging)</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8b6ee48c3b346166d4203b788d478ae7"> 1230</a></span>&#160;<span class="comment"></span>      <span class="keyword">virtual</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">Fitter_t</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8b6ee48c3b346166d4203b788d478ae7">Fitter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>; }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">       * @brief Evaluates a Gaussian with given parameters at one point</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">       * @param x the point where to evaluate the fit function</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">       * @param params Gaussian parameters: amplitude, mean, sigma</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">       * @return the Gaussian function evaluated at x</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69">Evaluate</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> x, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <span class="keyword">const</span>* params);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040"> 1242</a></span>&#160;      <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">Fitter_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">fitter</a>; <span class="comment">///&lt; the actual fitter and data holder</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">      /// @{</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">      /// @name Mumbo-jumbo to convert the values for a quadratic fit</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">      ///&lt; type of value and error</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html"> 1248</a></span>&#160;<span class="comment"></span>      <span class="keyword">struct </span><a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a>: <span class="keyword">public</span> std::tuple&lt;Data_t, Data_t&gt; {</div>
<div class="line"><a name="l01249"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aedf9cfa1cc9a4555be8e166bef57ac42"> 1249</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aedf9cfa1cc9a4555be8e166bef57ac42">Base_t</a> = std::tuple&lt;Data_t, Data_t&gt;;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a93578b4e19115a4715fe140bfb3a80b9"> 1251</a></span>&#160;        <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a93578b4e19115a4715fe140bfb3a80b9">Value_t</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> v, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>): <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aedf9cfa1cc9a4555be8e166bef57ac42">Base_t</a>(v, e) {}</div>
<div class="line"><a name="l01252"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aab8c459c58f27d536ca4ac00538ffb9e"> 1252</a></span>&#160;        <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aab8c459c58f27d536ca4ac00538ffb9e">Value_t</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a> meas):</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aedf9cfa1cc9a4555be8e166bef57ac42">Base_t</a>(<a class="code" href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">std</a>::<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt;1&gt;(meas), <a class="code" href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">std</a>::<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt;2&gt;(meas)) {}</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29"> 1255</a></span>&#160;        constexpr <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::get&lt;0&gt;(*this); }</div>
<div class="line"><a name="l01256"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5"> 1256</a></span>&#160;        constexpr <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::get&lt;1&gt;(*this); }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ae5437e7c57c31067e647f6789eeff30b"> 1258</a></span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ae5437e7c57c31067e647f6789eeff30b">value</a>() { <span class="keywordflow">return</span> std::get&lt;0&gt;(*this); }</div>
<div class="line"><a name="l01259"></a><span class="lineno"><a class="line" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a82c639ab4406d80b65062ef721249a24"> 1259</a></span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a82c639ab4406d80b65062ef721249a24">error</a>() { <span class="keywordflow">return</span> std::get&lt;1&gt;(*this); }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      }; <span class="comment">// Value_t</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">      /// Converts a value into a proper input for the quadratic fit;</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">      /// does not accept 0 or negative values!</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e"> 1265</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> value) { <span class="keywordflow">return</span> std::log(value); }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">      /// Converts a value from the quadratic fit into a proper value</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8d84a396c1367904464ca4cc5f317b5b"> 1268</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8d84a396c1367904464ca4cc5f317b5b">DecodeValue</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> value) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(value); }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">      /// Converts a value and error into a proper input for the quadratic fit</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac55a2bbf73bb5d200ee2614f3c802fad"> 1272</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac55a2bbf73bb5d200ee2614f3c802fad">EncodeValue</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> value, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d8/d79/namespacetest__msg.html#a79cb67e67dd7c11ad227880f7bd5625a">error</a>)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        { <span class="keywordflow">return</span> { std::log(value), error / <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(value) }; }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">      /// Converts a value and error into a proper input for the quadratic fit</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a31af0dc8685f677af1bffd6620ba1323"> 1277</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a31af0dc8685f677af1bffd6620ba1323">EncodeValue</a>(<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> <span class="keyword">const</span>&amp; value)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>(), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>()); }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">      /// Converts a value from the quadratic fit into a proper value</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a760c6d6ce0e04ee905d1c06723fcab08"> 1282</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a760c6d6ce0e04ee905d1c06723fcab08">DecodeValue</a>(<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> <span class="keyword">const</span>&amp; value)</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> v = <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>());</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          <span class="keywordflow">return</span> { v, v * value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>() };</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        } <span class="comment">// DecodeValue()</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">      /// Converts a value and error into a proper input for the quadratic fit</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#adcaa57cba5e79b3944afcd1dec42f73e"> 1289</a></span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#adcaa57cba5e79b3944afcd1dec42f73e">EncodeValue</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a> <span class="keyword">const</span>&amp; meas)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a>(std::get&lt;0&gt;(meas), <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(std::get&lt;1&gt;(meas)));</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">      /// Converts a value and error into a proper input for the quadratic fit</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a></div>
<div class="line"><a name="l01297"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ad8559f488b3c6b200f60d2abc0124ae3"> 1297</a></span>&#160;        (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a> <span class="keyword">const</span>&amp; meas)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> value = <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a>(meas));</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <span class="keywordflow">return</span> { std::get&lt;0&gt;(meas), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>(), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>() };</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        } <span class="comment">// EncodeValue(MeasurementAndUncertainty_t)</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">      /// Converts a value and error into a proper input for the quadratic fit</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment"></span>      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">MeasurementAndUncertainty_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a></div>
<div class="line"><a name="l01305"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aedf790dbffea37c309b4405b85c6bddc"> 1305</a></span>&#160;        (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">Measurement_t</a> <span class="keyword">const</span>&amp; meas, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d8/d79/namespacetest__msg.html#a79cb67e67dd7c11ad227880f7bd5625a">error</a>)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> value = <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a>(std::get&lt;1&gt;(meas), error));</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="keywordflow">return</span> { std::get&lt;0&gt;(meas), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>(), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>() };</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        } <span class="comment">// EncodeValue(Measurement_t, Data_t)</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">      /// Wrapper to encode a MeasurementAndUncertainty_t from a value</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">      /// and a error extractor</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred = <span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html"> 1315</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html">EncodeExtractor</a> {</div>
<div class="line"><a name="l01316"></a><span class="lineno"><a class="line" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a2e6850c298c2d7577a595f508df6ea74"> 1316</a></span>&#160;        <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a2e6850c298c2d7577a595f508df6ea74">EncodeExtractor</a>(VPred&amp; vpred, UPred&amp; upred):</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          value_extractor(vpred), <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#ac0c74ee598f1a08dd080878730881e53">error_extractor</a>(upred) {}</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="comment">// extractor takes whatever dereferencing Iter gives and returns</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="comment">// Measurement_t or MeasurementAndUncertainty_t,</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">// the one the extractor returns</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Elem&gt;</div>
<div class="line"><a name="l01323"></a><span class="lineno"><a class="line" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a4fef08fdef0fd3d2884b4d8f94d17c3b"> 1323</a></span>&#160;        <span class="keyword">auto</span> <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a4fef08fdef0fd3d2884b4d8f94d17c3b">operator() </a>(Elem elem)</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;          {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="comment">// use explicit casts to make sure we know what we are doing</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;              static_cast&lt;Measurement_t&amp;&amp;&gt;(<a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a9d9ad1880a0d0645d2c87b1274ae96a7">value_extractor</a>(elem)),</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;              static_cast&lt;Data_t&amp;&amp;&gt;(<a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#ac0c74ee598f1a08dd080878730881e53">error_extractor</a>(elem))</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;              );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          } <span class="comment">// operator()</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div>
<div class="line"><a name="l01332"></a><span class="lineno"><a class="line" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a9d9ad1880a0d0645d2c87b1274ae96a7"> 1332</a></span>&#160;        VPred&amp; <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a9d9ad1880a0d0645d2c87b1274ae96a7">value_extractor</a>; <span class="comment">///&lt; value extractor</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"><a class="line" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#ac0c74ee598f1a08dd080878730881e53"> 1333</a></span>&#160;<span class="comment"></span>        UPred&amp; <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#ac0c74ee598f1a08dd080878730881e53">error_extractor</a>; <span class="comment">///&lt; uncertainty extractor</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment"></span>      }; <span class="comment">// struct EncodeExtractor</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">      /// Wrapper to encode a Measurement_t or MeasurementAndUncertainty_t</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">      /// from a extractor</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment"></span>      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01339"></a><span class="lineno"><a class="line" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html"> 1339</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html">EncodeExtractor</a>&lt;Pred, <a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a59fca69799f6b9e366710cb9043aa77d">void</a>&gt; {</div>
<div class="line"><a name="l01340"></a><span class="lineno"><a class="line" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a0c81a335f9fa0bbd6d488db6aa4365a4"> 1340</a></span>&#160;        <a class="code" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a0c81a335f9fa0bbd6d488db6aa4365a4">EncodeExtractor</a>(Pred&amp; pred): extractor(pred) {}</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="comment">// extractor takes whatever dereferencing Iter gives and returns</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="comment">// Measurement_t or MeasurementAndUncertainty_t,</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="comment">// the one the extractor returns;</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="comment">// as usual with enable_if, I am not sure it makes sense</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          <span class="keyword">typename</span> Elem,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          <span class="keyword">typename</span> = <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">std::enable_if&lt;std::is_const&lt;Pred&gt;::value</a>, <span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          &gt;</div>
<div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a28426cf0296c535800ce8a57e71cd457"> 1350</a></span>&#160;        <span class="keyword">auto</span> <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a4fef08fdef0fd3d2884b4d8f94d17c3b">operator() </a>(Elem elem)<span class="keyword"> const</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="keyword">          </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(extractor(elem)); }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          <span class="keyword">typename</span> Elem,</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;          <span class="keyword">typename</span> = <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">std::enable_if&lt;!std::is_const&lt;Pred&gt;::value</a>, <span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          &gt;</div>
<div class="line"><a name="l01357"></a><span class="lineno"><a class="line" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a87993c2920991adeae5321f21bb47867"> 1357</a></span>&#160;        <span class="keyword">auto</span> <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a4fef08fdef0fd3d2884b4d8f94d17c3b">operator() </a>(Elem elem)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          { <span class="keywordflow">return</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">EncodeValue</a>(extractor(elem)); }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div>
<div class="line"><a name="l01360"></a><span class="lineno"><a class="line" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a01b1f5023f48e8903ffd765869fa424d"> 1360</a></span>&#160;        Pred&amp; <a class="code" href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a01b1f5023f48e8903ffd765869fa424d">extractor</a>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      }; <span class="comment">// struct EncodeExtractor&lt;Pred&gt;</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01364"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ad3ebeb4fe721f576acf73a8d349aeb9f"> 1364</a></span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html">EncodeExtractor&lt;Pred&gt;</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ad3ebeb4fe721f576acf73a8d349aeb9f">Encoder</a>(Pred&amp; pred) { <span class="keywordflow">return</span> { pred }; }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred&gt;</div>
<div class="line"><a name="l01367"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a15e54ca82341a7c2912238578d161e7c"> 1367</a></span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html">EncodeExtractor&lt;VPred, UPred&gt;</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a15e54ca82341a7c2912238578d161e7c">Encoder</a>(VPred&amp; vpred, UPred&amp; upred)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        { <span class="keywordflow">return</span> { vpred, upred }; }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">      /// @}</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment"></span><span class="comment"></span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">       * @brief Converts the specified quadratic fit parameters into Gaussian</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">       * @param qpars the quadratic fit parameters</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">       * @return Gaussian function parameters</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#accbd51441925c44762cdfe61e8a5c0b5">ConvertParameters</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">       * @brief Converts the specified quadratic fit parameters and errors</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">       * @param qpars the quadratic fit parameters</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">       * @param qparerrmat the quadratic fit parameter error matrix</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">       * @param params the Gaussian fit parameters</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">       * @param paramerrors the Gaussian fit parameter errors</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3e3c7d969786c42683414b1844c0cf93">ConvertParametersAndErrors</a>(</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        );</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">       * @brief Converts the specified quadratic fit parameters and errors</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">       * @param qpars the quadratic fit parameters</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">       * @param qparerrmat the quadratic fit parameter error matrix</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">       * @param params the Gaussian fit parameters</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">       * @param paramvariances the Gaussian fit parameter variance</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac4f73deb07279f689bce3dda5a5538ff">ConvertParametersAndVariances</a>(</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramvariances</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        );</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">       * @brief Converts the specified quadratic fit parameters and errors</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">       * @param qpars the quadratic fit parameters</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">       * @param qparerrmat the quadratic fit parameter error matrix</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">       * @param params the Gaussian fit parameters</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">       * @param Smat the covariance matrix of the Gaussian fit parameters</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aac76f73d1302f626d32ef2180890db84">ConvertParametersAndErrorMatrix</a>(</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        );</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">      /**</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">       * @brief Returns whether the specified parameters represent a valid fit</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">       * @param params Gaussian parameters</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">       * @param qpars quadratic fit parameters</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">       * @return whether specified parameters represent a valid Gaussian fit</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;     <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f6a4b59feda3dc4f21275ba417c5d5b">isValid</a></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;       (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a91d58d85ea54d3bd41dd3f4959d75d15"> 1425</a></span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a91d58d85ea54d3bd41dd3f4959d75d15">ThrowNotImplemented</a> [[noreturn]] (std::string <a class="code" href="../../d2/d65/crttrackproducer__icarus_8fcl.html#a14cd8fb5a7e9ccaa599d9e5fefbbe66d">method</a>)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        { <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Method &quot;</span> + <a class="code" href="../../d2/d65/crttrackproducer__icarus_8fcl.html#a14cd8fb5a7e9ccaa599d9e5fefbbe66d">method</a> + <span class="stringliteral">&quot;() not implemented&quot;</span>); }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    }; <span class="comment">// class GaussianFit&lt;&gt;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  } <span class="comment">// namespace util</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;} <span class="comment">// namespace lar</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">//=== template implementation</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">//***  FitDataCollector&lt;&gt;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">//***</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">lar::util::details::FitDataCollector&lt;T, D&gt;::add</a></div>
<div class="line"><a name="l01446"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1"> 1446</a></span>&#160;  (<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> x_value, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> y_value, <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> sy <span class="comment">/* = Data_t(1.0) */</span>)</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;{</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = UncertaintyToWeight(sy);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">if</span> (!std::isnormal(w)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="comment">// the x section has a 1/s^2 weight; we track that weight separately</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  s2.add(w);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  x.add(x_value, w);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="comment">// we treat the y section as if it were a x section with a y/s^2 weight;</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="comment">// we track that weight separately</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">Data_t</a> yw = y_value * <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  y.add(yw);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  y2.add(<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(y_value), w); <span class="comment">// used only for chi^2</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  xy.add(x_value, yw);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// we did add the value</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::add()</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">lar::util::details::FitDataCollector&lt;T, D&gt;::add_without_uncertainty</a></div>
<div class="line"><a name="l01467"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#af15324c6ee0b9e90509bc75e7ffad745"> 1467</a></span>&#160;  (Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>, Iter <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, Pred extractor)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  std::for_each</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    (begin, end, [<span class="keyword">this</span>, extractor](<span class="keyword">auto</span> item) { this-&gt;add(extractor(item)); });</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::add_without_uncertainty(Iter, Pred)</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VIter, <span class="keyword">typename</span> UIter, <span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred&gt;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03"> 1477</a></span>&#160;<a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">lar::util::details::FitDataCollector&lt;T, D&gt;::add_with_uncertainty</a>(</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  VIter begin_value, VIter end_value,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  UIter begin_uncertainty,</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  VPred value_extractor,</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  UPred uncertainty_extractor <span class="comment">/* = UPred() */</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keywordflow">while</span> (begin_value != end_value) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">if</span> (add</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      (value_extractor(*begin_value), uncertainty_extractor(*begin_uncertainty))</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      )</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    ++begin_value;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    ++begin_uncertainty;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  } <span class="comment">// while</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::add_with_uncertainty(VIter, VIter, UIter, VPred, UPred)</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">lar::util::details::FitDataCollector&lt;T, D&gt;::add_with_uncertainty</a></div>
<div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a42748739e7a9f94ec2169f48c08a755a"> 1499</a></span>&#160;  (Iter begin, Iter end)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;{</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_n = <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>();</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  std::for_each(begin, end, [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) { this-&gt;add(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>); });</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>() - old_n;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::add_with_uncertainty(Iter, Iter)</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01509"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9bc3d800d3e435afbcf66d0ff66f6adc"> 1509</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9bc3d800d3e435afbcf66d0ff66f6adc">lar::util::details::FitDataCollector&lt;T, D&gt;::clear</a>() {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  s2.clear();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  x.clear();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  y.clear();</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  y2.clear();</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  xy.clear();</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::clear()</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt; <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Stream&gt;</div>
<div class="line"><a name="l01519"></a><span class="lineno"><a class="line" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9b55ce81a1f76de70228e0298ae54e85"> 1519</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9b55ce81a1f76de70228e0298ae54e85">lar::util::details::FitDataCollector&lt;T, D&gt;::Print</a>(<a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#a9cafae22b6225844ee0cdf5ea57176ff">Stream</a>&amp; out)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  out &lt;&lt; <span class="stringliteral">&quot;Sums  1/s^2=&quot;</span> &lt;&lt; s2.Weights()</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n      x/s^2=&quot;</span> &lt;&lt; x.template SumN&lt;1&gt;();</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = 2; degree &lt;= x.Power; ++degree)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;\n    x^&quot;</span> &lt;&lt; degree &lt;&lt; <span class="stringliteral">&quot;/s^2=&quot;</span> &lt;&lt; x.Sum(degree);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  out</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n      y/s^2=&quot;</span> &lt;&lt; y.Weights()</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n    y^2/s^2=&quot;</span> &lt;&lt; y2.Sum();</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordflow">if</span> (xy.Power &gt;= 1)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;\n     xy/s^2=&quot;</span> &lt;&lt; xy.template SumN&lt;1&gt;();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = 2; degree &lt;= xy.Power; ++degree)</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;\n   x^&quot;</span> &lt;&lt; degree &lt;&lt; <span class="stringliteral">&quot;y/s^2=&quot;</span> &lt;&lt; xy.Sum(degree);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  out &lt;&lt; std::endl;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;} <span class="comment">// FitDataCollector&lt;&gt;::Print()</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">//***  SimplePolyFitterBase&lt;&gt;</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">//***</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01540"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae5e857b88e1c1e5b31e512ba0ed5a34d"> 1540</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae5e857b88e1c1e5b31e512ba0ed5a34d">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::isValid</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">Base_t::N</a>() &gt; (<span class="keywordtype">int</span>) Degree)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    &amp;&amp; std::isnormal(Determinant(MakeMatrixX()));</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::isValid()</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameter</a></div>
<div class="line"><a name="l01548"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104"> 1548</a></span>&#160;  (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>) <span class="keyword">const</span> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;{</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#aed0aabd6756019810d71a249e23433d6">Param</a>(n, MakeMatrixX());</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameter(unsigned int)</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameterError</a></div>
<div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b"> 1556</a></span>&#160;  (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n) <span class="keyword">const</span> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;{</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> (n &gt; Degree) <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(0); <span class="comment">// no parameter, no error</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordflow">return</span> std::sqrt(FitParameterCovariance()[n * (NParams + 1)]);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameterError()</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01564"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21"> 1564</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameters</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;{</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> Xmat = MakeMatrixX();</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> fit_params;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iParam = 0; iParam &lt; NParams; ++iParam)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    fit_params[iParam] = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#aed0aabd6756019810d71a249e23433d6">Param</a>(iParam, Xmat);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordflow">return</span> fit_params;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameters()</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab425fab187edeb678899b16b33be3fbf"> 1576</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab425fab187edeb678899b16b33be3fbf">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameterErrors</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;{</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">return</span> FitParameterErrors(FitParameterCovariance());</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameterErrors()</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a3388e3f7e748ff75fdfe1a0be195c9a0">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameterCovariance</a></div>
<div class="line"><a name="l01585"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a3388e3f7e748ff75fdfe1a0be195c9a0"> 1585</a></span>&#160;  () <span class="keyword">const</span> -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;{</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> Xmat = MakeMatrixX();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> det = Determinant(Xmat);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (!std::isnormal(det)) {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordflow">throw</span> std::range_error</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      (<span class="stringliteral">&quot;SimplePolyFitterBase::FitParameterCovariance(): determinant 0 while fitting&quot;</span>);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">return</span> InvertMatrix(Xmat, det);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameterCovariance()</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba"> 1598</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FillResults</a>(</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params,</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>&amp; det, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  Xmat = MakeMatrixX();</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  det = Determinant(Xmat);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordflow">if</span> (!std::isnormal(det)) {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    Smat.fill(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(0));</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    params.fill(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(0));</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  Smat = InvertMatrix(Xmat, det);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  params = FitParameters(Smat, det);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FillResults(params, matrices, determinant)</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01617"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a92fde7efc54923f04f2bde303c50cd5d"> 1617</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FillResults</a>(</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; paramerrors,</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>&amp; det, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;FillResults(params, Xmat, det, Smat)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  paramerrors = ExtractParameterErrors(Smat);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FillResults(params, errors, matrices, determinant)</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a269888423d79dd5c622505677da5442e"> 1629</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FillResults</a>(</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; params, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a>&amp; paramerrors</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// to compute the parameters, we need all the stuff;</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="comment">// we just keep it local and discard it in the end. Such a waste.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> Xmat, Smat;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> det;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">return</span> FillResults(params, paramerrors, Xmat, det, Smat);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FillResults(params, errors)</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01641"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a5248460746943b74c089d75dbabf2df1"> 1641</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a5248460746943b74c089d75dbabf2df1">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::Evaluate</a>(<a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> x) <span class="keyword">const</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;{</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> params = FitParameters();</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iParam = NParams - 1; <span class="comment">// point to last parameter (highest degree)</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> v = params[iParam];</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">while</span> (iParam &gt; 0) v = v * x + params[--iParam];</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::Evaluate()</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">// --- protected methods follow ---</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a8c15bf4e1cffb5f948e2cc0593b5bf59"> 1654</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a8c15bf4e1cffb5f948e2cc0593b5bf59">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::MakeMatrixX</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;{</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> Xmat;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; NParams; ++i) { <span class="comment">// row</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i; j &lt; NParams; ++j) { <span class="comment">// column</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      Xmat[j * NParams + i] = Xmat[i * NParams + j] = Base_t::XN(i+j);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    } <span class="comment">// for j</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  } <span class="comment">// for i</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">return</span> Xmat;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::MakeMatrixX()</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01668"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#afe61d8fd0065ea31105af6eead27bac3"> 1668</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#afe61d8fd0065ea31105af6eead27bac3">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::MakeMatrixY</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;{</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> Ymat;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; NParams; ++i) Ymat[i] = Base_t::XNY(i);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="keywordflow">return</span> Ymat;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::MakeMatrixY()</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameters</a></div>
<div class="line"><a name="l01679"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa33129a328e8d3152fa6112b4f1f547a"> 1679</a></span>&#160;  (<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat) <span class="keyword">const</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;{</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> fit_params;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iParam = 0; iParam &lt; NParams; ++iParam)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    fit_params[iParam] = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#aed0aabd6756019810d71a249e23433d6">Param</a>(iParam, Xmat);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keywordflow">return</span> fit_params;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameters(FitMatrix_t)</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::FitParameters</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab05ba0fe2b8b86264892da88e396c047"> 1691</a></span>&#160;  (<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Smat, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <span class="comment">/* det */</span>) <span class="keyword">const</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;{</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">return</span> MatrixProduct(Smat, MakeMatrixY());</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameters(FitMatrix_t)</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::Param</a></div>
<div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514"> 1700</a></span>&#160;  (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat) <span class="keyword">const</span> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;{</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">if</span> (n &gt; Degree) <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(0); <span class="comment">// no such a degree, its coefficient is 0</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> detXmat = Determinant(Xmat);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">if</span> (!std::isnormal(detXmat)) {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">throw</span> std::range_error</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      (<span class="stringliteral">&quot;SimplePolyFitterBase::Param(): Determinant 0 while fitting&quot;</span>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#aed0aabd6756019810d71a249e23433d6">Param</a>(n, Xmat, detXmat);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::Param(unsigned int, FitMatrix_t)</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a063a75ce9b914bbe7b9efc6adb7a2e7a">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::ExtractParameterErrors</a></div>
<div class="line"><a name="l01715"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a063a75ce9b914bbe7b9efc6adb7a2e7a"> 1715</a></span>&#160;  (<a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Smat)</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  -&gt; <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;{</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">FitParameters_t</a> fit_errors;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iParam = 0; iParam &lt;= Degree; ++iParam)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    fit_errors[iParam] = std::sqrt(Smat[iParam * (NParams + 1)]);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordflow">return</span> fit_errors;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameterErrors(FitMatrix_t)</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::Param</a></div>
<div class="line"><a name="l01727"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af8c179ba6d0e3586d946555120db590b"> 1727</a></span>&#160;  (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> <span class="keyword">const</span>&amp; Xmat, <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> detXmat) <span class="keyword">const</span> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;{</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">if</span> (n &gt; Degree) <span class="keywordflow">return</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(0); <span class="comment">// no such a degree, its coefficient is 0</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// XYmat is as Xmat...</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">FitMatrix_t</a> XYmat(Xmat);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="comment">// ... except that the N-th column is replaced with { sum x^i y }</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; NParams; ++i)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    XYmat[i * NParams + n] = Base_t::XNY(i);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">return</span> Determinant(XYmat) / detXmat;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::Param(unsigned int, FitMatrix_t, Data_t)</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> D&gt;</div>
<div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae812ba5cd684f8a6c7f8a9217fa32c25"> 1741</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae812ba5cd684f8a6c7f8a9217fa32c25">lar::util::details::SimplePolyFitterBase&lt;T, D&gt;::ChiSquare</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;{</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">// the generic implementation of ChiSquare from sums is complex enough that</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="comment">// I freaked out</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">throw</span> std::logic_error</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    (<span class="stringliteral">&quot;SimplePolyFitterBase::ChiSquare() not implemented for generic fit&quot;</span>);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::ChiSquare()</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">//***  LinearFit&lt;&gt;</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">//***</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01756"></a><span class="lineno"><a class="line" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a5e3a2a3a0b13dde0e958e3cbba67f5db"> 1756</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a5e3a2a3a0b13dde0e958e3cbba67f5db">lar::util::LinearFit&lt;T&gt;::ChiSquare</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;{</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <a class="code" href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1e9cd10f407a1a9386838bdb2bef1f11">FitParameters_t</a> fit_params = this-&gt;FitParameters();</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> b = fit_params[0];</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a> <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a> = fit_params[1];</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">return</span> Y2() + <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a) * X2() + <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(b) * <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#aecc4fdab27471fe2ecf532daa7973511">I</a>()</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    + <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(2) * (a * b * X2() - a * XY() - b * Y());</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;} <span class="comment">// LinearFit&lt;T&gt;::ChiSquare()</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">//***  QuadraticFit&lt;&gt;</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">//***</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01771"></a><span class="lineno"><a class="line" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a950aea2d9a641d91f023752dd436cbac"> 1771</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a950aea2d9a641d91f023752dd436cbac">lar::util::QuadraticFit&lt;T&gt;::ChiSquare</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;{</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a66369cf17abc77f70ba79ece4cb5e6ec">FitParameters_t</a> <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a> = this-&gt;FitParameters();</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keywordflow">return</span> Y2()           - <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(2) *        (a[0]*Y() + a[1]*XY() + a[2]*X2Y())</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;       + <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a[0])*<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#aecc4fdab27471fe2ecf532daa7973511">I</a>()  + <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(2) * a[0] * (           a[1]*<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>()  + a[2]*X2() )</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;       + <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a[1])*X2() + <a class="code" href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">Data_t</a>(2) * a[1] * (                       a[2]*X3() )</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;       + <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a[2])*X4();</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;} <span class="comment">// QuadraticFit&lt;T&gt;::ChiSquare()</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">//***  GaussianFit&lt;&gt;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">//***</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">// data interface</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8">lar::util::GaussianFit&lt;T&gt;::add</a></div>
<div class="line"><a name="l01790"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8"> 1790</a></span>&#160;  (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> x, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> y, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> sy <span class="comment">/* = Data_t(1.0) */</span>)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;{</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordflow">if</span> (y &lt;= <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>(0)) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// ignore the non-positive values</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a> value = EncodeValue(<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">Value_t</a>(y, sy));</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keywordflow">return</span> fitter.add(x, value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">value</a>(), value.<a class="code" href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">error</a>());</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;} <span class="comment">// GaussianFit&lt;T&gt;::add(Data_t, Data_t, Data_t)</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Pred&gt;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">lar::util::GaussianFit&lt;T&gt;::add_without_uncertainty</a></div>
<div class="line"><a name="l01801"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a89137a5a835db5c796668d68f8caab1a"> 1801</a></span>&#160;  (Iter begin, Iter end, Pred extractor)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;{</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">return</span> fitter.add_without_uncertainty(begin, end, Encoder(extractor));</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::add_without_uncertainty(Iter, Iter, Pred)</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="keyword">template</span> &lt;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keyword">typename</span> VIter, <span class="keyword">typename</span> UIter,</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keyword">typename</span> VPred, <span class="keyword">typename</span> UPred</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  &gt;</div>
<div class="line"><a name="l01812"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d"> 1812</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">lar::util::GaussianFit&lt;T&gt;::add_with_uncertainty</a>(</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        VIter begin_value, VIter end_value,</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        UIter begin_uncertainty,</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        VPred value_extractor,</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        UPred uncertainty_extractor <span class="comment">/* = UPred() */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        )</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;{</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">return</span> add_with_uncertainty(</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    begin_value, end_value, begin_uncertainty,</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    Encoder(value_extractor, uncertainty_extractor)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    );</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;} <span class="comment">// GaussianFit&lt;T&gt;::add_with_uncertainty()</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iter&gt;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">lar::util::GaussianFit&lt;T&gt;::add_with_uncertainty</a></div>
<div class="line"><a name="l01829"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a1c2202967cfdd53002f1f0ea4b1cfac2"> 1829</a></span>&#160;  (Iter begin, Iter end)</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;{</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_n = <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>();</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  std::for_each(begin, end, [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) { this-&gt;add(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>); });</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>() - old_n;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;} <span class="comment">// GaussianFit&lt;T&gt;::add_with_uncertainty()</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">// fitting interface</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01841"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a14cfdfe79c0db43c93ed48c1a5c72008"> 1841</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a14cfdfe79c0db43c93ed48c1a5c72008">lar::util::GaussianFit&lt;T&gt;::FitParameters</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">return</span> ConvertParameters(fitter.FitParameters());</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::FitParameters()</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01847"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa3922f3581c63ecd8e144cb2c98a09ef"> 1847</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa3922f3581c63ecd8e144cb2c98a09ef">lar::util::GaussianFit&lt;T&gt;::FitParameterErrors</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> qpars, qparerrors;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="keywordflow">if</span> (!FillResults(qpars, qparerrors)) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      (<span class="stringliteral">&quot;GaussianFit::FitParameterErrors() yielded invalid results&quot;</span>);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="keywordflow">return</span> qparerrors;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::FitParameterErrors()</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01858"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab7cc52876d6e9a87d422334c494c59bf"> 1858</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab7cc52876d6e9a87d422334c494c59bf">lar::util::GaussianFit&lt;T&gt;::FitParameterCovariance</a>() <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;{</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="comment">// we need to go through the whole chain to get the error matrix</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> params;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> Xmat;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> det;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> Smat;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordflow">if</span> (!FillResults(params, Xmat, det, Smat)) {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      (<span class="stringliteral">&quot;GaussianFit::FitParameterCovariance() yielded invalid results&quot;</span>);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordflow">return</span> Smat;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;} <span class="comment">// SimplePolyFitterBase&lt;&gt;::FitParameterCovariance()</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">lar::util::GaussianFit&lt;T&gt;::FillResults</a></div>
<div class="line"><a name="l01875"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#afc28b221d50d43a4c5dd6a136182dd15"> 1875</a></span>&#160;  (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors) <span class="keyword">const</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;{</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> qpars;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> qparerrmat;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> Xmat; <span class="comment">// not used</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> det; <span class="comment">// not used</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">if</span> (!fitter.FillResults(qpars, Xmat, det, qparerrmat)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  ConvertParametersAndErrors(qpars, qparerrmat, params, paramerrors);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordflow">return</span> isValid(params, qpars);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::FillResults()</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01888"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc"> 1888</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">lar::util::GaussianFit&lt;T&gt;::FillResults</a>(</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; det, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> qpars;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> qparerrmat;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="keywordflow">if</span> (!fitter.FillResults(qpars, Xmat, det, qparerrmat)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  ConvertParametersAndErrorMatrix(qpars, qparerrmat, params, Smat);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">return</span> isValid(params, qpars);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;} <span class="comment">// GaussianFit::FillResults()</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01900"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aab8d5ad26acd1f70796145d670117da9"> 1900</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">lar::util::GaussianFit&lt;T&gt;::FillResults</a>(</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors,</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Xmat, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; det, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="keywordflow">if</span> (!FillResults(params, Xmat, det, Smat)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  paramerrors = fitter.ExtractParameterErrors(Smat);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;} <span class="comment">// GaussianFit::FillResults()</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01911"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8eb9ed6ca0ce71404abb7795fe2584b0"> 1911</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69">lar::util::GaussianFit&lt;T&gt;::Evaluate</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> x, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <span class="keyword">const</span>* params)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  -&gt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a> = (x - params[1]) / params[2];</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="keywordflow">return</span> params[0] * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-0.5*<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(z));</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::Evaluate()</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01920"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#accbd51441925c44762cdfe61e8a5c0b5"> 1920</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#accbd51441925c44762cdfe61e8a5c0b5">lar::util::GaussianFit&lt;T&gt;::ConvertParameters</a>(<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  -&gt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> params;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> sigma2 = -0.5 / qpars[2]; <span class="comment">// sigma^2 = -1 / (2 a2)</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  params[2] = std::sqrt(sigma2); <span class="comment">// sigma</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  params[1] = sigma2 * qpars[1]; <span class="comment">// mean = sigma2 a1</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  params[0] = <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(qpars[0] - 0.25 * <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(qpars[1])/qpars[2]);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="keywordflow">return</span> params;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::ConvertParameters()</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01938"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac4f73deb07279f689bce3dda5a5538ff"> 1938</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac4f73deb07279f689bce3dda5a5538ff">lar::util::GaussianFit&lt;T&gt;::ConvertParametersAndVariances</a>(</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramvariances</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  )</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;{</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  params = ConvertParameters(qpars);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>     = qpars;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>     = params[0];</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#aabaa33ebc7d74aa4b215e94bc8a9897e">mu</a>    = params[1];</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; sigma = params[2];</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="comment">// error on sigma</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  paramvariances[2] = qparerrmat[3 * 2 + 2] / <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(<a class="code" href="../../d4/d95/PointIsolationAlgStress__test_8cc.html#a01fbff193985cc6e5ccd769e2f9656b1">cube</a>(sigma));</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="comment">// error on mu</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  paramvariances[1] = <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(mu * (</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    +    qparerrmat[3 * 1 + 1] / <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a[1])</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    - 2.*qparerrmat[3 * 2 + 1] / (a[1]*a[2])</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    +    qparerrmat[3 * 2 + 2] / <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(a[2])</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    ));</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="comment">// error on A</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  paramvariances[0] = <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(A * (</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    +     qparerrmat[3 * 0 + 0]</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    +  2.*qparerrmat[3 * 0 + 1]  * mu</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    +(    qparerrmat[3 * 1 + 1]</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;     + 2.*qparerrmat[3 * 0 + 2]) * <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(mu)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    +  2.*qparerrmat[3 * 1 + 2]  * <a class="code" href="../../d4/d95/PointIsolationAlgStress__test_8cc.html#a01fbff193985cc6e5ccd769e2f9656b1">cube</a>(mu)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    +     qparerrmat[3 * 2 + 2]  * <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(mu))</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    ));</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::ConvertParametersAndVariances()</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01974"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3e3c7d969786c42683414b1844c0cf93"> 1974</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3e3c7d969786c42683414b1844c0cf93">lar::util::GaussianFit&lt;T&gt;::ConvertParametersAndErrors</a>(</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; paramerrors</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  )</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;{</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  ConvertParametersAndVariances(qpars, qparerrmat, params, paramerrors);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// paramerrors actually stores the square of the error; fix it:</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>&amp; paramerror: paramerrors) paramerror = std::sqrt(paramerror);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::ConvertParametersAndErrors()</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01986"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aac76f73d1302f626d32ef2180890db84"> 1986</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aac76f73d1302f626d32ef2180890db84">lar::util::GaussianFit&lt;T&gt;::ConvertParametersAndErrorMatrix</a>(</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a> <span class="keyword">const</span>&amp; qparerrmat,</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">FitMatrix_t</a>&amp; Smat</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  )</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;{</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> paramvariances;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  ConvertParametersAndVariances(qpars, qparerrmat, params, paramvariances);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="comment">// let&#39;s call things with their names</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>     = qpars;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>     = params[0];</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#aabaa33ebc7d74aa4b215e94bc8a9897e">mu</a>    = params[1];</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>          <span class="keyword">const</span>&amp; sigma = params[2];</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="comment">// variance on sigma</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  Smat[3 * 2 + 2] = paramvariances[2];</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="comment">// variance on mu</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  Smat[3 * 1 + 1] = paramvariances[1];</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="comment">// variance on A</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  Smat[3 * 0 + 0] = paramvariances[0];</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="comment">// covariance on sigma and mu</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  Smat[3 * 1 + 2] = Smat[3 * 2 + 1]</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    = (qparerrmat[3 * 1 + 2] + 2 * mu * qparerrmat[3 * 2 + 2]) / sigma;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">// this is the sum of the derivatives of A vs. all a parameters, each one</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">// multiplied by the covariance of that parameter with a2</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> dA_dak_cov_aka2 = A * (</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        qparerrmat[3 * 0 + 2]</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      + qparerrmat[3 * 1 + 2] * mu</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      + qparerrmat[3 * 2 + 2] * <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(mu)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    );</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">// covariance on A and sigma</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  Smat[3 * 0 + 2] = Smat[3 * 2 + 0]</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    = dA_dak_cov_aka2 / <a class="code" href="../../d4/d95/PointIsolationAlgStress__test_8cc.html#a01fbff193985cc6e5ccd769e2f9656b1">cube</a>(sigma);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="comment">// this other is the same as dA_dak_cov_aka2, but for a1</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a> dA_dak_cov_aka1 = A * (</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        qparerrmat[3 * 0 + 1]</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      + qparerrmat[3 * 1 + 1] * mu</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      + qparerrmat[3 * 2 + 1] * <a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(mu)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    );</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="comment">// covariance on A and mu</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  Smat[3 * 0 + 1] = Smat[3 * 1 + 0] = mu *</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    (dA_dak_cov_aka1 / a[1] - dA_dak_cov_aka2 / a[2]);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::ConvertParametersAndErrors()</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f6a4b59feda3dc4f21275ba417c5d5b">lar::util::GaussianFit&lt;T&gt;::isValid</a></div>
<div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#acd4a3b3e072176b54b1cc947518c5cc1"> 2040</a></span>&#160;  (<a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; params, <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">FitParameters_t</a> <span class="keyword">const</span>&amp; qpars)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;{</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">return</span> (qpars[2] &lt; <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>(0)) &amp;&amp; (params[0] &gt;= <a class="code" href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">Data_t</a>(0));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;} <span class="comment">// GaussianFit&lt;&gt;::isValid(FitParameters_t)</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="preprocessor">#endif // SIMPLEFITS_H</span></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_ae127d0760150b1e158b8c4853c644dad"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ae127d0760150b1e158b8c4853c644dad">lar::util::details::SimpleFitterInterface::cube</a></div><div class="ttdeci">static constexpr Data_t cube(Data_t v)</div><div class="ttdoc">Returns the cube of the specified data value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00610">SimpleFits.h:610</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_html"><div class="ttname"><a href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html">lar::util::GaussianFit::EncodeExtractor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01315">SimpleFits.h:1315</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1WeightTracker_html_ac38af994023dd3e09ec4df16c83eba09"><div class="ttname"><a href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#ac38af994023dd3e09ec4df16c83eba09">lar::util::details::WeightTracker::Weights</a></div><div class="ttdeci">Weight_t Weights() const </div><div class="ttdoc">Returns the sum of the weights. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00062">StatCollector.h:62</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a149d21659c5f5ef5198bbb76ec73448c"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a149d21659c5f5ef5198bbb76ec73448c">lar::util::details::FitDataCollector::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Iter begin, Iter end)</div><div class="ttdoc">Adds measurements from a sequence, with no uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00135">SimpleFits.h:135</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_aecc4fdab27471fe2ecf532daa7973511"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#aecc4fdab27471fe2ecf532daa7973511">I</a></div><div class="ttdeci">see a below echo or echo I(indirect symbol).'echo&quot; If the symbol is local (non-external)</div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ada7b0f01aac6feb17ed089c7059327a0"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ada7b0f01aac6feb17ed089c7059327a0">lar::util::details::SimplePolyFitterBase::NParams</a></div><div class="ttdeci">static constexpr unsigned int NParams</div><div class="ttdoc">Number of parameters in the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00651">SimpleFits.h:651</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a8dbfa4229999e183dde5bd4533b301e1"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a8dbfa4229999e183dde5bd4533b301e1">lar::util::details::FitDataCollector::NParams</a></div><div class="ttdeci">static constexpr unsigned int NParams</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00074">SimpleFits.h:74</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a1bcda569b4c46c16da384062f0e4a266"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1bcda569b4c46c16da384062f0e4a266">lar::util::QuadraticFit::X4</a></div><div class="ttdeci">Data_t X4() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00991">SimpleFits.h:991</a></div></div>
<div class="ttc" id="namespacepmtana_html_a9860e62c78db1dd9c7d635a2832b883a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">pmtana::std</a></div><div class="ttdeci">double std(const std::vector&lt; short &gt; &amp;wf, const double ped_mean, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00042">UtilFunc.cxx:42</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_af425a07c655332d711b5ebbb31b1c456"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af425a07c655332d711b5ebbb31b1c456">lar::util::details::SimplePolyFitterDataBase::add</a></div><div class="ttdeci">bool add(MeasurementAndUncertainty_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00372">SimpleFits.h:372</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ae812ba5cd684f8a6c7f8a9217fa32c25"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae812ba5cd684f8a6c7f8a9217fa32c25">lar::util::details::SimplePolyFitterBase::ChiSquare</a></div><div class="ttdeci">virtual Data_t ChiSquare() const override</div><div class="ttdoc">Returns the  of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01741">SimpleFits.h:1741</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a45d61916db41f358569ca76d77a09501"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a45d61916db41f358569ca76d77a09501">lar::util::details::SimplePolyFitterDataBase::Degree</a></div><div class="ttdeci">static constexpr unsigned int Degree</div><div class="ttdoc">Degree of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00349">SimpleFits.h:349</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1WeightTracker_html_a0ea887fc54de99e26df4acd9365389ad"><div class="ttname"><a href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#a0ea887fc54de99e26df4acd9365389ad">lar::util::details::WeightTracker::N</a></div><div class="ttdeci">int N() const </div><div class="ttdoc">Returns the number of entries added. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00059">StatCollector.h:59</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a7f5f89da4d9e8eb6d8dc6895cae02639"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a7f5f89da4d9e8eb6d8dc6895cae02639">lar::util::LinearFit::InterceptError</a></div><div class="ttdeci">Data_t InterceptError() const </div><div class="ttdoc">Returns the error on intercept of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00891">SimpleFits.h:891</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_abd3e077bae3e45c414127589c60d8989"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd3e077bae3e45c414127589c60d8989">lar::util::details::SimplePolyFitterDataBase::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(Iter begin, Iter end)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00411">SimpleFits.h:411</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_ae31c12099db42fe59398a3a8a04ace03"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ae31c12099db42fe59398a3a8a04ace03">lar::util::details::FitDataCollector::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(VIter begin_value, VIter end_value, UIter begin_uncertainty, VPred value_extractor, UPred uncertainty_extractor=UPred())</div><div class="ttdoc">Adds measurements with uncertainties from a sequence. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01477">SimpleFits.h:1477</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_ac610ac111a4363cc4d363574092c5b5b"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac610ac111a4363cc4d363574092c5b5b">lar::util::details::SimplePolyFitterDataBase::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Iter begin, Iter end)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00377">SimpleFits.h:377</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a81e7535f0f47af4ecd43de2bcc5c41a8"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a81e7535f0f47af4ecd43de2bcc5c41a8">lar::util::GaussianFit::add</a></div><div class="ttdeci">bool add(Data_t x, Data_t y, Data_t sy=Data_t(1.0))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01790">SimpleFits.h:1790</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_aa9118bfb5db20357abab8e8cc12e800f"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa9118bfb5db20357abab8e8cc12e800f">lar::util::GaussianFit::Data_t</a></div><div class="ttdeci">typename Base_t::Data_t Data_t</div><div class="ttdoc">type of the data </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01026">SimpleFits.h:1026</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_abf6938c3e80be0da03f634b27c11f537"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abf6938c3e80be0da03f634b27c11f537">lar::util::details::SimplePolyFitterDataBase::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(VIter begin_value, VIter end_value, UIter begin_uncertainty, VPred value_extractor, UPred uncertainty_extractor=UPred())</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00397">SimpleFits.h:397</a></div></div>
<div class="ttc" id="namespacetest__msg_html_a79cb67e67dd7c11ad227880f7bd5625a"><div class="ttname"><a href="../../d8/d79/namespacetest__msg.html#a79cb67e67dd7c11ad227880f7bd5625a">test_msg.error</a></div><div class="ttdeci">error</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/larcorealg_2test_2GeoAlgo_2test__msg_8py_source.html#l00032">larcorealg/test/GeoAlgo/test_msg.py:32</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a08bf827c2a4f88030c025064483ed59a"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a08bf827c2a4f88030c025064483ed59a">lar::util::details::SimpleFitterInterface::FitParameterErrors</a></div><div class="ttdeci">virtual FitParameters_t FitParameterErrors() const =0</div><div class="ttdoc">Computes and returns all the parameter errors of the fit result. </div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_ade3dcb77d39f876e6f42f72b3f40a63a"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ade3dcb77d39f876e6f42f72b3f40a63a">lar::util::details::SimpleFitterInterface::InvertMatrix</a></div><div class="ttdeci">virtual FitMatrix_t InvertMatrix(FitMatrix_t const &amp;mat, Data_t det) const </div><div class="ttdoc">Computes the inverse of a matrix (using provided determinant) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00620">SimpleFits.h:620</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a46867798e05c9bfa39753abfaf75000b"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a46867798e05c9bfa39753abfaf75000b">lar::util::details::SimplePolyFitterBase::FitParameterError</a></div><div class="ttdeci">virtual Data_t FitParameterError(unsigned int n) const override</div><div class="ttdoc">Returns the error on parameter n of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01556">SimpleFits.h:1556</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_ae5a969956136114896c3b079df978eb1"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ae5a969956136114896c3b079df978eb1">lar::util::details::SimplePolyFitterDataBase::XN</a></div><div class="ttdeci">Data_t XN(unsigned int n) const </div><div class="ttdoc">Returns the weighted sum of x^n. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00447">SimpleFits.h:447</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a6d268d6f084a6f0e5d7f524304db557c"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6d268d6f084a6f0e5d7f524304db557c">lar::util::details::SimpleFitterInterface::FitParameterCovariance</a></div><div class="ttdeci">virtual FitMatrix_t FitParameterCovariance() const =0</div><div class="ttdoc">Computes and returns all the covariance matrix of the fit result. </div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FastMatrixOperations_html_ad29d6a2ce302b7d345fa1f1755b7af73"><div class="ttname"><a href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#ad29d6a2ce302b7d345fa1f1755b7af73">lar::util::details::FastMatrixOperations::Determinant</a></div><div class="ttdeci">static Data_t Determinant(Matrix_t const &amp;mat)</div><div class="ttdoc">Computes the determinant of a matrix. </div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_a52698435c32530e705692355c12429b5"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a52698435c32530e705692355c12429b5">lar::util::GaussianFit::Value_t::error</a></div><div class="ttdeci">constexpr Data_t error() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01256">SimpleFits.h:1256</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_html_a4fef08fdef0fd3d2884b4d8f94d17c3b"><div class="ttname"><a href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a4fef08fdef0fd3d2884b4d8f94d17c3b">lar::util::GaussianFit::EncodeExtractor::operator()</a></div><div class="ttdeci">auto operator()(Elem elem)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01323">SimpleFits.h:1323</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a3e7f08c98bb23604598d94dc44efbd37"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e7f08c98bb23604598d94dc44efbd37">lar::util::details::SimpleFitterInterface::operator()</a></div><div class="ttdeci">Data_t operator()(Data_t x) const </div><div class="ttdoc">Evaluates the fitted function; alias of Evaluate() </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00603">SimpleFits.h:603</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a1492f85d4cba91b82298a105e4889bb8"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a1492f85d4cba91b82298a105e4889bb8">lar::util::details::SimpleFitterInterface::FitParameterError</a></div><div class="ttdeci">virtual Data_t FitParameterError(unsigned int n) const </div><div class="ttdoc">Returns the error on parameter n of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00533">SimpleFits.h:533</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a8cae9e596a0ecc842d73928ea19350f7"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a8cae9e596a0ecc842d73928ea19350f7">lar::util::details::SimplePolyFitterDataBase::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00389">SimpleFits.h:389</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a91d58d85ea54d3bd41dd3f4959d75d15"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a91d58d85ea54d3bd41dd3f4959d75d15">lar::util::GaussianFit::ThrowNotImplemented</a></div><div class="ttdeci">static void ThrowNotImplemented(std::string method)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01425">SimpleFits.h:1425</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a9d78d4ffd495c6c3acd7ed6b57eed8c8"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9d78d4ffd495c6c3acd7ed6b57eed8c8">lar::util::details::FitDataCollector::XN</a></div><div class="ttdeci">Data_t XN(unsigned int n) const </div><div class="ttdoc">Returns the weighted sum of x^n. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00287">SimpleFits.h:287</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_aaf745e87eced248679b444c3f46555ba"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aaf745e87eced248679b444c3f46555ba">lar::util::details::SimplePolyFitterBase::FillResults</a></div><div class="ttdeci">bool FillResults(FitParameters_t &amp;params, FitMatrix_t &amp;Xmat, Data_t &amp;det, FitMatrix_t &amp;Smat) const override</div><div class="ttdoc">Fills the specified parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01598">SimpleFits.h:1598</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a44f5b4df159e9690a32ce3d3474460e8"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a44f5b4df159e9690a32ce3d3474460e8">lar::util::GaussianFit::NParams</a></div><div class="ttdeci">static constexpr unsigned int NParams</div><div class="ttdoc">Number of parameters in the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01024">SimpleFits.h:1024</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a28bf5ae226ecb32f9d77e8ff3122c8b0"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a28bf5ae226ecb32f9d77e8ff3122c8b0">lar::util::details::FitDataCollector::XN</a></div><div class="ttdeci">Data_t XN() const </div><div class="ttdoc">Returns the weighted sum of x^N. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00297">SimpleFits.h:297</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a2a3fb9bf968aeff83bfc0d8dde6ec1a3"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a2a3fb9bf968aeff83bfc0d8dde6ec1a3">lar::util::details::SimplePolyFitterDataBase::Data_t</a></div><div class="ttdeci">typename Collector_t::Data_t Data_t</div><div class="ttdoc">type of the data </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00351">SimpleFits.h:351</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1WeightTracker_html_a21cf0e4be6cfbf1fac2b2a5650f5500c"><div class="ttname"><a href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html#a21cf0e4be6cfbf1fac2b2a5650f5500c">lar::util::details::WeightTracker::AverageWeight</a></div><div class="ttdeci">Weight_t AverageWeight() const </div><div class="ttdoc">Returns the arithmetic average of the weights. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00841">StatCollector.h:841</a></div></div>
<div class="ttc" id="PMTconfigurationExtraction__module_8cc_html_ac33ee765f5ad9f134540bac393721cfe"><div class="ttname"><a href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a></div><div class="ttdeci">get()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d87/PMTconfigurationExtraction__module_8cc_source.html#l00168">PMTconfigurationExtraction_module.cc:168</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a17c3417bb84bd323dacd81f2dbc63cb2"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a17c3417bb84bd323dacd81f2dbc63cb2">lar::util::GaussianFit::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(Cont cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01092">SimpleFits.h:1092</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a1f7b06960ec67ad2da1032cee9cc4409"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a1f7b06960ec67ad2da1032cee9cc4409">lar::util::QuadraticFit::FitMatrix_t</a></div><div class="ttdeci">std::array&lt; Data_t, sqr(NParams)&gt; FitMatrix_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00971">SimpleFits.h:971</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a2deb48c1ead85214b38c9565b7e9ed8d"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a2deb48c1ead85214b38c9565b7e9ed8d">lar::util::GaussianFit::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(VIter begin_value, VIter end_value, UIter begin_uncertainty, VPred value_extractor, UPred uncertainty_extractor=UPred())</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01812">SimpleFits.h:1812</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_html_a2e6850c298c2d7577a595f508df6ea74"><div class="ttname"><a href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a2e6850c298c2d7577a595f508df6ea74">lar::util::GaussianFit::EncodeExtractor::EncodeExtractor</a></div><div class="ttdeci">EncodeExtractor(VPred &amp;vpred, UPred &amp;upred)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01316">SimpleFits.h:1316</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a039e303e0f690f7fffd3f472a267e468"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a039e303e0f690f7fffd3f472a267e468">lar::util::details::FitDataCollector::UncertaintyToWeight</a></div><div class="ttdeci">static Data_t UncertaintyToWeight(Data_t s)</div><div class="ttdoc">Transforms an uncertainty into a weight ( ) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00317">SimpleFits.h:317</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html">lar::util::GaussianFit::Value_t</a></div><div class="ttdoc">&amp;lt; type of value and error </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01248">SimpleFits.h:1248</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a5d81341ab4870034823963a45b995b3e"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5d81341ab4870034823963a45b995b3e">lar::util::details::SimpleFitterInterface::FitParameters</a></div><div class="ttdeci">virtual FitParameters_t FitParameters() const =0</div><div class="ttdoc">Computes and returns all the parameters of the fit result. </div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a3e5c8d99d2caf110f42dddbba2501e5e"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3e5c8d99d2caf110f42dddbba2501e5e">lar::util::details::SimpleFitterInterface::sqr</a></div><div class="ttdeci">static constexpr Data_t sqr(Data_t v)</div><div class="ttdoc">Returns the square of the specified data value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00607">SimpleFits.h:607</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a4a449166ad96fcd28c44ce5182a7c0b2"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a4a449166ad96fcd28c44ce5182a7c0b2">lar::util::details::FitDataCollector::y</a></div><div class="ttdeci">WeightTracker&lt; Data_t &gt; y</div><div class="ttdoc">accumulator for y </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00329">SimpleFits.h:329</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ac4f73deb07279f689bce3dda5a5538ff"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac4f73deb07279f689bce3dda5a5538ff">lar::util::GaussianFit::ConvertParametersAndVariances</a></div><div class="ttdeci">static void ConvertParametersAndVariances(FitParameters_t const &amp;qpars, FitMatrix_t const &amp;qparerrmat, FitParameters_t &amp;params, FitParameters_t &amp;paramvariances)</div><div class="ttdoc">Converts the specified quadratic fit parameters and errors. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01938">SimpleFits.h:1938</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_aa699fcf9f17e6ba01bf98d74c77991ca"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aa699fcf9f17e6ba01bf98d74c77991ca">lar::util::QuadraticFit::Y2</a></div><div class="ttdeci">Data_t Y2() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00995">SimpleFits.h:995</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a5a30e5b3bf19b38747341dc2f94aa69a"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a5a30e5b3bf19b38747341dc2f94aa69a">lar::util::details::SimpleFitterInterface&lt; T, D+1 &gt;::Data_t</a></div><div class="ttdeci">T Data_t</div><div class="ttdoc">type of the data </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00464">SimpleFits.h:464</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a3f712f3b4f6d75ccba0ccec5a86d7212"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3f712f3b4f6d75ccba0ccec5a86d7212">lar::util::GaussianFit::ChiSquare</a></div><div class="ttdeci">virtual Data_t ChiSquare() const override</div><div class="ttdoc">Returns the  of the original fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01161">SimpleFits.h:1161</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a0e15e48ab3008b47d66f496b1fb22104"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a0e15e48ab3008b47d66f496b1fb22104">lar::util::details::SimplePolyFitterBase::FitParameter</a></div><div class="ttdeci">virtual Data_t FitParameter(unsigned int n) const override</div><div class="ttdoc">Returns the parameter n of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01548">SimpleFits.h:1548</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ab72e76f690dca900d6d8fdeeda49c514"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab72e76f690dca900d6d8fdeeda49c514">lar::util::details::SimplePolyFitterBase::Param</a></div><div class="ttdeci">virtual Data_t Param(unsigned int n, FitMatrix_t const &amp;Xmat) const </div><div class="ttdoc">Computes a single fit parameter using the given information. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01700">SimpleFits.h:1700</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a3d9be0c8d4964334103140c74d9790be"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3d9be0c8d4964334103140c74d9790be">lar::util::GaussianFit::add</a></div><div class="ttdeci">bool add(Measurement_t value, Data_t sy=Data_t(1.0))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01050">SimpleFits.h:1050</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ab425fab187edeb678899b16b33be3fbf"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ab425fab187edeb678899b16b33be3fbf">lar::util::details::SimplePolyFitterBase::FitParameterErrors</a></div><div class="ttdeci">virtual FitParameters_t FitParameterErrors() const override</div><div class="ttdoc">Computes and returns all the parameter errors of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01576">SimpleFits.h:1576</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ac55a2bbf73bb5d200ee2614f3c802fad"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac55a2bbf73bb5d200ee2614f3c802fad">lar::util::GaussianFit::EncodeValue</a></div><div class="ttdeci">static Value_t EncodeValue(Data_t value, Data_t error)</div><div class="ttdoc">Converts a value and error into a proper input for the quadratic fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01272">SimpleFits.h:1272</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html">lar::util::details::FitDataCollector</a></div><div class="ttdoc">Class providing data collection for the simple polynomial fitters. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00037">SimpleFits.h:37</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a4a79a841dc6a4ee7caebcfc04c4767fe"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a4a79a841dc6a4ee7caebcfc04c4767fe">lar::util::GaussianFit::FitMatrix_t</a></div><div class="ttdeci">typename Fitter_t::FitMatrix_t FitMatrix_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01036">SimpleFits.h:1036</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_abcee99c58b01642177b6c7a5a0c88eb2"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#abcee99c58b01642177b6c7a5a0c88eb2">lar::util::details::FitDataCollector::sqr</a></div><div class="ttdeci">static constexpr V sqr(V const &amp;v)</div><div class="ttdoc">Returns the square of the specified value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00283">SimpleFits.h:283</a></div></div>
<div class="ttc" id="selectors_8fcl_html_aabaa33ebc7d74aa4b215e94bc8a9897e"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#aabaa33ebc7d74aa4b215e94bc8a9897e">mu</a></div><div class="ttdeci">pdgs mu</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_aa3922f3581c63ecd8e144cb2c98a09ef"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aa3922f3581c63ecd8e144cb2c98a09ef">lar::util::GaussianFit::FitParameterErrors</a></div><div class="ttdeci">virtual FitParameters_t FitParameterErrors() const override</div><div class="ttdoc">Computes and returns all the parameter errors of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01847">SimpleFits.h:1847</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_aedf9cfa1cc9a4555be8e166bef57ac42"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aedf9cfa1cc9a4555be8e166bef57ac42">lar::util::GaussianFit::Value_t::Base_t</a></div><div class="ttdeci">std::tuple&lt; Data_t, Data_t &gt; Base_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01249">SimpleFits.h:1249</a></div></div>
<div class="ttc" id="StatCollector_8h_html"><div class="ttname"><a href="../../df/d87/StatCollector_8h.html">StatCollector.h</a></div><div class="ttdoc">Classes gathering simple statistics. </div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a99bd817c34f06f535f974e68e47ea84f"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a99bd817c34f06f535f974e68e47ea84f">lar::util::LinearFit::FitMatrix_t</a></div><div class="ttdeci">std::array&lt; Data_t, sqr(NParams)&gt; FitMatrix_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00867">SimpleFits.h:867</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FastMatrixOperations_html_a7e51e12fd87a611610e3165f03a331ec"><div class="ttname"><a href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#a7e51e12fd87a611610e3165f03a331ec">lar::util::details::FastMatrixOperations::InvertSymmetricMatrix</a></div><div class="ttdeci">static Matrix_t InvertSymmetricMatrix(Matrix_t const &amp;mat, Data_t det)</div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a503408a5316325f66b0a2b35243a61b4"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a503408a5316325f66b0a2b35243a61b4">lar::util::details::FitDataCollector::y2</a></div><div class="ttdeci">DataTracker&lt; 1, Data_t &gt; y2</div><div class="ttdoc">accumulator for y2 </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00330">SimpleFits.h:330</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ac1cd3eb680bd5c9aff08a7bfa55ed9a3"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac1cd3eb680bd5c9aff08a7bfa55ed9a3">lar::util::GaussianFit::N</a></div><div class="ttdeci">int N() const </div><div class="ttdoc">Returns the number of (valid) points added. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01100">SimpleFits.h:1100</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ae2cc5f755c18d47429824d8792f734dc"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae2cc5f755c18d47429824d8792f734dc">lar::util::GaussianFit::FillResults</a></div><div class="ttdeci">virtual bool FillResults(FitParameters_t &amp;params, FitMatrix_t &amp;Xmat, Data_t &amp;det, FitMatrix_t &amp;Smat) const override</div><div class="ttdoc">Fills the specified parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01888">SimpleFits.h:1888</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_a93578b4e19115a4715fe140bfb3a80b9"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a93578b4e19115a4715fe140bfb3a80b9">lar::util::GaussianFit::Value_t::Value_t</a></div><div class="ttdeci">Value_t(Data_t v, Data_t e)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01251">SimpleFits.h:1251</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1WeightTracker_html"><div class="ttname"><a href="../../db/d57/classlar_1_1util_1_1details_1_1WeightTracker.html">lar::util::details::WeightTracker</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00048">StatCollector.h:48</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a5ecf0a1ebde715c54df255f3ba48fb58"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a5ecf0a1ebde715c54df255f3ba48fb58">lar::util::details::FitDataCollector::add</a></div><div class="ttdeci">bool add(MeasurementAndUncertainty_t value)</div><div class="ttdoc">Adds one entry with specified x, y and uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00118">SimpleFits.h:118</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html">lar::util::LinearFit</a></div><div class="ttdoc">Performs a linear regression of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00849">SimpleFits.h:849</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a8a81b255dd75fc336b7ccc38502ef1be"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a8a81b255dd75fc336b7ccc38502ef1be">lar::util::LinearFit::I</a></div><div class="ttdeci">Data_t I() const </div><div class="ttdoc">Aliases. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00920">SimpleFits.h:920</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_adcaa57cba5e79b3944afcd1dec42f73e"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#adcaa57cba5e79b3944afcd1dec42f73e">lar::util::GaussianFit::EncodeValue</a></div><div class="ttdeci">static Measurement_t EncodeValue(Measurement_t const &amp;meas)</div><div class="ttdoc">Converts a value and error into a proper input for the quadratic fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01289">SimpleFits.h:1289</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1DataTracker_html_abc738b4b828c01db8821c0c5e4653b05"><div class="ttname"><a href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html#abc738b4b828c01db8821c0c5e4653b05">lar::util::details::DataTracker::Sum</a></div><div class="ttdeci">Weight_t Sum(unsigned int n) const </div><div class="ttdoc">Returns the sum of the values to the power n (1 &amp;lt;= n &amp;lt;= 2, no check) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00124">StatCollector.h:124</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a483618f5c31f72f3545c681c783dbbac"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a483618f5c31f72f3545c681c783dbbac">lar::util::details::SimplePolyFitterDataBase::XNY</a></div><div class="ttdeci">Data_t XNY(unsigned int n) const </div><div class="ttdoc">Returns the weighted sum of x^n y. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00450">SimpleFits.h:450</a></div></div>
<div class="ttc" id="decode__signalprocess__icarus_8fcl_html_a2a105cb669129f9c63eb7a4c15bf2d9b"><div class="ttname"><a href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a></div><div class="ttdeci">process_name gaushit a</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/decode__signalprocess__icarus_8fcl_source.html#l00037">decode_signalprocess_icarus.fcl:37</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a8c15bf4e1cffb5f948e2cc0593b5bf59"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a8c15bf4e1cffb5f948e2cc0593b5bf59">lar::util::details::SimplePolyFitterBase::MakeMatrixX</a></div><div class="ttdeci">virtual FitMatrix_t MakeMatrixX() const </div><div class="ttdoc">Fills and returns the matrix of x^n sum coefficients ( { x^(i+j) } ) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01654">SimpleFits.h:1654</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a30464f5f8447e3d8ebd40e7241bdc9cc"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a30464f5f8447e3d8ebd40e7241bdc9cc">lar::util::details::SimplePolyFitterDataBase::MeasurementAndUncertainty_t</a></div><div class="ttdeci">typename Collector_t::MeasurementAndUncertainty_t MeasurementAndUncertainty_t</div><div class="ttdoc">type of measurement with uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00358">SimpleFits.h:358</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_html_ac0c74ee598f1a08dd080878730881e53"><div class="ttname"><a href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#ac0c74ee598f1a08dd080878730881e53">lar::util::GaussianFit::EncodeExtractor::error_extractor</a></div><div class="ttdeci">UPred &amp; error_extractor</div><div class="ttdoc">uncertainty extractor </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01333">SimpleFits.h:1333</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_aa47c53891635ba0c368f25e097be62c6"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#aa47c53891635ba0c368f25e097be62c6">lar::util::details::FitDataCollector::XNY</a></div><div class="ttdeci">Data_t XNY() const </div><div class="ttdoc">Returns the weighted sum of x^N y. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00302">SimpleFits.h:302</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_aa844e97b67fbb15e0c3eeda2c90ef515"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aa844e97b67fbb15e0c3eeda2c90ef515">lar::util::details::SimplePolyFitterBase::Data_t</a></div><div class="ttdeci">typename Base_t::Data_t Data_t</div><div class="ttdoc">type of the data </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00653">SimpleFits.h:653</a></div></div>
<div class="ttc" id="FastMatrixMathHelper_8h_html"><div class="ttname"><a href="../../dc/d0e/FastMatrixMathHelper_8h.html">FastMatrixMathHelper.h</a></div><div class="ttdoc">Classes with hard-coded (hence &amp;quot;fast&amp;quot;) matrix math. </div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_ac4d1e5c9f8997e754f1ff8419f5555af"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#ac4d1e5c9f8997e754f1ff8419f5555af">lar::util::LinearFit::Slope</a></div><div class="ttdeci">Data_t Slope() const </div><div class="ttdoc">Returns the slope of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00884">SimpleFits.h:884</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a5f510fe6d0cac9f3bd45b3eef1d4db1e"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f510fe6d0cac9f3bd45b3eef1d4db1e">lar::util::GaussianFit::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01072">SimpleFits.h:1072</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a760c6d6ce0e04ee905d1c06723fcab08"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a760c6d6ce0e04ee905d1c06723fcab08">lar::util::GaussianFit::DecodeValue</a></div><div class="ttdeci">static Value_t DecodeValue(Value_t const &amp;value)</div><div class="ttdoc">Converts a value from the quadratic fit into a proper value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01282">SimpleFits.h:1282</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_ab084657b6ccb739647ad9cbd13d7324c"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ab084657b6ccb739647ad9cbd13d7324c">lar::util::details::SimpleFitterInterface::InvertMatrix</a></div><div class="ttdeci">virtual FitMatrix_t InvertMatrix(FitMatrix_t const &amp;mat) const </div><div class="ttdoc">Computes the inverse of a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00624">SimpleFits.h:624</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a7171bc20f34cc335ec48c7f2e2615e6f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a></div><div class="ttdeci">BEGIN_PROLOG V</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_ad91db52e3c42b241530d6b7017f3f1d5"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad91db52e3c42b241530d6b7017f3f1d5">lar::util::details::FitDataCollector::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(Cont cont)</div><div class="ttdoc">Adds measurements with uncertainties from a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00254">SimpleFits.h:254</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_accbd51441925c44762cdfe61e8a5c0b5"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#accbd51441925c44762cdfe61e8a5c0b5">lar::util::GaussianFit::ConvertParameters</a></div><div class="ttdeci">static FitParameters_t ConvertParameters(FitParameters_t const &amp;qpars)</div><div class="ttdoc">Converts the specified quadratic fit parameters into Gaussian. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01920">SimpleFits.h:1920</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_abd1e361440cfbcf3c4834a7dc043f12e"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#abd1e361440cfbcf3c4834a7dc043f12e">lar::util::details::SimplePolyFitterDataBase::N</a></div><div class="ttdeci">int N() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00427">SimpleFits.h:427</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FastMatrixOperations_html"><div class="ttname"><a href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html">lar::util::details::FastMatrixOperations</a></div><div class="ttdoc">Provides &amp;quot;fast&amp;quot; matrix operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d0e/FastMatrixMathHelper_8h_source.html#l00087">FastMatrixMathHelper.h:87</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_ad88abb941befa28c77b91936c77b9a29"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ad88abb941befa28c77b91936c77b9a29">lar::util::GaussianFit::Value_t::value</a></div><div class="ttdeci">constexpr Data_t value() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01255">SimpleFits.h:1255</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a504e6d750057212db59e4a4ddba3db03"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a504e6d750057212db59e4a4ddba3db03">lar::util::details::FitDataCollector::s2</a></div><div class="ttdeci">WeightTracker&lt; Data_t &gt; s2</div><div class="ttdoc">accumulator for uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00327">SimpleFits.h:327</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a31b277799350e6a2a27beec6f994c233"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a31b277799350e6a2a27beec6f994c233">lar::util::LinearFit::InterceptSlopeCovariance</a></div><div class="ttdeci">Data_t InterceptSlopeCovariance() const </div><div class="ttdoc">Returns the covariance between intercept and slope of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00905">SimpleFits.h:905</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_adb062aeb049cd93d201b30eedba813be"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adb062aeb049cd93d201b30eedba813be">lar::util::LinearFit::Intercept</a></div><div class="ttdeci">Data_t Intercept() const </div><div class="ttdoc">Returns the intercept of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00877">SimpleFits.h:877</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a1a77d4ae72485eac9b9bcf85234d4de0"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1a77d4ae72485eac9b9bcf85234d4de0">lar::util::LinearFit::X2</a></div><div class="ttdeci">Data_t X2() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00922">SimpleFits.h:922</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a638cc4667a3926bdfab2ea3679ba95b8"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a638cc4667a3926bdfab2ea3679ba95b8">lar::util::details::FitDataCollector::x</a></div><div class="ttdeci">DataTracker&lt; Degree *2, Data_t &gt; x</div><div class="ttdoc">accumulator for variable x^k </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00328">SimpleFits.h:328</a></div></div>
<div class="ttc" id="ComputePi__module_8cc_html_a51cbff124162962a948e82258a33a415"><div class="ttname"><a href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a></div><div class="ttdeci">constexpr T sqr(T v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/ComputePi__module_8cc_source.html#l00097">ComputePi_module.cc:97</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor_html_a72ddd47480f6b3d639ef0c2eadedec5b"><div class="ttname"><a href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html#a72ddd47480f6b3d639ef0c2eadedec5b">lar::util::details::FitDataCollector::SumExtractor::Sum</a></div><div class="ttdeci">static T Sum(WeightTracker&lt; T &gt; const &amp;, DataTracker&lt; Power, T &gt; const &amp;sums)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00059">SimpleFits.h:59</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1identity_html"><div class="ttname"><a href="../../dd/d5e/structlar_1_1util_1_1identity.html">lar::util::identity</a></div><div class="ttdoc">A unary functor returning its own argument (any type) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00033">StatCollector.h:33</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a66369cf17abc77f70ba79ece4cb5e6ec"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a66369cf17abc77f70ba79ece4cb5e6ec">lar::util::QuadraticFit::FitParameters_t</a></div><div class="ttdeci">std::array&lt; Data_t, NParams &gt; FitParameters_t</div><div class="ttdoc">type of set of fit parameters </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00970">SimpleFits.h:970</a></div></div>
<div class="ttc" id="namespaceSortModuleTimes_html_a805854df4323f914a9a09f4e266b4794"><div class="ttname"><a href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">SortModuleTimes.const</a></div><div class="ttdeci">string const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df3/SortModuleTimes_8py_source.html#l00871">SortModuleTimes.py:871</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_ad48b203783a6c80cdca6c4f8dd44e549"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad48b203783a6c80cdca6c4f8dd44e549">lar::util::details::SimplePolyFitterDataBase::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont, Pred extractor)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00385">SimpleFits.h:385</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ac6219e5dc485a719393b107e5f88187f"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac6219e5dc485a719393b107e5f88187f">lar::util::GaussianFit::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont, Pred extractor)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01068">SimpleFits.h:1068</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a3e3c7d969786c42683414b1844c0cf93"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a3e3c7d969786c42683414b1844c0cf93">lar::util::GaussianFit::ConvertParametersAndErrors</a></div><div class="ttdeci">static void ConvertParametersAndErrors(FitParameters_t const &amp;qpars, FitMatrix_t const &amp;qparerrmat, FitParameters_t &amp;params, FitParameters_t &amp;paramerrors)</div><div class="ttdoc">Converts the specified quadratic fit parameters and errors. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01974">SimpleFits.h:1974</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_af4ab2c04006bb9d87ddf3371d10f34f7"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#af4ab2c04006bb9d87ddf3371d10f34f7">lar::util::details::SimplePolyFitterBase::FitParameters_t</a></div><div class="ttdeci">typename Interface_t::FitParameters_t FitParameters_t</div><div class="ttdoc">type of set of fit parameters </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00656">SimpleFits.h:656</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a3ffc00b73ada60025f8593a7553477e4"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3ffc00b73ada60025f8593a7553477e4">lar::util::details::FitDataCollector::WeightToUncertainty</a></div><div class="ttdeci">static Data_t WeightToUncertainty(Data_t w)</div><div class="ttdoc">Transforms a weight back to an uncertainty ( ) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00321">SimpleFits.h:321</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a3d0f30878e869b34592a564d50118efb"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3d0f30878e869b34592a564d50118efb">lar::util::details::FitDataCollector::N</a></div><div class="ttdeci">int N() const </div><div class="ttdoc">Returns the number of entries added. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00266">SimpleFits.h:266</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a44950067dbbf37e1522454c0b3fa928f"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a44950067dbbf37e1522454c0b3fa928f">lar::util::details::FitDataCollector::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont, Pred extractor)</div><div class="ttdoc">Adds all measurements from a container, with no uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00169">SimpleFits.h:169</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_af1ed8d3e064a52cf1ee95e85a99dbe2a"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#af1ed8d3e064a52cf1ee95e85a99dbe2a">lar::util::details::SimplePolyFitterDataBase::PrintStats</a></div><div class="ttdeci">void PrintStats(Stream &amp;out) const </div><div class="ttdoc">Prints the collected statistics into a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00436">SimpleFits.h:436</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a4891d1b53962c0c5432caefd700a4213"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4891d1b53962c0c5432caefd700a4213">lar::util::details::SimplePolyFitterDataBase::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears all the statistics. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00421">SimpleFits.h:421</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a16b22ddaf83811695a85fc2942aac908"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a16b22ddaf83811695a85fc2942aac908">lar::util::LinearFit::X</a></div><div class="ttdeci">Data_t X() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00921">SimpleFits.h:921</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_abbf276ad8a63b009b748ad2dbc6ce29b"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abbf276ad8a63b009b748ad2dbc6ce29b">lar::util::GaussianFit::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Iter begin, Iter end)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01061">SimpleFits.h:1061</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html">lar::util::GaussianFit</a></div><div class="ttdoc">&amp;quot;Fast&amp;quot; Gaussian fit </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01018">SimpleFits.h:1018</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_ad259e7c33a704282f3e0a2aea96011a3"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#ad259e7c33a704282f3e0a2aea96011a3">lar::util::details::SimpleFitterInterface::MatrixProduct</a></div><div class="ttdeci">virtual FitParameters_t MatrixProduct(FitMatrix_t const &amp;mat, FitParameters_t const &amp;vec) const </div><div class="ttdoc">Computes the product of a FitMatrix_t and a FitParameters_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00629">SimpleFits.h:629</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4_html_a0c81a335f9fa0bbd6d488db6aa4365a4"><div class="ttname"><a href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a0c81a335f9fa0bbd6d488db6aa4365a4">lar::util::GaussianFit::EncodeExtractor&lt; Pred, void &gt;::EncodeExtractor</a></div><div class="ttdeci">EncodeExtractor(Pred &amp;pred)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01340">SimpleFits.h:1340</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1DataTracker_html"><div class="ttname"><a href="../../d5/d18/classlar_1_1util_1_1details_1_1DataTracker.html">lar::util::details::DataTracker</a></div><div class="ttdoc">Class tracking sums of variables up to a specified power. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d87/StatCollector_8h_source.html#l00093">StatCollector.h:93</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a330b13d0a2f0ef6874e6cabea1f9a317"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a330b13d0a2f0ef6874e6cabea1f9a317">lar::util::details::SimpleFitterInterface::~SimpleFitterInterface</a></div><div class="ttdeci">virtual ~SimpleFitterInterface()=default</div><div class="ttdoc">Virtual destructor: compiler&amp;#39;s default. </div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_html_a59fca69799f6b9e366710cb9043aa77d"><div class="ttname"><a href="../../dc/df0/namespacenlohmann_1_1detail.html#a59fca69799f6b9e366710cb9043aa77d">nlohmann::detail::void</a></div><div class="ttdeci">j template void())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db8/json_8hpp_source.html#l03108">json.hpp:3108</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_html_a9d9ad1880a0d0645d2c87b1274ae96a7"><div class="ttname"><a href="../../d1/d9d/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor.html#a9d9ad1880a0d0645d2c87b1274ae96a7">lar::util::GaussianFit::EncodeExtractor::value_extractor</a></div><div class="ttdeci">VPred &amp; value_extractor</div><div class="ttdoc">value extractor </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01332">SimpleFits.h:1332</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_af72192678e8b18720e8e717a3aeacfb5"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#af72192678e8b18720e8e717a3aeacfb5">lar::util::LinearFit::SlopeError</a></div><div class="ttdeci">Data_t SlopeError() const </div><div class="ttdoc">Returns the error in slope of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00898">SimpleFits.h:898</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_ae5437e7c57c31067e647f6789eeff30b"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#ae5437e7c57c31067e647f6789eeff30b">lar::util::GaussianFit::Value_t::value</a></div><div class="ttdeci">Data_t &amp; value()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01258">SimpleFits.h:1258</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a4536c7581f4576bf9f02dbf81739414a"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a4536c7581f4576bf9f02dbf81739414a">lar::util::details::SimplePolyFitterDataBase::add</a></div><div class="ttdeci">bool add(Measurement_t value, Data_t sy=Data_t(1.0))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00369">SimpleFits.h:369</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a1e9cd10f407a1a9386838bdb2bef1f11"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a1e9cd10f407a1a9386838bdb2bef1f11">lar::util::LinearFit::FitParameters_t</a></div><div class="ttdeci">std::array&lt; Data_t, NParams &gt; FitParameters_t</div><div class="ttdoc">type of set of fit parameters </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00866">SimpleFits.h:866</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_ad622458251ea68f076bf81d91190e685"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ad622458251ea68f076bf81d91190e685">lar::util::details::SimplePolyFitterDataBase::AverageUncertainty</a></div><div class="ttdeci">Data_t AverageUncertainty() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00429">SimpleFits.h:429</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_aab8c459c58f27d536ca4ac00538ffb9e"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#aab8c459c58f27d536ca4ac00538ffb9e">lar::util::GaussianFit::Value_t::Value_t</a></div><div class="ttdeci">Value_t(MeasurementAndUncertainty_t meas)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01252">SimpleFits.h:1252</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a3954611eb63affe1913f53ce3671eaeb"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3954611eb63affe1913f53ce3671eaeb">lar::util::details::FitDataCollector::AverageUncertainty</a></div><div class="ttdeci">Data_t AverageUncertainty() const </div><div class="ttdoc">Returns an average of the uncertainties. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00277">SimpleFits.h:277</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a31af0dc8685f677af1bffd6620ba1323"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a31af0dc8685f677af1bffd6620ba1323">lar::util::GaussianFit::EncodeValue</a></div><div class="ttdeci">static Value_t EncodeValue(Value_t const &amp;value)</div><div class="ttdoc">Converts a value and error into a proper input for the quadratic fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01277">SimpleFits.h:1277</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_ad9d2dd0bd8aa5f7cfc461b4be05b0b61"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad9d2dd0bd8aa5f7cfc461b4be05b0b61">lar::util::details::FitDataCollector::XNY</a></div><div class="ttdeci">Data_t XNY(unsigned int n) const </div><div class="ttdoc">Returns the weighted sum of x^n y. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00291">SimpleFits.h:291</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html">lar::util::QuadraticFit</a></div><div class="ttdoc">Performs a second-degree fit of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00953">SimpleFits.h:953</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a1b7fb6ab9f3b08c598d33adf67ddc38f"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a1b7fb6ab9f3b08c598d33adf67ddc38f">lar::util::details::SimplePolyFitterBase::FitMatrix_t</a></div><div class="ttdeci">typename Interface_t::FitMatrix_t FitMatrix_t</div><div class="ttdoc">type of matrix for covariance (a std::array) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00659">SimpleFits.h:659</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a32ce0f367b4b2dd9d164f73741967f75"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a32ce0f367b4b2dd9d164f73741967f75">lar::util::details::SimpleFitterInterface&lt; T, D+1 &gt;::FitMatrix_t</a></div><div class="ttdeci">typename MatrixOps::Matrix_t FitMatrix_t</div><div class="ttdoc">type of matrix for covariance (a std::array) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00472">SimpleFits.h:472</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a421b70dcaafc9fa9c0aaf157eabd2403"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a421b70dcaafc9fa9c0aaf157eabd2403">lar::util::QuadraticFit::Y</a></div><div class="ttdeci">Data_t Y() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00992">SimpleFits.h:992</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a9b55ce81a1f76de70228e0298ae54e85"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9b55ce81a1f76de70228e0298ae54e85">lar::util::details::FitDataCollector::Print</a></div><div class="ttdeci">void Print(Stream &amp;out) const </div><div class="ttdoc">Prints the statistics into a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01519">SimpleFits.h:1519</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FastMatrixOperationsBase_html_a50691cd4ea489da5d9c1bb811193e775"><div class="ttname"><a href="../../d0/dfb/structlar_1_1util_1_1details_1_1FastMatrixOperationsBase.html#a50691cd4ea489da5d9c1bb811193e775">lar::util::details::FastMatrixOperationsBase::MatrixVectorProduct</a></div><div class="ttdeci">static Vector_t MatrixVectorProduct(Matrix_t const &amp;mat, Vector_t const &amp;vec)</div><div class="ttdoc">Returns the product of a square matrix times a column vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d0e/FastMatrixMathHelper_8h_source.html#l00362">FastMatrixMathHelper.h:362</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a5f6a4b59feda3dc4f21275ba417c5d5b"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5f6a4b59feda3dc4f21275ba417c5d5b">lar::util::GaussianFit::isValid</a></div><div class="ttdeci">virtual bool isValid() const override</div><div class="ttdoc">Returns if the fit has valid results. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01122">SimpleFits.h:1122</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ab6105e2afb2adfdb82920866f8d69040"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab6105e2afb2adfdb82920866f8d69040">lar::util::GaussianFit::fitter</a></div><div class="ttdeci">Fitter_t fitter</div><div class="ttdoc">the actual fitter and data holder </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01242">SimpleFits.h:1242</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_ac2a0e22cd7d4815d3a4a2a737470ed23"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#ac2a0e22cd7d4815d3a4a2a737470ed23">lar::util::details::SimplePolyFitterDataBase::sqr</a></div><div class="ttdeci">static constexpr V sqr(V const &amp;v)</div><div class="ttdoc">Returns the square of the specified value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00441">SimpleFits.h:441</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a0c3d305f74b0220c9e366ab52519fd1a"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0c3d305f74b0220c9e366ab52519fd1a">lar::util::details::FitDataCollector::Measurement_t</a></div><div class="ttdeci">std::tuple&lt; Data_t, Data_t &gt; Measurement_t</div><div class="ttdoc">type of measurement without uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00079">SimpleFits.h:79</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a063a75ce9b914bbe7b9efc6adb7a2e7a"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a063a75ce9b914bbe7b9efc6adb7a2e7a">lar::util::details::SimplePolyFitterBase::ExtractParameterErrors</a></div><div class="ttdeci">static FitParameters_t ExtractParameterErrors(FitMatrix_t const &amp;Smat)</div><div class="ttdoc">Extracts parameter errors from diagonal of the covarriance matrix. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01715">SimpleFits.h:1715</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor_html"><div class="ttname"><a href="../../d3/d17/structlar_1_1util_1_1details_1_1FitDataCollector_1_1SumExtractor.html">lar::util::details::FitDataCollector::SumExtractor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00057">SimpleFits.h:57</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a5594d0b6fea6ee3b30a1da69e10b4ced"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a5594d0b6fea6ee3b30a1da69e10b4ced">lar::util::QuadraticFit::X2Y</a></div><div class="ttdeci">Data_t X2Y() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00994">SimpleFits.h:994</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a5248460746943b74c089d75dbabf2df1"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a5248460746943b74c089d75dbabf2df1">lar::util::details::SimplePolyFitterBase::Evaluate</a></div><div class="ttdeci">virtual Data_t Evaluate(Data_t x) const override</div><div class="ttdoc">Evaluates the fitted function at the specified point. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01641">SimpleFits.h:1641</a></div></div>
<div class="ttc" id="crttrackproducer__icarus_8fcl_html_a14cd8fb5a7e9ccaa599d9e5fefbbe66d"><div class="ttname"><a href="../../d2/d65/crttrackproducer__icarus_8fcl.html#a14cd8fb5a7e9ccaa599d9e5fefbbe66d">method</a></div><div class="ttdeci">BEGIN_PROLOG method</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d65/crttrackproducer__icarus_8fcl_source.html#l00015">crttrackproducer_icarus.fcl:15</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a8b6ee48c3b346166d4203b788d478ae7"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8b6ee48c3b346166d4203b788d478ae7">lar::util::GaussianFit::Fitter</a></div><div class="ttdeci">virtual Fitter_t const &amp; Fitter() const </div><div class="ttdoc">Returns the internal fitter (mostly for debugging) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01230">SimpleFits.h:1230</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_afc58b254c9f739e9ff8af762d8bda1d9"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#afc58b254c9f739e9ff8af762d8bda1d9">lar::util::details::FitDataCollector::Data_t</a></div><div class="ttdeci">T Data_t</div><div class="ttdoc">type of the data </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00076">SimpleFits.h:76</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a123689f5219e4dfa8b382d57a60d95c0"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a123689f5219e4dfa8b382d57a60d95c0">lar::util::details::FitDataCollector::xy</a></div><div class="ttdeci">DataTracker&lt; Degree, Data_t &gt; xy</div><div class="ttdoc">accumulator for variable xy </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00331">SimpleFits.h:331</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a0c7d8282cee71e74462ead6919c21b4a"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a0c7d8282cee71e74462ead6919c21b4a">lar::util::GaussianFit::NDF</a></div><div class="ttdeci">virtual int NDF() const override</div><div class="ttdoc">Returns the degrees of freedom in the determination of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01170">SimpleFits.h:1170</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a73cf8964153186e7f7edca034fee1703"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a73cf8964153186e7f7edca034fee1703">lar::util::QuadraticFit::I</a></div><div class="ttdeci">Data_t I() const </div><div class="ttdoc">Aliases. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00987">SimpleFits.h:987</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html">lar::util::details::SimplePolyFitterBase</a></div><div class="ttdoc">Base class providing virtual fitting interface for polynomial fitters. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00637">SimpleFits.h:637</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a690421ae11ed311f948c68699e70c9c5"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a690421ae11ed311f948c68699e70c9c5">lar::util::GaussianFit::add</a></div><div class="ttdeci">bool add(MeasurementAndUncertainty_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01053">SimpleFits.h:1053</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html">lar::util::details::SimplePolyFitterDataBase</a></div><div class="ttdoc">Base class providing data collection for the simple polynomial fitters. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00344">SimpleFits.h:344</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ac8155264e35adb37f327ae2f53f60b69"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ac8155264e35adb37f327ae2f53f60b69">lar::util::GaussianFit::Measurement_t</a></div><div class="ttdeci">typename Fitter_t::Measurement_t Measurement_t</div><div class="ttdoc">type of measurement without uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01029">SimpleFits.h:1029</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a128fb909d713f604ae4ee55491dc6ac8"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a128fb909d713f604ae4ee55491dc6ac8">lar::util::LinearFit::XY</a></div><div class="ttdeci">Data_t XY() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00924">SimpleFits.h:924</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html">lar::util::details::SimpleFitterInterface</a></div><div class="ttdoc">Simple fitter abstract interface. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00458">SimpleFits.h:458</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a3388e3f7e748ff75fdfe1a0be195c9a0"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a3388e3f7e748ff75fdfe1a0be195c9a0">lar::util::details::SimplePolyFitterBase::FitParameterCovariance</a></div><div class="ttdeci">virtual FitMatrix_t FitParameterCovariance() const override</div><div class="ttdoc">Computes and returns all the covariance matrix of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01585">SimpleFits.h:1585</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ab57a42bc13063f3415f49947fcd6d631"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab57a42bc13063f3415f49947fcd6d631">lar::util::GaussianFit::MeasurementAndUncertainty_t</a></div><div class="ttdeci">typename Fitter_t::MeasurementAndUncertainty_t MeasurementAndUncertainty_t</div><div class="ttdoc">type of measurement with uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01033">SimpleFits.h:1033</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a0216904d6589fe893c7b4feb7dcb7a01"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a0216904d6589fe893c7b4feb7dcb7a01">lar::util::details::FitDataCollector::add</a></div><div class="ttdeci">bool add(Measurement_t value, Data_t sy=Data_t(1.0))</div><div class="ttdoc">Adds one entry with specified x, y and uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00108">SimpleFits.h:108</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a08a8105f4a8c69a529b330229bbef836"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a08a8105f4a8c69a529b330229bbef836">lar::util::details::SimpleFitterInterface::isValid</a></div><div class="ttdeci">virtual bool isValid() const =0</div><div class="ttdoc">Returns if the fit has valid results. </div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_afe61d8fd0065ea31105af6eead27bac3"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#afe61d8fd0065ea31105af6eead27bac3">lar::util::details::SimplePolyFitterBase::MakeMatrixY</a></div><div class="ttdeci">virtual FitParameters_t MakeMatrixY() const </div><div class="ttdoc">Fills and returns the matrix (vector) of x^n y sum coefficients. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01668">SimpleFits.h:1668</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a9bc3d800d3e435afbcf66d0ff66f6adc"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a9bc3d800d3e435afbcf66d0ff66f6adc">lar::util::details::FitDataCollector::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears all the statistics. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01509">SimpleFits.h:1509</a></div></div>
<div class="ttc" id="prova__source_8fcl_html_ab58e1ede8542ac672a1c146fb3870f2e"><div class="ttname"><a href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a></div><div class="ttdeci">process_name largeant stream1 can override from command line with o or output physics producers generator N</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/prova__source_8fcl_source.html#l00033">prova_source.fcl:33</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a15e54ca82341a7c2912238578d161e7c"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a15e54ca82341a7c2912238578d161e7c">lar::util::GaussianFit::Encoder</a></div><div class="ttdeci">static EncodeExtractor&lt; VPred, UPred &gt; Encoder(VPred &amp;vpred, UPred &amp;upred)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01367">SimpleFits.h:1367</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4_html_a01b1f5023f48e8903ffd765869fa424d"><div class="ttname"><a href="../../d4/dc5/structlar_1_1util_1_1GaussianFit_1_1EncodeExtractor_3_01Pred_00_01void_01_4.html#a01b1f5023f48e8903ffd765869fa424d">lar::util::GaussianFit::EncodeExtractor&lt; Pred, void &gt;::extractor</a></div><div class="ttdeci">Pred &amp; extractor</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01360">SimpleFits.h:1360</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a950aea2d9a641d91f023752dd436cbac"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a950aea2d9a641d91f023752dd436cbac">lar::util::QuadraticFit::ChiSquare</a></div><div class="ttdeci">virtual Data_t ChiSquare() const override</div><div class="ttdoc">Returns the  of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01771">SimpleFits.h:1771</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a1cb256534b87f3ef231340196b8ea420"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a1cb256534b87f3ef231340196b8ea420">lar::util::details::FitDataCollector::Degree</a></div><div class="ttdeci">static constexpr unsigned int Degree</div><div class="ttdoc">Degree of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00073">SimpleFits.h:73</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a6f434f79e36905d633fa70be5a90bc21"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a6f434f79e36905d633fa70be5a90bc21">lar::util::details::SimpleFitterInterface::Determinant</a></div><div class="ttdeci">virtual Data_t Determinant(FitMatrix_t const &amp;mat) const </div><div class="ttdoc">Computes the determinant of a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00615">SimpleFits.h:615</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_ad27b630119749ab8829fa0f164aef283"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#ad27b630119749ab8829fa0f164aef283">lar::util::details::FitDataCollector::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Cont cont)</div><div class="ttdoc">Adds all measurements from a container, with no uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00183">SimpleFits.h:183</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a9c99455132b4ede84de6e73fc5a9738f"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a9c99455132b4ede84de6e73fc5a9738f">lar::util::GaussianFit::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears all the input statistics. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01097">SimpleFits.h:1097</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ace155ab1da0a41774be251414c78ec21"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ace155ab1da0a41774be251414c78ec21">lar::util::details::SimplePolyFitterBase::FitParameters</a></div><div class="ttdeci">virtual FitParameters_t FitParameters() const override</div><div class="ttdoc">Computes and returns all the parameters of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01564">SimpleFits.h:1564</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_aeaa6a12c696704611d5712118158cacc"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#aeaa6a12c696704611d5712118158cacc">lar::util::details::SimpleFitterInterface::ChiSquare</a></div><div class="ttdeci">virtual Data_t ChiSquare() const =0</div><div class="ttdoc">Returns the  of the fit. </div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_a403adaeef013d290bb38246e905557fb"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#a403adaeef013d290bb38246e905557fb">lar::util::details::SimplePolyFitterBase::Degree</a></div><div class="ttdeci">static constexpr unsigned int Degree</div><div class="ttdoc">Degree of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00648">SimpleFits.h:648</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_aa4e78098f8018a494156c09516feb50e"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa4e78098f8018a494156c09516feb50e">lar::util::details::SimplePolyFitterDataBase::add_with_uncertainty</a></div><div class="ttdeci">unsigned int add_with_uncertainty(Cont cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00415">SimpleFits.h:415</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_aea7a7562e33591741b641e6ba634337b"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#aea7a7562e33591741b641e6ba634337b">lar::util::QuadraticFit::XY</a></div><div class="ttdeci">Data_t XY() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00993">SimpleFits.h:993</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ae003ced95b062a5ecbe28b5ed28a7c69"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ae003ced95b062a5ecbe28b5ed28a7c69">lar::util::GaussianFit::Evaluate</a></div><div class="ttdeci">virtual Data_t Evaluate(Data_t x) const override</div><div class="ttdoc">Evaluates the fitted function at the specified point. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01225">SimpleFits.h:1225</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a84305f45134eebc68cf6e6a2cca9d535"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a84305f45134eebc68cf6e6a2cca9d535">lar::util::details::SimpleFitterInterface::NParams</a></div><div class="ttdeci">static constexpr unsigned int NParams</div><div class="ttdoc">Number of parameters in the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00462">SimpleFits.h:462</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ab7cc52876d6e9a87d422334c494c59bf"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ab7cc52876d6e9a87d422334c494c59bf">lar::util::GaussianFit::FitParameterCovariance</a></div><div class="ttdeci">virtual FitMatrix_t FitParameterCovariance() const override</div><div class="ttdoc">Computes and returns all the covariance matrix of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01858">SimpleFits.h:1858</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a430de9ce64e6a16b75a447cfb21c68fd"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a430de9ce64e6a16b75a447cfb21c68fd">lar::util::details::SimplePolyFitterDataBase::add_without_uncertainty</a></div><div class="ttdeci">void add_without_uncertainty(Iter begin, Iter end, Pred extractor)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00381">SimpleFits.h:381</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_aac76f73d1302f626d32ef2180890db84"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#aac76f73d1302f626d32ef2180890db84">lar::util::GaussianFit::ConvertParametersAndErrorMatrix</a></div><div class="ttdeci">static void ConvertParametersAndErrorMatrix(FitParameters_t const &amp;qpars, FitMatrix_t const &amp;qparerrmat, FitParameters_t &amp;params, FitMatrix_t &amp;Smat)</div><div class="ttdoc">Converts the specified quadratic fit parameters and errors. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01986">SimpleFits.h:1986</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a3dab9ea4282ef37bba12e8ca2c532fe4"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a3dab9ea4282ef37bba12e8ca2c532fe4">lar::util::details::SimpleFitterInterface::FillResults</a></div><div class="ttdeci">virtual bool FillResults(FitParameters_t &amp;params, FitMatrix_t &amp;Xmat, Data_t &amp;det, FitMatrix_t &amp;Smat) const =0</div><div class="ttdoc">Fills the specified parameters. </div></div>
<div class="ttc" id="pmtsimulation__icarus_8fcl_html_a9fc569190f32b40862f18ac3c03a8e49"><div class="ttname"><a href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a></div><div class="ttdeci">temporary value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d36/pmtsimulation__icarus_8fcl_source.html#l00216">pmtsimulation_icarus.fcl:216</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a193e5368304049d6ed47870040d38f12"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a193e5368304049d6ed47870040d38f12">lar::util::QuadraticFit::X</a></div><div class="ttdeci">Data_t X() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00988">SimpleFits.h:988</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a51556ffbc848f3b78121d6606a2b9d24"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a51556ffbc848f3b78121d6606a2b9d24">lar::util::details::SimpleFitterInterface::NDF</a></div><div class="ttdeci">virtual int NDF() const =0</div><div class="ttdoc">Returns the degrees of freedom in the determination of the fit. </div></div>
<div class="ttc" id="structlar_1_1util_1_1details_1_1FastMatrixOperations_html_a2648e1625dc3754c74c0b62ae96be064"><div class="ttname"><a href="../../d7/d62/structlar_1_1util_1_1details_1_1FastMatrixOperations.html#a2648e1625dc3754c74c0b62ae96be064">lar::util::details::FastMatrixOperations::Matrix_t</a></div><div class="ttdeci">typename Base_t::Matrix_t Matrix_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d0e/FastMatrixMathHelper_8h_source.html#l00090">FastMatrixMathHelper.h:90</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_a20d435145aad9498d35489d9ebb1d619"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#a20d435145aad9498d35489d9ebb1d619">lar::util::details::SimplePolyFitterDataBase::Measurement_t</a></div><div class="ttdeci">typename Collector_t::Measurement_t Measurement_t</div><div class="ttdoc">type of measurement without uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00354">SimpleFits.h:354</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_ae5e857b88e1c1e5b31e512ba0ed5a34d"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#ae5e857b88e1c1e5b31e512ba0ed5a34d">lar::util::details::SimplePolyFitterBase::isValid</a></div><div class="ttdeci">virtual bool isValid() const override</div><div class="ttdoc">Returns if the fit has valid results. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01540">SimpleFits.h:1540</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a9c3406187e610b77163ab40a8cfc6d00"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a9c3406187e610b77163ab40a8cfc6d00">lar::util::details::SimpleFitterInterface&lt; T, D+1 &gt;::FitParameters_t</a></div><div class="ttdeci">std::array&lt; Data_t, NParams &gt; FitParameters_t</div><div class="ttdoc">type of set of fit parameters </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00469">SimpleFits.h:469</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_abf88c4962a6f92d0639138055082980e"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#abf88c4962a6f92d0639138055082980e">lar::util::GaussianFit::FitParameters_t</a></div><div class="ttdeci">typename Fitter_t::FitParameters_t FitParameters_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01035">SimpleFits.h:1035</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a439050e55109f795d68d94b1291b377b"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a439050e55109f795d68d94b1291b377b">lar::util::LinearFit::Y</a></div><div class="ttdeci">Data_t Y() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00923">SimpleFits.h:923</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a8d84a396c1367904464ca4cc5f317b5b"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a8d84a396c1367904464ca4cc5f317b5b">lar::util::GaussianFit::DecodeValue</a></div><div class="ttdeci">static Data_t DecodeValue(Data_t value)</div><div class="ttdoc">Converts a value from the quadratic fit into a proper value. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01268">SimpleFits.h:1268</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a5b78508f924627cfebea2e530c5a9d7e"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a5b78508f924627cfebea2e530c5a9d7e">lar::util::GaussianFit::EncodeValue</a></div><div class="ttdeci">static Data_t EncodeValue(Data_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01265">SimpleFits.h:1265</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterBase_html_aad5aa30de4b0390798c2be2e22e54a33"><div class="ttname"><a href="../../d8/dd9/classlar_1_1util_1_1details_1_1SimplePolyFitterBase.html#aad5aa30de4b0390798c2be2e22e54a33">lar::util::details::SimplePolyFitterBase::NDF</a></div><div class="ttdeci">virtual int NDF() const override</div><div class="ttdoc">Returns the degrees of freedom in the determination of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00731">SimpleFits.h:731</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_af0595a4b25e61e68c6d50f95f945d97a"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#af0595a4b25e61e68c6d50f95f945d97a">lar::util::details::SimpleFitterInterface::FitParameter</a></div><div class="ttdeci">virtual Data_t FitParameter(unsigned int n) const </div><div class="ttdoc">Returns the parameter n of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00524">SimpleFits.h:524</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1GaussianFit_1_1Value__t_html_a82c639ab4406d80b65062ef721249a24"><div class="ttname"><a href="../../d4/d3d/structlar_1_1util_1_1GaussianFit_1_1Value__t.html#a82c639ab4406d80b65062ef721249a24">lar::util::GaussianFit::Value_t::error</a></div><div class="ttdeci">Data_t &amp; error()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01259">SimpleFits.h:1259</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a248b2be108e07c2482280ae7bbfc93f1"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a248b2be108e07c2482280ae7bbfc93f1">lar::util::QuadraticFit::X2</a></div><div class="ttdeci">Data_t X2() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00989">SimpleFits.h:989</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_aa856c76df4b43666b625b4e2b9e351f5"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#aa856c76df4b43666b625b4e2b9e351f5">lar::util::details::SimplePolyFitterDataBase::add</a></div><div class="ttdeci">bool add(Data_t x, Data_t y, Data_t sy=Data_t(1.0))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00366">SimpleFits.h:366</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_aed0aabd6756019810d71a249e23433d6"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#aed0aabd6756019810d71a249e23433d6">Param</a></div><div class="ttdeci">do Param</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00249">updateVersionList.sh:249</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_ad3ebeb4fe721f576acf73a8d349aeb9f"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#ad3ebeb4fe721f576acf73a8d349aeb9f">lar::util::GaussianFit::Encoder</a></div><div class="ttdeci">static EncodeExtractor&lt; Pred &gt; Encoder(Pred &amp;pred)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01364">SimpleFits.h:1364</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1QuadraticFit_html_a330346b7f83f740f4e3273b7c37fed33"><div class="ttname"><a href="../../d8/d1a/classlar_1_1util_1_1QuadraticFit.html#a330346b7f83f740f4e3273b7c37fed33">lar::util::QuadraticFit::X3</a></div><div class="ttdeci">Data_t X3() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00990">SimpleFits.h:990</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase_html_afdb68198b00431b985f7c76be3de4621"><div class="ttname"><a href="../../d8/dc3/classlar_1_1util_1_1details_1_1SimplePolyFitterDataBase.html#afdb68198b00431b985f7c76be3de4621">lar::util::details::SimplePolyFitterDataBase::stats</a></div><div class="ttdeci">Collector_t stats</div><div class="ttdoc">statistics collected from fit data input </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00444">SimpleFits.h:444</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a3971e8ca775d4678cb69bafb82dc23c1"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a3971e8ca775d4678cb69bafb82dc23c1">lar::util::details::FitDataCollector::add</a></div><div class="ttdeci">bool add(Data_t x, Data_t y, Data_t sy=Data_t(1.0))</div><div class="ttdoc">Adds one entry with specified x, y and uncertainty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01446">SimpleFits.h:1446</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1SimpleFitterInterface_html_a43e6304f681bcd8d5ae34881a5531514"><div class="ttname"><a href="../../d5/d3e/classlar_1_1util_1_1details_1_1SimpleFitterInterface.html#a43e6304f681bcd8d5ae34881a5531514">lar::util::details::SimpleFitterInterface::Evaluate</a></div><div class="ttdeci">virtual Data_t Evaluate(Data_t x) const =0</div><div class="ttdoc">Evaluates the fitted function at the specified point. </div></div>
<div class="ttc" id="runFilesFromSAM_8sh_html_a9cafae22b6225844ee0cdf5ea57176ff"><div class="ttname"><a href="../../d0/d8f/runFilesFromSAM_8sh.html#a9cafae22b6225844ee0cdf5ea57176ff">Stream</a></div><div class="ttdeci">bnb BNB Stream</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/runFilesFromSAM_8sh_source.html#l00296">runFilesFromSAM.sh:296</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a7537924ed971ce2868e570993c7244e5"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a7537924ed971ce2868e570993c7244e5">lar::util::GaussianFit::PrintStats</a></div><div class="ttdeci">void PrintStats(Stream &amp;out) const </div><div class="ttdoc">Prints the collected statistics into a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01105">SimpleFits.h:1105</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_adf138b348f0f949b9db767773733814a"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#adf138b348f0f949b9db767773733814a">lar::util::LinearFit::Y2</a></div><div class="ttdeci">Data_t Y2() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00925">SimpleFits.h:925</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a67a9ecb3326bf44dd204c1a6a7dad7af"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a67a9ecb3326bf44dd204c1a6a7dad7af">lar::util::details::FitDataCollector::Y2</a></div><div class="ttdeci">Data_t Y2() const </div><div class="ttdoc">Returns the weighted sum of y^2. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00307">SimpleFits.h:307</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1details_1_1FitDataCollector_html_a11d623ec40d4c92ed9c00d41bac610a7"><div class="ttname"><a href="../../d5/db5/classlar_1_1util_1_1details_1_1FitDataCollector.html#a11d623ec40d4c92ed9c00d41bac610a7">lar::util::details::FitDataCollector::MeasurementAndUncertainty_t</a></div><div class="ttdeci">std::tuple&lt; Data_t, Data_t, Data_t &gt; MeasurementAndUncertainty_t</div><div class="ttdoc">type of measurement with uncertainty </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l00082">SimpleFits.h:82</a></div></div>
<div class="ttc" id="PointIsolationAlgStress__test_8cc_html_a01fbff193985cc6e5ccd769e2f9656b1"><div class="ttname"><a href="../../d4/d95/PointIsolationAlgStress__test_8cc.html#a01fbff193985cc6e5ccd769e2f9656b1">cube</a></div><div class="ttdeci">T cube(T side)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d95/PointIsolationAlgStress__test_8cc_source.html#l00052">PointIsolationAlgStress_test.cc:52</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1GaussianFit_html_a14cfdfe79c0db43c93ed48c1a5c72008"><div class="ttname"><a href="../../d7/de5/classlar_1_1util_1_1GaussianFit.html#a14cfdfe79c0db43c93ed48c1a5c72008">lar::util::GaussianFit::FitParameters</a></div><div class="ttdeci">virtual FitParameters_t FitParameters() const override</div><div class="ttdoc">Computes and returns all the parameters of the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01841">SimpleFits.h:1841</a></div></div>
<div class="ttc" id="classlar_1_1util_1_1LinearFit_html_a5e3a2a3a0b13dde0e958e3cbba67f5db"><div class="ttname"><a href="../../de/d76/classlar_1_1util_1_1LinearFit.html#a5e3a2a3a0b13dde0e958e3cbba67f5db">lar::util::LinearFit::ChiSquare</a></div><div class="ttdeci">virtual Data_t ChiSquare() const override</div><div class="ttdoc">Returns the  of the fit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd8/SimpleFits_8h_source.html#l01756">SimpleFits.h:1756</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
