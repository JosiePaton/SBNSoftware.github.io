<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>trkf::SpacePointAlg Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/da2/namespacetrkf.html">trkf</a></li><li class="navelem"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html">SpacePointAlg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d3/d18/classtrkf_1_1SpacePointAlg-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">trkf::SpacePointAlg Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d43/structtrkf_1_1SpacePointAlg_1_1HitMCInfo.html">HitMCInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab6b63569793eeee27524a64f3dbe1e5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ab6b63569793eeee27524a64f3dbe1e5d">SpacePointAlg</a> (const fhicl::ParameterSet &amp;pset)</td></tr>
<tr class="separator:ab6b63569793eeee27524a64f3dbe1e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f53b42a44aed5709088a10f894b7e30"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9f53b42a44aed5709088a10f894b7e30">filter</a> () const noexcept</td></tr>
<tr class="separator:a9f53b42a44aed5709088a10f894b7e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85632a9169a13170e3bd0d82dede1082"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a85632a9169a13170e3bd0d82dede1082">merge</a> () const noexcept</td></tr>
<tr class="separator:a85632a9169a13170e3bd0d82dede1082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedabe64048a1cc9fc8f1cb999140225d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aedabe64048a1cc9fc8f1cb999140225d">maxDT</a> () const noexcept</td></tr>
<tr class="separator:aedabe64048a1cc9fc8f1cb999140225d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3a29665371882093486184bcf82558"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a6a3a29665371882093486184bcf82558">maxS</a> () const noexcept</td></tr>
<tr class="separator:a6a3a29665371882093486184bcf82558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7a4f4edb5b41d89cd1262208a89150e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ab7a4f4edb5b41d89cd1262208a89150e">minViews</a> () const noexcept</td></tr>
<tr class="separator:ab7a4f4edb5b41d89cd1262208a89150e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ecb37b95c2a7a58f3360111af4e9876"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1ecb37b95c2a7a58f3360111af4e9876">enableU</a> () const noexcept</td></tr>
<tr class="separator:a1ecb37b95c2a7a58f3360111af4e9876"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07019d8e2e1fd03dbccab934c35cb74d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a07019d8e2e1fd03dbccab934c35cb74d">enableV</a> () const noexcept</td></tr>
<tr class="separator:a07019d8e2e1fd03dbccab934c35cb74d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85902c468adfe1a87c41f389daf1014"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ab85902c468adfe1a87c41f389daf1014">enableW</a> () const noexcept</td></tr>
<tr class="separator:ab85902c468adfe1a87c41f389daf1014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044c4e8d86cb11df41230b474ced9c77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a044c4e8d86cb11df41230b474ced9c77">update</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp) const </td></tr>
<tr class="separator:a044c4e8d86cb11df41230b474ced9c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9cae76cb97c0bc8773470bd95fcbea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c9cae76cb97c0bc8773470bd95fcbea">correctedTime</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &amp;<a class="el" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) const </td></tr>
<tr class="separator:a7c9cae76cb97c0bc8773470bd95fcbea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b1da1f8321bed3bd2847944a9c6b64"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a06b1da1f8321bed3bd2847944a9c6b64">separation</a> (const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits) const </td></tr>
<tr class="separator:a06b1da1f8321bed3bd2847944a9c6b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7927dbe026b0c8c4e4e5987e6757b04f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">compatible</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, bool useMC=false) const </td></tr>
<tr class="separator:a7927dbe026b0c8c4e4e5987e6757b04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6180a5a8b4330cb1c4c11f5b5d1dd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">fillSpacePoint</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;sptv, int sptid) const </td></tr>
<tr class="separator:aec6180a5a8b4330cb1c4c11f5b5d1dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c3ba596cb07ea6f99d9ed288cac1bf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c3ba596cb07ea6f99d9ed288cac1bf1">fillSpacePoints</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;spts, std::multimap&lt; double, <a class="el" href="../../d0/d93/classtrkf_1_1KHitTrack.html">KHitTrack</a> &gt; const &amp;trackMap) const </td></tr>
<tr class="memdesc:a7c3ba596cb07ea6f99d9ed288cac1bf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a collection of space points.  <a href="#a7c3ba596cb07ea6f99d9ed288cac1bf1">More...</a><br/></td></tr>
<tr class="separator:a7c3ba596cb07ea6f99d9ed288cac1bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54689b4bd761a33189b79111a4d40c94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a54689b4bd761a33189b79111a4d40c94">fillComplexSpacePoint</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;sptv, int sptid) const </td></tr>
<tr class="separator:a54689b4bd761a33189b79111a4d40c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b604504074eea09d792a92378982f90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1b604504074eea09d792a92378982f90">makeSpacePoints</a> (<a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;clockData, <a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;spts) const </td></tr>
<tr class="separator:a1b604504074eea09d792a92378982f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2d410b0f9ad9de58b79ef55dafa44a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a2f2d410b0f9ad9de58b79ef55dafa44a">makeMCTruthSpacePoints</a> (<a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;clockData, <a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;spts) const </td></tr>
<tr class="separator:a2f2d410b0f9ad9de58b79ef55dafa44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21daf6d37253e815d61956a4d6ced46c"><td class="memItemLeft" align="right" valign="top">const art::PtrVector<br class="typebreak"/>
&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a21daf6d37253e815d61956a4d6ced46c">getAssociatedHits</a> (const <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &amp;spt) const </td></tr>
<tr class="separator:a21daf6d37253e815d61956a4d6ced46c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a932bf44eae12a46fc0662dc64ba0d762"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a932bf44eae12a46fc0662dc64ba0d762">clearHitMap</a> () const </td></tr>
<tr class="separator:a932bf44eae12a46fc0662dc64ba0d762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af72426e4adcea9b90fecb919ed8ca3f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#af72426e4adcea9b90fecb919ed8ca3f5">numHitMap</a> () const </td></tr>
<tr class="separator:af72426e4adcea9b90fecb919ed8ca3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:acf7ad8047e45ba5240e140dfc4df1534"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#acf7ad8047e45ba5240e140dfc4df1534">makeSpacePoints</a> (<a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;clockData, <a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;detProp, const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;hits, std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;spts, bool useMC) const </td></tr>
<tr class="separator:acf7ad8047e45ba5240e140dfc4df1534"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9d43b56724e1577e314b26e30bbb5e48"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a></td></tr>
<tr class="memdesc:a9d43b56724e1577e314b26e30bbb5e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum time difference between planes.  <a href="#a9d43b56724e1577e314b26e30bbb5e48">More...</a><br/></td></tr>
<tr class="separator:a9d43b56724e1577e314b26e30bbb5e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a27449c7c640a7a0acdf3d40f8f6b01"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a></td></tr>
<tr class="memdesc:a7a27449c7c640a7a0acdf3d40f8f6b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum space separation between wires.  <a href="#a7a27449c7c640a7a0acdf3d40f8f6b01">More...</a><br/></td></tr>
<tr class="separator:a7a27449c7c640a7a0acdf3d40f8f6b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d724375215b3762ce7411f2d93588b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a></td></tr>
<tr class="memdesc:a1d724375215b3762ce7411f2d93588b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mininum number of views per space point.  <a href="#a1d724375215b3762ce7411f2d93588b3">More...</a><br/></td></tr>
<tr class="separator:a1d724375215b3762ce7411f2d93588b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a36a047288595882c58b053651d40c2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">fEnableU</a></td></tr>
<tr class="memdesc:a1a36a047288595882c58b053651d40c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable flag (U).  <a href="#a1a36a047288595882c58b053651d40c2">More...</a><br/></td></tr>
<tr class="separator:a1a36a047288595882c58b053651d40c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76b19c3723486c679453d62ef7e94b0e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">fEnableV</a></td></tr>
<tr class="memdesc:a76b19c3723486c679453d62ef7e94b0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable flag (V).  <a href="#a76b19c3723486c679453d62ef7e94b0e">More...</a><br/></td></tr>
<tr class="separator:a76b19c3723486c679453d62ef7e94b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbcef335053102f807b531bc5aedfdfa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">fEnableW</a></td></tr>
<tr class="memdesc:adbcef335053102f807b531bc5aedfdfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable flag (W).  <a href="#adbcef335053102f807b531bc5aedfdfa">More...</a><br/></td></tr>
<tr class="separator:adbcef335053102f807b531bc5aedfdfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008aac356cf9d575420a7c44f7c0ea40"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a></td></tr>
<tr class="memdesc:a008aac356cf9d575420a7c44f7c0ea40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter flag.  <a href="#a008aac356cf9d575420a7c44f7c0ea40">More...</a><br/></td></tr>
<tr class="separator:a008aac356cf9d575420a7c44f7c0ea40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c715309641498a1b8f2c358fcbbe4d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a></td></tr>
<tr class="memdesc:a7c715309641498a1b8f2c358fcbbe4d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge flag.  <a href="#a7c715309641498a1b8f2c358fcbbe4d9">More...</a><br/></td></tr>
<tr class="separator:a7c715309641498a1b8f2c358fcbbe4d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee29fb1bf85b5474d410bf397e752a2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a></td></tr>
<tr class="memdesc:aee29fb1bf85b5474d410bf397e752a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort by collection wire.  <a href="#aee29fb1bf85b5474d410bf397e752a2e">More...</a><br/></td></tr>
<tr class="separator:aee29fb1bf85b5474d410bf397e752a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72df8a610502c189f835b5c32a64d975"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">fTickOffsetU</a></td></tr>
<tr class="memdesc:a72df8a610502c189f835b5c32a64d975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tick offset for plane U.  <a href="#a72df8a610502c189f835b5c32a64d975">More...</a><br/></td></tr>
<tr class="separator:a72df8a610502c189f835b5c32a64d975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bdedbda8245291bfa18995efca0fd7c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">fTickOffsetV</a></td></tr>
<tr class="memdesc:a5bdedbda8245291bfa18995efca0fd7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tick offset for plane V.  <a href="#a5bdedbda8245291bfa18995efca0fd7c">More...</a><br/></td></tr>
<tr class="separator:a5bdedbda8245291bfa18995efca0fd7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5fadf661ecd9fc31367d63270b721e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">fTickOffsetW</a></td></tr>
<tr class="memdesc:aa5fadf661ecd9fc31367d63270b721e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tick offset for plane W.  <a href="#aa5fadf661ecd9fc31367d63270b721e7">More...</a><br/></td></tr>
<tr class="separator:aa5fadf661ecd9fc31367d63270b721e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7eba2eaf2795a2a922511779faeb6c1"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <br class="typebreak"/>
*, <a class="el" href="../../d4/d43/structtrkf_1_1SpacePointAlg_1_1HitMCInfo.html">HitMCInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a></td></tr>
<tr class="separator:ac7eba2eaf2795a2a922511779faeb6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c9890b5efe25df63a5e70ccb91d7a3"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, art::PtrVector<br class="typebreak"/>
&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a></td></tr>
<tr class="separator:ad2c9890b5efe25df63a5e70ccb91d7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00079">79</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab6b63569793eeee27524a64f3dbe1e5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">trkf::SpacePointAlg::SpacePointAlg </td>
          <td>(</td>
          <td class="paramtype">const fhicl::ParameterSet &amp;&#160;</td>
          <td class="paramname"><em>pset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00038">38</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    : <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxDT&quot;</span>)}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxS&quot;</span>)}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a>{pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;MinViews&quot;</span>)}</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">fEnableU</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;EnableU&quot;</span>)}</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">fEnableV</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;EnableV&quot;</span>)}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">fEnableW</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;EnableW&quot;</span>)}</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;Filter&quot;</span>)}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;Merge&quot;</span>)}</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;PreferColl&quot;</span>)}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">fTickOffsetU</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;TickOffsetU&quot;</span>, 0.)}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">fTickOffsetV</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;TickOffsetV&quot;</span>, 0.)}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    , <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">fTickOffsetW</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;TickOffsetW&quot;</span>, 0.)}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Only allow one of fFilter and fMerge to be true.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a> &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a>)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Filter and Merge flags are both true.\n&quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Report.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;SpacePointAlg configured with the following parameters:\n&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  MaxDT = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  MaxS = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  MinViews = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  EnableU = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">fEnableU</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  EnableV = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">fEnableV</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  EnableW = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">fEnableW</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Filter = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Merge = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  PreferColl = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  TickOffsetU = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">fTickOffsetU</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  TickOffsetV = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">fTickOffsetV</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  TickOffsetW = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">fTickOffsetW</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a72df8a610502c189f835b5c32a64d975"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">trkf::SpacePointAlg::fTickOffsetU</a></div><div class="ttdeci">double fTickOffsetU</div><div class="ttdoc">Tick offset for plane U. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00213">SpacePointAlg.h:213</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a9d43b56724e1577e314b26e30bbb5e48"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">trkf::SpacePointAlg::fMaxDT</a></div><div class="ttdeci">double fMaxDT</div><div class="ttdoc">Maximum time difference between planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00204">SpacePointAlg.h:204</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a008aac356cf9d575420a7c44f7c0ea40"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">trkf::SpacePointAlg::fFilter</a></div><div class="ttdeci">bool fFilter</div><div class="ttdoc">Filter flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00210">SpacePointAlg.h:210</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_adbcef335053102f807b531bc5aedfdfa"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">trkf::SpacePointAlg::fEnableW</a></div><div class="ttdeci">bool fEnableW</div><div class="ttdoc">Enable flag (W). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00209">SpacePointAlg.h:209</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1a36a047288595882c58b053651d40c2"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">trkf::SpacePointAlg::fEnableU</a></div><div class="ttdeci">bool fEnableU</div><div class="ttdoc">Enable flag (U). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00207">SpacePointAlg.h:207</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7a27449c7c640a7a0acdf3d40f8f6b01"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">trkf::SpacePointAlg::fMaxS</a></div><div class="ttdeci">double fMaxS</div><div class="ttdoc">Maximum space separation between wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00205">SpacePointAlg.h:205</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aee29fb1bf85b5474d410bf397e752a2e"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">trkf::SpacePointAlg::fPreferColl</a></div><div class="ttdeci">bool fPreferColl</div><div class="ttdoc">Sort by collection wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00212">SpacePointAlg.h:212</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a5bdedbda8245291bfa18995efca0fd7c"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">trkf::SpacePointAlg::fTickOffsetV</a></div><div class="ttdeci">double fTickOffsetV</div><div class="ttdoc">Tick offset for plane V. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00214">SpacePointAlg.h:214</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aa5fadf661ecd9fc31367d63270b721e7"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">trkf::SpacePointAlg::fTickOffsetW</a></div><div class="ttdeci">double fTickOffsetW</div><div class="ttdoc">Tick offset for plane W. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00215">SpacePointAlg.h:215</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1d724375215b3762ce7411f2d93588b3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">trkf::SpacePointAlg::fMinViews</a></div><div class="ttdeci">int fMinViews</div><div class="ttdoc">Mininum number of views per space point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00206">SpacePointAlg.h:206</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7c715309641498a1b8f2c358fcbbe4d9"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">trkf::SpacePointAlg::fMerge</a></div><div class="ttdeci">bool fMerge</div><div class="ttdoc">Merge flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00211">SpacePointAlg.h:211</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a76b19c3723486c679453d62ef7e94b0e"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">trkf::SpacePointAlg::fEnableV</a></div><div class="ttdeci">bool fEnableV</div><div class="ttdoc">Enable flag (V). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00208">SpacePointAlg.h:208</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a932bf44eae12a46fc0662dc64ba0d762"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::clearHitMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00181">181</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.clear();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7927dbe026b0c8c4e4e5987e6757b04f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::compatible </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useMC</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00277">277</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> nhits = hits.size();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Fewer than two or more than three hits can never be compatible.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">bool</span> result = nhits &gt;= 2 &amp;&amp; nhits &lt;= 3;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">bool</span> mc_ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (result) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">// First do pairwise tests.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// Do double loop over hits.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ihit1 = 0; result &amp;&amp; ihit1 &lt; nhits - 1; ++ihit1) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit1 = *(hits[ihit1]);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hit1WireID = hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view1 = hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">double</span> t1 = hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() -</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(hit1WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hit1WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, hit1WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">// If using mc information, get a collection of track ids for hit 1.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">// If not using mc information, this section of code will trigger the</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">// insertion of a single invalid HitMCInfo object into fHitMCMap.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">const</span> HitMCInfo&amp; mcinfo1 = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>[(useMC ? &amp;hit1 : 0)];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; tid1 = mcinfo1.trackIDs;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordtype">bool</span> only_neg1 = tid1.size() &gt; 0 &amp;&amp; tid1.back() &lt; 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Loop over second hit.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ihit2 = ihit1 + 1; result &amp;&amp; ihit2 &lt; nhits; ++ihit2) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit2 = *(hits[ihit2]);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hit2WireID = hit2.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view2 = hit2.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="comment">// Test for same tpc and different views.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          result = result &amp;&amp; hit1WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> == hit2WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> &amp;&amp; view1 != view2 &amp;&amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                   hit1WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> == hit2WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="keywordflow">if</span> (result) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">// Remember which tpc and cryostat we are in.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            tpc = hit1WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            cstat = hit1WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordtype">double</span> t2 = hit2.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                            hit2WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hit2WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, hit2WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">// Test maximum time difference.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            result = result &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(t1 - t2) &lt;= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">// Test mc truth.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">if</span> (result &amp;&amp; useMC) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              <span class="comment">// Test whether hits have a common parent track id.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keyword">const</span> HitMCInfo&amp; mcinfo2 = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>[&amp;hit2];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;              std::vector&lt;int&gt; tid2 = mcinfo2.trackIDs;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="keywordtype">bool</span> only_neg2 = tid2.size() &gt; 0 &amp;&amp; tid2.back() &lt; 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;              std::vector&lt;int&gt;::iterator it = std::set_intersection(</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                tid1.begin(), tid1.end(), tid2.begin(), tid2.end(), tid2.begin());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;              tid2.resize(it - tid2.begin());</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;              <span class="comment">// Hits are compatible if they have parents in common.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              <span class="comment">// If the only parent id in common is negative (-999),</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              <span class="comment">// then hits are compatible only if both hits have only</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              <span class="comment">// negative parent tracks.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              <span class="keywordtype">bool</span> only_neg3 = tid2.size() &gt; 0 &amp;&amp; tid2.back() &lt; 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              mc_ok = tid2.size() &gt; 0 &amp;&amp; (!only_neg3 || (only_neg1 &amp;&amp; only_neg2));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              result = result &amp;&amp; mc_ok;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;              <span class="comment">// If we are still OK, check that either hit is</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;              <span class="comment">// the nearest neighbor of the other.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;              <span class="keywordflow">if</span> (result) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                result = mcinfo1.pchit[hit2WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] == &amp;hit2 ||</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                         mcinfo2.pchit[hit1WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] == &amp;hit1;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;              }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// If there are exactly three hits, and they pass pairwise tests, check</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// for spatial compatibility.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (result &amp;&amp; nhits == 3) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// Loop over hits.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordtype">double</span> sinth[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordtype">double</span> costh[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="comment">// Get tpc, plane, wire.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = *(hits[i]);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeom = geom-&gt;WireIDToWireGeo(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="keywordflow">if</span> ((hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> != tpc) || (hitWireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> != cstat))</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;compatible(): geometry mismatch\n&quot;</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="comment">// Get angles and distance of wire.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          <span class="keywordtype">double</span> hl = wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="keywordtype">double</span> xyz1[3];</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz1, hl);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = (xyz1[1] - xyz[1]) / hl;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="keywordtype">double</span> c = (xyz1[2] - xyz[2]) / hl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          sinth[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          costh[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = c;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          dist[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = xyz[2] * s - xyz[1] * c;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// Do space cut.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a> = ((sinth[1] * costh[2] - costh[1] * sinth[2]) * dist[0] +</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    (sinth[2] * costh[0] - costh[2] * sinth[0]) * dist[1] +</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    (sinth[0] * costh[1] - costh[0] * sinth[1]) * dist[2]);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        result = result &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(S) &lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Done.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_a04e39dabfbb7bad6da7fd87b7431a845"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a></div><div class="ttdeci">see a below echo S(symbol in a section other than those above)</div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ac7eba2eaf2795a2a922511779faeb6c1"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">trkf::SpacePointAlg::fHitMCMap</a></div><div class="ttdeci">std::map&lt; const recob::Hit *, HitMCInfo &gt; fHitMCMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00225">SpacePointAlg.h:225</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a9d43b56724e1577e314b26e30bbb5e48"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">trkf::SpacePointAlg::fMaxDT</a></div><div class="ttdeci">double fMaxDT</div><div class="ttdoc">Maximum time difference between planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00204">SpacePointAlg.h:204</a></div></div>
<div class="ttc" id="namespacegeo_html_a6baec40eaf3ff161f7eb1a5f0779794f"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a></div><div class="ttdeci">enum geo::_plane_proj View_t</div><div class="ttdoc">Enumerate the possible plane projections. </div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a025b7a27fcb52523170cf0e0b2ab5c03"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">recob::Hit::View</a></div><div class="ttdeci">geo::View_t View() const </div><div class="ttdoc">View for the plane of the hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00232">Hit.h:232</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7a27449c7c640a7a0acdf3d40f8f6b01"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">trkf::SpacePointAlg::fMaxS</a></div><div class="ttdeci">double fMaxS</div><div class="ttdoc">Maximum space separation between wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00205">SpacePointAlg.h:205</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c9cae76cb97c0bc8773470bd95fcbea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::correctedTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &amp;&#160;</td>
          <td class="paramname"><em>hit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00167">167</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Get services.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// Correct time for trigger offset and plane-dependent time offsets.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">double</span> t = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() -</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;               <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>() == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a>)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      t -= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">fTickOffsetU</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>() == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      t -= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">fTickOffsetV</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>() == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a7aa5678675f243c5e03583de1bfe1b4e">geo::kW</a>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      t -= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">fTickOffsetW</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a72df8a610502c189f835b5c32a64d975"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a72df8a610502c189f835b5c32a64d975">trkf::SpacePointAlg::fTickOffsetU</a></div><div class="ttdeci">double fTickOffsetU</div><div class="ttdoc">Tick offset for plane U. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00213">SpacePointAlg.h:213</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a></div><div class="ttdoc">Planes which measure V. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00130">geo_types.h:130</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a025b7a27fcb52523170cf0e0b2ab5c03"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">recob::Hit::View</a></div><div class="ttdeci">geo::View_t View() const </div><div class="ttdoc">View for the plane of the hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00232">Hit.h:232</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a></div><div class="ttdoc">Planes which measure U. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00129">geo_types.h:129</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a5bdedbda8245291bfa18995efca0fd7c"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a5bdedbda8245291bfa18995efca0fd7c">trkf::SpacePointAlg::fTickOffsetV</a></div><div class="ttdeci">double fTickOffsetV</div><div class="ttdoc">Tick offset for plane V. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00214">SpacePointAlg.h:214</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aa5fadf661ecd9fc31367d63270b721e7"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aa5fadf661ecd9fc31367d63270b721e7">trkf::SpacePointAlg::fTickOffsetW</a></div><div class="ttdeci">double fTickOffsetW</div><div class="ttdoc">Tick offset for plane W. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00215">SpacePointAlg.h:215</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486a7aa5678675f243c5e03583de1bfe1b4e"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a7aa5678675f243c5e03583de1bfe1b4e">geo::kW</a></div><div class="ttdoc">Planes which measure W (third view for Bo, MicroBooNE, etc). </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00131">geo_types.h:131</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ecb37b95c2a7a58f3360111af4e9876"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::enableU </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00111">111</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">fEnableU</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1a36a047288595882c58b053651d40c2"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">trkf::SpacePointAlg::fEnableU</a></div><div class="ttdeci">bool fEnableU</div><div class="ttdoc">Enable flag (U). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00207">SpacePointAlg.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a07019d8e2e1fd03dbccab934c35cb74d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::enableV </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00116">116</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">fEnableV</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a76b19c3723486c679453d62ef7e94b0e"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">trkf::SpacePointAlg::fEnableV</a></div><div class="ttdeci">bool fEnableV</div><div class="ttdoc">Enable flag (V). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00208">SpacePointAlg.h:208</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab85902c468adfe1a87c41f389daf1014"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::enableW </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00121">121</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">fEnableW</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_adbcef335053102f807b531bc5aedfdfa"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">trkf::SpacePointAlg::fEnableW</a></div><div class="ttdeci">bool fEnableW</div><div class="ttdoc">Enable flag (W). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00209">SpacePointAlg.h:209</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a54689b4bd761a33189b79111a4d40c94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::fillComplexSpacePoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sptv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sptid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00634">634</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// Calculate time pitch.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">double</span> timePitch = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksCoefficient(); <span class="comment">// cm / tick</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// Figure out which tpc we are in.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc0 = 0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat0 = 0;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">int</span> nhits = hits.size();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (nhits &gt; 0) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      tpc0 = hits.front()-&gt;WireID().TPC;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      cstat0 = hits.front()-&gt;WireID().Cryostat;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Remember associated hits internally.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.count(sptid) != 0)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;fillComplexSpacePoint(): hit already present!\n&quot;</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>[sptid] = hits;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// Do a preliminary scan of hits.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// Determine weight given to hits in each view.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nplanes = geom-&gt;Cryostat(cstat0).TPC(tpc0).Nplanes();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    std::vector&lt;int&gt; numhits(nplanes, 0);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    std::vector&lt;double&gt; weight(nplanes, 0.);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         ++ihit) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = **ihit;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="comment">// kept as assertions for performance reasons</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      assert(hitWireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> == cstat0);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      assert(hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> == tpc0);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      assert(hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> &lt; nplanes);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      ++numhits[hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane = 0; plane &lt; nplanes; ++plane) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordtype">double</span> np = numhits[plane];</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">if</span> (np &gt; 0.) weight[plane] = 1. / (np * np * np);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// Calculate position and error matrix.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">double</span> xyz[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">double</span> errxyz[6] = {0., 0., 0., 0., 0., 0.};</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// Calculate x using drift times.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// Loop over all hits and calculate the weighted average drift time.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// Also calculate time variance and chisquare.</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordtype">double</span> sumt2w = 0.;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">double</span> sumtw = 0.;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">double</span> sumw = 0.;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;         ++ihit) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit = **ihit;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="comment">// Correct time for trigger offset and view-dependent time offsets.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a> = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, hitWireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordtype">double</span> t = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordtype">double</span> et = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">SigmaPeakTime</a>();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = weight[hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] / (et * et);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      sumt2w += w * t * t;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      sumtw += w * t;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      sumw += <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">double</span> drift_time = 0.;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">double</span> var_time = 0.;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">double</span> chisq = 0.;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (sumw != 0.) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      drift_time = sumtw / sumw;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      var_time = sumt2w / sumw - drift_time * drift_time;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">if</span> (var_time &lt; 0.) var_time = 0.;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      chisq = sumt2w - sumtw * drift_time;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (chisq &lt; 0.) chisq = 0.;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    xyz[0] = drift_time * timePitch;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    errxyz[0] = var_time * timePitch * timePitch;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// Calculate y, z using wires (need at least two hits).</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (nhits &gt;= 2) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="comment">// Calculate y and z by chisquare minimization of wire coordinates.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordtype">double</span> sw = 0.;  <span class="comment">// sum w_i</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordtype">double</span> sus = 0.; <span class="comment">// sum w_i u_i sin_th_i</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordtype">double</span> suc = 0.; <span class="comment">// sum w_i u_i cos_th_i</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordtype">double</span> sc2 = 0.; <span class="comment">// sum w_i cos2_th_i</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordtype">double</span> ss2 = 0.; <span class="comment">// sum w_i sin2_th_i</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordtype">double</span> ssc = 0.; <span class="comment">// sum w_i sin_th_i cos_th_i</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="comment">// Loop over points.</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;           ++ihit) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit = **ihit;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeom = geom-&gt;WireIDToWireGeo(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="comment">// Calculate angle and wire coordinate in this view.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordtype">double</span> hl = wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordtype">double</span> cen[3];</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordtype">double</span> cen1[3];</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(cen);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(cen1, hl);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = (cen1[1] - cen[1]) / hl;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordtype">double</span> c = (cen1[2] - cen[2]) / hl;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">double</span> u = cen[2] * s - cen[1] * c;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">double</span> eu = geom-&gt;WirePitch(hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>) / std::sqrt(12.);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = weight[hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] / (eu * eu);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">// Summations</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        sw += <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        sus += w * u * <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        suc += w * u * c;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        sc2 += w * c * c;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        ss2 += w * s * <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        ssc += w * s * c;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="comment">// Calculate y,z</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordtype">double</span> denom = sc2 * ss2 - ssc * ssc;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">if</span> (denom != 0.) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        xyz[1] = (-suc * ss2 + sus * ssc) / denom;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        xyz[2] = (sus * sc2 - suc * ssc) / denom;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        errxyz[2] = ss2 / denom;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        errxyz[4] = ssc / denom;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        errxyz[5] = sc2 / denom;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="comment">// Make space point.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> spt(xyz, errxyz, chisq, sptid);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      sptv.push_back(spt);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_a2b8237bac57d5c373c623869ad4513c8"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">make_calib_df.t0</a></div><div class="ttdeci">int t0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00042">make_calib_df.py:42</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a1952360bd63d45e0c14fd07764076ef2"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">recob::Hit::SigmaPeakTime</a></div><div class="ttdeci">float SigmaPeakTime() const </div><div class="ttdoc">Uncertainty for the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00219">Hit.h:219</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00023">SpacePoint.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec6180a5a8b4330cb1c4c11f5b5d1dd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::fillSpacePoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sptv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sptid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00428">428</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">double</span> timePitch = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksCoefficient();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">int</span> nhits = hits.size();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// Remember associated hits internally.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.find(sptid) != <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.end())</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;fillSpacePoint(): hit already present!\n&quot;</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>[sptid] = hits;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// Calculate position and error matrix.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">double</span> xyz[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">double</span> errxyz[6] = {0., 0., 0., 0., 0., 0.};</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// Calculate x using drift times.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// Loop over all hits and calculate the weighted average drift time.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// Also calculate time variance and chisquare.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">double</span> sumt2w = 0.;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">double</span> sumtw = 0.;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">double</span> sumw = 0.;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         ++ihit) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = **ihit;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">// Correct time for trigger offset and view-dependent time offsets.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a> = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, hitWireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">double</span> t = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordtype">double</span> et = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">SigmaPeakTime</a>();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = 1. / (et * et);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      sumt2w += w * t * t;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      sumtw += w * t;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      sumw += <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">double</span> drift_time = 0.;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">double</span> var_time = 0.;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">double</span> chisq = 0.;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> (sumw != 0.) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      drift_time = sumtw / sumw;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="comment">//var_time = sumt2w / sumw - drift_time * drift_time;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      var_time = 1. / sumw;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">if</span> (var_time &lt; 0.) var_time = 0.;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      chisq = sumt2w - sumtw * drift_time;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">if</span> (chisq &lt; 0.) chisq = 0.;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    xyz[0] = drift_time * timePitch;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    errxyz[0] = var_time * timePitch * timePitch;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Calculate y, z using wires (need at least two hits).</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (nhits &gt;= 2) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// Calculate y and z by chisquare minimization of wire coordinates.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordtype">double</span> sw = 0.;  <span class="comment">// sum w_i</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordtype">double</span> sus = 0.; <span class="comment">// sum w_i u_i sin_th_i</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordtype">double</span> suc = 0.; <span class="comment">// sum w_i u_i cos_th_i</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordtype">double</span> sc2 = 0.; <span class="comment">// sum w_i cos2_th_i</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordtype">double</span> ss2 = 0.; <span class="comment">// sum w_i sin2_th_i</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordtype">double</span> ssc = 0.; <span class="comment">// sum w_i sin_th_i cos_th_i</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// Loop over points.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;           ++ihit) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit = **ihit;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeom = geom-&gt;WireIDToWireGeo(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// Calculate angle and wire coordinate in this view.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">double</span> hl = wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordtype">double</span> cen[3];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">double</span> cen1[3];</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(cen);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(cen1, hl);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = (cen1[1] - cen[1]) / hl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordtype">double</span> c = (cen1[2] - cen[2]) / hl;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordtype">double</span> u = cen[2] * s - cen[1] * c;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordtype">double</span> eu = geom-&gt;WirePitch(hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, hitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>) / std::sqrt(12.);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = 1. / (eu * eu);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">// Summations</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        sw += <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        sus += w * u * <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        suc += w * u * c;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        sc2 += w * c * c;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        ss2 += w * s * <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ssc += w * s * c;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">// Calculate y,z</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordtype">double</span> denom = sc2 * ss2 - ssc * ssc;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (denom != 0.) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        xyz[1] = (-suc * ss2 + sus * ssc) / denom;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        xyz[2] = (sus * sc2 - suc * ssc) / denom;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        errxyz[2] = ss2 / denom;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        errxyz[4] = ssc / denom;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        errxyz[5] = sc2 / denom;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="comment">// Make space point.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> spt(xyz, errxyz, chisq, sptid);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      sptv.push_back(spt);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_a2b8237bac57d5c373c623869ad4513c8"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">make_calib_df.t0</a></div><div class="ttdeci">int t0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00042">make_calib_df.py:42</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a1952360bd63d45e0c14fd07764076ef2"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">recob::Hit::SigmaPeakTime</a></div><div class="ttdeci">float SigmaPeakTime() const </div><div class="ttdoc">Uncertainty for the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00219">Hit.h:219</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00023">SpacePoint.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c3ba596cb07ea6f99d9ed288cac1bf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::fillSpacePoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multimap&lt; double, <a class="el" href="../../d0/d93/classtrkf_1_1KHitTrack.html">KHitTrack</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>trackMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a collection of space points. </p>
<p>Fill a collection of space points.</p>
<p>Arguments:</p>
<p>spts - Collection of space points to fill. sptalg - Space point algorithm object.</p>
<p>This method uses the hits contained in this track to construct space points.</p>
<p>This method does not have any knowledge of what constitutes a good space point, except that Hits are required to be consecutive when sorted by path distance, and space points are required to pass compatibility tests used by the space point algorithm object. This method will make space points from either two or three Hits (even for three-plane detectors), if the space point algorithm is configured to allow it. </p>

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00573">573</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// Loop over KHitTracks.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    art::PtrVector&lt;recob::Hit&gt; hits;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    art::PtrVector&lt;recob::Hit&gt; compatible_hits;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">for</span> (std::multimap&lt;double, KHitTrack&gt;::const_iterator it = trackMap.begin();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;         it != trackMap.end();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         ++it) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keyword">const</span> KHitTrack&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a> = (*it).second;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="comment">// Extrack Hit from track.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keyword">const</span> std::shared_ptr&lt;const KHitBase&gt;&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = track.getHit();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keyword">const</span> KHitWireX* phit = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>KHitWireX*<span class="keyword">&gt;</span>(&amp;*<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">if</span> (phit != 0) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt; prhit = phit-&gt;getHit();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// Test this hit for compatibility.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        hits.push_back(prhit);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordtype">bool</span> ok = this-&gt;<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">compatible</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hits);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (!ok) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="comment">// The new hit is not compatible.  Make a space point out of</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="comment">// the last known compatible hits, provided there are at least</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="comment">// two.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <span class="keywordflow">if</span> (compatible_hits.size() &gt;= 2) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            this-&gt;<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">fillSpacePoint</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, compatible_hits, spts, this-&gt;<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#af72426e4adcea9b90fecb919ed8ca3f5">numHitMap</a>());</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            compatible_hits.clear();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="comment">// Forget about any previous hits.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          hits.clear();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          hits.push_back(prhit);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">// Update the list of known compatible hits.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        compatible_hits = hits;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// Maybe make one final space point.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (compatible_hits.size() &gt;= 2) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      this-&gt;<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">fillSpacePoint</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, compatible_hits, spts, this-&gt;<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#af72426e4adcea9b90fecb919ed8ca3f5">numHitMap</a>());</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="ttc" id="standard__reco_8fcl_html_a8e7c4631bab825a68b0a82d8223c2ec2"><div class="ttname"><a href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a></div><div class="ttdeci">process_name use argoneut_mc_hitfinder track</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df2/standard__reco_8fcl_source.html#l00036">standard_reco.fcl:36</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7927dbe026b0c8c4e4e5987e6757b04f"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">trkf::SpacePointAlg::compatible</a></div><div class="ttdeci">bool compatible(detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, bool useMC=false) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00277">SpacePointAlg.cxx:277</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_af72426e4adcea9b90fecb919ed8ca3f5"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#af72426e4adcea9b90fecb919ed8ca3f5">trkf::SpacePointAlg::numHitMap</a></div><div class="ttdeci">int numHitMap() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00188">SpacePointAlg.h:188</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aec6180a5a8b4330cb1c4c11f5b5d1dd8"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">trkf::SpacePointAlg::fillSpacePoint</a></div><div class="ttdeci">void fillSpacePoint(detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; recob::SpacePoint &gt; &amp;sptv, int sptid) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00428">SpacePointAlg.cxx:428</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f53b42a44aed5709088a10f894b7e30"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::filter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00086">86</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a008aac356cf9d575420a7c44f7c0ea40"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">trkf::SpacePointAlg::fFilter</a></div><div class="ttdeci">bool fFilter</div><div class="ttdoc">Filter flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00210">SpacePointAlg.h:210</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a21daf6d37253e815d61956a4d6ced46c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp; trkf::SpacePointAlg::getAssociatedHits </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &amp;&#160;</td>
          <td class="paramname"><em>spt</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l01495">1495</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// It is an error if no hits are associated with this space point (throw exception).</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    std::map&lt;int, art::PtrVector&lt;recob::Hit&gt;&gt;::const_iterator it = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.find(spt.<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a9aa5f938876ad987f773babe89bc4bc2">ID</a>());</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">if</span> (it == <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.end()) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Looking for ID &quot;</span> &lt;&lt; spt.<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a9aa5f938876ad987f773babe89bc4bc2">ID</a>() &lt;&lt; <span class="stringliteral">&quot; from &quot;</span> &lt;&lt; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;No Hits associated with space point.\n&quot;</span>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">return</span> (*it).second;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html_a9aa5f938876ad987f773babe89bc4bc2"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html#a9aa5f938876ad987f773babe89bc4bc2">recob::SpacePoint::ID</a></div><div class="ttdeci">ID_t ID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00075">SpacePoint.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f2d410b0f9ad9de58b79ef55dafa44a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::makeMCTruthSpacePoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;&#160;</td>
          <td class="paramname"><em>clockData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00810">810</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1b604504074eea09d792a92378982f90">makeSpacePoints</a>(clockData, <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hits, spts, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1b604504074eea09d792a92378982f90"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1b604504074eea09d792a92378982f90">trkf::SpacePointAlg::makeSpacePoints</a></div><div class="ttdeci">void makeSpacePoints(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; recob::SpacePoint &gt; &amp;spts) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00797">SpacePointAlg.cxx:797</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b604504074eea09d792a92378982f90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::makeSpacePoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;&#160;</td>
          <td class="paramname"><em>clockData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00797">797</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1b604504074eea09d792a92378982f90">makeSpacePoints</a>(clockData, <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hits, spts, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1b604504074eea09d792a92378982f90"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1b604504074eea09d792a92378982f90">trkf::SpacePointAlg::makeSpacePoints</a></div><div class="ttdeci">void makeSpacePoints(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; recob::SpacePoint &gt; &amp;spts) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00797">SpacePointAlg.cxx:797</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf7ad8047e45ba5240e140dfc4df1534"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::makeSpacePoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;&#160;</td>
          <td class="paramname"><em>clockData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useMC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000118">Todo:</a></b></dt><dd>Why are we still checking on whether this is MC or not? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000119">Todo:</a></b></dt><dd>Such checks should not be in reconstruction code. </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00823">823</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.clear();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// Print diagnostic information.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a044c4e8d86cb11df41230b474ced9c77">update</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// First make sure result vector is empty.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    spts.erase(spts.begin(), spts.end());</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">// Statistics.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">int</span> n2 = 0;     <span class="comment">// Number of two-hit space points.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">int</span> n3 = 0;     <span class="comment">// Number of three-hit space points.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">int</span> n2filt = 0; <span class="comment">// Number of two-hit space points after filtering/merging.</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">int</span> n3filt = 0; <span class="comment">// Number of three-hit space pointe after filtering/merging.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// Sort hits into maps indexed by [cryostat][tpc][plane][wire].</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// If using mc information, also generate maps of sim::IDEs and mc</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// position indexed by hit.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;std::multimap&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;&gt;&gt;&gt; hitmap;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>.clear();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncstat = geom-&gt;Ncryostats();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    hitmap.resize(ncstat);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; ncstat; ++cstat) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ntpc = geom-&gt;Cryostat(cstat).NTPC();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      hitmap[cstat].resize(ntpc);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; ntpc; ++tpc) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordtype">int</span> nplane = geom-&gt;Cryostat(cstat).TPC(tpc).Nplanes();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        hitmap[cstat][tpc].resize(nplane);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator ihit = hits.begin(); ihit != hits.end();</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;         ++ihit) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit = *ihit;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view = phit-&gt;View();</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">if</span> ((view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a> &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">fEnableU</a>) || (view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a> &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">fEnableV</a>) ||</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;          (view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64">geo::kZ</a> &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">fEnableW</a>)) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> phitWireID = phit-&gt;<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">WireID</a>();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        hitmap[phitWireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>][phitWireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>][phitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>].insert(</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          std::make_pair(phitWireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>, phit));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// Fill mc information, including IDEs and closest neighbors</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// of each hit.</span><span class="comment"></span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">    ///\todo Why are we still checking on whether this is MC or not?</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">    ///\todo Such checks should not be in reconstruction code.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (useMC) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      art::ServiceHandle&lt;cheat::BackTrackerService const&gt; bt_serv;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">// First loop over hits and fill track ids and mc position.</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; ncstat; ++cstat) {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; geom-&gt;Cryostat(cstat).NTPC(); ++tpc) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;          <span class="keywordtype">int</span> nplane = geom-&gt;Cryostat(cstat).TPC(tpc).Nplanes();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane = 0; plane &lt; nplane; ++plane) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">for</span> (std::map&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator ihit =</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                   hitmap[cstat][tpc][plane].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                 ihit != hitmap[cstat][tpc][plane].end();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                 ++ihit) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;              <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit = ihit-&gt;second;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = *phit;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;              HitMCInfo&amp; mcinfo = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>[&amp;<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]; <span class="comment">// Default HitMCInfo.</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;              <span class="comment">// Fill default nearest neighbor information (i.e. none).</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;              mcinfo.pchit.resize(nplane, 0);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;              mcinfo.dist2.resize(nplane, 1.e20);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;              <span class="comment">// Get sim::IDEs for this hit.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              std::vector&lt;sim::IDE&gt; ides = bt_serv-&gt;HitToAvgSimIDEs(clockData, phit);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;              <span class="comment">// Get sorted track ids. for this hit.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;              mcinfo.trackIDs.reserve(ides.size());</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;              <span class="keywordflow">for</span> (std::vector&lt;sim::IDE&gt;::const_iterator i = ides.begin(); i != ides.end(); ++i)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                mcinfo.trackIDs.push_back(i-&gt;trackID);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;              sort(mcinfo.trackIDs.begin(), mcinfo.trackIDs.end());</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;              <span class="comment">// Get position of ionization for this hit.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;              <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                mcinfo.xyz = bt_serv-&gt;SimIDEsToXYZ(ides);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;              }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                mcinfo.xyz.clear();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;              }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            } <span class="comment">// end loop over ihit</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          }   <span class="comment">// end loop oer planes</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        }     <span class="comment">// end loop over TPCs</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }       <span class="comment">// end loop over cryostats</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="comment">// Loop over hits again and fill nearest neighbor information for real.</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; ncstat; ++cstat) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; geom-&gt;Cryostat(cstat).NTPC(); ++tpc) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          <span class="keywordtype">int</span> nplane = geom-&gt;Cryostat(cstat).TPC(tpc).Nplanes();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane = 0; plane &lt; nplane; ++plane) {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordflow">for</span> (std::map&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator ihit =</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                   hitmap[cstat][tpc][plane].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                 ihit != hitmap[cstat][tpc][plane].end();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                 ++ihit) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;              <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit = ihit-&gt;second;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit = *phit;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;              HitMCInfo&amp; mcinfo = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>[&amp;<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>];</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;              <span class="keywordflow">if</span> (mcinfo.xyz.size() != 0) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                assert(mcinfo.xyz.size() == 3);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <span class="comment">// Fill nearest neighbor information for this hit.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane2 = 0; plane2 &lt; nplane; ++plane2) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                  <span class="keywordflow">for</span> (std::map&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator jhit =</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                         hitmap[cstat][tpc][plane2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>();</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                       jhit != hitmap[cstat][tpc][plane2].end();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                       ++jhit) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit2 = jhit-&gt;second;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit2 = *phit2;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    <span class="keyword">const</span> HitMCInfo&amp; mcinfo2 = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">fHitMCMap</a>[&amp;hit2];</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="keywordflow">if</span> (mcinfo2.xyz.size() != 0) {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                      assert(mcinfo2.xyz.size() == 3);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                      <span class="keywordtype">double</span> dx = mcinfo.xyz[0] - mcinfo2.xyz[0];</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                      <span class="keywordtype">double</span> dy = mcinfo.xyz[1] - mcinfo2.xyz[1];</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                      <span class="keywordtype">double</span> dz = mcinfo.xyz[2] - mcinfo2.xyz[2];</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                      <span class="keywordtype">double</span> dist2 = dx * dx + dy * dy + dz * dz;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                      <span class="keywordflow">if</span> (dist2 &lt; mcinfo.dist2[plane2]) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        mcinfo.dist2[plane2] = dist2;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        mcinfo.pchit[plane2] = &amp;hit2;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                      }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    } <span class="comment">// end if mcinfo2.xyz valid</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                  }   <span class="comment">// end loop over jhit</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                }     <span class="comment">// end loop over plane2</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;              }       <span class="comment">// end if mcinfo.xyz valid.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            }         <span class="comment">// end loop over ihit</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          }           <span class="comment">// end loop over plane</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }             <span class="comment">// end loop over tpc</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }               <span class="comment">// end loop over cryostats</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    }                 <span class="comment">// end if MC</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// use mf::LogDebug instead of MF_LOG_DEBUG because we reuse it in many lines</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// insertions are protected by mf::isDebugEnabled()</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    mf::LogDebug <a class="code" href="../../dd/db0/testFHiCLfiles_8sh.html#a0514aabed091ee5e2f35766eb01eced6">debug</a>(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">if</span> (mf::isDebugEnabled()) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="../../dd/db0/testFHiCLfiles_8sh.html#a0514aabed091ee5e2f35766eb01eced6">debug</a> &lt;&lt; <span class="stringliteral">&quot;Total hits = &quot;</span> &lt;&lt; hits.size() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; ncstat; ++cstat) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; geom-&gt;Cryostat(cstat).NTPC(); ++tpc) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          <span class="keywordtype">int</span> nplane = hitmap[cstat][tpc].size();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane = 0; plane &lt; nplane; ++plane) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <a class="code" href="../../dd/db0/testFHiCLfiles_8sh.html#a0514aabed091ee5e2f35766eb01eced6">debug</a> &lt;&lt; <span class="stringliteral">&quot;TPC, Plane: &quot;</span> &lt;&lt; tpc &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; plane</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;, hits = &quot;</span> &lt;&lt; hitmap[cstat][tpc][plane].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      } <span class="comment">// end loop over cryostats</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }   <span class="comment">// if debug</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// Make empty multimap from hit pointer on preferred</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// (most-populated or collection) plane to space points that</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// include that hit (used for sorting, filtering, and</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// merging).</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>* sptkey_type;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    std::multimap&lt;sptkey_type, recob::SpacePoint&gt; sptmap;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    std::set&lt;sptkey_type&gt; sptkeys; <span class="comment">// Keys of multimap.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// Loop over TPCs.</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; ncstat; ++cstat) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; geom-&gt;Cryostat(cstat).NTPC(); ++tpc) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> tpcid(cstat, tpc);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">// Sort maps in increasing order of number of hits.</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">// This is so that we can do the outer loops over hits</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">// over the views with fewer hits.</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="comment">// If config parameter PreferColl is true, treat the colleciton</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">// plane as if it had the most hits, regardless of how many</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="comment">// hits it actually has.  This will force space points to be</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="comment">// filtered and merged with respect to the collection plane</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="comment">// wires.  It will also force space points to be sorted by</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="comment">// collection plane wire.</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordtype">int</span> nplane = hitmap[cstat][tpc].size();</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        std::vector&lt;int&gt; index(nplane);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nplane; ++i)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          index[i] = i;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nplane - 1; ++i) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; nplane; ++j) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordtype">bool</span> icoll =</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;              <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a> &amp;&amp; geom-&gt;SignalType(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a>(tpcid, index[i])) == <a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <span class="keywordtype">bool</span> jcoll =</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;              <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a> &amp;&amp; geom-&gt;SignalType(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a>(tpcid, index[j])) == <a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keywordflow">if</span> ((hitmap[cstat][tpc][index[i]].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; hitmap[cstat][tpc][index[j]].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &amp;&amp;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                 !jcoll) ||</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                icoll) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;              <span class="keywordtype">int</span> temp = index[i];</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;              index[i] = index[j];</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;              index[j] = temp;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;          }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        } <span class="comment">// end loop over i</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="comment">// how many views with hits?</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">// This will allow for the special case where we might have only 2 planes of information and</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="comment">// still want space points even if a three plane TPC</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        std::vector&lt;std::multimap&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;&gt;&amp; hitsByPlaneVec =</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          hitmap[cstat][tpc];</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keywordtype">int</span> nViewsWithHits(0);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nplane; i++) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          <span class="keywordflow">if</span> (hitsByPlaneVec[index[i]].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; 0) nViewsWithHits++;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">// If two-view space points are allowed, make a double loop</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">// over hits and produce space points for compatible hit-pairs.</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> ((nViewsWithHits == 2 || nplane == 2) &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a> &lt;= 2) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <span class="comment">// Loop over pairs of views.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nplane - 1; ++i) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane1 = index[i];</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">if</span> (hitmap[cstat][tpc][plane1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; nplane; ++j) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane2 = index[j];</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;              <span class="keywordflow">if</span> (hitmap[cstat][tpc][plane2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;              <span class="comment">// Get angle, pitch, and offset of plane2 wires.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo2 = geom-&gt;Cryostat(cstat).TPC(tpc).Plane(plane2).Wire(0);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;              <span class="keywordtype">double</span> hl2 = wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;              <span class="keywordtype">double</span> xyz21[3];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;              <span class="keywordtype">double</span> xyz22[3];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;              wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz21, -hl2);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;              wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz22, hl2);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;              <span class="keywordtype">double</span> s2 = (xyz22[1] - xyz21[1]) / (2. * hl2);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;              <span class="keywordtype">double</span> c2 = (xyz22[2] - xyz21[2]) / (2. * hl2);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;              <span class="keywordtype">double</span> dist2 = -xyz21[1] * c2 + xyz21[2] * s2;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;              <span class="keywordtype">double</span> pitch2 = geom-&gt;WirePitch(plane2, tpc, cstat);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">fPreferColl</a> &amp;&amp;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                  hitmap[cstat][tpc][plane1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; hitmap[cstat][tpc][plane2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>())</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;makeSpacePoints(): hitmaps with incompatible size\n&quot;</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;              <span class="comment">// Loop over pairs of hits.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;              art::PtrVector&lt;recob::Hit&gt; hitvec;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;              hitvec.reserve(2);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;              <span class="keywordflow">for</span> (std::map&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator ihit1 =</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                     hitmap[cstat][tpc][plane1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>();</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                   ihit1 != hitmap[cstat][tpc][plane1].end();</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                   ++ihit1) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit1 = ihit1-&gt;second;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> phit1WireID = phit1-&gt;<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">WireID</a>();</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo = geom-&gt;WireIDToWireGeo(phit1WireID);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                <span class="comment">// Get endpoint coordinates of this wire.</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <span class="comment">// (kept as assertions for performance reasons)</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                assert(phit1WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> == cstat);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                assert(phit1WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> == tpc);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                assert(phit1WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> == plane1);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <span class="keywordtype">double</span> hl1 = wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                <span class="keywordtype">double</span> xyz1[3];</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                <span class="keywordtype">double</span> xyz2[3];</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz1, -hl1);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz2, hl1);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="comment">// Find the plane2 wire numbers corresponding to the endpoints.</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="keywordtype">double</span> wire21 = (-xyz1[1] * c2 + xyz1[2] * s2 - dist2) / pitch2;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="keywordtype">double</span> wire22 = (-xyz2[1] * c2 + xyz2[2] * s2 - dist2) / pitch2;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="keywordtype">int</span> wmin = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., std::min(wire21, wire22));</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordtype">int</span> wmax = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(wire21, wire22) + 1.);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                std::map&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                  ihit2 = hitmap[cstat][tpc][plane2].lower_bound(wmin),</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                  ihit2end = hitmap[cstat][tpc][plane2].upper_bound(wmax);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">for</span> (; ihit2 != ihit2end; ++ihit2) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                  <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit2 = ihit2-&gt;second;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                  <span class="comment">// Check current pair of hits for compatibility.</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                  <span class="comment">// By construction, hits should always have compatible views</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                  <span class="comment">// and times, but may not have compatible mc information.</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                  hitvec.clear();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                  hitvec.push_back(phit1);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                  hitvec.push_back(phit2);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                  <span class="keywordtype">bool</span> ok = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">compatible</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hitvec, useMC);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                  <span class="keywordflow">if</span> (ok) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                    <span class="comment">// Add a space point.</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    ++n2;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    <span class="comment">// make a dummy vector of recob::SpacePoints</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                    <span class="comment">// as we are filtering or merging and don&#39;t want to</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    <span class="comment">// add the created SpacePoint to the final collection just yet</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    <span class="comment">// This dummy vector will hold just one recob::SpacePoint,</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    <span class="comment">// which will go into the multimap and then the vector</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    <span class="comment">// will go out of scope.</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                    std::vector&lt;recob::SpacePoint&gt; sptv;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                    <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">fillSpacePoint</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hitvec, sptv, sptmap.size());</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                    sptkey_type key = &amp;*phit2;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    sptmap.insert(std::pair&lt;sptkey_type, recob::SpacePoint&gt;(key, sptv.back()));</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    sptkeys.insert(key);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                  }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;              }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        } <span class="comment">// end if fMinViews &lt;= 2</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="comment">// If three-view space points are allowed, make a triple loop</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// over hits and produce space points for compatible triplets.</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="keywordflow">if</span> (nplane &gt;= 3 &amp;&amp; <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a> &lt;= 3) {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          <span class="comment">// Loop over triplets of hits.</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          art::PtrVector&lt;recob::Hit&gt; hitvec;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;          hitvec.reserve(3);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane1 = index[0];</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane2 = index[1];</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane3 = index[2];</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <span class="comment">// Get angle, pitch, and offset of plane1 wires.</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo1 = geom-&gt;Cryostat(cstat).TPC(tpc).Plane(plane1).Wire(0);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          <span class="keywordtype">double</span> hl1 = wgeo1.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          <span class="keywordtype">double</span> xyz11[3];</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <span class="keywordtype">double</span> xyz12[3];</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          wgeo1.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz11, -hl1);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;          wgeo1.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz12, hl1);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;          <span class="keywordtype">double</span> s1 = (xyz12[1] - xyz11[1]) / (2. * hl1);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          <span class="keywordtype">double</span> c1 = (xyz12[2] - xyz11[2]) / (2. * hl1);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          <span class="keywordtype">double</span> dist1 = -xyz11[1] * c1 + xyz11[2] * s1;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;          <span class="keywordtype">double</span> pitch1 = geom-&gt;WirePitch(plane1, tpc, cstat);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> TicksOffset1 = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(plane1, tpc, cstat);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <span class="comment">// Get angle, pitch, and offset of plane2 wires.</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo2 = geom-&gt;Cryostat(cstat).TPC(tpc).Plane(plane2).Wire(0);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <span class="keywordtype">double</span> hl2 = wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          <span class="keywordtype">double</span> xyz21[3];</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <span class="keywordtype">double</span> xyz22[3];</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz21, -hl2);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;          wgeo2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz22, hl2);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;          <span class="keywordtype">double</span> s2 = (xyz22[1] - xyz21[1]) / (2. * hl2);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          <span class="keywordtype">double</span> c2 = (xyz22[2] - xyz21[2]) / (2. * hl2);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          <span class="keywordtype">double</span> dist2 = -xyz21[1] * c2 + xyz21[2] * s2;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          <span class="keywordtype">double</span> pitch2 = geom-&gt;WirePitch(plane2, tpc, cstat);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> TicksOffset2 = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(plane2, tpc, cstat);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;          <span class="comment">// Get angle, pitch, and offset of plane3 wires.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo3 = geom-&gt;Cryostat(cstat).TPC(tpc).Plane(plane3).Wire(0);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          <span class="keywordtype">double</span> hl3 = wgeo3.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          <span class="keywordtype">double</span> xyz31[3];</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;          <span class="keywordtype">double</span> xyz32[3];</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          wgeo3.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz31, -hl3);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          wgeo3.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz32, hl3);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;          <span class="keywordtype">double</span> s3 = (xyz32[1] - xyz31[1]) / (2. * hl3);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;          <span class="keywordtype">double</span> c3 = (xyz32[2] - xyz31[2]) / (2. * hl3);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;          <span class="keywordtype">double</span> dist3 = -xyz31[1] * c3 + xyz31[2] * s3;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          <span class="keywordtype">double</span> pitch3 = geom-&gt;WirePitch(plane3, tpc, cstat);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> TicksOffset3 = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(plane3, tpc, cstat);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          <span class="comment">// Get sine of angle differences.</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;          <span class="keywordtype">double</span> s12 = s1 * c2 - s2 * c1; <span class="comment">// sin(theta1 - theta2).</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          <span class="keywordtype">double</span> s23 = s2 * c3 - s3 * c2; <span class="comment">// sin(theta2 - theta3).</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          <span class="keywordtype">double</span> s31 = s3 * c1 - s1 * c3; <span class="comment">// sin(theta3 - theta1).</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;          <span class="comment">// Loop over hits in plane1.</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;          std::map&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            ihit1 = hitmap[cstat][tpc][plane1].begin(),</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            ihit1end = hitmap[cstat][tpc][plane1].end();</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;          <span class="keywordflow">for</span> (; ihit1 != ihit1end; ++ihit1) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire1 = ihit1-&gt;first;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit1 = ihit1-&gt;second;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> phit1WireID = phit1-&gt;<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">WireID</a>();</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeo = geom-&gt;WireIDToWireGeo(phit1WireID);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="comment">// Get endpoint coordinates of this wire from plane1.</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            <span class="comment">// (kept as assertions for performance reasons)</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            assert(phit1WireID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> == cstat);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            assert(phit1WireID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> == tpc);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            assert(phit1WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> == plane1);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            assert(phit1WireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a> == wire1);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordtype">double</span> hl1 = wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="keywordtype">double</span> xyz1[3];</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            <span class="keywordtype">double</span> xyz2[3];</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz1, -hl1);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            wgeo.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz2, hl1);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <span class="comment">// Get corrected time and oblique coordinate of first hit.</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="keywordtype">double</span> t1 = phit1-&gt;PeakTime() - TicksOffset1;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <span class="keywordtype">double</span> u1 = wire1 * pitch1 + dist1;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="comment">// Find the plane2 wire numbers corresponding to the endpoints.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            <span class="keywordtype">double</span> wire21 = (-xyz1[1] * c2 + xyz1[2] * s2 - dist2) / pitch2;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordtype">double</span> wire22 = (-xyz2[1] * c2 + xyz2[2] * s2 - dist2) / pitch2;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordtype">int</span> wmin = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., std::min(wire21, wire22));</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            <span class="keywordtype">int</span> wmax = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(wire21, wire22) + 1.);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            std::map&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              ihit2 = hitmap[cstat][tpc][plane2].lower_bound(wmin),</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;              ihit2end = hitmap[cstat][tpc][plane2].upper_bound(wmax);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keywordflow">for</span> (; ihit2 != ihit2end; ++ihit2) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;              <span class="keywordtype">int</span> wire2 = ihit2-&gt;first;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;              <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit2 = ihit2-&gt;second;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;              <span class="comment">// Get corrected time of second hit.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;              <span class="keywordtype">double</span> t2 = phit2-&gt;PeakTime() - TicksOffset2;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;              <span class="comment">// Check maximum time difference with first hit.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;              <span class="keywordtype">bool</span> dt12ok = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(t1 - t2) &lt;= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;              <span class="keywordflow">if</span> (dt12ok) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                <span class="comment">// Test first two hits for compatibility before looping</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                <span class="comment">// over third hit.</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                hitvec.clear();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                hitvec.push_back(phit1);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                hitvec.push_back(phit2);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <span class="keywordtype">bool</span> h12ok = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">compatible</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hitvec, useMC);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                <span class="keywordflow">if</span> (h12ok) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                  <span class="comment">// Get oblique coordinate of second hit.</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                  <span class="keywordtype">double</span> u2 = wire2 * pitch2 + dist2;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                  <span class="comment">// Predict plane3 oblique coordinate and wire number.</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                  <span class="keywordtype">double</span> u3pred = (-u1 * s23 - u2 * s31) / s12;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                  <span class="keywordtype">double</span> w3pred = (u3pred - dist3) / pitch3;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                  <span class="keywordtype">double</span> w3delta = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a> / (s12 * pitch3));</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                  <span class="keywordtype">int</span> w3min = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., std::ceil(w3pred - w3delta));</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                  <span class="keywordtype">int</span> w3max = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0., std::floor(w3pred + w3delta));</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                  std::map&lt;unsigned int, art::Ptr&lt;recob::Hit&gt;&gt;::const_iterator</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    ihit3 = hitmap[cstat][tpc][plane3].lower_bound(w3min),</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    ihit3end = hitmap[cstat][tpc][plane3].upper_bound(w3max);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                  <span class="keywordflow">for</span> (; ihit3 != ihit3end; ++ihit3) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    <span class="keywordtype">int</span> wire3 = ihit3-&gt;first;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; phit3 = ihit3-&gt;second;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    <span class="comment">// Get corrected time of third hit.</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    <span class="keywordtype">double</span> t3 = phit3-&gt;PeakTime() - TicksOffset3;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                    <span class="comment">// Check time difference of third hit compared to first two hits.</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    <span class="keywordtype">bool</span> dt123ok = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(t1 - t3) &lt;= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a> &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(t2 - t3) &lt;= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                    <span class="keywordflow">if</span> (dt123ok) {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                      <span class="comment">// Get oblique coordinate of third hit and check spatial separation.</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                      <span class="keywordtype">double</span> u3 = wire3 * pitch3 + dist3;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                      <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a> = s23 * u1 + s31 * u2 + s12 * u3;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                      <span class="keywordtype">bool</span> sok = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(S) &lt;= <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                      <span class="keywordflow">if</span> (sok) {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        <span class="comment">// Test triplet for compatibility.</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                        hitvec.clear();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                        hitvec.push_back(phit1);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                        hitvec.push_back(phit2);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        hitvec.push_back(phit3);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                        <span class="keywordtype">bool</span> h123ok = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">compatible</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hitvec, useMC);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                        <span class="keywordflow">if</span> (h123ok) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                          <span class="comment">// Add a space point.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                          ++n3;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                          <span class="comment">// make a dummy vector of recob::SpacePoints</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                          <span class="comment">// as we are filtering or merging and don&#39;t want to</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                          <span class="comment">// add the created SpacePoint to the final collection just yet</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                          <span class="comment">// This dummy vector will hold just one recob::SpacePoint,</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                          <span class="comment">// which will go into the multimap and then the vector</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                          <span class="comment">// will go out of scope.</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                          std::vector&lt;recob::SpacePoint&gt; sptv;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                          <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">fillSpacePoint</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, hitvec, sptv, sptmap.size() - 1);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                          sptkey_type key = &amp;*phit3;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                          sptmap.insert(</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                            std::pair&lt;sptkey_type, recob::SpacePoint&gt;(key, sptv.back()));</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                          sptkeys.insert(key);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                      }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                  }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;              }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        } <span class="comment">// end if fMinViews &lt;= 3</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="comment">// Do Filtering.</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">fFilter</a>) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          <span class="comment">// Transfer (some) space points from sptmap to spts.</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          spts.reserve(spts.size() + sptkeys.size());</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;          <span class="comment">// Loop over keys of space point map.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;          <span class="comment">// Space points that have the same key are candidates for filtering.</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          <span class="keywordflow">for</span> (std::set&lt;sptkey_type&gt;::const_iterator i = sptkeys.begin(); i != sptkeys.end(); ++i) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            sptkey_type key = *i;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            <span class="comment">// Loop over space points corresponding to the current key.</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <span class="comment">// Choose the single best space point from among this group.</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="keywordtype">double</span> best_chisq = 0.;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>* best_spt = 0;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            <span class="keywordflow">for</span> (std::multimap&lt;sptkey_type, recob::SpacePoint&gt;::const_iterator j =</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                   sptmap.lower_bound(key);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                 j != sptmap.upper_bound(key);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                 ++j) {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>&amp; spt = j-&gt;second;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;              <span class="keywordflow">if</span> (best_spt == 0 || spt.<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#affacd833f00e5080e14f5c29610df6ad">Chisq</a>() &lt; best_chisq) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                best_spt = &amp;spt;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                best_chisq = spt.<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#affacd833f00e5080e14f5c29610df6ad">Chisq</a>();</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;              }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="comment">// Transfer best filtered space point to result vector.</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            <span class="keywordflow">if</span> (!best_spt)</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;              <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;makeSpacePoints(): no best point\n&quot;</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            spts.push_back(*best_spt);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a> &lt;= 2)</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;              ++n2filt;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;              ++n3filt;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        } <span class="comment">// end if filtering</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="comment">// Do merging.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a>) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          <span class="comment">// Transfer merged space points from sptmap to spts.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          spts.reserve(spts.size() + sptkeys.size());</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          <span class="comment">// Loop over keys of space point map.</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          <span class="comment">// Space points that have the same key are candidates for merging.</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          <span class="keywordflow">for</span> (std::set&lt;sptkey_type&gt;::const_iterator i = sptkeys.begin(); i != sptkeys.end(); ++i) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            sptkey_type key = *i;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="comment">// Loop over space points corresponding to the current key.</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            <span class="comment">// Make a collection of hits that is the union of the hits</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="comment">// from each candidate space point.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            std::multimap&lt;sptkey_type, recob::SpacePoint&gt;::const_iterator jSPT =</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                                                            sptmap.lower_bound(key),</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                                                          jSPTend =</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                                                                            sptmap.upper_bound(key);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            art::PtrVector&lt;recob::Hit&gt; merged_hits;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <span class="keywordflow">for</span> (; jSPT != jSPTend; ++jSPT) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>&amp; spt = jSPT-&gt;second;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;              <span class="comment">// Loop over hits from this space points.</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;              <span class="comment">// Add each hit to the collection of all hits.</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;              <span class="keyword">const</span> art::PtrVector&lt;recob::Hit&gt;&amp; spt_hits = <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a21daf6d37253e815d61956a4d6ced46c">getAssociatedHits</a>(spt);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;              merged_hits.reserve(merged_hits.size() +</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                  spt_hits.size()); <span class="comment">// better than nothing, but not ideal</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;              <span class="keywordflow">for</span> (art::PtrVector&lt;recob::Hit&gt;::const_iterator <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a> = spt_hits.begin();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                   <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a> != spt_hits.end();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                   ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt;&amp; hit = *<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                merged_hits.push_back(hit);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;              }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="comment">// Remove duplicates.</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            std::sort(merged_hits.begin(), merged_hits.end());</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            art::PtrVector&lt;recob::Hit&gt;::iterator it =</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;              std::unique(merged_hits.begin(), merged_hits.end());</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            merged_hits.erase(it, merged_hits.end());</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="comment">// Construct a complex space points using merged hits.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a54689b4bd761a33189b79111a4d40c94">fillComplexSpacePoint</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, merged_hits, spts, sptmap.size() + spts.size() - 1);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a> &lt;= 2)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;              ++n2filt;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;              ++n3filt;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        } <span class="comment">// end if merging</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="comment">// No filter, no merge.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          <span class="comment">// Transfer all space points from sptmap to spts.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          spts.reserve(spts.size() + sptkeys.size());</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;          <span class="comment">// Loop over space points.</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;          <span class="keywordflow">for</span> (std::multimap&lt;sptkey_type, recob::SpacePoint&gt;::const_iterator j = sptmap.begin();</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;               j != sptmap.end();</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;               ++j) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>&amp; spt = j-&gt;second;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            spts.push_back(spt);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;          }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="comment">// Update statistics.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          n2filt = n2;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          n3filt = n3;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      } <span class="comment">// end loop over tpcs</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    }   <span class="comment">// end loop over cryostats</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span> (mf::isDebugEnabled()) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <a class="code" href="../../dd/db0/testFHiCLfiles_8sh.html#a0514aabed091ee5e2f35766eb01eced6">debug</a> &lt;&lt; <span class="stringliteral">&quot;\n2-hit space points = &quot;</span> &lt;&lt; n2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;3-hit space points = &quot;</span> &lt;&lt; n3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;2-hit filtered/merged space points = &quot;</span> &lt;&lt; n2filt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;3-hit filtered/merged space points = &quot;</span> &lt;&lt; n3filt;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    } <span class="comment">// if debug</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_a04e39dabfbb7bad6da7fd87b7431a845"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a></div><div class="ttdeci">see a below echo S(symbol in a section other than those above)</div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ac7eba2eaf2795a2a922511779faeb6c1"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ac7eba2eaf2795a2a922511779faeb6c1">trkf::SpacePointAlg::fHitMCMap</a></div><div class="ttdeci">std::map&lt; const recob::Hit *, HitMCInfo &gt; fHitMCMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00225">SpacePointAlg.h:225</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a9d43b56724e1577e314b26e30bbb5e48"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">trkf::SpacePointAlg::fMaxDT</a></div><div class="ttdeci">double fMaxDT</div><div class="ttdoc">Maximum time difference between planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00204">SpacePointAlg.h:204</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a008aac356cf9d575420a7c44f7c0ea40"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a008aac356cf9d575420a7c44f7c0ea40">trkf::SpacePointAlg::fFilter</a></div><div class="ttdeci">bool fFilter</div><div class="ttdoc">Filter flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00210">SpacePointAlg.h:210</a></div></div>
<div class="ttc" id="namespacegeo_html_a6baec40eaf3ff161f7eb1a5f0779794f"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a></div><div class="ttdeci">enum geo::_plane_proj View_t</div><div class="ttdoc">Enumerate the possible plane projections. </div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a></div><div class="ttdoc">Planes which measure V. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00130">geo_types.h:130</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a044c4e8d86cb11df41230b474ced9c77"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a044c4e8d86cb11df41230b474ced9c77">trkf::SpacePointAlg::update</a></div><div class="ttdeci">void update(detinfo::DetectorPropertiesData const &amp;detProp) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00078">SpacePointAlg.cxx:78</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a></div><div class="ttdoc">The data type to uniquely identify a Plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00472">geo_types.h:472</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_adbcef335053102f807b531bc5aedfdfa"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#adbcef335053102f807b531bc5aedfdfa">trkf::SpacePointAlg::fEnableW</a></div><div class="ttdeci">bool fEnableW</div><div class="ttdoc">Enable flag (W). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00209">SpacePointAlg.h:209</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html_affacd833f00e5080e14f5c29610df6ad"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html#affacd833f00e5080e14f5c29610df6ad">recob::SpacePoint::Chisq</a></div><div class="ttdeci">Double32_t Chisq() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00078">SpacePoint.h:78</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64">geo::kZ</a></div><div class="ttdoc">Planes which measure Z direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00132">geo_types.h:132</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ac303d2971eb9697f3a65821bb92bb934"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">geo::WireID::Wire</a></div><div class="ttdeci">WireID_t Wire</div><div class="ttdoc">Index of the wire within its plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00580">geo_types.h:580</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="testFHiCLfiles_8sh_html_a0514aabed091ee5e2f35766eb01eced6"><div class="ttname"><a href="../../dd/db0/testFHiCLfiles_8sh.html#a0514aabed091ee5e2f35766eb01eced6">debug</a></div><div class="ttdeci">debug</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db0/testFHiCLfiles_8sh_source.html#l00353">testFHiCLfiles.sh:353</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a21daf6d37253e815d61956a4d6ced46c"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a21daf6d37253e815d61956a4d6ced46c">trkf::SpacePointAlg::getAssociatedHits</a></div><div class="ttdeci">const art::PtrVector&lt; recob::Hit &gt; &amp; getAssociatedHits(const recob::SpacePoint &amp;spt) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l01495">SpacePointAlg.cxx:1495</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a></div><div class="ttdoc">Planes which measure U. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00129">geo_types.h:129</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1a36a047288595882c58b053651d40c2"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1a36a047288595882c58b053651d40c2">trkf::SpacePointAlg::fEnableU</a></div><div class="ttdeci">bool fEnableU</div><div class="ttdoc">Enable flag (U). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00207">SpacePointAlg.h:207</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a54689b4bd761a33189b79111a4d40c94"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a54689b4bd761a33189b79111a4d40c94">trkf::SpacePointAlg::fillComplexSpacePoint</a></div><div class="ttdeci">void fillComplexSpacePoint(detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; recob::SpacePoint &gt; &amp;sptv, int sptid) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00634">SpacePointAlg.cxx:634</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7a27449c7c640a7a0acdf3d40f8f6b01"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">trkf::SpacePointAlg::fMaxS</a></div><div class="ttdeci">double fMaxS</div><div class="ttdoc">Maximum space separation between wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00205">SpacePointAlg.h:205</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a></div><div class="ttdoc">The data type to uniquely identify a TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00386">geo_types.h:386</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aee29fb1bf85b5474d410bf397e752a2e"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aee29fb1bf85b5474d410bf397e752a2e">trkf::SpacePointAlg::fPreferColl</a></div><div class="ttdeci">bool fPreferColl</div><div class="ttdoc">Sort by collection wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00212">SpacePointAlg.h:212</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7927dbe026b0c8c4e4e5987e6757b04f"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7927dbe026b0c8c4e4e5987e6757b04f">trkf::SpacePointAlg::compatible</a></div><div class="ttdeci">bool compatible(detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, bool useMC=false) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00277">SpacePointAlg.cxx:277</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_a27e19a98be832681be8967bb9da9b6e6"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">geo::WireID::WireID</a></div><div class="ttdeci">constexpr WireID()=default</div><div class="ttdoc">Default constructor: an invalid TPC ID. </div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1d724375215b3762ce7411f2d93588b3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">trkf::SpacePointAlg::fMinViews</a></div><div class="ttdeci">int fMinViews</div><div class="ttdoc">Mininum number of views per space point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00206">SpacePointAlg.h:206</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a122a7b8666811f02fba2c0fcdc485d17"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a></div><div class="ttdeci">pdgs k</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7c715309641498a1b8f2c358fcbbe4d9"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">trkf::SpacePointAlg::fMerge</a></div><div class="ttdeci">bool fMerge</div><div class="ttdoc">Merge flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00211">SpacePointAlg.h:211</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_aec6180a5a8b4330cb1c4c11f5b5d1dd8"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#aec6180a5a8b4330cb1c4c11f5b5d1dd8">trkf::SpacePointAlg::fillSpacePoint</a></div><div class="ttdeci">void fillSpacePoint(detinfo::DetectorPropertiesData const &amp;detProp, const art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; recob::SpacePoint &gt; &amp;sptv, int sptid) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00428">SpacePointAlg.cxx:428</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a74da18d4f0023feee71c1352a99b3910"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">icarus::ns::util::empty</a></div><div class="ttdeci">bool empty(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00555">FixedBins.h:555</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00023">SpacePoint.h:23</a></div></div>
<div class="ttc" id="namespacegeo_html_a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a></div><div class="ttdoc">Signal from collection planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00146">geo_types.h:146</a></div></div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a76b19c3723486c679453d62ef7e94b0e"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a76b19c3723486c679453d62ef7e94b0e">trkf::SpacePointAlg::fEnableV</a></div><div class="ttdeci">bool fEnableV</div><div class="ttdoc">Enable flag (V). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00208">SpacePointAlg.h:208</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aedabe64048a1cc9fc8f1cb999140225d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::maxDT </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00096">96</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">fMaxDT</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a9d43b56724e1577e314b26e30bbb5e48"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a9d43b56724e1577e314b26e30bbb5e48">trkf::SpacePointAlg::fMaxDT</a></div><div class="ttdeci">double fMaxDT</div><div class="ttdoc">Maximum time difference between planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00204">SpacePointAlg.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a3a29665371882093486184bcf82558"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::maxS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00101">101</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">fMaxS</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7a27449c7c640a7a0acdf3d40f8f6b01"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7a27449c7c640a7a0acdf3d40f8f6b01">trkf::SpacePointAlg::fMaxS</a></div><div class="ttdeci">double fMaxS</div><div class="ttdoc">Maximum space separation between wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00205">SpacePointAlg.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85632a9169a13170e3bd0d82dede1082"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::merge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00091">91</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">fMerge</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a7c715309641498a1b8f2c358fcbbe4d9"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a7c715309641498a1b8f2c358fcbbe4d9">trkf::SpacePointAlg::fMerge</a></div><div class="ttdeci">bool fMerge</div><div class="ttdoc">Merge flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00211">SpacePointAlg.h:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab7a4f4edb5b41d89cd1262208a89150e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int trkf::SpacePointAlg::minViews </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00106">106</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">fMinViews</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_a1d724375215b3762ce7411f2d93588b3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#a1d724375215b3762ce7411f2d93588b3">trkf::SpacePointAlg::fMinViews</a></div><div class="ttdeci">int fMinViews</div><div class="ttdoc">Mininum number of views per space point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00206">SpacePointAlg.h:206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af72426e4adcea9b90fecb919ed8ca3f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int trkf::SpacePointAlg::numHitMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00188">188</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">fSptHitMap</a>.size();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="ttc" id="classtrkf_1_1SpacePointAlg_html_ad2c9890b5efe25df63a5e70ccb91d7a3"><div class="ttname"><a href="../../dd/d20/classtrkf_1_1SpacePointAlg.html#ad2c9890b5efe25df63a5e70ccb91d7a3">trkf::SpacePointAlg::fSptHitMap</a></div><div class="ttdeci">std::map&lt; int, art::PtrVector&lt; recob::Hit &gt; &gt; fSptHitMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">SpacePointAlg.h:226</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06b1da1f8321bed3bd2847944a9c6b64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::separation </td>
          <td>(</td>
          <td class="paramtype">const art::PtrVector&lt; <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hits</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00191">191</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Get geometry service.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Trivial case - fewer than three hits.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (hits.size() &lt; 3) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Error case - more than three hits.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (hits.size() &gt; 3) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      mf::LogError(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Method separation called with more than three htis.&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Got exactly three hits.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// Calculate angles and distance of each hit from origin.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">double</span> sinth[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">double</span> costh[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstats[3];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpcs[3];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a>[3];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// Get tpc, plane, wire.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = *(hits[i]);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeom = geom-&gt;WireIDToWireGeo(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      cstats[i] = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      tpcs[i] = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      planes[i] = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">// Check tpc and plane errors.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; ++j) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (cstats[j] != hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          mf::LogError(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Method separation called with hits from multiple cryostats..&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (tpcs[j] != hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          mf::LogError(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Method separation called with hits from multiple tpcs..&quot;</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (planes[j] == hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          mf::LogError(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Method separation called with hits from the same plane..&quot;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// Get angles and distance of wire.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordtype">double</span> hl = wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">double</span> xyz1[3];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz1, hl);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = (xyz1[1] - xyz[1]) / hl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordtype">double</span> c = (xyz1[2] - xyz[2]) / hl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      sinth[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      costh[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = c;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      dist[hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>] = xyz[2] * s - xyz[1] * c;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a> = ((sinth[1] * costh[2] - costh[1] * sinth[2]) * dist[0] +</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                (sinth[2] * costh[0] - costh[2] * sinth[0]) * dist[1] +</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                (sinth[0] * costh[1] - costh[0] * sinth[1]) * dist[2]);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_a04e39dabfbb7bad6da7fd87b7431a845"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#a04e39dabfbb7bad6da7fd87b7431a845">S</a></div><div class="ttdeci">see a below echo S(symbol in a section other than those above)</div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_ac996980052e16111a1efc913778a5f5f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a></div><div class="ttdeci">BEGIN_PROLOG Z planes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a044c4e8d86cb11df41230b474ced9c77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trkf::SpacePointAlg::update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const &amp;&#160;</td>
          <td class="paramname"><em>detProp</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html#l00078">78</a> of file <a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Generate info report on first call only.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">bool</span> report = <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Get services.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// Calculate and print geometry information.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (report) mf::LogInfo(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Updating geometry constants.\n&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = 0; cstat &lt; geom-&gt;Ncryostats(); ++cstat) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">// Loop over TPCs.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> ntpc = geom-&gt;Cryostat(cstat).NTPC();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = 0; tpc &lt; ntpc; ++tpc) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; tpcgeom = geom-&gt;Cryostat(cstat).TPC(tpc);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">// Loop over planes.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> nplane = tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane = 0; plane &lt; nplane; ++plane) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeid(cstat, tpc, plane);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a>&amp; pgeom = tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(planeid);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <span class="comment">// Fill view-dependent quantities.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view = pgeom.<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#aa5686dd2cfd623b83eeb2b4e18db42ae">View</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          std::string viewname = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="keywordflow">if</span> (view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a>) { viewname = <span class="stringliteral">&quot;U&quot;</span>; }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a>) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            viewname = <span class="stringliteral">&quot;V&quot;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (view == <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64">geo::kZ</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            viewname = <span class="stringliteral">&quot;Z&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad view = &quot;</span> &lt;&lt; view &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          std::string sigtypename = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a> sigtype = geom-&gt;SignalType(planeid);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keywordflow">if</span> (sigtype == <a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8">geo::kInduction</a>)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            sigtypename = <span class="stringliteral">&quot;Induction&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sigtype == <a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a>)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            sigtypename = <span class="stringliteral">&quot;Collection&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad signal type = &quot;</span> &lt;&lt; sigtype &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          std::string orientname = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a64418a3b0fa44f9ce32e0e269cc96524">geo::Orient_t</a> orient = pgeom.<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#ab096479e47140e77ec1050096d446a23">Orientation</a>();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="keywordflow">if</span> (orient == <a class="code" href="../../d6/d23/namespacegeo.html#aa466678f5f635eee4a8179671f3aae7ea3278689303684830961f26ab4ae9d7b5">geo::kVertical</a>)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            orientname = <span class="stringliteral">&quot;Vertical&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (orient == <a class="code" href="../../d6/d23/namespacegeo.html#aa466678f5f635eee4a8179671f3aae7eaf7e5e120c91f8fae9de103aefe12b0ca">geo::kHorizontal</a>)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            orientname = <span class="stringliteral">&quot;Horizontal&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad orientation = &quot;</span> &lt;&lt; orient &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">if</span> (report) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz = tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">PlaneLocation</a>(plane);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            mf::LogInfo(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\nCryostat, TPC, Plane: &quot;</span> &lt;&lt; cstat &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; tpc &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; plane &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  View: &quot;</span> &lt;&lt; viewname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  SignalType: &quot;</span> &lt;&lt; sigtypename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Orientation: &quot;</span> &lt;&lt; orientname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Plane location: &quot;</span> &lt;&lt; xyz[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Plane pitch: &quot;</span> &lt;&lt; tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a8a67d792308b4298d3c782bd219e508a">Plane0Pitch</a>(plane) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Wire angle: &quot;</span> &lt;&lt; tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(plane).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a52fd8fb79c65318b52d60acb58c9a0d3">Wire</a>(0).<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a0607dce1b981e52fc158ad5cbfd343d0">ThetaZ</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Wire pitch: &quot;</span> &lt;&lt; tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3aa34691d012bfba86e5aaab2a0d3317">WirePitch</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Time offset: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.GetXTicksOffset(plane, tpc, cstat) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keywordflow">if</span> (orient != <a class="code" href="../../d6/d23/namespacegeo.html#aa466678f5f635eee4a8179671f3aae7ea3278689303684830961f26ab4ae9d7b5">geo::kVertical</a>)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SpacePointAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Horizontal wire geometry not implemented.\n&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        } <span class="comment">// end loop over planes</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }   <span class="comment">// end loop over tpcs</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }     <span class="comment">// end loop over cryostats</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_a52fd8fb79c65318b52d60acb58c9a0d3"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#a52fd8fb79c65318b52d60acb58c9a0d3">geo::PlaneGeo::Wire</a></div><div class="ttdeci">WireGeo const &amp; Wire(unsigned int iwire) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd0/PlaneGeo_8cxx_source.html#l00506">PlaneGeo.cxx:506</a></div></div>
<div class="ttc" id="namespacegeo_html_a6baec40eaf3ff161f7eb1a5f0779794f"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a></div><div class="ttdeci">enum geo::_plane_proj View_t</div><div class="ttdoc">Enumerate the possible plane projections. </div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486aea23122caaaed75b787c745a188871f6">geo::kV</a></div><div class="ttdoc">Planes which measure V. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00130">geo_types.h:130</a></div></div>
<div class="ttc" id="namespacegeo_html_a64418a3b0fa44f9ce32e0e269cc96524"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a64418a3b0fa44f9ce32e0e269cc96524">geo::Orient_t</a></div><div class="ttdeci">enum geo::_plane_orient Orient_t</div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ab3391de99203f6a60eeeef152d3adb35"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">geo::TPCGeo::Nplanes</a></div><div class="ttdeci">unsigned int Nplanes() const </div><div class="ttdoc">Number of planes in this tpc. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00165">TPCGeo.h:165</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a></div><div class="ttdoc">The data type to uniquely identify a Plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00472">geo_types.h:472</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a29e198ce46b2c8fc4a31422f42f77c64">geo::kZ</a></div><div class="ttdoc">Planes which measure Z direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00132">geo_types.h:132</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a0607dce1b981e52fc158ad5cbfd343d0"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a0607dce1b981e52fc158ad5cbfd343d0">geo::WireGeo::ThetaZ</a></div><div class="ttdeci">double ThetaZ() const </div><div class="ttdoc">Returns angle of wire with respect to z axis in the Y-Z plane in radians. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00250">WireGeo.h:250</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae2842cacc3d7d281d01b4316380b8d5b">geo::kU</a></div><div class="ttdoc">Planes which measure U. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00129">geo_types.h:129</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_aa5686dd2cfd623b83eeb2b4e18db42ae"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#aa5686dd2cfd623b83eeb2b4e18db42ae">geo::PlaneGeo::View</a></div><div class="ttdeci">View_t View() const </div><div class="ttdoc">Which coordinate does this plane measure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00184">PlaneGeo.h:184</a></div></div>
<div class="ttc" id="namespacegeo_html_aa466678f5f635eee4a8179671f3aae7eaf7e5e120c91f8fae9de103aefe12b0ca"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aa466678f5f635eee4a8179671f3aae7eaf7e5e120c91f8fae9de103aefe12b0ca">geo::kHorizontal</a></div><div class="ttdoc">Planes that are in the horizontal plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00140">geo_types.h:140</a></div></div>
<div class="ttc" id="namespacegeo_html_a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8">geo::kInduction</a></div><div class="ttdoc">Signal from induction planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00145">geo_types.h:145</a></div></div>
<div class="ttc" id="namespacegeo_html_aa466678f5f635eee4a8179671f3aae7ea3278689303684830961f26ab4ae9d7b5"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aa466678f5f635eee4a8179671f3aae7ea3278689303684830961f26ab4ae9d7b5">geo::kVertical</a></div><div class="ttdoc">Planes that are in the vertical plane (e.g. ArgoNeuT). </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00141">geo_types.h:141</a></div></div>
<div class="ttc" id="namespacegeo_html_a59a0688ea6aaa04f0ffa6451f8083ca1"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a></div><div class="ttdeci">enum geo::_plane_sigtype SigType_t</div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a></div><div class="ttdoc">Geometry information for a single wire plane.The plane is represented in the geometry by a solid whic...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00082">PlaneGeo.h:82</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3aa34691d012bfba86e5aaab2a0d3317"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3aa34691d012bfba86e5aaab2a0d3317">geo::TPCGeo::WirePitch</a></div><div class="ttdeci">double WirePitch(unsigned plane=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00396">TPCGeo.cxx:396</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a8a67d792308b4298d3c782bd219e508a"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a8a67d792308b4298d3c782bd219e508a">geo::TPCGeo::Plane0Pitch</a></div><div class="ttdeci">double Plane0Pitch(unsigned int p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00324">TPCGeo.cxx:324</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_ab096479e47140e77ec1050096d446a23"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#ab096479e47140e77ec1050096d446a23">geo::PlaneGeo::Orientation</a></div><div class="ttdeci">Orient_t Orientation() const </div><div class="ttdoc">What is the orientation of the plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00187">PlaneGeo.h:187</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a411eea9dd765636914a618ded267558c"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">geo::TPCGeo::Plane</a></div><div class="ttdeci">PlaneGeo const &amp; Plane(geo::View_t view) const </div><div class="ttdoc">Return the plane in the tpc with View_t view. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00263">TPCGeo.cxx:263</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ad48eecd625c1d023828570dfeea497dd"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">geo::TPCGeo::PlaneLocation</a></div><div class="ttdeci">const double * PlaneLocation(unsigned int p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00382">TPCGeo.cxx:382</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="namespacegeo_html_a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a></div><div class="ttdoc">Signal from collection planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00146">geo_types.h:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a1a36a047288595882c58b053651d40c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fEnableU</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable flag (U). </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00207">207</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a76b19c3723486c679453d62ef7e94b0e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fEnableV</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable flag (V). </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00208">208</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="adbcef335053102f807b531bc5aedfdfa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fEnableW</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable flag (W). </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00209">209</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a008aac356cf9d575420a7c44f7c0ea40"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fFilter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Filter flag. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00210">210</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac7eba2eaf2795a2a922511779faeb6c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;const <a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>*, <a class="el" href="../../d4/d43/structtrkf_1_1SpacePointAlg_1_1HitMCInfo.html">HitMCInfo</a>&gt; trkf::SpacePointAlg::fHitMCMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00225">225</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9d43b56724e1577e314b26e30bbb5e48"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::fMaxDT</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum time difference between planes. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00204">204</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7a27449c7c640a7a0acdf3d40f8f6b01"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::fMaxS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum space separation between wires. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00205">205</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7c715309641498a1b8f2c358fcbbe4d9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fMerge</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Merge flag. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00211">211</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1d724375215b3762ce7411f2d93588b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int trkf::SpacePointAlg::fMinViews</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mininum number of views per space point. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00206">206</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="aee29fb1bf85b5474d410bf397e752a2e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool trkf::SpacePointAlg::fPreferColl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sort by collection wire. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00212">212</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad2c9890b5efe25df63a5e70ccb91d7a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int, art::PtrVector&lt;<a class="el" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&gt; &gt; trkf::SpacePointAlg::fSptHitMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00226">226</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a72df8a610502c189f835b5c32a64d975"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::fTickOffsetU</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tick offset for plane U. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00213">213</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5bdedbda8245291bfa18995efca0fd7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::fTickOffsetV</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tick offset for plane V. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00214">214</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa5fadf661ecd9fc31367d63270b721e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double trkf::SpacePointAlg::fTickOffsetW</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tick offset for plane W. </p>

<p>Definition at line <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html#l00215">215</a> of file <a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d3/d87/SpacePointAlg_8h_source.html">SpacePointAlg.h</a></li>
<li><a class="el" href="../../d9/d43/SpacePointAlg_8cxx_source.html">SpacePointAlg.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
