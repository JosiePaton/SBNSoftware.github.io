<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>larg4::OpBoundaryProcessSimple Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d7/d6f/namespacelarg4.html">larg4</a></li><li class="navelem"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html">OpBoundaryProcessSimple</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d4/d1e/classlarg4_1_1OpBoundaryProcessSimple-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">larg4::OpBoundaryProcessSimple Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Discrete process for reflection and diffusion at optical interfaces.  
 <a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for larg4::OpBoundaryProcessSimple:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.png" usemap="#larg4::OpBoundaryProcessSimple_map" alt=""/>
  <map id="larg4::OpBoundaryProcessSimple_map" name="larg4::OpBoundaryProcessSimple_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa264e01ccace48f12c474f72b2ee470"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#aaa264e01ccace48f12c474f72b2ee470">OpBoundaryProcessSimple</a> (const G4String &amp;processName=&quot;OpBoundary&quot;, G4ProcessType <a class="el" href="../../d9/da0/structtype.html">type</a>=fOptical)</td></tr>
<tr class="separator:aaa264e01ccace48f12c474f72b2ee470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe627d4506cecea322e237d0e281f7c0"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#abe627d4506cecea322e237d0e281f7c0">IsApplicable</a> (const G4ParticleDefinition &amp;aParticleType)</td></tr>
<tr class="separator:abe627d4506cecea322e237d0e281f7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e14c3d177c08b8d61bacb3fb56113b"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#a23e14c3d177c08b8d61bacb3fb56113b">GetMeanFreePath</a> (const G4Track &amp;, G4double, G4ForceCondition *condition)</td></tr>
<tr class="separator:a23e14c3d177c08b8d61bacb3fb56113b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab788db1d9c0be644342815ee34126696"><td class="memItemLeft" align="right" valign="top">G4VParticleChange *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ab788db1d9c0be644342815ee34126696">PostStepDoIt</a> (const G4Track &amp;aTrack, const G4Step &amp;aStep)</td></tr>
<tr class="separator:ab788db1d9c0be644342815ee34126696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48244352ff24c5f37f83610d252d84fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7">OpBoundaryProcessSimpleStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#a48244352ff24c5f37f83610d252d84fb">GetStatus</a> () const </td></tr>
<tr class="separator:a48244352ff24c5f37f83610d252d84fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac37327f9eeadd6ef370cdbad0ed5793b"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ac37327f9eeadd6ef370cdbad0ed5793b">G4BooleanRand</a> (const G4double prob) const </td></tr>
<tr class="separator:ac37327f9eeadd6ef370cdbad0ed5793b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae5c6548598a58eabbd4bb454c4fe02c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7">OpBoundaryProcessSimpleStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a></td></tr>
<tr class="separator:ae5c6548598a58eabbd4bb454c4fe02c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5a847f13b03810dc28dddab62568b8"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#add5a847f13b03810dc28dddab62568b8">fCarTolerance</a></td></tr>
<tr class="separator:add5a847f13b03810dc28dddab62568b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2a05cae795fed3f7eee9312f6958ca9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ab2a05cae795fed3f7eee9312f6958ca9">fVerbosity</a></td></tr>
<tr class="separator:ab2a05cae795fed3f7eee9312f6958ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Discrete process for reflection and diffusion at optical interfaces. </p>
<dl class="section see"><dt>See Also</dt><dd><code>G4VDiscreteProcess</code></dd></dl>
<p>This class invokes a simplified model of optical reflections at boundaries between different materials. The relevant reflectivities are ultimately read from <code><a class="el" href="../../dc/d37/classdetinfo_1_1LArProperties.html">detinfo::LArProperties</a></code> via <code>larg4::MaterialPropertiesLoader</code>.</p>
<p>The required parameters are total reflectance (<code><a class="el" href="../../dc/d37/classdetinfo_1_1LArProperties.html#ae48523c5293cb7b267052bc420944443">detinfo::LArProperties::SurfaceReflectances()</a></code>) and ratio of diffuse to specular reflectance (<code><a class="el" href="../../dc/d37/classdetinfo_1_1LArProperties.html#a598cd8ca6cf15cf6a623f1ba87188f53">detinfo::LArProperties::SurfaceReflectanceDiffuseFractions()</a></code>). Each photon crossing a boundary with a defined reflectance is randomly either reflected or absorbed and killed according to the supplied probability.</p>
<p>Every reflected photon with a defined diffuse reflection fraction is then randomly either diffusely or specularly reflected according to the supplied probability. All materials with no defined reflectance are assumed to be black and absorb all incident photons.</p>
<p>This physics process is loaded in <code><a class="el" href="../../db/ddf/classlarg4_1_1OpticalPhysics.html">larg4::OpticalPhysics</a></code> physics constructor.</p>
<p>This class is based on the <code>G4OpBoundaryProcess</code> class in Geant4 and was adapted for LArSoft by Ben Jones, MIT, March 2010. </p>

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00102">102</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaa264e01ccace48f12c474f72b2ee470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">larg4::OpBoundaryProcessSimple::OpBoundaryProcessSimple </td>
          <td>(</td>
          <td class="paramtype">const G4String &amp;&#160;</td>
          <td class="paramname"><em>processName</em> = <code>&quot;OpBoundary&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ProcessType&#160;</td>
          <td class="paramname"><em>type</em> = <code>fOptical</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html#l00067">67</a> of file <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html">OpBoundaryProcessSimple.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    : G4VDiscreteProcess(processName, <a class="code" href="../../d9/da0/structtype.html">type</a>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    G4cout &lt;&lt; GetProcessName() &lt;&lt; <span class="stringliteral">&quot; is created &quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    SetProcessSubType(fOpBoundary);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b">Undefined</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#add5a847f13b03810dc28dddab62568b8">fCarTolerance</a> = G4GeometryTolerance::GetInstance()-&gt;GetSurfaceTolerance();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_add5a847f13b03810dc28dddab62568b8"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#add5a847f13b03810dc28dddab62568b8">larg4::OpBoundaryProcessSimple::fCarTolerance</a></div><div class="ttdeci">G4double fCarTolerance</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00127">OpBoundaryProcessSimple.hh:127</a></div></div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_ae5c6548598a58eabbd4bb454c4fe02c3"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">larg4::OpBoundaryProcessSimple::fTheStatus</a></div><div class="ttdeci">OpBoundaryProcessSimpleStatus fTheStatus</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00126">OpBoundaryProcessSimple.hh:126</a></div></div>
<div class="ttc" id="structtype_html"><div class="ttname"><a href="../../d9/da0/structtype.html">type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9e/ShowerProducedPtrsHolder_8hh_source.html#l00050">ShowerProducedPtrsHolder.hh:50</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b">larg4::Undefined</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00064">OpBoundaryProcessSimple.hh:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac37327f9eeadd6ef370cdbad0ed5793b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpBoundaryProcessSimple::G4BooleanRand </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>prob</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00133">133</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">/* Returns a random boolean variable with the specified probability */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> (G4UniformRand() &lt; prob);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a23e14c3d177c08b8d61bacb3fb56113b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpBoundaryProcessSimple::GetMeanFreePath </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ForceCondition *&#160;</td>
          <td class="paramname"><em>condition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html#l00235">235</a> of file <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html">OpBoundaryProcessSimple.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    *condition = Forced;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> DBL_MAX;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48244352ff24c5f37f83610d252d84fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7">OpBoundaryProcessSimpleStatus</a> larg4::OpBoundaryProcessSimple::GetStatus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00146">146</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_ae5c6548598a58eabbd4bb454c4fe02c3"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">larg4::OpBoundaryProcessSimple::fTheStatus</a></div><div class="ttdeci">OpBoundaryProcessSimpleStatus fTheStatus</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00126">OpBoundaryProcessSimple.hh:126</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abe627d4506cecea322e237d0e281f7c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpBoundaryProcessSimple::IsApplicable </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition &amp;&#160;</td>
          <td class="paramname"><em>aParticleType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00140">140</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> (&amp;aParticleType == G4OpticalPhoton::OpticalPhoton());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab788db1d9c0be644342815ee34126696"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4VParticleChange * larg4::OpBoundaryProcessSimple::PostStepDoIt </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>aTrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html#l00083">83</a> of file <a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html">OpBoundaryProcessSimple.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Note - these have to be loaded here, since this object</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// is constructed before LArG4, and hence before the</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// LArG4 parameters are read from config</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b">Undefined</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    aParticleChange.Initialize(aTrack);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    G4StepPoint* pPreStepPoint = aStep.GetPreStepPoint();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    G4StepPoint* pPostStepPoint = aStep.GetPostStepPoint();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (pPostStepPoint-&gt;GetStepStatus() != fGeomBoundary) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6e7dc2b90fdf60249c4fb788477d42d6">NotAtBoundary</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">return</span> G4VDiscreteProcess::PostStepDoIt(aTrack, aStep);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (aTrack.GetStepLength() &lt;= <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#add5a847f13b03810dc28dddab62568b8">fCarTolerance</a> / 2) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7afa498bf7d7e9f27946b35f5176f86c90">StepTooSmall</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">return</span> G4VDiscreteProcess::PostStepDoIt(aTrack, aStep);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    G4Material* Material1 = pPreStepPoint-&gt;GetMaterial();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    G4Material* Material2 = pPostStepPoint-&gt;GetMaterial();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (Material1 != Material2) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      art::ServiceHandle&lt;sim::LArG4Parameters const&gt; lgp;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ab2a05cae795fed3f7eee9312f6958ca9">fVerbosity</a> = lgp-&gt;OpVerbosity();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      G4ThreeVector NewMomentum;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      G4ThreeVector NewPolarization;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      G4ThreeVector theGlobalNormal;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      G4ThreeVector theFacetNormal;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      std::string Material1Name = Material1-&gt;GetName();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      std::string Material2Name = Material2-&gt;GetName();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keyword">const</span> G4DynamicParticle* aParticle = aTrack.GetDynamicParticle();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      G4double thePhotonMomentum = aParticle-&gt;GetTotalMomentum();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      G4ThreeVector OldMomentum = aParticle-&gt;GetMomentumDirection();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      G4ThreeVector OldPolarization = aParticle-&gt;GetPolarization();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ab2a05cae795fed3f7eee9312f6958ca9">fVerbosity</a> &gt; 9)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;OpBoundaryProcessSimple Debug: Photon &quot;</span> &lt;&lt; aTrack.GetTrackID() &lt;&lt; <span class="stringliteral">&quot; momentum &quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  &lt;&lt; thePhotonMomentum &lt;&lt; <span class="stringliteral">&quot; Material1 &quot;</span> &lt;&lt; Material1Name.c_str() &lt;&lt; <span class="stringliteral">&quot; Material 2 &quot;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                  &lt;&lt; Material2Name.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      G4ThreeVector theGlobalPoint = pPostStepPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      G4Navigator* theNavigator =</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        G4TransportationManager::GetTransportationManager()-&gt;GetNavigatorForTracking();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      G4ThreeVector theLocalPoint =</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        theNavigator-&gt;GetGlobalToLocalTransform().TransformPoint(theGlobalPoint);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">// Normal points back into volume</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      G4bool valid;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      G4ThreeVector theLocalNormal = theNavigator-&gt;GetLocalExitNormal(&amp;valid);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">if</span> (valid) { theLocalNormal = -theLocalNormal; }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        G4cerr &lt;&lt; <span class="stringliteral">&quot; OpBoundaryProcessSimple/PostStepDoIt(): &quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; The Navigator reports that it returned an invalid normal&quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      theGlobalNormal = theNavigator-&gt;GetLocalToGlobalTransform().TransformAxis(theLocalNormal);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span> (OldMomentum * theGlobalNormal &gt; 0.0) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#ifdef G4DEBUG_OPTICAL</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor"></span>        G4cerr &lt;&lt; <span class="stringliteral">&quot; OpBoundaryProcessSimple/PostStepDoIt(): &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; theGlobalNormal points the wrong direction &quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor"></span>        theGlobalNormal = -theGlobalNormal;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      G4MaterialPropertiesTable* aMaterialPropertiesTable;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      G4MaterialPropertyVector* Reflectance;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      G4MaterialPropertyVector* DiffuseReflectanceFraction;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      aMaterialPropertiesTable = Material1-&gt;GetMaterialPropertiesTable();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> (aMaterialPropertiesTable) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        std::stringstream PropertyName;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        PropertyName &lt;&lt; <span class="stringliteral">&quot;REFLECTANCE_&quot;</span> &lt;&lt; Material2Name.c_str();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        Reflectance = aMaterialPropertiesTable-&gt;GetProperty(PropertyName.str().c_str());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        PropertyName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        PropertyName &lt;&lt; <span class="stringliteral">&quot;DIFFUSE_REFLECTANCE_FRACTION_&quot;</span> &lt;&lt; Material2Name.c_str();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        DiffuseReflectanceFraction =</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          aMaterialPropertiesTable-&gt;GetProperty(PropertyName.str().c_str());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (Reflectance) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="keywordtype">double</span> theReflectance = Reflectance-&gt;Value(thePhotonMomentum);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ac37327f9eeadd6ef370cdbad0ed5793b">G4BooleanRand</a>(theReflectance)) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">if</span> (DiffuseReflectanceFraction) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              <span class="keywordtype">double</span> theDiffuseReflectanceFraction =</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                DiffuseReflectanceFraction-&gt;Value(thePhotonMomentum);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ac37327f9eeadd6ef370cdbad0ed5793b">G4BooleanRand</a>(theDiffuseReflectanceFraction)) { <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a2054d694f6da3456a8e7e5fc9d02c5ea">SimpleDiffuse</a>; }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3d813bd4c0149db150cfa84ec9594593">SimpleSpecular</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;              }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3d813bd4c0149db150cfa84ec9594593">SimpleSpecular</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6359e345b6c385e32d39bfaa834bf5d9">SimpleAbsorbed</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3da93a0a2d610bc45a6ec6cc60693a3b">SimpleAbsorbedNoRefl</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">// Take action according to track status</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a2054d694f6da3456a8e7e5fc9d02c5ea">SimpleDiffuse</a>) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        NewMomentum = G4LambertianRand(theGlobalNormal);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        theFacetNormal = (NewMomentum - OldMomentum).unit();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3d813bd4c0149db150cfa84ec9594593">SimpleSpecular</a>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        theFacetNormal = theGlobalNormal;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        G4double PdotN = OldMomentum * theFacetNormal;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        NewMomentum = OldMomentum - (2. * PdotN) * theFacetNormal;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6359e345b6c385e32d39bfaa834bf5d9">SimpleAbsorbed</a>) || (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3da93a0a2d610bc45a6ec6cc60693a3b">SimpleAbsorbedNoRefl</a>)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        aParticleChange.ProposeTrackStatus(fStopAndKill);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6e7dc2b90fdf60249c4fb788477d42d6">NotAtBoundary</a>) || (<a class="code" href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">fTheStatus</a> == <a class="code" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7afa498bf7d7e9f27946b35f5176f86c90">StepTooSmall</a>)) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        NewMomentum = OldMomentum;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        aParticleChange.ProposeTrackStatus(fStopAndKill);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      NewMomentum = NewMomentum.unit();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      aParticleChange.ProposeMomentumDirection(NewMomentum);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> G4VDiscreteProcess::PostStepDoIt(aTrack, aStep);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a6359e345b6c385e32d39bfaa834bf5d9"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6359e345b6c385e32d39bfaa834bf5d9">larg4::SimpleAbsorbed</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00067">OpBoundaryProcessSimple.hh:67</a></div></div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_add5a847f13b03810dc28dddab62568b8"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#add5a847f13b03810dc28dddab62568b8">larg4::OpBoundaryProcessSimple::fCarTolerance</a></div><div class="ttdeci">G4double fCarTolerance</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00127">OpBoundaryProcessSimple.hh:127</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a6e7dc2b90fdf60249c4fb788477d42d6"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a6e7dc2b90fdf60249c4fb788477d42d6">larg4::NotAtBoundary</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00065">OpBoundaryProcessSimple.hh:65</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a3da93a0a2d610bc45a6ec6cc60693a3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3da93a0a2d610bc45a6ec6cc60693a3b">larg4::SimpleAbsorbedNoRefl</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00066">OpBoundaryProcessSimple.hh:66</a></div></div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_ae5c6548598a58eabbd4bb454c4fe02c3"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ae5c6548598a58eabbd4bb454c4fe02c3">larg4::OpBoundaryProcessSimple::fTheStatus</a></div><div class="ttdeci">OpBoundaryProcessSimpleStatus fTheStatus</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00126">OpBoundaryProcessSimple.hh:126</a></div></div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_ab2a05cae795fed3f7eee9312f6958ca9"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ab2a05cae795fed3f7eee9312f6958ca9">larg4::OpBoundaryProcessSimple::fVerbosity</a></div><div class="ttdeci">int fVerbosity</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00129">OpBoundaryProcessSimple.hh:129</a></div></div>
<div class="ttc" id="classlarg4_1_1OpBoundaryProcessSimple_html_ac37327f9eeadd6ef370cdbad0ed5793b"><div class="ttname"><a href="../../d8/d47/classlarg4_1_1OpBoundaryProcessSimple.html#ac37327f9eeadd6ef370cdbad0ed5793b">larg4::OpBoundaryProcessSimple::G4BooleanRand</a></div><div class="ttdeci">G4bool G4BooleanRand(const G4double prob) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00133">OpBoundaryProcessSimple.hh:133</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7afa498bf7d7e9f27946b35f5176f86c90"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7afa498bf7d7e9f27946b35f5176f86c90">larg4::StepTooSmall</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00070">OpBoundaryProcessSimple.hh:70</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a3d813bd4c0149db150cfa84ec9594593"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a3d813bd4c0149db150cfa84ec9594593">larg4::SimpleSpecular</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00069">OpBoundaryProcessSimple.hh:69</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a2054d694f6da3456a8e7e5fc9d02c5ea"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a2054d694f6da3456a8e7e5fc9d02c5ea">larg4::SimpleDiffuse</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00068">OpBoundaryProcessSimple.hh:68</a></div></div>
<div class="ttc" id="namespacelarg4_html_a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7a064e7a79e4fb9869853447f84f7d321b">larg4::Undefined</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00064">OpBoundaryProcessSimple.hh:64</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="add5a847f13b03810dc28dddab62568b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpBoundaryProcessSimple::fCarTolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00127">127</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ae5c6548598a58eabbd4bb454c4fe02c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a44112bd44532c866e9ab3d40d3aa9dc7">OpBoundaryProcessSimpleStatus</a> larg4::OpBoundaryProcessSimple::fTheStatus</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00126">126</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ab2a05cae795fed3f7eee9312f6958ca9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int larg4::OpBoundaryProcessSimple::fVerbosity</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html#l00129">129</a> of file <a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d8/d76/OpBoundaryProcessSimple_8hh_source.html">OpBoundaryProcessSimple.hh</a></li>
<li><a class="el" href="../../d1/da1/OpBoundaryProcessSimple_8cxx_source.html">OpBoundaryProcessSimple.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
