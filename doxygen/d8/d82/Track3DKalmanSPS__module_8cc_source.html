<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Track3DKalmanSPS_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_e5d091f126962b7bbee30f7df4314892.html">TrackFinder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Track3DKalmanSPS_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d82/Track3DKalmanSPS__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// \file Track3DKalmanSPS.cxx</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// \author echurch@fnal.gov</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  This algorithm is designed to reconstruct 3D tracks through</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  GENFIT&#39;s Kalman filter.</span><span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// C++ includes</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span> <span class="comment">// std::distance()</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::sort()</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// ROOT includes</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;TVector3.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;TPrincipal.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;TDatabasePDG.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;TTree.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;TMatrixT.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// Framework includes</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/exception.h&quot;</span> </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/Ptr.h&quot;</span> </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/PtrVector.h&quot;</span> </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;art_root_io/TFileService.h&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindManyP.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// GENFIT includes</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da1/GFAbsTrackRep_8h.html">larreco/Genfit/GFAbsTrackRep.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dc4/RKTrackRep_8h.html">larreco/Genfit/RKTrackRep.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dec/GFConstField_8h.html">larreco/Genfit/GFConstField.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db9/GFFieldManager_8h.html">larreco/Genfit/GFFieldManager.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/dea/PointHit_8h.html">larreco/Genfit/PointHit.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d5e/GFTrack_8h.html">larreco/Genfit/GFTrack.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/dfe/GFKalman_8h.html">larreco/Genfit/GFKalman.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// LArSoft includes</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/de5/WireGeo_8h.html">larcorealg/Geometry/WireGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d80/PlaneGeo_8h.html">larcorealg/Geometry/PlaneGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d77/Cluster_8h.html">lardataobj/RecoBase/Cluster.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">lardataobj/RecoBase/Track.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d12/SpacePoint_8h.html">lardataobj/RecoBase/SpacePoint.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//\todo Reconstruction Producers should never include SimulationBase objects</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;nusimdata/SimulationBase/MCTruth.h&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">lardata/Utilities/AssociationUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#ae807a928af6da3ddaece0d3d3cf8139f">   63</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#ae807a928af6da3ddaece0d3d3cf8139f">sp_sort_3dz</a>(<span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h1, <span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h2)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz1 = h1-&gt;XYZ();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz2 = h2-&gt;XYZ();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">return</span> xyz1[2] &lt; xyz2[2];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a7032263c9a4b40e04508141cab74f889">   69</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a7032263c9a4b40e04508141cab74f889">sp_sort_3dy</a>(<span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h1, <span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h2)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz1 = h1-&gt;XYZ();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz2 = h2-&gt;XYZ();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">return</span> xyz1[1] &lt; xyz2[1];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a4c97875920f5de204382b4d0b1ccf203">   75</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a4c97875920f5de204382b4d0b1ccf203">sp_sort_3dx</a>(<span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h1, <span class="keyword">const</span> art::Ptr&lt;recob::SpacePoint&gt;&amp; h2)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz1 = h1-&gt;XYZ();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz2 = h2-&gt;XYZ();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">return</span> xyz1[0] &lt; xyz2[0];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a3a89dfb7215ac4a87edff409a572c319">   82</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a3a89dfb7215ac4a87edff409a572c319">sp_sort_nsppts</a>(<span class="keyword">const</span> art::PtrVector&lt;recob::SpacePoint&gt;&amp; h1, <span class="keyword">const</span> art::PtrVector&lt;recob::SpacePoint&gt;&amp; h2)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s1 = h1.size();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s2 = h2.size();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">return</span> s1 &gt; s2;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">namespace </span>trkf {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html">   92</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html">Track3DKalmanSPS</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a059f4a9027a40f3c3a29db8c34e8f5fe">Track3DKalmanSPS</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5506e5aeb47f53b533e0a472968e6b9c">produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#adfcffc313cd8d80bd22f6c67fb151645">beginJob</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7e83a16d9bff674bf0bcabfaf932e846">endJob</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7702666bf7dc64083957821882f1310b">energyLossBetheBloch</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad78bb6f946608b7f8eaccd384f501fd7">rotationCov</a>(TMatrixT&lt;Double_t&gt;  &amp;cov, <span class="keyword">const</span> TVector3 &amp;u, <span class="keyword">const</span> TVector3 &amp;v);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    std::vector &lt;double&gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3961ab423ca0e4a28a9a4006fc4a745c">dQdxCalc</a>(<span class="keyword">const</span> art::FindManyP&lt;recob::Hit&gt; &amp;<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>, <span class="keyword">const</span> art::PtrVector&lt;recob::SpacePoint&gt; &amp;<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, <span class="keyword">const</span> TVector3 &amp;p, <span class="keyword">const</span> TVector3 &amp;d );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2110a60a25052899732d5148da99ac5c">  107</a></span>&#160;    std::string     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2110a60a25052899732d5148da99ac5c">fClusterModuleLabel</a>;<span class="comment">// label for input collection</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4814469790a4d733161f39b0cf26deea">  108</a></span>&#160;    std::string     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4814469790a4d733161f39b0cf26deea">fSpptModuleLabel</a>;<span class="comment">// label for input collection</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a528dc4a0cd42bb2becffbf84b9c0dfc2">  109</a></span>&#160;    std::string     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a528dc4a0cd42bb2becffbf84b9c0dfc2">fGenieGenModuleLabel</a>;<span class="comment">// label for input MC single particle generator</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1094a2f95d50b93f94b8d4224157965b">  110</a></span>&#160;    std::string     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1094a2f95d50b93f94b8d4224157965b">fG4ModuleLabel</a>;<span class="comment">// label for input MC single particle generator</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">  111</a></span>&#160;    std::string     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">fSortDim</a>; <span class="comment">// direction in which to sort spacepoints</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">//  TFile *fileGENFIT;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">  114</a></span>&#160;    TTree *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">  116</a></span>&#160;    TMatrixT&lt;Double_t&gt; *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">stMCT</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">  117</a></span>&#160;    TMatrixT&lt;Double_t&gt; *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">covMCT</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">  118</a></span>&#160;    TMatrixT&lt;Double_t&gt; *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">  119</a></span>&#160;    TMatrixT&lt;Double_t&gt; *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">  120</a></span>&#160;    Float_t <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">chi2</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab72440c7624691a34d8199795c54fdf7">  121</a></span>&#160;    Float_t <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab72440c7624691a34d8199795c54fdf7">chi2ndf</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad4009cd5cb3a4c77fdef5fca59f94b4a">  122</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad4009cd5cb3a4c77fdef5fca59f94b4a">fcont</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">  124</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">  125</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">  126</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">fpMCMom</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">  127</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">fpMCPos</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">  128</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">fState0</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">  129</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">fCov0</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7a6e7a0b35efa067667ce90bf8c53e95">  130</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7a6e7a0b35efa067667ce90bf8c53e95">nfail</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">  131</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">ndf</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a19abc2f92027fc0437caa8229c6605bf">  132</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a19abc2f92027fc0437caa8229c6605bf">nchi2rePass</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8efb2e23ee9af8c4d20146cb4b7126f0">  133</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8efb2e23ee9af8c4d20146cb4b7126f0">ispptvec</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af4c54e6ad0bc1b6cefc51cca114d19f5">  134</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af4c54e6ad0bc1b6cefc51cca114d19f5">nspptvec</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9dca5bc8c9313514589d2d5c6411a287">  135</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9dca5bc8c9313514589d2d5c6411a287">evtt</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">  136</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">nTrks</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">  137</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">  138</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">  139</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">  140</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">  141</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">feshx</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">  142</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">feshy</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">  143</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">feshz</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">  144</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">feshyz</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">  145</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">  146</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">  147</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">fth</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">  148</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">  149</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">  150</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">  151</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">  152</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">  153</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">fsep</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">  154</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">fdQdx</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">  155</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>; <span class="comment">// if necessary will get this from pset in constructor.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">  156</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">fPCmeans</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">  157</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">  158</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">fPCsigmas</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">  159</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">  160</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">  161</a></span>&#160;    Float_t *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">  163</a></span>&#160;    std::vector&lt;double&gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">fPosErr</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">  164</a></span>&#160;    std::vector&lt;double&gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">  165</a></span>&#160;    std::vector&lt;double&gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">fMomStart</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5563bd2cf53ca90f1d0ab6e85035fec8">  166</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5563bd2cf53ca90f1d0ab6e85035fec8">fPerpLim</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73ca4e3ef1e3cfebc2e7ab8a2292faed">  167</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73ca4e3ef1e3cfebc2e7ab8a2292faed">fDoFit</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">  168</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a00b9d476e554b933cd468b853280fc5c">  169</a></span>&#160;    uint16_t <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a00b9d476e554b933cd468b853280fc5c">fMinNumSppts</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa72479279d60b326f69f91ba52bd14fa">  170</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa72479279d60b326f69f91ba52bd14fa">fErrScaleS</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa3d20a00fc8487dc31ceb3d2991a656c">  171</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa3d20a00fc8487dc31ceb3d2991a656c">fErrScaleM</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#afa86b6db7a2cf5e3a3382dad99632e32">  172</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#afa86b6db7a2cf5e3a3382dad99632e32">fDecimate</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af0a319af20f43790eeff622ee1a99ec7">  173</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af0a319af20f43790eeff622ee1a99ec7">fMaxUpdate</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a51aa50dd51d6f45a93f7d1afaeb6e102">  174</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a51aa50dd51d6f45a93f7d1afaeb6e102">fDecimateU</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3290d686880f8d5a0ca01cab32cd97c9">  175</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3290d686880f8d5a0ca01cab32cd97c9">fDistanceU</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aefaf06a0a7796d9bf32d31a42472aa0e">  176</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aefaf06a0a7796d9bf32d31a42472aa0e">fMaxUpdateU</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a870dfc519ed7673076f6972866c981e8">  177</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a870dfc519ed7673076f6972866c981e8">fMomLow</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">  178</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">fMomHigh</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">  179</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">fPdg</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4616317bdd8aa4259547658854b05129">  180</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4616317bdd8aa4259547658854b05129">fChi2Thresh</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a053a4a7fa7010fc41f036b72b5db13da">  181</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a053a4a7fa7010fc41f036b72b5db13da">fMaxPass</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">  183</a></span>&#160;    <a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html">genf::GFAbsTrackRep</a> *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">  184</a></span>&#160;    <a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html">genf::GFAbsTrackRep</a> *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }; <span class="comment">// class Track3DKalmanSPS</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">namespace </span>trkf {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a059f4a9027a40f3c3a29db8c34e8f5fe">  193</a></span>&#160;  <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a059f4a9027a40f3c3a29db8c34e8f5fe">Track3DKalmanSPS::Track3DKalmanSPS</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    : EDProducer{pset}</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    , fDoFit(<span class="keyword">true</span>)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    , fNumIt(5)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    , fMinNumSppts(5)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    , fErrScaleS(1.0)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    , fErrScaleM(1.0)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    , fDecimate(1)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    , fMaxUpdate(0.10)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    , fDecimateU(1)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    , fDistanceU(1.)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    , fMaxUpdateU(0.10)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    , fMomLow(0.001)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    , fMomHigh(100.)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    , fPdg(-13)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    , fChi2Thresh(12.0E12)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    , fMaxPass (1)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    fClusterModuleLabel    = pset.get&lt; std::string &gt;(<span class="stringliteral">&quot;ClusterModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    fSpptModuleLabel       = pset.get&lt; std::string &gt;(<span class="stringliteral">&quot;SpptModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    fGenieGenModuleLabel   = pset.get&lt; std::string &gt;(<span class="stringliteral">&quot;GenieGenModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    fG4ModuleLabel         = pset.get&lt; std::string &gt;(<span class="stringliteral">&quot;G4ModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    fPosErr                = pset.get&lt; std::vector &lt; double &gt;  &gt;(<span class="stringliteral">&quot;PosErr3&quot;</span>);   <span class="comment">// resolution. cm</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    fMomErr                = pset.get&lt; std::vector &lt; double &gt;  &gt;(<span class="stringliteral">&quot;MomErr3&quot;</span>);   <span class="comment">// GeV</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    fMomStart              = pset.get&lt; std::vector &lt; double &gt;  &gt;(<span class="stringliteral">&quot;MomStart3&quot;</span>); <span class="comment">//</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    fPerpLim               = pset.get&lt; <span class="keywordtype">double</span>  &gt;(<span class="stringliteral">&quot;PerpLimit&quot;</span>, 1.e6); <span class="comment">// PCA cut.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    fDoFit                 = pset.get&lt; <span class="keywordtype">bool</span>  &gt;(<span class="stringliteral">&quot;DoFit&quot;</span>, <span class="keyword">true</span>); <span class="comment">// Der.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    fNumIt                 = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;NumIt&quot;</span>, 5); <span class="comment">// Number x2 passes per fit.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    fMinNumSppts           = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;MinNumSppts&quot;</span>, 5); <span class="comment">// Min number of sppts in vector to bother fitting</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    fErrScaleS             = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;ErrScaleSim&quot;</span>, 1.0); <span class="comment">// error scale.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    fErrScaleM             = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;ErrScaleMeas&quot;</span>, 1.0); <span class="comment">// error scale.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    fDecimate              = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;DecimateC&quot;</span>, 40); <span class="comment">// Sparsify data.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    fMaxUpdate             = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MaxUpdateC&quot;</span>, 0.1); <span class="comment">// 0-out.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    fDecimateU             = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;DecimateU&quot;</span>, 100);<span class="comment">// Sparsify data.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    fDistanceU             = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;DistanceU&quot;</span>, 10.0);<span class="comment">// Require this separation on uncontained 2nd pass.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    fMaxUpdateU            = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MaxUpdateU&quot;</span>, 0.02); <span class="comment">// 0-out.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    fMomLow                = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MomLow&quot;</span>, 0.01); <span class="comment">// Fit Range.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    fMomHigh               = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MomHigh&quot;</span>, 20.); <span class="comment">// Fit Range.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    fPdg                   = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;PdgCode&quot;</span>, -13); <span class="comment">// mu+ Hypothesis.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    fChi2Thresh            = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;Chi2HitThresh&quot;</span>, 12.0E12); <span class="comment">//For Re-pass.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    fSortDim               = pset.get&lt; std::string&gt; (<span class="stringliteral">&quot;SortDirection&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>); <span class="comment">// case sensitive</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    fMaxPass               = pset.get&lt; <span class="keywordtype">int</span>  &gt;(<span class="stringliteral">&quot;MaxPass&quot;</span>, 2); <span class="comment">// mu+ Hypothesis.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">bool</span> fGenfPRINT;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (pset.get_if_present(<span class="stringliteral">&quot;GenfPRINT&quot;</span>, fGenfPRINT)) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">MF_LOG_WARNING</a>(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Parameter &#39;GenfPRINT&#39; has been deprecated.\n&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="stringliteral">&quot;Please use the standard message facility to enable GenFit debug output.&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// A way to enable debug output is all of the following:</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// - compile in debug mode (no optimization, no profiling)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// - if that makes everything too noisy, add to have everything else quiet</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">//   services.message.debugModules: [ &quot;Track3DKalmanSPS&quot; ]</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// - to print all the GenFit debug messages, set</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">//   services.message.destinations.LogDebugFile.categories.Track3DKalmanSPS_GenFit.limit: -1</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">//   (assuming there is a LogDebugFile destination already; for example</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">//   see the settings in uboonecode/uboone/Utilities/services_microboone.fcl )</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    produces&lt; std::vector&lt;recob::Track&gt;                  &gt;();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    produces&lt;art::Assns&lt;recob::Track, recob::Cluster&gt;    &gt;();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    produces&lt;art::Assns&lt;recob::Track, recob::SpacePoint&gt; &gt;();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    produces&lt;art::Assns&lt;recob::Track, recob::Hit&gt;        &gt;();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// stolen, mostly, from GFMaterialEffects.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7702666bf7dc64083957821882f1310b">  260</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7702666bf7dc64083957821882f1310b">Track3DKalmanSPS::energyLossBetheBloch</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>=1.5</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> charge(1.0);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> mEE(188.); <span class="comment">// eV</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> matZ(18.);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> matA(40.);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> matDensity(1.4);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> me(0.000511);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">double</span> beta = <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>/std::sqrt(mass*mass+<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>*<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">double</span> gammaSquare = 1./(1.0 - beta*beta);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// 4pi.r_e^2.N.me = 0.307075, I think.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> dedx = 0.307075*matDensity*matZ/matA/(beta*beta)*charge*charge;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">double</span> massRatio = me/<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// me=0.000511 here is in GeV. So mEE comes in here in eV.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">double</span> argument = gammaSquare*beta*beta*me*1.E3*2./((1.E-6*mEE) * std::sqrt(1+2*std::sqrt(gammaSquare)*massRatio + massRatio*massRatio));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (mass==0.0) <span class="keywordflow">return</span>(0.0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (argument &lt;= <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(beta*beta))</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        dedx = 0.;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      dedx *= (log(argument)-beta*beta); <span class="comment">// Bethe-Bloch [MeV/cm]</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      dedx *= 1.E-3;  <span class="comment">// in GeV/cm, hence 1.e-3</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (dedx&lt;0.) dedx = 0.;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> dedx;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad78bb6f946608b7f8eaccd384f501fd7">  292</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad78bb6f946608b7f8eaccd384f501fd7">Track3DKalmanSPS::rotationCov</a>(TMatrixT&lt;Double_t&gt; &amp;cov, <span class="keyword">const</span> TVector3 &amp;u, <span class="keyword">const</span> TVector3 &amp;v)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    TVector3 xhat(1.0,0.0,0.0);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    TVector3 yhat(0.0,1.0,0.0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    TVector3 zhat(0.0,0.0,1.0);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    TVector3 <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>(u.Cross(v));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    TVector3 uprime(u);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    TVector3 vprime(<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>.Cross(xhat)); <span class="comment">// vprime now lies in yz plane</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    Double_t <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>(v.Angle(vprime));<span class="comment">/* This is the angle through which v</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">                                       must rotate. */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    uprime.Rotate(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>,<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>);<span class="comment">// u now is rotated the same amount</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (uprime*xhat&lt;0)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        uprime.Rotate(TMath::Pi(),<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        vprime.Rotate(TMath::Pi(),<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>+=TMath::Pi();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Build the block-diagonal 5x5 matrix</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">double</span> c = TMath::Cos(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>), <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = TMath::Sin(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    TMatrixT&lt;Double_t&gt; rot(5,5);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    rot[0][0] = 1.0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    rot[1][1] =  c;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    rot[1][2] =  <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    rot[2][1] = -<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    rot[2][2] =  c;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    rot[3][3] =  c;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    rot[3][4] =  <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    rot[4][3] = -<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    rot[4][4] =  c;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    cov=rot*cov;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3961ab423ca0e4a28a9a4006fc4a745c">  325</a></span>&#160;   std::vector&lt;double&gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3961ab423ca0e4a28a9a4006fc4a745c">Track3DKalmanSPS::dQdxCalc</a>(<span class="keyword">const</span> art::FindManyP&lt;recob::Hit&gt; &amp;<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>, <span class="keyword">const</span> art::PtrVector&lt;recob::SpacePoint&gt; &amp;<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, <span class="keyword">const</span> TVector3 &amp;<a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>, <span class="keyword">const</span> TVector3 &amp;<a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#aeee9f371db14fda0de35d16324a167df">loc</a> )</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// For now just Collection plane.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">// We should loop over all views, more generally.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a> sig(<a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keyword">static</span> art::PtrVector&lt;recob::SpacePoint&gt;::const_iterator sstart(s.begin());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">//      art::PtrVector&lt;recob::SpacePoint&gt;::const_iterator sppt = sstart;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      art::PtrVector&lt;recob::SpacePoint&gt;::const_iterator sppt = s.begin();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      std::vector &lt;double&gt; v;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordtype">double</span> mindist(100.0); <span class="comment">// cm</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keyword">auto</span> spptminIt(sppt);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">while</span> (sppt != s.end())</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          <span class="keywordflow">if</span> (((**sppt).XYZ() - <a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#aeee9f371db14fda0de35d16324a167df">loc</a>).Mag() &lt; mindist)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a> = ((**sppt).XYZ() - <a class="code" href="../../d0/d8f/runFilesFromSAM_8sh.html#aeee9f371db14fda0de35d16324a167df">loc</a>).Mag();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="comment">// Jump out if we&#39;re as close as 0.1 mm away.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;              <span class="keywordflow">if</span> (dist&lt;mindist)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                  mindist = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                  spptminIt = sppt;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                  <span class="keywordflow">if</span> (mindist &lt; 0.01) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          sppt++;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      sstart = spptminIt; <span class="comment">// for next time.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ind(std::distance(s.begin(),spptminIt));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      std::vector&lt; art::Ptr&lt;recob::Hit&gt; &gt; hitlist = h.at(ind);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordtype">double</span> wirePitch = 0.;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordtype">double</span> angleToVert = 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">//      unsigned int tpc1;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane1;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordtype">double</span> charge = 0.;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt; art::Ptr&lt;recob::Hit&gt; &gt;::const_iterator ihit = hitlist.begin();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          ihit != hitlist.end(); ++ihit)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; hit1 = **ihit;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="comment">//      if (hit1.View() != view) continue;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="keywordflow">if</span> (hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a19a017039c62b9be286cd55944686ec4">SignalType</a>() != sig) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hit1WireID = hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="comment">//      tpc1 = hit1WireID.TPC;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          plane1 = hit1WireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          charge = hit1.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          wirePitch = geom-&gt;WirePitch(plane1);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          angleToVert = geom-&gt;Plane(plane1).Wire(0).ThetaZ(<span class="keyword">false</span>) - 0.5*TMath::Pi();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordtype">double</span> cosgamma = TMath::Abs(TMath::Sin(angleToVert)*dir.Y() +</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                   TMath::Cos(angleToVert)*dir.Z());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">// if(cosgamma &lt; 1.e-5)</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">//      throw cet::exception(&quot;Track&quot;) &lt;&lt; &quot;cosgamma is basically 0, that can&#39;t be right\n&quot;;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      v.push_back(charge/wirePitch/cosgamma);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot; Track3DKalmanSPS::dQdxCalc() : For loc.XYZ() hit is ... &quot; &lt;&lt; ind &lt;&lt; &quot; and v is &quot; &lt;&lt; v.back() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#adfcffc313cd8d80bd22f6c67fb151645">  396</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#adfcffc313cd8d80bd22f6c67fb151645">Track3DKalmanSPS::beginJob</a>()</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">stMCT</a>  = <span class="keyword">new</span> TMatrixT&lt;Double_t&gt;(5,1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">covMCT</a> = <span class="keyword">new</span> TMatrixT&lt;Double_t&gt;(5,5);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a>  = <span class="keyword">new</span> TMatrixT&lt;Double_t&gt;(5,1);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a> = <span class="keyword">new</span> TMatrixT&lt;Double_t&gt;(5,5);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">fpMCMom</a> = <span class="keyword">new</span> Float_t[4];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">fpMCPos</a> = <span class="keyword">new</span> Float_t[4];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a> = <span class="keyword">new</span> Float_t[4];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a> = <span class="keyword">new</span> Float_t[4];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">fState0</a> = <span class="keyword">new</span> Float_t[5];</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">fCov0</a> = <span class="keyword">new</span> Float_t[25];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a> = 20000; <span class="comment">// if necessary will get this from pset in constructor.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">feshx</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">feshy</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">feshz</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">feshyz</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">fth</a>  = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">fsep</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">fdQdx</a> = <span class="keyword">new</span> Float_t[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">fPCmeans</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">fPCsigmas</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a> = <span class="keyword">new</span> Float_t[3];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//   //TFile fileGENFIT(&quot;GENFITout.root&quot;,&quot;RECREATE&quot;);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a> = tfs-&gt;make&lt;TTree&gt;(<span class="stringliteral">&quot;GENFITttree&quot;</span>,<span class="stringliteral">&quot;GENFITttree&quot;</span>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">//tree-&gt;Branch(&quot;stMCT&quot;,&amp;stMCT,&quot;stMCT[5]/F&quot;); // &quot;TMatrixT&lt;Double_t&gt;&quot;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">//tree-&gt;Branch(&quot;stMCT&quot;,&quot;TMatrixD&quot;,&amp;stMCT,64000,0);</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">//tree-&gt;Branch(&quot;covMCT&quot;,covMCT,&quot;covMCT[25]/F&quot;);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;covMCT&quot;</span>,<span class="stringliteral">&quot;TMatrixD&quot;</span>,&amp;covMCT,64000,0);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;stREC&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">fState0</a>,<span class="stringliteral">&quot;stREC[5]/F&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">//tree-&gt;Branch(&quot;stREC&quot;,&quot;TMatrixD&quot;,&amp;stREC,64000,0);</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;covREC&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">fCov0</a>,<span class="stringliteral">&quot;covREC[25]/F&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//tree-&gt;Branch(&quot;covREC&quot;,&quot;TMatrixD&quot;,&amp;covREC,64000,0);</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;nchi2rePass&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a19abc2f92027fc0437caa8229c6605bf">nchi2rePass</a>,<span class="stringliteral">&quot;nchi2rePass/I&quot;</span>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;ispptvec&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8efb2e23ee9af8c4d20146cb4b7126f0">ispptvec</a>,<span class="stringliteral">&quot;ispptvec/I&quot;</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">chi2</a>,<span class="stringliteral">&quot;chi2/F&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;nfail&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7a6e7a0b35efa067667ce90bf8c53e95">nfail</a>,<span class="stringliteral">&quot;nfail/I&quot;</span>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;ndf&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">ndf</a>,<span class="stringliteral">&quot;ndf/I&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;evtNo&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9dca5bc8c9313514589d2d5c6411a287">evtt</a>,<span class="stringliteral">&quot;evtNo/I&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;nspptvec&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af4c54e6ad0bc1b6cefc51cca114d19f5">nspptvec</a>,<span class="stringliteral">&quot;nspptvec/I&quot;</span>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2ndf&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab72440c7624691a34d8199795c54fdf7">chi2ndf</a>,<span class="stringliteral">&quot;chi2ndf/F&quot;</span>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;trkNo&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">nTrks</a>,<span class="stringliteral">&quot;trkNo/I&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;ptsNo&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>,<span class="stringliteral">&quot;ptsNo/I&quot;</span>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;cont&quot;</span>,&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad4009cd5cb3a4c77fdef5fca59f94b4a">fcont</a>,<span class="stringliteral">&quot;cont/I&quot;</span>); <span class="comment">//O? Yes, O. Not 0, not L, ...</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;shx&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>,<span class="stringliteral">&quot;shx[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;shy&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>,<span class="stringliteral">&quot;shy[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;shz&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>,<span class="stringliteral">&quot;shz[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;sep&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">fsep</a>,<span class="stringliteral">&quot;sep[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;dQdx&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">fdQdx</a>,<span class="stringliteral">&quot;dQdx[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eshx&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">feshx</a>,<span class="stringliteral">&quot;eshx[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eshy&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">feshy</a>,<span class="stringliteral">&quot;eshy[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eshz&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">feshz</a>,<span class="stringliteral">&quot;eshz[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eshyz&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">feshyz</a>,<span class="stringliteral">&quot;eshyz[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;update&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a>,<span class="stringliteral">&quot;update[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2hit&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>,<span class="stringliteral">&quot;chi2hit[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;th&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">fth</a>,<span class="stringliteral">&quot;th[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eth&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a>,<span class="stringliteral">&quot;eth[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;edudw&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a>,<span class="stringliteral">&quot;edudw[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;edvdw&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a>,<span class="stringliteral">&quot;edvdw[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;eu&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a>,<span class="stringliteral">&quot;eu[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;ev&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a>,<span class="stringliteral">&quot;ev[ptsNo]/F&quot;</span>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcMeans&quot;</span>, <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">fPCmeans</a>,<span class="stringliteral">&quot;pcMeans[3]/F&quot;</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcSigmas&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">fPCsigmas</a>,<span class="stringliteral">&quot;pcSigmas[3]/F&quot;</span>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcEvals&quot;</span>, <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>,<span class="stringliteral">&quot;pcEvals[3]/F&quot;</span>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcEvec1&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a>,<span class="stringliteral">&quot;pcEvec1[3]/F&quot;</span>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcEvec2&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a>,<span class="stringliteral">&quot;pcEvec2[3]/F&quot;</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pcEvec3&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a>,<span class="stringliteral">&quot;pcEvec3[3]/F&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pMCMom&quot;</span>,fpMCMom,<span class="stringliteral">&quot;pMCMom[4]/F&quot;</span>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pMCPos&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">fpMCPos</a>,<span class="stringliteral">&quot;pMCPos[4]/F&quot;</span>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pRECKalF&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>,<span class="stringliteral">&quot;pRECKalF[4]/F&quot;</span>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Branch(<span class="stringliteral">&quot;pRECKalL&quot;</span>,<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a>,<span class="stringliteral">&quot;pRECKalL[4]/F&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">//TGeoManager* geomGENFIT = new TGeoManager(&quot;Geometry&quot;, &quot;Geane geometry&quot;);</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">//TGeoManager::Import(&quot;config/genfitGeom.root&quot;);</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">//  gROOT-&gt;Macro(&quot;config/Geane.C&quot;);</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7e83a16d9bff674bf0bcabfaf932e846">  506</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7e83a16d9bff674bf0bcabfaf932e846">Track3DKalmanSPS::endJob</a>()</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>) <span class="keyword">delete</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>) <span class="keyword">delete</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  //  not sure why I can&#39;t do these, but at least some cause seg faults.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  delete[] stMCT;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  delete[] covMCT;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">  delete[] stREC;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">  delete[] covREC;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">fState0</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">fCov0</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">feshx</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">feshy</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">feshyz</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">feshz</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">fth</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">fsep</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">fdQdx</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">fPCmeans</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">fPCsigmas</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">//------------------------------------------------------------------------------------//</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5506e5aeb47f53b533e0a472968e6b9c">  553</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5506e5aeb47f53b533e0a472968e6b9c">Track3DKalmanSPS::produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>=0;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>=0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// get services</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  //////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span>  <span class="comment">// Make a std::unique_ptr&lt;&gt; for the thing you want to put into the event</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// because that handles the memory management for you</span><span class="comment"></span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  //////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span>  std::unique_ptr&lt;std::vector&lt;recob::Track&gt; &gt; tcol(<span class="keyword">new</span> std::vector&lt;recob::Track&gt;);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  std::unique_ptr&lt; art::Assns&lt;recob::Track, recob::SpacePoint&gt; &gt; tspassn(<span class="keyword">new</span> art::Assns&lt;recob::Track, recob::SpacePoint&gt;);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  std::unique_ptr&lt; art::Assns&lt;recob::Track, recob::Hit&gt; &gt; thassn(<span class="keyword">new</span> art::Assns&lt;recob::Track, recob::Hit&gt;);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tcnt = 0;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// define TPC parameters</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  TString tpcName = geom-&gt;GetLArTPCVolumeName();</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// get input Hit object(s).</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  art::Handle&lt; std::vector&lt;recob::Cluster&gt; &gt; clusterListHandle;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  evt.getByLabel(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2110a60a25052899732d5148da99ac5c">fClusterModuleLabel</a>,clusterListHandle);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  art::Handle&lt; std::vector&lt; art::PtrVector &lt; recob::SpacePoint &gt; &gt; &gt; spptListHandle;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  evt.getByLabel(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4814469790a4d733161f39b0cf26deea">fSpptModuleLabel</a>,spptListHandle);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  art::PtrVector&lt;simb::MCTruth&gt; mclist;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">  /// \todo Should never test whether the event is real data in reconstruction algorithms</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">  /// \todo as that introduces potential data/MC differences that are very hard to track down</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">  /// \todo Remove this test as soon as possible please</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span> (!evt.isRealData()){</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot;Track3DKalmanSPS: This is MC.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">// std::cout&lt;&lt;&quot;Run &quot;&lt;&lt;evt.run()&lt;&lt;&quot; Event &quot;&lt;&lt;evt.id().event()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      art::Handle&lt; std::vector&lt;simb::MCTruth&gt; &gt; mctruthListHandle;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      evt.getByLabel(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a528dc4a0cd42bb2becffbf84b9c0dfc2">fGenieGenModuleLabel</a>,mctruthListHandle);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt;  mctruthListHandle-&gt;size(); ++ii)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          art::Ptr&lt;simb::MCTruth&gt; mctparticle(mctruthListHandle,ii);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          mclist.push_back(mctparticle);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// std::cout&lt;&lt;&quot;Run &quot;&lt;&lt;evt.run()&lt;&lt;&quot; Event &quot;&lt;&lt;evt.id().event()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// Put this back when Wes&#39;s reign of terror ends ...</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">//  MF_LOG_DEBUG(&quot;Track3DKalmanSPS&quot;) &lt;&lt; &quot;There are &quot; &lt;&lt;  spptListHandle-&gt;size() &lt;&lt; &quot; Spacepoint PtrVectors (spacepoint clumps) in this event.&quot;;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  std::vector &lt; art::PtrVector&lt;recob::SpacePoint&gt; &gt; spptIn(spptListHandle-&gt;begin(),spptListHandle-&gt;end());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// Get the spptvectors that are largest to be first, and smallest last.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  std::sort(spptIn.begin(), spptIn.end(), <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a3a89dfb7215ac4a87edff409a572c319">sp_sort_nsppts</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  std::vector &lt; art::PtrVector&lt;recob::SpacePoint&gt; &gt;::const_iterator sppt = spptIn.begin();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keyword">auto</span> spptB = sppt;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  TVector3 MCOrigin;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  TVector3 MCMomentum;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// TVector3 posErr(.05,.05,.05); // resolution. 0.5mm</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// TVector3 momErr(.1,.1,0.2);   // GeV</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  TVector3 posErr(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">fPosErr</a>[0],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">fPosErr</a>[1],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">fPosErr</a>[2]); <span class="comment">// resolution. 0.5mm</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  TVector3 momErr(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[0],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[1],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[2]);   <span class="comment">// GeV</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  TVector3 momErrFit(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[0],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[1],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">fMomErr</a>[2]);   <span class="comment">// GeV</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// This is strictly for MC</span><span class="comment"></span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">  /// \todo Should never test whether the event is real data in reconstruction algorithms</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">  /// \todo as that introduces potential data/MC differences that are very hard to track down</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">  /// \todo Remove this test as soon as possible please</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span> (!evt.isRealData())</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="comment">// Below breaks are stupid, I realize. But rather than keep all the MC</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="comment">// particles I just take the first primary, e.g., muon and only keep its</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// info in the branches of the Ttree. I could generalize later, ...</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; mclist.size(); ++ii )</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="comment">//art::Ptr&lt;const simb::MCTruth&gt; mc(mctruthListHandle,i);</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            art::Ptr&lt;simb::MCTruth&gt; mc(mclist[ii]);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = 0; jj &lt; mc-&gt;NParticles(); ++jj)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;              {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                simb::MCParticle part(mc-&gt;GetParticle(jj));</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                MCOrigin.SetXYZ(part.Vx(),part.Vy(),part.Vz()); <span class="comment">// V for Vertex</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                MCMomentum.SetXYZ(part.Px(),part.Py(),part.Pz());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;FROM MC TRUTH, the particle&#39;s pdg code is: &quot;</span>&lt;&lt;part.PdgCode()&lt;&lt; <span class="stringliteral">&quot; with energy = &quot;</span>&lt;&lt;part.E() &lt;&lt;<span class="stringliteral">&quot;, with energy = &quot;</span>&lt;&lt;part.E()</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;\n  vtx: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(MCOrigin)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;\n  momentum: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(MCMomentum)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;\n    (both in Global (not volTPC) coords)&quot;</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a> = <span class="keyword">new</span> <a class="code" href="../../dc/d1d/classgenf_1_1RKTrackRep.html">genf::RKTrackRep</a>(MCOrigin,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                             MCMomentum,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                             posErr,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                             momErr,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                             part.PdgCode());</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;              }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <span class="comment">//for saving of MC truth</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">stMCT</a>-&gt;ResizeTo(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">getState</a>());</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">stMCT</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">getState</a>();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">covMCT</a>-&gt; ResizeTo(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">getCov</a>());</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">covMCT</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">getCov</a>();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; repMC, covMC are ... \n&quot;</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">getState</a>())</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">getCov</a>());</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        } <span class="comment">// !isRealData</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">nTrks</a> = 0;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      TParticlePDG * part = TDatabasePDG::Instance()-&gt;GetParticle(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">fPdg</a>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      Double_t <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a> = part-&gt;Mass();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordtype">size_t</span> cntp(0);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">while</span> (sppt!=spptIn.end())</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="keyword">const</span> art::PtrVector&lt;recob::SpacePoint&gt; &amp; spacepoints = *sppt;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="keywordtype">double</span> fMaxUpdateHere(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aefaf06a0a7796d9bf32d31a42472aa0e">fMaxUpdateU</a>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordtype">int</span> fDecimateHere(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a51aa50dd51d6f45a93f7d1afaeb6e102">fDecimateU</a>);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keywordtype">double</span> fErrScaleSHere(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa72479279d60b326f69f91ba52bd14fa">fErrScaleS</a>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keywordtype">double</span> fErrScaleMHere(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa3d20a00fc8487dc31ceb3d2991a656c">fErrScaleM</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          <span class="keywordtype">int</span> rePass0(1);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nTailPoints = 0; <span class="comment">// 100;</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keywordflow">if</span> (spacepoints.size()&lt;5)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            { sppt++; rePass0 = 3; <span class="keywordflow">continue</span>;} <span class="comment">// for now...</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;\n\t found &quot;</span>&lt;&lt;spacepoints.size()&lt;&lt;<span class="stringliteral">&quot; 3D spacepoint(s) for this element of std::vector&lt;art:PtrVector&gt; spacepoints. \n&quot;</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="comment">//const double resolution = posErr.Mag();</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          <span class="comment">// Let&#39;s find track&#39;s principle components.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          <span class="comment">// We will sort along that direction, rather than z.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="comment">// Further, we will skip outliers away from main axis.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          TPrincipal* principal = <span class="keyword">new</span> TPrincipal(3,<span class="stringliteral">&quot;ND&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;          <span class="comment">// I need to shuffle these around, so use copy constructor</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          <span class="comment">// to make non-const version spacepointss.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          art::PtrVector&lt;recob::SpacePoint&gt; spacepointss(spacepoints);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="comment">// What I need is a nearest neighbor sorting.</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">fSortDim</a>.compare(<span class="stringliteral">&quot;y&quot;</span>) &amp;&amp; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">fSortDim</a>.compare(<span class="stringliteral">&quot;x&quot;</span>)) std::sort(spacepointss.begin(), spacepointss.end(), <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#ae807a928af6da3ddaece0d3d3cf8139f">sp_sort_3dz</a>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">fSortDim</a>.compare(<span class="stringliteral">&quot;y&quot;</span>)) std::sort(spacepointss.begin(), spacepointss.end(), <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a7032263c9a4b40e04508141cab74f889">sp_sort_3dy</a>);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">fSortDim</a>.compare(<span class="stringliteral">&quot;x&quot;</span>)) std::sort(spacepointss.begin(), spacepointss.end(), <a class="code" href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a4c97875920f5de204382b4d0b1ccf203">sp_sort_3dx</a>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> point=0;point&lt;spacepointss.size();++point)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;              <span class="comment">//              std::cout &lt;&lt; &quot;Spacepoint &quot; &lt;&lt; point &lt;&lt; &quot; added:&quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[0]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[1]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[2]&lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;              <span class="keywordflow">if</span> (point&lt;(spacepointss.size()-nTailPoints))</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                  principal-&gt;AddRow(spacepointss[point]-&gt;XYZ());</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          principal-&gt;MakePrincipals();</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          <span class="comment">/*</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">            principal-&gt;Test();</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">            principal-&gt;MakeHistograms();</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">            principal-&gt;Print(&quot;MSEV&quot;);</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">          */</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          <span class="keyword">const</span> TVectorD* evals = principal-&gt;GetEigenValues();</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <span class="keyword">const</span> TMatrixD* evecs = principal-&gt;GetEigenVectors();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="keyword">const</span> TVectorD* means = principal-&gt;GetMeanValues();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          <span class="keyword">const</span> TVectorD* sigmas = principal-&gt;GetSigmas();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">          std::vector&lt;TVector3*&gt; pcs;</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">          Double_t* pc = new Double_t[3];</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">          for (unsigned int point=0;point&lt;spacepointss.size();++point)</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">              principal-&gt;X2P((Double_t *)(spacepointss[point]-&gt;XYZ()),pc);</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">              pcs.push_back((TVector3 *)pc); // !!!</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">          delete [] pc;</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          Double_t tmp[3], tmp2[3];</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          principal-&gt;X2P((Double_t *)(means-&gt;GetMatrixArray()),tmp);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          principal-&gt;X2P((Double_t *)(sigmas-&gt;GetMatrixArray()),tmp2);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii=0;ii&lt;3;++ii)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">fPCmeans</a>[ii] = (Float_t )(tmp[ii]);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">fPCsigmas</a>[ii] = (Float_t )(tmp2[ii]);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>[ii] = (Float_t )(evals-&gt;GetMatrixArray())[ii];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;              <span class="comment">// This method requires apparently pulling all 9</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;              <span class="comment">// elements. Maybe 3 works.</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              <span class="comment">// Certainly, w can&#39;t be a scalar, I discovered.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>[9];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;              evecs-&gt;ExtractRow(ii,0,w);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a>[ii] = w[0];</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a>[ii] = w[1];</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a>[ii] = w[2];</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          Double_t tmp3[3], tmp4[3], tmp5[3];</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          principal-&gt;X2P((Double_t *)<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">fPC1</a>,tmp3);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          principal-&gt;X2P((Double_t *)<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">fPC2</a>,tmp4);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          principal-&gt;X2P((Double_t *)<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">fPC3</a>,tmp5);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <span class="comment">// Use a mip approximation assuming straight lines</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          <span class="comment">// and a small angle wrt beam.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">fMomStart</a>[0] = spacepointss[spacepointss.size()-1]-&gt;XYZ()[0] - spacepointss[0]-&gt;XYZ()[0];</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">fMomStart</a>[1] = spacepointss[spacepointss.size()-1]-&gt;XYZ()[1] - spacepointss[0]-&gt;XYZ()[1];</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">fMomStart</a>[2] = spacepointss[spacepointss.size()-1]-&gt;XYZ()[2] - spacepointss[0]-&gt;XYZ()[2];</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          <span class="comment">// This presumes a 0.8 GeV/c particle</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../de/d0f/namespacetca.html#a03d7925cba1cd1c5952d280736887b6b">dEdx</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7702666bf7dc64083957821882f1310b">energyLossBetheBloch</a>(mass, 1.0);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="comment">// mom is really KE.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          TVector3 mom(dEdx*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">fMomStart</a>[0],dEdx*fMomStart[1],dEdx*fMomStart[2]);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          <span class="keywordtype">double</span> pmag2 = pow(mom.Mag()+<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>, 2. - mass*<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;          mom.SetMag(std::sqrt(pmag2));</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;          <span class="comment">// Over-estimate by just enough for contained particles (5%).</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;          mom.SetMag(1.0 * mom.Mag());</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          <span class="comment">// My true 0.5 GeV/c muons need a yet bigger over-estimate.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          <span class="comment">//if (mom.Mag()&lt;0.7) mom.SetMag(1.2*mom.Mag());</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          <span class="comment">//      if (mom.Mag()&gt;2.0) mom.SetMag(10.0*mom.Mag());</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="comment">//      mom.SetMag(3*mom.Mag()); // EC, 15-Feb-2012. TEMPORARY!!!</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <span class="comment">// If 1st/last point is close to edge of TPC, this track is</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          <span class="comment">// uncontained.Give higher momentum starting value in</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          <span class="comment">// that case.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <span class="keywordtype">bool</span> uncontained(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>(5.); <span class="comment">// cm.</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <span class="keywordtype">double</span> epsMag(0.001);<span class="comment">// cm.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          <span class="keywordtype">double</span> epsX(250.0);  <span class="comment">// cm.</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          <span class="keywordtype">double</span> epsZ(0.001);  <span class="comment">// cm.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;              spacepointss[spacepointss.size()-1]-&gt;XYZ()[0] &gt; (2.*geom-&gt;DetHalfWidth(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || spacepointss[spacepointss.size()-1]-&gt;XYZ()[0] &lt; close ||</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;              spacepointss[0]-&gt;XYZ()[0] &gt; (2.*geom-&gt;DetHalfWidth(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || spacepointss[0]-&gt;XYZ()[0] &lt; close ||</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;              spacepointss[spacepointss.size()-1]-&gt;XYZ()[1] &gt; (1.*geom-&gt;DetHalfHeight(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || (spacepointss[spacepointss.size()-1]-&gt;XYZ()[1] &lt; -1.*geom-&gt;DetHalfHeight(0,0)+<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) ||</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;              spacepointss[0]-&gt;XYZ()[1] &gt; (1.*geom-&gt;DetHalfHeight(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || spacepointss[0]-&gt;XYZ()[1] &lt; (-1.*geom-&gt;DetHalfHeight(0,0)+<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) ||</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;              spacepointss[spacepointss.size()-1]-&gt;XYZ()[2] &gt; (geom-&gt;DetLength(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || spacepointss[spacepointss.size()-1]-&gt;XYZ()[2] &lt; close ||</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;              spacepointss[0]-&gt;XYZ()[2] &gt; (geom-&gt;DetLength(0,0)-<a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a>) || spacepointss[0]-&gt;XYZ()[2] &lt; <a class="code" href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;              )</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            uncontained = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          fErrScaleSHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa72479279d60b326f69f91ba52bd14fa">fErrScaleS</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          fErrScaleMHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa3d20a00fc8487dc31ceb3d2991a656c">fErrScaleM</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          <span class="keywordflow">if</span> (uncontained)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;              <span class="comment">// Big enough to not run out of gas right at end of</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;              <span class="comment">// track and give large angular deviations which</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;              <span class="comment">// will kill the fit.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;              mom.SetMag(2.0 * mom.Mag());</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;              MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)&lt;&lt;<span class="stringliteral">&quot;Uncontained track ... &quot;</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;              fDecimateHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a51aa50dd51d6f45a93f7d1afaeb6e102">fDecimateU</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;              fMaxUpdateHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aefaf06a0a7796d9bf32d31a42472aa0e">fMaxUpdateU</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;              MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)&lt;&lt;<span class="stringliteral">&quot;Contained track ... Run &quot;</span>&lt;&lt;evt.run()&lt;&lt;<span class="stringliteral">&quot; Event &quot;</span>&lt;&lt;evt.id().event();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;              <span class="comment">// Don&#39;t decimate contained tracks as drastically,</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;              <span class="comment">// and omit only very large corrections ...</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;              <span class="comment">// which hurt only high momentum tracks.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;              fDecimateHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#afa86b6db7a2cf5e3a3382dad99632e32">fDecimate</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;              fMaxUpdateHere = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af0a319af20f43790eeff622ee1a99ec7">fMaxUpdate</a>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad4009cd5cb3a4c77fdef5fca59f94b4a">fcont</a> = (int) (!uncontained);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="comment">// This seems like best place to jump back to for a re-pass.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rePass = rePass0; <span class="comment">// 1 by default;</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> maxPass(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a053a4a7fa7010fc41f036b72b5db13da">fMaxPass</a>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tcnt1(0);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          <span class="keywordflow">while</span> (rePass&lt;=maxPass)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;              TVector3 momM(mom);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;              TVector3 momErrFit(momM[0]/3.0,</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                 momM[1]/3.0,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                 momM[2]/3.0);   <span class="comment">// GeV</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;              <a class="code" href="../../dd/d50/classgenf_1_1GFFieldManager.html#a32fc17b84bd4a87376103389c92f9229">genf::GFFieldManager::getInstance</a>()-&gt;<a class="code" href="../../dd/d50/classgenf_1_1GFFieldManager.html#abdf2d962e17190bd3a07458735ed28a8">init</a>(<span class="keyword">new</span> <a class="code" href="../../d5/dfa/classgenf_1_1GFConstField.html">genf::GFConstField</a>(0.0,0.0,0.0));</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;              <a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html">genf::GFDetPlane</a> planeG((TVector3)(spacepointss[0]-&gt;XYZ()),momM);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;              <span class="comment">//      std::cout&lt;&lt;&quot;Track3DKalmanSPS about to do GAbsTrackRep.&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;              <span class="comment">// Initialize with 1st spacepoint location and ...</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a> = <span class="keyword">new</span> <a class="code" href="../../dc/d1d/classgenf_1_1RKTrackRep.html">genf::RKTrackRep</a>(<span class="comment">//posM-.5/momM.Mag()*momM,</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                         (TVector3)(spacepointss[0]-&gt;XYZ()),</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                         momM,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                         posErr,</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                         momErrFit,</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                         <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">fPdg</a>);  <span class="comment">// mu+ hypothesis</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;              <span class="comment">//      std::cout&lt;&lt;&quot;Track3DKalmanSPS: about to do GFTrack. repDim is &quot; &lt;&lt; rep-&gt;getDim() &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;              <a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html">genf::GFTrack</a> fitTrack(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>);<span class="comment">//initialized with smeared rep</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a5404a2d9ea2e02fcc4a1e229aa58a78f">setPDG</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">fPdg</a>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;              <span class="comment">// Gonna sort in z cuz I want to essentially transform here to volTPC coords.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;              <span class="comment">// volTPC coords, cuz that&#39;s what the Geant3/Geane stepper wants, as that&#39;s its understanding</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;              <span class="comment">// from the Geant4 geometry, which it&#39;ll use. EC, 7-Jan-2011.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;              <span class="keywordtype">int</span> ihit = 0;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a> = 0;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;              std::vector &lt;unsigned int&gt; spptSurvivedIndex;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;              std::vector &lt;unsigned int&gt; spptSkippedIndex;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ppoint(0);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> point=0;point&lt;spacepointss.size();++point)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                  <span class="keywordtype">double</span> sep;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                  <span class="comment">// Calculate the distance in 2nd and 3rd PCs and</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                  <span class="comment">// reject spt if it&#39;s too far out. Remember, the</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                  <span class="comment">// sigmas are std::sqrt(eigenvals).</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                  <span class="keywordtype">double</span> tmp[3];</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                  principal-&gt;X2P((Double_t *)(spacepointss[point]-&gt;XYZ()),tmp);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                  sep = std::sqrt(tmp[1]*tmp[1]/<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>[1]+tmp[2]*tmp[2]/<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">fPCevals</a>[2]);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                  <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(sep) &gt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5563bd2cf53ca90f1d0ab6e85035fec8">fPerpLim</a>) &amp;&amp; (point&lt;(spacepointss.size()-nTailPoints)) &amp;&amp; rePass&lt;=1)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                      <span class="comment">//                      std::cout &lt;&lt; &quot;Spacepoint &quot; &lt;&lt; point &lt;&lt; &quot; DROPPED, cuz it&#39;s sufficiently far from the PCA major axis!!!:&quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[0]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[1]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[2]&lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                      spptSkippedIndex.push_back(point);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                  <span class="comment">// If point is too close in Mag or Z or too far in X from last kept point drop it.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                  <span class="comment">// I think this is largely redundant with PCA cut.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                  TVector3 <a class="code" href="../../d5/d6b/makeNoOverburdenVersionOf_8sh.html#aed8c88c45b85ce77144caff93012211c">one</a>(spacepointss[point]-&gt;XYZ());</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                  TVector3 two(spacepointss[ppoint]-&gt;XYZ());</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                  <span class="keywordflow">if</span> (rePass==2 &amp;&amp; uncontained)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                      epsMag = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3290d686880f8d5a0ca01cab32cd97c9">fDistanceU</a>; <span class="comment">// cm</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a> = 4;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                      fErrScaleMHere = 0.1;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                      <span class="comment">// Above allows us to pretend as though measurements</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                      <span class="comment">// are perfect, which we can ostensibly do now with</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                      <span class="comment">// clean set of sppts. This creates larger gains, bigger</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                      <span class="comment">// updates: bigger sensitivity to multiple scattering.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                      <span class="comment">//                      std::cout &lt;&lt; &quot;Spacepoint &quot; &lt;&lt; point &lt;&lt; &quot; ?DROPPED? magnitude and TV3 diff to ppoint is :&quot; &lt;&lt; (((TVector3)(spacepointss[point]-&gt;XYZ()-spacepointss[ppoint]-&gt;XYZ())).Mag()) &lt;&lt; &quot; and &quot; &lt;&lt; one[0] &lt;&lt; &quot;, &quot; &lt;&lt; one[1] &lt;&lt; &quot;, &quot; &lt;&lt; one[2] &lt;&lt; two[0] &lt;&lt; &quot;, &quot; &lt;&lt; two[1] &lt;&lt; &quot;, &quot; &lt;&lt; two[2] &lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rePass==2 &amp;&amp; !uncontained)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                      <span class="comment">//                      fNumIt = 2;</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                      <span class="comment">//                      std::cout &lt;&lt; &quot;Spacepoint &quot; &lt;&lt; point &lt;&lt; &quot; ?DROPPED? magnitude and TV3 diff to ppoint is :&quot; &lt;&lt; (((TVector3)(spacepointss[point]-&gt;XYZ()-spacepointss[ppoint]-&gt;XYZ())).Mag()) &lt;&lt; &quot; and &quot; &lt;&lt; one[0] &lt;&lt; &quot;, &quot; &lt;&lt; one[1] &lt;&lt; &quot;, &quot; &lt;&lt; one[2] &lt;&lt; two[0] &lt;&lt; &quot;, &quot; &lt;&lt; two[1] &lt;&lt; &quot;, &quot; &lt;&lt; two[2] &lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                  <span class="keywordflow">if</span> (point&gt;0 &amp;&amp;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                      (</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                       (one-two).Mag()&lt;epsMag || <span class="comment">// too close</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                       ((one-two).Mag()&gt;8.0&amp;&amp;rePass==1) || <span class="comment">// too far</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                       <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(spacepointss[point]-&gt;XYZ()[2]-spacepointss[ppoint]-&gt;XYZ()[2])&lt;epsZ ||</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                       <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(spacepointss[point]-&gt;XYZ()[0]-spacepointss[ppoint]-&gt;XYZ()[0])&gt;epsX</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                       )</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                      )</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                      <span class="comment">//                      std::cout &lt;&lt; &quot;Spacepoint &quot; &lt;&lt; point &lt;&lt; &quot; DROPPED, cuz it&#39;s too far in x or too close in magnitude or z to previous used spacepoint!!!:&quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[0]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[1]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[point]-&gt;XYZ()[2]&lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                      <span class="comment">//                      std::cout &lt;&lt; &quot;Prev used Spacepoint &quot; &lt;&lt; spacepointss[ppoint]-&gt;XYZ()[0]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[ppoint]-&gt;XYZ()[1]&lt;&lt; &quot;, &quot; &lt;&lt; spacepointss[ppoint]-&gt;XYZ()[2]&lt;&lt; &quot;. &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                      spptSkippedIndex.push_back(point);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                  <span class="keywordflow">if</span> (point%fDecimateHere &amp;&amp; rePass&lt;=1) <span class="comment">// Jump out of loop except on every fDecimate^th pt. fDecimate==1 never sees continue.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                      <span class="comment">/* Replace continue with a counter that will be used</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">                         to index into vector of GFKalman fits.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">                      */</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                      <span class="comment">// spptSkippedIndex.push_back(point);</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                  ppoint=point;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                  TVector3 spt3 = (TVector3)(spacepointss[point]-&gt;XYZ());</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                  std::vector &lt;double&gt; err3;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                  err3.push_back(spacepointss[point]-&gt;ErrXYZ()[0]);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                  err3.push_back(spacepointss[point]-&gt;ErrXYZ()[2]);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                  err3.push_back(spacepointss[point]-&gt;ErrXYZ()[4]);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                  err3.push_back(spacepointss[point]-&gt;ErrXYZ()[5]); <span class="comment">// lower triangle diags.</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>&lt;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">fDimSize</a>)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                    {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = spt3[0];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = spt3[1];</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = spt3[2];</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">feshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = err3[0];</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">feshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = err3[1];</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">feshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = err3[3];</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">feshyz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = err3[2];</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">fsep</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = sep;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>&gt;1)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                          TVector3 pointer(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1]);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                          TVector3 pointerPrev(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">fshx</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-2],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">fshy</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-2],<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-1]-<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">fshz</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>-2]);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">fth</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = (pointer.Unit()).Angle(pointerPrev.Unit());</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a>[<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>] = 0.0;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                  MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ihit xyz...&quot;</span> &lt;&lt; spt3[0]&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt; spt3[1]&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt; spt3[2];</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                  fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a60a720ef52b34e7feab26bdc2999fd91">addHit</a>(<span class="keyword">new</span> <a class="code" href="../../de/dc5/classgenf_1_1PointHit.html">genf::PointHit</a>(spt3,err3),</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                  1,<span class="comment">//dummy detector id</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                  ihit++</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                  );</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                  spptSurvivedIndex.push_back(point);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                  <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>++;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                } <span class="comment">// end loop over spacepoints.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a>&lt;=<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a00b9d476e554b933cd468b853280fc5c">fMinNumSppts</a>) <span class="comment">// Cuz 1st 2 in each direction don&#39;t count. Should have, say, 3 more.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                  MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bailing cuz only &quot;</span> &lt;&lt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a> &lt;&lt; <span class="stringliteral">&quot; spacepoints.&quot;</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                  rePass++;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Fitting on &quot;</span> &lt;&lt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">fptsNo</a> &lt;&lt; <span class="stringliteral">&quot; spacepoints.&quot;</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;              <span class="comment">//      std::cout&lt;&lt;&quot;Track3DKalmanSPS about to do GFKalman.&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;              <a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html">genf::GFKalman</a> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a8aab3ab7f9dfd7f42f9068cc109854d1">setBlowUpFactor</a>(5); <span class="comment">// 500 out of box. EC, 6-Jan-2011.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a8f9f692bfb411c84f624b153d6acafca">setMomHigh</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">fMomHigh</a>); <span class="comment">// Don&#39;t fit above this many GeV.</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a7ad951aae27c39fe511696fabb90577b">setMomLow</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a870dfc519ed7673076f6972866c981e8">fMomLow</a>);   <span class="comment">// Don&#39;t fit below this many GeV.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#ab416c092144a1769a026d2da4efb9a5d">setInitialDirection</a>(+1); <span class="comment">// Instead of 1 out of box. EC, 6-Jan-2011.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#ad68ed30c7172d564ed83fd7e3d94cff3">setNumIterations</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a5fd291537eb1f74e044bf4f0f07d6fd8">setMaxUpdate</a>(fMaxUpdateHere); <span class="comment">// 0 out abs(update) bigger than this.</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a840ee9b09e94995b1ec90ce5924b64f9">setErrorScaleSTh</a>(fErrScaleSHere);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;              k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#ab66864c7a4b187ccc0268e7367262e3b">setErrorScaleMTh</a>(fErrScaleMHere);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;              <span class="keywordtype">bool</span> skipFill = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;              <span class="comment">//      std::cout&lt;&lt;&quot;Track3DKalmanSPS back from setNumIterations.&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;              std::vector &lt; TMatrixT&lt;double&gt; &gt; hitMeasCov;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;              std::vector &lt; TMatrixT&lt;double&gt; &gt; hitUpdate;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;              std::vector &lt; TMatrixT&lt;double&gt; &gt; hitCov;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;              std::vector &lt; TMatrixT&lt;double&gt; &gt; hitCov7x7;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;              std::vector &lt; TMatrixT&lt;double&gt; &gt; hitState;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;              std::vector &lt; double &gt;           hitChi2;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;              std::vector &lt;TVector3&gt; hitPlaneXYZ;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;              std::vector &lt;TVector3&gt; hitPlaneUxUyUz;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;              std::vector &lt;TVector3&gt; hitPlaneU;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;              std::vector &lt;TVector3&gt; hitPlaneV;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <span class="comment">//      std::cout&lt;&lt;&quot;Track3DKalmanSPS about to processTrack.&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73ca4e3ef1e3cfebc2e7ab8a2292faed">fDoFit</a>) k.<a class="code" href="../../de/d6e/classgenf_1_1GFKalman.html#a0e445ef81d61b70d44ad1862576e52c8">processTrack</a>(&amp;fitTrack);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;Track3DKalmanSPS back from processTrack.&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;              }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;              <span class="comment">//catch(GFException&amp; e){</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              <span class="keywordflow">catch</span>(cet::exception &amp;<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>){</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                MF_LOG_ERROR(<span class="stringliteral">&quot;Track3DKalmanSPS&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;just caught a cet::exception: &quot;</span> &lt;&lt; e.what()</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;\nExceptions won&#39;t be further handled; skip filling big chunks of the TTree.&quot;</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                skipFill = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                <span class="comment">//      exit(1);</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;              }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a7b1666e5827c41c1ba3170a3b7a8d083">getStatusFlag</a>()==0) <span class="comment">// 0 is successful completion</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                  <span class="keywordflow">if</span>(mf::isDebugEnabled()) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    std::ostringstream dbgmsg;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    dbgmsg &lt;&lt; <span class="stringliteral">&quot;Original plane:&quot;</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    planeG.<a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html#aa7cb1af01b4ed7b5dfec2ce5938caa33">Print</a>(dbgmsg);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    dbgmsg &lt;&lt; <span class="stringliteral">&quot;Current (fit) reference Plane:&quot;</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aa33f8c315f1a93e7ccab17826f1b7d9e">getReferencePlane</a>().<a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html#aa7cb1af01b4ed7b5dfec2ce5938caa33">Print</a>(dbgmsg);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    dbgmsg &lt;&lt; <span class="stringliteral">&quot;Last reference Plane:&quot;</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a70f54869958bc1b7945b85e15cc86053">getLastPlane</a>().<a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html#aa7cb1af01b4ed7b5dfec2ce5938caa33">Print</a>(dbgmsg);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                    <span class="keywordflow">if</span> (planeG != <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aa33f8c315f1a93e7ccab17826f1b7d9e">getReferencePlane</a>())</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                      dbgmsg &lt;&lt;<span class="stringliteral">&quot;  =&gt; original hit plane (not surprisingly) not current reference Plane!&quot;</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; dbgmsg.str();</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                  }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                  <span class="keywordflow">if</span> (!skipFill)</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                    {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                      hitMeasCov = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a588ca428995cab199a4774e30ac0c58f">getHitMeasuredCov</a>();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                      hitUpdate = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#ae966c9f264cd8611a816a7141501f839">getHitUpdate</a>();</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                      hitCov = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a389de1eda321adfa2af2f26a9c846561">getHitCov</a>();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                      hitCov7x7 = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#aa66dc9a5d6eac3df49afc048509240f6">getHitCov7x7</a>();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                      hitState = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a85f5a8565d122cdaf5b82cd6de23cbe8">getHitState</a>();</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                      hitChi2 = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#aeced5c5fba5694796b55c0dca5279d14">getHitChi2</a>();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                      hitPlaneXYZ = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a41e70ae63e95d375a844b6aadac9db61">getHitPlaneXYZ</a>();</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                      hitPlaneUxUyUz = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a33a5c903a4b6193163d1f7ceed3aac51">getHitPlaneUxUyUz</a>();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                      hitPlaneU = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#abf0f79cbebd150f860c339cdb7bd974d">getHitPlaneU</a>();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                      hitPlaneV = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a2e69a012684a936de399ed3dffbddf0d">getHitPlaneV</a>();</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totHits = hitState.size();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                      <span class="comment">//                  for (unsigned int ihit=0; ihit&lt;fptsNo; ihit++)</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                      <span class="comment">// Pick up info from last fwd Kalman pass.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jhit=0;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>); ihit&lt;(totHits-totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)); ihit++) <span class="comment">// was ihit&lt;ihit&lt;(totHits-fptsNo)&lt;7</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">feth</a>[jhit] = (Float_t ) (hitMeasCov.at(ihit)[0][0]); <span class="comment">// eth</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">fedudw</a>[jhit] = (Float_t ) (hitMeasCov.at(ihit)[1][1]);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">fedvdw</a>[jhit] = (Float_t ) (hitMeasCov.at(ihit)[2][2]);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">feu</a>[jhit] = (Float_t ) (hitMeasCov.at(ihit)[3][3]);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">fev</a>[jhit] = (Float_t ) (hitMeasCov.at(ihit)[4][4]);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">fupdate</a>[jhit] = (Float_t ) (hitUpdate.at(ihit)[0][0]);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>[jhit] = (Float_t ) (hitChi2.at(ihit));</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                          jhit++;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a>-&gt;ResizeTo(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">getState</a>());</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                      *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">getState</a>();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a>-&gt;ResizeTo(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">getCov</a>());</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                      *<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">getCov</a>();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                      <span class="keywordtype">double</span> dum[5];</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                      <span class="keywordtype">double</span> dum2[5];</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii=0;ii&lt;5;ii++)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a>-&gt;ExtractRow(ii,0,dum);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">fState0</a>[ii] = dum[0];</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a>-&gt;ExtractRow(ii,0,dum2);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj=0;jj&lt;5;jj++)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                            {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                              <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">fCov0</a>[ii*5+jj] = dum2[jj];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                            }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                        }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                      MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; First State and Cov:&quot;</span> &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">stREC</a>)</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        &lt;&lt; <a class="code" href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a>(*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">covREC</a>);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">chi2</a> = (Float_t)(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aab060cdfad37f9d1eae3a8cf34398cd9">getChiSqu</a>());</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">ndf</a> = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a55cecc8b75804f97f9474716d194de5f">getNDF</a>();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7a6e7a0b35efa067667ce90bf8c53e95">nfail</a> = fitTrack.<a class="code" href="../../d6/d69/classgenf_1_1GFTrack.html#a0a8c33a10a231e1990a00926240eca01">getFailedHits</a>();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a19abc2f92027fc0437caa8229c6605bf">nchi2rePass</a> = (int)rePass;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8efb2e23ee9af8c4d20146cb4b7126f0">ispptvec</a>=1+std::distance(spptB, sppt);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab72440c7624691a34d8199795c54fdf7">chi2ndf</a> = (Float_t)(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">chi2</a>/<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">ndf</a>);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">nTrks</a>++;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                      MF_LOG_DEBUG(<span class="stringliteral">&quot;Track3DKalmanSPS_GenFit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Track3DKalmanSPS about to do tree-&gt;Fill(). Chi2/ndf is &quot;</span> &lt;&lt; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">chi2</a>/<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">ndf</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">fpMCMom</a>[3] = MCMomentum.Mag();</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0;ii&lt;3;++ii)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                        {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">fpMCMom</a>[ii] = MCMomentum[ii];</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">fpMCPos</a>[ii] = MCOrigin[ii];</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>[ii]   = hitPlaneUxUyUz.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>))[ii];</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a>[ii]  = hitPlaneUxUyUz.at(totHits-totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)-1)[ii];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9dca5bc8c9313514589d2d5c6411a287">evtt</a> = (<span class="keywordtype">unsigned</span> int) evt.id().event();</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af4c54e6ad0bc1b6cefc51cca114d19f5">nspptvec</a> = (<span class="keywordtype">unsigned</span> int)  spptListHandle-&gt;size();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                      cntp++;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                      std::vector &lt; std::vector &lt;double&gt; &gt; dQdx;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                      <span class="comment">// Calculate LastFwdPass quantities.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                      std::vector &lt; TMatrixT&lt;double&gt; &gt; hitCovLFP;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                      std::vector &lt;TVector3&gt; hitPlaneXYZLFP;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                      std::vector &lt;TVector3&gt; hitPlaneUxUyUzLFP;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                      std::vector &lt;TVector3&gt; hitPlanePxPyPzLFP;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                      std::vector &lt;TVector3&gt; hitPlaneULFP;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                      std::vector &lt;TVector3&gt; hitPlaneVLFP;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                      std::vector &lt;double&gt; pLFP;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                      std::vector &lt; TMatrixT&lt;double&gt; &gt; c7x7LFP;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                      art::FindManyP&lt;recob::Hit&gt; hitAssns(spacepointss, evt, <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4814469790a4d733161f39b0cf26deea">fSpptModuleLabel</a>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii=0; ii&lt;totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>); ii++)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                          pLFP.push_back(1./hitState.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii)[0][0]);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                          <span class="comment">// hitCov -&gt; hitCov7x7 !! EC, 11-May-2012.</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                          c7x7LFP.push_back(hitCov7x7.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                          hitCovLFP.push_back(hitCov.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                          hitPlaneXYZLFP.push_back(hitPlaneXYZ.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                          hitPlaneUxUyUzLFP.push_back(hitPlaneUxUyUz.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                          hitPlanePxPyPzLFP.push_back(hitPlaneUxUyUzLFP.back()*pLFP.back());</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                          hitPlaneULFP.push_back(hitPlaneU.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                          hitPlaneVLFP.push_back(hitPlaneV.at(totHits-2*totHits/(2*<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">fNumIt</a>)+ii));</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                          <span class="comment">// Transform cov appropriate for track rotated</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                          <span class="comment">// about w, forcing</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                          <span class="comment">// v to be in y-z plane and u pointing in</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                          <span class="comment">// +-ive x direction, per TrackAna convention.</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad78bb6f946608b7f8eaccd384f501fd7">rotationCov</a>(hitCovLFP.back(),</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                      hitPlaneULFP.back(),</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                      hitPlaneVLFP.back()</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                      );</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                          dQdx.push_back(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3961ab423ca0e4a28a9a4006fc4a745c">dQdxCalc</a>(hitAssns,</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                                  spacepointss,</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                                  hitPlaneUxUyUzLFP.back(),</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                                  hitPlaneXYZLFP.back()</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                                  )</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                         );</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                          <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">fdQdx</a>[ii] = dQdx.back().back();</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>[3]  = <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a135f0bf1ae7e6067ef1aaa74bb011ceb">getMom</a>(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>-&gt;<a class="code" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aa33f8c315f1a93e7ccab17826f1b7d9e">getReferencePlane</a>()).Mag();</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">fpRECL</a>[3] = pLFP[1];</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">tree</a>-&gt;Fill();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                      <span class="comment">// Put newest track on stack for this set of sppts,</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                      <span class="comment">// remove previous one.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                      <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a> covVtx, covEnd;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;5; i++) {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i; j&lt;5; j++) {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                          covVtx(i,j) = hitCovLFP.front()(i,j);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                          covEnd(i,j) = hitCovLFP.back()(i,j);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                        }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                      }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                      <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>  the3DTrack(<a class="code" href="../../de/de5/classrecob_1_1TrackTrajectory.html">recob::TrackTrajectory</a>(<a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a2253bf96e69f939f133551c86bdd2e37">recob::tracking::convertCollToPoint</a>(hitPlaneXYZLFP),</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                                                      <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a159ae849126aae38dcc0675e448c0727">recob::tracking::convertCollToVector</a>(hitPlanePxPyPzLFP),</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                                                      <a class="code" href="../../d9/dca/classrecob_1_1Track.html#a79f1b57342d70962685e749753d76ad1">recob::Track::Flags_t</a>(hitPlaneXYZLFP.size()), <span class="keyword">true</span>),</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                               0, -1., 0, covVtx, covEnd, tcnt++);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                      <span class="keywordflow">if</span> (rePass==1) tcnt1++; <span class="comment">// won&#39;t get here if Trackfit failed.</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                      <span class="keywordflow">if</span> (rePass!=1 &amp;&amp; tcnt1) tcol-&gt;pop_back();</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                      tcol-&gt;push_back(the3DTrack);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                      <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(*<span class="keyword">this</span>, evt, *tcol, spacepointss, *tspassn);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                      art::PtrVector&lt;recob::Hit&gt; hits;<span class="comment">// = hitAssns;</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii=0; ii &lt; spacepointss.size(); ++ii)</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                        {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                          <span class="comment">//                      for (unsigned int jj=0; jj &lt; hitAssns.at(ii).size(); ++jj)</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                            <span class="comment">//                      hits.push_back(hitAssns.at(ii).at(jj));</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                          hits.insert(hits.end(),hitAssns.at(ii).begin(),hitAssns.at(ii).end());</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                        }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                      <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(*<span class="keyword">this</span>, evt, *tcol, hits, *thassn, tcol-&gt;size()-1);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                    } <span class="comment">// end !skipFill</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                } <span class="comment">// getStatusFlag</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>) <span class="keyword">delete</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">rep</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;              rePass++;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;              <span class="comment">// need to first excise bad spacepoints.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;              <span class="comment">// Grab up large Chi2hits first.</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;              art::PtrVector&lt;recob::SpacePoint&gt; spacepointssExcise;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ind=0;ind&lt;spptSurvivedIndex.size();++ind)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                  <span class="comment">// Stricter to chuck sppts from uncontained then contained trks.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                  <span class="keywordflow">if</span> ((uncontained&amp;&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>[ind] &gt;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4616317bdd8aa4259547658854b05129">fChi2Thresh</a>)     ||</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                      (!uncontained&amp;&amp;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>[ind]&gt;1.e9) ||</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                      <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">fchi2hit</a>[ind]&lt;0.0</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                      <span class="comment">// =0 eliminates ruled-out large updates. Not obviously</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                      <span class="comment">// helpful.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                      <span class="comment">// add a restriction on dQdx here ...</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                      )</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                      art::PtrVector&lt;recob::SpacePoint&gt;::iterator spptIt = spacepointss.begin()+spptSurvivedIndex[ind];</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                      spacepointssExcise.push_back(*spptIt);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;              <span class="comment">// Now grab up those sppts which we skipped and don&#39;t want</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;              <span class="comment">// to reconsider cuz they&#39;re too close to each other or</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;              <span class="comment">// cuz they&#39;re too far in x, e.g.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ind=0;ind&lt;spptSkippedIndex.size();++ind)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                  art::PtrVector&lt;recob::SpacePoint&gt;::iterator spptIt = spacepointss.begin()+spptSkippedIndex[ind];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                  spacepointssExcise.push_back(*spptIt);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;              <span class="comment">// Get rid of redundantly Excised sppts before proceeding.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;              std::stable_sort(spacepointss.begin(),spacepointss.end());</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;              std::stable_sort(spacepointssExcise.begin(),spacepointssExcise.end());</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;              std::set_union(spacepointssExcise.begin(),spacepointssExcise.end(),</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                             spacepointssExcise.begin(),spacepointssExcise.end(),</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                             spacepointssExcise.begin()</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                             );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;              <span class="comment">// Now excise. New spacepointss will be smaller for second pass.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;              art::PtrVector&lt;recob::SpacePoint&gt;::iterator diffSpptIt =</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;              std::set_difference(spacepointss.begin(),spacepointss.end(),</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                  spacepointssExcise.begin(),spacepointssExcise.end(),</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                  spacepointss.begin()</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                  );</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;              spacepointss.erase(diffSpptIt,spacepointss.end());</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;              <span class="comment">// calculate new seed momentum, and errors as merited</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;              <span class="keywordflow">if</span> (rePass==2<span class="comment">/* &amp;&amp; uncontained */</span>)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>[3]&lt;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">fMomHigh</a> &amp;&amp; <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>[3]&gt;<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a870dfc519ed7673076f6972866c981e8">fMomLow</a>)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                      <span class="keywordtype">double</span> kick(0.9); <span class="comment">//Try to get away with a smaller start</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                      <span class="comment">// for contained tracks. While for uncontained tracks</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                      <span class="comment">// let&#39;s start up at a higher momentum and come down.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                      <span class="comment">// Though, 2 (1) GeV/c tracks are too low (high), so</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                      <span class="comment">// instead let&#39;s actually lower starting value on</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                      <span class="comment">// this second pass. -- EC 7-Mar-2013</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                      <span class="keywordflow">if</span>  (uncontained) kick = 0.5;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0;ii&lt;3;++ii)</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                        {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                          <span class="comment">//mom[ii] = fpREC[ii]*fpREC[3]*kick;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                          mom[ii] = momM[ii]*kick;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uncontained)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                    {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                      <span class="keywordtype">double</span> unstick(1.0);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                      <span class="keywordflow">if</span>  (<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">fpREC</a>[3]&gt;=<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">fMomHigh</a>) unstick = 0.3;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0;ii&lt;3;++ii)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                        {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                          mom[ii] = momM[ii]*unstick;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                        }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0;ii&lt;3;++ii)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                        {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                          mom[ii] = 1.1*momM[ii];</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                        }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            } <span class="comment">// end while rePass&lt;=maxPass</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          sppt++;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        } <span class="comment">// end while on elements of std::vector of art::PtrVectors of SpPts.</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>) <span class="keyword">delete</span> <a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">repMC</a>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      evt.put(std::move(tcol));</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="comment">// and now the spacepoints</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      evt.put(std::move(tspassn));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">// and the hits. Note that these are all the hits from all the spacepoints considered,</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="comment">// even though they&#39;re not all contributing to the tracks.</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      evt.put(std::move(thassn));</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  DEFINE_ART_MODULE(<a class="code" href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html">Track3DKalmanSPS</a>)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}  <span class="comment">// end namespace</span></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_addf335fb1ac84fb831e6558085945d13"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#addf335fb1ac84fb831e6558085945d13">trkf::Track3DKalmanSPS::stREC</a></div><div class="ttdeci">TMatrixT&lt; Double_t &gt; * stREC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00118">Track3DKalmanSPS_module.cc:118</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_a55cecc8b75804f97f9474716d194de5f"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a55cecc8b75804f97f9474716d194de5f">genf::GFAbsTrackRep::getNDF</a></div><div class="ttdeci">unsigned int getNDF() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00251">GFAbsTrackRep.h:251</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a8a4fc6d93c9da50c1c462529e48788b1"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8a4fc6d93c9da50c1c462529e48788b1">trkf::Track3DKalmanSPS::fMomErr</a></div><div class="ttdeci">std::vector&lt; double &gt; fMomErr</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00164">Track3DKalmanSPS_module.cc:164</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a7ad951aae27c39fe511696fabb90577b"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a7ad951aae27c39fe511696fabb90577b">genf::GFKalman::setMomLow</a></div><div class="ttdeci">void setMomLow(Double_t f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00115">GFKalman.h:115</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_afa86b6db7a2cf5e3a3382dad99632e32"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#afa86b6db7a2cf5e3a3382dad99632e32">trkf::Track3DKalmanSPS::fDecimate</a></div><div class="ttdeci">int fDecimate</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00172">Track3DKalmanSPS_module.cc:172</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a73f028ed81f1273e190f4151ea0a257c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73f028ed81f1273e190f4151ea0a257c">trkf::Track3DKalmanSPS::tree</a></div><div class="ttdeci">TTree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00114">Track3DKalmanSPS_module.cc:114</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a8e8639fba03cc7fb71ddac2b0d069a2d"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8e8639fba03cc7fb71ddac2b0d069a2d">trkf::Track3DKalmanSPS::fedvdw</a></div><div class="ttdeci">Float_t * fedvdw</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00150">Track3DKalmanSPS_module.cc:150</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aa264e64e0c34ac9ed8383a5cca8096f5"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa264e64e0c34ac9ed8383a5cca8096f5">trkf::Track3DKalmanSPS::fshy</a></div><div class="ttdeci">Float_t * fshy</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00139">Track3DKalmanSPS_module.cc:139</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a33a5c903a4b6193163d1f7ceed3aac51"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a33a5c903a4b6193163d1f7ceed3aac51">genf::GFTrack::getHitPlaneUxUyUz</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; getHitPlaneUxUyUz()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00369">GFTrack.h:369</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ad4009cd5cb3a4c77fdef5fca59f94b4a"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad4009cd5cb3a4c77fdef5fca59f94b4a">trkf::Track3DKalmanSPS::fcont</a></div><div class="ttdeci">int fcont</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00122">Track3DKalmanSPS_module.cc:122</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a5fd291537eb1f74e044bf4f0f07d6fd8"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a5fd291537eb1f74e044bf4f0f07d6fd8">genf::GFKalman::setMaxUpdate</a></div><div class="ttdeci">void setMaxUpdate(Double_t f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00117">GFKalman.h:117</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a9b786f6ea1e4007e50f437d6e44bdf61"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9b786f6ea1e4007e50f437d6e44bdf61">trkf::Track3DKalmanSPS::feshx</a></div><div class="ttdeci">Float_t * feshx</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00141">Track3DKalmanSPS_module.cc:141</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_ae966c9f264cd8611a816a7141501f839"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#ae966c9f264cd8611a816a7141501f839">genf::GFTrack::getHitUpdate</a></div><div class="ttdeci">std::vector&lt; TMatrixT&lt; Double_t &gt; &gt; getHitUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00363">GFTrack.h:363</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a19a017039c62b9be286cd55944686ec4"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a19a017039c62b9be286cd55944686ec4">recob::Hit::SignalType</a></div><div class="ttdeci">geo::SigType_t SignalType() const </div><div class="ttdoc">Signal type for the plane of the hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00231">Hit.h:231</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a8d2b9957b95582f1d88723eae28e413d"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8d2b9957b95582f1d88723eae28e413d">trkf::Track3DKalmanSPS::stMCT</a></div><div class="ttdeci">TMatrixT&lt; Double_t &gt; * stMCT</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00116">Track3DKalmanSPS_module.cc:116</a></div></div>
<div class="ttc" id="Track3DKalmanSPS__module_8cc_html_ae807a928af6da3ddaece0d3d3cf8139f"><div class="ttname"><a href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#ae807a928af6da3ddaece0d3d3cf8139f">sp_sort_3dz</a></div><div class="ttdeci">static bool sp_sort_3dz(const art::Ptr&lt; recob::SpacePoint &gt; &amp;h1, const art::Ptr&lt; recob::SpacePoint &gt; &amp;h2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00063">Track3DKalmanSPS_module.cc:63</a></div></div>
<div class="ttc" id="classgenf_1_1GFConstField_html"><div class="ttname"><a href="../../d5/dfa/classgenf_1_1GFConstField.html">genf::GFConstField</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dec/GFConstField_8h_source.html#l00037">GFConstField.h:37</a></div></div>
<div class="ttc" id="GFKalman_8h_html"><div class="ttname"><a href="../../da/dfe/GFKalman_8h.html">GFKalman.h</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a3290d686880f8d5a0ca01cab32cd97c9"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3290d686880f8d5a0ca01cab32cd97c9">trkf::Track3DKalmanSPS::fDistanceU</a></div><div class="ttdeci">double fDistanceU</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00175">Track3DKalmanSPS_module.cc:175</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_aa33f8c315f1a93e7ccab17826f1b7d9e"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aa33f8c315f1a93e7ccab17826f1b7d9e">genf::GFAbsTrackRep::getReferencePlane</a></div><div class="ttdeci">const GFDetPlane &amp; getReferencePlane() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00283">GFAbsTrackRep.h:283</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a1094a2f95d50b93f94b8d4224157965b"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1094a2f95d50b93f94b8d4224157965b">trkf::Track3DKalmanSPS::fG4ModuleLabel</a></div><div class="ttdeci">std::string fG4ModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00110">Track3DKalmanSPS_module.cc:110</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html">genf::GFTrack</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00064">GFTrack.h:64</a></div></div>
<div class="ttc" id="classgenf_1_1PointHit_html"><div class="ttname"><a href="../../de/dc5/classgenf_1_1PointHit.html">genf::PointHit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dea/PointHit_8h_source.html#l00014">PointHit.h:14</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_a70f54869958bc1b7945b85e15cc86053"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a70f54869958bc1b7945b85e15cc86053">genf::GFAbsTrackRep::getLastPlane</a></div><div class="ttdeci">GFDetPlane getLastPlane() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00240">GFAbsTrackRep.h:240</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ad78bb6f946608b7f8eaccd384f501fd7"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad78bb6f946608b7f8eaccd384f501fd7">trkf::Track3DKalmanSPS::rotationCov</a></div><div class="ttdeci">void rotationCov(TMatrixT&lt; Double_t &gt; &amp;cov, const TVector3 &amp;u, const TVector3 &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00292">Track3DKalmanSPS_module.cc:292</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a85f5a8565d122cdaf5b82cd6de23cbe8"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a85f5a8565d122cdaf5b82cd6de23cbe8">genf::GFTrack::getHitState</a></div><div class="ttdeci">std::vector&lt; TMatrixT&lt; Double_t &gt; &gt; getHitState()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00365">GFTrack.h:365</a></div></div>
<div class="ttc" id="GFTrack_8h_html"><div class="ttname"><a href="../../d7/d5e/GFTrack_8h.html">GFTrack.h</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_aedd77b5ebb70d48a9b4673b8efcbc32e"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a></div><div class="ttdeci">ROOT::Math::SMatrix&lt; Double32_t, 5, 5, ROOT::Math::MatRepSym&lt; Double32_t, 5 &gt; &gt; SMatrixSym55</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00085">TrackingTypes.h:85</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_a159ae849126aae38dcc0675e448c0727"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#a159ae849126aae38dcc0675e448c0727">recob::tracking::convertCollToVector</a></div><div class="ttdeci">std::vector&lt; Vector_t &gt; convertCollToVector(std::vector&lt; Vector &gt; const &amp;coll)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00058">TrackingTypes.h:58</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a9dca5bc8c9313514589d2d5c6411a287"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9dca5bc8c9313514589d2d5c6411a287">trkf::Track3DKalmanSPS::evtt</a></div><div class="ttdeci">unsigned int evtt</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00135">Track3DKalmanSPS_module.cc:135</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a23ae0a8f813a4932b19b1c3af3103d3a"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a23ae0a8f813a4932b19b1c3af3103d3a">trkf::Track3DKalmanSPS::fPC1</a></div><div class="ttdeci">Float_t * fPC1</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00159">Track3DKalmanSPS_module.cc:159</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ab868a7702863cf60a28d80e845f775bc"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab868a7702863cf60a28d80e845f775bc">trkf::Track3DKalmanSPS::fPC3</a></div><div class="ttdeci">Float_t * fPC3</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00161">Track3DKalmanSPS_module.cc:161</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aa72479279d60b326f69f91ba52bd14fa"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa72479279d60b326f69f91ba52bd14fa">trkf::Track3DKalmanSPS::fErrScaleS</a></div><div class="ttdeci">double fErrScaleS</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00170">Track3DKalmanSPS_module.cc:170</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a29b7539641ce59c5bb0e0be6431f1e02"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a29b7539641ce59c5bb0e0be6431f1e02">trkf::Track3DKalmanSPS::fPCevals</a></div><div class="ttdeci">Float_t * fPCevals</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00157">Track3DKalmanSPS_module.cc:157</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a07ced3d8d3977afdfc0a5aff2e83c23d"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a07ced3d8d3977afdfc0a5aff2e83c23d">trkf::Track3DKalmanSPS::rep</a></div><div class="ttdeci">genf::GFAbsTrackRep * rep</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00184">Track3DKalmanSPS_module.cc:184</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aefaf06a0a7796d9bf32d31a42472aa0e"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aefaf06a0a7796d9bf32d31a42472aa0e">trkf::Track3DKalmanSPS::fMaxUpdateU</a></div><div class="ttdeci">double fMaxUpdateU</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00176">Track3DKalmanSPS_module.cc:176</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a243ac7ae980b6c385728a888dd76fae1"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a243ac7ae980b6c385728a888dd76fae1">trkf::Track3DKalmanSPS::fPCmeans</a></div><div class="ttdeci">Float_t * fPCmeans</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00156">Track3DKalmanSPS_module.cc:156</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a8f9f692bfb411c84f624b153d6acafca"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a8f9f692bfb411c84f624b153d6acafca">genf::GFKalman::setMomHigh</a></div><div class="ttdeci">void setMomHigh(Double_t f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00116">GFKalman.h:116</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a79f1b57342d70962685e749753d76ad1"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a79f1b57342d70962685e749753d76ad1">recob::Track::Flags_t</a></div><div class="ttdeci">TrackTrajectory::Flags_t Flags_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00068">bj/lardataobj/RecoBase/Track.h:68</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a73ca4e3ef1e3cfebc2e7ab8a2292faed"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a73ca4e3ef1e3cfebc2e7ab8a2292faed">trkf::Track3DKalmanSPS::fDoFit</a></div><div class="ttdeci">bool fDoFit</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00167">Track3DKalmanSPS_module.cc:167</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a528dc4a0cd42bb2becffbf84b9c0dfc2"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a528dc4a0cd42bb2becffbf84b9c0dfc2">trkf::Track3DKalmanSPS::fGenieGenModuleLabel</a></div><div class="ttdeci">std::string fGenieGenModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00109">Track3DKalmanSPS_module.cc:109</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a4616317bdd8aa4259547658854b05129"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4616317bdd8aa4259547658854b05129">trkf::Track3DKalmanSPS::fChi2Thresh</a></div><div class="ttdeci">double fChi2Thresh</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00180">Track3DKalmanSPS_module.cc:180</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a5878f99277288349a5be8c2b77c5fe09"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5878f99277288349a5be8c2b77c5fe09">trkf::Track3DKalmanSPS::fNumIt</a></div><div class="ttdeci">int fNumIt</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00168">Track3DKalmanSPS_module.cc:168</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a98fe3ce584899b6f824260d8b4153bd8"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">recob::Hit::Integral</a></div><div class="ttdeci">float Integral() const </div><div class="ttdoc">Integral under the calibrated signal waveform of the hit, in tick x ADC units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00224">Hit.h:224</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a64fc6b55efd589d72bb8fc867f1b7bed"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a64fc6b55efd589d72bb8fc867f1b7bed">trkf::Track3DKalmanSPS::fPosErr</a></div><div class="ttdeci">std::vector&lt; double &gt; fPosErr</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00163">Track3DKalmanSPS_module.cc:163</a></div></div>
<div class="ttc" id="classgenf_1_1GFDetPlane_html_aa7cb1af01b4ed7b5dfec2ce5938caa33"><div class="ttname"><a href="../../d3/db4/classgenf_1_1GFDetPlane.html#aa7cb1af01b4ed7b5dfec2ce5938caa33">genf::GFDetPlane::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;out=std::cout) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d42/GFDetPlane_8cxx_source.html#l00247">GFDetPlane.cxx:247</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_a93fb589fc99dbf86da2fb7764f46716c"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a93fb589fc99dbf86da2fb7764f46716c">genf::GFAbsTrackRep::getState</a></div><div class="ttdeci">const TMatrixT&lt; Double_t &gt; &amp; getState() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00196">GFAbsTrackRep.h:196</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a41e70ae63e95d375a844b6aadac9db61"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a41e70ae63e95d375a844b6aadac9db61">genf::GFTrack::getHitPlaneXYZ</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; getHitPlaneXYZ()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00368">GFTrack.h:368</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a389de1eda321adfa2af2f26a9c846561"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a389de1eda321adfa2af2f26a9c846561">genf::GFTrack::getHitCov</a></div><div class="ttdeci">std::vector&lt; TMatrixT&lt; Double_t &gt; &gt; getHitCov()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00366">GFTrack.h:366</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a4814469790a4d733161f39b0cf26deea"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a4814469790a4d733161f39b0cf26deea">trkf::Track3DKalmanSPS::fSpptModuleLabel</a></div><div class="ttdeci">std::string fSpptModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00108">Track3DKalmanSPS_module.cc:108</a></div></div>
<div class="ttc" id="Track3DKalmanSPS__module_8cc_html_a7032263c9a4b40e04508141cab74f889"><div class="ttname"><a href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a7032263c9a4b40e04508141cab74f889">sp_sort_3dy</a></div><div class="ttdeci">static bool sp_sort_3dy(const art::Ptr&lt; recob::SpacePoint &gt; &amp;h1, const art::Ptr&lt; recob::SpacePoint &gt; &amp;h2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00069">Track3DKalmanSPS_module.cc:69</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ac1ea004ddc8d0f844002c184cf30a9cd"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac1ea004ddc8d0f844002c184cf30a9cd">trkf::Track3DKalmanSPS::fpRECL</a></div><div class="ttdeci">Float_t * fpRECL</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00124">Track3DKalmanSPS_module.cc:124</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a2110a60a25052899732d5148da99ac5c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2110a60a25052899732d5148da99ac5c">trkf::Track3DKalmanSPS::fClusterModuleLabel</a></div><div class="ttdeci">std::string fClusterModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00107">Track3DKalmanSPS_module.cc:107</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a5506e5aeb47f53b533e0a472968e6b9c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5506e5aeb47f53b533e0a472968e6b9c">trkf::Track3DKalmanSPS::produce</a></div><div class="ttdeci">void produce(art::Event &amp;evt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00553">Track3DKalmanSPS_module.cc:553</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a1562b1f707ad3d1534ad7a4eae907c7f"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a1562b1f707ad3d1534ad7a4eae907c7f">trkf::Track3DKalmanSPS::fPC2</a></div><div class="ttdeci">Float_t * fPC2</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00160">Track3DKalmanSPS_module.cc:160</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ac435fa7ebbddc0d1a55dda29c9365fda"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ac435fa7ebbddc0d1a55dda29c9365fda">trkf::Track3DKalmanSPS::feshy</a></div><div class="ttdeci">Float_t * feshy</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00142">Track3DKalmanSPS_module.cc:142</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a047ed98dd5528af4f912c227b3008809"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a047ed98dd5528af4f912c227b3008809">trkf::Track3DKalmanSPS::fev</a></div><div class="ttdeci">Float_t * fev</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00152">Track3DKalmanSPS_module.cc:152</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html">genf::GFAbsTrackRep</a></div><div class="ttdoc">Base Class for genfit track representations. Defines interface for track parameterizations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00083">GFAbsTrackRep.h:83</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a9c87354d2ffccbdfe08716aec50f333c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a9c87354d2ffccbdfe08716aec50f333c">trkf::Track3DKalmanSPS::fshx</a></div><div class="ttdeci">Float_t * fshx</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00138">Track3DKalmanSPS_module.cc:138</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aaf1744b2e3ccffcc81ac252b25f511d0"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aaf1744b2e3ccffcc81ac252b25f511d0">trkf::Track3DKalmanSPS::fth</a></div><div class="ttdeci">Float_t * fth</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00147">Track3DKalmanSPS_module.cc:147</a></div></div>
<div class="ttc" id="getStatistics_8sh_html_a04d4c2131ccb24cc78386597e8a21c5b"><div class="ttname"><a href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a></div><div class="ttdeci">while getopts h</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/getStatistics_8sh_source.html#l00013">getStatistics.sh:13</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a870dfc519ed7673076f6972866c981e8"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a870dfc519ed7673076f6972866c981e8">trkf::Track3DKalmanSPS::fMomLow</a></div><div class="ttdeci">double fMomLow</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00177">Track3DKalmanSPS_module.cc:177</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_af0a319af20f43790eeff622ee1a99ec7"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af0a319af20f43790eeff622ee1a99ec7">trkf::Track3DKalmanSPS::fMaxUpdate</a></div><div class="ttdeci">double fMaxUpdate</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00173">Track3DKalmanSPS_module.cc:173</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_abd93297c92778400965b653db3d2a8ec"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abd93297c92778400965b653db3d2a8ec">trkf::Track3DKalmanSPS::fchi2hit</a></div><div class="ttdeci">Float_t * fchi2hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00146">Track3DKalmanSPS_module.cc:146</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_abe10585bf850cb83ce7a2677ccbdf80e"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#abe10585bf850cb83ce7a2677ccbdf80e">trkf::Track3DKalmanSPS::fPCsigmas</a></div><div class="ttdeci">Float_t * fPCsigmas</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00158">Track3DKalmanSPS_module.cc:158</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html">genf::GFKalman</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00053">GFKalman.h:53</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aff31faea068a27cc2719db251554d3bd"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aff31faea068a27cc2719db251554d3bd">trkf::Track3DKalmanSPS::fpMCMom</a></div><div class="ttdeci">Float_t * fpMCMom</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00126">Track3DKalmanSPS_module.cc:126</a></div></div>
<div class="ttc" id="classgenf_1_1RKTrackRep_html"><div class="ttname"><a href="../../dc/d1d/classgenf_1_1RKTrackRep.html">genf::RKTrackRep</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc4/RKTrackRep_8h_source.html#l00053">RKTrackRep.h:53</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a908e490d06692ec759aa14b614c1e685"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a908e490d06692ec759aa14b614c1e685">trkf::Track3DKalmanSPS::fPdg</a></div><div class="ttdeci">int fPdg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00179">Track3DKalmanSPS_module.cc:179</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a52004fd16a63407d503e33fa855746ab"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a52004fd16a63407d503e33fa855746ab">trkf::Track3DKalmanSPS::fMomStart</a></div><div class="ttdeci">std::vector&lt; double &gt; fMomStart</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00165">Track3DKalmanSPS_module.cc:165</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_af4c54e6ad0bc1b6cefc51cca114d19f5"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af4c54e6ad0bc1b6cefc51cca114d19f5">trkf::Track3DKalmanSPS::nspptvec</a></div><div class="ttdeci">int nspptvec</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00134">Track3DKalmanSPS_module.cc:134</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a2e69a012684a936de399ed3dffbddf0d"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a2e69a012684a936de399ed3dffbddf0d">genf::GFTrack::getHitPlaneV</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; getHitPlaneV()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00371">GFTrack.h:371</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ad62eae8b94c544b8a6c16dee7809bf86"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad62eae8b94c544b8a6c16dee7809bf86">trkf::Track3DKalmanSPS::chi2</a></div><div class="ttdeci">Float_t chi2</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00120">Track3DKalmanSPS_module.cc:120</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_a135f0bf1ae7e6067ef1aaa74bb011ceb"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a135f0bf1ae7e6067ef1aaa74bb011ceb">genf::GFAbsTrackRep::getMom</a></div><div class="ttdeci">virtual TVector3 getMom(const GFDetPlane &amp;pl)=0</div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_aeced5c5fba5694796b55c0dca5279d14"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#aeced5c5fba5694796b55c0dca5279d14">genf::GFTrack::getHitChi2</a></div><div class="ttdeci">std::vector&lt; Double_t &gt; getHitChi2()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00364">GFTrack.h:364</a></div></div>
<div class="ttc" id="Track3DKalmanSPS__module_8cc_html_a4c97875920f5de204382b4d0b1ccf203"><div class="ttname"><a href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a4c97875920f5de204382b4d0b1ccf203">sp_sort_3dx</a></div><div class="ttdeci">static bool sp_sort_3dx(const art::Ptr&lt; recob::SpacePoint &gt; &amp;h1, const art::Ptr&lt; recob::SpacePoint &gt; &amp;h2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00075">Track3DKalmanSPS_module.cc:75</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a54e4ff86282e10afe29ab925cc6790c6"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a54e4ff86282e10afe29ab925cc6790c6">trkf::Track3DKalmanSPS::fedudw</a></div><div class="ttdeci">Float_t * fedudw</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00149">Track3DKalmanSPS_module.cc:149</a></div></div>
<div class="ttc" id="classrecob_1_1TrackTrajectory_html"><div class="ttname"><a href="../../de/de5/classrecob_1_1TrackTrajectory.html">recob::TrackTrajectory</a></div><div class="ttdoc">A trajectory in space reconstructed from hits. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/TrackTrajectory_8h_source.html#l00062">TrackTrajectory.h:62</a></div></div>
<div class="ttc" id="namespacegeo_html_a59a0688ea6aaa04f0ffa6451f8083ca1"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a></div><div class="ttdeci">enum geo::_plane_sigtype SigType_t</div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a8aab3ab7f9dfd7f42f9068cc109854d1"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a8aab3ab7f9dfd7f42f9068cc109854d1">genf::GFKalman::setBlowUpFactor</a></div><div class="ttdeci">void setBlowUpFactor(double f)</div><div class="ttdoc">Set the blowup factor (see blowUpCovs() ) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00114">GFKalman.h:114</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a5f1623c6d7f2dd3ca235f800469727d3"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5f1623c6d7f2dd3ca235f800469727d3">trkf::Track3DKalmanSPS::nTrks</a></div><div class="ttdeci">unsigned int nTrks</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00136">Track3DKalmanSPS_module.cc:136</a></div></div>
<div class="ttc" id="GFAbsTrackRep_8h_html"><div class="ttname"><a href="../../d5/da1/GFAbsTrackRep_8h.html">GFAbsTrackRep.h</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ab72440c7624691a34d8199795c54fdf7"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab72440c7624691a34d8199795c54fdf7">trkf::Track3DKalmanSPS::chi2ndf</a></div><div class="ttdeci">Float_t chi2ndf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00121">Track3DKalmanSPS_module.cc:121</a></div></div>
<div class="ttc" id="namespacedetsim_html_ac17a92de25bbd84bdd320811fff947c6"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">detsim::MF_LOG_WARNING</a></div><div class="ttdeci">MF_LOG_WARNING(&quot;SimWire&quot;)&lt;&lt; &quot;SimWire is an example module that works for the &quot;&lt;&lt; &quot;MicroBooNE detector. Each experiment should implement &quot;&lt;&lt; &quot;its own version of this module to simulate electronics &quot;&lt;&lt; &quot;response.&quot;</div></div>
<div class="ttc" id="Track3DKalmanSPS__module_8cc_html_a3a89dfb7215ac4a87edff409a572c319"><div class="ttname"><a href="../../d8/d82/Track3DKalmanSPS__module_8cc.html#a3a89dfb7215ac4a87edff409a572c319">sp_sort_nsppts</a></div><div class="ttdeci">static bool sp_sort_nsppts(const art::PtrVector&lt; recob::SpacePoint &gt; &amp;h1, const art::PtrVector&lt; recob::SpacePoint &gt; &amp;h2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00082">Track3DKalmanSPS_module.cc:82</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a7e83a16d9bff674bf0bcabfaf932e846"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7e83a16d9bff674bf0bcabfaf932e846">trkf::Track3DKalmanSPS::endJob</a></div><div class="ttdeci">void endJob()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00506">Track3DKalmanSPS_module.cc:506</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a8ef4012255e13d74ebe8e5a3bc542b10"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8ef4012255e13d74ebe8e5a3bc542b10">trkf::Track3DKalmanSPS::fsep</a></div><div class="ttdeci">Float_t * fsep</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00153">Track3DKalmanSPS_module.cc:153</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a7702666bf7dc64083957821882f1310b"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7702666bf7dc64083957821882f1310b">trkf::Track3DKalmanSPS::energyLossBetheBloch</a></div><div class="ttdeci">double energyLossBetheBloch(const double &amp;mass, const double p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00260">Track3DKalmanSPS_module.cc:260</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a543387594bfb1aeb2290d7e7d68895dd"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a543387594bfb1aeb2290d7e7d68895dd">trkf::Track3DKalmanSPS::fptsNo</a></div><div class="ttdeci">unsigned int fptsNo</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00137">Track3DKalmanSPS_module.cc:137</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_ad68ed30c7172d564ed83fd7e3d94cff3"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#ad68ed30c7172d564ed83fd7e3d94cff3">genf::GFKalman::setNumIterations</a></div><div class="ttdeci">void setNumIterations(Int_t i)</div><div class="ttdoc">Set number of iterations for Kalman Filter. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00089">GFKalman.h:89</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a5404a2d9ea2e02fcc4a1e229aa58a78f"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a5404a2d9ea2e02fcc4a1e229aa58a78f">genf::GFTrack::setPDG</a></div><div class="ttdeci">void setPDG(int pdgt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00361">GFTrack.h:361</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a7a6e7a0b35efa067667ce90bf8c53e95"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a7a6e7a0b35efa067667ce90bf8c53e95">trkf::Track3DKalmanSPS::nfail</a></div><div class="ttdeci">int nfail</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00130">Track3DKalmanSPS_module.cc:130</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a00b9d476e554b933cd468b853280fc5c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a00b9d476e554b933cd468b853280fc5c">trkf::Track3DKalmanSPS::fMinNumSppts</a></div><div class="ttdeci">uint16_t fMinNumSppts</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00169">Track3DKalmanSPS_module.cc:169</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a0a8c33a10a231e1990a00926240eca01"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a0a8c33a10a231e1990a00926240eca01">genf::GFTrack::getFailedHits</a></div><div class="ttdeci">int getFailedHits(int repId=-1)</div><div class="ttdoc">return the number of failed Hits in track fit repId == -1 will use cardinal rep </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00149">GFTrack.h:149</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ad3735773b2f28c8410e5b415dc3ca135"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad3735773b2f28c8410e5b415dc3ca135">trkf::Track3DKalmanSPS::covREC</a></div><div class="ttdeci">TMatrixT&lt; Double_t &gt; * covREC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00119">Track3DKalmanSPS_module.cc:119</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a0e445ef81d61b70d44ad1862576e52c8"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a0e445ef81d61b70d44ad1862576e52c8">genf::GFKalman::processTrack</a></div><div class="ttdeci">void processTrack(GFTrack *)</div><div class="ttdoc">Performs fit on a GFTrack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/GFKalman_8cxx_source.html#l00046">GFKalman.cxx:46</a></div></div>
<div class="ttc" id="classgenf_1_1GFDetPlane_html"><div class="ttname"><a href="../../d3/db4/classgenf_1_1GFDetPlane.html">genf::GFDetPlane</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d65/GFDetPlane_8h_source.html#l00065">GFDetPlane.h:65</a></div></div>
<div class="ttc" id="classgenf_1_1GFFieldManager_html_a32fc17b84bd4a87376103389c92f9229"><div class="ttname"><a href="../../dd/d50/classgenf_1_1GFFieldManager.html#a32fc17b84bd4a87376103389c92f9229">genf::GFFieldManager::getInstance</a></div><div class="ttdeci">static GFFieldManager * getInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db9/GFFieldManager_8h_source.html#l00070">GFFieldManager.h:70</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a595e017dfe2b0ea37f7024de80143047"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a595e017dfe2b0ea37f7024de80143047">trkf::Track3DKalmanSPS::covMCT</a></div><div class="ttdeci">TMatrixT&lt; Double_t &gt; * covMCT</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00117">Track3DKalmanSPS_module.cc:117</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_a2253bf96e69f939f133551c86bdd2e37"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#a2253bf96e69f939f133551c86bdd2e37">recob::tracking::convertCollToPoint</a></div><div class="ttdeci">std::vector&lt; Point_t &gt; convertCollToPoint(std::vector&lt; Point &gt; const &amp;coll)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00055">TrackingTypes.h:55</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a44ad32e69364446202494cab6ae8239a"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a44ad32e69364446202494cab6ae8239a">trkf::Track3DKalmanSPS::fSortDim</a></div><div class="ttdeci">std::string fSortDim</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00111">Track3DKalmanSPS_module.cc:111</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="Cluster_8h_html"><div class="ttname"><a href="../../d8/d77/Cluster_8h.html">Cluster.h</a></div><div class="ttdoc">Declaration of cluster object. </div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_aba9e2e2e8025d9ad233711aed72a59d2"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aba9e2e2e8025d9ad233711aed72a59d2">genf::GFAbsTrackRep::getCov</a></div><div class="ttdeci">const TMatrixT&lt; Double_t &gt; &amp; getCov() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00197">GFAbsTrackRep.h:197</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_abf0f79cbebd150f860c339cdb7bd974d"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#abf0f79cbebd150f860c339cdb7bd974d">genf::GFTrack::getHitPlaneU</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; getHitPlaneU()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00370">GFTrack.h:370</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a8efb2e23ee9af8c4d20146cb4b7126f0"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a8efb2e23ee9af8c4d20146cb4b7126f0">trkf::Track3DKalmanSPS::ispptvec</a></div><div class="ttdeci">int ispptvec</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00133">Track3DKalmanSPS_module.cc:133</a></div></div>
<div class="ttc" id="namespacetca_html_a03d7925cba1cd1c5952d280736887b6b"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a03d7925cba1cd1c5952d280736887b6b">tca::dEdx</a></div><div class="ttdeci">float dEdx(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, const TCSlice &amp;slc, TP3D &amp;tp3d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/PFPUtils_8cxx_source.html#l02687">PFPUtils.cxx:2687</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a802154f632bd1e255cc50f1c30b276cb"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a802154f632bd1e255cc50f1c30b276cb">trkf::Track3DKalmanSPS::fDimSize</a></div><div class="ttdeci">unsigned int fDimSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00155">Track3DKalmanSPS_module.cc:155</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_a7b1666e5827c41c1ba3170a3b7a8d083"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#a7b1666e5827c41c1ba3170a3b7a8d083">genf::GFAbsTrackRep::getStatusFlag</a></div><div class="ttdeci">bool getStatusFlag()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00306">GFAbsTrackRep.h:306</a></div></div>
<div class="ttc" id="bj_2lardataobj_2RecoBase_2Track_8h_html"><div class="ttname"><a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">Track.h</a></div><div class="ttdoc">Provides recob::Track data product. </div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a51aa50dd51d6f45a93f7d1afaeb6e102"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a51aa50dd51d6f45a93f7d1afaeb6e102">trkf::Track3DKalmanSPS::fDecimateU</a></div><div class="ttdeci">int fDecimateU</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00174">Track3DKalmanSPS_module.cc:174</a></div></div>
<div class="ttc" id="namespacegenf_html_a9b7a42e7f52c2197d353dc2d6dc213c6"><div class="ttname"><a href="../../d0/dc1/namespacegenf.html#a9b7a42e7f52c2197d353dc2d6dc213c6">genf::ROOTobjectToString</a></div><div class="ttdeci">std::string ROOTobjectToString(const ROOTOBJ &amp;obj)</div><div class="ttdoc">Shortcut to write one ROOT object into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00116">GFException.h:116</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aa1d855e5f008f0fc0c3bb896cd31a5d8"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa1d855e5f008f0fc0c3bb896cd31a5d8">trkf::Track3DKalmanSPS::fshz</a></div><div class="ttdeci">Float_t * fshz</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00140">Track3DKalmanSPS_module.cc:140</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a3a34199a6b49f0961af2903f421ef336"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3a34199a6b49f0961af2903f421ef336">trkf::Track3DKalmanSPS::fpMCPos</a></div><div class="ttdeci">Float_t * fpMCPos</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00127">Track3DKalmanSPS_module.cc:127</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="WireGeo_8h_html"><div class="ttname"><a href="../../da/de5/WireGeo_8h.html">WireGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of a wire. </div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_aa66dc9a5d6eac3df49afc048509240f6"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#aa66dc9a5d6eac3df49afc048509240f6">genf::GFTrack::getHitCov7x7</a></div><div class="ttdeci">std::vector&lt; TMatrixT&lt; Double_t &gt; &gt; getHitCov7x7()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00367">GFTrack.h:367</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_af6a784cc4af6b33e5e9dcbb40b2f01fd"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af6a784cc4af6b33e5e9dcbb40b2f01fd">trkf::Track3DKalmanSPS::fCov0</a></div><div class="ttdeci">Float_t * fCov0</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00129">Track3DKalmanSPS_module.cc:129</a></div></div>
<div class="ttc" id="makeNoOverburdenVersionOf_8sh_html_aed8c88c45b85ce77144caff93012211c"><div class="ttname"><a href="../../d5/d6b/makeNoOverburdenVersionOf_8sh.html#aed8c88c45b85ce77144caff93012211c">one</a></div><div class="ttdeci">then echo Cowardly refusing to create a new FHiCL file with the same name as the original one('${SourceName}').&quot; &gt;&amp;2 exit 1 fi echo &quot;'$</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6b/makeNoOverburdenVersionOf_8sh_source.html#l00065">makeNoOverburdenVersionOf.sh:65</a></div></div>
<div class="ttc" id="namespaceutil_html_ac016dc123242a7f1d5c81594de910717"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a></div><div class="ttdeci">bool CreateAssn(art::Event &amp;evt, std::vector&lt; T &gt; const &amp;a, art::Ptr&lt; U &gt; const &amp;b, art::Assns&lt; U, T &gt; &amp;assn, std::string a_instance, size_t index=UINT_MAX)</div><div class="ttdoc">Creates a single one-to-one association. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h_source.html#l00586">lardata/lardata/Utilities/AssociationUtil.h:586</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a0b72f8115f5f7be7df77eb3d80e18001"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a0b72f8115f5f7be7df77eb3d80e18001">trkf::Track3DKalmanSPS::fpREC</a></div><div class="ttdeci">Float_t * fpREC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00125">Track3DKalmanSPS_module.cc:125</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_aa3d20a00fc8487dc31ceb3d2991a656c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#aa3d20a00fc8487dc31ceb3d2991a656c">trkf::Track3DKalmanSPS::fErrScaleM</a></div><div class="ttdeci">double fErrScaleM</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00171">Track3DKalmanSPS_module.cc:171</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a722ab9e122fc3017606f81f53e36f0ff"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a722ab9e122fc3017606f81f53e36f0ff">trkf::Track3DKalmanSPS::feth</a></div><div class="ttdeci">Float_t * feth</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00148">Track3DKalmanSPS_module.cc:148</a></div></div>
<div class="ttc" id="SpacePoint_8h_html"><div class="ttname"><a href="../../d9/d12/SpacePoint_8h.html">SpacePoint.h</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a773bbcd64b719b797f3ae878a763ab35"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a773bbcd64b719b797f3ae878a763ab35">trkf::Track3DKalmanSPS::feshyz</a></div><div class="ttdeci">Float_t * feshyz</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00144">Track3DKalmanSPS_module.cc:144</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a3961ab423ca0e4a28a9a4006fc4a745c"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a3961ab423ca0e4a28a9a4006fc4a745c">trkf::Track3DKalmanSPS::dQdxCalc</a></div><div class="ttdeci">std::vector&lt; double &gt; dQdxCalc(const art::FindManyP&lt; recob::Hit &gt; &amp;h, const art::PtrVector&lt; recob::SpacePoint &gt; &amp;s, const TVector3 &amp;p, const TVector3 &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00325">Track3DKalmanSPS_module.cc:325</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a35a856c042b5d1adb449555449b17f7d"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a35a856c042b5d1adb449555449b17f7d">trkf::Track3DKalmanSPS::feshz</a></div><div class="ttdeci">Float_t * feshz</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00143">Track3DKalmanSPS_module.cc:143</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ab31e9b2247e8a0ae5ffb8c9be8b0c26f"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ab31e9b2247e8a0ae5ffb8c9be8b0c26f">trkf::Track3DKalmanSPS::ndf</a></div><div class="ttdeci">int ndf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00131">Track3DKalmanSPS_module.cc:131</a></div></div>
<div class="ttc" id="PlaneGeo_8h_html"><div class="ttname"><a href="../../d8/d80/PlaneGeo_8h.html">PlaneGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a230ca186980db75cea9e9a361fa5b060"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a230ca186980db75cea9e9a361fa5b060">trkf::Track3DKalmanSPS::repMC</a></div><div class="ttdeci">genf::GFAbsTrackRep * repMC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00183">Track3DKalmanSPS_module.cc:183</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_ab416c092144a1769a026d2da4efb9a5d"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#ab416c092144a1769a026d2da4efb9a5d">genf::GFKalman::setInitialDirection</a></div><div class="ttdeci">void setInitialDirection(int d)</div><div class="ttdoc">Sets the inital direction of the track fit (1 for inner to outer, or -1 for outer to inner)...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00110">GFKalman.h:110</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="lardata_2lardata_2Utilities_2AssociationUtil_8h_html"><div class="ttname"><a href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">AssociationUtil.h</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_af9508f78ba8143119daa95dbd8220f91"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">lib.dedx.mass</a></div><div class="ttdeci">float mass</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00047">dedx.py:47</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a5563bd2cf53ca90f1d0ab6e85035fec8"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a5563bd2cf53ca90f1d0ab6e85035fec8">trkf::Track3DKalmanSPS::fPerpLim</a></div><div class="ttdeci">double fPerpLim</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00166">Track3DKalmanSPS_module.cc:166</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classgenf_1_1GFFieldManager_html_abdf2d962e17190bd3a07458735ed28a8"><div class="ttname"><a href="../../dd/d50/classgenf_1_1GFFieldManager.html#abdf2d962e17190bd3a07458735ed28a8">genf::GFFieldManager::init</a></div><div class="ttdeci">void init(GFAbsBField *b)</div><div class="ttdoc">set the magntic field here. Magnetic field classes must be derived from GFAbsBField ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db9/GFFieldManager_8h_source.html#l00066">GFFieldManager.h:66</a></div></div>
<div class="ttc" id="RKTrackRep_8h_html"><div class="ttname"><a href="../../dd/dc4/RKTrackRep_8h.html">RKTrackRep.h</a></div></div>
<div class="ttc" id="PointHit_8h_html"><div class="ttname"><a href="../../d2/dea/PointHit_8h.html">PointHit.h</a></div></div>
<div class="ttc" id="GFConstField_8h_html"><div class="ttname"><a href="../../d5/dec/GFConstField_8h.html">GFConstField.h</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_abfae2e504dfa44c403614b6cd601f99e"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a></div><div class="ttdeci">finds tracks best matching by angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00064">trackfinderalgorithms.fcl:64</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_a840ee9b09e94995b1ec90ce5924b64f9"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#a840ee9b09e94995b1ec90ce5924b64f9">genf::GFKalman::setErrorScaleSTh</a></div><div class="ttdeci">void setErrorScaleSTh(Double_t f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00118">GFKalman.h:118</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00254">NuVertexChargeTree_module.cc:254</a></div></div>
<div class="ttc" id="classgenf_1_1GFAbsTrackRep_html_aab060cdfad37f9d1eae3a8cf34398cd9"><div class="ttname"><a href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html#aab060cdfad37f9d1eae3a8cf34398cd9">genf::GFAbsTrackRep::getChiSqu</a></div><div class="ttdeci">double getChiSqu() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/GFAbsTrackRep_8h_source.html#l00243">GFAbsTrackRep.h:243</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a60a720ef52b34e7feab26bdc2999fd91"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a60a720ef52b34e7feab26bdc2999fd91">genf::GFTrack::addHit</a></div><div class="ttdeci">void addHit(GFAbsRecoHit *theHit)</div><div class="ttdoc">deprecated! </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00300">GFTrack.h:300</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00008">DataStructs.cxx:8</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a122a7b8666811f02fba2c0fcdc485d17"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a></div><div class="ttdeci">pdgs k</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a059f4a9027a40f3c3a29db8c34e8f5fe"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a059f4a9027a40f3c3a29db8c34e8f5fe">trkf::Track3DKalmanSPS::Track3DKalmanSPS</a></div><div class="ttdeci">Track3DKalmanSPS(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00193">Track3DKalmanSPS_module.cc:193</a></div></div>
<div class="ttc" id="icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl_html_a0fe11031f1265411c06f6f1ca14b496f"><div class="ttname"><a href="../../db/d16/icarusalg_2icarusalg_2Geometry_2gdml_2make__gdml_8pl.html#a0fe11031f1265411c06f6f1ca14b496f">close</a></div><div class="ttdeci">print OUTPUT&lt;&lt; EOF;&lt; setup name=&quot;Default&quot;version=&quot;1.0&quot;&gt;&lt; worldref=&quot;volWorld&quot;/&gt;&lt;/setup &gt;&lt;/gdml &gt; EOF close(OUTPUT)</div></div>
<div class="ttc" id="runFilesFromSAM_8sh_html_aeee9f371db14fda0de35d16324a167df"><div class="ttname"><a href="../../d0/d8f/runFilesFromSAM_8sh.html#aeee9f371db14fda0de35d16324a167df">loc</a></div><div class="ttdeci">loc</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/runFilesFromSAM_8sh_source.html#l00290">runFilesFromSAM.sh:290</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html">trkf::Track3DKalmanSPS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00092">Track3DKalmanSPS_module.cc:92</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_adfcffc313cd8d80bd22f6c67fb151645"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#adfcffc313cd8d80bd22f6c67fb151645">trkf::Track3DKalmanSPS::beginJob</a></div><div class="ttdeci">void beginJob()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00396">Track3DKalmanSPS_module.cc:396</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a2a31a62380be4749381f3f2bc0a3e289"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2a31a62380be4749381f3f2bc0a3e289">trkf::Track3DKalmanSPS::fdQdx</a></div><div class="ttdeci">Float_t * fdQdx</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00154">Track3DKalmanSPS_module.cc:154</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a93d476785e5b0283f68a7530311b7cdb"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a93d476785e5b0283f68a7530311b7cdb">trkf::Track3DKalmanSPS::fState0</a></div><div class="ttdeci">Float_t * fState0</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00128">Track3DKalmanSPS_module.cc:128</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a2dedb80dfd17966648979586d2b96601"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a2dedb80dfd17966648979586d2b96601">trkf::Track3DKalmanSPS::fMomHigh</a></div><div class="ttdeci">double fMomHigh</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00178">Track3DKalmanSPS_module.cc:178</a></div></div>
<div class="ttc" id="GFFieldManager_8h_html"><div class="ttname"><a href="../../dc/db9/GFFieldManager_8h.html">GFFieldManager.h</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a></div><div class="ttdoc">Track from a non-cascading particle.A recob::Track consists of a recob::TrackTrajectory, plus additional members relevant for a &amp;quot;fitted&amp;quot; track: </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00049">bj/lardataobj/RecoBase/Track.h:49</a></div></div>
<div class="ttc" id="classgenf_1_1GFKalman_html_ab66864c7a4b187ccc0268e7367262e3b"><div class="ttname"><a href="../../de/d6e/classgenf_1_1GFKalman.html#ab66864c7a4b187ccc0268e7367262e3b">genf::GFKalman::setErrorScaleMTh</a></div><div class="ttdeci">void setErrorScaleMTh(Double_t f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfe/GFKalman_8h_source.html#l00119">GFKalman.h:119</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_ad5c0351e3f3d7103b7a2b8709dcdbfff"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#ad5c0351e3f3d7103b7a2b8709dcdbfff">trkf::Track3DKalmanSPS::feu</a></div><div class="ttdeci">Float_t * feu</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00151">Track3DKalmanSPS_module.cc:151</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a053a4a7fa7010fc41f036b72b5db13da"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a053a4a7fa7010fc41f036b72b5db13da">trkf::Track3DKalmanSPS::fMaxPass</a></div><div class="ttdeci">int fMaxPass</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00181">Track3DKalmanSPS_module.cc:181</a></div></div>
<div class="ttc" id="classgenf_1_1GFTrack_html_a588ca428995cab199a4774e30ac0c58f"><div class="ttname"><a href="../../d6/d69/classgenf_1_1GFTrack.html#a588ca428995cab199a4774e30ac0c58f">genf::GFTrack::getHitMeasuredCov</a></div><div class="ttdeci">std::vector&lt; TMatrixT&lt; Double_t &gt; &gt; getHitMeasuredCov()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5e/GFTrack_8h_source.html#l00362">GFTrack.h:362</a></div></div>
<div class="ttc" id="namespacegeo_html_a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58bea0cb0a8adf7d7ffd1771088bdff443f63">geo::kCollection</a></div><div class="ttdoc">Signal from collection planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00146">geo_types.h:146</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_af9908e059b5a6575f008371a625c6fbb"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#af9908e059b5a6575f008371a625c6fbb">trkf::Track3DKalmanSPS::fupdate</a></div><div class="ttdeci">Float_t * fupdate</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00145">Track3DKalmanSPS_module.cc:145</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanSPS_html_a19abc2f92027fc0437caa8229c6605bf"><div class="ttname"><a href="../../d5/dd9/classtrkf_1_1Track3DKalmanSPS.html#a19abc2f92027fc0437caa8229c6605bf">trkf::Track3DKalmanSPS::nchi2rePass</a></div><div class="ttdeci">int nchi2rePass</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Track3DKalmanSPS__module_8cc_source.html#l00132">Track3DKalmanSPS_module.cc:132</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
