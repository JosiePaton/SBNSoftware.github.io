<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MultiPartRain_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_5f678ef99ea6f964b236b90db12a4ab6.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_9c2e8b3a7cfa1f7937f5a112e04e3409.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_1ffba7274604d06a154edb7c31d4b2fb.html">EventGenerator</a></li><li class="navelem"><a class="el" href="../../dir_570c16182580b3e510afe3c29d921fe8.html">MultiPart</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MultiPartRain_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d5a/MultiPartRain__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">// Class:       MultiPartRain</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Module Type: producer</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// File:        MultiPartRain_module.cc</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Generated at Tue Dec 13 15:48:59 2016 by Kazuhiro Terao using artmod</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// from cetpkgsupport v1_11_00.</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Run.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/SubRun.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//#include &quot;art/Utilities/InputTag.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;CLHEP/Random/RandFlat.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;TRandom.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;nurandom/RandomUtils/NuRandomService.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d86/RunData_8h.html">larcoreobj/SummaryData/RunData.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;nusimdata/SimulationBase/MCTruth.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;nusimdata/SimulationBase/MCParticle.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;TLorentzVector.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;TDatabasePDG.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html">   35</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../de/d2a/structPartGenParam.html">PartGenParam</a> {</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">   36</a></span>&#160;    std::vector&lt;int       &gt; <a class="code" href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">pdg</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#aa9fa8427ec12affc5da55b8db3b86f0e">   37</a></span>&#160;    std::vector&lt;double    &gt; <a class="code" href="../../de/d2a/structPartGenParam.html#aa9fa8427ec12affc5da55b8db3b86f0e">mass</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#a7cfb854791d484f4ba6fb4b479a0cb57">   38</a></span>&#160;    std::array &lt;size_t, 2 &gt; <a class="code" href="../../de/d2a/structPartGenParam.html#a7cfb854791d484f4ba6fb4b479a0cb57">multi</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">   39</a></span>&#160;    std::array &lt;double, 2 &gt; <a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">   40</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">use_mom</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#a09ef6f7d36212061710fa5e9b3e7c32e">   41</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../de/d2a/structPartGenParam.html#a09ef6f7d36212061710fa5e9b3e7c32e">direct_inward</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../de/d2a/structPartGenParam.html#aace1fb67cf0c24c1a85e7ed81d69cff9">   42</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/d2a/structPartGenParam.html#aace1fb67cf0c24c1a85e7ed81d69cff9">weight</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;};</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html">   47</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">MultiPartRain</a>(fhicl::ParameterSet <span class="keyword">const</span> &amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// The destructor generated by the compiler is fine for classes</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// without bare pointers or other resource use.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="../../d4/d55/classMultiPartRain.html#ac744b20fe953112d8355c7c253e7c768">~MultiPartRain</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Plugins should not be copied or assigned.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">MultiPartRain</a>(<a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> <span class="keyword">const</span> &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">MultiPartRain</a>(<a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> &amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> &amp; <a class="code" href="../../d4/d55/classMultiPartRain.html#a62766de7bd11c934bfd327e2048022e3">operator = </a>(<a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> <span class="keyword">const</span> &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> &amp; <a class="code" href="../../d4/d55/classMultiPartRain.html#a62766de7bd11c934bfd327e2048022e3">operator = </a>(<a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a> &amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// Required functions.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a685ad5c1815aec926c5ba2be37471edd">produce</a>(art::Event &amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a70e7c2b84de5a801696afa3ee013ee32">beginRun</a>(art::Run&amp; run) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#aa6fdca63d4ed14dace67e285754e1bde">GenPosition</a>(<span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a07753676c3a909f95f8971ec343d281e">GenMomentum</a>(<span class="keyword">const</span> <a class="code" href="../../de/d2a/structPartGenParam.html">PartGenParam</a>&amp; param, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../de/d4f/filemuons_8fcl.html#a5d65ed57c8d202a924f2716ca6c8d209">px</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d2/df3/prod__muon__2GeV__d45__Collection_8fcl.html#ad3fdde52520bceee418a61ecae2a8343">py</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../de/d4f/filemuons_8fcl.html#a353996e037fc5b2ea33c626744db2552">pz</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> z);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    std::vector&lt;size_t&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#afc8bfdb718a8f4e99a65476c368e49f0">GenParticles</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a3380ff0a887a68168b4186241d29b5fc">   74</a></span>&#160;    CLHEP::HepRandomEngine&amp; <a class="code" href="../../d4/d55/classMultiPartRain.html#a3380ff0a887a68168b4186241d29b5fc">fFlatEngine</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">   75</a></span>&#160;    CLHEP::RandFlat *<a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// exception thrower</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="keyword">const</span> std::string <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#a25a3f236e071521c1ae6d2efe0ebe688">msg</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// array of particle info for generation</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">   81</a></span>&#160;    std::vector&lt;PartGenParam&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// g4 time of generation</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">   84</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">_t0</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">   85</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">_t0_sigma</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// g4 position</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">   88</a></span>&#160;    std::array&lt;double,2&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">   89</a></span>&#160;    std::array&lt;double,2&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">   90</a></span>&#160;    std::array&lt;double,2&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// TPC array</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#af2c1a1f9251258024df37c5ccb7cb552">   93</a></span>&#160;    std::vector&lt;std::vector&lt;unsigned short&gt; &gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#af2c1a1f9251258024df37c5ccb7cb552">_tpc_v</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// multiplicity constraint</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">   96</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#aeb68fcd74f4fa2ef7cdbc79addabecf0">   97</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#aeb68fcd74f4fa2ef7cdbc79addabecf0">_multi_max</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// verbosity flag</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">  100</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">  103</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">MultiPartRain::abort</a>(<span class="keyword">const</span> std::string <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#a25a3f236e071521c1ae6d2efe0ebe688">msg</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a8d1a8a85a0b2a30cac1090ea528dd015">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;\033[93m&quot;</span> &lt;&lt; msg.c_str() &lt;&lt; <span class="stringliteral">&quot;\033[00m&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">throw</span> std::exception();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#ac744b20fe953112d8355c7c253e7c768">  109</a></span>&#160;<a class="code" href="../../d4/d55/classMultiPartRain.html#ac744b20fe953112d8355c7c253e7c768">MultiPartRain::~MultiPartRain</a>()</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{ <span class="keyword">delete</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>; }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">  112</a></span>&#160;<a class="code" href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">MultiPartRain::MultiPartRain</a>(fhicl::ParameterSet <span class="keyword">const</span> &amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;: EDProducer(p)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;, fFlatEngine(art::ServiceHandle&lt;rndm::NuRandomService&gt;()-&gt;createEngine(*<a class="code" href="../../dc/d8a/namespaceopdet.html#a3129c5b22fe2bf850c452ed5507de2e7">this</a>, <span class="stringliteral">&quot;HepJamesRandom&quot;</span>, <span class="stringliteral">&quot;GenRain&quot;</span>))</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//, fFlatEngine(art::ServiceHandle&lt;rndm::NuRandomService&gt;()-&gt;createEngine(*this, &quot;HepJamesRandom&quot;, &quot;Gen&quot;, p, &quot;Seed&quot;))</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// :</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// Initialize member data here.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Random engine initialization</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a> = <span class="keyword">new</span> CLHEP::RandFlat(<a class="code" href="../../d4/d55/classMultiPartRain.html#a3380ff0a887a68168b4186241d29b5fc">fFlatEngine</a>,0,1);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    produces&lt; std::vector&lt;simb::MCTruth&gt;   &gt;();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    produces&lt; sumdata::RunData, art::InRun &gt;();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a> = p.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;DebugMode&quot;</span>,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">_t0</a> = p.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;G4Time&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">_t0_sigma</a> = p.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;G4TimeJitter&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span>(_t0_sigma &lt; 0) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Cannot have a negative value for G4 time jitter&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a> = p.get&lt;<span class="keywordtype">size_t</span>&gt;(<span class="stringliteral">&quot;MultiMin&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#aeb68fcd74f4fa2ef7cdbc79addabecf0">_multi_max</a> = p.get&lt;<span class="keywordtype">size_t</span>&gt;(<span class="stringliteral">&quot;MultiMax&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#af2c1a1f9251258024df37c5ccb7cb552">_tpc_v</a> = p.get&lt;std::vector&lt;std::vector&lt;unsigned short&gt; &gt; &gt;(<span class="stringliteral">&quot;TPCRange&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> xrange = p.get&lt;std::vector&lt;double&gt; &gt; (<span class="stringliteral">&quot;XRange&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> yrange = p.get&lt;std::vector&lt;double&gt; &gt; (<span class="stringliteral">&quot;YRange&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> zrange = p.get&lt;std::vector&lt;double&gt; &gt; (<span class="stringliteral">&quot;ZRange&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> part_cfg = p.get&lt;fhicl::ParameterSet&gt;(<span class="stringliteral">&quot;ParticleParameter&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>.clear();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> pdg_v      = part_cfg.get&lt;std::vector&lt;std::vector&lt;int&gt;    &gt; &gt; (<span class="stringliteral">&quot;PDGCode&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> minmult_v  = part_cfg.get&lt;std::vector&lt;unsigned short&gt; &gt; (<span class="stringliteral">&quot;MinMulti&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> maxmult_v  = part_cfg.get&lt;std::vector&lt;unsigned short&gt; &gt; (<span class="stringliteral">&quot;MaxMulti&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> weight_v   = part_cfg.get&lt;std::vector&lt;double&gt; &gt; (<span class="stringliteral">&quot;ProbWeight&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">auto</span> kerange_v  = part_cfg.get&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; (<span class="stringliteral">&quot;KERange&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">auto</span> momrange_v = part_cfg.get&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; (<span class="stringliteral">&quot;MomRange&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span>( (kerange_v.empty() &amp;&amp; momrange_v.empty()) ||</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;       (!kerange_v.empty() &amp;&amp; !momrange_v.empty()) ) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Only one of KERange or MomRange must be empty!&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">bool</span> use_mom = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span>(kerange_v.empty()){</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        kerange_v = momrange_v;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        use_mom = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// sanity check</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span>( pdg_v.size() != kerange_v.size() ||</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       pdg_v.size() != minmult_v.size() ||</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       pdg_v.size() != maxmult_v.size() ||</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;       pdg_v.size() != weight_v.size() )</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;configuration parameters have incompatible lengths!&quot;</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// further sanity check (1 more depth for some double-array)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> : pdg_v    ) { <span class="keywordflow">if</span>(              <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>.empty()  ) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;PDG code not given!&quot;</span>);                        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> : kerange_v) { <span class="keywordflow">if</span>(              <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>.size()!=2) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Incompatible legnth @ KE vector!&quot;</span>);           }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx=0; idx&lt;minmult_v.size(); ++idx) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span>(minmult_v[idx] &gt; maxmult_v[idx]) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Particle MinMulti &gt; Particle MaxMulti!&quot;</span>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span>(minmult_v[idx] &gt; _multi_max) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Particle MinMulti &gt; overall MultiMax!&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span>(minmult_v[idx] &gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a>)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a> = minmult_v[idx];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>(_multi_max &lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a>) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Overall MultiMax &lt;= overall MultiMin!&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span>(!xrange.empty() &amp;&amp; xrange.size() &gt;2) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Incompatible legnth @ X vector!&quot;</span> );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span>(!yrange.empty() &amp;&amp; yrange.size() &gt;2) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Incompatible legnth @ Y vector!&quot;</span> );</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span>(!zrange.empty() &amp;&amp; zrange.size() &gt;2) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;Incompatible legnth @ Z vector!&quot;</span> );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// slight modification from mpv: define the overall volume across specified TPC IDs + range options</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a>,xmax,ymin,ymax,zmin,zmax;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    xmin = ymin = zmin =  1.e20;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    xmax = ymax = zmax = -1.e20;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Implementation of required member function here.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">auto</span> geop = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; tpc_id : _tpc_v) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      assert(tpc_id.size() == 2);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordtype">size_t</span> cid = tpc_id[0];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">size_t</span> tid = tpc_id[1];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; cryostat = geop-&gt;Cryostat(cid);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      assert(cryostat.HasTPC(tid));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; tpc = cryostat.TPC(tid);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; tpcabox = tpc.ActiveBoundingBox();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      xmin = std::min(tpcabox.MinX(), <a class="code" href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      ymin = std::min(tpcabox.MinY(), ymin);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      zmin = std::min(tpcabox.MinZ(), zmin);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      xmax = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(tpcabox.MaxX(), xmax);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      ymax = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(tpcabox.MaxY(), ymax);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      zmax = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(tpcabox.MaxZ(), zmax);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span>(_debug) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Using Cryostat &quot;</span> &lt;&lt; tpc_id[0] &lt;&lt; <span class="stringliteral">&quot; TPC &quot;</span> &lt;&lt; tpc_id[1]</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; ... X &quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; xmax</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; ... Y &quot;</span> &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; ymax</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; ... Z &quot;</span> &lt;&lt; zmin &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; zmax</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// range register</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>(xrange.size()==1) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0] = <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[1] = xrange[0]; }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span>(yrange.size()==1) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0] = <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[1] = yrange[0]; }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span>(zrange.size()==1) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0] = <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[1] = zrange[0]; }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span>(xrange.size()==2) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0] = xrange[0]; <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[1] = xrange[1]; }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span>(yrange.size()==2) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0] = yrange[0]; <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[1] = yrange[1]; }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span>(zrange.size()==2) { <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0] = zrange[0]; <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[1] = zrange[1]; }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0] = xmin + <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    _xrange[1] = xmax - _xrange[1];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0] = ymin + <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    _yrange[1] = ymax - _yrange[1];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0] = zmin + <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    _zrange[1] = zmax - _zrange[1];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// check</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    assert(_xrange[0] &lt;= _xrange[1]);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    assert(_yrange[0] &lt;= _yrange[1]);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    assert(_zrange[0] &lt;= _zrange[1]);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>(_debug&gt;0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;Particle generation world boundaries...&quot;</span>&lt;&lt;std::endl</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;               &lt;&lt;<span class="stringliteral">&quot;X &quot;</span> &lt;&lt; _xrange[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; _xrange[1] &lt;&lt; std::endl</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               &lt;&lt;<span class="stringliteral">&quot;Y &quot;</span> &lt;&lt; _yrange[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; _yrange[1] &lt;&lt; std::endl</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               &lt;&lt;<span class="stringliteral">&quot;Z &quot;</span> &lt;&lt; _zrange[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; _zrange[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// register</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">//auto db = new TDatabasePDG;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">auto</span> <a class="code" href="../../dc/db0/corsika__icarus_8fcl.html#ab93e705c5d934e7777f11582689b7e1f">db</a> = TDatabasePDG::Instance();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx=0; idx&lt;pdg_v.size(); ++idx) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>     = pdg_v[idx];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; kerange = kerange_v[idx];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="../../de/d2a/structPartGenParam.html">PartGenParam</a> param;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#a09ef6f7d36212061710fa5e9b3e7c32e">direct_inward</a> = p.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;DirectInward&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">use_mom</a>    = use_mom;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">pdg</a>        = <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[0] = kerange[0];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[1] = kerange[1];</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#aa9fa8427ec12affc5da55b8db3b86f0e">mass</a>.resize(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>.size());</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#a7cfb854791d484f4ba6fb4b479a0cb57">multi</a>[0]   = minmult_v[idx];</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#a7cfb854791d484f4ba6fb4b479a0cb57">multi</a>[1]   = maxmult_v[idx];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        param.<a class="code" href="../../de/d2a/structPartGenParam.html#aace1fb67cf0c24c1a85e7ed81d69cff9">weight</a>     = weight_v[idx];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;<a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>.size(); ++i)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            param.<a class="code" href="../../de/d2a/structPartGenParam.html#aa9fa8427ec12affc5da55b8db3b86f0e">mass</a>[i] = <a class="code" href="../../dc/db0/corsika__icarus_8fcl.html#ab93e705c5d934e7777f11582689b7e1f">db</a>-&gt;GetParticle(param.<a class="code" href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">pdg</a>[i])-&gt;Mass();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// sanity check</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span>(kerange[0]&lt;0 || kerange[1]&lt;0)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;You provided negative energy? Fuck off Mr. Trump.&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// overall range check</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">if</span>(param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[0] &gt; param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[1]) this-&gt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">abort</a>(<span class="stringliteral">&quot;KE range has no phase space...&quot;</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span>(_debug&gt;0) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Generating particle (PDG&quot;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> : param.<a class="code" href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">pdg</a>) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            &lt;&lt; (param.<a class="code" href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">use_mom</a> ? <span class="stringliteral">&quot;    KE range ....... &quot;</span> : <span class="stringliteral">&quot;    Mom range ....... &quot;</span>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            &lt;&lt; param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[1] &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>.push_back(param);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a70e7c2b84de5a801696afa3ee013ee32">  283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a70e7c2b84de5a801696afa3ee013ee32">MultiPartRain::beginRun</a>(art::Run&amp; run)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// grab the geometry object to see what geometry we are using</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    art::ServiceHandle&lt;geo::Geometry&gt; geo;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    std::unique_ptr&lt;sumdata::RunData&gt; runData(<span class="keyword">new</span> <a class="code" href="../../d4/de1/classsumdata_1_1RunData.html">sumdata::RunData</a>(geo-&gt;DetectorName()));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    run.put(std::move(runData));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#afc8bfdb718a8f4e99a65476c368e49f0">  295</a></span>&#160;std::vector&lt;size_t&gt; <a class="code" href="../../d4/d55/classMultiPartRain.html#afc8bfdb718a8f4e99a65476c368e49f0">MultiPartRain::GenParticles</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    std::vector&lt;size_t&gt; result;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::vector&lt;size_t&gt; gen_count_v(<a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>.size(),0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    std::vector&lt;double&gt; weight_v(<a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>.size(),0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx=0; idx&lt;<a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>.size(); ++idx)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        weight_v[idx] = <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>[idx].weight;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">int</span> num_part = (int)(<a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(<a class="code" href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">_multi_min</a>,<a class="code" href="../../d4/d55/classMultiPartRain.html#aeb68fcd74f4fa2ef7cdbc79addabecf0">_multi_max</a>+1-1.e-10));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">while</span>(num_part) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordtype">double</span> total_weight = 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; v : weight_v) total_weight += v;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordtype">double</span> rval = 0;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        rval = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0,total_weight);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">for</span>(idx = 0; idx &lt; weight_v.size(); ++idx) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            rval -= weight_v[idx];</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span>(rval &lt;=0.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// register to the output</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        result.push_back(idx);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// if generation count exceeds max, set probability weight to be 0</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        gen_count_v[idx] += 1;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span>(gen_count_v[idx] &gt;= <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>[idx].multi[1])</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            weight_v[idx] = 0.;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        --num_part;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#aa6fdca63d4ed14dace67e285754e1bde">  332</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#aa6fdca63d4ed14dace67e285754e1bde">MultiPartRain::GenPosition</a>(<span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  x = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(<a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0],<a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[1]);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  y = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(<a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0],<a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[1]);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  z = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(<a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0],<a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[1]);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>&gt;0) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Generating a rain particle at (&quot;</span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; z &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a07753676c3a909f95f8971ec343d281e">  344</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a07753676c3a909f95f8971ec343d281e">MultiPartRain::GenMomentum</a>(<span class="keyword">const</span> <a class="code" href="../../de/d2a/structPartGenParam.html">PartGenParam</a>&amp; param, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../de/d4f/filemuons_8fcl.html#a5d65ed57c8d202a924f2716ca6c8d209">px</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d2/df3/prod__muon__2GeV__d45__Collection_8fcl.html#ad3fdde52520bceee418a61ecae2a8343">py</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../de/d4f/filemuons_8fcl.html#a353996e037fc5b2ea33c626744db2552">pz</a>,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">double</span> tot_energy = 0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span>(param.<a class="code" href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">use_mom</a>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      tot_energy = sqrt(pow(<a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[0],param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[1]),2) + pow(mass,2));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      tot_energy = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[0],param.<a class="code" href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">kerange</a>[1]) + <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">double</span> mom_mag = sqrt(pow(tot_energy,2) - pow(mass,2));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span>(!param.<a class="code" href="../../de/d2a/structPartGenParam.html#a09ef6f7d36212061710fa5e9b3e7c32e">direct_inward</a>) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;No inward directioning...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordtype">double</span> phi   = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0, 2 * 3.141592653589793238);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordtype">double</span> theta = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0, 1 * 3.141592653589793238);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      px = cos(phi) * sin(theta);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      py = sin(phi) * sin(theta);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      pz = cos(theta);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordtype">double</span> sign_x = ( (x - <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0]) &lt; (<a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[1] - x) ? 1.0 : -1.0 );</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordtype">double</span> sign_y = ( (y - <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0]) &lt; (<a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[1] - y) ? 1.0 : -1.0 );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordtype">double</span> sign_z = ( (z - <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0]) &lt; (<a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[1] - z) ? 1.0 : -1.0 );</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;Generating XYZ direction sign for a particle at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; z &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;X: &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">_xrange</a>[1] &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; sign_x &lt;&lt; std::endl</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;Y: &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">_yrange</a>[1] &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; sign_y &lt;&lt; std::endl</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;Z: &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[0] &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; <a class="code" href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">_zrange</a>[1] &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; sign_z &lt;&lt; std::endl</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">while</span>(1) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordtype">double</span> phi   = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0, 2 * 3.141592653589793238);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">double</span> theta = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0, 1 * 3.141592653589793238);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        px = cos(phi) * sin(theta);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        py = sin(phi) * sin(theta);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        pz = cos(theta);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span>( (px * sign_x) &gt;= 0. &amp;&amp; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            (py * sign_y) &gt;= 0. &amp;&amp;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            (pz * sign_z) &gt;= 0. )</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;LOGME,&quot;&lt;&lt;phi&lt;&lt;&quot;,&quot;&lt;&lt;theta&lt;&lt;&quot;,&quot;&lt;&lt;px&lt;&lt;&quot;,&quot;&lt;&lt;py&lt;&lt;&quot;,&quot;&lt;&lt;pz&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>&gt;1)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;    Direction : (&quot;</span> &lt;&lt; px &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; py &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; pz &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;    Momentum  : &quot;</span> &lt;&lt; mom_mag &lt;&lt; <span class="stringliteral">&quot; [MeV/c]&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;    Energy    : &quot;</span> &lt;&lt; tot_energy &lt;&lt; <span class="stringliteral">&quot; [MeV/c^2]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    px *= mom_mag;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    py *= mom_mag;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    pz *= mom_mag;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="../../d4/d55/classMultiPartRain.html#a685ad5c1815aec926c5ba2be37471edd">  401</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/d55/classMultiPartRain.html#a685ad5c1815aec926c5ba2be37471edd">MultiPartRain::produce</a>(art::Event &amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>&gt;0) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Processing a new event...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    std::unique_ptr&lt; std::vector&lt;simb::MCTruth&gt; &gt; mctArray(<span class="keyword">new</span> std::vector&lt;simb::MCTruth&gt;);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    simb::MCTruth mct;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    mct.SetOrigin(<a class="code" href="../../d0/d98/PAC2020_2SBND_2helper_8h.html#a0f8170e4d8765178d662f2d77d6e92ce">simb::kCosmicRay</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    std::vector&lt;simb::MCParticle&gt; part_v;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> param_idx_v = <a class="code" href="../../d4/d55/classMultiPartRain.html#afc8bfdb718a8f4e99a65476c368e49f0">GenParticles</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Generating&quot;</span> &lt;&lt; param_idx_v.size() &lt;&lt; <span class="stringliteral">&quot; particles...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx=0; idx&lt;param_idx_v.size(); ++idx) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; param = <a class="code" href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">_param_v</a>[param_idx_v[idx]];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../de/d4f/filemuons_8fcl.html#a5d65ed57c8d202a924f2716ca6c8d209">px</a>,<a class="code" href="../../d2/df3/prod__muon__2GeV__d45__Collection_8fcl.html#ad3fdde52520bceee418a61ecae2a8343">py</a>,<a class="code" href="../../de/d4f/filemuons_8fcl.html#a353996e037fc5b2ea33c626744db2552">pz</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">// decide which particle</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordtype">size_t</span> pdg_index = (size_t)(<a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(0,param.pdg.size()-1.e-10));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>  = param.pdg[pdg_index];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a> = param.mass[pdg_index];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; idx &lt;&lt; <span class="stringliteral">&quot;th instance PDG &quot;</span> &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../d4/d55/classMultiPartRain.html#aa6fdca63d4ed14dace67e285754e1bde">GenPosition</a>(x,y,z);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordtype">double</span> g4_time = <a class="code" href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">fFlatRandom</a>-&gt;fire(<a class="code" href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">_t0</a> - <a class="code" href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">_t0_sigma</a>/2., <a class="code" href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">_t0</a> + <a class="code" href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">_t0_sigma</a>/2.);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        TLorentzVector pos(x,y,z,g4_time);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;Generating momentum...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="../../d4/d55/classMultiPartRain.html#a07753676c3a909f95f8971ec343d281e">GenMomentum</a>(param,<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>,px,py,pz,x,y,z);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;done&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        TLorentzVector mom(px,py,pz,sqrt(pow(px,2)+pow(py,2)+pow(pz,2)+pow(<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>,2)));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        simb::MCParticle part(part_v.size(), <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>, <span class="stringliteral">&quot;primary&quot;</span>, 0, <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>, 1);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        part.AddTrajectoryPoint(pos,mom);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        part_v.emplace_back(std::move(part));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">_debug</a>) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Total number particles: &quot;</span> &lt;&lt; mct.NParticles() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">     simb::MCParticle nu(mct.NParticles(), 16, &quot;primary&quot;, mct.NParticles(), 0, 0);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">     double px=0;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">     double py=0;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">     double pz=0;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">     double en=0;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">     for(auto const&amp; part : part_v) {</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">     px = part.Momentum().Px();</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">     py = part.Momentum().Py();</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">     pz = part.Momentum().Pz();</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">     en = part.Momentum().E();</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">     }</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">     TLorentzVector mom(px,py,pz,en);</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">     nu.AddTrajectoryPoint(pos,mom);</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">     </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">     mct.Add(nu);</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; part : part_v)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        mct.Add(part);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    mctArray-&gt;push_back(mct);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    e.put(std::move(mctArray));</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;DEFINE_ART_MODULE(<a class="code" href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a>)</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="classMultiPartRain_html_ac4e6643c013c84d2810ef78040051751"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#ac4e6643c013c84d2810ef78040051751">MultiPartRain::_t0</a></div><div class="ttdeci">double _t0</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00084">MultiPartRain_module.cc:84</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a697017f6ca07cbb4f47653babf318012"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a></div><div class="ttdeci">var pdg</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00014">selectors.fcl:14</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a8d1a8a85a0b2a30cac1090ea528dd015"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a8d1a8a85a0b2a30cac1090ea528dd015">cerr</a></div><div class="ttdeci">BEGIN_PROLOG could also be cerr</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="filemuons_8fcl_html_a353996e037fc5b2ea33c626744db2552"><div class="ttname"><a href="../../de/d4f/filemuons_8fcl.html#a353996e037fc5b2ea33c626744db2552">pz</a></div><div class="ttdeci">BEGIN_PROLOG pz</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4f/filemuons_8fcl_source.html#l00010">filemuons.fcl:10</a></div></div>
<div class="ttc" id="structPartGenParam_html"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html">PartGenParam</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00035">MultiPartRain_module.cc:35</a></div></div>
<div class="ttc" id="structPartGenParam_html_ad86c810e3318771095a1c90eaabc3f9f"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#ad86c810e3318771095a1c90eaabc3f9f">PartGenParam::pdg</a></div><div class="ttdeci">std::vector&lt; int &gt; pdg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00036">MultiPartRain_module.cc:36</a></div></div>
<div class="ttc" id="classMultiPartRain_html_aeb68fcd74f4fa2ef7cdbc79addabecf0"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#aeb68fcd74f4fa2ef7cdbc79addabecf0">MultiPartRain::_multi_max</a></div><div class="ttdeci">size_t _multi_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00097">MultiPartRain_module.cc:97</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="structPartGenParam_html_a09ef6f7d36212061710fa5e9b3e7c32e"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#a09ef6f7d36212061710fa5e9b3e7c32e">PartGenParam::direct_inward</a></div><div class="ttdeci">bool direct_inward</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00041">MultiPartRain_module.cc:41</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a3380ff0a887a68168b4186241d29b5fc"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a3380ff0a887a68168b4186241d29b5fc">MultiPartRain::fFlatEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fFlatEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00074">MultiPartRain_module.cc:74</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a709cd1c493ad24b701894ae702651664"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a709cd1c493ad24b701894ae702651664">MultiPartRain::_xrange</a></div><div class="ttdeci">std::array&lt; double, 2 &gt; _xrange</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00088">MultiPartRain_module.cc:88</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a26375c0b75c286b5e831c4f872814dd4"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a26375c0b75c286b5e831c4f872814dd4">MultiPartRain::_multi_min</a></div><div class="ttdeci">size_t _multi_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00096">MultiPartRain_module.cc:96</a></div></div>
<div class="ttc" id="classMultiPartRain_html_ac744b20fe953112d8355c7c253e7c768"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#ac744b20fe953112d8355c7c253e7c768">MultiPartRain::~MultiPartRain</a></div><div class="ttdeci">~MultiPartRain()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00109">MultiPartRain_module.cc:109</a></div></div>
<div class="ttc" id="run__vertexcharge__icarus_8fcl_html_a0bb005bed46cb3379a0703e7b92b23c5"><div class="ttname"><a href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a></div><div class="ttdeci">process_name pandoraGausCryo1 vertexChargeCryo1 vertexStubCryo1 xmin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d48/run__vertexcharge__icarus_8fcl_source.html#l00109">run_vertexcharge_icarus.fcl:109</a></div></div>
<div class="ttc" id="namespacesortDataLoggerFiles_html_a25a3f236e071521c1ae6d2efe0ebe688"><div class="ttname"><a href="../../d3/d46/namespacesortDataLoggerFiles.html#a25a3f236e071521c1ae6d2efe0ebe688">sortDataLoggerFiles.msg</a></div><div class="ttdeci">string msg</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc8/sortDataLoggerFiles_8py_source.html#l00436">sortDataLoggerFiles.py:436</a></div></div>
<div class="ttc" id="structPartGenParam_html_a2042f4e6870d547ee555b9810eef536c"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#a2042f4e6870d547ee555b9810eef536c">PartGenParam::use_mom</a></div><div class="ttdeci">bool use_mom</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00040">MultiPartRain_module.cc:40</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a9f3d14a3224d64d4fef66197fe4bdb70"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a9f3d14a3224d64d4fef66197fe4bdb70">MultiPartRain::_t0_sigma</a></div><div class="ttdeci">double _t0_sigma</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00085">MultiPartRain_module.cc:85</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a1e5aaaf25e8609a835e8c7c6fda71456"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div><div class="ttdeci">process_name opflash particleana ie ie y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00091">run_opflash_electron.fcl:91</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a62766de7bd11c934bfd327e2048022e3"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a62766de7bd11c934bfd327e2048022e3">MultiPartRain::operator=</a></div><div class="ttdeci">MultiPartRain &amp; operator=(MultiPartRain const &amp;)=delete</div></div>
<div class="ttc" id="classMultiPartRain_html"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html">MultiPartRain</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00047">MultiPartRain_module.cc:47</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a685ad5c1815aec926c5ba2be37471edd"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a685ad5c1815aec926c5ba2be37471edd">MultiPartRain::produce</a></div><div class="ttdeci">void produce(art::Event &amp;e) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00401">MultiPartRain_module.cc:401</a></div></div>
<div class="ttc" id="PAC2020_2SBND_2helper_8h_html_a0f8170e4d8765178d662f2d77d6e92ce"><div class="ttname"><a href="../../d0/d98/PAC2020_2SBND_2helper_8h.html#a0f8170e4d8765178d662f2d77d6e92ce">kCosmicRay</a></div><div class="ttdeci">const Cut kCosmicRay</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d98/PAC2020_2SBND_2helper_8h_source.html#l00054">PAC2020/SBND/helper.h:54</a></div></div>
<div class="ttc" id="structPartGenParam_html_aace1fb67cf0c24c1a85e7ed81d69cff9"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#aace1fb67cf0c24c1a85e7ed81d69cff9">PartGenParam::weight</a></div><div class="ttdeci">double weight</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00042">MultiPartRain_module.cc:42</a></div></div>
<div class="ttc" id="classMultiPartRain_html_aa6fdca63d4ed14dace67e285754e1bde"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#aa6fdca63d4ed14dace67e285754e1bde">MultiPartRain::GenPosition</a></div><div class="ttdeci">void GenPosition(double &amp;x, double &amp;y, double &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00332">MultiPartRain_module.cc:332</a></div></div>
<div class="ttc" id="namespaceopdet_html_a3129c5b22fe2bf850c452ed5507de2e7"><div class="ttname"><a href="../../dc/d8a/namespaceopdet.html#a3129c5b22fe2bf850c452ed5507de2e7">opdet::this</a></div><div class="ttdeci">createEngine this</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d31/OpMCDigi__module_8cc_source.html#l00084">OpMCDigi_module.cc:84</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a515346d2e6fab33384471ab2f65fa1bf"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a515346d2e6fab33384471ab2f65fa1bf">MultiPartRain::_zrange</a></div><div class="ttdeci">std::array&lt; double, 2 &gt; _zrange</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00090">MultiPartRain_module.cc:90</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a778b8f7056fa8249970e71f0d4ae04be"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a778b8f7056fa8249970e71f0d4ae04be">MultiPartRain::_param_v</a></div><div class="ttdeci">std::vector&lt; PartGenParam &gt; _param_v</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00081">MultiPartRain_module.cc:81</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a07753676c3a909f95f8971ec343d281e"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a07753676c3a909f95f8971ec343d281e">MultiPartRain::GenMomentum</a></div><div class="ttdeci">void GenMomentum(const PartGenParam &amp;param, const double &amp;mass, double &amp;px, double &amp;py, double &amp;pz, const double x, const double y, const double z)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00344">MultiPartRain_module.cc:344</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a70e7c2b84de5a801696afa3ee013ee32"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a70e7c2b84de5a801696afa3ee013ee32">MultiPartRain::beginRun</a></div><div class="ttdeci">void beginRun(art::Run &amp;run) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00283">MultiPartRain_module.cc:283</a></div></div>
<div class="ttc" id="filemuons_8fcl_html_a5d65ed57c8d202a924f2716ca6c8d209"><div class="ttname"><a href="../../de/d4f/filemuons_8fcl.html#a5d65ed57c8d202a924f2716ca6c8d209">px</a></div><div class="ttdeci">BEGIN_PROLOG px</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4f/filemuons_8fcl_source.html#l00010">filemuons.fcl:10</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a74e97ce5dfc5885b014f1ec4e73a7a54"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a74e97ce5dfc5885b014f1ec4e73a7a54">MultiPartRain::_yrange</a></div><div class="ttdeci">std::array&lt; double, 2 &gt; _yrange</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00089">MultiPartRain_module.cc:89</a></div></div>
<div class="ttc" id="prod__muon__2GeV__d45__Collection_8fcl_html_ad3fdde52520bceee418a61ecae2a8343"><div class="ttname"><a href="../../d2/df3/prod__muon__2GeV__d45__Collection_8fcl.html#ad3fdde52520bceee418a61ecae2a8343">py</a></div><div class="ttdeci">process_name physics producers generator physics producers generator physics producers generator py</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df3/prod__muon__2GeV__d45__Collection_8fcl_source.html#l00021">prod_muon_2GeV_d45_Collection.fcl:21</a></div></div>
<div class="ttc" id="classMultiPartRain_html_aa14699a67088a3d64c650479183c4860"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#aa14699a67088a3d64c650479183c4860">MultiPartRain::MultiPartRain</a></div><div class="ttdeci">MultiPartRain(fhicl::ParameterSet const &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00112">MultiPartRain_module.cc:112</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_af9508f78ba8143119daa95dbd8220f91"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">lib.dedx.mass</a></div><div class="ttdeci">float mass</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00047">dedx.py:47</a></div></div>
<div class="ttc" id="structPartGenParam_html_aa9fa8427ec12affc5da55b8db3b86f0e"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#aa9fa8427ec12affc5da55b8db3b86f0e">PartGenParam::mass</a></div><div class="ttdeci">std::vector&lt; double &gt; mass</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00037">MultiPartRain_module.cc:37</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a59d626f9376846f0881d5d0fdcebdf6e"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a59d626f9376846f0881d5d0fdcebdf6e">MultiPartRain::fFlatRandom</a></div><div class="ttdeci">CLHEP::RandFlat * fFlatRandom</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00075">MultiPartRain_module.cc:75</a></div></div>
<div class="ttc" id="structPartGenParam_html_afefbd4783441a28192945a2533651c66"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#afefbd4783441a28192945a2533651c66">PartGenParam::kerange</a></div><div class="ttdeci">std::array&lt; double, 2 &gt; kerange</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00039">MultiPartRain_module.cc:39</a></div></div>
<div class="ttc" id="RunData_8h_html"><div class="ttname"><a href="../../da/d86/RunData_8h.html">RunData.h</a></div></div>
<div class="ttc" id="corsika__icarus_8fcl_html_ab93e705c5d934e7777f11582689b7e1f"><div class="ttname"><a href="../../dc/db0/corsika__icarus_8fcl.html#ab93e705c5d934e7777f11582689b7e1f">db</a></div><div class="ttdeci">height to which particles are projected pnfs larsoft persistent physics cosmics Fermilab CORSIKA standard He_showers_ * db</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/corsika__icarus_8fcl_source.html#l00039">corsika_icarus.fcl:39</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="structPartGenParam_html_a7cfb854791d484f4ba6fb4b479a0cb57"><div class="ttname"><a href="../../de/d2a/structPartGenParam.html#a7cfb854791d484f4ba6fb4b479a0cb57">PartGenParam::multi</a></div><div class="ttdeci">std::array&lt; size_t, 2 &gt; multi</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00038">MultiPartRain_module.cc:38</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a6a3dafeef1a85f85b275b3f8ebf4dcbd"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a6a3dafeef1a85f85b275b3f8ebf4dcbd">MultiPartRain::_debug</a></div><div class="ttdeci">unsigned short _debug</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00100">MultiPartRain_module.cc:100</a></div></div>
<div class="ttc" id="classMultiPartRain_html_a794aef72f45e141a4849decb4023f17d"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#a794aef72f45e141a4849decb4023f17d">MultiPartRain::abort</a></div><div class="ttdeci">void abort(const std::string msg) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00103">MultiPartRain_module.cc:103</a></div></div>
<div class="ttc" id="classMultiPartRain_html_afc8bfdb718a8f4e99a65476c368e49f0"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#afc8bfdb718a8f4e99a65476c368e49f0">MultiPartRain::GenParticles</a></div><div class="ttdeci">std::vector&lt; size_t &gt; GenParticles() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00295">MultiPartRain_module.cc:295</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classMultiPartRain_html_af2c1a1f9251258024df37c5ccb7cb552"><div class="ttname"><a href="../../d4/d55/classMultiPartRain.html#af2c1a1f9251258024df37c5ccb7cb552">MultiPartRain::_tpc_v</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned short &gt; &gt; _tpc_v</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5a/MultiPartRain__module_8cc_source.html#l00093">MultiPartRain_module.cc:93</a></div></div>
<div class="ttc" id="classsumdata_1_1RunData_html"><div class="ttname"><a href="../../d4/de1/classsumdata_1_1RunData.html">sumdata::RunData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d86/RunData_8h_source.html#l00015">RunData.h:15</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
