<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>larg4::OpFastScintillation Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d7/d6f/namespacelarg4.html">larg4</a></li><li class="navelem"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html">OpFastScintillation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d3/d95/classlarg4_1_1OpFastScintillation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">larg4::OpFastScintillation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for larg4::OpFastScintillation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d8/da8/classlarg4_1_1OpFastScintillation.png" usemap="#larg4::OpFastScintillation_map" alt=""/>
  <map id="larg4::OpFastScintillation_map" name="larg4::OpFastScintillation_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html">Dims</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d61/structlarg4_1_1OpFastScintillation_1_1OpticalDetector.html">OpticalDetector</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9592440366ee70f00e44854b6c1f247d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9592440366ee70f00e44854b6c1f247d">OpFastScintillation</a> (const G4String &amp;processName=&quot;Scintillation&quot;, G4ProcessType <a class="el" href="../../d9/da0/structtype.html">type</a>=fElectromagnetic)</td></tr>
<tr class="separator:a9592440366ee70f00e44854b6c1f247d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa71c13b426fc5506ddaf48d37d07731b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa71c13b426fc5506ddaf48d37d07731b">~OpFastScintillation</a> ()</td></tr>
<tr class="separator:aa71c13b426fc5506ddaf48d37d07731b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ecae910924fb15418d0a67e081a55c"><td class="memItemLeft" align="right" valign="top">virtual G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae2ecae910924fb15418d0a67e081a55c">IsApplicable</a> (const G4ParticleDefinition &amp;aParticleType)</td></tr>
<tr class="separator:ae2ecae910924fb15418d0a67e081a55c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf94bf52ee86abfe3bb54ac09254eb01"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acf94bf52ee86abfe3bb54ac09254eb01">GetMeanFreePath</a> (const G4Track &amp;aTrack, G4double, G4ForceCondition *)</td></tr>
<tr class="separator:acf94bf52ee86abfe3bb54ac09254eb01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dda88dd1ed0bf3a20d7d27e35fed076"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7dda88dd1ed0bf3a20d7d27e35fed076">GetMeanLifeTime</a> (const G4Track &amp;aTrack, G4ForceCondition *)</td></tr>
<tr class="separator:a7dda88dd1ed0bf3a20d7d27e35fed076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630668b55faf8fd7231e028d5435a6b9"><td class="memItemLeft" align="right" valign="top">virtual G4VParticleChange *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a630668b55faf8fd7231e028d5435a6b9">PostStepDoIt</a> (const G4Track &amp;aTrack, const G4Step &amp;aStep)</td></tr>
<tr class="separator:a630668b55faf8fd7231e028d5435a6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67180d32e39d25c79d7a968d2a7714f9"><td class="memItemLeft" align="right" valign="top">virtual G4VParticleChange *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a67180d32e39d25c79d7a968d2a7714f9">AtRestDoIt</a> (const G4Track &amp;aTrack, const G4Step &amp;aStep)</td></tr>
<tr class="separator:a67180d32e39d25c79d7a968d2a7714f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c474b8018bca3d7eac0aaf78302acc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a92c474b8018bca3d7eac0aaf78302acc">SetTrackSecondariesFirst</a> (const G4bool state)</td></tr>
<tr class="separator:a92c474b8018bca3d7eac0aaf78302acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718cbd5149e67598da3959762e33bb5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a718cbd5149e67598da3959762e33bb5d">SetFiniteRiseTime</a> (const G4bool state)</td></tr>
<tr class="separator:a718cbd5149e67598da3959762e33bb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066c9dcaa558cd204e61bd6bd632e36a"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a066c9dcaa558cd204e61bd6bd632e36a">GetTrackSecondariesFirst</a> () const </td></tr>
<tr class="separator:a066c9dcaa558cd204e61bd6bd632e36a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453822bae262478f564459c724fc7a79"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a453822bae262478f564459c724fc7a79">GetFiniteRiseTime</a> () const </td></tr>
<tr class="separator:a453822bae262478f564459c724fc7a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf8e02aaaeaa11f1b504cc4be6867e0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#abf8e02aaaeaa11f1b504cc4be6867e0c">SetScintillationYieldFactor</a> (const G4double yieldfactor)</td></tr>
<tr class="separator:abf8e02aaaeaa11f1b504cc4be6867e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b6f90c2384f50eca4638c9a959bcff"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a95b6f90c2384f50eca4638c9a959bcff">GetScintillationYieldFactor</a> () const </td></tr>
<tr class="separator:a95b6f90c2384f50eca4638c9a959bcff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bd403f4950cb4293aeb7f1758c5956"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a97bd403f4950cb4293aeb7f1758c5956">SetScintillationExcitationRatio</a> (const G4double excitationratio)</td></tr>
<tr class="separator:a97bd403f4950cb4293aeb7f1758c5956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da1ce87f8696d08ec043080784a6ed1"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1da1ce87f8696d08ec043080784a6ed1">GetScintillationExcitationRatio</a> () const </td></tr>
<tr class="separator:a1da1ce87f8696d08ec043080784a6ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb6e92550ce65018427fa5c2626a6f9"><td class="memItemLeft" align="right" valign="top">G4PhysicsTable *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#abdb6e92550ce65018427fa5c2626a6f9">GetFastIntegralTable</a> () const </td></tr>
<tr class="separator:abdb6e92550ce65018427fa5c2626a6f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ed84a341704afc71c18dba5a81dd0c"><td class="memItemLeft" align="right" valign="top">G4PhysicsTable *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad7ed84a341704afc71c18dba5a81dd0c">GetSlowIntegralTable</a> () const </td></tr>
<tr class="separator:ad7ed84a341704afc71c18dba5a81dd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2d80b31636c407b0a09c7f65889cd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4f2d80b31636c407b0a09c7f65889cd9">AddSaturation</a> (G4EmSaturation *sat)</td></tr>
<tr class="separator:a4f2d80b31636c407b0a09c7f65889cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e698f56af8b30beb9cd5d184fda6ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a80e698f56af8b30beb9cd5d184fda6ee">RemoveSaturation</a> ()</td></tr>
<tr class="separator:a80e698f56af8b30beb9cd5d184fda6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf7a03d3514cc60f83cc6145bc0e209"><td class="memItemLeft" align="right" valign="top">G4EmSaturation *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7cf7a03d3514cc60f83cc6145bc0e209">GetSaturation</a> () const </td></tr>
<tr class="separator:a7cf7a03d3514cc60f83cc6145bc0e209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c2959e073ec328528a0d266b3dfcbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa0c2959e073ec328528a0d266b3dfcbe">SetScintillationByParticleType</a> (const G4bool)</td></tr>
<tr class="separator:aa0c2959e073ec328528a0d266b3dfcbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1e83595b2c1b230877efd434334e38"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6b1e83595b2c1b230877efd434334e38">GetScintillationByParticleType</a> () const </td></tr>
<tr class="separator:a6b1e83595b2c1b230877efd434334e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0fc947d918d98f900772ecc34124734"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa0fc947d918d98f900772ecc34124734">DumpPhysicsTable</a> () const </td></tr>
<tr class="separator:aa0fc947d918d98f900772ecc34124734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd7c56451b5f94eb75a96e12dcef651"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cd7c56451b5f94eb75a96e12dcef651">getVUVTimes</a> (std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</td></tr>
<tr class="separator:a0cd7c56451b5f94eb75a96e12dcef651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e18bdfefefd4285bc885a75c8138dff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e18bdfefefd4285bc885a75c8138dff">generateParam</a> (const size_t index, const size_t angle_bin)</td></tr>
<tr class="separator:a3e18bdfefefd4285bc885a75c8138dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84ba80af002d91417fb2266c95a598c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae84ba80af002d91417fb2266c95a598c">getVISTimes</a> (std::vector&lt; double &gt; &amp;arrivalTimes, const TVector3 &amp;ScintPoint, const TVector3 &amp;OpDetPoint)</td></tr>
<tr class="separator:ae84ba80af002d91417fb2266c95a598c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ddbf2ecd690f04d2ca60ca29498ec16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ddbf2ecd690f04d2ca60ca29498ec16">detectedDirectHits</a> (std::map&lt; size_t, int &gt; &amp;DetectedNum, const double Num, <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint) const </td></tr>
<tr class="separator:a8ddbf2ecd690f04d2ca60ca29498ec16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50926aab8f0a269cc3f8d0bb8120d933"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a50926aab8f0a269cc3f8d0bb8120d933">detectedReflecHits</a> (std::map&lt; size_t, int &gt; &amp;ReflDetectedNum, const double Num, <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint) const </td></tr>
<tr class="separator:a50926aab8f0a269cc3f8d0bb8120d933"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aba3299f209b0f95616219b70ca03833a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aba3299f209b0f95616219b70ca03833a">BuildThePhysicsTable</a> ()</td></tr>
<tr class="separator:aba3299f209b0f95616219b70ca03833a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647336b4bc721eff8745d41d52e70320"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a647336b4bc721eff8745d41d52e70320">RecordPhotonsProduced</a> (const G4Step &amp;aStep, double <a class="el" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>)</td></tr>
<tr class="separator:a647336b4bc721eff8745d41d52e70320"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a064dc724b2899db0b59c75d9ea6e4b7c"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; G4PhysicsTable &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a></td></tr>
<tr class="separator:a064dc724b2899db0b59c75d9ea6e4b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aade9c725e09500c55a71743d5b1bf806"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; G4PhysicsTable &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a></td></tr>
<tr class="separator:aade9c725e09500c55a71743d5b1bf806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da3e7ccf57e91bb3378d29cb27cdaee"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">fTrackSecondariesFirst</a></td></tr>
<tr class="separator:a8da3e7ccf57e91bb3378d29cb27cdaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae878469b0e42918cb9816f410c34a58f"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a></td></tr>
<tr class="separator:ae878469b0e42918cb9816f410c34a58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bd26b19a7037ed64fbc6970d9d7770"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">YieldFactor</a></td></tr>
<tr class="separator:ac2bd26b19a7037ed64fbc6970d9d7770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76852aeab9621ed43645e8c559c8b022"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a></td></tr>
<tr class="separator:a76852aeab9621ed43645e8c559c8b022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ffae6dd0169c1cb290f05f1b2782d4"><td class="memItemLeft" align="right" valign="top">G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a></td></tr>
<tr class="separator:a96ffae6dd0169c1cb290f05f1b2782d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8ce91426a2e9ffeb4ff14a4bca0f2519"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a> () const </td></tr>
<tr class="memdesc:a8ce91426a2e9ffeb4ff14a4bca0f2519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the semi-analytic visibility parametrization is being used.  <a href="#a8ce91426a2e9ffeb4ff14a4bca0f2519">More...</a><br/></td></tr>
<tr class="separator:a8ce91426a2e9ffeb4ff14a4bca0f2519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8721e1342d192025d3bc7320aeedcc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8721e1342d192025d3bc7320aeedcc3">VUVHits</a> (const double Nphotons_created, <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint, <a class="el" href="../../d0/d61/structlarg4_1_1OpFastScintillation_1_1OpticalDetector.html">OpticalDetector</a> const &amp;opDet) const </td></tr>
<tr class="separator:ac8721e1342d192025d3bc7320aeedcc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d1cae90d2db03f8af7a7745e676e41"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8d1cae90d2db03f8af7a7745e676e41">VISHits</a> (<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint, <a class="el" href="../../d0/d61/structlarg4_1_1OpFastScintillation_1_1OpticalDetector.html">OpticalDetector</a> const &amp;opDet, const double cathode_hits_rec, const <a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; hotspot) const </td></tr>
<tr class="separator:ac8d1cae90d2db03f8af7a7745e676e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261eb530f9cc114884f8524c7fbb489d"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a261eb530f9cc114884f8524c7fbb489d">single_exp</a> (const G4double t, const G4double tau2) const </td></tr>
<tr class="separator:a261eb530f9cc114884f8524c7fbb489d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea57f26d674500fbafa01f690344f88"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1ea57f26d674500fbafa01f690344f88">bi_exp</a> (const G4double t, const G4double tau1, const G4double tau2) const </td></tr>
<tr class="separator:a1ea57f26d674500fbafa01f690344f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac268e718c4272ba70f59249ce2f4d1c7"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac268e718c4272ba70f59249ce2f4d1c7">scint_time</a> (const G4Step &amp;aStep, G4double ScintillationTime, G4double ScintillationRiseTime) const </td></tr>
<tr class="separator:ac268e718c4272ba70f59249ce2f4d1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ea1001348191bda5f3708042b2d0aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84ea1001348191bda5f3708042b2d0aa">propagationTime</a> (std::vector&lt; double &gt; &amp;arrival_time_dist, G4ThreeVector x0, const size_t OpChannel, <a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> Reflected=<a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a>)</td></tr>
<tr class="separator:a84ea1001348191bda5f3708042b2d0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab48ce5a5e51491782ece2423af6c52b5"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab48ce5a5e51491782ece2423af6c52b5">sample_time</a> (const G4double tau1, const G4double tau2) const </td></tr>
<tr class="separator:ab48ce5a5e51491782ece2423af6c52b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a9e45eb46a2f325c0b85dba8e43fa7e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9a9e45eb46a2f325c0b85dba8e43fa7e">reemission_energy</a> () const </td></tr>
<tr class="separator:a9a9e45eb46a2f325c0b85dba8e43fa7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce84220570f42dca9aef2116444ce7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#abce84220570f42dca9aef2116444ce7d">average_position</a> (G4Step const &amp;aStep, double *xzyPos) const </td></tr>
<tr class="separator:abce84220570f42dca9aef2116444ce7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fd540bc6b6a8f667c11a01c914ad89c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a> (const double <a class="el" href="../../d1/d82/OnlineDecoder_8fcl.html#a99b093ee2be2d37375506bb99fb5ea75">a</a>, const double b, const double d) const </td></tr>
<tr class="separator:a3fd540bc6b6a8f667c11a01c914ad89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5535e4150f4a6528aa6a80db1066573e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5535e4150f4a6528aa6a80db1066573e">Rectangle_SolidAngle</a> (<a class="el" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html">Dims</a> const &amp;o, const <a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; v) const </td></tr>
<tr class="separator:a5535e4150f4a6528aa6a80db1066573e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc790f6bda764b63c5467ca650d996ac"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acc790f6bda764b63c5467ca650d996ac">Disk_SolidAngle</a> (const double d, const double <a class="el" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>, const double b) const </td></tr>
<tr class="separator:acc790f6bda764b63c5467ca650d996ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8bcfdaaeea917bfd16f95671d45da1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8bcfdaaeea917bfd16f95671d45da1">Omega_Dome_Model</a> (const double distance, const double theta) const </td></tr>
<tr class="separator:a1c8bcfdaaeea917bfd16f95671d45da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c56e09c6f8efb51bbe8f4a770d84c4"><td class="memItemLeft" align="right" valign="top">G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab7c56e09c6f8efb51bbe8f4a770d84c4">Gaisser_Hillas</a> (const double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, const double *par) const </td></tr>
<tr class="separator:ab7c56e09c6f8efb51bbe8f4a770d84c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94c040f0c06732a61c6a21e296cc60d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad94c040f0c06732a61c6a21e296cc60d">ProcessStep</a> (const G4Step &amp;step)</td></tr>
<tr class="separator:ad94c040f0c06732a61c6a21e296cc60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ddf47e1ef56bfe5449e119604e63465"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">isOpDetInSameTPC</a> (<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint, <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;OpDetPoint) const </td></tr>
<tr class="separator:a9ddf47e1ef56bfe5449e119604e63465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a7e6435cb535cec2ecd110f6d8a1e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa8a7e6435cb535cec2ecd110f6d8a1e5">isScintInActiveVolume</a> (<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;ScintPoint)</td></tr>
<tr class="separator:aa8a7e6435cb535cec2ecd110f6d8a1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d54689d66686566526adb0bc2fb6ecf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a> (const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, <a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> extrapolate, size_t i=0) const </td></tr>
<tr class="separator:a5d54689d66686566526adb0bc2fb6ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b1c3f11842b0a9a92fd0c136f046d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a20b1c3f11842b0a9a92fd0c136f046d4">interpolate3</a> (<a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; &amp;inter, const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData1, const std::vector&lt; double &gt; &amp;yData2, const std::vector&lt; double &gt; &amp;yData3, double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, <a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> extrapolate) const </td></tr>
<tr class="separator:a20b1c3f11842b0a9a92fd0c136f046d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a02bce31fa194e7e6b33d3673464ed231"><td class="memItemLeft" align="right" valign="top">static std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a02bce31fa194e7e6b33d3673464ed231">extractActiveVolumes</a> (<a class="el" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> const &amp;geom)</td></tr>
<tr class="separator:a02bce31fa194e7e6b33d3673464ed231"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab9fcea92a722f1e4569db0df3c96bf0b"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a></td></tr>
<tr class="separator:ab9fcea92a722f1e4569db0df3c96bf0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac9f56ab984f0fbd014183350575ffcc"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; CLHEP::RandGeneral &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aac9f56ab984f0fbd014183350575ffcc">fTPBEm</a></td></tr>
<tr class="separator:aac9f56ab984f0fbd014183350575ffcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30492b68ed1ae863f668dd713d870101"><td class="memItemLeft" align="right" valign="top">G4EmSaturation *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a></td></tr>
<tr class="separator:a30492b68ed1ae863f668dd713d870101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22593277a1ca27ab95c98e70e50b800c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d7c/namespacephot.html#ac2dd130b2751833e36c3825a60ba891b">phot::MappedFunctions_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">ParPropTimeTF1</a></td></tr>
<tr class="separator:a22593277a1ca27ab95c98e70e50b800c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac06190fa1fced63c3464db9b08a348"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d7c/namespacephot.html#a5db42c0ec04a6dda89181a67fee78170">phot::MappedT0s_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaac06190fa1fced63c3464db9b08a348">ReflT0s</a></td></tr>
<tr class="separator:aaac06190fa1fced63c3464db9b08a348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f187b0d853cf7833b81e52bdf7e0f6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a></td></tr>
<tr class="separator:a52f187b0d853cf7833b81e52bdf7e0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af37aae991c13fdd84d0e445e1013d465"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a></td></tr>
<tr class="separator:af37aae991c13fdd84d0e445e1013d465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae797b001bd6fd0f7a49d74f8b0b4dfe3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae797b001bd6fd0f7a49d74f8b0b4dfe3">fmax_d</a></td></tr>
<tr class="separator:ae797b001bd6fd0f7a49d74f8b0b4dfe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7841a3917307d6c44157ea99738bc7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">fvuv_vgroup_mean</a></td></tr>
<tr class="separator:a8c7841a3917307d6c44157ea99738bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93522458cf3401e99459b4973ad08a31"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">fvuv_vgroup_max</a></td></tr>
<tr class="separator:a93522458cf3401e99459b4973ad08a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b19869980094466af92423dddeeec3a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9b19869980094466af92423dddeeec3a">finflexion_point_distance</a></td></tr>
<tr class="separator:a9b19869980094466af92423dddeeec3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84145a771638c07c31d6f38242c4494c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">fangle_bin_timing_vuv</a></td></tr>
<tr class="separator:a84145a771638c07c31d6f38242c4494c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19a03db803a0acb4e9510076e8c585d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a> [7]</td></tr>
<tr class="separator:ad19a03db803a0acb4e9510076e8c585d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7035b4befbb801111de32c5959b45d89"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TF1 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">VUV_timing</a></td></tr>
<tr class="separator:a7035b4befbb801111de32c5959b45d89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78a8761b4bd4dec065441cb0d0a2070"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">VUV_max</a></td></tr>
<tr class="separator:aa78a8761b4bd4dec065441cb0d0a2070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ddb7228bb686dd9ba2e982878224cef"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">VUV_min</a></td></tr>
<tr class="separator:a5ddb7228bb686dd9ba2e982878224cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd58061960591a845c7530428d6e2425"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">fvis_vmean</a></td></tr>
<tr class="separator:acd58061960591a845c7530428d6e2425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a944dc6ab3e7ee8ae1e1df70f274a7934"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a944dc6ab3e7ee8ae1e1df70f274a7934">fangle_bin_timing_vis</a></td></tr>
<tr class="separator:a944dc6ab3e7ee8ae1e1df70f274a7934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636af825c7b0490efcc2d361377f990c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">fdistances_refl</a></td></tr>
<tr class="separator:a636af825c7b0490efcc2d361377f990c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e967540da71175904e177bcaa19603"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">fradial_distances_refl</a></td></tr>
<tr class="separator:a81e967540da71175904e177bcaa19603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e21019631a04a7f22c3b0aaf6f79bd3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">fcut_off_pars</a></td></tr>
<tr class="separator:a3e21019631a04a7f22c3b0aaf6f79bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec108b3daf6f1aed81abff6459ece66"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">ftau_pars</a></td></tr>
<tr class="separator:a0ec108b3daf6f1aed81abff6459ece66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb621a844af899a684aa828f0f786a2c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afb621a844af899a684aa828f0f786a2c">fdelta_angulo_vuv</a></td></tr>
<tr class="separator:afb621a844af899a684aa828f0f786a2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea945e24a8395eb19ac877970c835f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a></td></tr>
<tr class="separator:a7ea945e24a8395eb19ac877970c835f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12464241f0ae6056ca4864e6e2cddcbb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a></td></tr>
<tr class="separator:a12464241f0ae6056ca4864e6e2cddcbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae56165035186723b8d79b16c244bdd7b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a></td></tr>
<tr class="separator:ae56165035186723b8d79b16c244bdd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb8239fa328e1717ba5c69fd50273ca"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a></td></tr>
<tr class="separator:a3bb8239fa328e1717ba5c69fd50273ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6d69c230148f61e69e62c45c49b292"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a></td></tr>
<tr class="separator:a6a6d69c230148f61e69e62c45c49b292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e569f857c4b4d5139d9325d9bb3349b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a></td></tr>
<tr class="separator:a5e569f857c4b4d5139d9325d9bb3349b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ec975734345c521e013a2e16d68e3d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">fborder_corr_angulo_dome</a></td></tr>
<tr class="separator:af3ec975734345c521e013a2e16d68e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db520f0f99b5f5c1b7575b74ae7ec8f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">fborder_corr_dome</a></td></tr>
<tr class="separator:a3db520f0f99b5f5c1b7575b74ae7ec8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51aff7f60f22299ad11b43f0108c262b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a51aff7f60f22299ad11b43f0108c262b">fStoreReflected</a></td></tr>
<tr class="separator:a51aff7f60f22299ad11b43f0108c262b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0751805825b8a27dacfbe6177fee770"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad0751805825b8a27dacfbe6177fee770">fdelta_angulo_vis</a></td></tr>
<tr class="separator:ad0751805825b8a27dacfbe6177fee770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8784560c1c79f93a372e16f2ce4adee7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a></td></tr>
<tr class="separator:a8784560c1c79f93a372e16f2ce4adee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3705b34ffa34651aec27841f907bf82"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad3705b34ffa34651aec27841f907bf82">fvis_distances_r_flat</a></td></tr>
<tr class="separator:ad3705b34ffa34651aec27841f907bf82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff75d10959edf1d09ca83bd149cbaea"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">fvispars_flat</a></td></tr>
<tr class="separator:aaff75d10959edf1d09ca83bd149cbaea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea78d33e76362e20533d8041204d1eb5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a></td></tr>
<tr class="separator:aea78d33e76362e20533d8041204d1eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8a307d8e0be43367314badf2fb033e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8a307d8e0be43367314badf2fb033e">fvis_distances_r_dome</a></td></tr>
<tr class="separator:a1c8a307d8e0be43367314badf2fb033e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20cf552f2a1bee81d366bab436abbee"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">fvispars_dome</a></td></tr>
<tr class="separator:af20cf552f2a1bee81d366bab436abbee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0563fa0f8189dd11d735beeb289f436c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a></td></tr>
<tr class="separator:a0563fa0f8189dd11d735beeb289f436c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a38294b1c5c68bc3c817f5b0716fb83"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7a38294b1c5c68bc3c817f5b0716fb83">fcathode_zdimension</a></td></tr>
<tr class="separator:a7a38294b1c5c68bc3c817f5b0716fb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c41b3a9dd7c8cfa15fa381bd19f91e9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5c41b3a9dd7c8cfa15fa381bd19f91e9">fcathode_ydimension</a></td></tr>
<tr class="separator:a5c41b3a9dd7c8cfa15fa381bd19f91e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c3322018a751c9dc8dde377c676322a"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a></td></tr>
<tr class="separator:a4c3322018a751c9dc8dde377c676322a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c08417aab17cdfc0d15258c1914a7e"><td class="memItemLeft" align="right" valign="top">std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> &gt; const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a></td></tr>
<tr class="separator:ac0c08417aab17cdfc0d15258c1914a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbacbb2ba255f4f2c831a8e22a944225"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a></td></tr>
<tr class="separator:afbacbb2ba255f4f2c831a8e22a944225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1cabc60fa3b993b146001098cd128b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html">Dims</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">fcathode_plane</a></td></tr>
<tr class="separator:afd1cabc60fa3b993b146001098cd128b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3674409d5d75236a9c79413b02ae2f10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">fL_abs_vuv</a></td></tr>
<tr class="separator:a3674409d5d75236a9c79413b02ae2f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9133f6ec2aad11f06c6450b31d10081f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a></td></tr>
<tr class="separator:a9133f6ec2aad11f06c6450b31d10081f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b293604d22ea91a66e9e51284d3043f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a></td></tr>
<tr class="separator:a0b293604d22ea91a66e9e51284d3043f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c9da7eeb8335d6c50a7c3711f8978e9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a></td></tr>
<tr class="separator:a1c9da7eeb8335d6c50a7c3711f8978e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28584b8a2ba4bed4f379447c8822422e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a></td></tr>
<tr class="separator:a28584b8a2ba4bed4f379447c8822422e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4253237e0ebc8dab74a4f5e2bb8c2124"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">bPropagate</a></td></tr>
<tr class="memdesc:a4253237e0ebc8dab74a4f5e2bb8c2124"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether propagation of photons is enabled.  <a href="#a4253237e0ebc8dab74a4f5e2bb8c2124">More...</a><br/></td></tr>
<tr class="separator:a4253237e0ebc8dab74a4f5e2bb8c2124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d0364f20281bcc4b3f41784335f3ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html">phot::PhotonVisibilityService</a> <br class="typebreak"/>
const *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a></td></tr>
<tr class="memdesc:a00d0364f20281bcc4b3f41784335f3ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Photon visibility service instance.  <a href="#a00d0364f20281bcc4b3f41784335f3ed">More...</a><br/></td></tr>
<tr class="separator:a00d0364f20281bcc4b3f41784335f3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb9ba23f6ef377b0cc5d260372dc8e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cb9ba23f6ef377b0cc5d260372dc8e6">fUseNhitsModel</a> = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td></tr>
<tr class="memdesc:a0cb9ba23f6ef377b0cc5d260372dc8e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the semi-analytic model is being used for photon visibility.  <a href="#a0cb9ba23f6ef377b0cc5d260372dc8e6">More...</a><br/></td></tr>
<tr class="separator:a0cb9ba23f6ef377b0cc5d260372dc8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c053e17d850120cd4fe2823d884063"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">fOnlyActiveVolume</a> = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td></tr>
<tr class="memdesc:ab3c053e17d850120cd4fe2823d884063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether photon propagation is performed only from active volumes.  <a href="#ab3c053e17d850120cd4fe2823d884063">More...</a><br/></td></tr>
<tr class="separator:ab3c053e17d850120cd4fe2823d884063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af470b4fa2aa4d1a63dd1969235e0ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5af470b4fa2aa4d1a63dd1969235e0ec">fOnlyOneCryostat</a> = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td></tr>
<tr class="separator:a5af470b4fa2aa4d1a63dd1969235e0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4bd5196829b1a1ac8ce863091fedb53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa4bd5196829b1a1ac8ce863091fedb53">fOpaqueCathode</a> = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td></tr>
<tr class="memdesc:aa4bd5196829b1a1ac8ce863091fedb53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the cathodes are fully opaque; currently hard coded "no".  <a href="#aa4bd5196829b1a1ac8ce863091fedb53">More...</a><br/></td></tr>
<tr class="separator:aa4bd5196829b1a1ac8ce863091fedb53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00130">130</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9592440366ee70f00e44854b6c1f247d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">larg4::OpFastScintillation::OpFastScintillation </td>
          <td>(</td>
          <td class="paramtype">const G4String &amp;&#160;</td>
          <td class="paramname"><em>processName</em> = <code>&quot;Scintillation&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ProcessType&#160;</td>
          <td class="paramname"><em>type</em> = <code>fElectromagnetic</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00180">180</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    : G4VRestDiscreteProcess(processName, <a class="code" href="../../d9/da0/structtype.html">type</a>)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    , <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>{<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a02bce31fa194e7e6b33d3673464ed231">extractActiveVolumes</a>(*(lar::providerFrom&lt;geo::Geometry&gt;()))}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    , <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">bPropagate</a>(!(art::ServiceHandle&lt;sim::LArG4Parameters const&gt;()-&gt;NoPhotonPropagation()))</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    , <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">bPropagate</a> ? art::ServiceHandle&lt;phot::PhotonVisibilityService const&gt;().<span class="keyword">get</span>() : <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    , <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cb9ba23f6ef377b0cc5d260372dc8e6">fUseNhitsModel</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a> &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aca0562070b5646b986bad33c5f806411">UseNhitsModel</a>())</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// for now, limit to the active volume only if semi-analytic model is used</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    , <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">fOnlyActiveVolume</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>())</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    SetProcessSubType(25); <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">fTrackSecondariesFirst</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">YieldFactor</a> = 1.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a> = 1.0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../dc/d37/classdetinfo_1_1LArProperties.html">detinfo::LArProperties</a>* larp = lar::providerFrom&lt;detinfo::LArPropertiesService&gt;();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a> = larp-&gt;<a class="code" href="../../dc/d37/classdetinfo_1_1LArProperties.html#a5090ca3ff2294af77a193d2714be3557">ScintByParticleType</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (verboseLevel &gt; 0) { G4cout &lt;&lt; GetProcessName() &lt;&lt; <span class="stringliteral">&quot; is created &quot;</span> &lt;&lt; G4endl; }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aba3299f209b0f95616219b70ca03833a">BuildThePhysicsTable</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a> = NULL;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">bPropagate</a>) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      assert(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="comment">// Loading the position of each optical channel, neccessary for the parametrizatiuons of Nhits and prop-time</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> <span class="keyword">const</span>&amp; geom = *(lar::providerFrom&lt;geo::Geometry&gt;());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keyword">auto</span> log = mf::LogTrace(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;OpFastScintillation: active volume boundaries from &quot;</span> &lt;&lt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>.size()</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; volumes:&quot;</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [iCryo, box] : <a class="code" href="../../d6/d72/namespaceutil.html#af0615b7538ff948ea65d5206a23c84f2">util::enumerate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>)) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          log &lt;&lt; <span class="stringliteral">&quot;\n - C:&quot;</span> &lt;&lt; iCryo &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; box.Min() &lt;&lt; <span class="stringliteral">&quot; -- &quot;</span> &lt;&lt; box.Max() &lt;&lt; <span class="stringliteral">&quot; cm&quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        } <span class="comment">// for</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;\n  (scintillation photons are propagated &quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            &lt;&lt; (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">fOnlyActiveVolume</a> ? <span class="stringliteral">&quot;only from active volumes&quot;</span> : <span class="stringliteral">&quot;from anywhere&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      } <span class="comment">// local scope</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>() &amp;&amp; (geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>() &gt; 1U)) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5af470b4fa2aa4d1a63dd1969235e0ec">fOnlyOneCryostat</a>) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          mf::LogWarning(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            &lt;&lt; std::string(80, <span class="charliteral">&#39;=&#39;</span>) &lt;&lt; <span class="stringliteral">&quot;\nA detector with &quot;</span> &lt;&lt; geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>()</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; cryostats is configured&quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; , and semi-analytic model is requested for scintillation photon propagation.&quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; THIS CONFIGURATION IS NOT SUPPORTED and it is open to bugs&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; (e.g. scintillation may be detected only in cryostat #0).&quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nThis would be normally a fatal error, but it has been forcibly overridden.&quot;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            &lt;&lt; std::string(80, <span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <span class="keywordflow">throw</span> art::Exception(art::errors::Configuration)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Photon propagation via semi-analytic model is not supported yet&quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; on detectors with more than one cryostat.&quot;</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      } <span class="comment">// if</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span> Cathode_centre{geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(0, 0).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">GetCathodeCenter</a>().X(),</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].CenterY(),</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].CenterZ()};</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      mf::LogTrace(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Cathode_centre: &quot;</span> &lt;&lt; Cathode_centre &lt;&lt; <span class="stringliteral">&quot; cm&quot;</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;\nInitialize acos_arr with &quot; &lt;&lt; acos_bins+1</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">//           &lt;&lt; &quot; hence with a resolution of &quot; &lt;&lt; 1./acos_bins &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// for(size_t i=0; i&lt;=acos_bins; ++i){</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">//   acos_arr[i] = std::acos(i/double(acos_bins));</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">// }</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> i : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">NOpChannels</a>())) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html">geo::OpDetGeo</a> <span class="keyword">const</span>&amp; opDet = geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">OpDetGeoFromOpDet</a>(i);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.push_back(opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a0a09bf2d6710fe7ce6fe42416a2d13f9">GetCenter</a>());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (dynamic_cast&lt;TGeoSphere const*&gt;(opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7df92063c04f75d821e97f2b275ef193">Shape</a>()) != <span class="keyword">nullptr</span>) {  <span class="comment">// sphere/dome</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a>.push_back(1); <span class="comment">// Dome PMTs</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a>.push_back(-1);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a>.push_back(-1);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7dd253348db6b605f8c324a0624ee311">isBar</a>()) {  <span class="comment">// box</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a>.push_back(0); <span class="comment">//Arapucas</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a>.push_back(opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a99581ce607905340d1b3a83f236a0c60">Length</a>());</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a>.push_back(opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#ae3261a6a3db55fa07cf04775f98c2edf">Height</a>());</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">else</span> {  <span class="comment">// disk</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a>.push_back(2); <span class="comment">// Disk PMTs</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <span class="comment">//    std::cout&lt;&lt;&quot;Radio: &quot;&lt;&lt;geom.OpDetGeoFromOpDet(i).RMax()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a>.push_back(-1);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a>.push_back(-1);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aab173e0567c088a08bb3345716b315ae">IncludePropTime</a>()) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Using parameterisation of timings.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">//OLD VUV time parapetrization (to be removed soon)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">//fPVS-&gt;SetDirectLightPropFunctions(functions_vuv, fd_break, fd_max, ftf1_sampling_factor);</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">//fPVS-&gt;SetReflectedCOLightPropFunctions(functions_vis, ft0_max, ft0_break_point);</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">//New VUV time parapetrization</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ad710b749fc331f27fd47974d256d8802">LoadTimingsForVUVPar</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae797b001bd6fd0f7a49d74f8b0b4dfe3">fmax_d</a>,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">fvuv_vgroup_mean</a>,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">fvuv_vgroup_max</a>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9b19869980094466af92423dddeeec3a">finflexion_point_distance</a>,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                   <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">fangle_bin_timing_vuv</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// create vector of empty TF1s that will be replaces with the parameterisations that are generated as they are required</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// default TF1() constructor gives function with 0 dimensions, can then check numDim to qucikly see if a parameterisation has been generated</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_params = (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae797b001bd6fd0f7a49d74f8b0b4dfe3">fmax_d</a> - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>) / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a>; <span class="comment">// for d &lt; fmin_d, no parameterisaton, a delta function is used instead</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">size_t</span> num_angles = std::round(90/<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">fangle_bin_timing_vuv</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">VUV_timing</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, TF1()));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// initialise vectors to contain range parameterisations sampled to in each case</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">// when using TF1-&gt;GetRandom(xmin,xmax), must be in same range otherwise sampling is regenerated, this is the slow part!</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">VUV_max</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, 0.0));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">VUV_min</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, 0.0));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// VIS time parameterisation</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">StoreReflected</a>()) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="comment">// load parameters</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a5c8a0b4299fb2aa9d9b584bf61602008">LoadTimingsForVISPar</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">fdistances_refl</a>,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">fradial_distances_refl</a>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">fcut_off_pars</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">ftau_pars</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">fvis_vmean</a>,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a944dc6ab3e7ee8ae1e1df70f274a7934">fangle_bin_timing_vis</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>()) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;OpFastScintillation: using semi-analytic model for number of hits&quot;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">// LAr absorption length in cm</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        std::map&lt;double, double&gt; abs_length_spectrum =</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          lar::providerFrom&lt;detinfo::LArPropertiesService&gt;()-&gt;<a class="code" href="../../d0/d11/larproperties_8fcl.html#a0461a6e4be96377f9cdf78b2fa5d343b">AbsLengthSpectrum</a>();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        std::vector&lt;double&gt; x_v, y_v;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> elem : abs_length_spectrum) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          x_v.push_back(elem.first);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          y_v.push_back(elem.second);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">fL_abs_vuv</a> =</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          std::round(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(x_v, y_v, 9.7, <span class="keyword">false</span>)); <span class="comment">// 9.7 eV: peak of VUV emission spectrum</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// Load Gaisser-Hillas corrections for VUV semi-analytic hits</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Loading the GH corrections&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#afa2dd5ee21442d40ada80f81062edd4a">LoadVUVSemiAnalyticProperties</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                            <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                            <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afb621a844af899a684aa828f0f786a2c">fdelta_angulo_vuv</a>,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                            <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                          );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a> &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Both isFlatPDCorr and isDomePDCorr parameters are false, at least one type of parameterisation is required for the semi-analytic light simulation.&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a2e76f14f03b46bd472f2f3b7fdde3172">LoadGHFlat</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                           <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                           <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                          );</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a080ba268e04c698861d92c84dd4a8cce">LoadGHDome</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a>,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                           <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">fborder_corr_angulo_dome</a>,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                           <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">fborder_corr_dome</a></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                          );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">// cathode center coordinates required for corrections</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a> = geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(0, 0).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">GetCathodeCenter</a>();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[1] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].CenterY();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[2] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].CenterZ(); <span class="comment">// to get full cathode dimension rather than just single tpc</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">StoreReflected</a>()) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a51aff7f60f22299ad11b43f0108c262b">fStoreReflected</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          <span class="comment">// Load corrections for VIS semi-anlytic hits</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Loading visible light corrections&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ae5c635540a660e049083e85db0707e45">LoadVisSemiAnalyticProperties</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad0751805825b8a27dacfbe6177fee770">fdelta_angulo_vis</a>,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                              <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                             );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a29f3b634f032d171850a230ae802c477">LoadVisParsFlat</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a>,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                  <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad3705b34ffa34651aec27841f907bf82">fvis_distances_r_flat</a>,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                  <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">fvispars_flat</a></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a419b08512c435f5fdd8317d783c87637">LoadVisParsDome</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                  <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8a307d8e0be43367314badf2fb033e">fvis_distances_r_dome</a>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                  <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">fvispars_dome</a></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                );</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="comment">// cathode dimensions</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5c41b3a9dd7c8cfa15fa381bd19f91e9">fcathode_ydimension</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].SizeY();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7a38294b1c5c68bc3c817f5b0716fb83">fcathode_zdimension</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].SizeZ();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          <span class="comment">// set cathode plane struct for solid angle function</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">fcathode_plane</a>.<a class="code" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html#a6ba84567487b571cc01b6a82fe33f767">h</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5c41b3a9dd7c8cfa15fa381bd19f91e9">fcathode_ydimension</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">fcathode_plane</a>.<a class="code" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html#a84cb1b2fc78aeee8dd8aaa4626054837">w</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7a38294b1c5c68bc3c817f5b0716fb83">fcathode_zdimension</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[0]);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a51aff7f60f22299ad11b43f0108c262b">fStoreReflected</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a> = lar::providerFrom&lt;detinfo::LArPropertiesService&gt;()-&gt;TpbEm();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    std::vector&lt;double&gt; parent;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    parent.reserve(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.size());</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.begin(); iter != <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.end(); ++iter) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      parent.push_back(iter-&gt;second);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aac9f56ab984f0fbd014183350575ffcc">fTPBEm</a> = std::make_unique&lt;CLHEP::RandGeneral&gt;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      (parent.data(), parent.size());</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html">geo::OpDetGeo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00043">OpDetGeo.h:43</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a5c8a0b4299fb2aa9d9b584bf61602008"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a5c8a0b4299fb2aa9d9b584bf61602008">phot::PhotonVisibilityService::LoadTimingsForVISPar</a></div><div class="ttdeci">void LoadTimingsForVISPar(std::vector&lt; double &gt; &amp;distances, std::vector&lt; double &gt; &amp;radial_distances, std::vector&lt; std::vector&lt; std::vector&lt; double &gt;&gt;&gt; &amp;cut_off, std::vector&lt; std::vector&lt; std::vector&lt; double &gt;&gt;&gt; &amp;tau, double &amp;vis_vmean, double &amp;angle_bin_timing_vis) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00775">PhotonVisibilityService_service.cc:775</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_aab173e0567c088a08bb3345716b315ae"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aab173e0567c088a08bb3345716b315ae">phot::PhotonVisibilityService::IncludePropTime</a></div><div class="ttdeci">bool IncludePropTime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00196">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:196</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af37aae991c13fdd84d0e445e1013d465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">larg4::OpFastScintillation::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classdetinfo_1_1LArProperties_html"><div class="ttname"><a href="../../dc/d37/classdetinfo_1_1LArProperties.html">detinfo::LArProperties</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d94/LArProperties_8h_source.html#l00020">LArProperties.h:20</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af20cf552f2a1bee81d366bab436abbee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">larg4::OpFastScintillation::fvispars_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fvispars_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00404">OpFastScintillation.hh:404</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a96ffae6dd0169c1cb290f05f1b2782d4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">larg4::OpFastScintillation::scintillationByParticleType</a></div><div class="ttdeci">G4bool scintillationByParticleType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00292">OpFastScintillation.hh:292</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afd1cabc60fa3b993b146001098cd128b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">larg4::OpFastScintillation::fcathode_plane</a></div><div class="ttdeci">Dims fcathode_plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00415">OpFastScintillation.hh:415</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a03c3be304c290d57f8909c25e70cfd81"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">geo::GeometryCore::OpDetGeoFromOpDet</a></div><div class="ttdeci">OpDetGeo const &amp; OpDetGeoFromOpDet(unsigned int OpDet) const </div><div class="ttdoc">Returns the geo::OpDetGeo object for the given detector number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01830">GeometryCore.cxx:1830</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9133f6ec2aad11f06c6450b31d10081f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">larg4::OpFastScintillation::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">OpFastScintillation.hh:417</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9b19869980094466af92423dddeeec3a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9b19869980094466af92423dddeeec3a">larg4::OpFastScintillation::finflexion_point_distance</a></div><div class="ttdeci">double finflexion_point_distance</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_ad710b749fc331f27fd47974d256d8802"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ad710b749fc331f27fd47974d256d8802">phot::PhotonVisibilityService::LoadTimingsForVUVPar</a></div><div class="ttdeci">void LoadTimingsForVUVPar(std::vector&lt; std::vector&lt; double &gt;&gt;(&amp;v)[7], double &amp;step_size, double &amp;max_d, double &amp;min_d, double &amp;vuv_vgroup_mean, double &amp;vuv_vgroup_max, double &amp;inflexion_point_distance, double &amp;angle_bin_timing_vuv) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00748">PhotonVisibilityService_service.cc:748</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a28584b8a2ba4bed4f379447c8822422e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">larg4::OpFastScintillation::fOpDetHeight</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetHeight</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00420">OpFastScintillation.hh:420</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a02bce31fa194e7e6b33d3673464ed231"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a02bce31fa194e7e6b33d3673464ed231">larg4::OpFastScintillation::extractActiveVolumes</a></div><div class="ttdeci">static std::vector&lt; geo::BoxBoundedGeo &gt; extractActiveVolumes(geo::GeometryCore const &amp;geom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02172">OpFastScintillation.cxx:2172</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a7dd253348db6b605f8c324a0624ee311"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7dd253348db6b605f8c324a0624ee311">geo::OpDetGeo::isBar</a></div><div class="ttdeci">bool isBar() const </div><div class="ttdoc">Returns whether the detector shape is a bar (TGeoBBox). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00195">OpDetGeo.h:195</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab3c053e17d850120cd4fe2823d884063"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">larg4::OpFastScintillation::fOnlyActiveVolume</a></div><div class="ttdeci">bool const fOnlyActiveVolume</div><div class="ttdoc">Whether photon propagation is performed only from active volumes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00433">OpFastScintillation.hh:433</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_aa10ecaf40f48331dc005d6ae9e5f6ab5"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">geo::TPCGeo::GetCathodeCenter</a></div><div class="ttdeci">Point GetCathodeCenter() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00298">TPCGeo.h:298</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab9fcea92a722f1e4569db0df3c96bf0b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">larg4::OpFastScintillation::tpbemission</a></div><div class="ttdeci">std::map&lt; double, double &gt; tpbemission</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00333">OpFastScintillation.hh:333</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7ea945e24a8395eb19ac877970c835f8"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">larg4::OpFastScintillation::fIsFlatPDCorr</a></div><div class="ttdeci">bool fIsFlatPDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00383">OpFastScintillation.hh:383</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aaff75d10959edf1d09ca83bd149cbaea"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">larg4::OpFastScintillation::fvispars_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fvispars_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00400">OpFastScintillation.hh:400</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae797b001bd6fd0f7a49d74f8b0b4dfe3"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae797b001bd6fd0f7a49d74f8b0b4dfe3">larg4::OpFastScintillation::fmax_d</a></div><div class="ttdeci">double fmax_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8da3e7ccf57e91bb3378d29cb27cdaee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">larg4::OpFastScintillation::fTrackSecondariesFirst</a></div><div class="ttdeci">G4bool fTrackSecondariesFirst</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00285">OpFastScintillation.hh:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8c7841a3917307d6c44157ea99738bc7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">larg4::OpFastScintillation::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a29f3b634f032d171850a230ae802c477"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a29f3b634f032d171850a230ae802c477">phot::PhotonVisibilityService::LoadVisParsFlat</a></div><div class="ttdeci">void LoadVisParsFlat(std::vector&lt; double &gt; &amp;vis_distances_x_flat, std::vector&lt; double &gt; &amp;vis_distances_r_flat, std::vector&lt; std::vector&lt; std::vector&lt; double &gt;&gt;&gt; &amp;vispars_flat) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00825">PhotonVisibilityService_service.cc:825</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad3705b34ffa34651aec27841f907bf82"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad3705b34ffa34651aec27841f907bf82">larg4::OpFastScintillation::fvis_distances_r_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_r_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00399">OpFastScintillation.hh:399</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a0a09bf2d6710fe7ce6fe42416a2d13f9"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a0a09bf2d6710fe7ce6fe42416a2d13f9">geo::OpDetGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dfb/OpDetGeo_8cxx_source.html#l00040">OpDetGeo.cxx:40</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a636af825c7b0490efcc2d361377f990c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">larg4::OpFastScintillation::fdistances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fdistances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00361">OpFastScintillation.hh:361</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7035b4befbb801111de32c5959b45d89"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">larg4::OpFastScintillation::VUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; VUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00354">OpFastScintillation.hh:354</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad19a03db803a0acb4e9510076e8c585d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">larg4::OpFastScintillation::fparameters</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fparameters[7]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00352">OpFastScintillation.hh:352</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0b293604d22ea91a66e9e51284d3043f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">larg4::OpFastScintillation::fOpDetType</a></div><div class="ttdeci">std::vector&lt; int &gt; fOpDetType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00418">OpFastScintillation.hh:418</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ab4691c2dc44983f6082defa5a34cb001"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">geo::GeometryCore::Ncryostats</a></div><div class="ttdeci">unsigned int Ncryostats() const </div><div class="ttdoc">Returns the number of cryostats in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01994">GeometryCore.h:1994</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a080ba268e04c698861d92c84dd4a8cce"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a080ba268e04c698861d92c84dd4a8cce">phot::PhotonVisibilityService::LoadGHDome</a></div><div class="ttdeci">void LoadGHDome(std::vector&lt; std::vector&lt; double &gt;&gt; &amp;GHvuvpars_dome, std::vector&lt; double &gt; &amp;border_corr_angulo_dome, std::vector&lt; std::vector&lt; double &gt;&gt; &amp;border_corr_dome) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00810">PhotonVisibilityService_service.cc:810</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a12464241f0ae6056ca4864e6e2cddcbb"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">larg4::OpFastScintillation::fGHvuvpars_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fGHvuvpars_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00384">OpFastScintillation.hh:384</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5ddb7228bb686dd9ba2e982878224cef"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">larg4::OpFastScintillation::VUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00357">OpFastScintillation.hh:357</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a944dc6ab3e7ee8ae1e1df70f274a7934"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a944dc6ab3e7ee8ae1e1df70f274a7934">larg4::OpFastScintillation::fangle_bin_timing_vis</a></div><div class="ttdeci">double fangle_bin_timing_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">OpFastScintillation.hh:360</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5e569f857c4b4d5139d9325d9bb3349b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">larg4::OpFastScintillation::fGHvuvpars_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fGHvuvpars_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00389">OpFastScintillation.hh:389</a></div></div>
<div class="ttc" id="namespaceutil_html_af0615b7538ff948ea65d5206a23c84f2"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#af0615b7538ff948ea65d5206a23c84f2">util::enumerate</a></div><div class="ttdeci">auto enumerate(Iterables &amp;&amp;...iterables)</div><div class="ttdoc">Range-for loop helper tracking the number of iteration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d85/enumerate_8h_source.html#l00069">enumerate.h:69</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_afa2dd5ee21442d40ada80f81062edd4a"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#afa2dd5ee21442d40ada80f81062edd4a">phot::PhotonVisibilityService::LoadVUVSemiAnalyticProperties</a></div><div class="ttdeci">void LoadVUVSemiAnalyticProperties(bool &amp;isFlatPDCorr, bool &amp;isDomePDCorr, double &amp;delta_angulo_vuv, double &amp;radius) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00791">PhotonVisibilityService_service.cc:791</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af3ec975734345c521e013a2e16d68e3d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">larg4::OpFastScintillation::fborder_corr_angulo_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fborder_corr_angulo_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00390">OpFastScintillation.hh:390</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_acd747ad512f0bcd96fa37bffef59b178"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">phot::PhotonVisibilityService::StoreReflected</a></div><div class="ttdeci">bool StoreReflected() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00170">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:170</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4253237e0ebc8dab74a4f5e2bb8c2124"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">larg4::OpFastScintillation::bPropagate</a></div><div class="ttdeci">bool const bPropagate</div><div class="ttdoc">Whether propagation of photons is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00425">OpFastScintillation.hh:425</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac2bd26b19a7037ed64fbc6970d9d7770"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">larg4::OpFastScintillation::YieldFactor</a></div><div class="ttdeci">G4double YieldFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00288">OpFastScintillation.hh:288</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3db520f0f99b5f5c1b7575b74ae7ec8f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">larg4::OpFastScintillation::fborder_corr_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fborder_corr_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00391">OpFastScintillation.hh:391</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3bb8239fa328e1717ba5c69fd50273ca"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">larg4::OpFastScintillation::fborder_corr_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fborder_corr_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00386">OpFastScintillation.hh:386</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aba3299f209b0f95616219b70ca03833a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aba3299f209b0f95616219b70ca03833a">larg4::OpFastScintillation::BuildThePhysicsTable</a></div><div class="ttdeci">void BuildThePhysicsTable()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00870">OpFastScintillation.cxx:870</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8784560c1c79f93a372e16f2ce4adee7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">larg4::OpFastScintillation::fvis_distances_x_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_x_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00398">OpFastScintillation.hh:398</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a2e76f14f03b46bd472f2f3b7fdde3172"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a2e76f14f03b46bd472f2f3b7fdde3172">phot::PhotonVisibilityService::LoadGHFlat</a></div><div class="ttdeci">void LoadGHFlat(std::vector&lt; std::vector&lt; double &gt;&gt; &amp;GHvuvpars_flat, std::vector&lt; double &gt; &amp;border_corr_angulo_flat, std::vector&lt; std::vector&lt; double &gt;&gt; &amp;border_corr_flat) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00801">PhotonVisibilityService_service.cc:801</a></div></div>
<div class="ttc" id="larproperties_8fcl_html_a0461a6e4be96377f9cdf78b2fa5d343b"><div class="ttname"><a href="../../d0/d11/larproperties_8fcl.html#a0461a6e4be96377f9cdf78b2fa5d343b">AbsLengthSpectrum</a></div><div class="ttdeci">BEGIN_PROLOG AbsLengthSpectrum</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d11/larproperties_8fcl_source.html#l00021">larproperties.fcl:21</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afbacbb2ba255f4f2c831a8e22a944225"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">larg4::OpFastScintillation::fradius</a></div><div class="ttdeci">double fradius</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00414">OpFastScintillation.hh:414</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8ce91426a2e9ffeb4ff14a4bca0f2519"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">larg4::OpFastScintillation::usesSemiAnalyticModel</a></div><div class="ttdeci">bool usesSemiAnalyticModel() const </div><div class="ttdoc">Returns whether the semi-analytic visibility parametrization is being used. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01492">OpFastScintillation.cxx:1492</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a419b08512c435f5fdd8317d783c87637"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a419b08512c435f5fdd8317d783c87637">phot::PhotonVisibilityService::LoadVisParsDome</a></div><div class="ttdeci">void LoadVisParsDome(std::vector&lt; double &gt; &amp;vis_distances_x_dome, std::vector&lt; double &gt; &amp;vis_distances_r_dome, std::vector&lt; std::vector&lt; std::vector&lt; double &gt;&gt;&gt; &amp;vispars_dome) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00834">PhotonVisibilityService_service.cc:834</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae56165035186723b8d79b16c244bdd7b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">larg4::OpFastScintillation::fborder_corr_angulo_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fborder_corr_angulo_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00385">OpFastScintillation.hh:385</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c9da7eeb8335d6c50a7c3711f8978e9"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">larg4::OpFastScintillation::fOpDetLength</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00419">OpFastScintillation.hh:419</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae878469b0e42918cb9816f410c34a58f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">larg4::OpFastScintillation::fFiniteRiseTime</a></div><div class="ttdeci">G4bool fFiniteRiseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00286">OpFastScintillation.hh:286</a></div></div>
<div class="ttc" id="structtype_html"><div class="ttname"><a href="../../d9/da0/structtype.html">type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9e/ShowerProducedPtrsHolder_8hh_source.html#l00036">ShowerProducedPtrsHolder.hh:36</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a52f187b0d853cf7833b81e52bdf7e0f6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">larg4::OpFastScintillation::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3674409d5d75236a9c79413b02ae2f10"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">larg4::OpFastScintillation::fL_abs_vuv</a></div><div class="ttdeci">int fL_abs_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00416">OpFastScintillation.hh:416</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aac9f56ab984f0fbd014183350575ffcc"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aac9f56ab984f0fbd014183350575ffcc">larg4::OpFastScintillation::fTPBEm</a></div><div class="ttdeci">std::unique_ptr&lt; CLHEP::RandGeneral &gt; fTPBEm</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00334">OpFastScintillation.hh:334</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a93522458cf3401e99459b4973ad08a31"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">larg4::OpFastScintillation::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4c3322018a751c9dc8dde377c676322a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">larg4::OpFastScintillation::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">OpFastScintillation.hh:408</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac0c08417aab17cdfc0d15258c1914a7e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">larg4::OpFastScintillation::fActiveVolumes</a></div><div class="ttdeci">std::vector&lt; geo::BoxBoundedGeo &gt; const fActiveVolumes</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00409">OpFastScintillation.hh:409</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0ec108b3daf6f1aed81abff6459ece66"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">larg4::OpFastScintillation::ftau_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; ftau_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00364">OpFastScintillation.hh:364</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a99581ce607905340d1b3a83f236a0c60"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a99581ce607905340d1b3a83f236a0c60">geo::OpDetGeo::Length</a></div><div class="ttdeci">double Length() const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00081">OpDetGeo.h:81</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a6a6d69c230148f61e69e62c45c49b292"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">larg4::OpFastScintillation::fIsDomePDCorr</a></div><div class="ttdeci">bool fIsDomePDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00388">OpFastScintillation.hh:388</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad0751805825b8a27dacfbe6177fee770"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad0751805825b8a27dacfbe6177fee770">larg4::OpFastScintillation::fdelta_angulo_vis</a></div><div class="ttdeci">double fdelta_angulo_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00396">OpFastScintillation.hh:396</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a></div><div class="ttdoc">Description of geometry of one entire detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01468">GeometryCore.h:1468</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0563fa0f8189dd11d735beeb289f436c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">larg4::OpFastScintillation::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5af470b4fa2aa4d1a63dd1969235e0ec"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5af470b4fa2aa4d1a63dd1969235e0ec">larg4::OpFastScintillation::fOnlyOneCryostat</a></div><div class="ttdeci">bool const fOnlyOneCryostat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00436">OpFastScintillation.hh:436</a></div></div>
<div class="ttc" id="structlarg4_1_1OpFastScintillation_1_1Dims_html_a84cb1b2fc78aeee8dd8aaa4626054837"><div class="ttname"><a href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html#a84cb1b2fc78aeee8dd8aaa4626054837">larg4::OpFastScintillation::Dims::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00367">OpFastScintillation.hh:367</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a81e967540da71175904e177bcaa19603"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">larg4::OpFastScintillation::fradial_distances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fradial_distances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00362">OpFastScintillation.hh:362</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c8a307d8e0be43367314badf2fb033e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8a307d8e0be43367314badf2fb033e">larg4::OpFastScintillation::fvis_distances_r_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_r_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00403">OpFastScintillation.hh:403</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a76852aeab9621ed43645e8c559c8b022"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">larg4::OpFastScintillation::ExcitationRatio</a></div><div class="ttdeci">G4double ExcitationRatio</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00290">OpFastScintillation.hh:290</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_ae5c635540a660e049083e85db0707e45"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ae5c635540a660e049083e85db0707e45">phot::PhotonVisibilityService::LoadVisSemiAnalyticProperties</a></div><div class="ttdeci">void LoadVisSemiAnalyticProperties(double &amp;delta_angulo_vis, double &amp;radius) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00819">PhotonVisibilityService_service.cc:819</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3e21019631a04a7f22c3b0aaf6f79bd3"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">larg4::OpFastScintillation::fcut_off_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fcut_off_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00363">OpFastScintillation.hh:363</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5c41b3a9dd7c8cfa15fa381bd19f91e9"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5c41b3a9dd7c8cfa15fa381bd19f91e9">larg4::OpFastScintillation::fcathode_ydimension</a></div><div class="ttdeci">double fcathode_ydimension</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0cb9ba23f6ef377b0cc5d260372dc8e6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cb9ba23f6ef377b0cc5d260372dc8e6">larg4::OpFastScintillation::fUseNhitsModel</a></div><div class="ttdeci">bool const fUseNhitsModel</div><div class="ttdoc">Whether the semi-analytic model is being used for photon visibility. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00431">OpFastScintillation.hh:431</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aea78d33e76362e20533d8041204d1eb5"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">larg4::OpFastScintillation::fvis_distances_x_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_x_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00402">OpFastScintillation.hh:402</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afb621a844af899a684aa828f0f786a2c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afb621a844af899a684aa828f0f786a2c">larg4::OpFastScintillation::fdelta_angulo_vuv</a></div><div class="ttdeci">double fdelta_angulo_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00381">OpFastScintillation.hh:381</a></div></div>
<div class="ttc" id="structlarg4_1_1OpFastScintillation_1_1Dims_html_a6ba84567487b571cc01b6a82fe33f767"><div class="ttname"><a href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html#a6ba84567487b571cc01b6a82fe33f767">larg4::OpFastScintillation::Dims::h</a></div><div class="ttdeci">double h</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00367">OpFastScintillation.hh:367</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_aca0562070b5646b986bad33c5f806411"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aca0562070b5646b986bad33c5f806411">phot::PhotonVisibilityService::UseNhitsModel</a></div><div class="ttdeci">bool UseNhitsModel() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00201">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:201</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a00d0364f20281bcc4b3f41784335f3ed"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">larg4::OpFastScintillation::fPVS</a></div><div class="ttdeci">phot::PhotonVisibilityService const *const fPVS</div><div class="ttdoc">Photon visibility service instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">OpFastScintillation.hh:428</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aa78a8761b4bd4dec065441cb0d0a2070"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">larg4::OpFastScintillation::VUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00356">OpFastScintillation.hh:356</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_acd58061960591a845c7530428d6e2425"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">larg4::OpFastScintillation::fvis_vmean</a></div><div class="ttdeci">double fvis_vmean</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">OpFastScintillation.hh:360</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a84aba48f49cf9add6cf0641a4527e45b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">geo::GeometryCore::TPC</a></div><div class="ttdeci">TPCGeo const &amp; TPC(unsigned int const tpc=0, unsigned int const cstat=0) const </div><div class="ttdoc">Returns the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02423">GeometryCore.h:2423</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
<div class="ttc" id="classdetinfo_1_1LArProperties_html_a5090ca3ff2294af77a193d2714be3557"><div class="ttname"><a href="../../dc/d37/classdetinfo_1_1LArProperties.html#a5090ca3ff2294af77a193d2714be3557">detinfo::LArProperties::ScintByParticleType</a></div><div class="ttdeci">virtual bool ScintByParticleType() const =0</div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a424c9a54c418f076f42d728fbb63e894"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">phot::PhotonVisibilityService::NOpChannels</a></div><div class="ttdeci">size_t NOpChannels() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00702">PhotonVisibilityService_service.cc:702</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7a38294b1c5c68bc3c817f5b0716fb83"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7a38294b1c5c68bc3c817f5b0716fb83">larg4::OpFastScintillation::fcathode_zdimension</a></div><div class="ttdeci">double fcathode_zdimension</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_ae3261a6a3db55fa07cf04775f98c2edf"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#ae3261a6a3db55fa07cf04775f98c2edf">geo::OpDetGeo::Height</a></div><div class="ttdeci">double Height() const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00083">OpDetGeo.h:83</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a84145a771638c07c31d6f38242c4494c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">larg4::OpFastScintillation::fangle_bin_timing_vuv</a></div><div class="ttdeci">double fangle_bin_timing_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a7df92063c04f75d821e97f2b275ef193"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7df92063c04f75d821e97f2b275ef193">geo::OpDetGeo::Shape</a></div><div class="ttdeci">TGeoShape const * Shape() const </div><div class="ttdoc">Returns the geometry object as TGeoShape. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00154">OpDetGeo.h:154</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a51aff7f60f22299ad11b43f0108c262b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a51aff7f60f22299ad11b43f0108c262b">larg4::OpFastScintillation::fStoreReflected</a></div><div class="ttdeci">bool fStoreReflected</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00394">OpFastScintillation.hh:394</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa71c13b426fc5506ddaf48d37d07731b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">larg4::OpFastScintillation::~OpFastScintillation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00400">400</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>) <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>-&gt;clearAndDestroy();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>) <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>-&gt;clearAndDestroy();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a064dc724b2899db0b59c75d9ea6e4b7c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">larg4::OpFastScintillation::theSlowIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theSlowIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">OpFastScintillation.hh:282</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aade9c725e09500c55a71743d5b1bf806"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">larg4::OpFastScintillation::theFastIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theFastIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">OpFastScintillation.hh:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4f2d80b31636c407b0a09c7f65889cd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::AddSaturation </td>
          <td>(</td>
          <td class="paramtype">G4EmSaturation *&#160;</td>
          <td class="paramname"><em>sat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00216">216</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a> = sat;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a67180d32e39d25c79d7a968d2a7714f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4VParticleChange * larg4::OpFastScintillation::AtRestDoIt </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>aTrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00414">414</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a630668b55faf8fd7231e028d5435a6b9">OpFastScintillation::PostStepDoIt</a>(aTrack, aStep);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a630668b55faf8fd7231e028d5435a6b9"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a630668b55faf8fd7231e028d5435a6b9">larg4::OpFastScintillation::PostStepDoIt</a></div><div class="ttdeci">virtual G4VParticleChange * PostStepDoIt(const G4Track &amp;aTrack, const G4Step &amp;aStep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00425">OpFastScintillation.cxx:425</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abce84220570f42dca9aef2116444ce7d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::average_position </td>
          <td>(</td>
          <td class="paramtype">G4Step const &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xzyPos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01102">1102</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    CLHEP::Hep3Vector prePoint = (aStep.GetPreStepPoint())-&gt;GetPosition();</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    CLHEP::Hep3Vector postPoint = (aStep.GetPostStepPoint())-&gt;GetPosition();</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    xyzPos[0] = (((prePoint.getX() + postPoint.getX()) / 2.0) / CLHEP::cm);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    xyzPos[1] = (((prePoint.getY() + postPoint.getY()) / 2.0) / CLHEP::cm);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    xyzPos[2] = (((prePoint.getZ() + postPoint.getZ()) / 2.0) / CLHEP::cm);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ea57f26d674500fbafa01f690344f88"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::bi_exp </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>tau1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>tau2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01849">1849</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  { <span class="comment">// TODO: what&#39;s up with this? ... / tau2 / tau2 ...</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1.0 * t / tau2) * (1 - <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1.0 * t / tau1)) / tau2 / tau2 *</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;           (tau1 + tau2);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  }</div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aba3299f209b0f95616219b70ca03833a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::BuildThePhysicsTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00870">870</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a> &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keyword">const</span> G4MaterialTable* theMaterialTable = G4Material::GetMaterialTable();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    G4int numOfMaterials = G4Material::GetNumberOfMaterials();</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// create new physics table</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a> = std::make_unique&lt;G4PhysicsTable&gt;(numOfMaterials);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a> = std::make_unique&lt;G4PhysicsTable&gt;(numOfMaterials);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// loop for materials</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">for</span> (G4int i = 0; i &lt; numOfMaterials; i++) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      G4PhysicsOrderedFreeVector* aPhysicsOrderedFreeVector = <span class="keyword">new</span> G4PhysicsOrderedFreeVector();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      G4PhysicsOrderedFreeVector* bPhysicsOrderedFreeVector = <span class="keyword">new</span> G4PhysicsOrderedFreeVector();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">// Retrieve vector of scintillation wavelength intensity for</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">// the material from the material&#39;s optical properties table.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      G4Material* aMaterial = (*theMaterialTable)[i];</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      G4MaterialPropertiesTable* aMaterialPropertiesTable = aMaterial-&gt;GetMaterialPropertiesTable();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">if</span> (aMaterialPropertiesTable) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        G4MaterialPropertyVector* theFastLightVector =</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          aMaterialPropertiesTable-&gt;GetProperty(<span class="stringliteral">&quot;FASTCOMPONENT&quot;</span>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">if</span> (theFastLightVector) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          <span class="comment">// Retrieve the first intensity point in vector</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          <span class="comment">// of (photon energy, intensity) pairs</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          G4double currentIN = (*theFastLightVector)[0];</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          <span class="keywordflow">if</span> (currentIN &gt;= 0.0) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="comment">// Create first (photon energy, Scintillation</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="comment">// Integral pair</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            G4double currentPM = theFastLightVector-&gt;Energy(0);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            G4double currentCII = 0.0;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            aPhysicsOrderedFreeVector-&gt;InsertValues(currentPM, currentCII);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="comment">// Set previous values to current ones prior to loop</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            G4double prevPM = currentPM;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            G4double prevCII = currentCII;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            G4double prevIN = currentIN;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="comment">// loop over all (photon energy, intensity)</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="comment">// pairs stored for this material</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; theFastLightVector-&gt;GetVectorLength(); i++) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              currentPM = theFastLightVector-&gt;Energy(i);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;              currentIN = (*theFastLightVector)[i];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;              currentCII = 0.5 * (prevIN + currentIN);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;              currentCII = prevCII + (currentPM - prevPM) * currentCII;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;              aPhysicsOrderedFreeVector-&gt;InsertValues(currentPM, currentCII);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;              prevPM = currentPM;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;              prevCII = currentCII;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              prevIN = currentIN;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        G4MaterialPropertyVector* theSlowLightVector =</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          aMaterialPropertiesTable-&gt;GetProperty(<span class="stringliteral">&quot;SLOWCOMPONENT&quot;</span>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordflow">if</span> (theSlowLightVector) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">// Retrieve the first intensity point in vector</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="comment">// of (photon energy, intensity) pairs</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          G4double currentIN = (*theSlowLightVector)[0];</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="keywordflow">if</span> (currentIN &gt;= 0.0) {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="comment">// Create first (photon energy, Scintillation</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="comment">// Integral pair</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            G4double currentPM = theSlowLightVector-&gt;Energy(0);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            G4double currentCII = 0.0;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            bPhysicsOrderedFreeVector-&gt;InsertValues(currentPM, currentCII);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="comment">// Set previous values to current ones prior to loop</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            G4double prevPM = currentPM;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            G4double prevCII = currentCII;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            G4double prevIN = currentIN;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">// loop over all (photon energy, intensity)</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="comment">// pairs stored for this material</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; theSlowLightVector-&gt;GetVectorLength(); i++) {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;              currentPM = theSlowLightVector-&gt;Energy(i);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;              currentIN = (*theSlowLightVector)[i];</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;              currentCII = 0.5 * (prevIN + currentIN);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;              currentCII = prevCII + (currentPM - prevPM) * currentCII;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;              bPhysicsOrderedFreeVector-&gt;InsertValues(currentPM, currentCII);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;              prevPM = currentPM;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              prevCII = currentCII;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;              prevIN = currentIN;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="comment">// The scintillation integral(s) for a given material</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="comment">// will be inserted in the table(s) according to the</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">// position of the material in the material table.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>-&gt;insertAt(i, aPhysicsOrderedFreeVector);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>-&gt;insertAt(i, bPhysicsOrderedFreeVector);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a064dc724b2899db0b59c75d9ea6e4b7c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">larg4::OpFastScintillation::theSlowIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theSlowIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">OpFastScintillation.hh:282</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aade9c725e09500c55a71743d5b1bf806"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">larg4::OpFastScintillation::theFastIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theFastIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">OpFastScintillation.hh:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ddbf2ecd690f04d2ca60ca29498ec16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::detectedDirectHits </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; size_t, int &gt; &amp;&#160;</td>
          <td class="paramname"><em>DetectedNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01499">1499</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> OpDet : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">NOpChannels</a>())) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">isOpDetInSameTPC</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet))) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">// set detector struct for solid angle function</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keyword">const</span> OpFastScintillation::OpticalDetector op{</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a>.at(OpDet), <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a>.at(OpDet),</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet), <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a>.at(OpDet)};</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> DetThis = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8721e1342d192025d3bc7320aeedcc3">VUVHits</a>(Num, ScintPoint, op);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">if</span> (DetThis &gt; 0) {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        DetectedNum[OpDet] = DetThis;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="comment">//   mf::LogInfo(&quot;OpFastScintillation&quot;) &lt;&lt; &quot;FastScint: &quot; &lt;&lt;</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="comment">//   //   it-&gt;second&lt;&lt;&quot; &quot; &lt;&lt; Num &lt;&lt; &quot; &quot; &lt;&lt; DetThisPMT;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="comment">//det_photon_ctr += DetThisPMT; // CASE-DEBUG DO NOT REMOVE THIS COMMENT</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9133f6ec2aad11f06c6450b31d10081f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">larg4::OpFastScintillation::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">OpFastScintillation.hh:417</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a28584b8a2ba4bed4f379447c8822422e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">larg4::OpFastScintillation::fOpDetHeight</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetHeight</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00420">OpFastScintillation.hh:420</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9ddf47e1ef56bfe5449e119604e63465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">larg4::OpFastScintillation::isOpDetInSameTPC</a></div><div class="ttdeci">bool isOpDetInSameTPC(geo::Point_t const &amp;ScintPoint, geo::Point_t const &amp;OpDetPoint) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01822">OpFastScintillation.cxx:1822</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0b293604d22ea91a66e9e51284d3043f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">larg4::OpFastScintillation::fOpDetType</a></div><div class="ttdeci">std::vector&lt; int &gt; fOpDetType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00418">OpFastScintillation.hh:418</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac8721e1342d192025d3bc7320aeedcc3"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8721e1342d192025d3bc7320aeedcc3">larg4::OpFastScintillation::VUVHits</a></div><div class="ttdeci">int VUVHits(const double Nphotons_created, geo::Point_t const &amp;ScintPoint, OpticalDetector const &amp;opDet) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01595">OpFastScintillation.cxx:1595</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c9da7eeb8335d6c50a7c3711f8978e9"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">larg4::OpFastScintillation::fOpDetLength</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00419">OpFastScintillation.hh:419</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a00d0364f20281bcc4b3f41784335f3ed"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">larg4::OpFastScintillation::fPVS</a></div><div class="ttdeci">phot::PhotonVisibilityService const *const fPVS</div><div class="ttdoc">Photon visibility service instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">OpFastScintillation.hh:428</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a424c9a54c418f076f42d728fbb63e894"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">phot::PhotonVisibilityService::NOpChannels</a></div><div class="ttdeci">size_t NOpChannels() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00702">PhotonVisibilityService_service.cc:702</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50926aab8f0a269cc3f8d0bb8120d933"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::detectedReflecHits </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; size_t, int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ReflDetectedNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01521">1521</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// 1). calculate total number of hits of VUV photons on</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">// reflective foils via solid angle + Gaisser-Hillas</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="comment">// corrections:</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">// set plane_depth for correct TPC:</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordtype">double</span> plane_depth;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">if</span> (ScintPoint.X() &lt; 0.) { plane_depth = -<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>; }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      plane_depth = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// get scintpoint coords relative to centre of cathode plane</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    std::array&lt;double, 3&gt; ScintPoint_relative = {<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint.X() - plane_depth),</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                                 <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint.Y() - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[1]),</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                                 <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint.Z() - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[2])};</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// calculate solid angle of cathode from the scintillation point</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordtype">double</span> solid_angle_cathode = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">fcathode_plane</a>, ScintPoint_relative);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// calculate distance and angle between ScintPoint and hotspot</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="comment">// vast majority of hits in hotspot region directly infront of scintpoint,</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="comment">// therefore consider attenuation for this distance and on axis GH instead of for the centre coordinate</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordtype">double</span> distance_cathode = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(plane_depth - ScintPoint.X());</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">// calculate hits on cathode plane via geometric acceptance</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordtype">double</span> cathode_hits_geo = <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1. * distance_cathode / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">fL_abs_vuv</a>) *</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                              (solid_angle_cathode / (4. * <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>)) * Num;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="comment">// determine Gaisser-Hillas correction including border effects</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// use flat correction</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> = std::sqrt(std::pow(ScintPoint.Y() - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[1], 2) + std::pow(ScintPoint.Z() - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[2], 2));</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordtype">double</span> pars_ini[4] = {0, 0, 0, 0};</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordtype">double</span> s1 = 0; <span class="keywordtype">double</span> s2 = 0; <span class="keywordtype">double</span> s3 = 0;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      pars_ini[0] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[0][0];</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      pars_ini[1] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[1][0];</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      pars_ini[2] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[2][0];</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      pars_ini[3] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[3][0];</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      s1 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[0], 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      s2 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[1], 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      s3 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[2], 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error: flat optical detector VUV correction required for reflected semi-analytic hits.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="comment">// add border correction</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    pars_ini[0] = pars_ini[0] + s1 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    pars_ini[1] = pars_ini[1] + s2 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    pars_ini[2] = pars_ini[2] + s3 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    pars_ini[3] = pars_ini[3];</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// calculate corrected number of hits</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordtype">double</span> GH_correction = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab7c56e09c6f8efb51bbe8f4a770d84c4">Gaisser_Hillas</a>(distance_cathode, pars_ini);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cathode_hits_rec = GH_correction * cathode_hits_geo;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// detemine hits on each PD</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keyword">const</span> std::array&lt;double, 3&gt; hotspot = {plane_depth, ScintPoint.Y(), ScintPoint.Z()};</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> OpDet : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">NOpChannels</a>())) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">isOpDetInSameTPC</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet))) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="comment">// set detector struct for solid angle function</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <span class="keyword">const</span>  OpFastScintillation::OpticalDetector op{</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">fOpDetHeight</a>.at(OpDet), <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">fOpDetLength</a>.at(OpDet),</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet), <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">fOpDetType</a>.at(OpDet)};</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordtype">int</span> <span class="keyword">const</span> ReflDetThis =</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8d1cae90d2db03f8af7a7745e676e41">VISHits</a>(ScintPoint, op, cathode_hits_rec, hotspot);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">if</span> (ReflDetThis &gt; 0) { ReflDetectedNum[OpDet] = ReflDetThis; }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afd1cabc60fa3b993b146001098cd128b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afd1cabc60fa3b993b146001098cd128b">larg4::OpFastScintillation::fcathode_plane</a></div><div class="ttdeci">Dims fcathode_plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00415">OpFastScintillation.hh:415</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9133f6ec2aad11f06c6450b31d10081f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">larg4::OpFastScintillation::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">OpFastScintillation.hh:417</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab7c56e09c6f8efb51bbe8f4a770d84c4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab7c56e09c6f8efb51bbe8f4a770d84c4">larg4::OpFastScintillation::Gaisser_Hillas</a></div><div class="ttdeci">G4double Gaisser_Hillas(const double x, const double *par) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01856">OpFastScintillation.cxx:1856</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a28584b8a2ba4bed4f379447c8822422e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a28584b8a2ba4bed4f379447c8822422e">larg4::OpFastScintillation::fOpDetHeight</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetHeight</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00420">OpFastScintillation.hh:420</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac8d1cae90d2db03f8af7a7745e676e41"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac8d1cae90d2db03f8af7a7745e676e41">larg4::OpFastScintillation::VISHits</a></div><div class="ttdeci">int VISHits(geo::Point_t const &amp;ScintPoint, OpticalDetector const &amp;opDet, const double cathode_hits_rec, const std::array&lt; double, 3 &gt; hotspot) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01691">OpFastScintillation.cxx:1691</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7ea945e24a8395eb19ac877970c835f8"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">larg4::OpFastScintillation::fIsFlatPDCorr</a></div><div class="ttdeci">bool fIsFlatPDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00383">OpFastScintillation.hh:383</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9ddf47e1ef56bfe5449e119604e63465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">larg4::OpFastScintillation::isOpDetInSameTPC</a></div><div class="ttdeci">bool isOpDetInSameTPC(geo::Point_t const &amp;ScintPoint, geo::Point_t const &amp;OpDetPoint) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01822">OpFastScintillation.cxx:1822</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0b293604d22ea91a66e9e51284d3043f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0b293604d22ea91a66e9e51284d3043f">larg4::OpFastScintillation::fOpDetType</a></div><div class="ttdeci">std::vector&lt; int &gt; fOpDetType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00418">OpFastScintillation.hh:418</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a12464241f0ae6056ca4864e6e2cddcbb"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">larg4::OpFastScintillation::fGHvuvpars_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fGHvuvpars_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00384">OpFastScintillation.hh:384</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3bb8239fa328e1717ba5c69fd50273ca"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">larg4::OpFastScintillation::fborder_corr_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fborder_corr_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00386">OpFastScintillation.hh:386</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae56165035186723b8d79b16c244bdd7b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">larg4::OpFastScintillation::fborder_corr_angulo_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fborder_corr_angulo_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00385">OpFastScintillation.hh:385</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c9da7eeb8335d6c50a7c3711f8978e9"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c9da7eeb8335d6c50a7c3711f8978e9">larg4::OpFastScintillation::fOpDetLength</a></div><div class="ttdeci">std::vector&lt; double &gt; fOpDetLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00419">OpFastScintillation.hh:419</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3674409d5d75236a9c79413b02ae2f10"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">larg4::OpFastScintillation::fL_abs_vuv</a></div><div class="ttdeci">int fL_abs_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00416">OpFastScintillation.hh:416</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4c3322018a751c9dc8dde377c676322a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">larg4::OpFastScintillation::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">OpFastScintillation.hh:408</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0563fa0f8189dd11d735beeb289f436c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">larg4::OpFastScintillation::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3fd540bc6b6a8f667c11a01c914ad89c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">larg4::OpFastScintillation::Rectangle_SolidAngle</a></div><div class="ttdeci">double Rectangle_SolidAngle(const double a, const double b, const double d) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02075">OpFastScintillation.cxx:2075</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a00d0364f20281bcc4b3f41784335f3ed"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">larg4::OpFastScintillation::fPVS</a></div><div class="ttdeci">phot::PhotonVisibilityService const *const fPVS</div><div class="ttdoc">Photon visibility service instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">OpFastScintillation.hh:428</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a424c9a54c418f076f42d728fbb63e894"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">phot::PhotonVisibilityService::NOpChannels</a></div><div class="ttdeci">size_t NOpChannels() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00702">PhotonVisibilityService_service.cc:702</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc790f6bda764b63c5467ca650d996ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::Disk_SolidAngle </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02013">2013</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordflow">if</span> (b &lt;= 0. || d &lt; 0. || <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> &lt;= 0.) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> leg2 = (b + d) * (b + d);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> aa = std::sqrt(<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> * <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> / (<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> * <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> + leg2));</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordflow">if</span> (isApproximatelyZero(d)) { <span class="keywordflow">return</span> 2. * <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> * (1. - aa); }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordtype">double</span> bb = 2. * std::sqrt(b * d / (<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> * <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> + leg2));</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordtype">double</span> cc = 4. * b * d / leg2;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span> (isDefinitelyGreaterThan(d, b)) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keywordflow">return</span> 2. * aa *</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;               (std::sqrt(1. - cc) * boost::math::ellint_3(bb, cc, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>()) -</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                boost::math::ellint_1(bb, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>()));</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <span class="keywordflow">catch</span> (std::domain_error&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordflow">if</span> (isApproximatelyEqual(d, b, 1e-9)) {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;          mf::LogWarning(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Elliptic Integral in Disk_SolidAngle() given parameters outside domain.&quot;</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nbb: &quot;</span> &lt;&lt; bb &lt;&lt; <span class="stringliteral">&quot;\ncc: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot;\nException message: &quot;</span> &lt;&lt; e.what()</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nRelax condition and carry on.&quot;</span>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> - 2. * aa * boost::math::ellint_1(bb, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>());</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;          mf::LogError(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Elliptic Integral inside Disk_SolidAngle() given parameters outside domain.\n&quot;</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nbb: &quot;</span> &lt;&lt; bb &lt;&lt; <span class="stringliteral">&quot;\ncc: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot;Exception message: &quot;</span> &lt;&lt; e.what();</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span> (isDefinitelyLessThan(d, b)) {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        <span class="keywordflow">return</span> 2. * <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> -</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;               2. * aa *</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                 (boost::math::ellint_1(bb, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>()) +</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                  std::sqrt(1. - cc) * boost::math::ellint_3(bb, cc, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>()));</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="keywordflow">catch</span> (std::domain_error&amp; e) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        <span class="keywordflow">if</span> (isApproximatelyEqual(d, b, 1e-9)) {</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          mf::LogWarning(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Elliptic Integral in Disk_SolidAngle() given parameters outside domain.&quot;</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nbb: &quot;</span> &lt;&lt; bb &lt;&lt; <span class="stringliteral">&quot;\ncc: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot;\nException message: &quot;</span> &lt;&lt; e.what()</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nRelax condition and carry on.&quot;</span>;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> - 2. * aa * boost::math::ellint_1(bb, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>());</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          mf::LogError(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Elliptic Integral inside Disk_SolidAngle() given parameters outside domain.\n&quot;</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nbb: &quot;</span> &lt;&lt; bb &lt;&lt; <span class="stringliteral">&quot;\ncc: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot;Exception message: &quot;</span> &lt;&lt; e.what();</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">if</span> (isApproximatelyEqual(d, b)) {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> - 2. * aa * boost::math::ellint_1(bb, <a class="code" href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a>());</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  }</div>
<div class="ttc" id="getStatistics_8sh_html_a04d4c2131ccb24cc78386597e8a21c5b"><div class="ttname"><a href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a></div><div class="ttdeci">while getopts h</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/getStatistics_8sh_source.html#l00013">getStatistics.sh:13</a></div></div>
<div class="ttc" id="OpFastScintillation_8cxx_html_a7c9f8956443b33cd575fd778dba4f495"><div class="ttname"><a href="../../d7/d47/OpFastScintillation_8cxx.html#a7c9f8956443b33cd575fd778dba4f495">noLDoublePromote</a></div><div class="ttdeci">boost::math::policies::policy&lt; boost::math::policies::promote_double&lt; false &gt; &gt; noLDoublePromote</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00160">OpFastScintillation.cxx:160</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0fc947d918d98f900772ecc34124734"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::DumpPhysicsTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00541">541</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      G4int PhysicsTableSize = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>-&gt;entries();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      G4PhysicsOrderedFreeVector* v;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">for</span> (G4int i = 0; i &lt; PhysicsTableSize; i++) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        v = (G4PhysicsOrderedFreeVector*)(*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>)[i];</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        v-&gt;DumpValues();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      G4int PhysicsTableSize = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>-&gt;entries();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      G4PhysicsOrderedFreeVector* v;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">for</span> (G4int i = 0; i &lt; PhysicsTableSize; i++) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        v = (G4PhysicsOrderedFreeVector*)(*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>)[i];</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        v-&gt;DumpValues();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a064dc724b2899db0b59c75d9ea6e4b7c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">larg4::OpFastScintillation::theSlowIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theSlowIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">OpFastScintillation.hh:282</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aade9c725e09500c55a71743d5b1bf806"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">larg4::OpFastScintillation::theFastIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theFastIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">OpFastScintillation.hh:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a02bce31fa194e7e6b33d3673464ed231"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> &gt; larg4::OpFastScintillation::extractActiveVolumes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> const &amp;&#160;</td>
          <td class="paramname"><em>geom</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02172">2172</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    std::vector&lt;geo::BoxBoundedGeo&gt; activeVolumes;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    activeVolumes.reserve(geom.Ncryostats());</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo : geom.IterateCryostats()) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="comment">// can&#39;t use it default-constructed since it would always include origin</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> box{cryo.TPC(0).ActiveBoundingBox()};</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> : cryo.IterateTPCs())</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#adab794eed303c92172c8e2e6e7a51876">ExtendToInclude</a>(<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>.ActiveBoundingBox());</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      activeVolumes.push_back(std::move(box));</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    } <span class="comment">// for cryostats</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordflow">return</span> activeVolumes;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  } <span class="comment">// OpFastScintillation::extractActiveVolumes()</span></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a></div><div class="ttdoc">Geometry information for a single cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00043">CryostatGeo.h:43</a></div></div>
<div class="ttc" id="sbnd__flashalgo_8fcl_html_a648c7afac4085c93cd1ba4a75dfe8818"><div class="ttname"><a href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a></div><div class="ttdeci">BEGIN_PROLOG TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d22/sbnd__flashalgo_8fcl_source.html#l00014">sbnd_flashalgo.fcl:14</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a></div><div class="ttdoc">A base class aware of world box coordinatesAn object describing a simple shape can inherit from this ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00033">BoxBoundedGeo.h:33</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_adab794eed303c92172c8e2e6e7a51876"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#adab794eed303c92172c8e2e6e7a51876">geo::BoxBoundedGeo::ExtendToInclude</a></div><div class="ttdeci">void ExtendToInclude(Coord_t x, Coord_t y, Coord_t z)</div><div class="ttdoc">Extends the current box to also include the specified point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00414">BoxBoundedGeo.h:414</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab7c56e09c6f8efb51bbe8f4a770d84c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::Gaisser_Hillas </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01856">1856</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordtype">double</span> X_mu_0 = par[3];</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordtype">double</span> Normalization = par[0];</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordtype">double</span> Diff = par[1] - X_mu_0;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordtype">double</span> Term = std::pow((<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - X_mu_0) / Diff, Diff / par[2]);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordtype">double</span> Exponential = <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>((par[1] - <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>) / par[2]);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">return</span> (Normalization * Term * Exponential);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  }</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e18bdfefefd4285bc885a75c8138dff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::generateParam </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>angle_bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01252">1252</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">// get distance</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordtype">double</span> distance_in_cm = (index * <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a>) + <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">// time range</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> signal_t_range = 5000.; <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="comment">// parameterisation TF1</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    TF1 fVUVTiming;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">// For very short distances the time correction is just a shift</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordtype">double</span> t_direct_mean = distance_in_cm / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">fvuv_vgroup_mean</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordtype">double</span> t_direct_min = distance_in_cm / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">fvuv_vgroup_max</a>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// Defining the model function(s) describing the photon transportation timing vs distance</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">// Getting the landau parameters from the time parametrization</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    std::array&lt;double, 3&gt; pars_landau;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a20b1c3f11842b0a9a92fd0c136f046d4">interpolate3</a>(pars_landau,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                 <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[0][0],</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                 <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[2][angle_bin],</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                 <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[3][angle_bin],</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                 <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[1][angle_bin],</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                 distance_in_cm,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                 <span class="keyword">true</span>);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// Deciding which time model to use (depends on the distance)</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// defining useful times for the VUV arrival time shapes</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (distance_in_cm &gt;= <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9b19869980094466af92423dddeeec3a">finflexion_point_distance</a>) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordtype">double</span> pars_far[4] = {t_direct_min, pars_landau[0], pars_landau[1], pars_landau[2]};</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="comment">// Set model: Landau</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      fVUVTiming = TF1(<span class="stringliteral">&quot;fVUVTiming&quot;</span>, <a class="code" href="../../d7/d6f/namespacelarg4.html#ad43a11f1cc0f4c9f623b29c5a3f79983">model_far</a>, 0, signal_t_range, 4);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      fVUVTiming.SetParameters(pars_far);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="comment">// Set model: Landau + Exponential</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      fVUVTiming = TF1(<span class="stringliteral">&quot;fVUVTiming&quot;</span>, <a class="code" href="../../d7/d6f/namespacelarg4.html#af11ec2be58eab951ca98bdb7c2bc8084">model_close</a>, 0, signal_t_range, 7);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="comment">// Exponential parameters</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordtype">double</span> pars_expo[2];</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="comment">// Getting the exponential parameters from the time parametrization</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      pars_expo[1] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[4][0], <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[5][angle_bin], distance_in_cm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      pars_expo[0] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[4][0], <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">fparameters</a>[6][angle_bin], distance_in_cm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      pars_expo[0] *= pars_landau[2];</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      pars_expo[0] = std::log(pars_expo[0]);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="comment">// this is to find the intersection point between the two functions:</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      TF1 fint = TF1(<span class="stringliteral">&quot;fint&quot;</span>, <a class="code" href="../../d7/d6f/namespacelarg4.html#af3457898941f1149801a042b67b16900">finter_d</a>, pars_landau[0], 4 * t_direct_mean, 5);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordtype">double</span> parsInt[5] = {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        pars_landau[0], pars_landau[1], pars_landau[2], pars_expo[0], pars_expo[1]};</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      fint.SetParameters(parsInt);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordtype">double</span> t_int = fint.GetMinimumX();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordtype">double</span> minVal = fint.Eval(t_int);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="comment">// the functions must intersect - output warning if they don&#39;t</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordflow">if</span> (minVal &gt; 0.015) {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Parametrization of VUV light discontinuous for distance = &quot;</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                  &lt;&lt; distance_in_cm &lt;&lt; std::endl;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: This shouldn&#39;t be happening &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordtype">double</span> parsfinal[7] = {t_int,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                             pars_landau[0],</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                             pars_landau[1],</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                             pars_landau[2],</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                             pars_expo[0],</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                             pars_expo[1],</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                             t_direct_min};</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      fVUVTiming.SetParameters(parsfinal);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">// set the number of points used to sample parameterisation</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">// for shorter distances, peak is sharper so more sensitive sampling required</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordtype">int</span> fsampling; <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">if</span> (distance_in_cm &lt; 50) { fsampling = 10000; }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (distance_in_cm &lt; 100) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      fsampling = 5000;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      fsampling = 1000;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    fVUVTiming.SetNpx(fsampling);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// calculate max and min distance relevant to sample parameterisation</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">// max</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nq_max = 1;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordtype">double</span> xq_max[nq_max];</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordtype">double</span> yq_max[nq_max];</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    xq_max[0] = 0.995; <span class="comment">// include 99.5%</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    fVUVTiming.GetQuantiles(nq_max, yq_max, xq_max);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a> = yq_max[0];</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">// min</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordtype">double</span> min = t_direct_min;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="comment">// store TF1 and min/max, this allows identical TF1 to be used every time sampling</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">// the first call of GetRandom generates the timing sampling and stores it in the TF1 object, this is the slow part</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">// all subsequent calls check if it has been generated previously and are ~100+ times quicker</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">VUV_timing</a>[angle_bin][index] = fVUVTiming;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">VUV_max</a>[angle_bin][index] = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">VUV_min</a>[angle_bin][index] = min;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af37aae991c13fdd84d0e445e1013d465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">larg4::OpFastScintillation::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9b19869980094466af92423dddeeec3a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9b19869980094466af92423dddeeec3a">larg4::OpFastScintillation::finflexion_point_distance</a></div><div class="ttdeci">double finflexion_point_distance</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8c7841a3917307d6c44157ea99738bc7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">larg4::OpFastScintillation::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="namespacelarg4_html_af3457898941f1149801a042b67b16900"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#af3457898941f1149801a042b67b16900">larg4::finter_d</a></div><div class="ttdeci">double finter_d(double *x, double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01867">OpFastScintillation.cxx:1867</a></div></div>
<div class="ttc" id="namespacelarg4_html_ad43a11f1cc0f4c9f623b29c5a3f79983"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#ad43a11f1cc0f4c9f623b29c5a3f79983">larg4::model_far</a></div><div class="ttdeci">double model_far(double *x, double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01916">OpFastScintillation.cxx:1916</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7035b4befbb801111de32c5959b45d89"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">larg4::OpFastScintillation::VUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; VUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00354">OpFastScintillation.hh:354</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad19a03db803a0acb4e9510076e8c585d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad19a03db803a0acb4e9510076e8c585d">larg4::OpFastScintillation::fparameters</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fparameters[7]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00352">OpFastScintillation.hh:352</a></div></div>
<div class="ttc" id="namespacelarg4_html_af11ec2be58eab951ca98bdb7c2bc8084"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#af11ec2be58eab951ca98bdb7c2bc8084">larg4::model_close</a></div><div class="ttdeci">double model_close(double *x, double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01899">OpFastScintillation.cxx:1899</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5ddb7228bb686dd9ba2e982878224cef"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">larg4::OpFastScintillation::VUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00357">OpFastScintillation.hh:357</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a52f187b0d853cf7833b81e52bdf7e0f6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">larg4::OpFastScintillation::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a93522458cf3401e99459b4973ad08a31"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">larg4::OpFastScintillation::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a20b1c3f11842b0a9a92fd0c136f046d4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a20b1c3f11842b0a9a92fd0c136f046d4">larg4::OpFastScintillation::interpolate3</a></div><div class="ttdeci">void interpolate3(std::array&lt; double, 3 &gt; &amp;inter, const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData1, const std::vector&lt; double &gt; &amp;yData2, const std::vector&lt; double &gt; &amp;yData3, double x, bool extrapolate) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01961">OpFastScintillation.cxx:1961</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aa78a8761b4bd4dec065441cb0d0a2070"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">larg4::OpFastScintillation::VUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00356">OpFastScintillation.hh:356</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abdb6e92550ce65018427fa5c2626a6f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4PhysicsTable * larg4::OpFastScintillation::GetFastIntegralTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00535">535</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>.get();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aade9c725e09500c55a71743d5b1bf806"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">larg4::OpFastScintillation::theFastIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theFastIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">OpFastScintillation.hh:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a453822bae262478f564459c724fc7a79"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::GetFiniteRiseTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00499">499</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae878469b0e42918cb9816f410c34a58f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">larg4::OpFastScintillation::fFiniteRiseTime</a></div><div class="ttdeci">G4bool fFiniteRiseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00286">OpFastScintillation.hh:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf94bf52ee86abfe3bb54ac09254eb01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::GetMeanFreePath </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>aTrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ForceCondition *&#160;</td>
          <td class="paramname"><em>condition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00997">997</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    *condition = StronglyForced;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span> DBL_MAX;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7dda88dd1ed0bf3a20d7d27e35fed076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::GetMeanLifeTime </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>aTrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ForceCondition *&#160;</td>
          <td class="paramname"><em>condition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01004">1004</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    *condition = Forced;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> DBL_MAX;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7cf7a03d3514cc60f83cc6145bc0e209"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4EmSaturation* larg4::OpFastScintillation::GetSaturation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00230">230</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b1e83595b2c1b230877efd434334e38"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::GetScintillationByParticleType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00241">241</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a96ffae6dd0169c1cb290f05f1b2782d4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">larg4::OpFastScintillation::scintillationByParticleType</a></div><div class="ttdeci">G4bool scintillationByParticleType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00292">OpFastScintillation.hh:292</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1da1ce87f8696d08ec043080784a6ed1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::GetScintillationExcitationRatio </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00523">523</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a76852aeab9621ed43645e8c559c8b022"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">larg4::OpFastScintillation::ExcitationRatio</a></div><div class="ttdeci">G4double ExcitationRatio</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00290">OpFastScintillation.hh:290</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a95b6f90c2384f50eca4638c9a959bcff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::GetScintillationYieldFactor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00511">511</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">YieldFactor</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac2bd26b19a7037ed64fbc6970d9d7770"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">larg4::OpFastScintillation::YieldFactor</a></div><div class="ttdeci">G4double YieldFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00288">OpFastScintillation.hh:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad7ed84a341704afc71c18dba5a81dd0c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4PhysicsTable * larg4::OpFastScintillation::GetSlowIntegralTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00529">529</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>.get();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a064dc724b2899db0b59c75d9ea6e4b7c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">larg4::OpFastScintillation::theSlowIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theSlowIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">OpFastScintillation.hh:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a066c9dcaa558cd204e61bd6bd632e36a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::GetTrackSecondariesFirst </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00493">493</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">fTrackSecondariesFirst</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8da3e7ccf57e91bb3378d29cb27cdaee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">larg4::OpFastScintillation::fTrackSecondariesFirst</a></div><div class="ttdeci">G4bool fTrackSecondariesFirst</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00285">OpFastScintillation.hh:285</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae84ba80af002d91417fb2266c95a598c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::getVISTimes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrivalTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>OpDetPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01374">1374</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">//     Calculation of earliest arrival times and corresponding unsmeared distribution</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">// set plane_depth for correct TPC:</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">double</span> plane_depth;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">if</span> (ScintPoint[0] &lt; 0) { plane_depth = -<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>; }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      plane_depth = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// calculate point of reflection for shortest path</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    TVector3 bounce_point(plane_depth,ScintPoint[1],ScintPoint[2]);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// calculate distance travelled by VUV light and by vis light</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordtype">double</span> VUVdist = (bounce_point - ScintPoint).Mag();</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordtype">double</span> Visdist = (OpDetPoint - bounce_point).Mag();</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">// calculate times taken by VUV part of path</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordtype">int</span> angle_bin_vuv = 0; <span class="comment">// on-axis by definition</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cd7c56451b5f94eb75a96e12dcef651">getVUVTimes</a>(arrivalTimes, VUVdist, angle_bin_vuv);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// add visible direct path transport time</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      arrivalTimes[i] += Visdist / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">fvis_vmean</a>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">//      Smearing of arrival time distribution</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">// calculate fastest time possible</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// vis part</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">double</span> vis_time = Visdist / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">fvis_vmean</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">// vuv part</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordtype">double</span> vuv_time;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">if</span> (VUVdist &lt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      vuv_time = VUVdist / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">fvuv_vgroup_max</a>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="comment">// find index of required parameterisation</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = std::round((VUVdist - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>) / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a>);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="comment">// find shortest time</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      vuv_time = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">VUV_min</a>[angle_bin_vuv][index];</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="comment">// sum</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordtype">double</span> fastest_time = vis_time + vuv_time;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">// calculate angle theta between bound_point and optical detector</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordtype">double</span> cosine_theta = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(OpDetPoint[0] - bounce_point[0]) / Visdist;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordtype">double</span> theta = <a class="code" href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">fast_acos</a>(cosine_theta) * 180. / <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">// determine smearing parameters using interpolation of generated points:</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">// 1). tau = exponential smearing factor, varies with distance and angle</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// 2). cutoff = largest smeared time allowed, preventing excessively large</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">//     times caused by exponential distance to cathode</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordtype">double</span> distance_cathode_plane = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(plane_depth - ScintPoint[0]);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// angular bin</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordtype">size_t</span> theta_bin = theta / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a944dc6ab3e7ee8ae1e1df70f274a7934">fangle_bin_timing_vis</a>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// radial distance from centre of TPC (y,z plane)</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> = std::sqrt(std::pow(ScintPoint[1] - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[1], 2) + std::pow(ScintPoint[2] - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>[2], 2));</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// cut-off and tau</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// cut-off</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// interpolate in d_c for each r bin</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    std::vector&lt;double&gt; interp_vals(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">fcut_off_pars</a>[theta_bin].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>(), 0.0);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">fcut_off_pars</a>[theta_bin].size(); i++){</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        interp_vals[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">fdistances_refl</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">fcut_off_pars</a>[theta_bin][i], distance_cathode_plane, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordtype">double</span> cutoff = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">fradial_distances_refl</a>, interp_vals, r, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// tau</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// interpolate in x for each r bin</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    std::vector&lt;double&gt; interp_vals_tau(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">ftau_pars</a>[theta_bin].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>(), 0.0);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">ftau_pars</a>[theta_bin].size(); i++){</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        interp_vals_tau[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">fdistances_refl</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">ftau_pars</a>[theta_bin][i], distance_cathode_plane, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordtype">double</span> tau = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">fradial_distances_refl</a>, interp_vals_tau, r, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (tau &lt; 0) { tau = 0; } <span class="comment">// failsafe if tau extrapolate goes wrong</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">// apply smearing:</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordtype">double</span> arrival_time_smeared;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="comment">// if time is already greater than cutoff, do not apply smearing</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">if</span> (arrivalTimes[i] &gt;= cutoff) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="comment">// otherwise smear</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">counter</a> = 0;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="comment">// loop until time generated is within cutoff limit</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="comment">// most are within single attempt, very few take more than two</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          <span class="comment">// don&#39;t attempt smearings too many times</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          <span class="keywordflow">if</span> (counter &gt;= 10) {                      <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            arrival_time_smeared = arrivalTimes[i]; <span class="comment">// don&#39;t smear</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="comment">// generate random number in appropriate range</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = gRandom-&gt;Uniform(0.5, 1.0); <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="comment">// apply the exponential smearing</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            arrival_time_smeared =</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;              arrivalTimes[i] + (arrivalTimes[i] - fastest_time) * (std::pow(x, -tau) - 1);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          counter++;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        } <span class="keywordflow">while</span> (arrival_time_smeared &gt; cutoff);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      arrivalTimes[i] = arrival_time_smeared;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af37aae991c13fdd84d0e445e1013d465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">larg4::OpFastScintillation::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a636af825c7b0490efcc2d361377f990c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a636af825c7b0490efcc2d361377f990c">larg4::OpFastScintillation::fdistances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fdistances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00361">OpFastScintillation.hh:361</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5ddb7228bb686dd9ba2e982878224cef"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">larg4::OpFastScintillation::VUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00357">OpFastScintillation.hh:357</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a944dc6ab3e7ee8ae1e1df70f274a7934"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a944dc6ab3e7ee8ae1e1df70f274a7934">larg4::OpFastScintillation::fangle_bin_timing_vis</a></div><div class="ttdeci">double fangle_bin_timing_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">OpFastScintillation.hh:360</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a52f187b0d853cf7833b81e52bdf7e0f6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">larg4::OpFastScintillation::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a93522458cf3401e99459b4973ad08a31"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a93522458cf3401e99459b4973ad08a31">larg4::OpFastScintillation::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4c3322018a751c9dc8dde377c676322a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">larg4::OpFastScintillation::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">OpFastScintillation.hh:408</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0ec108b3daf6f1aed81abff6459ece66"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0ec108b3daf6f1aed81abff6459ece66">larg4::OpFastScintillation::ftau_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; ftau_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00364">OpFastScintillation.hh:364</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0563fa0f8189dd11d735beeb289f436c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">larg4::OpFastScintillation::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a81e967540da71175904e177bcaa19603"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a81e967540da71175904e177bcaa19603">larg4::OpFastScintillation::fradial_distances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fradial_distances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00362">OpFastScintillation.hh:362</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3e21019631a04a7f22c3b0aaf6f79bd3"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e21019631a04a7f22c3b0aaf6f79bd3">larg4::OpFastScintillation::fcut_off_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fcut_off_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00363">OpFastScintillation.hh:363</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0cd7c56451b5f94eb75a96e12dcef651"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cd7c56451b5f94eb75a96e12dcef651">larg4::OpFastScintillation::getVUVTimes</a></div><div class="ttdeci">void getVUVTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01351">OpFastScintillation.cxx:1351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_acd58061960591a845c7530428d6e2425"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acd58061960591a845c7530428d6e2425">larg4::OpFastScintillation::fvis_vmean</a></div><div class="ttdeci">double fvis_vmean</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">OpFastScintillation.hh:360</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="namespacelarg4_html_a2e90958f76053f34c244902d2cf34c3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">larg4::fast_acos</a></div><div class="ttdeci">double fast_acos(double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02195">OpFastScintillation.cxx:2195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0cd7c56451b5f94eb75a96e12dcef651"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::getVUVTimes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrivalTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>distance_in_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>angle_bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01351">1351</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">if</span> (distance &lt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="comment">// times are fixed shift i.e. direct path only</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordtype">double</span> t_prop_correction = distance / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">fvuv_vgroup_mean</a>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        arrivalTimes[i] = t_prop_correction;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">// distance &gt;= fmin_d</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="comment">// determine nearest parameterisation in discretisation</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordtype">int</span> index = std::round((distance - <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">fmin_d</a>) / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">fstep_size</a>);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="comment">// check whether required parameterisation has been generated, generating if not</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">VUV_timing</a>[angle_bin][index].GetNdim() == 0) { <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e18bdfefefd4285bc885a75c8138dff">generateParam</a>(index, angle_bin); }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="comment">// randomly sample parameterisation for each photon</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        arrivalTimes[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">VUV_timing</a>[angle_bin][index].GetRandom(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">VUV_min</a>[angle_bin][index], <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">VUV_max</a>[angle_bin][index]);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af37aae991c13fdd84d0e445e1013d465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af37aae991c13fdd84d0e445e1013d465">larg4::OpFastScintillation::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8c7841a3917307d6c44157ea99738bc7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8c7841a3917307d6c44157ea99738bc7">larg4::OpFastScintillation::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7035b4befbb801111de32c5959b45d89"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7035b4befbb801111de32c5959b45d89">larg4::OpFastScintillation::VUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; VUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00354">OpFastScintillation.hh:354</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5ddb7228bb686dd9ba2e982878224cef"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5ddb7228bb686dd9ba2e982878224cef">larg4::OpFastScintillation::VUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00357">OpFastScintillation.hh:357</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a52f187b0d853cf7833b81e52bdf7e0f6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a52f187b0d853cf7833b81e52bdf7e0f6">larg4::OpFastScintillation::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3e18bdfefefd4285bc885a75c8138dff"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3e18bdfefefd4285bc885a75c8138dff">larg4::OpFastScintillation::generateParam</a></div><div class="ttdeci">void generateParam(const size_t index, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01252">OpFastScintillation.cxx:1252</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aa78a8761b4bd4dec065441cb0d0a2070"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa78a8761b4bd4dec065441cb0d0a2070">larg4::OpFastScintillation::VUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; VUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00356">OpFastScintillation.hh:356</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5d54689d66686566526adb0bc2fb6ecf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::interpolate </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td>
          <td class="paramname"><em>extrapolate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">1932</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = xData.size();</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt;= xData[size - 2]) { <span class="comment">// special case: beyond right end</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        i = size - 2;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xData[i + 1])</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;          i++;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordtype">double</span> xL = xData[i];</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordtype">double</span> xR = xData[i + 1];</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordtype">double</span> yL = yData[i];</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordtype">double</span> yR = yData[i + 1]; <span class="comment">// points on either side (unless beyond ends)</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">if</span> (!extrapolate) {       <span class="comment">// if beyond ends of array and not extrapolating</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; xL) <span class="keywordflow">return</span> yL;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xR) <span class="keywordflow">return</span> yL;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    }</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> dydx = (yR - yL) / (xR - xL); <span class="comment">// gradient</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">return</span> yL + dydx * (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - xL);               <span class="comment">// linear interpolation</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  }</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20b1c3f11842b0a9a92fd0c136f046d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::interpolate3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>inter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td>
          <td class="paramname"><em>extrapolate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01961">1961</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = xData.size();</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordtype">size_t</span> i = 0;               <span class="comment">// find left end of interval for interpolation</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt;= xData[size - 2]) { <span class="comment">// special case: beyond right end</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      i = size - 2;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xData[i + 1])</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        i++;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordtype">double</span> xL = xData[i];</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordtype">double</span> xR = xData[i + 1]; <span class="comment">// points on either side (unless beyond ends)</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordtype">double</span> yL1 = yData1[i];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordtype">double</span> yR1 = yData1[i + 1];</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordtype">double</span> yL2 = yData2[i];</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="keywordtype">double</span> yR2 = yData2[i + 1];</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordtype">double</span> yL3 = yData3[i];</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keywordtype">double</span> yR3 = yData3[i + 1];</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="keywordflow">if</span> (!extrapolate) { <span class="comment">// if beyond ends of array and not extrapolating</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; xL) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        inter[0] = yL1;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        inter[1] = yL2;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        inter[2] = yL3;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xR) {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        inter[0] = yL1;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        inter[1] = yL2;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        inter[2] = yL3;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a> = (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - xL) / (xR - xL);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    inter[0] = m * (yR1 - yL1) + yL1;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    inter[1] = m * (yR2 - yL2) + yL2;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    inter[2] = m * (yR3 - yL3) + yL3;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  }</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a55a56854d78e363691470c7297fde77c"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">gen_crt_frags.m</a></div><div class="ttdeci">tuple m</div><div class="ttdoc">now if test mode generate materials, CRT shell, world, gdml header else just generate CRT shell for u...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01347">gen_crt_frags.py:1347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2ecae910924fb15418d0a67e081a55c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::IsApplicable </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition &amp;&#160;</td>
          <td class="paramname"><em>aParticleType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00472">472</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (aParticleType.GetParticleName() == <span class="stringliteral">&quot;opticalphoton&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (aParticleType.IsShortLived()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ddf47e1ef56bfe5449e119604e63465"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::isOpDetInSameTPC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>OpDetPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01822">1822</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">// check optical channel is in same TPC as scintillation light, if not return 0 hits</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// temporary method working for SBND, uBooNE, DUNE 1x2x6; to be replaced to work in full DUNE geometry</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// check x coordinate has same sign or is close to zero, otherwise return 0 hits</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">if</span> (((ScintPoint.X() &lt; 0.) != (OpDetPoint.X() &lt; 0.)) &amp;&amp;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(OpDetPoint.X()) &gt; 10.) { <span class="comment">// TODO: unhardcode</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  }</div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8a7e6435cb535cec2ecd110f6d8a1e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::isScintInActiveVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01836">1836</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="comment">//semi-analytic approach only works in the active volume</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">fActiveVolumes</a>[0].ContainsPosition(ScintPoint);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac0c08417aab17cdfc0d15258c1914a7e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac0c08417aab17cdfc0d15258c1914a7e">larg4::OpFastScintillation::fActiveVolumes</a></div><div class="ttdeci">std::vector&lt; geo::BoxBoundedGeo &gt; const fActiveVolumes</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00409">OpFastScintillation.hh:409</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c8bcfdaaeea917bfd16f95671d45da1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::Omega_Dome_Model </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02140">2140</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                                                                              {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="comment">// this function calculates the solid angle of a semi-sphere of radius b,</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="comment">// as a correction to the analytic formula of the on-axix solid angle,</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="comment">// as we move off-axis an angle theta. We have used 9-angular bins</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="comment">// with delta_theta width.</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="comment">// par0 = Radius correction close</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="comment">// par1 = Radius correction far</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="comment">// par2 = breaking distance betwween &quot;close&quot; and &quot;far&quot;</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="keywordtype">double</span> par0[9] = {0., 0., 0., 0., 0., 0.597542, 1.00872, 1.46993, 2.04221};</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="keywordtype">double</span> par1[9] = {0, 0, 0.19569, 0.300449, 0.555598, 0.854939, 1.39166, 2.19141, 2.57732};</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> delta_theta = 10.;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="keywordtype">int</span> j = int(theta/delta_theta);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="comment">// PMT radius</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a>; <span class="comment">// cm</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// distance form which the model parameters break (empirical value)</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> d_break = 5*b; <span class="comment">//par2</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">if</span>(distance &gt;= d_break) {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordtype">double</span> R_apparent_far = b - par1[j];</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">return</span>  (2*<a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> * (1 - std::sqrt(1 - std::pow(R_apparent_far/distance,2))));</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="keywordtype">double</span> R_apparent_close = b - par0[j];</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">return</span> (2*<a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a> * (1 - std::sqrt(1 - std::pow(R_apparent_close/distance,2))));</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;}</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afbacbb2ba255f4f2c831a8e22a944225"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">larg4::OpFastScintillation::fradius</a></div><div class="ttdeci">double fradius</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00414">OpFastScintillation.hh:414</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a630668b55faf8fd7231e028d5435a6b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4VParticleChange * larg4::OpFastScintillation::PostStepDoIt </td>
          <td>(</td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>aTrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00425">425</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    aParticleChange.Initialize(aTrack);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// Check that we are in a material with a properties table, if not</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// just return</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">const</span> G4Material* aMaterial = aTrack.GetMaterial();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    G4MaterialPropertiesTable* aMaterialPropertiesTable = aMaterial-&gt;GetMaterialPropertiesTable();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (!aMaterialPropertiesTable) <span class="keywordflow">return</span> G4VRestDiscreteProcess::PostStepDoIt(aTrack, aStep);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    G4StepPoint* pPreStepPoint = aStep.GetPreStepPoint();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    G4ThreeVector x0 = pPreStepPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    G4ThreeVector p0 = aStep.GetDeltaPosition().unit();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    ///////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span>    <span class="comment">//   This is the old G4 way - but we do things differently - Ben J, Oct Nov 2012.</span><span class="comment"></span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    ///////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span>    <span class="comment">//</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">//     if (MeanNumberOfPhotons &gt; 10.)</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">//      {</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//        G4double sigma = ResolutionScale * std::sqrt(MeanNumberOfPhotons);</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">//        NumPhotons = G4int(G4RandGauss::shoot(MeanNumberOfPhotons,sigma)+0.5);</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//      }</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//     else</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//      {</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//        NumPhotons = G4int(G4Poisson(MeanNumberOfPhotons));</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//      }</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">//        if (NumPhotons &lt;= 0)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//        {</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">//  // return unchanged particle and no secondaries</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">//           aParticleChange.SetNumberOfSecondaries(0);</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">//           return G4VRestDiscreteProcess::PostStepDoIt(aTrack, aStep);</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">//        }</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">//       aParticleChange.SetNumberOfSecondaries(NumPhotons);</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//        if (fTrackSecondariesFirst) {</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">//           if (aTrack.GetTrackStatus() == fAlive )</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//                  aParticleChange.ProposeTrackStatus(fSuspend);</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">//        }</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">    ////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span>    <span class="comment">//</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">    ////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span>    <span class="comment">//  The fast sim way - Ben J, Nov 2012</span><span class="comment"></span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">    ////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span>    <span class="comment">//</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// We don&#39;t want to produce any trackable G4 secondaries</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    aParticleChange.SetNumberOfSecondaries(0);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Retrieve the Scintillation Integral for this material</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// new G4PhysicsOrderedFreeVector allocated to hold CII&#39;s</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// Some explanation for later improvements to scint yield code:</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// What does G4 do here?</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">//  It produces light in 2 steps, fast (scnt=1) then slow (scnt=2)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// The ratio of slow photons to fast photons is related        by the yieldratio</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">//  parameter.  G4&#39;s poisson fluctuating scheme is a bit different to ours</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">//  - we should check that they are equivalent.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// G4 poisson fluctuates the number of initial photons then divides them</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">//  with a constant factor between fast + slow, whereas we poisson</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">//  fluctuate separateyly the fast and slow detection numbers.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// get the number of photons produced from the IonizationAndScintillation</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// singleton</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a36d3b1ef43576b020ca130e80f069e84">Reset</a>(&amp;aStep);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">double</span> MeanNumberOfPhotons =</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a770cdb9f511f11351657e397f75c982d">NumberScintillationPhotons</a>();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// double stepEnergy          = larg4::IonizationAndScintillation::Instance()-&gt;VisibleEnergyDeposit()/CLHEP::MeV;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a647336b4bc721eff8745d41d52e70320">RecordPhotonsProduced</a>(aStep, MeanNumberOfPhotons); <span class="comment">//, stepEnergy);</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (verboseLevel &gt; 0) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      G4cout &lt;&lt; <span class="stringliteral">&quot;\n Exiting from OpFastScintillation::DoIt -- NumberOfSecondaries = &quot;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;             &lt;&lt; aParticleChange.GetNumberOfSecondaries() &lt;&lt; G4endl;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span> G4VRestDiscreteProcess::PostStepDoIt(aTrack, aStep);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a36d3b1ef43576b020ca130e80f069e84"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a36d3b1ef43576b020ca130e80f069e84">larg4::IonizationAndScintillation::Reset</a></div><div class="ttdeci">void Reset(const G4Step *step)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00098">IonizationAndScintillation.cxx:98</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a647336b4bc721eff8745d41d52e70320"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a647336b4bc721eff8745d41d52e70320">larg4::OpFastScintillation::RecordPhotonsProduced</a></div><div class="ttdeci">bool RecordPhotonsProduced(const G4Step &amp;aStep, double N)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00545">OpFastScintillation.cxx:545</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a30d440651b97effb3a48f67d3ad4d5f1"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a></div><div class="ttdeci">static IonizationAndScintillation * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00044">IonizationAndScintillation.cxx:44</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a770cdb9f511f11351657e397f75c982d"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a770cdb9f511f11351657e397f75c982d">larg4::IonizationAndScintillation::NumberScintillationPhotons</a></div><div class="ttdeci">double NumberScintillationPhotons() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/IonizationAndScintillation_8h_source.html#l00058">IonizationAndScintillation.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad94c040f0c06732a61c6a21e296cc60d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::ProcessStep </td>
          <td>(</td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>step</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00522">522</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> (step.GetTotalEnergyDeposit() &lt;= 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a8e1d2081518c789bb29a4b6ce1ec5f76">OpDetPhotonTable::Instance</a>()-&gt;<a class="code" href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a30ae62c19e9c7d9d90453137610a3017">AddEnergyDeposit</a>(</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      -1,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      -1,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      1.0,                                                 <span class="comment">//scintillation yield</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      (<span class="keywordtype">double</span>)(step.GetTotalEnergyDeposit() / <a class="code" href="../../da/dc7/TriggerEfficiencyPlots__module_8cc.html#ac771d2ad6d0ad30734b0590a6461dd20">CLHEP::MeV</a>), <span class="comment">//energy in MeV</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPreStepPoint()-&gt;GetPosition().x() / CLHEP::cm),</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPreStepPoint()-&gt;GetPosition().y() / CLHEP::cm),</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPreStepPoint()-&gt;GetPosition().z() / CLHEP::cm),</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPostStepPoint()-&gt;GetPosition().x() / CLHEP::cm),</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPostStepPoint()-&gt;GetPosition().y() / CLHEP::cm),</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      (<span class="keywordtype">float</span>)(step.GetPostStepPoint()-&gt;GetPosition().z() / CLHEP::cm),</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      (<span class="keywordtype">double</span>)(step.GetPreStepPoint()-&gt;GetGlobalTime()),</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      (<span class="keywordtype">double</span>)(step.GetPostStepPoint()-&gt;GetGlobalTime()),</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">//step.GetTrack()-&gt;GetTrackID(),</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">ParticleListAction::GetCurrentTrackID</a>(),</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      step.GetTrack()-&gt;GetParticleDefinition()-&gt;GetPDGEncoding(),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      step.GetPreStepPoint()-&gt;GetPhysicalVolume()-&gt;GetName());</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div>
<div class="ttc" id="TriggerEfficiencyPlots__module_8cc_html_ac771d2ad6d0ad30734b0590a6461dd20"><div class="ttname"><a href="../../da/dc7/TriggerEfficiencyPlots__module_8cc.html#ac771d2ad6d0ad30734b0590a6461dd20">MeV</a></div><div class="ttdeci">util::quantities::megaelectronvolt MeV</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc7/TriggerEfficiencyPlots__module_8cc_source.html#l00089">TriggerEfficiencyPlots_module.cc:89</a></div></div>
<div class="ttc" id="classlarg4_1_1OpDetPhotonTable_html_a8e1d2081518c789bb29a4b6ce1ec5f76"><div class="ttname"><a href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a8e1d2081518c789bb29a4b6ce1ec5f76">larg4::OpDetPhotonTable::Instance</a></div><div class="ttdeci">static OpDetPhotonTable * Instance(bool LitePhotons=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6e/OpDetPhotonTable_8cxx_source.html#l00032">OpDetPhotonTable.cxx:32</a></div></div>
<div class="ttc" id="classlarg4_1_1ParticleListAction_html_adbeb4f865250923b00533c44136ff9a3"><div class="ttname"><a href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">larg4::ParticleListAction::GetCurrentTrackID</a></div><div class="ttdeci">static int GetCurrentTrackID()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/ParticleListAction_8h_source.html#l00118">ParticleListAction.h:118</a></div></div>
<div class="ttc" id="classlarg4_1_1OpDetPhotonTable_html_a30ae62c19e9c7d9d90453137610a3017"><div class="ttname"><a href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a30ae62c19e9c7d9d90453137610a3017">larg4::OpDetPhotonTable::AddEnergyDeposit</a></div><div class="ttdeci">void AddEnergyDeposit(int n_photon, int n_elec, double scint_yield, double energy, float start_x, float start_y, float start_z, float end_x, float end_y, float end_z, double start_time, double end_time, int trackid, int pdgcode, std::string const &amp;vol=&quot;EMPTY&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6e/OpDetPhotonTable_8cxx_source.html#l00202">OpDetPhotonTable.cxx:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84ea1001348191bda5f3708042b2d0aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::propagationTime </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrival_time_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ThreeVector&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>OpChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td>
          <td class="paramname"><em>Reflected</em> = <code><a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01028">1028</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    assert(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">IncludeParPropTime</a>() &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aab173e0567c088a08bb3345716b315ae">IncludePropTime</a>()) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Cannot have both propagation time models simultaneously.&quot;</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">IncludeParPropTime</a>() &amp;&amp;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;             !(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">ParPropTimeTF1</a> &amp;&amp; (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">ParPropTimeTF1</a>[OpChannel].GetNdim() == 1))) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">//Warning: TF1::GetNdim()==1 will tell us if the TF1 is really defined or it is the default one.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">//This will fix a segfault when using timing and interpolation.</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      G4cout &lt;&lt; <span class="stringliteral">&quot;WARNING: Requested parameterized timing, but no function found. Not applying &quot;</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                <span class="stringliteral">&quot;propagation time.&quot;</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;             &lt;&lt; G4endl;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">IncludeParPropTime</a>()) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">if</span> (Reflected)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;OpFastScintillation&quot;</span>)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;No parameterized propagation time for reflected light&quot;</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrival_time_dist.size(); ++i) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        arrival_time_dist[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">ParPropTimeTF1</a>[OpChannel].GetRandom();</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aab173e0567c088a08bb3345716b315ae">IncludePropTime</a>()) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">// Get VUV photons arrival time distribution from the parametrization</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; opDetCenter = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpChannel);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">if</span> (!Reflected) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keyword">const</span> G4ThreeVector OpDetPoint(</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          opDetCenter.X() * CLHEP::cm, opDetCenter.Y() * CLHEP::cm, opDetCenter.Z() * CLHEP::cm);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordtype">double</span> distance_in_cm = (x0 - OpDetPoint).mag() / CLHEP::cm; <span class="comment">// this must be in CENTIMETERS!</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordtype">double</span> cosine = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(x0[0]*CLHEP::cm - OpDetPoint[0]*CLHEP::cm) / distance_in_cm;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordtype">double</span> theta = <a class="code" href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">fast_acos</a>(cosine)*180./<a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordtype">int</span> angle_bin = theta/<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">fangle_bin_timing_vuv</a>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cd7c56451b5f94eb75a96e12dcef651">getVUVTimes</a>(arrival_time_dist, distance_in_cm, angle_bin);              <span class="comment">// in ns</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        TVector3 <span class="keyword">const</span> ScintPoint(x0[0] / CLHEP::cm, x0[1] / CLHEP::cm, x0[2] / CLHEP::cm); <span class="comment">// in cm</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae84ba80af002d91417fb2266c95a598c">getVISTimes</a>(arrival_time_dist, ScintPoint, <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a>(opDetCenter));     <span class="comment">// in ns</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_aab173e0567c088a08bb3345716b315ae"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#aab173e0567c088a08bb3345716b315ae">phot::PhotonVisibilityService::IncludePropTime</a></div><div class="ttdeci">bool IncludePropTime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00196">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:196</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9133f6ec2aad11f06c6450b31d10081f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">larg4::OpFastScintillation::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">OpFastScintillation.hh:417</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae84ba80af002d91417fb2266c95a598c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae84ba80af002d91417fb2266c95a598c">larg4::OpFastScintillation::getVISTimes</a></div><div class="ttdeci">void getVISTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const TVector3 &amp;ScintPoint, const TVector3 &amp;OpDetPoint)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01374">OpFastScintillation.cxx:1374</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0cd7c56451b5f94eb75a96e12dcef651"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cd7c56451b5f94eb75a96e12dcef651">larg4::OpFastScintillation::getVUVTimes</a></div><div class="ttdeci">void getVUVTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01351">OpFastScintillation.cxx:1351</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a2de0745d12bd608fe66a141667764c69"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a></div><div class="ttdeci">TVector3 toTVector3(Vector const &amp;v)</div><div class="ttdoc">Converts a vector into a TVector3. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/geo__vectors__utils__TVector_8h_source.html#l00043">geo_vectors_utils_TVector.h:43</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a00d0364f20281bcc4b3f41784335f3ed"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">larg4::OpFastScintillation::fPVS</a></div><div class="ttdeci">phot::PhotonVisibilityService const *const fPVS</div><div class="ttdoc">Photon visibility service instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">OpFastScintillation.hh:428</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a4fe4087419d5e1ab0bbbf266ceac1c86"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">phot::PhotonVisibilityService::IncludeParPropTime</a></div><div class="ttdeci">bool IncludeParPropTime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00180">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:180</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a22593277a1ca27ab95c98e70e50b800c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">larg4::OpFastScintillation::ParPropTimeTF1</a></div><div class="ttdeci">phot::MappedFunctions_t ParPropTimeTF1</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00340">OpFastScintillation.hh:340</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a84145a771638c07c31d6f38242c4494c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84145a771638c07c31d6f38242c4494c">larg4::OpFastScintillation::fangle_bin_timing_vuv</a></div><div class="ttdeci">double fangle_bin_timing_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">OpFastScintillation.hh:351</a></div></div>
<div class="ttc" id="namespacelarg4_html_a2e90958f76053f34c244902d2cf34c3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">larg4::fast_acos</a></div><div class="ttdeci">double fast_acos(double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02195">OpFastScintillation.cxx:2195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a647336b4bc721eff8745d41d52e70320"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::RecordPhotonsProduced </td>
          <td>(</td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00545">545</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// make sure that whatever happens afterwards, the energy deposition is stored</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    art::ServiceHandle&lt;sim::LArG4Parameters const&gt; lgp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (lgp-&gt;FillSimEnergyDeposits()) <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad94c040f0c06732a61c6a21e296cc60d">ProcessStep</a>(aStep);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// Get the pointer to the fast scintillation table</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    OpDetPhotonTable* fst = <a class="code" href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a8e1d2081518c789bb29a4b6ce1ec5f76">OpDetPhotonTable::Instance</a>();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keyword">const</span> G4Track* aTrack = aStep.GetTrack();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    G4StepPoint <span class="keyword">const</span>* pPreStepPoint = aStep.GetPreStepPoint();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// unused G4StepPoint const* pPostStepPoint = aStep.GetPostStepPoint();</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keyword">const</span> G4DynamicParticle* aParticle = aTrack-&gt;GetDynamicParticle();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keyword">const</span> G4Material* aMaterial = aTrack-&gt;GetMaterial();</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    G4int materialIndex = aMaterial-&gt;GetIndex();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    G4int tracknumber = aStep.GetTrack()-&gt;GetTrackID();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    G4ThreeVector x0 = pPreStepPoint-&gt;GetPosition();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    G4ThreeVector p0 = aStep.GetDeltaPosition().unit();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">//G4double      t0 = pPreStepPoint-&gt;GetGlobalTime() - fGlobalTimeOffset;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    G4double <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a> = pPreStepPoint-&gt;GetGlobalTime();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    G4MaterialPropertiesTable* aMaterialPropertiesTable = aMaterial-&gt;GetMaterialPropertiesTable();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    G4MaterialPropertyVector* Fast_Intensity =</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      aMaterialPropertiesTable-&gt;GetProperty(<span class="stringliteral">&quot;FASTCOMPONENT&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    G4MaterialPropertyVector* Slow_Intensity =</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      aMaterialPropertiesTable-&gt;GetProperty(<span class="stringliteral">&quot;SLOWCOMPONENT&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (!Fast_Intensity &amp;&amp; !Slow_Intensity) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">bPropagate</a>) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Get the visibility vector for this point</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    assert(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    G4int nscnt = 1;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">if</span> (Fast_Intensity &amp;&amp; Slow_Intensity) nscnt = 2;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">double</span> Num = 0;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">double</span> YieldRatio = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a>) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">// The scintillation response is a function of the energy</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">// deposited by particle types.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">// Get the definition of the current particle</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      G4ParticleDefinition* pDef = aParticle-&gt;GetDefinition();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// Obtain the G4MaterialPropertyVectory containing the</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">// scintillation light yield as a function of the deposited</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// energy for the current particle type</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">// Protons</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">if</span> (pDef == G4Proton::ProtonDefinition()) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;PROTONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="comment">// Muons</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDef == G4MuonPlus::MuonPlusDefinition() ||</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;               pDef == G4MuonMinus::MuonMinusDefinition()) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;MUONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="comment">// Pions</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDef == G4PionPlus::PionPlusDefinition() ||</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;               pDef == G4PionMinus::PionMinusDefinition()) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;PIONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">// Kaons</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDef == G4KaonPlus::KaonPlusDefinition() ||</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;               pDef == G4KaonMinus::KaonMinusDefinition()) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;KAONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// Alphas</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDef == G4Alpha::AlphaDefinition()) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;ALPHAYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="comment">// Electrons (must also account for shell-binding energy</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// attributed to gamma from standard PhotoElectricEffect)</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDef == G4Electron::ElectronDefinition() || pDef == G4Gamma::GammaDefinition()) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;ELECTRONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// Default for particles not enumerated/listed above</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;ELECTRONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">// If the user has not specified yields for (p,d,t,a,carbon)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// then these unspecified particles will default to the</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="comment">// electron&#39;s scintillation yield</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">if</span> (YieldRatio == 0) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;ELECTRONYIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span> ScintPoint = {x0[0] / CLHEP::cm, x0[1] / CLHEP::cm, x0[2] / CLHEP::cm};</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">fOnlyActiveVolume</a> &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa8a7e6435cb535cec2ecd110f6d8a1e5">isScintInActiveVolume</a>(ScintPoint)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d9/dd4/classphot_1_1OpDetVisibilityData.html">phot::MappedCounts_t</a>&amp; Visibilities = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ab4c5e18a6121c4cfd1290b730e99bfc2">GetAllVisibilities</a>(ScintPoint);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="../../d9/dd4/classphot_1_1OpDetVisibilityData.html">phot::MappedCounts_t</a> ReflVisibilities;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// Store timing information in the object for use in propagationTime method</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">StoreReflected</a>()) {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      ReflVisibilities = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ab4c5e18a6121c4cfd1290b730e99bfc2">GetAllVisibilities</a>(ScintPoint, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ab9991e67f5ef4da6e3462d9561b46ada">StoreReflT0</a>()) <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaac06190fa1fced63c3464db9b08a348">ReflT0s</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a42975425cee174d35c43f7ba3fec8521">GetReflT0s</a>(ScintPoint);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">IncludeParPropTime</a>()) { <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">ParPropTimeTF1</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a57d00151bfec63ad517d42e619cef34f">GetTimingTF1</a>(ScintPoint); }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">    // For Kazu to debug # photons generated using csv file, by default should be commented out</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">    // but don&#39;t remove as it&#39;s useful. Separated portion of code relevant to this block</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">    // is labeled as &quot;CASE-DEBUG DO NOT REMOVE THIS COMMENT&quot;</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">    // (2017 May 2nd ... &quot;kazuhiro at nevis dot columbia dot edu&quot;)</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    //</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">    static bool first_time=false;</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">    if(!first_time) {</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">    std::cout&lt;&lt;&quot;LOGMEid,pdg,mass,ke,te,de,x,y,z,t,dr,mean_npe,gen_npe,det_npe&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">    first_time=true;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">    std::cout&lt;&lt;&quot;LOGME&quot;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">    &lt;&lt;aStep.GetTrack()-&gt;GetTrackID()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">    &lt;&lt;aParticle-&gt;GetDefinition()-&gt;GetPDGEncoding()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">    &lt;&lt;aParticle-&gt;GetDefinition()-&gt;GetPDGMass()/CLHEP::MeV&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">    &lt;&lt;pPreStepPoint-&gt;GetKineticEnergy()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">    &lt;&lt;pPreStepPoint-&gt;GetTotalEnergy()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">    &lt;&lt;aStep.GetTotalEnergyDeposit()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">    &lt;&lt;ScintPoint&lt;&lt;&quot;,&quot;&lt;&lt;t0&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">    &lt;&lt;aStep.GetDeltaPosition().mag()&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">    &lt;&lt;MeanNumberOfPhotons&lt;&lt;&quot;,&quot;&lt;&lt;std::flush;</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">    double gen_photon_ctr=0;</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">    double det_photon_ctr=0;</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">for</span> (G4int scnt = 1; scnt &lt;= nscnt; scnt++) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      G4double ScintillationTime = 0. * CLHEP::ns;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      G4double ScintillationRiseTime = 0. * CLHEP::ns;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      G4PhysicsOrderedFreeVector* ScintillationIntegral = NULL;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> (scnt == 1) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> (nscnt == 1) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="keywordflow">if</span> (Fast_Intensity) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            ScintillationTime = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;FASTTIMECONSTANT&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a>) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;              ScintillationRiseTime =</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;FASTSCINTILLATIONRISETIME&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            ScintillationIntegral =</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;              (G4PhysicsOrderedFreeVector*)((*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>)(materialIndex));</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          <span class="keywordflow">if</span> (Slow_Intensity) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            ScintillationTime = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;SLOWTIMECONSTANT&quot;</span>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a>) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;              ScintillationRiseTime =</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;SLOWSCINTILLATIONRISETIME&quot;</span>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            ScintillationIntegral =</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              (G4PhysicsOrderedFreeVector*)((*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>)(materialIndex));</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        } <span class="comment">//endif nscnt=1</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          <span class="keywordflow">if</span> (YieldRatio == 0)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            YieldRatio = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;YIELDRATIO&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a> == 1.0) { Num = std::min(YieldRatio, 1.0) * MeanNumberOfPhotons; }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            Num = std::min(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a>, 1.0) * MeanNumberOfPhotons;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          ScintillationTime = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;FASTTIMECONSTANT&quot;</span>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a>) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            ScintillationRiseTime =</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;              aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;FASTSCINTILLATIONRISETIME&quot;</span>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          ScintillationIntegral =</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            (G4PhysicsOrderedFreeVector*)((*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">theFastIntegralTable</a>)(materialIndex));</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        } <span class="comment">//endif nscnt!=1</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      }   <span class="comment">//end scnt=1</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        Num = MeanNumberOfPhotons - Num;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        ScintillationTime = aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;SLOWTIMECONSTANT&quot;</span>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a>) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          ScintillationRiseTime =</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            aMaterialPropertiesTable-&gt;GetConstProperty(<span class="stringliteral">&quot;SLOWSCINTILLATIONRISETIME&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        ScintillationIntegral =</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          (G4PhysicsOrderedFreeVector*)((*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">theSlowIntegralTable</a>)(materialIndex));</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">if</span> (!ScintillationIntegral) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">//gen_photon_ctr += Num; // CASE-DEBUG DO NOT REMOVE THIS COMMENT</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="comment">// Max Scintillation Integral</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="comment">//            G4double CIImax = ScintillationIntegral-&gt;GetMaxValue();</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;++++++++++++&quot; &lt;&lt; Num &lt;&lt; &quot;++++++++++&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="comment">// here we go: now if visibilities are invalid, we are in trouble</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="comment">//if (!Visibilities &amp;&amp; (fPVS-&gt;NOpChannels() &gt; 0)) {</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="comment">//  throw cet::exception(&quot;OpFastScintillator&quot;)</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">//    &lt;&lt; &quot;Photon library does not cover point &quot; &lt;&lt; ScintPoint &lt;&lt; &quot; cm.\n&quot;;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">if</span> (!Visibilities &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">// detected photons from direct light</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      std::map&lt;size_t, int&gt; DetectedNum;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">if</span> (Visibilities &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>()) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> OpDet : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">NOpChannels</a>())) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa4bd5196829b1a1ac8ce863091fedb53">fOpaqueCathode</a> &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">isOpDetInSameTPC</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet))) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="keywordtype">int</span> <span class="keyword">const</span> DetThis = std::round(G4Poisson(Visibilities[OpDet] * Num));</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          <span class="keywordflow">if</span> (DetThis &gt; 0) DetectedNum[OpDet] = DetThis;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ddbf2ecd690f04d2ca60ca29498ec16">detectedDirectHits</a>(DetectedNum, Num, ScintPoint);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="comment">// detected photons from reflected light</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      std::map&lt;size_t, int&gt; ReflDetectedNum;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">StoreReflected</a>()) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">usesSemiAnalyticModel</a>()) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> OpDet : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">NOpChannels</a>())) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa4bd5196829b1a1ac8ce863091fedb53">fOpaqueCathode</a> &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">isOpDetInSameTPC</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">fOpDetCenter</a>.at(OpDet))) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordtype">int</span> <span class="keyword">const</span> ReflDetThis = std::round(G4Poisson(ReflVisibilities[OpDet] * Num));</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">if</span> (ReflDetThis &gt; 0) ReflDetectedNum[OpDet] = ReflDetThis;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a50926aab8f0a269cc3f8d0bb8120d933">detectedReflecHits</a>(ReflDetectedNum, Num, ScintPoint);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      std::vector&lt;double&gt; arrival_time_dist;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="comment">// Now we run through each PMT figuring out num of detected photons</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Reflected = 0; Reflected &lt;= 1; ++Reflected) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="comment">// Only do the reflected loop if we have reflected visibilities</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">if</span> (Reflected &amp;&amp; !<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">fPVS</a>-&gt;<a class="code" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">StoreReflected</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        std::map&lt;size_t, int&gt;::const_iterator itstart;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        std::map&lt;size_t, int&gt;::const_iterator itend;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span> (Reflected) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          itstart = ReflDetectedNum.begin();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          itend = ReflDetectedNum.end();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          itstart = DetectedNum.begin();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          itend = DetectedNum.end();</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> itdetphot = itstart; itdetphot != itend; ++itdetphot) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">size_t</span> OpChannel = itdetphot-&gt;first;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> NPhotons = itdetphot-&gt;second;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          <span class="comment">// Set up the OpDetBTR information</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          <a class="code" href="../../dd/d36/classsim_1_1OpDetBacktrackerRecord.html">sim::OpDetBacktrackerRecord</a> tmpOpDetBTRecord(OpChannel);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          <span class="keywordtype">int</span> thisG4TrackID = <a class="code" href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">ParticleListAction::GetCurrentTrackID</a>();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          <span class="keywordtype">double</span> xyzPos[3];</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#abce84220570f42dca9aef2116444ce7d">average_position</a>(aStep, xyzPos);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          <span class="keywordtype">double</span> Edeposited = 0;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a>) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="comment">//We use this when it is the only sensical information. It may be of limited use to end users.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            Edeposited = aStep.GetTotalEnergyDeposit();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a>) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="comment">//If Birk Coefficient used, log VisibleEnergies.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            Edeposited =</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;              <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#ab898cd621f38d4a3ba7cba74519e350c">VisibleEnergyDeposit</a>() / <a class="code" href="../../da/dc7/TriggerEfficiencyPlots__module_8cc.html#ac771d2ad6d0ad30734b0590a6461dd20">CLHEP::MeV</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">//We use this when it is the only sensical information. It may be of limited use to end users.</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            Edeposited = aStep.GetTotalEnergyDeposit();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;          <span class="comment">// Get the transport time distribution</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          arrival_time_dist.resize(NPhotons);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84ea1001348191bda5f3708042b2d0aa">propagationTime</a>(arrival_time_dist, x0, OpChannel, Reflected);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          <span class="comment">//We need to split the energy up by the number of photons so that we never try to write a 0 energy.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;          Edeposited = Edeposited / double(NPhotons);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          <span class="comment">// Loop through the photons</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          <span class="keywordflow">for</span> (G4int i = 0; i &lt; NPhotons; ++i) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="comment">//std::cout&lt;&lt;&quot;VUV time correction: &quot;&lt;&lt;arrival_time_dist[i]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            G4double Time = t0 + <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac268e718c4272ba70f59249ce2f4d1c7">scint_time</a>(aStep, ScintillationTime, ScintillationRiseTime) +</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                            arrival_time_dist[i] * CLHEP::ns;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="comment">// Always store the BTR</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            tmpOpDetBTRecord.AddScintillationPhotons(thisG4TrackID, Time, 1, xyzPos, Edeposited);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// Store as lite photon or as OnePhoton</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span> (lgp-&gt;UseLitePhotons()) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;              fst-&gt;AddLitePhoton(OpChannel, static_cast&lt;int&gt;(Time), 1, Reflected);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;              <span class="comment">// The sim photon in this case stores its production point and time</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;              TVector3 PhotonPosition(x0[0], x0[1], x0[2]);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;              <span class="keywordtype">float</span> PhotonEnergy = 0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              <span class="keywordflow">if</span> (Reflected)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                PhotonEnergy = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9a9e45eb46a2f325c0b85dba8e43fa7e">reemission_energy</a>() * CLHEP::eV;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                PhotonEnergy = 9.7 * CLHEP::eV; <span class="comment">// 9.7 eV peak of VUV emission spectrum</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;              <span class="comment">// Make a photon object for the collection</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              <a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html">sim::OnePhoton</a> PhotToAdd;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;              PhotToAdd.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a2c524ee4618d5091358a4fba57d6bbd0">InitialPosition</a> = PhotonPosition;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;              PhotToAdd.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#ade1e95cbc4acebdd2b61046b3035113b">Energy</a> = PhotonEnergy;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;              PhotToAdd.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a821c9e06cd12efb223004d78c9fcb57e">Time</a> = Time;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;              PhotToAdd.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a9811e0658d83df0ea88ce0d60129c9e5">SetInSD</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;              PhotToAdd.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a5e7026752a387def764e51d4c56b537f">MotherTrackID</a> = tracknumber;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;              fst-&gt;AddPhoton(OpChannel, std::move(PhotToAdd), Reflected);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          fst-&gt;AddOpDetBacktrackerRecord(tmpOpDetBTRecord, Reflected);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">//std::cout&lt;&lt;gen_photon_ctr&lt;&lt;&quot;,&quot;&lt;&lt;det_photon_ctr&lt;&lt;std::endl; // CASE-DEBUG DO NOT REMOVE THIS COMMENT</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a96ffae6dd0169c1cb290f05f1b2782d4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">larg4::OpFastScintillation::scintillationByParticleType</a></div><div class="ttdeci">G4bool scintillationByParticleType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00292">OpFastScintillation.hh:292</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8ddbf2ecd690f04d2ca60ca29498ec16"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ddbf2ecd690f04d2ca60ca29498ec16">larg4::OpFastScintillation::detectedDirectHits</a></div><div class="ttdeci">void detectedDirectHits(std::map&lt; size_t, int &gt; &amp;DetectedNum, const double Num, geo::Point_t const &amp;ScintPoint) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01499">OpFastScintillation.cxx:1499</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_ab9991e67f5ef4da6e3462d9561b46ada"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ab9991e67f5ef4da6e3462d9561b46ada">phot::PhotonVisibilityService::StoreReflT0</a></div><div class="ttdeci">bool StoreReflT0() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00175">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:175</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a50926aab8f0a269cc3f8d0bb8120d933"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a50926aab8f0a269cc3f8d0bb8120d933">larg4::OpFastScintillation::detectedReflecHits</a></div><div class="ttdeci">void detectedReflecHits(std::map&lt; size_t, int &gt; &amp;ReflDetectedNum, const double Num, geo::Point_t const &amp;ScintPoint) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01521">OpFastScintillation.cxx:1521</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_abce84220570f42dca9aef2116444ce7d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#abce84220570f42dca9aef2116444ce7d">larg4::OpFastScintillation::average_position</a></div><div class="ttdeci">void average_position(G4Step const &amp;aStep, double *xzyPos) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01102">OpFastScintillation.cxx:1102</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aa8a7e6435cb535cec2ecd110f6d8a1e5"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa8a7e6435cb535cec2ecd110f6d8a1e5">larg4::OpFastScintillation::isScintInActiveVolume</a></div><div class="ttdeci">bool isScintInActiveVolume(geo::Point_t const &amp;ScintPoint)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01836">OpFastScintillation.cxx:1836</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9133f6ec2aad11f06c6450b31d10081f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9133f6ec2aad11f06c6450b31d10081f">larg4::OpFastScintillation::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">OpFastScintillation.hh:417</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_ab898cd621f38d4a3ba7cba74519e350c"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#ab898cd621f38d4a3ba7cba74519e350c">larg4::IonizationAndScintillation::VisibleEnergyDeposit</a></div><div class="ttdeci">double VisibleEnergyDeposit() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/IonizationAndScintillation_8h_source.html#l00048">IonizationAndScintillation.h:48</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a84ea1001348191bda5f3708042b2d0aa"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a84ea1001348191bda5f3708042b2d0aa">larg4::OpFastScintillation::propagationTime</a></div><div class="ttdeci">void propagationTime(std::vector&lt; double &gt; &amp;arrival_time_dist, G4ThreeVector x0, const size_t OpChannel, bool Reflected=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01028">OpFastScintillation.cxx:1028</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab3c053e17d850120cd4fe2823d884063"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab3c053e17d850120cd4fe2823d884063">larg4::OpFastScintillation::fOnlyActiveVolume</a></div><div class="ttdeci">bool const fOnlyActiveVolume</div><div class="ttdoc">Whether photon propagation is performed only from active volumes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00433">OpFastScintillation.hh:433</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html">sim::OnePhoton</a></div><div class="ttdoc">All information of a photon entering the sensitive optical detector volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00064">SimPhotons.h:64</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9ddf47e1ef56bfe5449e119604e63465"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9ddf47e1ef56bfe5449e119604e63465">larg4::OpFastScintillation::isOpDetInSameTPC</a></div><div class="ttdeci">bool isOpDetInSameTPC(geo::Point_t const &amp;ScintPoint, geo::Point_t const &amp;OpDetPoint) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01822">OpFastScintillation.cxx:1822</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a57d00151bfec63ad517d42e619cef34f"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a57d00151bfec63ad517d42e619cef34f">phot::PhotonVisibilityService::GetTimingTF1</a></div><div class="ttdeci">MappedFunctions_t GetTimingTF1(Point const &amp;p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00112">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:112</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad94c040f0c06732a61c6a21e296cc60d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad94c040f0c06732a61c6a21e296cc60d">larg4::OpFastScintillation::ProcessStep</a></div><div class="ttdeci">void ProcessStep(const G4Step &amp;step)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00522">OpFastScintillation.cxx:522</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a064dc724b2899db0b59c75d9ea6e4b7c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a064dc724b2899db0b59c75d9ea6e4b7c">larg4::OpFastScintillation::theSlowIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theSlowIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">OpFastScintillation.hh:282</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac268e718c4272ba70f59249ce2f4d1c7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac268e718c4272ba70f59249ce2f4d1c7">larg4::OpFastScintillation::scint_time</a></div><div class="ttdeci">G4double scint_time(const G4Step &amp;aStep, G4double ScintillationTime, G4double ScintillationRiseTime) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01011">OpFastScintillation.cxx:1011</a></div></div>
<div class="ttc" id="TriggerEfficiencyPlots__module_8cc_html_ac771d2ad6d0ad30734b0590a6461dd20"><div class="ttname"><a href="../../da/dc7/TriggerEfficiencyPlots__module_8cc.html#ac771d2ad6d0ad30734b0590a6461dd20">MeV</a></div><div class="ttdeci">util::quantities::megaelectronvolt MeV</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc7/TriggerEfficiencyPlots__module_8cc_source.html#l00089">TriggerEfficiencyPlots_module.cc:89</a></div></div>
<div class="ttc" id="classsim_1_1OpDetBacktrackerRecord_html"><div class="ttname"><a href="../../dd/d36/classsim_1_1OpDetBacktrackerRecord.html">sim::OpDetBacktrackerRecord</a></div><div class="ttdoc">Energy deposited on a readout Optical Detector by simulated tracks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc1/OpDetBacktrackerRecord_8h_source.html#l00123">OpDetBacktrackerRecord.h:123</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a2c524ee4618d5091358a4fba57d6bbd0"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a2c524ee4618d5091358a4fba57d6bbd0">sim::OnePhoton::InitialPosition</a></div><div class="ttdeci">geo::Point_t InitialPosition</div><div class="ttdoc">Scintillation position in world coordinates [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00067">SimPhotons.h:67</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_acd747ad512f0bcd96fa37bffef59b178"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#acd747ad512f0bcd96fa37bffef59b178">phot::PhotonVisibilityService::StoreReflected</a></div><div class="ttdeci">bool StoreReflected() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00170">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:170</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_a2b8237bac57d5c373c623869ad4513c8"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">make_calib_df.t0</a></div><div class="ttdeci">int t0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00042">make_calib_df.py:42</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4253237e0ebc8dab74a4f5e2bb8c2124"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4253237e0ebc8dab74a4f5e2bb8c2124">larg4::OpFastScintillation::bPropagate</a></div><div class="ttdeci">bool const bPropagate</div><div class="ttdoc">Whether propagation of photons is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00425">OpFastScintillation.hh:425</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a821c9e06cd12efb223004d78c9fcb57e"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a821c9e06cd12efb223004d78c9fcb57e">sim::OnePhoton::Time</a></div><div class="ttdeci">float Time</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00079">SimPhotons.h:79</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8ce91426a2e9ffeb4ff14a4bca0f2519"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8ce91426a2e9ffeb4ff14a4bca0f2519">larg4::OpFastScintillation::usesSemiAnalyticModel</a></div><div class="ttdeci">bool usesSemiAnalyticModel() const </div><div class="ttdoc">Returns whether the semi-analytic visibility parametrization is being used. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01492">OpFastScintillation.cxx:1492</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a42975425cee174d35c43f7ba3fec8521"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a42975425cee174d35c43f7ba3fec8521">phot::PhotonVisibilityService::GetReflT0s</a></div><div class="ttdeci">MappedT0s_t GetReflT0s(Point const &amp;p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00092">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:92</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae878469b0e42918cb9816f410c34a58f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">larg4::OpFastScintillation::fFiniteRiseTime</a></div><div class="ttdeci">G4bool fFiniteRiseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00286">OpFastScintillation.hh:286</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a30d440651b97effb3a48f67d3ad4d5f1"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a></div><div class="ttdeci">static IonizationAndScintillation * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00044">IonizationAndScintillation.cxx:44</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_ab4c5e18a6121c4cfd1290b730e99bfc2"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#ab4c5e18a6121c4cfd1290b730e99bfc2">phot::PhotonVisibilityService::GetAllVisibilities</a></div><div class="ttdeci">MappedCounts_t GetAllVisibilities(Point const &amp;p, bool wantReflected=false) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00074">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:74</a></div></div>
<div class="ttc" id="classlarg4_1_1OpDetPhotonTable_html_a8e1d2081518c789bb29a4b6ce1ec5f76"><div class="ttname"><a href="../../d3/dc5/classlarg4_1_1OpDetPhotonTable.html#a8e1d2081518c789bb29a4b6ce1ec5f76">larg4::OpDetPhotonTable::Instance</a></div><div class="ttdeci">static OpDetPhotonTable * Instance(bool LitePhotons=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6e/OpDetPhotonTable_8cxx_source.html#l00032">OpDetPhotonTable.cxx:32</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a76852aeab9621ed43645e8c559c8b022"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">larg4::OpFastScintillation::ExcitationRatio</a></div><div class="ttdeci">G4double ExcitationRatio</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00290">OpFastScintillation.hh:290</a></div></div>
<div class="ttc" id="classphot_1_1OpDetVisibilityData_html"><div class="ttname"><a href="../../d9/dd4/classphot_1_1OpDetVisibilityData.html">phot::OpDetVisibilityData</a></div><div class="ttdoc">A container for photon visibility mapping data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/OpDetVisibilityData_8h_source.html#l00120">OpDetVisibilityData.h:120</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a9811e0658d83df0ea88ce0d60129c9e5"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a9811e0658d83df0ea88ce0d60129c9e5">sim::OnePhoton::SetInSD</a></div><div class="ttdeci">bool SetInSD</div><div class="ttdoc">Whether the photon reaches the sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00088">SimPhotons.h:88</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a9a9e45eb46a2f325c0b85dba8e43fa7e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a9a9e45eb46a2f325c0b85dba8e43fa7e">larg4::OpFastScintillation::reemission_energy</a></div><div class="ttdeci">double reemission_energy() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01095">OpFastScintillation.cxx:1095</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aaac06190fa1fced63c3464db9b08a348"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaac06190fa1fced63c3464db9b08a348">larg4::OpFastScintillation::ReflT0s</a></div><div class="ttdeci">phot::MappedT0s_t ReflT0s</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00341">OpFastScintillation.hh:341</a></div></div>
<div class="ttc" id="classlarg4_1_1ParticleListAction_html_adbeb4f865250923b00533c44136ff9a3"><div class="ttname"><a href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">larg4::ParticleListAction::GetCurrentTrackID</a></div><div class="ttdeci">static int GetCurrentTrackID()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/ParticleListAction_8h_source.html#l00118">ParticleListAction.h:118</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a00d0364f20281bcc4b3f41784335f3ed"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a00d0364f20281bcc4b3f41784335f3ed">larg4::OpFastScintillation::fPVS</a></div><div class="ttdeci">phot::PhotonVisibilityService const *const fPVS</div><div class="ttdoc">Photon visibility service instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">OpFastScintillation.hh:428</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aa4bd5196829b1a1ac8ce863091fedb53"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aa4bd5196829b1a1ac8ce863091fedb53">larg4::OpFastScintillation::fOpaqueCathode</a></div><div class="ttdeci">bool const fOpaqueCathode</div><div class="ttdoc">Whether the cathodes are fully opaque; currently hard coded &amp;quot;no&amp;quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00438">OpFastScintillation.hh:438</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a4fe4087419d5e1ab0bbbf266ceac1c86"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a4fe4087419d5e1ab0bbbf266ceac1c86">phot::PhotonVisibilityService::IncludeParPropTime</a></div><div class="ttdeci">bool IncludeParPropTime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d61/larsim_2larsim_2PhotonPropagation_2PhotonVisibilityService_8h_source.html#l00180">larsim/larsim/PhotonPropagation/PhotonVisibilityService.h:180</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_ade1e95cbc4acebdd2b61046b3035113b"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#ade1e95cbc4acebdd2b61046b3035113b">sim::OnePhoton::Energy</a></div><div class="ttdeci">float Energy</div><div class="ttdoc">Scintillation photon energy [GeV]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00082">SimPhotons.h:82</a></div></div>
<div class="ttc" id="classphot_1_1PhotonVisibilityService_html_a424c9a54c418f076f42d728fbb63e894"><div class="ttname"><a href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html#a424c9a54c418f076f42d728fbb63e894">phot::PhotonVisibilityService::NOpChannels</a></div><div class="ttdeci">size_t NOpChannels() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d29/PhotonVisibilityService__service_8cc_source.html#l00702">PhotonVisibilityService_service.cc:702</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a22593277a1ca27ab95c98e70e50b800c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a22593277a1ca27ab95c98e70e50b800c">larg4::OpFastScintillation::ParPropTimeTF1</a></div><div class="ttdeci">phot::MappedFunctions_t ParPropTimeTF1</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00340">OpFastScintillation.hh:340</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aade9c725e09500c55a71743d5b1bf806"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aade9c725e09500c55a71743d5b1bf806">larg4::OpFastScintillation::theFastIntegralTable</a></div><div class="ttdeci">std::unique_ptr&lt; G4PhysicsTable &gt; theFastIntegralTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">OpFastScintillation.hh:283</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a5e7026752a387def764e51d4c56b537f"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a5e7026752a387def764e51d4c56b537f">sim::OnePhoton::MotherTrackID</a></div><div class="ttdeci">int MotherTrackID</div><div class="ttdoc">ID of the GEANT4 track causing the scintillation. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00085">SimPhotons.h:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3fd540bc6b6a8f667c11a01c914ad89c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::Rectangle_SolidAngle </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02075">2075</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordtype">double</span> aa = <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a> / (2. * d);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordtype">double</span> bb = b / (2. * d);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordtype">double</span> aux = (1. + aa * aa + bb * bb) / ((1. + aa * aa) * (1. + bb * bb));</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">// return 4 * std::acos(std::sqrt(aux));</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">return</span> 4. * <a class="code" href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">fast_acos</a>(std::sqrt(aux));</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  }</div>
<div class="ttc" id="decode__signalprocess__icarus_8fcl_html_a2a105cb669129f9c63eb7a4c15bf2d9b"><div class="ttname"><a href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a></div><div class="ttdeci">process_name gaushit a</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/decode__signalprocess__icarus_8fcl_source.html#l00037">decode_signalprocess_icarus.fcl:37</a></div></div>
<div class="ttc" id="namespacelarg4_html_a2e90958f76053f34c244902d2cf34c3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">larg4::fast_acos</a></div><div class="ttdeci">double fast_acos(double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02195">OpFastScintillation.cxx:2195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5535e4150f4a6528aa6a80db1066573e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::Rectangle_SolidAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html">Dims</a> const &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02086">2086</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  {</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">// v is the position of the track segment with respect to</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="comment">// the center position of the arapuca window</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="comment">// arapuca plane fixed in x direction</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keywordflow">if</span> (isApproximatelyZero(v[1]) &amp;&amp; isApproximatelyZero(v[2])) {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(o.h, o.w, v[0]);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">if</span> (isDefinitelyGreaterThan(v[1], o.h * .5) &amp;&amp; isDefinitelyGreaterThan(v[2], o.w * .5)) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = v[1] - o.h * .5;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="keywordtype">double</span> B = v[2] - o.w * .5;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="keywordtype">double</span> to_return = (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (A + o.h), 2. * (B + o.w), v[0]) -</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * (B + o.w), v[0]) -</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (A + o.h), 2. * B, v[0]) +</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * B, v[0])) *</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                         .25;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      <span class="keywordflow">return</span> to_return;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">if</span> ((v[1] &lt;= o.h * .5) &amp;&amp; (v[2] &lt;= o.w * .5)) {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      <span class="keywordtype">double</span> A = -v[1] + o.h * .5;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="keywordtype">double</span> B = -v[2] + o.w * .5;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keywordtype">double</span> to_return = (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (o.h - A), 2. * (o.w - B), v[0]) +</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * (o.w - B), v[0]) +</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (o.h - A), 2. * B, v[0]) +</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * B, v[0])) *</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                         .25;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <span class="keywordflow">return</span> to_return;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordflow">if</span> (isDefinitelyGreaterThan(v[1], o.h * .5) &amp;&amp; (v[2] &lt;= o.w * .5)) {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="keywordtype">double</span> A = v[1] - o.h * .5;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="keywordtype">double</span> B = -v[2] + o.w * .5;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordtype">double</span> to_return = (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (A + o.h), 2. * (o.w - B), v[0]) -</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * (o.w - B), v[0]) +</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (A + o.h), 2. * B, v[0]) -</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * B, v[0])) *</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                         .25;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      <span class="keywordflow">return</span> to_return;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">if</span> ((v[1] &lt;= o.h * .5) &amp;&amp; isDefinitelyGreaterThan(v[2], o.w * .5)) {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <span class="keywordtype">double</span> A = -v[1] + o.h * .5;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <span class="keywordtype">double</span> B = v[2] - o.w * .5;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keywordtype">double</span> to_return = (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (o.h - A), 2. * (B + o.w), v[0]) -</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * (o.h - A), 2. * B, v[0]) +</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * (B + o.w), v[0]) -</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                          <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(2. * A, 2. * B, v[0])) *</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                         .25;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="keywordflow">return</span> to_return;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">// error message if none of these cases, i.e. something has gone wrong!</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Warning: invalid solid angle call.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3fd540bc6b6a8f667c11a01c914ad89c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">larg4::OpFastScintillation::Rectangle_SolidAngle</a></div><div class="ttdeci">double Rectangle_SolidAngle(const double a, const double b, const double d) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02075">OpFastScintillation.cxx:2075</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a9e45eb46a2f325c0b85dba8e43fa7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::reemission_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01095">1095</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aac9f56ab984f0fbd014183350575ffcc">fTPBEm</a>-&gt;fire() * ((*(--<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.end())).first - (*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.begin()).<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>) +</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;           (*<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">tpbemission</a>.begin()).<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  }</div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab9fcea92a722f1e4569db0df3c96bf0b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab9fcea92a722f1e4569db0df3c96bf0b">larg4::OpFastScintillation::tpbemission</a></div><div class="ttdeci">std::map&lt; double, double &gt; tpbemission</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00333">OpFastScintillation.hh:333</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aac9f56ab984f0fbd014183350575ffcc"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aac9f56ab984f0fbd014183350575ffcc">larg4::OpFastScintillation::fTPBEm</a></div><div class="ttdeci">std::unique_ptr&lt; CLHEP::RandGeneral &gt; fTPBEm</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00334">OpFastScintillation.hh:334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80e698f56af8b30beb9cd5d184fda6ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::RemoveSaturation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00223">223</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a> = NULL;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab48ce5a5e51491782ece2423af6c52b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::sample_time </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>tau1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>tau2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01074">1074</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">// tau1: rise time and tau2: decay time</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="comment">// two random numbers</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      G4double ran1 = G4UniformRand();</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      G4double ran2 = G4UniformRand();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="comment">// exponential distribution as envelope function: very efficient</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      G4double d = (tau1 + tau2) / tau2;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">// make sure the envelope function is</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="comment">// always larger than the bi-exponential</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      G4double t = -1.0 * tau2 * std::log(1 - ran1);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      G4double <a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a> = d * <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a261eb530f9cc114884f8524c7fbb489d">single_exp</a>(t, tau2);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">if</span> (ran2 &lt;= <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1ea57f26d674500fbafa01f690344f88">bi_exp</a>(t, tau1, tau2) / g) <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">return</span> -1.0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1ea57f26d674500fbafa01f690344f88"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1ea57f26d674500fbafa01f690344f88">larg4::OpFastScintillation::bi_exp</a></div><div class="ttdeci">G4double bi_exp(const G4double t, const G4double tau1, const G4double tau2) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01849">OpFastScintillation.cxx:1849</a></div></div>
<div class="ttc" id="decoderTools__icarus_8fcl_html_a86703f8a44dd6742852257943d5a25c6"><div class="ttname"><a href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a></div><div class="ttdeci">BEGIN_PROLOG g</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d79/decoderTools__icarus_8fcl_source.html#l00007">decoderTools_icarus.fcl:7</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a261eb530f9cc114884f8524c7fbb489d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a261eb530f9cc114884f8524c7fbb489d">larg4::OpFastScintillation::single_exp</a></div><div class="ttdeci">G4double single_exp(const G4double t, const G4double tau2) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01843">OpFastScintillation.cxx:1843</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac268e718c4272ba70f59249ce2f4d1c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::scint_time </td>
          <td>(</td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>aStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>ScintillationTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>ScintillationRiseTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01011">1011</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    G4StepPoint <span class="keyword">const</span>* pPreStepPoint = aStep.GetPreStepPoint();</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    G4StepPoint <span class="keyword">const</span>* pPostStepPoint = aStep.GetPostStepPoint();</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    G4double avgVelocity = (pPreStepPoint-&gt;GetVelocity() + pPostStepPoint-&gt;GetVelocity()) / 2.;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    G4double deltaTime = aStep.GetStepLength() / avgVelocity;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (ScintillationRiseTime == 0.0) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      deltaTime = deltaTime - ScintillationTime * std::log(G4UniformRand());</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      deltaTime = deltaTime + <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab48ce5a5e51491782ece2423af6c52b5">sample_time</a>(ScintillationRiseTime, ScintillationTime);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">return</span> deltaTime;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab48ce5a5e51491782ece2423af6c52b5"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab48ce5a5e51491782ece2423af6c52b5">larg4::OpFastScintillation::sample_time</a></div><div class="ttdeci">G4double sample_time(const G4double tau1, const G4double tau2) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01074">OpFastScintillation.cxx:1074</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a718cbd5149e67598da3959762e33bb5d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::SetFiniteRiseTime </td>
          <td>(</td>
          <td class="paramtype">const G4bool&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00487">487</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">fFiniteRiseTime</a> = <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div>
<div class="ttc" id="namespacerun__simTestPulse_html_a4cef4374034bd70ad18185ff49d1dc64"><div class="ttname"><a href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">run_simTestPulse.state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/run__simTestPulse_8py_source.html#l00023">run_simTestPulse.py:23</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae878469b0e42918cb9816f410c34a58f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae878469b0e42918cb9816f410c34a58f">larg4::OpFastScintillation::fFiniteRiseTime</a></div><div class="ttdeci">G4bool fFiniteRiseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00286">OpFastScintillation.hh:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0c2959e073ec328528a0d266b3dfcbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::SetScintillationByParticleType </td>
          <td>(</td>
          <td class="paramtype">const G4bool&#160;</td>
          <td class="paramname"><em>scintType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l00984">984</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">emSaturation</a>) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      G4Exception(<span class="stringliteral">&quot;OpFastScintillation::SetScintillationByParticleType&quot;</span>,</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                  <span class="stringliteral">&quot;Scint02&quot;</span>,</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                  JustWarning,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                  <span class="stringliteral">&quot;Redefinition: Birks Saturation is replaced by ScintillationByParticleType!&quot;</span>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a80e698f56af8b30beb9cd5d184fda6ee">RemoveSaturation</a>();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">scintillationByParticleType</a> = scintType;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a96ffae6dd0169c1cb290f05f1b2782d4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a96ffae6dd0169c1cb290f05f1b2782d4">larg4::OpFastScintillation::scintillationByParticleType</a></div><div class="ttdeci">G4bool scintillationByParticleType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00292">OpFastScintillation.hh:292</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a80e698f56af8b30beb9cd5d184fda6ee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a80e698f56af8b30beb9cd5d184fda6ee">larg4::OpFastScintillation::RemoveSaturation</a></div><div class="ttdeci">void RemoveSaturation()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00223">OpFastScintillation.hh:223</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a30492b68ed1ae863f668dd713d870101"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a30492b68ed1ae863f668dd713d870101">larg4::OpFastScintillation::emSaturation</a></div><div class="ttdeci">G4EmSaturation * emSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">OpFastScintillation.hh:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97bd403f4950cb4293aeb7f1758c5956"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::SetScintillationExcitationRatio </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>excitationratio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00517">517</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">ExcitationRatio</a> = excitationratio;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a76852aeab9621ed43645e8c559c8b022"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a76852aeab9621ed43645e8c559c8b022">larg4::OpFastScintillation::ExcitationRatio</a></div><div class="ttdeci">G4double ExcitationRatio</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00290">OpFastScintillation.hh:290</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf8e02aaaeaa11f1b504cc4be6867e0c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::SetScintillationYieldFactor </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>yieldfactor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00505">505</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">YieldFactor</a> = yieldfactor;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ac2bd26b19a7037ed64fbc6970d9d7770"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ac2bd26b19a7037ed64fbc6970d9d7770">larg4::OpFastScintillation::YieldFactor</a></div><div class="ttdeci">G4double YieldFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00288">OpFastScintillation.hh:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a92c474b8018bca3d7eac0aaf78302acc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::OpFastScintillation::SetTrackSecondariesFirst </td>
          <td>(</td>
          <td class="paramtype">const G4bool&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00481">481</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">fTrackSecondariesFirst</a> = <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8da3e7ccf57e91bb3378d29cb27cdaee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8da3e7ccf57e91bb3378d29cb27cdaee">larg4::OpFastScintillation::fTrackSecondariesFirst</a></div><div class="ttdeci">G4bool fTrackSecondariesFirst</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00285">OpFastScintillation.hh:285</a></div></div>
<div class="ttc" id="namespacerun__simTestPulse_html_a4cef4374034bd70ad18185ff49d1dc64"><div class="ttname"><a href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">run_simTestPulse.state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/run__simTestPulse_8py_source.html#l00023">run_simTestPulse.py:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a261eb530f9cc114884f8524c7fbb489d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::single_exp </td>
          <td>(</td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4double&#160;</td>
          <td class="paramname"><em>tau2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01843">1843</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1.0 * t / tau2) / tau2;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  }</div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ce91426a2e9ffeb4ff14a4bca0f2519"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::usesSemiAnalyticModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the semi-analytic visibility parametrization is being used. </p>

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01492">1492</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cb9ba23f6ef377b0cc5d260372dc8e6">fUseNhitsModel</a>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  } <span class="comment">// OpFastScintillation::usesSemiAnalyticModel()</span></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0cb9ba23f6ef377b0cc5d260372dc8e6"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0cb9ba23f6ef377b0cc5d260372dc8e6">larg4::OpFastScintillation::fUseNhitsModel</a></div><div class="ttdeci">bool const fUseNhitsModel</div><div class="ttdoc">Whether the semi-analytic model is being used for photon visibility. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00431">OpFastScintillation.hh:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac8d1cae90d2db03f8af7a7745e676e41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int larg4::OpFastScintillation::VISHits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d61/structlarg4_1_1OpFastScintillation_1_1OpticalDetector.html">OpticalDetector</a> const &amp;&#160;</td>
          <td class="paramname"><em>opDet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>cathode_hits_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>hotspot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01691">1691</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="comment">// 1). calculate total number of hits of VUV photons on reflective</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// foils via solid angle + Gaisser-Hillas corrections.</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">// Done outside as it doesn&#39;t depend on OpDetPoint</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;     <span class="comment">// set plane_depth for correct TPC:</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordtype">double</span> plane_depth;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">if</span> (ScintPoint_v.X() &lt; 0.) { plane_depth = -<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>; }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      plane_depth = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">fplane_depth</a>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="comment">// 2). calculate number of these hits which reach the optical</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// detector from the hotspot via solid angle</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// the interface has been converted into geo::Point_t, the implementation not yet</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    std::array&lt;double, 3U&gt; ScintPoint;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    std::array&lt;double, 3U&gt; OpDetPoint;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a>(ScintPoint, ScintPoint_v);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a>(OpDetPoint, opDet.OpDetPoint);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">// calculate distances and angles for application of corrections</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">// distance from hotspot to optical detector</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordtype">double</span> distance_vis = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(&amp;hotspot[0], &amp;OpDetPoint[0], 3);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">//  angle between hotspot and optical detector</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordtype">double</span> cosine_vis = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hotspot[0] - OpDetPoint[0]) / distance_vis;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// double theta_vis = std::acos(cosine_vis) * 180. / CLHEP::pi;</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordtype">double</span> theta_vis = <a class="code" href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">fast_acos</a>(cosine_vis) * 180. / <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// calculate solid angle of optical detector</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordtype">double</span> solid_angle_detector = 0;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">// rectangular aperture</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">if</span> (opDet.type == 0) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="comment">// get hotspot coordinates relative to opDet</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      std::array&lt;double, 3&gt; emission_relative = {<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hotspot[0] - OpDetPoint[0]),</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                                 <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hotspot[1] - OpDetPoint[1]),</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                                 <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hotspot[2] - OpDetPoint[2])};</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="comment">// calculate solid angle</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      solid_angle_detector = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(Dims{opDet.h, opDet.w}, emission_relative);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// dome aperture</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 1) {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      solid_angle_detector = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8bcfdaaeea917bfd16f95671d45da1">Omega_Dome_Model</a>(distance_vis, theta_vis);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// disk aperture</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 2) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="comment">// offset in z-y plane</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordtype">double</span> d = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(&amp;hotspot[1], &amp;OpDetPoint[1], 2);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="comment">// drift distance (in x)</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hotspot[0] - OpDetPoint[0]);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="comment">// calculate solid angle</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      solid_angle_detector = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acc790f6bda764b63c5467ca650d996ac">Disk_SolidAngle</a>(d, h, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a>);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error: Invalid optical detector type. 0 = rectangular, 1 = dome, 2 = disk&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// calculate number of hits via geometeric acceptance</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordtype">double</span> hits_geo = (solid_angle_detector / (2. * <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>)) * cathode_hits_rec; <span class="comment">// 2*pi due to presence of reflective foils</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">// determine correction factor, depending on PD type</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a> = (theta_vis / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad0751805825b8a27dacfbe6177fee770">fdelta_angulo_vis</a>);         <span class="comment">// off-set angle bin</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>, 2, 1);      <span class="comment">// radial distance from centre of detector (Y-Z)</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordtype">double</span> d_c = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[0] - plane_depth);      <span class="comment">// distance to cathode</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">double</span> border_correction = 0;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="comment">// flat PDs</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordflow">if</span> ((opDet.type == 0 || opDet.type == 2) &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>){</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="comment">// interpolate in d_c for each r bin</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> nbins_r = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">fvispars_flat</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>].size();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      std::vector&lt;double&gt; interp_vals(nbins_r, 0.0);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a>.size();</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">if</span> (d_c &gt;= <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a>[size - 2])</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;          idx = size - 2;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;          <span class="keywordflow">while</span> (d_c &gt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a>[idx + 1])</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            idx++;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nbins_r; ++i) {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;          interp_vals[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">fvis_distances_x_flat</a>,</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                       <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">fvispars_flat</a>[k][i],</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                       d_c,</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                       <span class="keyword">false</span>,</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                       idx);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      border_correction = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad3705b34ffa34651aec27841f907bf82">fvis_distances_r_flat</a>, interp_vals, r, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">// dome PDs</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 1 &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="comment">// interpolate in d_c for each r bin</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> nbins_r = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">fvispars_dome</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>].size();</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      std::vector&lt;double&gt; interp_vals(nbins_r, 0.0);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keywordtype">size_t</span> size = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a>.size();</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">if</span> (d_c &gt;= <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a>[size - 2])</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          idx = size - 2;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;          <span class="keywordflow">while</span> (d_c &gt; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a>[idx + 1])</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            idx++;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nbins_r; ++i) {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          interp_vals[i] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">fvis_distances_x_dome</a>,</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                       <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">fvispars_dome</a>[k][i],</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                       d_c,</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                       <span class="keyword">false</span>,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                       idx);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      border_correction = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>(<a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8a307d8e0be43367314badf2fb033e">fvis_distances_r_dome</a>, interp_vals, r, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;     <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error: Invalid optical detector type. 0 = rectangular, 1 = dome, 2 = disk. Or corrections for chosen optical detector type missing.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    }</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">// apply correction factor</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordtype">double</span> hits_rec = border_correction * hits_geo / cosine_vis;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordtype">double</span> hits_vis = std::round(G4Poisson(hits_rec));</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">return</span> hits_vis;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af20cf552f2a1bee81d366bab436abbee"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af20cf552f2a1bee81d366bab436abbee">larg4::OpFastScintillation::fvispars_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fvispars_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00404">OpFastScintillation.hh:404</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7ea945e24a8395eb19ac877970c835f8"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">larg4::OpFastScintillation::fIsFlatPDCorr</a></div><div class="ttdeci">bool fIsFlatPDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00383">OpFastScintillation.hh:383</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aaff75d10959edf1d09ca83bd149cbaea"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aaff75d10959edf1d09ca83bd149cbaea">larg4::OpFastScintillation::fvispars_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fvispars_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00400">OpFastScintillation.hh:400</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad3705b34ffa34651aec27841f907bf82"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad3705b34ffa34651aec27841f907bf82">larg4::OpFastScintillation::fvis_distances_r_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_r_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00399">OpFastScintillation.hh:399</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_ab5195ee97d25f685ae274a686c643f37"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a></div><div class="ttdeci">unsigned int fillCoords(Coords &amp;dest, Vector const &amp;src)</div><div class="ttdoc">Fills a coordinate array with the coordinates of a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l02056">geo_vectors_utils.h:2056</a></div></div>
<div class="ttc" id="getStatistics_8sh_html_a04d4c2131ccb24cc78386597e8a21c5b"><div class="ttname"><a href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a></div><div class="ttdeci">while getopts h</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/getStatistics_8sh_source.html#l00013">getStatistics.sh:13</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a8784560c1c79f93a372e16f2ce4adee7"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a8784560c1c79f93a372e16f2ce4adee7">larg4::OpFastScintillation::fvis_distances_x_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_x_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00398">OpFastScintillation.hh:398</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afbacbb2ba255f4f2c831a8e22a944225"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">larg4::OpFastScintillation::fradius</a></div><div class="ttdeci">double fradius</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00414">OpFastScintillation.hh:414</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4c3322018a751c9dc8dde377c676322a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">larg4::OpFastScintillation::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">OpFastScintillation.hh:408</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a6a6d69c230148f61e69e62c45c49b292"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">larg4::OpFastScintillation::fIsDomePDCorr</a></div><div class="ttdeci">bool fIsDomePDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00388">OpFastScintillation.hh:388</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ad0751805825b8a27dacfbe6177fee770"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ad0751805825b8a27dacfbe6177fee770">larg4::OpFastScintillation::fdelta_angulo_vis</a></div><div class="ttdeci">double fdelta_angulo_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00396">OpFastScintillation.hh:396</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a0563fa0f8189dd11d735beeb289f436c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a0563fa0f8189dd11d735beeb289f436c">larg4::OpFastScintillation::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">OpFastScintillation.hh:407</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c8a307d8e0be43367314badf2fb033e"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8a307d8e0be43367314badf2fb033e">larg4::OpFastScintillation::fvis_distances_r_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_r_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00403">OpFastScintillation.hh:403</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_aea78d33e76362e20533d8041204d1eb5"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#aea78d33e76362e20533d8041204d1eb5">larg4::OpFastScintillation::fvis_distances_x_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fvis_distances_x_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00402">OpFastScintillation.hh:402</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3fd540bc6b6a8f667c11a01c914ad89c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">larg4::OpFastScintillation::Rectangle_SolidAngle</a></div><div class="ttdeci">double Rectangle_SolidAngle(const double a, const double b, const double d) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02075">OpFastScintillation.cxx:2075</a></div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c8bcfdaaeea917bfd16f95671d45da1"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8bcfdaaeea917bfd16f95671d45da1">larg4::OpFastScintillation::Omega_Dome_Model</a></div><div class="ttdeci">double Omega_Dome_Model(const double distance, const double theta) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02140">OpFastScintillation.cxx:2140</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_acc790f6bda764b63c5467ca650d996ac"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acc790f6bda764b63c5467ca650d996ac">larg4::OpFastScintillation::Disk_SolidAngle</a></div><div class="ttdeci">double Disk_SolidAngle(const double d, const double h, const double b) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02013">OpFastScintillation.cxx:2013</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a122a7b8666811f02fba2c0fcdc485d17"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a></div><div class="ttdeci">pdgs k</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="namespacelarg4_html_a2e90958f76053f34c244902d2cf34c3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">larg4::fast_acos</a></div><div class="ttdeci">double fast_acos(double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02195">OpFastScintillation.cxx:2195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac8721e1342d192025d3bc7320aeedcc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int larg4::OpFastScintillation::VUVHits </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Nphotons_created</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d61/structlarg4_1_1OpFastScintillation_1_1OpticalDetector.html">OpticalDetector</a> const &amp;&#160;</td>
          <td class="paramname"><em>opDet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01595">1595</a> of file <a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// the interface has been converted into geo::Point_t, the implementation not yet</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    std::array&lt;double, 3U&gt; ScintPoint;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    std::array&lt;double, 3U&gt; OpDetPoint;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a>(ScintPoint, ScintPoint_v);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a>(OpDetPoint, opDet.OpDetPoint);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">// distance and angle between ScintPoint and OpDetPoint</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordtype">double</span> distance = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(&amp;ScintPoint[0], &amp;OpDetPoint[0], 3);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">double</span> cosine = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[0] - OpDetPoint[0]) / distance;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// double theta = std::acos(cosine) * 180. / CLHEP::pi;</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordtype">double</span> theta = <a class="code" href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">fast_acos</a>(cosine) * 180. / <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// calculate solid angle:</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordtype">double</span> solid_angle = 0;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="comment">// Arapucas/Bars (rectangle)</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">if</span> (opDet.type == 0) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="comment">// get scintillation point coordinates relative to arapuca window centre</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      std::array&lt;double, 3&gt; ScintPoint_rel = {<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[0] - OpDetPoint[0]),</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                              <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[1] - OpDetPoint[1]),</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                              <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[2] - OpDetPoint[2])};</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="comment">// calculate solid angle</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      solid_angle = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">Rectangle_SolidAngle</a>(Dims{opDet.h, opDet.w}, ScintPoint_rel);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// PMTs (dome)</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 1) {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      solid_angle = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8bcfdaaeea917bfd16f95671d45da1">Omega_Dome_Model</a>(distance, theta);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// PMTs (disk approximation)</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 2) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="comment">// offset in z-y plane</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <span class="keywordtype">double</span> d = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(&amp;ScintPoint[1], &amp;OpDetPoint[1], 2);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="comment">// drift distance (in x)</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ScintPoint[0] - OpDetPoint[0]);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="comment">// Solid angle of a disk</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      solid_angle = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acc790f6bda764b63c5467ca650d996ac">Disk_SolidAngle</a>(d, h, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">fradius</a>);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error: Invalid optical detector type. 0 = rectangular, 1 = dome, 2 = disk&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="comment">// calculate number of photons hits by geometric acceptance: accounting for solid angle and LAr absorbtion length</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordtype">double</span> hits_geo = <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1. * distance / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">fL_abs_vuv</a>) * (solid_angle / (4 * <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>)) * Nphotons_created;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">// apply Gaisser-Hillas correction for Rayleigh scattering distance</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">// and angular dependence offset angle bin</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> j = (theta / <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afb621a844af899a684aa828f0f786a2c">fdelta_angulo_vuv</a>);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">// determine GH parameters, accounting for border effects</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="comment">// radial distance from centre of detector (Y-Z)</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> = <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(ScintPoint, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">fcathode_centre</a>, 2, 1);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordtype">double</span> pars_ini[4] = {0, 0, 0, 0};</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordtype">double</span> s1 = 0; <span class="keywordtype">double</span> s2 = 0; <span class="keywordtype">double</span> s3 = 0;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">// flat PDs</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">if</span> ((opDet.type == 0 || opDet.type == 2) &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">fIsFlatPDCorr</a>){</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      pars_ini[0] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[0][j];</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      pars_ini[1] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[1][j];</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      pars_ini[2] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[2][j];</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      pars_ini[3] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">fGHvuvpars_flat</a>[3][j];</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      s1 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[0], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      s2 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[1], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      s3 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">fborder_corr_angulo_flat</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">fborder_corr_flat</a>[2], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// dome PDs</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.type == 1 &amp;&amp; <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">fIsDomePDCorr</a>) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      pars_ini[0] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a>[0][j];</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      pars_ini[1] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a>[1][j];</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      pars_ini[2] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a>[2][j];</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      pars_ini[3] = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">fGHvuvpars_dome</a>[3][j];</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      s1 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">fborder_corr_angulo_dome</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">fborder_corr_dome</a>[0], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      s2 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">fborder_corr_angulo_dome</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">fborder_corr_dome</a>[1], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      s3 = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">interpolate</a>( <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">fborder_corr_angulo_dome</a>, <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">fborder_corr_dome</a>[2], theta, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error: Invalid optical detector type. 0 = rectangular, 1 = dome, 2 = disk. Or corrections for chosen optical detector type missing.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// add border correction</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    pars_ini[0] = pars_ini[0] + s1 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    pars_ini[1] = pars_ini[1] + s2 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    pars_ini[2] = pars_ini[2] + s3 * <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    pars_ini[3] = pars_ini[3];</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">// calculate correction</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordtype">double</span> GH_correction = <a class="code" href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab7c56e09c6f8efb51bbe8f4a770d84c4">Gaisser_Hillas</a>(distance, pars_ini);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">// calculate number photons</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">double</span> hits_rec = GH_correction * hits_geo / cosine;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordtype">int</span> hits_vuv = std::round(G4Poisson(hits_rec));</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">return</span> hits_vuv;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ab7c56e09c6f8efb51bbe8f4a770d84c4"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ab7c56e09c6f8efb51bbe8f4a770d84c4">larg4::OpFastScintillation::Gaisser_Hillas</a></div><div class="ttdeci">G4double Gaisser_Hillas(const double x, const double *par) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01856">OpFastScintillation.cxx:1856</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a7ea945e24a8395eb19ac877970c835f8"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a7ea945e24a8395eb19ac877970c835f8">larg4::OpFastScintillation::fIsFlatPDCorr</a></div><div class="ttdeci">bool fIsFlatPDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00383">OpFastScintillation.hh:383</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a12464241f0ae6056ca4864e6e2cddcbb"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a12464241f0ae6056ca4864e6e2cddcbb">larg4::OpFastScintillation::fGHvuvpars_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fGHvuvpars_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00384">OpFastScintillation.hh:384</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5e569f857c4b4d5139d9325d9bb3349b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5e569f857c4b4d5139d9325d9bb3349b">larg4::OpFastScintillation::fGHvuvpars_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fGHvuvpars_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00389">OpFastScintillation.hh:389</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_ab5195ee97d25f685ae274a686c643f37"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#ab5195ee97d25f685ae274a686c643f37">geo::vect::fillCoords</a></div><div class="ttdeci">unsigned int fillCoords(Coords &amp;dest, Vector const &amp;src)</div><div class="ttdoc">Fills a coordinate array with the coordinates of a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l02056">geo_vectors_utils.h:2056</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_af3ec975734345c521e013a2e16d68e3d"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#af3ec975734345c521e013a2e16d68e3d">larg4::OpFastScintillation::fborder_corr_angulo_dome</a></div><div class="ttdeci">std::vector&lt; double &gt; fborder_corr_angulo_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00390">OpFastScintillation.hh:390</a></div></div>
<div class="ttc" id="getStatistics_8sh_html_a04d4c2131ccb24cc78386597e8a21c5b"><div class="ttname"><a href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a></div><div class="ttdeci">while getopts h</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/getStatistics_8sh_source.html#l00013">getStatistics.sh:13</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3db520f0f99b5f5c1b7575b74ae7ec8f"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3db520f0f99b5f5c1b7575b74ae7ec8f">larg4::OpFastScintillation::fborder_corr_dome</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fborder_corr_dome</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00391">OpFastScintillation.hh:391</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3bb8239fa328e1717ba5c69fd50273ca"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3bb8239fa328e1717ba5c69fd50273ca">larg4::OpFastScintillation::fborder_corr_flat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fborder_corr_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00386">OpFastScintillation.hh:386</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afbacbb2ba255f4f2c831a8e22a944225"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afbacbb2ba255f4f2c831a8e22a944225">larg4::OpFastScintillation::fradius</a></div><div class="ttdeci">double fradius</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00414">OpFastScintillation.hh:414</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_ae56165035186723b8d79b16c244bdd7b"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#ae56165035186723b8d79b16c244bdd7b">larg4::OpFastScintillation::fborder_corr_angulo_flat</a></div><div class="ttdeci">std::vector&lt; double &gt; fborder_corr_angulo_flat</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00385">OpFastScintillation.hh:385</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3674409d5d75236a9c79413b02ae2f10"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3674409d5d75236a9c79413b02ae2f10">larg4::OpFastScintillation::fL_abs_vuv</a></div><div class="ttdeci">int fL_abs_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00416">OpFastScintillation.hh:416</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a4c3322018a751c9dc8dde377c676322a"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a4c3322018a751c9dc8dde377c676322a">larg4::OpFastScintillation::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">OpFastScintillation.hh:408</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a6a6d69c230148f61e69e62c45c49b292"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a6a6d69c230148f61e69e62c45c49b292">larg4::OpFastScintillation::fIsDomePDCorr</a></div><div class="ttdeci">bool fIsDomePDCorr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00388">OpFastScintillation.hh:388</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_afb621a844af899a684aa828f0f786a2c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#afb621a844af899a684aa828f0f786a2c">larg4::OpFastScintillation::fdelta_angulo_vuv</a></div><div class="ttdeci">double fdelta_angulo_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00381">OpFastScintillation.hh:381</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a3fd540bc6b6a8f667c11a01c914ad89c"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a3fd540bc6b6a8f667c11a01c914ad89c">larg4::OpFastScintillation::Rectangle_SolidAngle</a></div><div class="ttdeci">double Rectangle_SolidAngle(const double a, const double b, const double d) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02075">OpFastScintillation.cxx:2075</a></div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a1c8bcfdaaeea917bfd16f95671d45da1"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a1c8bcfdaaeea917bfd16f95671d45da1">larg4::OpFastScintillation::Omega_Dome_Model</a></div><div class="ttdeci">double Omega_Dome_Model(const double distance, const double theta) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02140">OpFastScintillation.cxx:2140</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_acc790f6bda764b63c5467ca650d996ac"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#acc790f6bda764b63c5467ca650d996ac">larg4::OpFastScintillation::Disk_SolidAngle</a></div><div class="ttdeci">double Disk_SolidAngle(const double d, const double h, const double b) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02013">OpFastScintillation.cxx:2013</a></div></div>
<div class="ttc" id="classlarg4_1_1OpFastScintillation_html_a5d54689d66686566526adb0bc2fb6ecf"><div class="ttname"><a href="../../d8/da8/classlarg4_1_1OpFastScintillation.html#a5d54689d66686566526adb0bc2fb6ecf">larg4::OpFastScintillation::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l01932">OpFastScintillation.cxx:1932</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="namespacelarg4_html_a2e90958f76053f34c244902d2cf34c3b"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a2e90958f76053f34c244902d2cf34c3b">larg4::fast_acos</a></div><div class="ttdeci">double fast_acos(double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/OpFastScintillation_8cxx_source.html#l02195">OpFastScintillation.cxx:2195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4253237e0ebc8dab74a4f5e2bb8c2124"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const larg4::OpFastScintillation::bPropagate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether propagation of photons is enabled. </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00425">425</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a30492b68ed1ae863f668dd713d870101"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4EmSaturation* larg4::OpFastScintillation::emSaturation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00338">338</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a76852aeab9621ed43645e8c559c8b022"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::ExcitationRatio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00290">290</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ac0c08417aab17cdfc0d15258c1914a7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>&gt; const larg4::OpFastScintillation::fActiveVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00409">409</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a944dc6ab3e7ee8ae1e1df70f274a7934"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fangle_bin_timing_vis</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">360</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a84145a771638c07c31d6f38242c4494c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fangle_bin_timing_vuv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="af3ec975734345c521e013a2e16d68e3d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fborder_corr_angulo_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00390">390</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ae56165035186723b8d79b16c244bdd7b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fborder_corr_angulo_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00385">385</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a3db520f0f99b5f5c1b7575b74ae7ec8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::fborder_corr_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00391">391</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a3bb8239fa328e1717ba5c69fd50273ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::fborder_corr_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00386">386</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a4c3322018a751c9dc8dde377c676322a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 larg4::OpFastScintillation::fcathode_centre</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00408">408</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="afd1cabc60fa3b993b146001098cd128b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dc6/structlarg4_1_1OpFastScintillation_1_1Dims.html">Dims</a> larg4::OpFastScintillation::fcathode_plane</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00415">415</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a5c41b3a9dd7c8cfa15fa381bd19f91e9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fcathode_ydimension</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">407</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a7a38294b1c5c68bc3c817f5b0716fb83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fcathode_zdimension</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">407</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a3e21019631a04a7f22c3b0aaf6f79bd3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; larg4::OpFastScintillation::fcut_off_pars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00363">363</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ad0751805825b8a27dacfbe6177fee770"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fdelta_angulo_vis</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00396">396</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="afb621a844af899a684aa828f0f786a2c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fdelta_angulo_vuv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00381">381</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a636af825c7b0490efcc2d361377f990c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fdistances_refl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00361">361</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ae878469b0e42918cb9816f410c34a58f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::fFiniteRiseTime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00286">286</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a5e569f857c4b4d5139d9325d9bb3349b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::fGHvuvpars_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00389">389</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a12464241f0ae6056ca4864e6e2cddcbb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::fGHvuvpars_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00384">384</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a9b19869980094466af92423dddeeec3a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::finflexion_point_distance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a6a6d69c230148f61e69e62c45c49b292"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::fIsDomePDCorr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00388">388</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a7ea945e24a8395eb19ac877970c835f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::fIsFlatPDCorr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00383">383</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a3674409d5d75236a9c79413b02ae2f10"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int larg4::OpFastScintillation::fL_abs_vuv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00416">416</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ae797b001bd6fd0f7a49d74f8b0b4dfe3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fmax_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="af37aae991c13fdd84d0e445e1013d465"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fmin_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ab3c053e17d850120cd4fe2823d884063"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const larg4::OpFastScintillation::fOnlyActiveVolume = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether photon propagation is performed only from active volumes. </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00433">433</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a5af470b4fa2aa4d1a63dd1969235e0ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const larg4::OpFastScintillation::fOnlyOneCryostat = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allows running even if light on cryostats <code>C:1</code> and higher is not supported. Currently hard coded "no" </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00436">436</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aa4bd5196829b1a1ac8ce863091fedb53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const larg4::OpFastScintillation::fOpaqueCathode = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the cathodes are fully opaque; currently hard coded "no". </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00438">438</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a9133f6ec2aad11f06c6450b31d10081f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>&gt; larg4::OpFastScintillation::fOpDetCenter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00417">417</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a28584b8a2ba4bed4f379447c8822422e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fOpDetHeight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00420">420</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a1c9da7eeb8335d6c50a7c3711f8978e9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fOpDetLength</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00419">419</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a0b293604d22ea91a66e9e51284d3043f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; larg4::OpFastScintillation::fOpDetType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00418">418</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ad19a03db803a0acb4e9510076e8c585d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::fparameters[7]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00352">352</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a0563fa0f8189dd11d735beeb289f436c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fplane_depth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00407">407</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a00d0364f20281bcc4b3f41784335f3ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d8a/classphot_1_1PhotonVisibilityService.html">phot::PhotonVisibilityService</a> const* const larg4::OpFastScintillation::fPVS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Photon visibility service instance. </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00428">428</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a81e967540da71175904e177bcaa19603"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fradial_distances_refl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00362">362</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="afbacbb2ba255f4f2c831a8e22a944225"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fradius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00414">414</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a52f187b0d853cf7833b81e52bdf7e0f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fstep_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a51aff7f60f22299ad11b43f0108c262b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::OpFastScintillation::fStoreReflected</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00394">394</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a0ec108b3daf6f1aed81abff6459ece66"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; larg4::OpFastScintillation::ftau_pars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00364">364</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aac9f56ab984f0fbd014183350575ffcc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;CLHEP::RandGeneral&gt; larg4::OpFastScintillation::fTPBEm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00334">334</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a8da3e7ccf57e91bb3378d29cb27cdaee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::fTrackSecondariesFirst</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00285">285</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a0cb9ba23f6ef377b0cc5d260372dc8e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> const larg4::OpFastScintillation::fUseNhitsModel = <a class="el" href="../../d7/d6f/namespacelarg4.html#a7eeba60c219f2d1b4094606a12d28d18">false</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the semi-analytic model is being used for photon visibility. </p>

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00431">431</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a1c8a307d8e0be43367314badf2fb033e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fvis_distances_r_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00403">403</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ad3705b34ffa34651aec27841f907bf82"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fvis_distances_r_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00399">399</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aea78d33e76362e20533d8041204d1eb5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fvis_distances_x_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00402">402</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a8784560c1c79f93a372e16f2ce4adee7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; larg4::OpFastScintillation::fvis_distances_x_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00398">398</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="acd58061960591a845c7530428d6e2425"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fvis_vmean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00360">360</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="af20cf552f2a1bee81d366bab436abbee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; larg4::OpFastScintillation::fvispars_dome</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00404">404</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aaff75d10959edf1d09ca83bd149cbaea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; larg4::OpFastScintillation::fvispars_flat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00400">400</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a93522458cf3401e99459b4973ad08a31"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fvuv_vgroup_max</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a8c7841a3917307d6c44157ea99738bc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::OpFastScintillation::fvuv_vgroup_mean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00351">351</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a22593277a1ca27ab95c98e70e50b800c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d7c/namespacephot.html#ac2dd130b2751833e36c3825a60ba891b">phot::MappedFunctions_t</a> larg4::OpFastScintillation::ParPropTimeTF1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00340">340</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aaac06190fa1fced63c3464db9b08a348"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d7c/namespacephot.html#a5db42c0ec04a6dda89181a67fee78170">phot::MappedT0s_t</a> larg4::OpFastScintillation::ReflT0s</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00341">341</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a96ffae6dd0169c1cb290f05f1b2782d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::OpFastScintillation::scintillationByParticleType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00292">292</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aade9c725e09500c55a71743d5b1bf806"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;G4PhysicsTable&gt; larg4::OpFastScintillation::theFastIntegralTable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00283">283</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a064dc724b2899db0b59c75d9ea6e4b7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;G4PhysicsTable&gt; larg4::OpFastScintillation::theSlowIntegralTable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00282">282</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ab9fcea92a722f1e4569db0df3c96bf0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;double, double&gt; larg4::OpFastScintillation::tpbemission</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00333">333</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aa78a8761b4bd4dec065441cb0d0a2070"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::VUV_max</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00356">356</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a5ddb7228bb686dd9ba2e982878224cef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; larg4::OpFastScintillation::VUV_min</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00357">357</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a7035b4befbb801111de32c5959b45d89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TF1&gt; &gt; larg4::OpFastScintillation::VUV_timing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00354">354</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<a class="anchor" id="ac2bd26b19a7037ed64fbc6970d9d7770"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double larg4::OpFastScintillation::YieldFactor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00288">288</a> of file <a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d6/d8a/OpFastScintillation_8hh_source.html">OpFastScintillation.hh</a></li>
<li><a class="el" href="../../d7/d47/OpFastScintillation_8cxx_source.html">OpFastScintillation.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
