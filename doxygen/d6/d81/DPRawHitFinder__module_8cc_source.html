<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>DPRawHitFinder_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_ebc1b529cb5032f145478a845d3c2aab.html">HitFinder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DPRawHitFinder_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d6/d81/DPRawHitFinder__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// DPRawHitFinder class</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// christoph.alt@cern.ch</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// This algorithm is designed to find hits on raw waveforms in collection planes (dual phase/single phase)</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// It is based on GausHitFinder.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// 1. The algorithm walks along the wire and looks for pulses above threshold.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// 2. Depending on distance and minimum ADC count between peaks inside the same ROI,</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// peaks can be grouped. Grouped peaks are fitted together (see later).</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// 3. Inside each group of peaks, look for pairs of peaks that are very close, with</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// one peak being much smaller than the other one (in integral and amplitude).</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// If such a pair of peaks is found, merge the two peaks to one peak.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// For pulse trains with #peaks &lt;= MaxMultiHit and width &lt; MaxGroupLength:</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// 4. Fit n double exponentials to each group of peaks, where n is the number</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// of peaks inside this group.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// 5. If the Chi2/NDF returned &gt; Chi2NDFRetry, attempt to fit n+1 double exponentials</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// to the group of peaks by adding a peak close to the maximum deviation between</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// fit and waveform. If this is a better fit it then uses the parameters of this</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// fit to characterize the &quot;hit&quot; object. If not, try n+2 exponentials and so on.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Stop when Chi2/NDF is good or 3 times the number of inital exponentials is reached.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// If Chi2/NDF is still bad or if #peaks &gt; MaxMultiHit or width &gt; MaxGroupLength:</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// 6. Split pulse into equally long hits.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// The parameters of the fit are saved in a feature vector by using MVAWriter to</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// draw the fitted function in the event display.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// C/C++ standard library</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::accumulate()</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span> <span class="comment">// std::unique_ptr()</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span> <span class="comment">// std::move()</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// Framework includes</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindOneP.h&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;canvas/Utilities/InputTag.h&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;art_root_io/TFileService.h&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/System/TriggerNamesService.h&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// LArSoft Includes</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d38/RawTypes_8h.html">larcoreobj/SimpleTypesAndConstants/RawTypes.h</a>&quot;</span> <span class="comment">// raw::ChannelID_t</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d9f/Wire_8h.html">lardataobj/RecoBase/Wire.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d8b/HitCreator_8h.html">lardata/ArtDataHelper/HitCreator.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/da6/MVAWriter_8h.html">lardata/ArtDataHelper/MVAWriter.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// ROOT Includes</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;TH1F.h&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;TF1.h&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>{</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html">   69</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html">DPRawHitFinder</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7538d2c67a7bdd574480728346000749">DPRawHitFinder</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ade2cf0283396a7392ceb31412dae00f3">produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a91754d685ea255e50dc58143a802a242">beginJob</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">   80</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a>      = std::vector&lt;std::tuple&lt;int,int,int&gt;&gt;; <span class="comment">// start, max, end of a peak</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">   81</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>   = std::vector&lt;std::tuple&lt;int,int,int,int&gt;&gt;; <span class="comment">// max, width, start, end of a peak within a group</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">   82</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">MergedTimeWidVec</a> = std::vector&lt;std::tuple&lt;int,int,PeakTimeWidVec,int&gt;&gt;; <span class="comment">// start, end of group of peaks, PeakTimeWidVec, NFluctuations</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">   83</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">PeakDevVec</a>       = std::vector&lt;std::tuple&lt;double,int,int,int&gt;&gt;;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">   84</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a>     = std::vector&lt;std::pair&lt;double,double&gt;&gt;;  <span class="comment">//&lt; parameter/error vec</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">findCandidatePeaks</a>(std::vector&lt;float&gt;::const_iterator startItr,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                            std::vector&lt;float&gt;::const_iterator stopItr,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a>&amp;                       timeValsVec,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                            <span class="keywordtype">float</span>&amp;                             PeakMin,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                            <span class="keywordtype">int</span>                                firstTick) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac4a2e230f393678103d444e9dc423064">EstimateFluctuations</a>(<span class="keyword">const</span> std::vector&lt;float&gt;  fsignalVec,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                             <span class="keywordtype">int</span>                       peakStart,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                             <span class="keywordtype">int</span>                       peakMean,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                             <span class="keywordtype">int</span>                       peakEnd);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce">mergeCandidatePeaks</a>(<span class="keyword">const</span> std::vector&lt;float&gt; signalVec, <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a>, <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">MergedTimeWidVec</a>&amp;);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// ### This function will fit N-Exponentials to a TH1D where N is set ###</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// ###            by the number of peaks found in the pulse         ###</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">FitExponentials</a>(<span class="keyword">const</span> std::vector&lt;float&gt; fSignalVector,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                         <span class="keyword">const</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>     fPeakVals,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                         <span class="keywordtype">int</span>                      fStartTime,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                         <span class="keywordtype">int</span>                      fEndTime,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                         <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a>&amp;            fparamVec,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                         <span class="keywordtype">double</span>&amp;                  fchi2PerNDF,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                         <span class="keywordtype">int</span>&amp;                     fNDF,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                         <span class="keywordtype">bool</span>                     <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">fSameShape</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae873bae18638eea8b66a26fe11e4e579">FindPeakWithMaxDeviation</a>(<span class="keyword">const</span> std::vector&lt;float&gt; fSignalVector,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                  <span class="keywordtype">int</span>                      fNPeaks,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                  <span class="keywordtype">int</span>                      fStartTime,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                  <span class="keywordtype">int</span>                      fEndTime,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                  <span class="keywordtype">bool</span>                     <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">fSameShape</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a>             fparamVec,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>           fpeakVals,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">PeakDevVec</a>&amp;              fPeakDev);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    std::string <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43be9390f29e91942cf8a7125198b6e4">CreateFitFunction</a>(<span class="keywordtype">int</span> fNPeaks, <span class="keywordtype">bool</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">fSameShape</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad1961c2589248e97da206b2c3cf7184d">AddPeak</a>(std::tuple&lt;double,int,int,int&gt; fPeakDevCand,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                 <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>&amp;                fpeakValsTemp);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a2f50fcd21558bcabe16aee0a9b29a0b9">SplitPeak</a>(std::tuple&lt;double,int,int,int&gt; fPeakDevCand,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>&amp;                fpeakValsTemp);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#afc8947a752ff69b717f32ba4f349842f">WidthFunc</a>(<span class="keywordtype">double</span> fPeakMean,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                     <span class="keywordtype">double</span> fPeakAmp,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                     <span class="keywordtype">double</span> fPeakTau1,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                     <span class="keywordtype">double</span> fPeakTau2,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                     <span class="keywordtype">double</span> fStartTime,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                     <span class="keywordtype">double</span> fEndTime,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                     <span class="keywordtype">double</span> fPeakMeanTrue);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a67166b9396014ec57f53021a7af3f47c">ChargeFunc</a>(<span class="keywordtype">double</span> fPeakMean,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      <span class="keywordtype">double</span> fPeakAmp,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                      <span class="keywordtype">double</span> fPeakTau1,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                      <span class="keywordtype">double</span> fPeakTau2,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      <span class="keywordtype">double</span> fChargeNormFactor,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      <span class="keywordtype">double</span> fPeakMeanTrue);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5616181f56c661d7bea7a843b1fa14ba">FillOutHitParameterVector</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; input,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                   std::vector&lt;double&gt;&amp; <a class="code" href="../../dd/db4/triggersim__eastmodule__icarus_8fcl.html#a6e6fc5a1833d744f7bd6bde59dd95323">output</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a6ed967faf8a3c616d1ade488dea51f00">doBinAverage</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                      std::vector&lt;float&gt;&amp;       outputVec,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                      <span class="keywordtype">size_t</span>                    binsToAverage) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa28e088e6a76fd2c2d31c912cf12ed38">reBin</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;               std::vector&lt;float&gt;&amp;       outputVec,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;               <span class="keywordtype">size_t</span>                    nBinsToCombine) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html">  155</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html">Comp</a> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// important: we need two overloads, because the comparison</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// needs to be done both ways to check for equality</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#aad1ffc6a779a1143a1d53bd543bd9e63">  159</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#aad1ffc6a779a1143a1d53bd543bd9e63">operator()</a>(std::tuple&lt;int,int,int,int&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, <span class="keywordtype">int</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> std::get&lt;0&gt;(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) &lt; s; }</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#add9ca4cd49ed9c6828f7ebf420906072">  161</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#add9ca4cd49ed9c6828f7ebf420906072">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, std::tuple&lt;int,int,int,int&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> s &lt; std::get&lt;0&gt;(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>); }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    };</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a877eb5476415cb380c85070aff311c2c">  165</a></span>&#160;    std::string      <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a877eb5476415cb380c85070aff311c2c">fCalDataModuleLabel</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//FHiCL parameter (see &quot;hitfindermodules.fcl&quot; for details)</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">  168</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7f809a0763ce7ed17a66902ba383fdc5">  169</a></span>&#160;    <span class="keywordtype">float</span>  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7f809a0763ce7ed17a66902ba383fdc5">fMinSig</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a19732896d59692ed0ab0cb2e5b156a12">  170</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a19732896d59692ed0ab0cb2e5b156a12">fTicksToStopPeakFinder</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9346f54ef2f20880c7ac3127b93370a8">  171</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9346f54ef2f20880c7ac3127b93370a8">fMinWidth</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a778b9327eb86c26e33431043368da90d">  172</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a778b9327eb86c26e33431043368da90d">fMinADCSum</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43eaf6e47b694503abf7ebf908d82823">  173</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43eaf6e47b694503abf7ebf908d82823">fMinADCSumOverWidth</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac596806a27037af14f3c8557c2fcd45d">  174</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac596806a27037af14f3c8557c2fcd45d">fMaxMultiHit</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#abd4bfc88d5c136b4ab0dd697414a58e3">  175</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#abd4bfc88d5c136b4ab0dd697414a58e3">fMaxGroupLength</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9ad50f1fb0633c982ccab25b7967ad80">  176</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9ad50f1fb0633c982ccab25b7967ad80">fChargeNorm</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0db71aafdb547f5e4ebace449f969bd1">  177</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0db71aafdb547f5e4ebace449f969bd1">fTryNplus1Fits</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57d52200f742d83db02d8e0e51b9ab84">  178</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57d52200f742d83db02d8e0e51b9ab84">fChi2NDFRetry</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a05328850b7bee78dc15ccc110df30f47">  179</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a05328850b7bee78dc15ccc110df30f47">fChi2NDFRetryFactorMultiHits</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae937aed028098222ab19af6b389d712a">  180</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae937aed028098222ab19af6b389d712a">fChi2NDFMax</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a10ab9b354477564574b3f09b485a1070">  181</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a10ab9b354477564574b3f09b485a1070">fChi2NDFMaxFactorMultiHits</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad0326ec884de710bead2451c0e65c74c">  182</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad0326ec884de710bead2451c0e65c74c">fNumBinsToAverage</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab583ed95bc6872700646fa87aa2d332b">  183</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab583ed95bc6872700646fa87aa2d332b">fMinTau</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5de73e8a267d20adb4ffa956e32a4759">  184</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5de73e8a267d20adb4ffa956e32a4759">fMaxTau</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aad301d82d0b33bc79a61289e772774ef">  185</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aad301d82d0b33bc79a61289e772774ef">fFitPeakMeanRange</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab543af91e06a2331421ac1bb0f570c70">  186</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab543af91e06a2331421ac1bb0f570c70">fGroupMaxDistance</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a397dd911804c668886ff9f6a8a38f227">  187</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a397dd911804c668886ff9f6a8a38f227">fGroupMinADC</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">  188</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">fSameShape</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a1a8ee444ca1b6eb8b33e8e20a81e6b55">  189</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a1a8ee444ca1b6eb8b33e8e20a81e6b55">fDoMergePeaks</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9143a0ae276ad6f3e7c2ca2c4015147a">  190</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9143a0ae276ad6f3e7c2ca2c4015147a">fMergeADCSumThreshold</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a466142ee47ba57525e9ff8827b431c07">  191</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a466142ee47ba57525e9ff8827b431c07">fMergeMaxADCThreshold</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab2169e8927cd7c4dadbbca67a9b81cf2">  192</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab2169e8927cd7c4dadbbca67a9b81cf2">fMinRelativePeakHeightLeft</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a3ef285126b24946d4d2d1a3a7b4e0aec">  193</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a3ef285126b24946d4d2d1a3a7b4e0aec">fMinRelativePeakHeightRight</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a270a8b6ae71bc6f4140ed016d475d343">  194</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a270a8b6ae71bc6f4140ed016d475d343">fMergeMaxADCLimit</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">  195</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">fWidthNormalization</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae8d63f8a7469ad8b4f48dd74f7223e67">  196</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae8d63f8a7469ad8b4f48dd74f7223e67">fLongMaxHits</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4d036906801d9bb13f0e2eb3b60a192e">  197</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4d036906801d9bb13f0e2eb3b60a192e">fLongPulseWidth</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4bf23aeec5444af9dee14f7a4fe77b0">  198</a></span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4bf23aeec5444af9dee14f7a4fe77b0">fMaxFluctuations</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#acc1d547db107f49dd70e65d12c0ecef1">  200</a></span>&#160;    art::InputTag <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#acc1d547db107f49dd70e65d12c0ecef1">fNewHitsTag</a>;              <span class="comment">// tag of hits produced by this module, need to have it for fit parameter data products</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">  201</a></span>&#160;    <a class="code" href="../../d2/dd8/classanab_1_1FVectorWriter.html">anab::FVectorWriter&lt;4&gt;</a> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">fHitParamWriter</a>; <span class="comment">// helper for saving hit fit parameters in data products</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#af4286aaa162b37e9ed91b03cdeb430d8">  203</a></span>&#160;    TH1F* <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#af4286aaa162b37e9ed91b03cdeb430d8">fFirstChi2</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a8d85f16917e8be98cc7b32d84ea8bf70">  204</a></span>&#160;    TH1F* <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a8d85f16917e8be98cc7b32d84ea8bf70">fChi2</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }; <span class="comment">// class DPRawHitFinder</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7538d2c67a7bdd574480728346000749">  211</a></span>&#160;<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7538d2c67a7bdd574480728346000749">DPRawHitFinder::DPRawHitFinder</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset) :</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        EDProducer{pset},</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        fNewHitsTag(</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;module_label&quot;</span>), <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            art::ServiceHandle&lt;art::TriggerNamesService const&gt;()-&gt;getProcessName()),</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        fHitParamWriter(producesCollector())</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    fLogLevel                    = pset.get&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;LogLevel&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    fCalDataModuleLabel          = pset.get&lt; std::string  &gt;(<span class="stringliteral">&quot;CalDataModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="../../dc/d43/namespacehit.html#a266919e10bc2e7291df21e01605d4042">fMaxMultiHit</a>                 = pset.get&lt; <span class="keywordtype">int</span>    &gt;(<span class="stringliteral">&quot;MaxMultiHit&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    fMaxGroupLength              = pset.get&lt; <span class="keywordtype">int</span>    &gt;(<span class="stringliteral">&quot;MaxGroupLength&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    fTryNplus1Fits               = pset.get&lt; <span class="keywordtype">bool</span>   &gt;(<span class="stringliteral">&quot;TryNplus1Fits&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    fChi2NDFRetry                = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;Chi2NDFRetry&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    fChi2NDFRetryFactorMultiHits = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;Chi2NDFRetryFactorMultiHits&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    fChi2NDFMax                  = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;Chi2NDFMax&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    fChi2NDFMaxFactorMultiHits   = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;Chi2NDFMaxFactorMultiHits&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    fNumBinsToAverage            = pset.get&lt; <span class="keywordtype">size_t</span> &gt;(<span class="stringliteral">&quot;NumBinsToAverage&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    fMinSig                      = pset.get&lt; <span class="keywordtype">float</span>    &gt;(<span class="stringliteral">&quot;MinSig&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    fMinWidth                    = pset.get&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;MinWidth&quot;</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    fMinADCSum                   = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MinADCSum&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    fMinADCSumOverWidth          = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MinADCSumOverWidth&quot;</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    fChargeNorm                  = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;ChargeNorm&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    fTicksToStopPeakFinder       = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;TicksToStopPeakFinder&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    fMinTau                      = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MinTau&quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    fMaxTau                      = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MaxTau&quot;</span>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    fFitPeakMeanRange            = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;FitPeakMeanRange&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    fGroupMaxDistance            = pset.get&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;GroupMaxDistance&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    fGroupMinADC                 = pset.get&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;GroupMinADC&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    fSameShape                   = pset.get&lt; <span class="keywordtype">bool</span> &gt;(<span class="stringliteral">&quot;SameShape&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    fDoMergePeaks                = pset.get&lt; <span class="keywordtype">bool</span>   &gt;(<span class="stringliteral">&quot;DoMergePeaks&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    fMergeADCSumThreshold        = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MergeADCSumThreshold&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    fMergeMaxADCThreshold        = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MergeMaxADCThreshold&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    fMinRelativePeakHeightLeft   = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MinRelativePeakHeightLeft&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    fMinRelativePeakHeightRight  = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MinRelativePeakHeightRight&quot;</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    fMergeMaxADCLimit            = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MergeMaxADCLimit&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    fWidthNormalization          = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;WidthNormalization&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    fLongMaxHits                 = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;LongMaxHits&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    fLongPulseWidth              = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;LongPulseWidth&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    fMaxFluctuations             = pset.get&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;MaxFluctuations&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// let HitCollectionCreator declare that we are going to produce</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// hits and associations with wires and raw digits</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// (with no particular product label)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="../../de/dfe/classrecob_1_1HitAndAssociationsWriterBase.html#adbc6a4d07ee8f3c4ebffc5e29436e351">recob::HitCollectionCreator::declare_products</a>(producesCollector());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// declare that data products with feature vectors describing</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// hits is going to be produced</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    fHitParamWriter.produces_using&lt; <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> &gt;();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;} <span class="comment">// DPRawHitFinder::DPRawHitFinder()</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5616181f56c661d7bea7a843b1fa14ba">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5616181f56c661d7bea7a843b1fa14ba">DPRawHitFinder::FillOutHitParameterVector</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; input,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                              std::vector&lt;double&gt;&amp;       <a class="code" href="../../dd/db4/triggersim__eastmodule__icarus_8fcl.html#a6e6fc5a1833d744f7bd6bde59dd95323">output</a>)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span>(input.size()==0)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;DPRawHitFinder::FillOutHitParameterVector ERROR! Input config vector has zero size.&quot;</span>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N_PLANES = geom-&gt;Nplanes();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span>(input.size()==1)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        output.resize(N_PLANES,input[0]);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(input.size()==N_PLANES)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        output = input;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;DPRawHitFinder::FillOutHitParameterVector ERROR! Input config vector size !=1 and !=N_PLANES.&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a91754d685ea255e50dc58143a802a242">  286</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a91754d685ea255e50dc58143a802a242">DPRawHitFinder::beginJob</a>()</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;{</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// get access to the TFile service</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// ======================================</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// === Hit Information for Histograms ===</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#af4286aaa162b37e9ed91b03cdeb430d8">fFirstChi2</a> = tfs-&gt;make&lt;TH1F&gt;(<span class="stringliteral">&quot;fFirstChi2&quot;</span>, <span class="stringliteral">&quot;#chi^{2}&quot;</span>, 10000, 0, 5000);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a8d85f16917e8be98cc7b32d84ea8bf70">fChi2</a>      = tfs-&gt;make&lt;TH1F&gt;(<span class="stringliteral">&quot;fChi2&quot;</span>, <span class="stringliteral">&quot;#chi^{2}&quot;</span>, 10000, 0, 5000);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ade2cf0283396a7392ceb31412dae00f3">  298</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ade2cf0283396a7392ceb31412dae00f3">DPRawHitFinder::produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">//==================================================================================================</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  TH1::AddDirectory(kFALSE);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">//Instantiate and Reset a stop watch</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">//TStopwatch StopWatch;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">//StopWatch.Reset();</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// ################################</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// ### Calling Geometry service ###</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// ################################</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// ###############################################</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// ### Making a ptr vector to put on the event ###</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// ###############################################</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// this contains the hit collection</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// and its associations to wires and raw digits</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html">recob::HitCollectionCreator</a> hcol(evt);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// start collection of fit parameters, initialize metadata describing it</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">auto</span> hitID = <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">fHitParamWriter</a>.<a class="code" href="../../d2/dd8/classanab_1_1FVectorWriter.html#a4f5f51963c0a635249f98e97f38da62f">initOutputs</a>&lt;<a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&gt;(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#acc1d547db107f49dd70e65d12c0ecef1">fNewHitsTag</a>, { <span class="stringliteral">&quot;t0&quot;</span>, <span class="stringliteral">&quot;tau1&quot;</span>, <span class="stringliteral">&quot;tau2&quot;</span>, <span class="stringliteral">&quot;ampl&quot;</span> });</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// ##########################################</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// ### Reading in the Wire List object(s) ###</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// ##########################################</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  art::Handle&lt; std::vector&lt;recob::Wire&gt; &gt; wireVecHandle;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  evt.getByLabel(fCalDataModuleLabel,wireVecHandle);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// #################################################################</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// ### Reading in the RawDigit associated with these wires, too  ###</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// #################################################################</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  art::FindOneP&lt;raw::RawDigit&gt; RawDigits(wireVecHandle, evt, fCalDataModuleLabel);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// Channel Number</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel = <a class="code" href="../../d9/d63/namespaceraw.html#ac59223371efaecdc5ef8389bc976a20a">raw::InvalidChannelID</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//##############################</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//### Looping over the wires ###</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">//##############################</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> wireIter = 0; wireIter &lt; wireVecHandle-&gt;size(); wireIter++)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// ####################################</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// ### Getting this particular wire ###</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// ####################################</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    art::Ptr&lt;recob::Wire&gt;   wire(wireVecHandle, wireIter);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    art::Ptr&lt;raw::RawDigit&gt; rawdigits = RawDigits.at(wireIter);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// --- Setting Channel Number and Signal type ---</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    channel = wire-&gt;Channel();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// get the WireID for this hit</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    std::vector&lt;geo::WireID&gt; wids = geom-&gt;ChannelToWire(channel);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// for now, just take the first option returned from ChannelToWire</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> wid  = wids[0];</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;= 1)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------------------------------------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Channel: &quot;</span> &lt;&lt; channel &lt;&lt; std::endl;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Cryostat: &quot;</span> &lt;&lt; wid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;TPC: &quot;</span> &lt;&lt; wid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Plane: &quot;</span> &lt;&lt; wid.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Wire: &quot;</span> &lt;&lt; wid.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">// #################################################</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">// ### Set up to loop over ROI&#39;s for this wire   ###</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="comment">// #################################################</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d4/da5/classlar_1_1sparse__vector.html">recob::Wire::RegionsOfInterest_t</a>&amp; signalROI = wire-&gt;SignalROI();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">int</span> CountROI=0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; range : signalROI.<a class="code" href="../../d4/da5/classlar_1_1sparse__vector.html#a8d9b2860eee2156fe59ba0ce4f0f1393">get_ranges</a>())</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// #################################################</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">// ### Getting a vector of signals for this wire ###</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// #################################################</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keyword">const</span> std::vector&lt;float&gt;&amp; signal = range.data();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// ROI start time</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="../../d9/d63/namespaceraw.html#abcbf8ba50ca9efdbeb1a6955b040b4fe">raw::TDCtick_t</a> roiFirstBinTick = range.begin_index();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">MergedTimeWidVec</a> mergedVec;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// ###########################################################</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// ### If option set do bin averaging before finding peaks ###</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">// ###########################################################</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (fNumBinsToAverage &gt; 1)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          std::vector&lt;float&gt; timeAve;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a6ed967faf8a3c616d1ade488dea51f00">doBinAverage</a>(signal, timeAve, fNumBinsToAverage);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <span class="comment">// ###################################################################</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="comment">// ### Search current averaged ROI for candidate peaks and widths  ###</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="comment">// ###################################################################</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a> timeValsVec;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">findCandidatePeaks</a>(timeAve.begin(),timeAve.end(),timeValsVec,<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7f809a0763ce7ed17a66902ba383fdc5">fMinSig</a>,0);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="comment">// ####################################################</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          <span class="comment">// ### If no startTime hit was found skip this wire ###</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <span class="comment">// ####################################################</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordflow">if</span> (timeValsVec.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          <span class="comment">// #############################################################</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          <span class="comment">// ### Merge potentially overlapping peaks and do multi fit  ###</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="comment">// #############################################################</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce">mergeCandidatePeaks</a>(timeAve, timeValsVec, mergedVec);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">// ###########################################################</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="comment">// ### Otherwise, operate directonly on signal vector      ###</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">// ###########################################################</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="comment">// ##########################################################</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="comment">// ### Search current ROI for candidate peaks and widths  ###</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="comment">// ##########################################################</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a> timeValsVec;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">findCandidatePeaks</a>(signal.begin(),signal.end(),timeValsVec,<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7f809a0763ce7ed17a66902ba383fdc5">fMinSig</a>,0);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=1)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;-------------------- ROI #&quot;</span> &lt;&lt; CountROI &lt;&lt; <span class="stringliteral">&quot; -------------------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">if</span>(timeValsVec.size() == 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;ROI #&quot;</span> &lt;&lt; CountROI &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; timeValsVec.size() &lt;&lt; <span class="stringliteral">&quot; peak):   ROIStartTick: &quot;</span> &lt;&lt; range.offset &lt;&lt; <span class="stringliteral">&quot;    ROIEndTick:&quot;</span> &lt;&lt; range.offset+range.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;ROI #&quot;</span> &lt;&lt; CountROI &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; timeValsVec.size() &lt;&lt; <span class="stringliteral">&quot; peaks):   ROIStartTick: &quot;</span> &lt;&lt; range.offset &lt;&lt; <span class="stringliteral">&quot;    ROIEndTick:&quot;</span> &lt;&lt; range.offset+range.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            CountROI++;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=2)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">int</span> CountPeak=0;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">auto</span> <span class="keyword">const</span>&amp; timeValsTmp : timeValsVec )</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; CountPeak &lt;&lt; <span class="stringliteral">&quot;:   PeakStartTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;0&gt;(timeValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakMaxTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;1&gt;(timeValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakEndTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;2&gt;(timeValsTmp) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;              CountPeak++;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          <span class="comment">// ####################################################</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <span class="comment">// ### If no startTime hit was found skip this wire ###</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          <span class="comment">// ####################################################</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          <span class="keywordflow">if</span> (timeValsVec.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          <span class="comment">// #############################################################</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          <span class="comment">// ### Merge potentially overlapping peaks and do multi fit  ###</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="comment">// #############################################################</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce">mergeCandidatePeaks</a>(signal, timeValsVec, mergedVec);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// ### Creating the parameter vector for the new pulse ###</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a> paramVec;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// === Number of Exponentials to try ===</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordtype">int</span> NumberOfPeaksBeforeFit=0;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nExponentialsForFit=0;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordtype">double</span>       chi2PerNDF=0.;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordtype">int</span>          NDF=0;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NumberOfMergedVecs = mergedVec.size();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// ################################################################</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// ### Lets loop over the groups of peaks we found on this wire ###</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="comment">// ################################################################</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; NumberOfMergedVecs; j++)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="keywordtype">int</span> startT = std::get&lt;0&gt;(mergedVec.at(j));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="keywordtype">int</span> endT   = std::get&lt;1&gt;(mergedVec.at(j));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="keywordtype">int</span> width  = endT + 1 - startT;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>&amp; peakVals = std::get&lt;2&gt;(mergedVec.at(j));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="keywordtype">int</span> NFluctuations = std::get&lt;3&gt;(mergedVec.at(j));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=3)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">if</span>(peakVals.size() == 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; peakVals.size() &lt;&lt; <span class="stringliteral">&quot; peak):  GroupStartTick: &quot;</span> &lt;&lt; range.offset + startT &lt;&lt; <span class="stringliteral">&quot;    GroupEndTick: &quot;</span> &lt;&lt; range.offset + endT &lt;&lt; std::endl;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; peakVals.size() &lt;&lt; <span class="stringliteral">&quot; peaks):  GroupStartTick: &quot;</span> &lt;&lt; range.offset + startT &lt;&lt; <span class="stringliteral">&quot;    GroupEndTick: &quot;</span> &lt;&lt; range.offset + endT &lt;&lt; std::endl;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Fluctuations in this group: &quot;</span> &lt;&lt; NFluctuations &lt;&lt; std::endl;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordtype">int</span> CountPeakInGroup=0;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">auto</span> <span class="keyword">const</span>&amp; peakValsTmp : peakVals )</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; CountPeakInGroup &lt;&lt; <span class="stringliteral">&quot; in group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;:  PeakInGroupStartTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;2&gt;(peakValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakInGroupMaxTick: &quot;</span> &lt;&lt;  range.offset + std::get&lt;0&gt;(peakValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakInGroupEndTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;3&gt;(peakValsTmp) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;              CountPeakInGroup++;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          <span class="comment">// ### Getting rid of noise hits ###</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;          <span class="keywordflow">if</span> (width &lt; fMinWidth || (<span class="keywordtype">double</span>)std::accumulate(signal.begin()+startT, signal.begin()+endT+1, 0) &lt; fMinADCSum || (<span class="keywordtype">double</span>)std::accumulate(signal.begin()+startT, signal.begin()+endT+1, 0)/width &lt; fMinADCSumOverWidth)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=3)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Delete this group of peaks because width, integral or width/intergral is too small.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          <span class="comment">// #####################################################################################################</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          <span class="comment">// ### Only attempt to fit if number of peaks &lt;= fMaxMultiHit and if group length &lt;= fMaxGroupLength ###</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <span class="comment">// #####################################################################################################</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;          NumberOfPeaksBeforeFit = peakVals.size();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          nExponentialsForFit = peakVals.size();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          chi2PerNDF = 0.;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          NDF = 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <span class="keywordflow">if</span>(NumberOfPeaksBeforeFit &lt;= fMaxMultiHit &amp;&amp; width &lt;= fMaxGroupLength &amp;&amp; NFluctuations &lt;= fMaxFluctuations)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="comment">// #####################################################</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="comment">// ### Calling the function for fitting Exponentials ###</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="comment">// #####################################################</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            paramVec.clear();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">FitExponentials</a>(signal, peakVals, startT, endT, paramVec, chi2PerNDF, NDF, fSameShape);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=4)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;--- First fit ---&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;              <span class="keywordflow">if</span> (nExponentialsForFit == 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Fitted &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; <span class="stringliteral">&quot; peak in group #&quot;</span>  &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;              <span class="keywordflow">else</span> <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Fitted &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; <span class="stringliteral">&quot; peaks in group #&quot;</span>  &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;chi2/ndf = &quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;              {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;tau1 [mus] = &quot;</span> &lt;&lt; paramVec[0].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;tau2 [mus] = &quot;</span> &lt;&lt; paramVec[1].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExponentialsForFit; i++)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; paramVec[2*(i+1)].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; range.offset + paramVec[2*(i+1)+1].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;              }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;              {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExponentialsForFit; i++)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; paramVec[4*i+2].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; range.offset + paramVec[4*i+3].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: tau1 [mus] = &quot;</span> &lt;&lt; paramVec[4*i].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: tau2 [mus] = &quot;</span> &lt;&lt; paramVec[4*i+1].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;              }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">// If the chi2 is infinite then there is a real problem so we bail</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">if</span> (!(chi2PerNDF &lt; std::numeric_limits&lt;double&gt;::infinity())) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#af4286aaa162b37e9ed91b03cdeb430d8">fFirstChi2</a>-&gt;Fill(chi2PerNDF);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="comment">// ########################################################</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="comment">// ### Trying extra Exponentials for an initial bad fit ###</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="comment">// ########################################################</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">if</span>( (fTryNplus1Fits &amp;&amp; nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFRetry) ||</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                (fTryNplus1Fits &amp;&amp; nExponentialsForFit &gt; 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFRetryFactorMultiHits*fChi2NDFRetry) )</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nExponentialsBeforeRefit=nExponentialsForFit;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nExponentialsAfterRefit=nExponentialsForFit;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;              <span class="keywordtype">double</span> oldChi2PerNDF = chi2PerNDF;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;              <span class="keywordtype">double</span> chi2PerNDF2;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;              <span class="keywordtype">int</span>    NDF2;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;              <span class="keywordtype">bool</span>   RefitSuccess;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;              <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a> peakValsTemp;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;              <span class="keywordflow">while</span>( (nExponentialsForFit == 1 &amp;&amp; nExponentialsAfterRefit &lt; 3*nExponentialsBeforeRefit &amp;&amp; chi2PerNDF &gt; fChi2NDFRetry) ||</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                     (nExponentialsForFit &gt; 1 &amp;&amp; nExponentialsAfterRefit &lt; 3*nExponentialsBeforeRefit &amp;&amp; chi2PerNDF &gt; fChi2NDFRetryFactorMultiHits*fChi2NDFRetry) )</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;              {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                RefitSuccess = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">PeakDevVec</a> PeakDev;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae873bae18638eea8b66a26fe11e4e579">FindPeakWithMaxDeviation</a>(signal, nExponentialsForFit, startT, endT, fSameShape, paramVec, peakVals, PeakDev);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="comment">//Add peak and re-fit</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; PeakDevCand : PeakDev)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                  chi2PerNDF2=0.;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                  NDF2=0.;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a> paramVecRefit;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                  peakValsTemp = peakVals;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad1961c2589248e97da206b2c3cf7184d">AddPeak</a>(PeakDevCand, peakValsTemp);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">FitExponentials</a>(signal, peakValsTemp, startT, endT, paramVecRefit, chi2PerNDF2, NDF2, fSameShape);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                  <span class="keywordflow">if</span> (chi2PerNDF2 &lt; chi2PerNDF)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                  {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    paramVec        = paramVecRefit;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    peakVals        = peakValsTemp;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    nExponentialsForFit = peakVals.size();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    chi2PerNDF              = chi2PerNDF2;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    NDF                     = NDF2;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    nExponentialsAfterRefit++;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    RefitSuccess = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="comment">//Split peak and re-fit</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="keywordflow">if</span>(RefitSuccess == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                  <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; PeakDevCand : PeakDev)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                  {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    chi2PerNDF2=0.;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    NDF2=0.;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a> paramVecRefit;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    peakValsTemp=peakVals;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a2f50fcd21558bcabe16aee0a9b29a0b9">SplitPeak</a>(PeakDevCand, peakValsTemp);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">FitExponentials</a>(signal, peakValsTemp, startT, endT, paramVecRefit, chi2PerNDF2, NDF2, fSameShape);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    <span class="keywordflow">if</span> (chi2PerNDF2 &lt; chi2PerNDF)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                      paramVec          = paramVecRefit;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                      peakVals          = peakValsTemp;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                      nExponentialsForFit = peakVals.size();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                      chi2PerNDF        = chi2PerNDF2;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                      NDF               = NDF2;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                      nExponentialsAfterRefit++;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                      RefitSuccess = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                  }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordflow">if</span>(RefitSuccess == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=5)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;              {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;--- Refit ---&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">if</span>( chi2PerNDF == oldChi2PerNDF) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;chi2/ndf didn&#39;t improve. Keep first fit.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Added peaks to group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;. This group now has &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; <span class="stringliteral">&quot; peaks:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; peakVals.size() &lt;&lt; <span class="stringliteral">&quot; peaks):  GroupStartTick: &quot;</span> &lt;&lt; range.offset + startT &lt;&lt; <span class="stringliteral">&quot;    GroupEndTick: &quot;</span> &lt;&lt; range.offset + endT &lt;&lt; std::endl;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                  <span class="keywordtype">int</span> CountPeakInGroup=0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                  <span class="keywordflow">for</span>( <span class="keyword">auto</span> <span class="keyword">const</span>&amp; peakValsTmp : peakVals )</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                  {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; CountPeakInGroup &lt;&lt; <span class="stringliteral">&quot; in group #&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;:  PeakInGroupStartTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;2&gt;(peakValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakInGroupMaxTick: &quot;</span> &lt;&lt;  range.offset + std::get&lt;0&gt;(peakValsTmp) &lt;&lt; <span class="stringliteral">&quot;    PeakInGroupEndTick: &quot;</span> &lt;&lt; range.offset + std::get&lt;3&gt;(peakValsTmp) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    CountPeakInGroup++;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                  }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;chi2/ndf = &quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                  <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                  {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;tau1 [mus] = &quot;</span> &lt;&lt; paramVec[0].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;tau2 [mus] = &quot;</span> &lt;&lt; paramVec[1].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExponentialsForFit; i++)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; paramVec[2*(i+1)].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; range.offset + paramVec[2*(i+1)+1].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                  }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                  {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExponentialsForFit; i++)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; paramVec[4*i+2].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; range.offset + paramVec[4*i+3].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: tau1 [mus] = &quot;</span> &lt;&lt; paramVec[4*i].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: tau2 [mus] = &quot;</span> &lt;&lt; paramVec[4*i+1].first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                  }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;              }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="comment">// ### Loop through returned peaks and make recob hits ###</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;              <span class="keywordtype">int</span> numHits(0);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nExponentialsForFit; i++)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;              {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="comment">//Extract fit parameters for this hit</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordtype">double</span> peakTau1;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="keywordtype">double</span> peakTau2;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keywordtype">double</span> peakAmp;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keywordtype">double</span> peakMean;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                  peakTau1 = paramVec[0].first;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                  peakTau2 = paramVec[1].first;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                  peakAmp  = paramVec[2*(i+1)].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                  peakMean = paramVec[2*(i+1)+1].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                  peakTau1 = paramVec[4*i].first;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                  peakTau2 = paramVec[4*i+1].first;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                  peakAmp  = paramVec[4*i+2].first;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                  peakMean = paramVec[4*i+3].first;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="comment">//Highest ADC count in peak = peakAmpTrue</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <span class="keywordtype">double</span> peakAmpTrue = signal[std::get&lt;0&gt;(peakVals.at(i))];</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="keywordtype">double</span> peakAmpErr = 1.;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="comment">//Determine peak position of fitted function (= peakMeanTrue)</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                TF1 Exponentials(<span class="stringliteral">&quot;Exponentials&quot;</span>,<span class="stringliteral">&quot;( [0] * exp(0.4*(x-[1])/[2]) / ( 1 + exp(0.4*(x-[1])/[3]) ) )&quot;</span>,startT,endT);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                Exponentials.SetParameter(0, peakAmp);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                Exponentials.SetParameter(1, peakMean);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                Exponentials.SetParameter(2, peakTau1);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                Exponentials.SetParameter(3, peakTau2);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="keywordtype">double</span> peakMeanTrue = Exponentials.GetMaximumX(startT,endT);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                Exponentials.Delete();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="comment">//Calculate width (=FWHM)</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordtype">double</span> peakWidth = <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#afc8947a752ff69b717f32ba4f349842f">WidthFunc</a>(peakMean, peakAmp, peakTau1, peakTau2, startT, endT, peakMeanTrue);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                peakWidth /= <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">fWidthNormalization</a>; <span class="comment">//from FWHM to &quot;standard deviation&quot;: standard deviation = FWHM/(2*sqrt(2*ln(2)))</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="comment">// Extract fit parameter errors</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="keywordtype">double</span> peakMeanErr;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  peakMeanErr  = paramVec[2*(i+1)+1].<a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  peakMeanErr  = paramVec[4*i+3].second;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordtype">double</span> peakWidthErr = 0.1*peakWidth;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="comment">// ### Charge ###</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordtype">double</span> charge = <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a67166b9396014ec57f53021a7af3f47c">ChargeFunc</a>(peakMean, peakAmp, peakTau1, peakTau2, fChargeNorm, peakMeanTrue);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="keywordtype">double</span> chargeErr = std::sqrt(TMath::Pi()) * (peakAmpErr*peakWidthErr + peakWidthErr*peakAmpErr);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="comment">// ### limits for getting sum of ADC counts</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="keywordtype">int</span> startTthisHit = std::get&lt;2&gt;(peakVals.at(i));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordtype">int</span> endTthisHit = std::get&lt;3&gt;(peakVals.at(i));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                std::vector&lt;float&gt;::const_iterator sumStartItr = signal.begin() + startTthisHit;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                std::vector&lt;float&gt;::const_iterator sumEndItr   = signal.begin() + endTthisHit;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="comment">// ### Sum of ADC counts</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="keywordtype">double</span> sumADC = std::accumulate(sumStartItr, sumEndItr + 1, 0.);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="comment">//Check if fit returns reasonable values and ich chi2 is below threshold</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordflow">if</span>(peakWidth &lt;= 0 || charge &lt;= 0. || charge != charge || ( nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFMax ) || ( nExponentialsForFit &gt;= 2 &amp;&amp; chi2PerNDF &gt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax ) )</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                  <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;= 1)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                  {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: For peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; in this group:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="keywordflow">if</span>( peakWidth &lt;= 0 || charge &lt;= 0. || charge != charge) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Fit function returned width &lt; 0 or charge &lt; 0 or charge = nan.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    <span class="keywordflow">if</span>( ( nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFMax ) || ( nExponentialsForFit &gt;= 2 &amp;&amp; chi2PerNDF &gt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax ) )</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: For fit of this group (&quot;</span> &lt;&lt;  NumberOfPeaksBeforeFit &lt;&lt; <span class="stringliteral">&quot; peaks before refit, &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; <span class="stringliteral">&quot; peaks after refit): &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                      <span class="keywordflow">if</span> ( nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFMax ) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;chi2/ndf of this fit (&quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; <span class="stringliteral">&quot;) is higher than threshold (&quot;</span> &lt;&lt; fChi2NDFMax &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                      <span class="keywordflow">if</span> ( nExponentialsForFit &gt;= 2 &amp;&amp; chi2PerNDF &gt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax ) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;chi2/ndf of this fit (&quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; <span class="stringliteral">&quot;) is higher than threshold (&quot;</span> &lt;&lt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; DO NOT create hit object from fit parameters but use peak values instead.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; Set fit parameter so that a sharp peak with a width of 1 tick is shown in the event display. This indicates that the fit failed.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                  }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                  peakWidth = ( ( (double)endTthisHit - (<span class="keywordtype">double</span>)startTthisHit )/4. ) / <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">fWidthNormalization</a>; <span class="comment">//~4 is the factor between FWHM and full width of the hit (last bin - first bin). no drift: 4.4, 6m drift: 3.7</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                  peakMeanErr=peakWidth/2;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                  charge = sumADC;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                  peakMeanTrue = std::get&lt;0&gt;(peakVals.at(i));</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                  <span class="comment">//set the fit values to make it visible in the event display that this fit failed</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                  peakMean = peakMeanTrue;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                  peakTau1 = 0.008;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                  peakTau2 = 0.0065;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                  peakAmp = 20.;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="comment">// Create the hit</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <a class="code" href="../../d1/de4/classrecob_1_1HitCreator.html">recob::HitCreator</a> hitcreator(*wire,                            <span class="comment">// wire reference</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                             wid,                              <span class="comment">// wire ID</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                             startTthisHit+roiFirstBinTick,    <span class="comment">// start_tick TODO check</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                             endTthisHit+roiFirstBinTick,  <span class="comment">// end_tick TODO check</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                             peakWidth,                        <span class="comment">// rms</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                             peakMeanTrue+roiFirstBinTick,     <span class="comment">// peak_time</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                             peakMeanErr,                      <span class="comment">// sigma_peak_time</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                             peakAmpTrue,                      <span class="comment">// peak_amplitude</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                             peakAmpErr,                       <span class="comment">// sigma_peak_amplitude</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                             charge,                           <span class="comment">// hit_integral</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                             chargeErr,                        <span class="comment">// hit_sigma_integral</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                             sumADC,                           <span class="comment">// summedADC FIXME</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                             nExponentialsForFit,              <span class="comment">// multiplicity</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                             numHits,                          <span class="comment">// local_index TODO check that the order is correct</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                             chi2PerNDF,                       <span class="comment">// goodness_of_fit</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                             NDF                               <span class="comment">// dof</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                             );</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=6)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Created hit object for peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; in this group with the following parameters (obtained from fit):&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitStartTick: &quot;</span> &lt;&lt; startTthisHit+roiFirstBinTick &lt;&lt; std::endl;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitEndTick: &quot;</span> &lt;&lt; endTthisHit+roiFirstBinTick &lt;&lt; std::endl;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitWidthTicks: &quot;</span> &lt;&lt; peakWidth &lt;&lt; std::endl;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitMeanTick: &quot;</span> &lt;&lt; peakMeanTrue+roiFirstBinTick &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; peakMeanErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitAmplitude [ADC]: &quot;</span> &lt;&lt; peakAmpTrue &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; peakAmpErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitIntegral [ADC*ticks]: &quot;</span> &lt;&lt; charge &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; chargeErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitADCSum [ADC*ticks]: &quot;</span> &lt;&lt; sumADC &lt;&lt; std::endl;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitMultiplicity: &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; std::endl;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitIndex in group: &quot;</span> &lt;&lt; numHits &lt;&lt; std::endl;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Hitchi2/ndf: &quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitNDF: &quot;</span> &lt;&lt; NDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>(hitcreator.<a class="code" href="../../d1/de4/classrecob_1_1HitCreator.html#acfb09016a1ec64e60f9103142c1a5f95">move</a>());</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                hcol.<a class="code" href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html#abe4bc553e92adfcae68adfdc0a635bca">emplace_back</a>(std::move(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>), wire, rawdigits);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="comment">// add fit parameters associated to the hit just pushed to the collection</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                std::array&lt;float, 4&gt; fitParams;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                fitParams[0] = peakMean+roiFirstBinTick;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                fitParams[1] = peakTau1;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                fitParams[2] = peakTau2;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                fitParams[3] = peakAmp;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">fHitParamWriter</a>.<a class="code" href="../../d2/dd8/classanab_1_1FVectorWriter.html#ae8914650df7d2fbfa772f3f31e8090b6">addVector</a>(hitID, fitParams);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                numHits++;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;              } <span class="comment">// &lt;---End loop over Exponentials</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">//            } // &lt;---End if chi2 &lt;= chi2Max</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          } <span class="comment">// &lt;---End if(NumberOfPeaksBeforeFit &lt;= fMaxMultiHit &amp;&amp; width &lt;= fMaxGroupLength), then fit</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;          <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          <span class="comment">// ### If too large then force alternate solution      ###</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          <span class="comment">// ### - Make n hits from pulse train where n will     ###</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          <span class="comment">// ###   depend on the fhicl parameter fLongPulseWidth ###</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <span class="comment">// ### Also do this if chi^2 is too large              ###</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="comment">// #######################################################</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordflow">if</span>( NumberOfPeaksBeforeFit &gt; fMaxMultiHit || (width &gt; fMaxGroupLength) || NFluctuations &gt; fMaxFluctuations)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordtype">int</span> nHitsInThisGroup = (endT - startT + 1) / fLongPulseWidth;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordflow">if</span> (nHitsInThisGroup &gt; fLongMaxHits)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              nHitsInThisGroup = <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae8d63f8a7469ad8b4f48dd74f7223e67">fLongMaxHits</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;              fLongPulseWidth = (endT - startT + 1) / nHitsInThisGroup;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordflow">if</span> (nHitsInThisGroup * fLongPulseWidth &lt; (endT - startT + 1) ) nHitsInThisGroup++;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordtype">int</span> firstTick = startT;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordtype">int</span> lastTick  = std::min(endT,firstTick+fLongPulseWidth-1);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;= 1)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;              <span class="keywordflow">if</span>( NumberOfPeaksBeforeFit &gt; fMaxMultiHit)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;              {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Number of peaks in this group (&quot;</span> &lt;&lt; NumberOfPeaksBeforeFit &lt;&lt; <span class="stringliteral">&quot;) is higher than threshold (&quot;</span> &lt;&lt;  fMaxMultiHit &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; DO NOT fit. Split group of peaks into hits with equal length instead.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;              }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              <span class="keywordflow">if</span>( width &gt; fMaxGroupLength)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: group of peak is longer (&quot;</span> &lt;&lt; width &lt;&lt; <span class="stringliteral">&quot; ticks) than threshold (&quot;</span> &lt;&lt;  fMaxGroupLength &lt;&lt; <span class="stringliteral">&quot; ticks).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; DO NOT fit. Split group of peaks into hits with equal length instead.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;              }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;              <span class="keywordflow">if</span>( NFluctuations &gt; fMaxFluctuations)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;              {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: fluctuations (&quot;</span> &lt;&lt; NFluctuations &lt;&lt; <span class="stringliteral">&quot;) higher than threshold (&quot;</span> &lt;&lt;  fMaxFluctuations &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; DO NOT fit. Split group of peaks into hits with equal length instead.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;              }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">              if( ( nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFMax ) || ( nExponentialsForFit &gt;= 2 &amp;&amp; chi2PerNDF &gt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax ) )</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">              {</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">                std::cout &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;WARNING: For fit of this group (&quot; &lt;&lt;  NumberOfPeaksBeforeFit &lt;&lt; &quot; peaks before refit, &quot; &lt;&lt; nExponentialsForFit &lt;&lt; &quot; peaks after refit): &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">                if ( nExponentialsForFit == 1 &amp;&amp; chi2PerNDF &gt; fChi2NDFMax ) std::cout &lt;&lt; &quot;chi2/ndf of this fit (&quot; &lt;&lt; chi2PerNDF &lt;&lt; &quot;) is higher than threshold (&quot; &lt;&lt; fChi2NDFMax &lt;&lt; &quot;).&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">                if ( nExponentialsForFit &gt;= 2 &amp;&amp; chi2PerNDF &gt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax ) std::cout &lt;&lt; &quot;chi2/ndf of this fit (&quot; &lt;&lt; chi2PerNDF &lt;&lt; &quot;) is higher than threshold (&quot; &lt;&lt; fChi2NDFMaxFactorMultiHits*fChi2NDFMax &lt;&lt; &quot;).&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;---&gt; DO NOT create hit object but split group of peaks into hits with equal length instead.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">              }*/</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; Group goes from tick &quot;</span> &lt;&lt; roiFirstBinTick+startT &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; roiFirstBinTick+endT &lt;&lt; <span class="stringliteral">&quot;. Split group into (&quot;</span> &lt;&lt; roiFirstBinTick+endT &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; roiFirstBinTick+startT &lt;&lt; <span class="stringliteral">&quot;)/&quot;</span> &lt;&lt; fLongPulseWidth &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt;  (endT - startT) &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; fLongPulseWidth &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; nHitsInThisGroup &lt;&lt; <span class="stringliteral">&quot; peaks (&quot;</span> &lt;&lt; fLongPulseWidth &lt;&lt; <span class="stringliteral">&quot; = LongPulseWidth), or maximum LongMaxHits = &quot;</span> &lt;&lt; fLongMaxHits &lt;&lt; <span class="stringliteral">&quot; peaks.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> hitIdx = 0; hitIdx &lt; nHitsInThisGroup; hitIdx++)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;              <span class="comment">// This hit parameters</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;              <span class="keywordtype">double</span> peakWidth = ( (lastTick - firstTick) /4. ) / <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">fWidthNormalization</a>; <span class="comment">//~4 is the factor between FWHM and full width of the hit (last bin - first bin). no drift: 4.4, 6m drift: 3.7</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;              <span class="keywordtype">double</span> peakMeanTrue = (firstTick + lastTick) / 2.;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;              <span class="keywordflow">if</span>( NumberOfPeaksBeforeFit == 1 &amp;&amp; nHitsInThisGroup == 1) peakMeanTrue = std::get&lt;0&gt;(peakVals.at(0)); <span class="comment">//if only one peak was found, we want the mean of this peak to be the tick with the max. ADC count</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;              <span class="keywordtype">double</span> peakMeanErr = (lastTick - firstTick) / 2.;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              <span class="keywordtype">double</span> sumADC    = std::accumulate(signal.begin() + firstTick, signal.begin() + lastTick + 1, 0.);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;              <span class="keywordtype">double</span> charge = sumADC;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;              <span class="keywordtype">double</span> chargeErr = 0.1*sumADC;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;              <span class="keywordtype">double</span> peakAmpTrue = 0;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = firstTick; <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> &lt;= lastTick; <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>++)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;              {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keywordflow">if</span>(signal[<a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>] &gt; peakAmpTrue) peakAmpTrue = signal[<a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>];</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;              }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;              <span class="keywordtype">double</span> peakAmpErr = 1.;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;              nExponentialsForFit = nHitsInThisGroup;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;              NDF         = -1;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;              chi2PerNDF  =   -1.;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              <span class="comment">//set the fit values to make it visible in the event display that this fit failed</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;              <span class="keywordtype">double</span> peakMean = peakMeanTrue-2;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;              <span class="keywordtype">double</span> peakTau1 = 0.008;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;              <span class="keywordtype">double</span> peakTau2 = 0.0065;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;              <span class="keywordtype">double</span> peakAmp = 20.;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;              <a class="code" href="../../d1/de4/classrecob_1_1HitCreator.html">recob::HitCreator</a> hitcreator(*wire,                            <span class="comment">// wire reference</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                           wid,                              <span class="comment">// wire ID</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                           firstTick+roiFirstBinTick,        <span class="comment">// start_tick TODO check</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                           lastTick+roiFirstBinTick,         <span class="comment">// end_tick TODO check</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                           peakWidth,                        <span class="comment">// rms</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                           peakMeanTrue+roiFirstBinTick,     <span class="comment">// peak_time</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                           peakMeanErr,                      <span class="comment">// sigma_peak_time</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                           peakAmpTrue,                          <span class="comment">// peak_amplitude</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                           peakAmpErr,                       <span class="comment">// sigma_peak_amplitude</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                           charge,                           <span class="comment">// hit_integral</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                           chargeErr,                        <span class="comment">// hit_sigma_integral</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                           sumADC,                           <span class="comment">// summedADC FIXME</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                           nExponentialsForFit,              <span class="comment">// multiplicity</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                           hitIdx,                          <span class="comment">// local_index TODO check that the order is correct</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                           chi2PerNDF,                       <span class="comment">// goodness_of_fit</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                           NDF                               <span class="comment">// dof</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                           );</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">fLogLevel</a> &gt;=6)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;              {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;- Created hit object for peak #&quot;</span> &lt;&lt; hitIdx &lt;&lt; <span class="stringliteral">&quot; in this group with the following parameters (obtained from waveform):&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitStartTick: &quot;</span> &lt;&lt; firstTick+roiFirstBinTick &lt;&lt; std::endl;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitEndTick: &quot;</span> &lt;&lt; lastTick+roiFirstBinTick &lt;&lt; std::endl;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitWidthTicks: &quot;</span> &lt;&lt; peakWidth &lt;&lt; std::endl;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitMeanTick: &quot;</span> &lt;&lt; peakMeanTrue+roiFirstBinTick &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; peakMeanErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitAmplitude [ADC]: &quot;</span> &lt;&lt; peakAmpTrue &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; peakAmpErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitIntegral [ADC*ticks]: &quot;</span> &lt;&lt; charge &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span> &lt;&lt; chargeErr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitADCSum [ADC*ticks]: &quot;</span> &lt;&lt; sumADC &lt;&lt; std::endl;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitMultiplicity: &quot;</span> &lt;&lt; nExponentialsForFit &lt;&lt; std::endl;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitIndex in group: &quot;</span> &lt;&lt; hitIdx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Hitchi2/ndf: &quot;</span> &lt;&lt; chi2PerNDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;HitNDF: &quot;</span> &lt;&lt; NDF &lt;&lt; std::endl;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>(hitcreator.<a class="code" href="../../d1/de4/classrecob_1_1HitCreator.html#acfb09016a1ec64e60f9103142c1a5f95">move</a>());</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;              hcol.<a class="code" href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html#abe4bc553e92adfcae68adfdc0a635bca">emplace_back</a>(std::move(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>), wire, rawdigits);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;              std::array&lt;float, 4&gt; fitParams;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;              fitParams[0] = peakMean+roiFirstBinTick;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              fitParams[1] = peakTau1;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              fitParams[2] = peakTau2;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;              fitParams[3] = peakAmp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;              <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">fHitParamWriter</a>.<a class="code" href="../../d2/dd8/classanab_1_1FVectorWriter.html#ae8914650df7d2fbfa772f3f31e8090b6">addVector</a>(hitID, fitParams);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;              <span class="comment">// set for next loop</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;              firstTick = lastTick+1;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;              lastTick  = std::min(firstTick + fLongPulseWidth - 1, endT);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            }<span class="comment">//&lt;---Hits in this group</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          }<span class="comment">//&lt;---End if #peaks &gt; MaxMultiHit</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a8d85f16917e8be98cc7b32d84ea8bf70">fChi2</a>-&gt;Fill(chi2PerNDF);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;         }<span class="comment">//&lt;---End loop over merged candidate hits</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;       } <span class="comment">//&lt;---End looping over ROI&#39;s</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;     }<span class="comment">//&lt;---End looping over all the wires</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">//==================================================================================================</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">// End of the event</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// move the hit collection and the associations into the event</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    hcol.<a class="code" href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html#a997b6e6c44c6f187351703ed6683c0e6">put_into</a>(evt);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// and put hit fit parameters together with metadata into the event</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">fHitParamWriter</a>.<a class="code" href="../../d2/dd8/classanab_1_1FVectorWriter.html#aa5b3eef17c9848e5cfc2c018598ece1e">saveOutputs</a>(evt);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;} <span class="comment">// End of produce()</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">// Initial finding of candidate peaks</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">  981</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">hit::DPRawHitFinder::findCandidatePeaks</a>(std::vector&lt;float&gt;::const_iterator   startItr,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                            std::vector&lt;float&gt;::const_iterator    stopItr,</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                            <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;std::tuple&lt;int,int,int&gt;&gt;&amp; timeValsVec,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                            <span class="keywordtype">float</span>&amp;                                PeakMin,</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                            <span class="keywordtype">int</span>                                   firstTick)<span class="keyword"> const</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// Need a minimum number of ticks to do any work here</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (std::distance(startItr,stopItr) &gt; 4)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="comment">// Find the highest peak in the range given</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keyword">auto</span> maxItr = std::max_element(startItr, stopItr);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordtype">float</span> maxValue = *maxItr;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordtype">int</span>   maxTime  = std::distance(startItr,maxItr);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">if</span> (maxValue &gt;= PeakMin)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="comment">// backwards to find first bin for this candidate hit</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keyword">auto</span> firstItr = std::distance(startItr,maxItr) &gt; 2 ? maxItr - 1 : startItr;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordtype">bool</span> PeakStartIsHere = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordflow">while</span>(firstItr != startItr)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="comment">//Check for inflection point &amp; ADC count &lt;= 0</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                PeakStartIsHere = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i &lt;= fTicksToStopPeakFinder; i++)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    <span class="keywordflow">if</span>( *firstItr &gt;= *(firstItr-i) )</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    PeakStartIsHere = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                <span class="keywordflow">if</span> (*firstItr &lt;= 0 || PeakStartIsHere) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                firstItr--;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordtype">int</span> firstTime = std::distance(startItr,firstItr);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="comment">// Recursive call to find all candidate hits earlier than this peak</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            findCandidatePeaks(startItr, firstItr - 1, timeValsVec, PeakMin, firstTick);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="comment">// forwards to find last bin for this candidate hit</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keyword">auto</span> lastItr = std::distance(maxItr,stopItr) &gt; 2 ? maxItr + 1 : stopItr - 1;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordtype">bool</span> PeakEndIsHere = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">while</span>(lastItr != stopItr)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="comment">//Check for inflection point &amp; ADC count &lt;= 0</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                PeakEndIsHere = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i &lt;= fTicksToStopPeakFinder; i++)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    <span class="keywordflow">if</span>( *lastItr &gt;= *(lastItr+i) )</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    PeakEndIsHere = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <span class="keywordflow">if</span> (*lastItr &lt;= 0 || PeakEndIsHere) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                lastItr++;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keywordtype">int</span> lastTime = std::distance(startItr,lastItr);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="comment">// Now save this candidate&#39;s start and max time info</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            timeValsVec.push_back(std::make_tuple(firstTick+firstTime,firstTick+maxTime,firstTick+lastTime));</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="comment">// Recursive call to find all candidate hits later than this peak</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            findCandidatePeaks(lastItr + 1, stopItr, timeValsVec, PeakMin, firstTick + std::distance(startItr,lastItr + 1));</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;}</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">// Merging of nearby candidate peaks</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce"> 1061</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce">hit::DPRawHitFinder::mergeCandidatePeaks</a>(<span class="keyword">const</span> std::vector&lt;float&gt; signalVec, <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">TimeValsVec</a> timeValsVec, <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">MergedTimeWidVec</a>&amp; mergedVec)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;{</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">// ################################################################</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">// ### Lets loop over the candidate pulses we found in this ROI ###</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="comment">// ################################################################</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keyword">auto</span> timeValsVecItr = timeValsVec.begin();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> PeaksInThisMergedPeak = 0;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">//int EndTickOfPreviousMergedPeak=0;</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">while</span>(timeValsVecItr != timeValsVec.end())</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a> peakVals;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="comment">// Setting the start, peak, and end time of the pulse</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keyword">auto</span>&amp; timeVal = *timeValsVecItr++;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordtype">int</span> startT = std::get&lt;0&gt;(timeVal);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordtype">int</span> maxT   = std::get&lt;1&gt;(timeVal);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordtype">int</span> endT   = std::get&lt;2&gt;(timeVal);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordtype">int</span> widT   = endT - startT;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordtype">int</span> FinalStartT=startT;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordtype">int</span> FinalEndT=endT;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordtype">int</span> NFluctuations=EstimateFluctuations(signalVec, startT, maxT, endT);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        peakVals.emplace_back(maxT,widT,startT,endT);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// See if we want to merge pulses together</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="comment">// First check if we have more than one pulse on the wire</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordtype">bool</span> checkNextHit = timeValsVecItr != timeValsVec.end();</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// Loop until no more merged pulses (or candidates in this ROI)</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">while</span>(checkNextHit)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="comment">// group hits if start time of the next pulse is &lt; end time + fGroupMaxDistance of current pulse and if intermediate signal between two pulses doesn&#39;t go below fMinBinToGroup and if the hits are not all above the merge max adc limit</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="keywordtype">int</span> NextStartT = std::get&lt;0&gt;(*timeValsVecItr);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">double</span> MinADC = signalVec[endT];</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = endT; i &lt;= NextStartT; i++)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="keywordflow">if</span>(signalVec[i]&lt;MinADC)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                MinADC = signalVec[i];</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="comment">// Group peaks (grouped peaks are fitted together and can be merged)</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">if</span>( MinADC &gt;= fGroupMinADC &amp;&amp; NextStartT - endT &lt;= fGroupMaxDistance )</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="keywordtype">int</span> CurrentStartT=startT;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="keywordtype">int</span> CurrentMaxT=maxT;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="keywordtype">int</span> CurrentEndT=endT;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="comment">//int CurrentWidT=widT;</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                timeVal = *timeValsVecItr++;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordtype">int</span> NextMaxT = std::get&lt;1&gt;(timeVal);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                <span class="keywordtype">int</span> NextEndT = std::get&lt;2&gt;(timeVal);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <span class="keywordtype">int</span> NextWidT = NextEndT - NextStartT;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                FinalEndT=NextEndT;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                NFluctuations += EstimateFluctuations(signalVec, NextStartT, NextMaxT, NextEndT);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="keywordtype">int</span> CurrentSumADC = 0;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = CurrentStartT; i&lt;= CurrentEndT; i++)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                    CurrentSumADC+=signalVec[i];</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="keywordtype">int</span> NextSumADC = 0;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = NextStartT; i&lt;= NextEndT; i++)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    NextSumADC+=signalVec[i];</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <span class="comment">//Merge peaks within a group</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="keywordflow">if</span>(fDoMergePeaks)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    <span class="keywordflow">if</span>( signalVec[NextMaxT] &lt;= signalVec[CurrentMaxT] &amp;&amp; ( ( signalVec[NextMaxT] &lt; fMergeMaxADCThreshold*signalVec[CurrentMaxT] &amp;&amp;  NextSumADC &lt; fMergeADCSumThreshold*CurrentSumADC ) || (signalVec[NextMaxT]-signalVec[NextStartT]) &lt; fMinRelativePeakHeightRight*signalVec[CurrentMaxT]  ) &amp;&amp; ( signalVec[NextMaxT] &lt;= fMergeMaxADCLimit ) )</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                        maxT=CurrentMaxT;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                        startT=CurrentStartT;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                        endT=NextEndT;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        widT=endT - startT;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                        peakVals.pop_back();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        peakVals.emplace_back(maxT,widT,startT,endT);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( signalVec[NextMaxT] &gt; signalVec[CurrentMaxT] &amp;&amp; ( ( signalVec[CurrentMaxT] &lt; fMergeMaxADCThreshold*signalVec[NextMaxT] &amp;&amp;  CurrentSumADC &lt; fMergeADCSumThreshold*NextSumADC ) || (signalVec[CurrentMaxT]-signalVec[CurrentEndT]) &lt; fMinRelativePeakHeightLeft*signalVec[NextMaxT]  ) &amp;&amp; ( signalVec[CurrentMaxT] &lt;= fMergeMaxADCLimit ) )</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                    {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                        maxT=NextMaxT;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                        startT=CurrentStartT;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                        endT=NextEndT;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        widT=endT - startT;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        peakVals.pop_back();</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        peakVals.emplace_back(maxT,widT,startT,endT);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                    }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                        maxT=NextMaxT;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        startT=NextStartT;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                        endT=NextEndT;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        widT=NextWidT;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                        peakVals.emplace_back(maxT,widT,startT,endT);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                        PeaksInThisMergedPeak++;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                    maxT=NextMaxT;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                    startT=NextStartT;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                    endT=NextEndT;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    widT=NextWidT;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    peakVals.emplace_back(maxT,widT,startT,endT);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    PeaksInThisMergedPeak++;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                checkNextHit = timeValsVecItr != timeValsVec.end();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            }<span class="comment">//&lt;---Checking adjacent pulses</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                checkNextHit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                PeaksInThisMergedPeak = 0;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        }<span class="comment">//&lt;---End checking if there is more than one pulse on the wire</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="comment">// Add these to our merged vector</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        mergedVec.emplace_back(FinalStartT, FinalEndT, peakVals, NFluctuations);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;}</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">// ----------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">// Estimate fluctuations for a group of peaks to identify hits from particles in drift direction</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">// ----------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac4a2e230f393678103d444e9dc423064"> 1191</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac4a2e230f393678103d444e9dc423064">hit::DPRawHitFinder::EstimateFluctuations</a>(<span class="keyword">const</span> std::vector&lt;float&gt;  fsignalVec,</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                              <span class="keywordtype">int</span>                       peakStart,</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                              <span class="keywordtype">int</span>                       peakMean,</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                              <span class="keywordtype">int</span>                       peakEnd)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;{</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordtype">int</span> NFluctuations=0;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = peakMean-1; j &gt;= peakStart; j--)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span>(fsignalVec[j] &lt; 5) <span class="keywordflow">break</span>; <span class="comment">//do not look for fluctuations below 5 ADC counts (this should depend on the noise RMS)</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">if</span>(fsignalVec[j] &gt; fsignalVec[j+1])</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      NFluctuations++;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = peakMean+1; j &lt;= peakEnd; j++)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span>(fsignalVec[j] &lt; 5) <span class="keywordflow">break</span>; <span class="comment">//do not look for fluctuations below 5 ADC counts (this should depend on the noise RMS)</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span>(fsignalVec[j] &gt; fsignalVec[j-1])</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      NFluctuations++;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">return</span> NFluctuations;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">// Fit Exponentials</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">// --------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed"> 1224</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">hit::DPRawHitFinder::FitExponentials</a>(<span class="keyword">const</span> std::vector&lt;float&gt;  fSignalVector,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>      fPeakVals,</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                          <span class="keywordtype">int</span>                       fStartTime,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                          <span class="keywordtype">int</span>                       fEndTime,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                          <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a>&amp;             fparamVec,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                          <span class="keywordtype">double</span>&amp;                   fchi2PerNDF,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                          <span class="keywordtype">int</span>&amp;                      fNDF,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                          <span class="keywordtype">bool</span>                      fSameShape)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = fEndTime - fStartTime + 1;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">int</span> NPeaks = fPeakVals.size();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// #############################################</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// ### If size &lt; 0 then set the size to zero ###</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// #############################################</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">if</span>(fEndTime - fStartTime &lt; 0){size = 0;}</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// --- TH1D HitSignal ---</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    TH1F hitSignal(<span class="stringliteral">&quot;hitSignal&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(size,1),fStartTime,fEndTime+1);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    hitSignal.Sumw2();</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">// #############################</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// ### Filling the histogram ###</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">// #############################</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = fStartTime; i &lt; fEndTime+1; i++)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        hitSignal.Fill(i,fSignalVector[i]);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        hitSignal.SetBinError(i,0.288675); <span class="comment">//1/sqrt(12)</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">// ################################################</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// ### Building TFormula for basic Exponentials ###</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// ################################################</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    std::string eqn = CreateFitFunction(NPeaks, fSameShape);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">// -------------------------------------</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="comment">// --- TF1 function for Exponentials ---</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">// -------------------------------------</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    TF1 Exponentials(<span class="stringliteral">&quot;Exponentials&quot;</span>,eqn.c_str(),fStartTime,fEndTime+1);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span>(fLogLevel &gt;= 4)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;--- Preparing fit ---&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;--- Lower limits, seed, upper limit:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      Exponentials.SetParameter(0, 0.5);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      Exponentials.SetParameter(1, 0.5);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      Exponentials.SetParLimits(0, fMinTau, fMaxTau);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      Exponentials.SetParLimits(1, fMinTau, fMaxTau);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keywordtype">double</span> amplitude=0;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordtype">double</span> peakMean=0;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keywordtype">double</span> peakMeanShift=2;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordtype">double</span> peakMeanSeed=0;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordtype">double</span> peakMeanRangeLow=0;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordtype">double</span> peakMeanRangeHi=0;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="keywordtype">double</span> peakStart=0;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordtype">double</span> peakEnd=0;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NPeaks; i++)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        peakMean = std::get&lt;0&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        peakStart = std::get&lt;2&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        peakEnd = std::get&lt;3&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        peakMeanSeed=peakMean-peakMeanShift;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        peakMeanRangeLow = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakStart-peakMeanShift, peakMeanSeed-fFitPeakMeanRange);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        peakMeanRangeHi = std::min(peakEnd, peakMeanSeed+fFitPeakMeanRange);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        amplitude = fSignalVector[peakMean];</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        Exponentials.SetParameter(2*(i+1), 1.65*amplitude);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        Exponentials.SetParLimits(2*(i+1), 0.3*1.65*amplitude, 2*1.65*amplitude);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        Exponentials.SetParameter(2*(i+1)+1, peakMeanSeed);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">if</span>(NPeaks == 1)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;          Exponentials.SetParLimits(2*(i+1)+1, peakMeanRangeLow, peakMeanRangeHi);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NPeaks &gt;= 2 &amp;&amp; i == 0)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToNextMean = 0.5*(std::get&lt;0&gt;(fPeakVals.at(i+1)) - peakMean);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          Exponentials.SetParLimits( 2*(i+1)+1, peakMeanRangeLow, std::min(peakMeanRangeHi, peakMeanSeed+HalfDistanceToNextMean) );</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NPeaks &gt;= 2 &amp;&amp; i == NPeaks-1)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToPrevMean = 0.5*(peakMean - std::get&lt;0&gt;(fPeakVals.at(i-1)));</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          Exponentials.SetParLimits(2*(i+1)+1, <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakMeanRangeLow, peakMeanSeed-HalfDistanceToPrevMean), peakMeanRangeHi );</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToNextMean = 0.5*(std::get&lt;0&gt;(fPeakVals.at(i+1)) - peakMean);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToPrevMean = 0.5*(peakMean - std::get&lt;0&gt;(fPeakVals.at(i-1)));</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          Exponentials.SetParLimits(2*(i+1)+1, <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakMeanRangeLow, peakMeanSeed-HalfDistanceToPrevMean), std::min(peakMeanRangeHi, peakMeanSeed+HalfDistanceToNextMean) );</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="keywordflow">if</span>(fLogLevel &gt;= 4)</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          <span class="keywordtype">double</span> t0low, t0high;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          Exponentials.GetParLimits(2*(i+1)+1, t0low, t0high);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; 0.3*1.65*amplitude &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; 1.65*amplitude &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; 2*1.65*amplitude &lt;&lt; std::endl;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; t0low &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; peakMeanSeed &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; t0high &lt;&lt; std::endl;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordtype">double</span> amplitude=0;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordtype">double</span> peakMean=0;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordtype">double</span> peakMeanShift=2;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="keywordtype">double</span> peakMeanSeed=0;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keywordtype">double</span> peakMeanRangeLow=0;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordtype">double</span> peakMeanRangeHi=0;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordtype">double</span> peakStart=0;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordtype">double</span> peakEnd=0;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NPeaks; i++)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        Exponentials.SetParameter(4*i, 0.5);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        Exponentials.SetParameter(4*i+1, 0.5);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        Exponentials.SetParLimits(4*i, fMinTau, fMaxTau);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        Exponentials.SetParLimits(4*i+1, fMinTau, fMaxTau);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        peakMean = std::get&lt;0&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        peakStart = std::get&lt;2&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        peakEnd = std::get&lt;3&gt;(fPeakVals.at(i));</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        peakMeanSeed=peakMean-peakMeanShift;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        peakMeanRangeLow = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakStart-peakMeanShift, peakMeanSeed-fFitPeakMeanRange);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        peakMeanRangeHi = std::min(peakEnd, peakMeanSeed+fFitPeakMeanRange);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        amplitude = fSignalVector[peakMean];</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        Exponentials.SetParameter(4*i+2, 1.65*amplitude);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        Exponentials.SetParLimits(4*i+2, 0.3*1.65*amplitude, 2*1.65*amplitude);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        Exponentials.SetParameter(4*i+3, peakMeanSeed);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">if</span>(NPeaks == 1)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          Exponentials.SetParLimits(4*i+3, peakMeanRangeLow, peakMeanRangeHi);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NPeaks &gt;= 2 &amp;&amp; i == 0)</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToNextMean = 0.5*(std::get&lt;0&gt;(fPeakVals.at(i+1)) - peakMean);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;          Exponentials.SetParLimits( 4*i+3, peakMeanRangeLow, std::min(peakMeanRangeHi, peakMeanSeed+HalfDistanceToNextMean) );</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NPeaks &gt;= 2 &amp;&amp; i == NPeaks-1)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToPrevMean = 0.5*(peakMean - std::get&lt;0&gt;(fPeakVals.at(i-1)));</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;          Exponentials.SetParLimits(4*i+3, <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakMeanRangeLow, peakMeanSeed-HalfDistanceToPrevMean), peakMeanRangeHi );</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToNextMean = 0.5*(std::get&lt;0&gt;(fPeakVals.at(i+1)) - peakMean);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          <span class="keywordtype">double</span> HalfDistanceToPrevMean = 0.5*(peakMean - std::get&lt;0&gt;(fPeakVals.at(i-1)));</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          Exponentials.SetParLimits(4*i+3, <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(peakMeanRangeLow, peakMeanSeed-HalfDistanceToPrevMean), std::min(peakMeanRangeHi, peakMeanSeed+HalfDistanceToNextMean) );</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="keywordflow">if</span>(fLogLevel &gt;= 4)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="keywordtype">double</span> t0low, t0high;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          Exponentials.GetParLimits(4*i+3, t0low, t0high);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: A [ADC] = &quot;</span> &lt;&lt; 0.3*1.65*amplitude &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; 1.65*amplitude &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; 2*1.65*amplitude &lt;&lt; std::endl;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Peak #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: t0 [ticks] = &quot;</span> &lt;&lt; t0low &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; peakMeanSeed &lt;&lt; <span class="stringliteral">&quot;  ,  &quot;</span> &lt;&lt; t0high &lt;&lt; std::endl;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">// ###########################################</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">// ### PERFORMING THE TOTAL FIT OF THE HIT ###</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">// ###########################################</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      { hitSignal.Fit(&amp;Exponentials,<span class="stringliteral">&quot;QNRWM&quot;</span>,<span class="stringliteral">&quot;&quot;</span>, fStartTime, fEndTime+1);}</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">catch</span>(...)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      {mf::LogWarning(<span class="stringliteral">&quot;DPRawHitFinder&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Fitter failed finding a hit&quot;</span>;}</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">// ##################################################</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">// ### Getting the fitted parameters from the fit ###</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// ##################################################</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    fchi2PerNDF = (Exponentials.GetChisquare() / Exponentials.GetNDF());</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    fNDF        = Exponentials.GetNDF();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      fparamVec.emplace_back(Exponentials.GetParameter(0),Exponentials.GetParError(0));</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      fparamVec.emplace_back(Exponentials.GetParameter(1),Exponentials.GetParError(1));</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NPeaks; i++)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(2*(i+1)),Exponentials.GetParError(2*(i+1)));</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(2*(i+1)+1),Exponentials.GetParError(2*(i+1)+1));</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NPeaks; i++)</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(4*i),Exponentials.GetParError(4*i));</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(4*i+1),Exponentials.GetParError(4*i+1));</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(4*i+2),Exponentials.GetParError(4*i+2));</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        fparamVec.emplace_back(Exponentials.GetParameter(4*i+3),Exponentials.GetParError(4*i+3));</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    Exponentials.Delete();</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    hitSignal.Delete();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;}<span class="comment">//&lt;----End FitExponentials</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae873bae18638eea8b66a26fe11e4e579"> 1437</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae873bae18638eea8b66a26fe11e4e579">hit::DPRawHitFinder::FindPeakWithMaxDeviation</a>(<span class="keyword">const</span> std::vector&lt;float&gt; fSignalVector,</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                                                   <span class="keywordtype">int</span>                      fNPeaks,</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                                                   <span class="keywordtype">int</span>                      fStartTime,</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                                                   <span class="keywordtype">int</span>                      fEndTime,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                                                   <span class="keywordtype">bool</span>                     fSameShape,</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                                   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">ParameterVec</a>             fparamVec,</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                                   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>           fpeakVals,</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                                   <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">PeakDevVec</a>&amp;              fPeakDev)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;{</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">//   int size = fEndTime - fStartTime + 1;</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">//    if(fEndTime - fStartTime &lt; 0){size = 0;}</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    std::string eqn = CreateFitFunction(fNPeaks, fSameShape);  <span class="comment">// string for equation of Exponentials fit</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    TF1 Exponentials(<span class="stringliteral">&quot;Exponentials&quot;</span>,eqn.c_str(),fStartTime,fEndTime+1);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i &lt; fparamVec.size(); i++)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        Exponentials.SetParameter(i, fparamVec[i].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">// ##########################################################################</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">// ### Finding the peak with the max chi2 fit and signal ###</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">// ##########################################################################</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordtype">double</span> Chi2PerNDFPeak;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordtype">double</span> MaxPosDeviation;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordtype">double</span> MaxNegDeviation;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordtype">int</span> BinMaxPosDeviation;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordtype">int</span> BinMaxNegDeviation;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; fNPeaks; i++)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        Chi2PerNDFPeak = 0.;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        MaxPosDeviation=0.;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        MaxNegDeviation=0.;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        BinMaxPosDeviation=0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        BinMaxNegDeviation=0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = std::get&lt;2&gt;(fpeakVals.at(i)); j &lt; std::get&lt;3&gt;(fpeakVals.at(i))+1; j++)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <span class="keywordflow">if</span>( (Exponentials(j+0.5)-fSignalVector[j]) &gt; MaxPosDeviation &amp;&amp; j != std::get&lt;0&gt;(fpeakVals.at(i)) )</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            MaxPosDeviation = Exponentials(j+0.5)-fSignalVector[j];</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            BinMaxPosDeviation = j;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="keywordflow">if</span>( (Exponentials(j+0.5)-fSignalVector[j]) &lt; MaxNegDeviation &amp;&amp; j != std::get&lt;0&gt;(fpeakVals.at(i)) )</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            MaxNegDeviation = Exponentials(j+0.5)-fSignalVector[j];</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            BinMaxNegDeviation = j;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        Chi2PerNDFPeak += pow((Exponentials(j+0.5)-fSignalVector[j])/sqrt(fSignalVector[j]),2);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="keywordflow">if</span>(BinMaxNegDeviation != 0)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        Chi2PerNDFPeak /= <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>((std::get&lt;3&gt;(fpeakVals.at(i))-std::get&lt;2&gt;(fpeakVals.at(i))));</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        fPeakDev.emplace_back(Chi2PerNDFPeak,i,BinMaxNegDeviation,BinMaxPosDeviation);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;std::sort(fPeakDev.begin(),fPeakDev.end(), [](std::tuple&lt;double,int,int,int&gt; <span class="keyword">const</span> &amp;t1, std::tuple&lt;double,int,int,int&gt; <span class="keyword">const</span> &amp;t2) {<span class="keywordflow">return</span> std::get&lt;0&gt;(t1) &gt; std::get&lt;0&gt;(t2);} );</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;Exponentials.Delete();</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;}</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43be9390f29e91942cf8a7125198b6e4"> 1501</a></span>&#160;std::string <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43be9390f29e91942cf8a7125198b6e4">hit::DPRawHitFinder::CreateFitFunction</a>(<span class="keywordtype">int</span> fNPeaks, <span class="keywordtype">bool</span> fSameShape)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;{</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  std::string feqn = <span class="stringliteral">&quot;&quot;</span>;  <span class="comment">// string holding fit formula</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  std::stringstream numConv;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">if</span>(fSameShape)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; fNPeaks; i++)</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        feqn.append(<span class="stringliteral">&quot;+( [&quot;</span>);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        numConv &lt;&lt; 2*(i+1);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        feqn.append(<span class="stringliteral">&quot;] * exp(0.4*(x-[&quot;</span>);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        numConv &lt;&lt; 2*(i+1)+1;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        feqn.append(<span class="stringliteral">&quot;])/[&quot;</span>);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        numConv &lt;&lt; 0;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        feqn.append(<span class="stringliteral">&quot;]) / ( 1 + exp(0.4*(x-[&quot;</span>);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        numConv &lt;&lt; 2*(i+1)+1;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        feqn.append(<span class="stringliteral">&quot;])/[&quot;</span>);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        numConv &lt;&lt; 1;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    feqn.append(<span class="stringliteral">&quot;]) ) )&quot;</span>);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; fNPeaks; i++)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        feqn.append(<span class="stringliteral">&quot;+( [&quot;</span>);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        numConv &lt;&lt; 4*i+2;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        feqn.append(<span class="stringliteral">&quot;] * exp(0.4*(x-[&quot;</span>);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        numConv &lt;&lt; 4*i+3;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        feqn.append(<span class="stringliteral">&quot;])/[&quot;</span>);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        numConv &lt;&lt; 4*i;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        feqn.append(<span class="stringliteral">&quot;]) / ( 1 + exp(0.4*(x-[&quot;</span>);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        numConv &lt;&lt; 2*(i+1)+1;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        feqn.append(<span class="stringliteral">&quot;])/[&quot;</span>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        numConv.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        numConv &lt;&lt; 4*i+1;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        feqn.append(numConv.str());</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    feqn.append(<span class="stringliteral">&quot;]) ) )&quot;</span>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="keywordflow">return</span> feqn;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;}</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad1961c2589248e97da206b2c3cf7184d"> 1565</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad1961c2589248e97da206b2c3cf7184d">hit::DPRawHitFinder::AddPeak</a>(std::tuple&lt;double,int,int,int&gt; fPeakDevCand,</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                                  <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>&amp; fpeakValsTemp)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;{</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="keywordtype">int</span> PeakNumberWithNewPeak = std::get&lt;1&gt;(fPeakDevCand);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="keywordtype">int</span> NewPeakMax = std::get&lt;2&gt;(fPeakDevCand);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordtype">int</span> OldPeakMax = std::get&lt;0&gt;(fpeakValsTemp.at(PeakNumberWithNewPeak));</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordtype">int</span> OldPeakOldStart = std::get&lt;2&gt;(fpeakValsTemp.at(PeakNumberWithNewPeak));</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordtype">int</span> OldPeakOldEnd = std::get&lt;3&gt;(fpeakValsTemp.at(PeakNumberWithNewPeak));</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordtype">int</span> NewPeakStart=0;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordtype">int</span> NewPeakEnd=0;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordtype">int</span> OldPeakNewStart=0;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordtype">int</span> OldPeakNewEnd=0;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordtype">int</span> DistanceBwOldAndNewPeak=0;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span>(NewPeakMax&lt;OldPeakMax)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    NewPeakStart = OldPeakOldStart;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    OldPeakNewEnd = OldPeakOldEnd;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    DistanceBwOldAndNewPeak = OldPeakMax - NewPeakMax;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    NewPeakEnd = NewPeakMax+0.5*(DistanceBwOldAndNewPeak-(DistanceBwOldAndNewPeak%2));</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">if</span>(DistanceBwOldAndNewPeak%2 == 0) NewPeakEnd -= 1;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    OldPeakNewStart = NewPeakEnd+1;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(OldPeakMax&lt;NewPeakMax)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    NewPeakEnd = OldPeakOldEnd;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    OldPeakNewStart = OldPeakOldStart;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    DistanceBwOldAndNewPeak = NewPeakMax - OldPeakMax;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    OldPeakNewEnd = OldPeakMax+0.5*(DistanceBwOldAndNewPeak-(DistanceBwOldAndNewPeak%2));</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">if</span>(DistanceBwOldAndNewPeak%2 == 0) OldPeakNewEnd -= 1;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    NewPeakStart = OldPeakNewEnd+1;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(OldPeakMax==NewPeakMax){<span class="keywordflow">return</span>;} <span class="comment">//This shouldn&#39;t happen</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  fpeakValsTemp.at(PeakNumberWithNewPeak) = std::make_tuple(OldPeakMax,0,OldPeakNewStart,OldPeakNewEnd);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  fpeakValsTemp.emplace_back(NewPeakMax,0,NewPeakStart,NewPeakEnd);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  std::sort(fpeakValsTemp.begin(),fpeakValsTemp.end(), [](std::tuple&lt;int,int,int,int&gt; <span class="keyword">const</span> &amp;t1, std::tuple&lt;int,int,int,int&gt; <span class="keyword">const</span> &amp;t2) {<span class="keywordflow">return</span> std::get&lt;0&gt;(t1) &lt; std::get&lt;0&gt;(t2);} );</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;}</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a2f50fcd21558bcabe16aee0a9b29a0b9"> 1609</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a2f50fcd21558bcabe16aee0a9b29a0b9">hit::DPRawHitFinder::SplitPeak</a>(std::tuple&lt;double,int,int,int&gt; fPeakDevCand,</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                    <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">PeakTimeWidVec</a>&amp; fpeakValsTemp)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;{</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="keywordtype">int</span> PeakNumberWithNewPeak = std::get&lt;1&gt;(fPeakDevCand);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="keywordtype">int</span> OldPeakOldStart = std::get&lt;2&gt;(fpeakValsTemp.at(PeakNumberWithNewPeak));</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="keywordtype">int</span> OldPeakOldEnd = std::get&lt;3&gt;(fpeakValsTemp.at(PeakNumberWithNewPeak));</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="keywordtype">int</span> WidthOldPeakOld = OldPeakOldEnd - OldPeakOldStart;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="keywordflow">if</span>(WidthOldPeakOld&lt;3) {<span class="keywordflow">return</span>;} <span class="comment">//can&#39;t split peaks with widths &lt; 3</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordtype">int</span> NewPeakMax = 0;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="keywordtype">int</span> NewPeakStart = 0;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="keywordtype">int</span> NewPeakEnd = 0;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="keywordtype">int</span> OldPeakNewMax = 0;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keywordtype">int</span> OldPeakNewStart = 0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="keywordtype">int</span> OldPeakNewEnd = 0;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;OldPeakNewStart = OldPeakOldStart;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;NewPeakEnd = OldPeakOldEnd;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;OldPeakNewEnd = OldPeakNewStart + 0.5*(WidthOldPeakOld + (WidthOldPeakOld%2));</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;NewPeakStart = OldPeakNewEnd+1;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="keywordtype">int</span> WidthOldPeakNew = OldPeakNewEnd-OldPeakNewStart;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="keywordtype">int</span> WidthNewPeak = NewPeakEnd-NewPeakStart;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;OldPeakNewMax = OldPeakNewStart + 0.5*(WidthOldPeakNew - (WidthOldPeakNew%2));</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;NewPeakMax = NewPeakStart + 0.5*(WidthNewPeak - (WidthNewPeak%2));</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;fpeakValsTemp.at(PeakNumberWithNewPeak) = std::make_tuple(OldPeakNewMax,0,OldPeakNewStart,OldPeakNewEnd);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;fpeakValsTemp.emplace_back(NewPeakMax,0,NewPeakStart,NewPeakEnd);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;std::sort(fpeakValsTemp.begin(),fpeakValsTemp.end(), [](std::tuple&lt;int,int,int,int&gt; <span class="keyword">const</span> &amp;t1, std::tuple&lt;int,int,int,int&gt; <span class="keyword">const</span> &amp;t2) {<span class="keywordflow">return</span> std::get&lt;0&gt;(t1) &lt; std::get&lt;0&gt;(t2);} );</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;}</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#afc8947a752ff69b717f32ba4f349842f"> 1647</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#afc8947a752ff69b717f32ba4f349842f">hit::DPRawHitFinder::WidthFunc</a>(<span class="keywordtype">double</span> fPeakMean,</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                                      <span class="keywordtype">double</span> fPeakAmp,</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                      <span class="keywordtype">double</span> fPeakTau1,</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                                      <span class="keywordtype">double</span> fPeakTau2,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                      <span class="keywordtype">double</span> fStartTime,</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                      <span class="keywordtype">double</span> fEndTime,</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                      <span class="keywordtype">double</span> fPeakMeanTrue)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;{</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="keywordtype">double</span> MaxValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(fPeakMeanTrue-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(fPeakMeanTrue-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keywordtype">double</span> FuncValue = 0.;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keywordtype">double</span> HalfMaxLeftTime = 0.;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="keywordtype">double</span> HalfMaxRightTime = 0.;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="keywordtype">double</span> ReBin=10.;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">//First iteration (+- 1 bin)</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = fPeakMeanTrue; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; fStartTime-1000.; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>--)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        HalfMaxLeftTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = fPeakMeanTrue; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; fEndTime+1000.; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>++)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        HalfMaxRightTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">//Second iteration (+- 0.1 bin)</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = HalfMaxLeftTime+1; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; HalfMaxLeftTime; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-=(1/ReBin))</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        HalfMaxLeftTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = HalfMaxRightTime-1; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; HalfMaxRightTime; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+=(1/ReBin))</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        HalfMaxRightTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">//Third iteration (+- 0.01 bin)</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = HalfMaxLeftTime+1/ReBin; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; HalfMaxLeftTime; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-=1/(ReBin*ReBin))</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        HalfMaxLeftTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = HalfMaxRightTime-1/ReBin; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; HalfMaxRightTime; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+=1/(ReBin*ReBin))</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    FuncValue = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">if</span>( FuncValue &lt; 0.5*MaxValue )</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        HalfMaxRightTime = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    }</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="keywordflow">return</span> HalfMaxRightTime-HalfMaxLeftTime;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;}</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a67166b9396014ec57f53021a7af3f47c"> 1728</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a67166b9396014ec57f53021a7af3f47c">hit::DPRawHitFinder::ChargeFunc</a>(<span class="keywordtype">double</span> fPeakMean,</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                       <span class="keywordtype">double</span> fPeakAmp,</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                       <span class="keywordtype">double</span> fPeakTau1,</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                       <span class="keywordtype">double</span> fPeakTau2,</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                       <span class="keywordtype">double</span> fChargeNormFactor,</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                       <span class="keywordtype">double</span> fPeakMeanTrue)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;{</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keywordtype">double</span> ChargeSum = 0.;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="keywordtype">double</span> Charge = 0.;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keywordtype">double</span> ReBin = 10.;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="keywordtype">bool</span> ChargeBigEnough=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = fPeakMeanTrue - 1/ReBin; ChargeBigEnough &amp;&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; fPeakMeanTrue-1000.; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>-=1.)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">double</span> i=0.; i &gt; -1.; i-=(1/ReBin))</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        Charge = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+i-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+i-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        ChargeSum += Charge;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">if</span>(Charge &lt; 0.01) ChargeBigEnough = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;ChargeBigEnough=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = fPeakMeanTrue; ChargeBigEnough &amp;&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; fPeakMeanTrue+1000.; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+=1.)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">double</span> i=0.; i &lt; 1.; i+=(1/ReBin))</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        Charge = ( fPeakAmp * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+i-fPeakMean)/fPeakTau1)) / ( 1 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(0.4*(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>+i-fPeakMean)/fPeakTau2) );</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        ChargeSum += Charge;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keywordflow">if</span>(Charge &lt; 0.01) ChargeBigEnough = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="keywordflow">return</span> ChargeSum*fChargeNormFactor/ReBin;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;}</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a6ed967faf8a3c616d1ade488dea51f00"> 1767</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a6ed967faf8a3c616d1ade488dea51f00">hit::DPRawHitFinder::doBinAverage</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec,</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                      std::vector&lt;float&gt;&amp;       outputVec,</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                                      <span class="keywordtype">size_t</span>                    binsToAverage)<span class="keyword"> const</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordtype">size_t</span> halfBinsToAverage(binsToAverage/2);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordtype">float</span> runningSum(0.);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; halfBinsToAverage; idx++) runningSum += inputVec[idx];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    outputVec.resize(inputVec.size());</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    std::vector&lt;float&gt;::iterator outputVecItr = outputVec.begin();</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="comment">// First pass through to build the erosion vector</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">for</span>(std::vector&lt;float&gt;::const_iterator inputItr = inputVec.begin(); inputItr != inputVec.end(); inputItr++)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <span class="keywordtype">size_t</span> startOffset = std::distance(inputVec.begin(),inputItr);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordtype">size_t</span> stopOffset  = std::distance(inputItr,inputVec.end());</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a>       = std::min(2 * halfBinsToAverage, std::min(startOffset + halfBinsToAverage + 1, halfBinsToAverage + stopOffset - 1));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keywordflow">if</span> (startOffset &gt;= halfBinsToAverage) runningSum -= *(inputItr - halfBinsToAverage);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">if</span> (stopOffset  &gt;  halfBinsToAverage) runningSum += *(inputItr + halfBinsToAverage);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        *outputVecItr++ = runningSum / float(count);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">//---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"><a class="line" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa28e088e6a76fd2c2d31c912cf12ed38"> 1797</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa28e088e6a76fd2c2d31c912cf12ed38">hit::DPRawHitFinder::reBin</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec,</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                               std::vector&lt;float&gt;&amp;       outputVec,</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                               <span class="keywordtype">size_t</span>                    nBinsToCombine)<span class="keyword"> const</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordtype">size_t</span> nNewBins = inputVec.size() / nBinsToCombine;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">if</span> (inputVec.size() % nBinsToCombine &gt; 0) nNewBins++;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    outputVec.resize(nNewBins, 0.);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordtype">size_t</span> outputBin = 0;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> inputIdx = 0; inputIdx &lt; inputVec.size();)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        outputVec[outputBin] += inputVec[inputIdx++];</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">if</span> (inputIdx % nBinsToCombine == 0) outputBin++;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordflow">if</span> (outputBin &gt; outputVec.size())</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;***** DISASTER!!! ****** outputBin: &quot;</span> &lt;&lt; outputBin &lt;&lt; <span class="stringliteral">&quot;, inputIdx = &quot;</span> &lt;&lt; inputIdx &lt;&lt; std::endl;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    }</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;}</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  DEFINE_ART_MODULE(<a class="code" href="../../d3/d47/classhit_1_1DPRawHitFinder.html">DPRawHitFinder</a>)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;} <span class="comment">// end of hit namespace</span></div>
<div class="ttc" id="classanab_1_1FVectorWriter_html"><div class="ttname"><a href="../../d2/dd8/classanab_1_1FVectorWriter.html">anab::FVectorWriter&lt; 4 &gt;</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a468ecd6be11ffe4ca3cf9046d26a6d49"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a468ecd6be11ffe4ca3cf9046d26a6d49">hit::DPRawHitFinder::findCandidatePeaks</a></div><div class="ttdeci">void findCandidatePeaks(std::vector&lt; float &gt;::const_iterator startItr, std::vector&lt; float &gt;::const_iterator stopItr, TimeValsVec &amp;timeValsVec, float &amp;PeakMin, int firstTick) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00981">DPRawHitFinder_module.cc:981</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ab583ed95bc6872700646fa87aa2d332b"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab583ed95bc6872700646fa87aa2d332b">hit::DPRawHitFinder::fMinTau</a></div><div class="ttdeci">double fMinTau</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00183">DPRawHitFinder_module.cc:183</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a4d036906801d9bb13f0e2eb3b60a192e"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4d036906801d9bb13f0e2eb3b60a192e">hit::DPRawHitFinder::fLongPulseWidth</a></div><div class="ttdeci">int fLongPulseWidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00197">DPRawHitFinder_module.cc:197</a></div></div>
<div class="ttc" id="detectorproperties__icarus_8fcl_html_acfd440223f806c44323dbd1053b99123"><div class="ttname"><a href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a></div><div class="ttdeci">second</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d33/detectorproperties__icarus_8fcl_source.html#l00008">detectorproperties_icarus.fcl:8</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a19732896d59692ed0ab0cb2e5b156a12"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a19732896d59692ed0ab0cb2e5b156a12">hit::DPRawHitFinder::fTicksToStopPeakFinder</a></div><div class="ttdeci">int fTicksToStopPeakFinder</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00170">DPRawHitFinder_module.cc:170</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_abd4bfc88d5c136b4ab0dd697414a58e3"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#abd4bfc88d5c136b4ab0dd697414a58e3">hit::DPRawHitFinder::fMaxGroupLength</a></div><div class="ttdeci">int fMaxGroupLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00175">DPRawHitFinder_module.cc:175</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a9143a0ae276ad6f3e7c2ca2c4015147a"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9143a0ae276ad6f3e7c2ca2c4015147a">hit::DPRawHitFinder::fMergeADCSumThreshold</a></div><div class="ttdeci">double fMergeADCSumThreshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00190">DPRawHitFinder_module.cc:190</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a0ced81e2b981d92aa26c4c19b0d3bbce"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0ced81e2b981d92aa26c4c19b0d3bbce">hit::DPRawHitFinder::mergeCandidatePeaks</a></div><div class="ttdeci">void mergeCandidatePeaks(const std::vector&lt; float &gt; signalVec, TimeValsVec, MergedTimeWidVec &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01061">DPRawHitFinder_module.cc:1061</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="structhit_1_1DPRawHitFinder_1_1Comp_html_aad1ffc6a779a1143a1d53bd543bd9e63"><div class="ttname"><a href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#aad1ffc6a779a1143a1d53bd543bd9e63">hit::DPRawHitFinder::Comp::operator()</a></div><div class="ttdeci">bool operator()(std::tuple&lt; int, int, int, int &gt; p, int s) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00159">DPRawHitFinder_module.cc:159</a></div></div>
<div class="ttc" id="namespacehit_html_a266919e10bc2e7291df21e01605d4042"><div class="ttname"><a href="../../dc/d43/namespacehit.html#a266919e10bc2e7291df21e01605d4042">hit::fMaxMultiHit</a></div><div class="ttdeci">fMaxMultiHit(pset.get&lt; int &gt;(&quot;MaxMultiHit&quot;))</div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_aa4456ffbbaf8e4c2cb9d9a0a408dfc10"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4456ffbbaf8e4c2cb9d9a0a408dfc10">hit::DPRawHitFinder::MergedTimeWidVec</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; int, int, PeakTimeWidVec, int &gt;&gt; MergedTimeWidVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00082">DPRawHitFinder_module.cc:82</a></div></div>
<div class="ttc" id="RawTypes_8h_html"><div class="ttname"><a href="../../d9/d38/RawTypes_8h.html">RawTypes.h</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ade2cf0283396a7392ceb31412dae00f3"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ade2cf0283396a7392ceb31412dae00f3">hit::DPRawHitFinder::produce</a></div><div class="ttdeci">void produce(art::Event &amp;evt) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00298">DPRawHitFinder_module.cc:298</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ae873bae18638eea8b66a26fe11e4e579"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae873bae18638eea8b66a26fe11e4e579">hit::DPRawHitFinder::FindPeakWithMaxDeviation</a></div><div class="ttdeci">void FindPeakWithMaxDeviation(const std::vector&lt; float &gt; fSignalVector, int fNPeaks, int fStartTime, int fEndTime, bool fSameShape, ParameterVec fparamVec, PeakTimeWidVec fpeakVals, PeakDevVec &amp;fPeakDev)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01437">DPRawHitFinder_module.cc:1437</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ac9477ba0777994afe86517a16056a222"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac9477ba0777994afe86517a16056a222">hit::DPRawHitFinder::PeakDevVec</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; double, int, int, int &gt;&gt; PeakDevVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00083">DPRawHitFinder_module.cc:83</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a5de73e8a267d20adb4ffa956e32a4759"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5de73e8a267d20adb4ffa956e32a4759">hit::DPRawHitFinder::fMaxTau</a></div><div class="ttdeci">double fMaxTau</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00184">DPRawHitFinder_module.cc:184</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ac596806a27037af14f3c8557c2fcd45d"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac596806a27037af14f3c8557c2fcd45d">hit::DPRawHitFinder::fMaxMultiHit</a></div><div class="ttdeci">int fMaxMultiHit</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00174">DPRawHitFinder_module.cc:174</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classlar_1_1sparse__vector_html_a8d9b2860eee2156fe59ba0ce4f0f1393"><div class="ttname"><a href="../../d4/da5/classlar_1_1sparse__vector.html#a8d9b2860eee2156fe59ba0ce4f0f1393">lar::sparse_vector::get_ranges</a></div><div class="ttdeci">const range_list_t &amp; get_ranges() const </div><div class="ttdoc">Returns the internal list of non-void ranges. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5b/sparse__vector_8h_source.html#l00717">sparse_vector.h:717</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a1a8ee444ca1b6eb8b33e8e20a81e6b55"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a1a8ee444ca1b6eb8b33e8e20a81e6b55">hit::DPRawHitFinder::fDoMergePeaks</a></div><div class="ttdeci">bool fDoMergePeaks</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00189">DPRawHitFinder_module.cc:189</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ac303d2971eb9697f3a65821bb92bb934"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">geo::WireID::Wire</a></div><div class="ttdeci">WireID_t Wire</div><div class="ttdoc">Index of the wire within its plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00580">geo_types.h:580</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_aa4bf23aeec5444af9dee14f7a4fe77b0"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa4bf23aeec5444af9dee14f7a4fe77b0">hit::DPRawHitFinder::fMaxFluctuations</a></div><div class="ttdeci">int fMaxFluctuations</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00198">DPRawHitFinder_module.cc:198</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a778b9327eb86c26e33431043368da90d"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a778b9327eb86c26e33431043368da90d">hit::DPRawHitFinder::fMinADCSum</a></div><div class="ttdeci">double fMinADCSum</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00172">DPRawHitFinder_module.cc:172</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a2f50fcd21558bcabe16aee0a9b29a0b9"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a2f50fcd21558bcabe16aee0a9b29a0b9">hit::DPRawHitFinder::SplitPeak</a></div><div class="ttdeci">void SplitPeak(std::tuple&lt; double, int, int, int &gt; fPeakDevCand, PeakTimeWidVec &amp;fpeakValsTemp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01609">DPRawHitFinder_module.cc:1609</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a10ab9b354477564574b3f09b485a1070"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a10ab9b354477564574b3f09b485a1070">hit::DPRawHitFinder::fChi2NDFMaxFactorMultiHits</a></div><div class="ttdeci">double fChi2NDFMaxFactorMultiHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00181">DPRawHitFinder_module.cc:181</a></div></div>
<div class="ttc" id="classrecob_1_1HitAndAssociationsWriterBase_html_adbc6a4d07ee8f3c4ebffc5e29436e351"><div class="ttname"><a href="../../de/dfe/classrecob_1_1HitAndAssociationsWriterBase.html#adbc6a4d07ee8f3c4ebffc5e29436e351">recob::HitAndAssociationsWriterBase::declare_products</a></div><div class="ttdeci">static void declare_products(art::ProducesCollector &amp;collector, std::string instance_name=&quot;&quot;, bool doWireAssns=true, bool doRawDigitAssns=true)</div><div class="ttdoc">Declares the hit products we are going to fill. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d4a/HitCreator_8cxx_source.html#l00248">HitCreator.cxx:248</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a7538d2c67a7bdd574480728346000749"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7538d2c67a7bdd574480728346000749">hit::DPRawHitFinder::DPRawHitFinder</a></div><div class="ttdeci">DPRawHitFinder(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00211">DPRawHitFinder_module.cc:211</a></div></div>
<div class="ttc" id="classanab_1_1FVectorWriter_html_ae8914650df7d2fbfa772f3f31e8090b6"><div class="ttname"><a href="../../d2/dd8/classanab_1_1FVectorWriter.html#ae8914650df7d2fbfa772f3f31e8090b6">anab::FVectorWriter::addVector</a></div><div class="ttdeci">void addVector(FVector_ID id, std::array&lt; float, N &gt; const &amp;values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da6/MVAWriter_8h_source.html#l00078">MVAWriter.h:78</a></div></div>
<div class="ttc" id="namespaceraw_html_abcbf8ba50ca9efdbeb1a6955b040b4fe"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abcbf8ba50ca9efdbeb1a6955b040b4fe">raw::TDCtick_t</a></div><div class="ttdeci">int TDCtick_t</div><div class="ttdoc">Type representing a TDC tick. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00025">RawTypes.h:25</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ad8a95ac33178d269256325a1ef0bceb8"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad8a95ac33178d269256325a1ef0bceb8">hit::DPRawHitFinder::PeakTimeWidVec</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; int, int, int, int &gt;&gt; PeakTimeWidVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00081">DPRawHitFinder_module.cc:81</a></div></div>
<div class="ttc" id="classrecob_1_1HitCreator_html"><div class="ttname"><a href="../../d1/de4/classrecob_1_1HitCreator.html">recob::HitCreator</a></div><div class="ttdoc">Class managing the creation of a new recob::Hit object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8b/HitCreator_8h_source.html#l00083">HitCreator.h:83</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a5616181f56c661d7bea7a843b1fa14ba"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5616181f56c661d7bea7a843b1fa14ba">hit::DPRawHitFinder::FillOutHitParameterVector</a></div><div class="ttdeci">void FillOutHitParameterVector(const std::vector&lt; double &gt; &amp;input, std::vector&lt; double &gt; &amp;output)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00265">DPRawHitFinder_module.cc:265</a></div></div>
<div class="ttc" id="HitCreator_8h_html"><div class="ttname"><a href="../../d7/d8b/HitCreator_8h.html">HitCreator.h</a></div><div class="ttdoc">Helper functions to create a hit. </div></div>
<div class="ttc" id="classanab_1_1FVectorWriter_html_a4f5f51963c0a635249f98e97f38da62f"><div class="ttname"><a href="../../d2/dd8/classanab_1_1FVectorWriter.html#a4f5f51963c0a635249f98e97f38da62f">anab::FVectorWriter::initOutputs</a></div><div class="ttdeci">FVector_ID initOutputs(std::string const &amp;dataTag, size_t dataSize, std::vector&lt; std::string &gt; const &amp;names=std::vector&lt; std::string &gt;(N,&quot;&quot;))</div></div>
<div class="ttc" id="namespaceraw_html_ac59223371efaecdc5ef8389bc976a20a"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#ac59223371efaecdc5ef8389bc976a20a">raw::InvalidChannelID</a></div><div class="ttdeci">constexpr ChannelID_t InvalidChannelID</div><div class="ttdoc">ID of an invalid channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00032">RawTypes.h:32</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ad1961c2589248e97da206b2c3cf7184d"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad1961c2589248e97da206b2c3cf7184d">hit::DPRawHitFinder::AddPeak</a></div><div class="ttdeci">void AddPeak(std::tuple&lt; double, int, int, int &gt; fPeakDevCand, PeakTimeWidVec &amp;fpeakValsTemp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01565">DPRawHitFinder_module.cc:1565</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a05328850b7bee78dc15ccc110df30f47"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a05328850b7bee78dc15ccc110df30f47">hit::DPRawHitFinder::fChi2NDFRetryFactorMultiHits</a></div><div class="ttdeci">double fChi2NDFRetryFactorMultiHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00179">DPRawHitFinder_module.cc:179</a></div></div>
<div class="ttc" id="classrecob_1_1HitCollectionCreator_html"><div class="ttname"><a href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html">recob::HitCollectionCreator</a></div><div class="ttdoc">A class handling a collection of hits and its associations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8b/HitCreator_8h_source.html#l00508">HitCreator.h:508</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a0dc30a5c3e2686b23da073a5768af760"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0dc30a5c3e2686b23da073a5768af760">hit::DPRawHitFinder::ParameterVec</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; double, double &gt;&gt; ParameterVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00084">DPRawHitFinder_module.cc:84</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a466142ee47ba57525e9ff8827b431c07"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a466142ee47ba57525e9ff8827b431c07">hit::DPRawHitFinder::fMergeMaxADCThreshold</a></div><div class="ttdeci">double fMergeMaxADCThreshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00191">DPRawHitFinder_module.cc:191</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a61dc4b18a37cecd8f11992382316cc48"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a61dc4b18a37cecd8f11992382316cc48">hit::DPRawHitFinder::fWidthNormalization</a></div><div class="ttdeci">double fWidthNormalization</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00195">DPRawHitFinder_module.cc:195</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a9346f54ef2f20880c7ac3127b93370a8"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9346f54ef2f20880c7ac3127b93370a8">hit::DPRawHitFinder::fMinWidth</a></div><div class="ttdeci">int fMinWidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00171">DPRawHitFinder_module.cc:171</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_aa6db5078f723fedb6315bf3243e009ae"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa6db5078f723fedb6315bf3243e009ae">hit::DPRawHitFinder::fHitParamWriter</a></div><div class="ttdeci">anab::FVectorWriter&lt; 4 &gt; fHitParamWriter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00201">DPRawHitFinder_module.cc:201</a></div></div>
<div class="ttc" id="structhit_1_1DPRawHitFinder_1_1Comp_html"><div class="ttname"><a href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html">hit::DPRawHitFinder::Comp</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00155">DPRawHitFinder_module.cc:155</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a43be9390f29e91942cf8a7125198b6e4"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43be9390f29e91942cf8a7125198b6e4">hit::DPRawHitFinder::CreateFitFunction</a></div><div class="ttdeci">std::string CreateFitFunction(int fNPeaks, bool fSameShape)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01501">DPRawHitFinder_module.cc:1501</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a397dd911804c668886ff9f6a8a38f227"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a397dd911804c668886ff9f6a8a38f227">hit::DPRawHitFinder::fGroupMinADC</a></div><div class="ttdeci">double fGroupMinADC</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00187">DPRawHitFinder_module.cc:187</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ad0326ec884de710bead2451c0e65c74c"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ad0326ec884de710bead2451c0e65c74c">hit::DPRawHitFinder::fNumBinsToAverage</a></div><div class="ttdeci">size_t fNumBinsToAverage</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00182">DPRawHitFinder_module.cc:182</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a1a08bc762b79d6e1d7816c34d3e36f78"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">util::quantities::tick</a></div><div class="ttdeci">tick_as&lt;&gt; tick</div><div class="ttdoc">Tick number, represented by std::ptrdiff_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00075">electronics.h:75</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ab543af91e06a2331421ac1bb0f570c70"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab543af91e06a2331421ac1bb0f570c70">hit::DPRawHitFinder::fGroupMaxDistance</a></div><div class="ttdeci">int fGroupMaxDistance</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00186">DPRawHitFinder_module.cc:186</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a8d85f16917e8be98cc7b32d84ea8bf70"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a8d85f16917e8be98cc7b32d84ea8bf70">hit::DPRawHitFinder::fChi2</a></div><div class="ttdeci">TH1F * fChi2</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00204">DPRawHitFinder_module.cc:204</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a67166b9396014ec57f53021a7af3f47c"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a67166b9396014ec57f53021a7af3f47c">hit::DPRawHitFinder::ChargeFunc</a></div><div class="ttdeci">double ChargeFunc(double fPeakMean, double fPeakAmp, double fPeakTau1, double fPeakTau2, double fChargeNormFactor, double fPeakMeanTrue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01728">DPRawHitFinder_module.cc:1728</a></div></div>
<div class="ttc" id="classrecob_1_1HitCollectionCreator_html_abe4bc553e92adfcae68adfdc0a635bca"><div class="ttname"><a href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html#abe4bc553e92adfcae68adfdc0a635bca">recob::HitCollectionCreator::emplace_back</a></div><div class="ttdeci">void emplace_back(recob::Hit &amp;&amp;hit, art::Ptr&lt; recob::Wire &gt; const &amp;wire=art::Ptr&lt; recob::Wire &gt;(), art::Ptr&lt; raw::RawDigit &gt; const &amp;digits=art::Ptr&lt; raw::RawDigit &gt;())</div><div class="ttdoc">Adds the specified hit to the data collection. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d4a/HitCreator_8cxx_source.html#l00290">HitCreator.cxx:290</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a43eaf6e47b694503abf7ebf908d82823"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a43eaf6e47b694503abf7ebf908d82823">hit::DPRawHitFinder::fMinADCSumOverWidth</a></div><div class="ttdeci">double fMinADCSumOverWidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00173">DPRawHitFinder_module.cc:173</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ab2169e8927cd7c4dadbbca67a9b81cf2"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ab2169e8927cd7c4dadbbca67a9b81cf2">hit::DPRawHitFinder::fMinRelativePeakHeightLeft</a></div><div class="ttdeci">double fMinRelativePeakHeightLeft</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00192">DPRawHitFinder_module.cc:192</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a91754d685ea255e50dc58143a802a242"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a91754d685ea255e50dc58143a802a242">hit::DPRawHitFinder::beginJob</a></div><div class="ttdeci">void beginJob() override</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00286">DPRawHitFinder_module.cc:286</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ae8d63f8a7469ad8b4f48dd74f7223e67"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae8d63f8a7469ad8b4f48dd74f7223e67">hit::DPRawHitFinder::fLongMaxHits</a></div><div class="ttdeci">int fLongMaxHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00196">DPRawHitFinder_module.cc:196</a></div></div>
<div class="ttc" id="classrecob_1_1HitCollectionCreator_html_a997b6e6c44c6f187351703ed6683c0e6"><div class="ttname"><a href="../../d4/dd2/classrecob_1_1HitCollectionCreator.html#a997b6e6c44c6f187351703ed6683c0e6">recob::HitCollectionCreator::put_into</a></div><div class="ttdeci">void put_into(art::Event &amp;)</div><div class="ttdoc">Moves the data into an event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8b/HitCreator_8h_source.html#l00652">HitCreator.h:652</a></div></div>
<div class="ttc" id="classanab_1_1FVectorWriter_html_aa5b3eef17c9848e5cfc2c018598ece1e"><div class="ttname"><a href="../../d2/dd8/classanab_1_1FVectorWriter.html#aa5b3eef17c9848e5cfc2c018598ece1e">anab::FVectorWriter::saveOutputs</a></div><div class="ttdeci">void saveOutputs(art::Event &amp;evt)</div><div class="ttdoc">Check consistency and save all the results in the event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da6/MVAWriter_8h_source.html#l00325">MVAWriter.h:325</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_aad301d82d0b33bc79a61289e772774ef"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aad301d82d0b33bc79a61289e772774ef">hit::DPRawHitFinder::fFitPeakMeanRange</a></div><div class="ttdeci">double fFitPeakMeanRange</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00185">DPRawHitFinder_module.cc:185</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a57d52200f742d83db02d8e0e51b9ab84"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57d52200f742d83db02d8e0e51b9ab84">hit::DPRawHitFinder::fChi2NDFRetry</a></div><div class="ttdeci">double fChi2NDFRetry</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00178">DPRawHitFinder_module.cc:178</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a5f4e8ee3a763004037cace9b1aea20ed"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a5f4e8ee3a763004037cace9b1aea20ed">hit::DPRawHitFinder::FitExponentials</a></div><div class="ttdeci">void FitExponentials(const std::vector&lt; float &gt; fSignalVector, const PeakTimeWidVec fPeakVals, int fStartTime, int fEndTime, ParameterVec &amp;fparamVec, double &amp;fchi2PerNDF, int &amp;fNDF, bool fSameShape)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01224">DPRawHitFinder_module.cc:1224</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a877eb5476415cb380c85070aff311c2c"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a877eb5476415cb380c85070aff311c2c">hit::DPRawHitFinder::fCalDataModuleLabel</a></div><div class="ttdeci">std::string fCalDataModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00165">DPRawHitFinder_module.cc:165</a></div></div>
<div class="ttc" id="classlar_1_1sparse__vector_html"><div class="ttname"><a href="../../d4/da5/classlar_1_1sparse__vector.html">lar::sparse_vector&lt; float &gt;</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a4b69d452413aca4b5a1d50ea72785dee"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a4b69d452413aca4b5a1d50ea72785dee">hit::DPRawHitFinder::fSameShape</a></div><div class="ttdeci">bool fSameShape</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00188">DPRawHitFinder_module.cc:188</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a57a369b18eca2c51665388cf6e2a4f63"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a57a369b18eca2c51665388cf6e2a4f63">hit::DPRawHitFinder::TimeValsVec</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; int, int, int &gt;&gt; TimeValsVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00080">DPRawHitFinder_module.cc:80</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="triggersim__eastmodule__icarus_8fcl_html_a6e6fc5a1833d744f7bd6bde59dd95323"><div class="ttname"><a href="../../dd/db4/triggersim__eastmodule__icarus_8fcl.html#a6e6fc5a1833d744f7bd6bde59dd95323">output</a></div><div class="ttdeci">BEGIN_PROLOG sequence::SlidingWindowTriggerPatternsOppositeWindows END_PROLOG simSlidingORM6O6 effSlidingORW output</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db4/triggersim__eastmodule__icarus_8fcl_source.html#l00134">triggersim_eastmodule_icarus.fcl:134</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html">hit::DPRawHitFinder</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00069">DPRawHitFinder_module.cc:69</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a9ad50f1fb0633c982ccab25b7967ad80"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a9ad50f1fb0633c982ccab25b7967ad80">hit::DPRawHitFinder::fChargeNorm</a></div><div class="ttdeci">double fChargeNorm</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00176">DPRawHitFinder_module.cc:176</a></div></div>
<div class="ttc" id="Wire_8h_html"><div class="ttname"><a href="../../da/d9f/Wire_8h.html">Wire.h</a></div><div class="ttdoc">Declaration of basic channel signal object. </div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ac4a2e230f393678103d444e9dc423064"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ac4a2e230f393678103d444e9dc423064">hit::DPRawHitFinder::EstimateFluctuations</a></div><div class="ttdeci">int EstimateFluctuations(const std::vector&lt; float &gt; fsignalVec, int peakStart, int peakMean, int peakEnd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01191">DPRawHitFinder_module.cc:1191</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a7151083b24e8ea8d2717dd6558dabe9f"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7151083b24e8ea8d2717dd6558dabe9f">hit::DPRawHitFinder::fLogLevel</a></div><div class="ttdeci">int fLogLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00168">DPRawHitFinder_module.cc:168</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a6ed967faf8a3c616d1ade488dea51f00"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a6ed967faf8a3c616d1ade488dea51f00">hit::DPRawHitFinder::doBinAverage</a></div><div class="ttdeci">void doBinAverage(const std::vector&lt; float &gt; &amp;inputVec, std::vector&lt; float &gt; &amp;outputVec, size_t binsToAverage) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01767">DPRawHitFinder_module.cc:1767</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00253">NuVertexChargeTree_module.cc:253</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00007">DataStructs.cxx:7</a></div></div>
<div class="ttc" id="IntegerRanges__test_8cc_html_abbc7e5f346bfa932ca51b4b07ccef76d"><div class="ttname"><a href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a></div><div class="ttdeci">std::size_t count(Cont const &amp;cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df5/IntegerRanges__test_8cc_source.html#l00029">IntegerRanges_test.cc:29</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a270a8b6ae71bc6f4140ed016d475d343"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a270a8b6ae71bc6f4140ed016d475d343">hit::DPRawHitFinder::fMergeMaxADCLimit</a></div><div class="ttdeci">double fMergeMaxADCLimit</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00194">DPRawHitFinder_module.cc:194</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a0db71aafdb547f5e4ebace449f969bd1"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a0db71aafdb547f5e4ebace449f969bd1">hit::DPRawHitFinder::fTryNplus1Fits</a></div><div class="ttdeci">bool fTryNplus1Fits</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00177">DPRawHitFinder_module.cc:177</a></div></div>
<div class="ttc" id="classrecob_1_1HitCreator_html_acfb09016a1ec64e60f9103142c1a5f95"><div class="ttname"><a href="../../d1/de4/classrecob_1_1HitCreator.html#acfb09016a1ec64e60f9103142c1a5f95">recob::HitCreator::move</a></div><div class="ttdeci">recob::Hit &amp;&amp; move()</div><div class="ttdoc">Prepares the constructed hit to be moved away. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8b/HitCreator_8h_source.html#l00343">HitCreator.h:343</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_acc1d547db107f49dd70e65d12c0ecef1"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#acc1d547db107f49dd70e65d12c0ecef1">hit::DPRawHitFinder::fNewHitsTag</a></div><div class="ttdeci">art::InputTag fNewHitsTag</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00200">DPRawHitFinder_module.cc:200</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_afc8947a752ff69b717f32ba4f349842f"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#afc8947a752ff69b717f32ba4f349842f">hit::DPRawHitFinder::WidthFunc</a></div><div class="ttdeci">double WidthFunc(double fPeakMean, double fPeakAmp, double fPeakTau1, double fPeakTau2, double fStartTime, double fEndTime, double fPeakMeanTrue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01647">DPRawHitFinder_module.cc:1647</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_aa28e088e6a76fd2c2d31c912cf12ed38"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#aa28e088e6a76fd2c2d31c912cf12ed38">hit::DPRawHitFinder::reBin</a></div><div class="ttdeci">void reBin(const std::vector&lt; float &gt; &amp;inputVec, std::vector&lt; float &gt; &amp;outputVec, size_t nBinsToCombine) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l01797">DPRawHitFinder_module.cc:1797</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a7f809a0763ce7ed17a66902ba383fdc5"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a7f809a0763ce7ed17a66902ba383fdc5">hit::DPRawHitFinder::fMinSig</a></div><div class="ttdeci">float fMinSig</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00169">DPRawHitFinder_module.cc:169</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_a3ef285126b24946d4d2d1a3a7b4e0aec"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#a3ef285126b24946d4d2d1a3a7b4e0aec">hit::DPRawHitFinder::fMinRelativePeakHeightRight</a></div><div class="ttdeci">double fMinRelativePeakHeightRight</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00193">DPRawHitFinder_module.cc:193</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_ae937aed028098222ab19af6b389d712a"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#ae937aed028098222ab19af6b389d712a">hit::DPRawHitFinder::fChi2NDFMax</a></div><div class="ttdeci">double fChi2NDFMax</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00180">DPRawHitFinder_module.cc:180</a></div></div>
<div class="ttc" id="MVAWriter_8h_html"><div class="ttname"><a href="../../d7/da6/MVAWriter_8h.html">MVAWriter.h</a></div></div>
<div class="ttc" id="classhit_1_1DPRawHitFinder_html_af4286aaa162b37e9ed91b03cdeb430d8"><div class="ttname"><a href="../../d3/d47/classhit_1_1DPRawHitFinder.html#af4286aaa162b37e9ed91b03cdeb430d8">hit::DPRawHitFinder::fFirstChi2</a></div><div class="ttdeci">TH1F * fFirstChi2</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00203">DPRawHitFinder_module.cc:203</a></div></div>
<div class="ttc" id="structhit_1_1DPRawHitFinder_1_1Comp_html_add9ca4cd49ed9c6828f7ebf420906072"><div class="ttname"><a href="../../d8/d37/structhit_1_1DPRawHitFinder_1_1Comp.html#add9ca4cd49ed9c6828f7ebf420906072">hit::DPRawHitFinder::Comp::operator()</a></div><div class="ttdeci">bool operator()(int s, std::tuple&lt; int, int, int, int &gt; p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d81/DPRawHitFinder__module_8cc_source.html#l00161">DPRawHitFinder_module.cc:161</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
