<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>DigiPMTSBNDAlg.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_e0f1515b72b556ea1a60650362b3fd43.html">sbndcode</a></li><li class="navelem"><a class="el" href="../../dir_c704eecb2dcddc67a44d0dda177b30ed.html">sbndcode</a></li><li class="navelem"><a class="el" href="../../dir_e27c91c13c05d45ca40fe73091117d2c.html">OpDetSim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DigiPMTSBNDAlg.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d6/d08/DigiPMTSBNDAlg_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/ddf/DigiPMTSBNDAlg_8hh.html">sbndcode/OpDetSim/DigiPMTSBNDAlg.hh</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//--- opdet::simpmtsbndAlg implementation</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">namespace </span>opdet {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aef8717165572fa46a280e8add93d4e">   10</a></span>&#160;  <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aef8717165572fa46a280e8add93d4e">DigiPMTSBNDAlg::DigiPMTSBNDAlg</a>(<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html">ConfigurationParameters_t</a> <span class="keyword">const</span>&amp; config)</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    : fParams(config)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    , fSampling(fParams.frequency)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    , fQEDirect(fParams.QEDirect / fParams.larProp-&gt;<a class="code" href="../../dc/db0/icarus__prodsingle__fastoptical_8fcl.html#adb6173ebd1f7c5a253fa43973b87634b">ScintPreScale</a>())</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    , fQERefl(fParams.QERefl / fParams.larProp-&gt;<a class="code" href="../../dc/db0/icarus__prodsingle__fastoptical_8fcl.html#adb6173ebd1f7c5a253fa43973b87634b">ScintPreScale</a>())</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="comment">//  , fSinglePEmodel(fParams.SinglePEmodel)</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    , <a class="code" href="../../d4/d4d/namespaceevgen.html#ac64ce9233583b081586d153cc2f2056b">fEngine</a>(fParams.engine)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;PMT corrected efficiencies = &quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                  &lt;&lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1ecd845781dec99e48b4796b9afedb80">fQEDirect</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">fQERefl</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">if</span>(fQERefl &gt; 1.0001 || <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1ecd845781dec99e48b4796b9afedb80">fQEDirect</a> &gt; 1.0001)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Quantum efficiency set in fhicl file &quot;</span> &lt;&lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a7c3fd539ae210ac7c93baa0773216d7e">QERefl</a></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ad0d2b05c6fe07ad329eae871425ac83c">QEDirect</a> &lt;&lt; <span class="stringliteral">&quot; seems to be too large!\n&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Final QE must be equal or smaller than the scintillation &quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;pre scale applied at simulation time.\n&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Please check this number (ScintPreScale): &quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        &lt;&lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a4b219e0b27fc96198ce8a9b1f27d42ff">larProp</a>-&gt;<a class="code" href="../../dc/d37/classdetinfo_1_1LArProperties.html#a769f632bb0d68ed3bec2ee18e9e8a2a8">ScintPreScale</a>();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a> = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a> / 1000.0; <span class="comment">//in GHz, to cancel with ns</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    std::string <a class="code" href="../../d2/d0d/namespacedemo.html#a5cd789a25b595576a719efcae81f17b3">fname</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    cet::search_path sp(<span class="stringliteral">&quot;FW_SEARCH_PATH&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    sp.find_file(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a0e6104aa112147e0bb4d9dd40ef9b9c8">PMTDataFile</a>, fname);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    TFile* <a class="code" href="../../d0/dea/file__to__url_8sh.html#a79854d43ae87cec96a59d17fc4141bf0">file</a> = TFile::Open(fname.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// TPB emission time histogram for pmt_coated histogram</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    std::vector&lt;double&gt;* timeTPB_p;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    file-&gt;GetObject(<span class="stringliteral">&quot;timeTPB&quot;</span>, timeTPB_p);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a> = std::make_unique&lt;CLHEP::RandGeneral&gt;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      (*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, timeTPB_p-&gt;data(), timeTPB_p-&gt;size());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//shape of single pulse</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a9013dfe5427f96cccce9fa9c4282e3e8">PMTSinglePEmodel</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; using testbench pe response&quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      std::vector&lt;double&gt;* SinglePEVec_p;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      file-&gt;GetObject(<span class="stringliteral">&quot;SinglePEVec&quot;</span>, SinglePEVec_p);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a> = *SinglePEVec_p;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">pulsesize</a> = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a>.size();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; using ideal pe response&quot;</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">//shape of single pulse</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad2462528559eaaec56be6f775bff4de0">sigma1</a> = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a1670d7925f2126850c03b977823b1a3b">PMTRiseTime</a> / (std::sqrt(2.0) * (std::sqrt(-std::log(0.1)) - std::sqrt(-std::log(0.9))));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a2257b911b465722fdce0080c141412d1">sigma2</a> = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ae5e432a425423f82584a6fcab6acc2fb">PMTFallTime</a> / (std::sqrt(2.0) * (std::sqrt(-std::log(0.1)) - std::sqrt(-std::log(0.9))));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">pulsesize</a> = (int)((6 * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a2257b911b465722fdce0080c141412d1">sigma2</a> + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a8e17b0e642eb3195fb148d83260c5711">TransitTime</a>) * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a>.resize(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">pulsesize</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a4e51eb92004ef00802382754b60a017d">Pulse1PE</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac202530a5cfde623d564114216ad6261">MakeGainFluctuations</a>){</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab2a08b34a2006b986432fe30dc645bee">fPMTGainFluctuationsPtr</a> = art::make_tool&lt;opdet::PMTGainFluctuations&gt;(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afb8cd9a86f6a665835afddde13e3cf31">GainFluctuationsParams</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a7560269c725d2a894854cbf1fdb25fa2">saturation</a> = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">PMTBaseline</a> + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a7ae0f1830f826274c112fdfd23cca403">PMTSaturation</a> * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ad068922ecbc307c058f8afa09a728c98">PMTChargeToADC</a> * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a61da5dbeec1071fe56ccdd0f05f88f2e">PMTMeanAmplitude</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    file-&gt;Close();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  } <span class="comment">// end constructor</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a03fbcc7abc4ca2578a019b3f2e5d8702">   72</a></span>&#160;  <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a03fbcc7abc4ca2578a019b3f2e5d8702">DigiPMTSBNDAlg::~DigiPMTSBNDAlg</a>(){}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ac06e071f23a232a6fb59d3408fab44df">   75</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ac06e071f23a232a6fb59d3408fab44df">DigiPMTSBNDAlg::ConstructWaveform</a>(</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a> <span class="keyword">const</span>&amp; simphotons,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    std::vector&lt;short unsigned int&gt;&amp; waveform,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    std::string pdtype,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a1f8c2c7c3785cd2c9d93d6381e3c7d1c">start_time</a>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">unsigned</span> n_sample)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    std::vector&lt;double&gt; waves(n_sample, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">PMTBaseline</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1aa7d358ef53ba6957af0e61a8b286a2">CreatePDWaveform</a>(simphotons, start_time, waves, ch, pdtype);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    waveform = std::vector&lt;short unsigned int&gt; (waves.begin(), waves.end());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6667b4a366e6d2719adc275894b10c6b">   88</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6667b4a366e6d2719adc275894b10c6b">DigiPMTSBNDAlg::ConstructWaveformCoatedPMT</a>(</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    std::vector&lt;short unsigned int&gt;&amp; waveform,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    std::unordered_map&lt;int, sim::SimPhotons&gt;&amp; DirectPhotonsMap,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    std::unordered_map&lt;int, sim::SimPhotons&gt;&amp; ReflectedPhotonsMap,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a1f8c2c7c3785cd2c9d93d6381e3c7d1c">start_time</a>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">unsigned</span> n_sample)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    std::vector&lt;double&gt; waves(n_sample, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">PMTBaseline</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3810371ff4099ca2bfaa3cf211446155">CreatePDWaveformCoatedPMT</a>(ch, start_time, waves, DirectPhotonsMap, ReflectedPhotonsMap);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    waveform = std::vector&lt;short unsigned int&gt; (waves.begin(), waves.end());</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aeee5382f39f86585e7bf391bb469c2">  102</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aeee5382f39f86585e7bf391bb469c2">DigiPMTSBNDAlg::ConstructWaveformLite</a>(</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html">sim::SimPhotonsLite</a> <span class="keyword">const</span>&amp; litesimphotons,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    std::vector&lt;short unsigned int&gt;&amp; waveform,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    std::string pdtype,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a1f8c2c7c3785cd2c9d93d6381e3c7d1c">start_time</a>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">unsigned</span> n_sample)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    std::vector&lt;double&gt; waves(n_sample, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">PMTBaseline</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3de67fad7681a1d7afbaa3e69201c9da">CreatePDWaveformLite</a>(litesimphotons, start_time, waves, ch, pdtype);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    waveform = std::vector&lt;short unsigned int&gt; (waves.begin(), waves.end());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a294027d499c1cc29fad20ac36108c59c">  116</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a294027d499c1cc29fad20ac36108c59c">DigiPMTSBNDAlg::ConstructWaveformLiteCoatedPMT</a>(</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    std::vector&lt;short unsigned int&gt;&amp; waveform,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    std::unordered_map&lt;int, sim::SimPhotonsLite&gt;&amp; DirectPhotonsMap,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    std::unordered_map&lt;int, sim::SimPhotonsLite&gt;&amp; ReflectedPhotonsMap,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a1f8c2c7c3785cd2c9d93d6381e3c7d1c">start_time</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">unsigned</span> n_sample)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    std::vector&lt;double&gt; waves(n_sample, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">PMTBaseline</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab7f0983e236ba02eb29602be82109a95">CreatePDWaveformLiteCoatedPMT</a>(ch, start_time, waves, DirectPhotonsMap, ReflectedPhotonsMap);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    waveform = std::vector&lt;short unsigned int&gt; (waves.begin(), waves.end());</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1aa7d358ef53ba6957af0e61a8b286a2">  130</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1aa7d358ef53ba6957af0e61a8b286a2">DigiPMTSBNDAlg::CreatePDWaveform</a>(</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a> <span class="keyword">const</span>&amp; simphotons,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">double</span> t_min,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    std::vector&lt;double&gt;&amp; wave,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    std::string pdtype)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">double</span> ttsTime = 0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">double</span> tphoton;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">size_t</span> timeBin;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">double</span> ttpb=0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; simphotons.size(); i++) { <span class="comment">//simphotons is here reflected light. To be added for all PMTs</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span>(CLHEP::RandFlat::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, 1.0) &lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">fQERefl</a>) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        tphoton = ttsTime + simphotons[i].Time - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">PMTBaselineRMS</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">AddLineNoise</a>(wave);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">PMTDarkNoiseRate</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">AddDarkNoise</a>(wave);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">CreateSaturation</a>(wave);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3810371ff4099ca2bfaa3cf211446155">  158</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3810371ff4099ca2bfaa3cf211446155">DigiPMTSBNDAlg::CreatePDWaveformCoatedPMT</a>(</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">double</span> t_min,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    std::vector&lt;double&gt;&amp; wave,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::unordered_map&lt;int, sim::SimPhotons&gt;&amp; DirectPhotonsMap,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::unordered_map&lt;int, sim::SimPhotons&gt;&amp; ReflectedPhotonsMap)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">double</span> ttsTime = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">double</span> tphoton;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">size_t</span> timeBin;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">double</span> ttpb=0;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a> auxphotons;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">//direct light</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">auto</span> it{ DirectPhotonsMap.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(DirectPhotonsMap) )</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {auxphotons = it-&gt;second;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; auxphotons.size(); j++) { <span class="comment">//auxphotons is direct light</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">if</span>(CLHEP::RandFlat::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, 1.0) &lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1ecd845781dec99e48b4796b9afedb80">fQEDirect</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>); <span class="comment">//implementing transit time spread</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        tphoton = ttsTime + auxphotons[j].Time - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// reflected light</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">auto</span> it{ ReflectedPhotonsMap.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(ReflectedPhotonsMap) )</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    {auxphotons = it-&gt;second;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; auxphotons.size(); j++) { <span class="comment">//auxphotons is now reflected light</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span>(CLHEP::RandFlat::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, 1.0) &lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">fQERefl</a>) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>); <span class="comment">//implementing transit time spread</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        tphoton = ttsTime + auxphotons[j].Time - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//Adding noise and saturation</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">PMTBaselineRMS</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">AddLineNoise</a>(wave);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">PMTDarkNoiseRate</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">AddDarkNoise</a>(wave);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">CreateSaturation</a>(wave);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3de67fad7681a1d7afbaa3e69201c9da">  206</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3de67fad7681a1d7afbaa3e69201c9da">DigiPMTSBNDAlg::CreatePDWaveformLite</a>(</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html">sim::SimPhotonsLite</a> <span class="keyword">const</span>&amp; litesimphotons,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">double</span> t_min,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    std::vector&lt;double&gt;&amp; wave,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    std::string pdtype)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">double</span> mean_photons;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">size_t</span> accepted_photons;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">double</span> ttsTime = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">double</span> tphoton;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">size_t</span> timeBin;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">double</span> ttpb=0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// reflected light to be added to all PMTs</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    std::map&lt;int, int&gt; <span class="keyword">const</span>&amp; photonMap = litesimphotons.<a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html#a3b3f2c60661dc50217f2d4598a9d41c0">DetectedPhotons</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; reflectedPhotons : photonMap) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// TODO: check that this new approach of not using the last</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">// (1-accepted_photons) doesn&#39;t introduce some bias. ~icaza</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      mean_photons = reflectedPhotons.second*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">fQERefl</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      accepted_photons = CLHEP::RandPoissonQ::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, mean_photons);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; accepted_photons; i++) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        tphoton = ttsTime + reflectedPhotons.first - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">PMTBaselineRMS</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">AddLineNoise</a>(wave);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">PMTDarkNoiseRate</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">AddDarkNoise</a>(wave);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">CreateSaturation</a>(wave);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab7f0983e236ba02eb29602be82109a95">  242</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab7f0983e236ba02eb29602be82109a95">DigiPMTSBNDAlg::CreatePDWaveformLiteCoatedPMT</a>(</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">double</span> t_min,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    std::vector&lt;double&gt;&amp; wave,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    std::unordered_map&lt;int, sim::SimPhotonsLite&gt;&amp; DirectPhotonsMap,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    std::unordered_map&lt;int, sim::SimPhotonsLite&gt;&amp; ReflectedPhotonsMap)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">double</span> mean_photons;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">size_t</span> accepted_photons;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">double</span> ttsTime = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">double</span> tphoton;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">size_t</span> timeBin;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">double</span> ttpb;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// direct light</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">auto</span> it{ DirectPhotonsMap.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(DirectPhotonsMap) ){</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; directPhotons : (it-&gt;second).DetectedPhotons) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// TODO: check that this new approach of not using the last</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// (1-accepted_photons) doesn&#39;t introduce some bias. ~icaza</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        mean_photons = directPhotons.second*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1ecd845781dec99e48b4796b9afedb80">fQEDirect</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        accepted_photons = CLHEP::RandPoissonQ::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, mean_photons);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; accepted_photons; i++) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>); <span class="comment">//implementing transit time spread</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          tphoton = ttsTime + directPhotons.first - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// reflected light</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">auto</span> it{ ReflectedPhotonsMap.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(ReflectedPhotonsMap) ){</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; reflectedPhotons : (it-&gt;second).DetectedPhotons) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// TODO: check that this new approach of not using the last</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// (1-accepted_photons) doesn&#39;t introduce some bias. ~icaza</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        mean_photons = reflectedPhotons.second*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">fQERefl</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        accepted_photons = CLHEP::RandPoissonQ::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, mean_photons);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; accepted_photons; i++) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a> &gt; 0.0) ttsTime = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">Transittimespread</a>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">TTS</a>); <span class="comment">//implementing transit time spread</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          ttpb = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">fTimeTPB</a>-&gt;fire(); <span class="comment">//for including TPB emission time</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          tphoton = ttsTime + reflectedPhotons.first - t_min + ttpb + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">CableTime</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <span class="keywordflow">if</span>(tphoton &lt; 0.) <span class="keywordflow">continue</span>; <span class="comment">// discard if it didn&#39;t made it to the acquisition</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          timeBin = std::floor(tphoton*<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">//Adding noise and saturation</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">PMTBaselineRMS</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">AddLineNoise</a>(wave);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">PMTDarkNoiseRate</a> &gt; 0.0) <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">AddDarkNoise</a>(wave);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">CreateSaturation</a>(wave);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a4e51eb92004ef00802382754b60a017d">  298</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a4e51eb92004ef00802382754b60a017d">DigiPMTSBNDAlg::Pulse1PE</a>(std::vector&lt;double&gt;&amp; fSinglePEWave)<span class="comment">//single pulse waveform</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">double</span> time;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">double</span> constT1 = <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ad068922ecbc307c058f8afa09a728c98">PMTChargeToADC</a> * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a61da5dbeec1071fe56ccdd0f05f88f2e">PMTMeanAmplitude</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">double</span> constT21 = 2.0 * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad2462528559eaaec56be6f775bff4de0">sigma1</a> * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad2462528559eaaec56be6f775bff4de0">sigma1</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">double</span> constT22 = 2.0 * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a2257b911b465722fdce0080c141412d1">sigma2</a> * <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a2257b911b465722fdce0080c141412d1">sigma2</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i&lt;fSinglePEWave.size(); i++) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      time = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(i) / <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">fSampling</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (time &lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a8e17b0e642eb3195fb148d83260c5711">TransitTime</a>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        fSinglePEWave[i] = constT1 * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1.0 * std::pow(time - <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a8e17b0e642eb3195fb148d83260c5711">TransitTime</a>, 2) / constT21);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        fSinglePEWave[i] = constT1 * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">std::exp</a>(-1.0 * std::pow(time - <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a8e17b0e642eb3195fb148d83260c5711">TransitTime</a>, 2) / constT22);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">  314</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">DigiPMTSBNDAlg::Transittimespread</a>(<span class="keywordtype">double</span> fwhm)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">double</span> tts, sigma;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    sigma = fwhm / <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a90f62eeb118cc169b1d3eb029dfab8a2">transitTimeSpread_frac</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    tts = CLHEP::RandGaussQ::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, 0, sigma);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> tts;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">  323</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">DigiPMTSBNDAlg::AddSPE</a>(<span class="keywordtype">size_t</span> time_bin, std::vector&lt;double&gt;&amp; wave)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a> = time_bin + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">pulsesize</a> &lt; wave.size() ? time_bin + <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">pulsesize</a> : wave.size();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">auto</span> min_it = std::next(wave.begin(), time_bin);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keyword">auto</span> max_it = std::next(wave.begin(), <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac202530a5cfde623d564114216ad6261">MakeGainFluctuations</a>){</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordtype">double</span> npe=<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab2a08b34a2006b986432fe30dc645bee">fPMTGainFluctuationsPtr</a>-&gt;GainFluctuation(1,<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(min_it, max_it,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                     <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a>.begin(), min_it,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                     [npe](<span class="keyword">auto</span> <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>, <span class="keyword">auto</span> b) { <span class="keywordflow">return</span> a+npe*b; });</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(min_it, max_it,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                   <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">fSinglePEWave</a>.begin(), min_it,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                   std::plus&lt;double&gt;( ));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">  342</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">DigiPMTSBNDAlg::CreateSaturation</a>(std::vector&lt;double&gt;&amp; wave)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::replace_if(wave.begin(), wave.end(),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    [&amp;](<span class="keyword">auto</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>){<span class="keywordflow">return</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> &lt; <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a7560269c725d2a894854cbf1fdb25fa2">saturation</a>;}, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a7560269c725d2a894854cbf1fdb25fa2">saturation</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">  349</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">DigiPMTSBNDAlg::AddLineNoise</a>(std::vector&lt;double&gt;&amp; wave)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// TODO: after running the profiler I can see that this is where</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// most cycles are being used.  Potentially some improvement could</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// be achieved with the below code but the array dynamic allocation</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// is not helping. The function would need to have it passed.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// ~icaza</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// double *array = new double[wave.size()]();</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// CLHEP::RandGaussQ::shootArray(fEngine, wave.size(), array, 0, fParams.PMTBaselineRMS);</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// for(size_t i = 0; i&lt;wave.size(); i++) {</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//   wave[i] += array[i];</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// delete array;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(wave.begin(), wave.end(), wave.begin(),</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                   [<span class="keyword">this</span>](<span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>) -&gt; <span class="keywordtype">double</span> {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                     <span class="keywordflow">return</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> + CLHEP::RandGaussQ::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, 0, <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">PMTBaselineRMS</a>) ; });</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">  370</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">DigiPMTSBNDAlg::AddDarkNoise</a>(std::vector&lt;double&gt;&amp; wave)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">size_t</span> timeBin;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Multiply by 10^9 since fParams.DarkNoiseRate is in Hz (conversion from s to ns)</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a> =  1000000000.0 / <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">fParams</a>.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">PMTDarkNoiseRate</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">double</span> darkNoiseTime = CLHEP::RandExponential::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, mean);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">while</span>(darkNoiseTime &lt; wave.size()) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      timeBin = std::round(darkNoiseTime);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">if</span>(timeBin &lt; wave.size()) {<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">AddSPE</a>(timeBin, wave);}</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// Find next time to add dark noise</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      darkNoiseTime += CLHEP::RandExponential::shoot(<a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">fEngine</a>, mean);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// TODO: this function is not being used anywhere! ~icaza</span></div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a983ca6b16027147dba9fd475a0c54d25">  386</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a983ca6b16027147dba9fd475a0c54d25">DigiPMTSBNDAlg::FindMinimumTime</a>(</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a> <span class="keyword">const</span>&amp; simphotons,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    std::string pdtype,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    std::unordered_map&lt;int, sim::SimPhotons&gt;&amp; directPhotonsOnPMTS)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">double</span> t_min = 1e15;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span>(pdtype == <span class="stringliteral">&quot;pmt_uncoated&quot;</span>) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">// TODO: use std::algorithm.  ~icaza</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; simphotons.size(); i++) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span>(simphotons[i].Time &lt; t_min) t_min = simphotons[i].Time;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pdtype == <span class="stringliteral">&quot;pmt_coated&quot;</span>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <a class="code" href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a> auxphotons;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span> ( <span class="keyword">auto</span> it{ directPhotonsOnPMTS.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(directPhotonsOnPMTS) )</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      {auxphotons = it-&gt;second;}</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      auxphotons += (simphotons);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="comment">// TODO: use std::algorithm.  ~icaza</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; auxphotons.size(); i++) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">if</span>(auxphotons[i].Time &lt; t_min) t_min = auxphotons[i].Time;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Wrong pdtype: &quot;</span> &lt;&lt; pdtype &lt;&lt; std::endl;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> t_min;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">// TODO: this function is not being used anywhere! ~icaza</span></div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a712bfdb3b39279dfc3e17ca898dbe5ea">  418</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a712bfdb3b39279dfc3e17ca898dbe5ea">DigiPMTSBNDAlg::FindMinimumTimeLite</a>(</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html">sim::SimPhotonsLite</a> <span class="keyword">const</span>&amp; litesimphotons,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    std::string pdtype,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    std::unordered_map&lt;int, sim::SimPhotonsLite&gt;&amp; directPhotonsOnPMTS)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span>(pdtype == <span class="stringliteral">&quot;pmt_uncoated&quot;</span>) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      std::map&lt;int, int&gt; <span class="keyword">const</span>&amp; photonMap = litesimphotons.<a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html#a3b3f2c60661dc50217f2d4598a9d41c0">DetectedPhotons</a>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keyword">auto</span> min = std::find_if(</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        photonMap.begin(),</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        photonMap.end(),</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pm) {<span class="keywordflow">return</span> pm.second != 0; });</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span>(min != photonMap.end()) <span class="keywordflow">return</span> <span class="keywordtype">double</span>(min-&gt;first);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pdtype == <span class="stringliteral">&quot;pmt_coated&quot;</span>) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html">sim::SimPhotonsLite</a> auxphotons;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span> ( <span class="keyword">auto</span> it{ directPhotonsOnPMTS.find(ch) }; it != <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(directPhotonsOnPMTS) )</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      {auxphotons = it-&gt;second;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">// TODO: this might be buggy:</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="comment">// potentially adding to a uninitialized object.  ~icaza</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      auxphotons += (litesimphotons);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      std::map&lt;int, int&gt; <span class="keyword">const</span>&amp; auxphotonMap = auxphotons.<a class="code" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html#a3b3f2c60661dc50217f2d4598a9d41c0">DetectedPhotons</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keyword">auto</span> min = std::find_if(</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        auxphotonMap.begin(),</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        auxphotonMap.end(),</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pm) {<span class="keywordflow">return</span> pm.second != 0; });</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">if</span>(min != auxphotonMap.end()) <span class="keywordflow">return</span> <span class="keywordtype">double</span>(min-&gt;first);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DigiPMTSBNDAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Wrong pdtype: &quot;</span> &lt;&lt; pdtype &lt;&lt; std::endl;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> 1e5;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// ---  opdet::DigiPMTSBNDAlgMaker</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a09192074c14d1e6ca69fa4472e9b10cf">DigiPMTSBNDAlgMaker::DigiPMTSBNDAlgMaker</a></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a09192074c14d1e6ca69fa4472e9b10cf">  458</a></span>&#160;  (<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html">Config</a> <span class="keyword">const</span>&amp; config)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// settings</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    fBaseConfig.PMTChargeToADC           = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#afd73afb8549df2a392027dd1edf6d1b5">pmtchargeToADC</a>();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    fBaseConfig.PMTBaseline              = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a4b2641886f51ce656f33ac507fa44c69">pmtbaseline</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    fBaseConfig.PMTSaturation            = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a8a60d129b86883c49e41c8ae66c3f36b">pmtsaturation</a>();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    fBaseConfig.QEDirect                 = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a991f159a7075380496339ffec175864e">qEDirect</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    fBaseConfig.QERefl                   = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a43ee47cb42371a58bea7b2fc41b72cce">qERefl</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    fBaseConfig.PMTSinglePEmodel         = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a489e9f2ce921190ab563aebda6c8dfd6">PMTsinglePEmodel</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    fBaseConfig.PMTRiseTime              = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a34bcd97da38e80d7e2b58e8672585401">pmtriseTime</a>();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    fBaseConfig.PMTFallTime              = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a3253daa50921f08d89a6c8e79f11a398">pmtfallTime</a>();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    fBaseConfig.PMTMeanAmplitude         = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a996a980789bbf8077d6b1dfa7998435b">pmtmeanAmplitude</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    fBaseConfig.PMTDarkNoiseRate         = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a5bbfd5ef95b507c72e46c025fcaaeecd">pmtdarkNoiseRate</a>();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    fBaseConfig.PMTBaselineRMS           = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#ab4791777e1d114abdfa06e9920de0a72">pmtbaselineRMS</a>();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    fBaseConfig.TransitTime              = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a2d772b6e249a731793f1471804a480ec">transitTime</a>();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    fBaseConfig.TTS                      = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a511b1e0e36b752b7510ebc27ebefecfe">tts</a>();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    fBaseConfig.CableTime                = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a89908b46dcdb95ed28edb753d9df232e">cableTime</a>();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    fBaseConfig.PMTDataFile              = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a4fef36dea7524ea92f52bb25cd81c48c">pmtDataFile</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    fBaseConfig.MakeGainFluctuations     = config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a6380810bba247c736b3fb3d9c0bf67ec">makeGainFluctuations</a>();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    config.<a class="code" href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#ab2ee2d40c83200a9d1d38c7a12b00815">gainFluctuationsParams</a>.get_if_present(fBaseConfig.GainFluctuationsParams);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  std::unique_ptr&lt;DigiPMTSBNDAlg&gt;</div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a589a537bd746a1904d3fa1702a5adfbc">  481</a></span>&#160;  <a class="code" href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a589a537bd746a1904d3fa1702a5adfbc">DigiPMTSBNDAlgMaker::operator()</a>(</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="../../dc/d37/classdetinfo_1_1LArProperties.html">detinfo::LArProperties</a> <span class="keyword">const</span>&amp; larProp,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    CLHEP::HepRandomEngine* engine</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    )<span class="keyword"> const</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// set the configuration</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keyword">auto</span> params = <a class="code" href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#ad593751c6f96597bbaca7f2e680093bd">fBaseConfig</a>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// set up parameters</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    params.<a class="code" href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a4b219e0b27fc96198ce8a9b1f27d42ff">larProp</a> = &amp;larProp;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    params.frequency = clockData.<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html#a2a9cc42c56118ccdf655a1b0312243f9">OpticalClock</a>().<a class="code" href="../../d0/d00/classdetinfo_1_1ElecClock.html#a8cc9f01b364bb33bd48866131086c4ec">Frequency</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    params.engine = engine;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> std::make_unique&lt;DigiPMTSBNDAlg&gt;(params);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  } <span class="comment">// DigiPMTSBNDAlgMaker::create()</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_aa0ea168591664ff01f639a3a7cae95c6"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#aa0ea168591664ff01f639a3a7cae95c6">opdet::DigiPMTSBNDAlg::fTimeTPB</a></div><div class="ttdeci">std::unique_ptr&lt; CLHEP::RandGeneral &gt; fTimeTPB</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00141">DigiPMTSBNDAlg.hh:141</a></div></div>
<div class="ttc" id="classdetinfo_1_1LArProperties_html"><div class="ttname"><a href="../../dc/d37/classdetinfo_1_1LArProperties.html">detinfo::LArProperties</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d94/LArProperties_8h_source.html#l00020">LArProperties.h:20</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ad068922ecbc307c058f8afa09a728c98"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ad068922ecbc307c058f8afa09a728c98">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTChargeToADC</a></div><div class="ttdeci">double PMTChargeToADC</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00054">DigiPMTSBNDAlg.hh:54</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ab7f0983e236ba02eb29602be82109a95"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab7f0983e236ba02eb29602be82109a95">opdet::DigiPMTSBNDAlg::CreatePDWaveformLiteCoatedPMT</a></div><div class="ttdeci">void CreatePDWaveformLiteCoatedPMT(int ch, double t_min, std::vector&lt; double &gt; &amp;wave, std::unordered_map&lt; int, sim::SimPhotonsLite &gt; &amp;DirectPhotonsMap, std::unordered_map&lt; int, sim::SimPhotonsLite &gt; &amp;ReflectedPhotonsMap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00242">DigiPMTSBNDAlg.cc:242</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a3de67fad7681a1d7afbaa3e69201c9da"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3de67fad7681a1d7afbaa3e69201c9da">opdet::DigiPMTSBNDAlg::CreatePDWaveformLite</a></div><div class="ttdeci">void CreatePDWaveformLite(sim::SimPhotonsLite const &amp;litesimphotons, double t_min, std::vector&lt; double &gt; &amp;wave, int ch, std::string pdtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00206">DigiPMTSBNDAlg.cc:206</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a71992f9f9618d1fc09ef56736859d5f2"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a71992f9f9618d1fc09ef56736859d5f2">opdet::DigiPMTSBNDAlg::fParams</a></div><div class="ttdeci">ConfigurationParameters_t fParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00118">DigiPMTSBNDAlg.hh:118</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ac06e071f23a232a6fb59d3408fab44df"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ac06e071f23a232a6fb59d3408fab44df">opdet::DigiPMTSBNDAlg::ConstructWaveform</a></div><div class="ttdeci">void ConstructWaveform(int ch, sim::SimPhotons const &amp;simphotons, std::vector&lt; short unsigned int &gt; &amp;waveform, std::string pdtype, double start_time, unsigned n_sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00075">DigiPMTSBNDAlg.cc:75</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a0e6104aa112147e0bb4d9dd40ef9b9c8"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a0e6104aa112147e0bb4d9dd40ef9b9c8">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTDataFile</a></div><div class="ttdeci">std::string PMTDataFile</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00064">DigiPMTSBNDAlg.hh:64</a></div></div>
<div class="ttc" id="namespacedemo_html_a5cd789a25b595576a719efcae81f17b3"><div class="ttname"><a href="../../d2/d0d/namespacedemo.html#a5cd789a25b595576a719efcae81f17b3">demo.fname</a></div><div class="ttdeci">string fname</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d5b/demo_8py_source.html#l00005">demo.py:5</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ad420129294b30ab284ee43f10e9e4a3e"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad420129294b30ab284ee43f10e9e4a3e">opdet::DigiPMTSBNDAlg::pulsesize</a></div><div class="ttdeci">int pulsesize</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00140">DigiPMTSBNDAlg.hh:140</a></div></div>
<div class="ttc" id="namespaceicarus_1_1waveform__operations_1_1details_html_ae295d3f6cb2f9181dccdf0e3492d44e0"><div class="ttname"><a href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">icarus::waveform_operations::details::transform</a></div><div class="ttdeci">static constexpr Sample_t transform(Sample_t sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/WaveformOperations_8h_source.html#l00145">WaveformOperations.h:145</a></div></div>
<div class="ttc" id="icarus__prodsingle__fastoptical_8fcl_html_adb6173ebd1f7c5a253fa43973b87634b"><div class="ttname"><a href="../../dc/db0/icarus__prodsingle__fastoptical_8fcl.html#adb6173ebd1f7c5a253fa43973b87634b">ScintPreScale</a></div><div class="ttdeci">stream1 stream1 can override from command line with o or output services LArPropertiesService ScintPreScale</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/icarus__prodsingle__fastoptical_8fcl_source.html#l00100">icarus_prodsingle_fastoptical.fcl:100</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_afc5698768e2fbedb5410f88daea2b262"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afc5698768e2fbedb5410f88daea2b262">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTDarkNoiseRate</a></div><div class="ttdeci">double PMTDarkNoiseRate</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00060">DigiPMTSBNDAlg.hh:60</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a1ecd845781dec99e48b4796b9afedb80"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1ecd845781dec99e48b4796b9afedb80">opdet::DigiPMTSBNDAlg::fQEDirect</a></div><div class="ttdeci">double fQEDirect</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00121">DigiPMTSBNDAlg.hh:121</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a79854d43ae87cec96a59d17fc4141bf0"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a79854d43ae87cec96a59d17fc4141bf0">file</a></div><div class="ttdeci">* file</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00069">file_to_url.sh:69</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlgMaker_html_ad593751c6f96597bbaca7f2e680093bd"><div class="ttname"><a href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#ad593751c6f96597bbaca7f2e680093bd">opdet::DigiPMTSBNDAlgMaker::fBaseConfig</a></div><div class="ttdeci">DigiPMTSBNDAlg::ConfigurationParameters_t fBaseConfig</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00287">DigiPMTSBNDAlg.hh:287</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a294027d499c1cc29fad20ac36108c59c"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a294027d499c1cc29fad20ac36108c59c">opdet::DigiPMTSBNDAlg::ConstructWaveformLiteCoatedPMT</a></div><div class="ttdeci">void ConstructWaveformLiteCoatedPMT(int ch, std::vector&lt; short unsigned int &gt; &amp;waveform, std::unordered_map&lt; int, sim::SimPhotonsLite &gt; &amp;DirectPhotonsMap, std::unordered_map&lt; int, sim::SimPhotonsLite &gt; &amp;ReflectedPhotonsMap, double start_time, unsigned n_sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00116">DigiPMTSBNDAlg.cc:116</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ad2462528559eaaec56be6f775bff4de0"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad2462528559eaaec56be6f775bff4de0">opdet::DigiPMTSBNDAlg::sigma1</a></div><div class="ttdeci">double sigma1</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00124">DigiPMTSBNDAlg.hh:124</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a2d772b6e249a731793f1471804a480ec"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a2d772b6e249a731793f1471804a480ec">opdet::DigiPMTSBNDAlgMaker::Config::transitTime</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; transitTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00190">DigiPMTSBNDAlg.hh:190</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ace22cf8fd028e0fe775f5b6caa7c9157"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ace22cf8fd028e0fe775f5b6caa7c9157">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::CableTime</a></div><div class="ttdeci">double CableTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00053">DigiPMTSBNDAlg.hh:53</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ac202530a5cfde623d564114216ad6261"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac202530a5cfde623d564114216ad6261">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::MakeGainFluctuations</a></div><div class="ttdeci">bool MakeGainFluctuations</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00066">DigiPMTSBNDAlg.hh:66</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ab733d35eacbf7fca4ecc47965a18c424"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab733d35eacbf7fca4ecc47965a18c424">opdet::DigiPMTSBNDAlg::CreateSaturation</a></div><div class="ttdeci">void CreateSaturation(std::vector&lt; double &gt; &amp;wave)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00342">DigiPMTSBNDAlg.cc:342</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a7560269c725d2a894854cbf1fdb25fa2"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a7560269c725d2a894854cbf1fdb25fa2">opdet::DigiPMTSBNDAlg::saturation</a></div><div class="ttdeci">double saturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00128">DigiPMTSBNDAlg.hh:128</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ad0d2b05c6fe07ad329eae871425ac83c"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ad0d2b05c6fe07ad329eae871425ac83c">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::QEDirect</a></div><div class="ttdeci">double QEDirect</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00062">DigiPMTSBNDAlg.hh:62</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a5bbfd5ef95b507c72e46c025fcaaeecd"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a5bbfd5ef95b507c72e46c025fcaaeecd">opdet::DigiPMTSBNDAlgMaker::Config::pmtdarkNoiseRate</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtdarkNoiseRate</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00235">DigiPMTSBNDAlg.hh:235</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a1bd05e397049f856e85337254ac7c511"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1bd05e397049f856e85337254ac7c511">opdet::DigiPMTSBNDAlg::fSinglePEWave</a></div><div class="ttdeci">std::vector&lt; double &gt; fSinglePEWave</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00139">DigiPMTSBNDAlg.hh:139</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a0aeee5382f39f86585e7bf391bb469c2"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aeee5382f39f86585e7bf391bb469c2">opdet::DigiPMTSBNDAlg::ConstructWaveformLite</a></div><div class="ttdeci">void ConstructWaveformLite(int ch, sim::SimPhotonsLite const &amp;litesimphotons, std::vector&lt; short unsigned int &gt; &amp;waveform, std::string pdtype, double start_time, unsigned n_sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00102">DigiPMTSBNDAlg.cc:102</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_afb8cd9a86f6a665835afddde13e3cf31"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#afb8cd9a86f6a665835afddde13e3cf31">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::GainFluctuationsParams</a></div><div class="ttdeci">fhicl::ParameterSet GainFluctuationsParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00067">DigiPMTSBNDAlg.hh:67</a></div></div>
<div class="ttc" id="classsim_1_1SimPhotonsLite_html_a3b3f2c60661dc50217f2d4598a9d41c0"><div class="ttname"><a href="../../d7/d6b/classsim_1_1SimPhotonsLite.html#a3b3f2c60661dc50217f2d4598a9d41c0">sim::SimPhotonsLite::DetectedPhotons</a></div><div class="ttdeci">std::map&lt; int, int &gt; DetectedPhotons</div><div class="ttdoc">Number of photons detected at each given time: time tick -&amp;gt; photons. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00117">SimPhotons.h:117</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a3253daa50921f08d89a6c8e79f11a398"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a3253daa50921f08d89a6c8e79f11a398">opdet::DigiPMTSBNDAlgMaker::Config::pmtfallTime</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtfallTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00215">DigiPMTSBNDAlg.hh:215</a></div></div>
<div class="ttc" id="decode__signalprocess__icarus_8fcl_html_a2a105cb669129f9c63eb7a4c15bf2d9b"><div class="ttname"><a href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a></div><div class="ttdeci">process_name gaushit a</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/decode__signalprocess__icarus_8fcl_source.html#l00037">decode_signalprocess_icarus.fcl:37</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a2257b911b465722fdce0080c141412d1"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a2257b911b465722fdce0080c141412d1">opdet::DigiPMTSBNDAlg::sigma2</a></div><div class="ttdeci">double sigma2</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00125">DigiPMTSBNDAlg.hh:125</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a90f62eeb118cc169b1d3eb029dfab8a2"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a90f62eeb118cc169b1d3eb029dfab8a2">opdet::DigiPMTSBNDAlg::transitTimeSpread_frac</a></div><div class="ttdeci">const double transitTimeSpread_frac</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00127">DigiPMTSBNDAlg.hh:127</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a61da5dbeec1071fe56ccdd0f05f88f2e"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a61da5dbeec1071fe56ccdd0f05f88f2e">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTMeanAmplitude</a></div><div class="ttdeci">double PMTMeanAmplitude</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00058">DigiPMTSBNDAlg.hh:58</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a5a86c648fba213c110f6d259ce48642d"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a5a86c648fba213c110f6d259ce48642d">opdet::DigiPMTSBNDAlg::AddDarkNoise</a></div><div class="ttdeci">void AddDarkNoise(std::vector&lt; double &gt; &amp;wave)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00370">DigiPMTSBNDAlg.cc:370</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ab65e65f76d6926db0833593d3b10d18e"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ab65e65f76d6926db0833593d3b10d18e">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTBaselineRMS</a></div><div class="ttdeci">double PMTBaselineRMS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00059">DigiPMTSBNDAlg.hh:59</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ad12a9eba7a3680a5cdf7772f16780c12"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ad12a9eba7a3680a5cdf7772f16780c12">opdet::DigiPMTSBNDAlg::Transittimespread</a></div><div class="ttdeci">double Transittimespread(double fwhm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00314">DigiPMTSBNDAlg.cc:314</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a805d20ea51ac6ef15d0f1c9528718e83"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a805d20ea51ac6ef15d0f1c9528718e83">opdet::DigiPMTSBNDAlg::AddLineNoise</a></div><div class="ttdeci">void AddLineNoise(std::vector&lt; double &gt; &amp;wave)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00349">DigiPMTSBNDAlg.cc:349</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlgMaker_html_a589a537bd746a1904d3fa1702a5adfbc"><div class="ttname"><a href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a589a537bd746a1904d3fa1702a5adfbc">opdet::DigiPMTSBNDAlgMaker::operator()</a></div><div class="ttdeci">std::unique_ptr&lt; DigiPMTSBNDAlg &gt; operator()(detinfo::LArProperties const &amp;larProp, detinfo::DetectorClocksData const &amp;clockData, CLHEP::HepRandomEngine *engine) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00481">DigiPMTSBNDAlg.cc:481</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a4fef36dea7524ea92f52bb25cd81c48c"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a4fef36dea7524ea92f52bb25cd81c48c">opdet::DigiPMTSBNDAlgMaker::Config::pmtDataFile</a></div><div class="ttdeci">fhicl::Atom&lt; std::string &gt; pmtDataFile</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00260">DigiPMTSBNDAlg.hh:260</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a3810371ff4099ca2bfaa3cf211446155"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a3810371ff4099ca2bfaa3cf211446155">opdet::DigiPMTSBNDAlg::CreatePDWaveformCoatedPMT</a></div><div class="ttdeci">void CreatePDWaveformCoatedPMT(int ch, double t_min, std::vector&lt; double &gt; &amp;wave, std::unordered_map&lt; int, sim::SimPhotons &gt; &amp;DirectPhotonsMap, std::unordered_map&lt; int, sim::SimPhotons &gt; &amp;ReflectedPhotonsMap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00158">DigiPMTSBNDAlg.cc:158</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a7c3fd539ae210ac7c93baa0773216d7e"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a7c3fd539ae210ac7c93baa0773216d7e">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::QERefl</a></div><div class="ttdeci">double QERefl</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00063">DigiPMTSBNDAlg.hh:63</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="namespaceevgen_html_ac64ce9233583b081586d153cc2f2056b"><div class="ttname"><a href="../../d4/d4d/namespaceevgen.html#ac64ce9233583b081586d153cc2f2056b">evgen::fEngine</a></div><div class="ttdeci">fEngine(art::ServiceHandle&lt; rndm::NuRandomService &gt;() -&gt;createEngine(*this, pset,&quot;Seed&quot;))</div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ab6e82cc910c6ca1ae020143818df1212"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab6e82cc910c6ca1ae020143818df1212">opdet::DigiPMTSBNDAlg::fEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine * fEngine</div><div class="ttdoc">Reference to art-managed random-number engine. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00130">DigiPMTSBNDAlg.hh:130</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a6667b4a366e6d2719adc275894b10c6b"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6667b4a366e6d2719adc275894b10c6b">opdet::DigiPMTSBNDAlg::ConstructWaveformCoatedPMT</a></div><div class="ttdeci">void ConstructWaveformCoatedPMT(int ch, std::vector&lt; short unsigned int &gt; &amp;waveform, std::unordered_map&lt; int, sim::SimPhotons &gt; &amp;DirectPhotonsMap, std::unordered_map&lt; int, sim::SimPhotons &gt; &amp;ReflectedPhotonsMap, double start_time, unsigned n_sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00088">DigiPMTSBNDAlg.cc:88</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a81e0cdabb7c225f74777fad0398658bf"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a81e0cdabb7c225f74777fad0398658bf">opdet::DigiPMTSBNDAlg::fQERefl</a></div><div class="ttdeci">double fQERefl</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00122">DigiPMTSBNDAlg.hh:122</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a9013dfe5427f96cccce9fa9c4282e3e8"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a9013dfe5427f96cccce9fa9c4282e3e8">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTSinglePEmodel</a></div><div class="ttdeci">bool PMTSinglePEmodel</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00065">DigiPMTSBNDAlg.hh:65</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a6380810bba247c736b3fb3d9c0bf67ec"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a6380810bba247c736b3fb3d9c0bf67ec">opdet::DigiPMTSBNDAlgMaker::Config::makeGainFluctuations</a></div><div class="ttdeci">fhicl::Atom&lt; bool &gt; makeGainFluctuations</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00265">DigiPMTSBNDAlg.hh:265</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a8e17b0e642eb3195fb148d83260c5711"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a8e17b0e642eb3195fb148d83260c5711">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::TransitTime</a></div><div class="ttdeci">double TransitTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00051">DigiPMTSBNDAlg.hh:51</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html">opdet::DigiPMTSBNDAlgMaker::Config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00186">DigiPMTSBNDAlg.hh:186</a></div></div>
<div class="ttc" id="DigiPMTSBNDAlg_8hh_html"><div class="ttname"><a href="../../d3/ddf/DigiPMTSBNDAlg_8hh.html">DigiPMTSBNDAlg.hh</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a8a60d129b86883c49e41c8ae66c3f36b"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a8a60d129b86883c49e41c8ae66c3f36b">opdet::DigiPMTSBNDAlgMaker::Config::pmtsaturation</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtsaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00240">DigiPMTSBNDAlg.hh:240</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_ab2a08b34a2006b986432fe30dc645bee"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#ab2a08b34a2006b986432fe30dc645bee">opdet::DigiPMTSBNDAlg::fPMTGainFluctuationsPtr</a></div><div class="ttdeci">std::unique_ptr&lt; opdet::PMTGainFluctuations &gt; fPMTGainFluctuationsPtr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00133">DigiPMTSBNDAlg.hh:133</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a991f159a7075380496339ffec175864e"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a991f159a7075380496339ffec175864e">opdet::DigiPMTSBNDAlgMaker::Config::qEDirect</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; qEDirect</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00245">DigiPMTSBNDAlg.hh:245</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html_a2a9cc42c56118ccdf655a1b0312243f9"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html#a2a9cc42c56118ccdf655a1b0312243f9">detinfo::DetectorClocksData::OpticalClock</a></div><div class="ttdeci">ElecClock const &amp; OpticalClock() const noexcept</div><div class="ttdoc">Borrow a const Optical clock with time set to Trigger time [us]. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00404">DetectorClocksData.h:404</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a0aef8717165572fa46a280e8add93d4e"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a0aef8717165572fa46a280e8add93d4e">opdet::DigiPMTSBNDAlg::DigiPMTSBNDAlg</a></div><div class="ttdeci">DigiPMTSBNDAlg(ConfigurationParameters_t const &amp;config)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00010">DigiPMTSBNDAlg.cc:10</a></div></div>
<div class="ttc" id="classdetinfo_1_1LArProperties_html_a769f632bb0d68ed3bec2ee18e9e8a2a8"><div class="ttname"><a href="../../dc/d37/classdetinfo_1_1LArProperties.html#a769f632bb0d68ed3bec2ee18e9e8a2a8">detinfo::LArProperties::ScintPreScale</a></div><div class="ttdeci">virtual double ScintPreScale(bool prescale=true) const =0</div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a996a980789bbf8077d6b1dfa7998435b"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a996a980789bbf8077d6b1dfa7998435b">opdet::DigiPMTSBNDAlgMaker::Config::pmtmeanAmplitude</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtmeanAmplitude</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00205">DigiPMTSBNDAlg.hh:205</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_afd73afb8549df2a392027dd1edf6d1b5"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#afd73afb8549df2a392027dd1edf6d1b5">opdet::DigiPMTSBNDAlgMaker::Config::pmtchargeToADC</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtchargeToADC</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00220">DigiPMTSBNDAlg.hh:220</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a489e9f2ce921190ab563aebda6c8dfd6"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a489e9f2ce921190ab563aebda6c8dfd6">opdet::DigiPMTSBNDAlgMaker::Config::PMTsinglePEmodel</a></div><div class="ttdeci">fhicl::Atom&lt; bool &gt; PMTsinglePEmodel</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00255">DigiPMTSBNDAlg.hh:255</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_ab4791777e1d114abdfa06e9920de0a72"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#ab4791777e1d114abdfa06e9920de0a72">opdet::DigiPMTSBNDAlgMaker::Config::pmtbaselineRMS</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtbaselineRMS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00230">DigiPMTSBNDAlg.hh:230</a></div></div>
<div class="ttc" id="namespacepmtana_html_afea8da0c88fccc3252529b6a49284b4a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">pmtana::mean</a></div><div class="ttdeci">double mean(const std::vector&lt; short &gt; &amp;wf, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00013">UtilFunc.cxx:13</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a1aa7d358ef53ba6957af0e61a8b286a2"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a1aa7d358ef53ba6957af0e61a8b286a2">opdet::DigiPMTSBNDAlg::CreatePDWaveform</a></div><div class="ttdeci">void CreatePDWaveform(sim::SimPhotons const &amp;SimPhotons, double t_min, std::vector&lt; double &gt; &amp;wave, int ch, std::string pdtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00130">DigiPMTSBNDAlg.cc:130</a></div></div>
<div class="ttc" id="classsim_1_1SimPhotons_html"><div class="ttname"><a href="../../d3/dd1/classsim_1_1SimPhotons.html">sim::SimPhotons</a></div><div class="ttdoc">Collection of photons which recorded on one channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00136">SimPhotons.h:136</a></div></div>
<div class="ttc" id="classsim_1_1SimPhotonsLite_html"><div class="ttname"><a href="../../d7/d6b/classsim_1_1SimPhotonsLite.html">sim::SimPhotonsLite</a></div><div class="ttdoc">Compact representation of photons on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00103">SimPhotons.h:103</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a1f8c2c7c3785cd2c9d93d6381e3c7d1c"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a1f8c2c7c3785cd2c9d93d6381e3c7d1c">start_time</a></div><div class="ttdeci">then echo fcl sbnd_project sbnd_project sbnd_project sbnd_project production production start_time</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a89908b46dcdb95ed28edb753d9df232e"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a89908b46dcdb95ed28edb753d9df232e">opdet::DigiPMTSBNDAlgMaker::Config::cableTime</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; cableTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00200">DigiPMTSBNDAlg.hh:200</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ae5e432a425423f82584a6fcab6acc2fb"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ae5e432a425423f82584a6fcab6acc2fb">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTFallTime</a></div><div class="ttdeci">double PMTFallTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00056">DigiPMTSBNDAlg.hh:56</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a7ae0f1830f826274c112fdfd23cca403"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a7ae0f1830f826274c112fdfd23cca403">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTSaturation</a></div><div class="ttdeci">double PMTSaturation</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00061">DigiPMTSBNDAlg.hh:61</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00050">DigiPMTSBNDAlg.hh:50</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a511b1e0e36b752b7510ebc27ebefecfe"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a511b1e0e36b752b7510ebc27ebefecfe">opdet::DigiPMTSBNDAlgMaker::Config::tts</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; tts</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00195">DigiPMTSBNDAlg.hh:195</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a34bcd97da38e80d7e2b58e8672585401"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a34bcd97da38e80d7e2b58e8672585401">opdet::DigiPMTSBNDAlgMaker::Config::pmtriseTime</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtriseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00210">DigiPMTSBNDAlg.hh:210</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a94405599d752c59713c6f806a11fa60f"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a94405599d752c59713c6f806a11fa60f">opdet::DigiPMTSBNDAlg::fSampling</a></div><div class="ttdeci">double fSampling</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00120">DigiPMTSBNDAlg.hh:120</a></div></div>
<div class="ttc" id="classdetinfo_1_1ElecClock_html_a8cc9f01b364bb33bd48866131086c4ec"><div class="ttname"><a href="../../d0/d00/classdetinfo_1_1ElecClock.html#a8cc9f01b364bb33bd48866131086c4ec">detinfo::ElecClock::Frequency</a></div><div class="ttdeci">constexpr double Frequency() const </div><div class="ttdoc">Frequency in MHz. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d60/ElecClock_8h_source.html#l00191">ElecClock.h:191</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a4e51eb92004ef00802382754b60a017d"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a4e51eb92004ef00802382754b60a017d">opdet::DigiPMTSBNDAlg::Pulse1PE</a></div><div class="ttdeci">void Pulse1PE(std::vector&lt; double &gt; &amp;wave)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00298">DigiPMTSBNDAlg.cc:298</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlgMaker_html_a09192074c14d1e6ca69fa4472e9b10cf"><div class="ttname"><a href="../../d9/d4b/classopdet_1_1DigiPMTSBNDAlgMaker.html#a09192074c14d1e6ca69fa4472e9b10cf">opdet::DigiPMTSBNDAlgMaker::DigiPMTSBNDAlgMaker</a></div><div class="ttdeci">DigiPMTSBNDAlgMaker(Config const &amp;config)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00458">DigiPMTSBNDAlg.cc:458</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a43ee47cb42371a58bea7b2fc41b72cce"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a43ee47cb42371a58bea7b2fc41b72cce">opdet::DigiPMTSBNDAlgMaker::Config::qERefl</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; qERefl</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00250">DigiPMTSBNDAlg.hh:250</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a712bfdb3b39279dfc3e17ca898dbe5ea"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a712bfdb3b39279dfc3e17ca898dbe5ea">opdet::DigiPMTSBNDAlg::FindMinimumTimeLite</a></div><div class="ttdeci">double FindMinimumTimeLite(sim::SimPhotonsLite const &amp;litesimphotons, int ch, std::string pdtype, std::unordered_map&lt; int, sim::SimPhotonsLite &gt; &amp;directPhotonsOnPMTS)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00418">DigiPMTSBNDAlg.cc:418</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a6003a230def49cc48ddf7a93901ff547"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a6003a230def49cc48ddf7a93901ff547">opdet::DigiPMTSBNDAlg::AddSPE</a></div><div class="ttdeci">void AddSPE(size_t time_bin, std::vector&lt; double &gt; &amp;wave)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00323">DigiPMTSBNDAlg.cc:323</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a1670d7925f2126850c03b977823b1a3b"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a1670d7925f2126850c03b977823b1a3b">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTRiseTime</a></div><div class="ttdeci">double PMTRiseTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00057">DigiPMTSBNDAlg.hh:57</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_ab2ee2d40c83200a9d1d38c7a12b00815"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#ab2ee2d40c83200a9d1d38c7a12b00815">opdet::DigiPMTSBNDAlgMaker::Config::gainFluctuationsParams</a></div><div class="ttdeci">fhicl::OptionalDelegatedParameter gainFluctuationsParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00270">DigiPMTSBNDAlg.hh:270</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a4b219e0b27fc96198ce8a9b1f27d42ff"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a4b219e0b27fc96198ce8a9b1f27d42ff">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::larProp</a></div><div class="ttdeci">detinfo::LArProperties const * larProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00069">DigiPMTSBNDAlg.hh:69</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config_html_a4b2641886f51ce656f33ac507fa44c69"><div class="ttname"><a href="../../d3/d01/structopdet_1_1DigiPMTSBNDAlgMaker_1_1Config.html#a4b2641886f51ce656f33ac507fa44c69">opdet::DigiPMTSBNDAlgMaker::Config::pmtbaseline</a></div><div class="ttdeci">fhicl::Atom&lt; double &gt; pmtbaseline</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00225">DigiPMTSBNDAlg.hh:225</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_ac448c8a336495a1ed08ff1b9936b587f"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#ac448c8a336495a1ed08ff1b9936b587f">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::PMTBaseline</a></div><div class="ttdeci">double PMTBaseline</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00055">DigiPMTSBNDAlg.hh:55</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a03fbcc7abc4ca2578a019b3f2e5d8702"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a03fbcc7abc4ca2578a019b3f2e5d8702">opdet::DigiPMTSBNDAlg::~DigiPMTSBNDAlg</a></div><div class="ttdeci">~DigiPMTSBNDAlg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00072">DigiPMTSBNDAlg.cc:72</a></div></div>
<div class="ttc" id="classopdet_1_1DigiPMTSBNDAlg_html_a983ca6b16027147dba9fd475a0c54d25"><div class="ttname"><a href="../../dc/d0b/classopdet_1_1DigiPMTSBNDAlg.html#a983ca6b16027147dba9fd475a0c54d25">opdet::DigiPMTSBNDAlg::FindMinimumTime</a></div><div class="ttdeci">double FindMinimumTime(sim::SimPhotons const &amp;, int ch, std::string pdtype, std::unordered_map&lt; int, sim::SimPhotons &gt; &amp;directPhotonsOnPMTS)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d08/DigiPMTSBNDAlg_8cc_source.html#l00386">DigiPMTSBNDAlg.cc:386</a></div></div>
<div class="ttc" id="structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t_html_a582743f28b4b049adcd7bcff1c467bb6"><div class="ttname"><a href="../../d8/db6/structopdet_1_1DigiPMTSBNDAlg_1_1ConfigurationParameters__t.html#a582743f28b4b049adcd7bcff1c467bb6">opdet::DigiPMTSBNDAlg::ConfigurationParameters_t::TTS</a></div><div class="ttdeci">double TTS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/DigiPMTSBNDAlg_8hh_source.html#l00052">DigiPMTSBNDAlg.hh:52</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
