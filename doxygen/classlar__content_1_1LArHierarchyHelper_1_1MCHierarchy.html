<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>lar_content::LArHierarchyHelper::MCHierarchy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelar__content.html">lar_content</a></li><li class="navelem"><a class="el" href="classlar__content_1_1LArHierarchyHelper.html">LArHierarchyHelper</a></li><li class="navelem"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html">MCHierarchy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lar_content::LArHierarchyHelper::MCHierarchy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html" title="MCHierarchy class. ">MCHierarchy</a> class.  
 <a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html" title="Node class. ">Node</a> class.  <a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html">ReconstructabilityCriteria</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html" title="ReconstructabilityCriteria class. ">ReconstructabilityCriteria</a> class.  <a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:acbffe19c103d910824a6ace85f4e256c"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a></td></tr>
<tr class="separator:acbffe19c103d910824a6ace85f4e256c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63284ca17c1ec6bdda94d4d55ea4a07a"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="find__global__symbol_8sh.html#ae54b7e1a1825bc958e2952b902e1b907">std::list</a>&lt; const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a63284ca17c1ec6bdda94d4d55ea4a07a">NodeList</a></td></tr>
<tr class="separator:a63284ca17c1ec6bdda94d4d55ea4a07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa9ddff217bca05ea04aa047cf727c70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#aaa9ddff217bca05ea04aa047cf727c70">MCHierarchy</a> ()</td></tr>
<tr class="memdesc:aaa9ddff217bca05ea04aa047cf727c70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#aaa9ddff217bca05ea04aa047cf727c70">More...</a><br/></td></tr>
<tr class="separator:aaa9ddff217bca05ea04aa047cf727c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c199a341558a585d977017bed77990a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a1c199a341558a585d977017bed77990a">MCHierarchy</a> (const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html">ReconstructabilityCriteria</a> &amp;recoCriteria)</td></tr>
<tr class="memdesc:a1c199a341558a585d977017bed77990a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html" title="MCHierarchy class. ">MCHierarchy</a> object using specified reconstructability criteria.  <a href="#a1c199a341558a585d977017bed77990a">More...</a><br/></td></tr>
<tr class="separator:a1c199a341558a585d977017bed77990a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad092c4c28899a53dfa88dbff60373808"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ad092c4c28899a53dfa88dbff60373808">~MCHierarchy</a> ()</td></tr>
<tr class="memdesc:ad092c4c28899a53dfa88dbff60373808"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ad092c4c28899a53dfa88dbff60373808">More...</a><br/></td></tr>
<tr class="separator:ad092c4c28899a53dfa88dbff60373808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c077a1944b8d033f5ecd1a4dc4f245"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ad5c077a1944b8d033f5ecd1a4dc4f245">FillHierarchy</a> (const pandora::MCParticleList &amp;mcParticleList, const pandora::CaloHitList &amp;caloHitList, const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1FoldingParameters.html">FoldingParameters</a> &amp;foldParameters)</td></tr>
<tr class="memdesc:ad5c077a1944b8d033f5ecd1a4dc4f245"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an MC hierarchy representation. Without folding this will be a mirror image of the standard MCParticle relationships. However, with folding options selected the hierarchy structure will group together MC particles into nodes based on the folding requirements.  <a href="#ad5c077a1944b8d033f5ecd1a4dc4f245">More...</a><br/></td></tr>
<tr class="separator:ad5c077a1944b8d033f5ecd1a4dc4f245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9187e78519a0881b9a74955378543757"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a9187e78519a0881b9a74955378543757">InterpretHierarchy</a> (const pandora::MCParticle *const pRoot, pandora::MCParticleList &amp;leadingParticles, pandora::MCParticleList &amp;childParticles, const float cosAngleTolerance) const </td></tr>
<tr class="memdesc:a9187e78519a0881b9a74955378543757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpret the hierarchy below a particular particle to determine if and how it should be folded. Folded particles are added to the leadingParticles list and child particles are added to the childParticles list.  <a href="#a9187e78519a0881b9a74955378543757">More...</a><br/></td></tr>
<tr class="separator:a9187e78519a0881b9a74955378543757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93fddd6dd4662b509c035757909c6eb"><td class="memItemLeft" align="right" valign="top">const pandora::MCParticle *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#aa93fddd6dd4662b509c035757909c6eb">GetNeutrino</a> () const </td></tr>
<tr class="memdesc:aa93fddd6dd4662b509c035757909c6eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the neutrino at the root of the hierarchy if it exists.  <a href="#aa93fddd6dd4662b509c035757909c6eb">More...</a><br/></td></tr>
<tr class="separator:aa93fddd6dd4662b509c035757909c6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6f1979f4102f5a5f7e7d24ea386f203"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae6f1979f4102f5a5f7e7d24ea386f203">GetRootNodes</a> () const </td></tr>
<tr class="memdesc:ae6f1979f4102f5a5f7e7d24ea386f203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the root nodes in this hierarchy.  <a href="#ae6f1979f4102f5a5f7e7d24ea386f203">More...</a><br/></td></tr>
<tr class="separator:ae6f1979f4102f5a5f7e7d24ea386f203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b618bd1cce5f09cddae714fe52c63a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a59b618bd1cce5f09cddae714fe52c63a">GetFlattenedNodes</a> (<a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a> &amp;nodeVector) const </td></tr>
<tr class="memdesc:a59b618bd1cce5f09cddae714fe52c63a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a flat vector of the ndoes in the hierarchy.  <a href="#a59b618bd1cce5f09cddae714fe52c63a">More...</a><br/></td></tr>
<tr class="separator:a59b618bd1cce5f09cddae714fe52c63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a606e15ceac76e8ede3ff9f8dd4544fdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a606e15ceac76e8ede3ff9f8dd4544fdb">RegisterNode</a> (const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *pNode)</td></tr>
<tr class="memdesc:a606e15ceac76e8ede3ff9f8dd4544fdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a node with the hierarchy.  <a href="#a606e15ceac76e8ede3ff9f8dd4544fdb">More...</a><br/></td></tr>
<tr class="separator:a606e15ceac76e8ede3ff9f8dd4544fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ad6c76f51f821bc9b3627248ebb230"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ad1ad6c76f51f821bc9b3627248ebb230">ToString</a> () const </td></tr>
<tr class="memdesc:ad1ad6c76f51f821bc9b3627248ebb230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produce a string representation of the hierarchy.  <a href="#ad1ad6c76f51f821bc9b3627248ebb230">More...</a><br/></td></tr>
<tr class="separator:ad1ad6c76f51f821bc9b3627248ebb230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d41b395359579d18ee282172a25a611"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a9d41b395359579d18ee282172a25a611">IsNeutrinoHierarchy</a> () const </td></tr>
<tr class="memdesc:a9d41b395359579d18ee282172a25a611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if this is a neutrino hierarchy.  <a href="#a9d41b395359579d18ee282172a25a611">More...</a><br/></td></tr>
<tr class="separator:a9d41b395359579d18ee282172a25a611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd0c0e51813c78525ca3bf46dff59c9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a9bd0c0e51813c78525ca3bf46dff59c9">IsTestBeamHierarchy</a> () const </td></tr>
<tr class="memdesc:a9bd0c0e51813c78525ca3bf46dff59c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if this is a test beam hierarchy.  <a href="#a9bd0c0e51813c78525ca3bf46dff59c9">More...</a><br/></td></tr>
<tr class="separator:a9bd0c0e51813c78525ca3bf46dff59c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a98e8b6a1b82143224b3edd23d2d91ef0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a98e8b6a1b82143224b3edd23d2d91ef0">CollectContinuations</a> (const pandora::MCParticle *pRoot, pandora::MCParticleList &amp;continuingParticles, pandora::MCParticleList &amp;childParticles, const float cosAngleTolerance) const </td></tr>
<tr class="memdesc:a98e8b6a1b82143224b3edd23d2d91ef0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identify downstream particles that represent continuations of the parent particle from a reconstruction perspective.  <a href="#a98e8b6a1b82143224b3edd23d2d91ef0">More...</a><br/></td></tr>
<tr class="separator:a98e8b6a1b82143224b3edd23d2d91ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95db5a2c05a81236628035958fd19029"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a95db5a2c05a81236628035958fd19029">IsReconstructable</a> (const pandora::MCParticle *pMCParticle) const </td></tr>
<tr class="memdesc:a95db5a2c05a81236628035958fd19029"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an individual particle meets reconstructability criteria.  <a href="#a95db5a2c05a81236628035958fd19029">More...</a><br/></td></tr>
<tr class="separator:a95db5a2c05a81236628035958fd19029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91897c8e02f96ef0d5c0c5cd2b2134f3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a91897c8e02f96ef0d5c0c5cd2b2134f3">IsReconstructable</a> (const pandora::CaloHitList &amp;caloHits) const </td></tr>
<tr class="memdesc:a91897c8e02f96ef0d5c0c5cd2b2134f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a set of hits meet reconstructability criteria.  <a href="#a91897c8e02f96ef0d5c0c5cd2b2134f3">More...</a><br/></td></tr>
<tr class="separator:a91897c8e02f96ef0d5c0c5cd2b2134f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab0ccb168e0845a1b38af7e74e825ad69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a></td></tr>
<tr class="memdesc:ab0ccb168e0845a1b38af7e74e825ad69"><td class="mdescLeft">&#160;</td><td class="mdescRight">The leading nodes (e.g. primary particles, cosmic rays, ...)  <a href="#ab0ccb168e0845a1b38af7e74e825ad69">More...</a><br/></td></tr>
<tr class="separator:ab0ccb168e0845a1b38af7e74e825ad69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae291b61ef96b0cdbc6b6f24b0c86d188"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html">ReconstructabilityCriteria</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a></td></tr>
<tr class="memdesc:ae291b61ef96b0cdbc6b6f24b0c86d188"><td class="mdescLeft">&#160;</td><td class="mdescRight">The criteria used to determine if the node is reconstructable.  <a href="#ae291b61ef96b0cdbc6b6f24b0c86d188">More...</a><br/></td></tr>
<tr class="separator:ae291b61ef96b0cdbc6b6f24b0c86d188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc05aed7b2ca0498f55711a4da52c248"><td class="memItemLeft" align="right" valign="top">const pandora::MCParticle *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a></td></tr>
<tr class="memdesc:afc05aed7b2ca0498f55711a4da52c248"><td class="mdescLeft">&#160;</td><td class="mdescRight">The incident neutrino, if it exists.  <a href="#afc05aed7b2ca0498f55711a4da52c248">More...</a><br/></td></tr>
<tr class="separator:afc05aed7b2ca0498f55711a4da52c248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3f1725df00c7dbdf5aa57f5d9448a9"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <br class="typebreak"/>
pandora::MCParticle <br class="typebreak"/>
*, pandora::CaloHitList &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a></td></tr>
<tr class="memdesc:a7b3f1725df00c7dbdf5aa57f5d9448a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The map between MC particles and calo hits.  <a href="#a7b3f1725df00c7dbdf5aa57f5d9448a9">More...</a><br/></td></tr>
<tr class="separator:a7b3f1725df00c7dbdf5aa57f5d9448a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c2b0a562a9bcdd858b294a5b1c3def"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a51c2b0a562a9bcdd858b294a5b1c3def">m_nodeToIdMap</a></td></tr>
<tr class="memdesc:a51c2b0a562a9bcdd858b294a5b1c3def"><td class="mdescLeft">&#160;</td><td class="mdescRight">A map from nodes to unique ids.  <a href="#a51c2b0a562a9bcdd858b294a5b1c3def">More...</a><br/></td></tr>
<tr class="separator:a51c2b0a562a9bcdd858b294a5b1c3def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a72a33776ac1afedd9855b0596c7828"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">m_nextNodeId</a></td></tr>
<tr class="memdesc:a3a72a33776ac1afedd9855b0596c7828"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ID to use for the next node.  <a href="#a3a72a33776ac1afedd9855b0596c7828">More...</a><br/></td></tr>
<tr class="separator:a3a72a33776ac1afedd9855b0596c7828"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html" title="MCHierarchy class. ">MCHierarchy</a> class. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00088">88</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a63284ca17c1ec6bdda94d4d55ea4a07a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="find__global__symbol_8sh.html#ae54b7e1a1825bc958e2952b902e1b907">std::list</a>&lt;const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *&gt; <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a63284ca17c1ec6bdda94d4d55ea4a07a">lar_content::LArHierarchyHelper::MCHierarchy::NodeList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00126">126</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="acbffe19c103d910824a6ace85f4e256c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *&gt; <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">lar_content::LArHierarchyHelper::MCHierarchy::NodeVector</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00124">124</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaa9ddff217bca05ea04aa047cf727c70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lar_content::LArHierarchyHelper::MCHierarchy::MCHierarchy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00075">75</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                           : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a>{<span class="keyword">nullptr</span>}, <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">m_nextNodeId</a>{1}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a3a72a33776ac1afedd9855b0596c7828"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">lar_content::LArHierarchyHelper::MCHierarchy::m_nextNodeId</a></div><div class="ttdeci">int m_nextNodeId</div><div class="ttdoc">The ID to use for the next node. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00420">LArHierarchyHelper.h:420</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c199a341558a585d977017bed77990a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lar_content::LArHierarchyHelper::MCHierarchy::MCHierarchy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html">ReconstructabilityCriteria</a> &amp;&#160;</td>
          <td class="paramname"><em>recoCriteria</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html" title="MCHierarchy class. ">MCHierarchy</a> object using specified reconstructability criteria. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recoCriteria</td><td>The reconstructability criteria to be applied </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00081">81</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                                                                         :</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>(recoCriteria),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a>{<span class="keyword">nullptr</span>},</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">m_nextNodeId</a>{1}</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ae291b61ef96b0cdbc6b6f24b0c86d188"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</a></div><div class="ttdeci">ReconstructabilityCriteria m_recoCriteria</div><div class="ttdoc">The criteria used to determine if the node is reconstructable. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00416">LArHierarchyHelper.h:416</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a3a72a33776ac1afedd9855b0596c7828"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">lar_content::LArHierarchyHelper::MCHierarchy::m_nextNodeId</a></div><div class="ttdeci">int m_nextNodeId</div><div class="ttdoc">The ID to use for the next node. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00420">LArHierarchyHelper.h:420</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad092c4c28899a53dfa88dbff60373808"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lar_content::LArHierarchyHelper::MCHierarchy::~MCHierarchy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00090">90</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> Node *pNode : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">delete</span> pNode;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    m_rootNodes.clear();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ab0ccb168e0845a1b38af7e74e825ad69"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</a></div><div class="ttdeci">NodeVector m_rootNodes</div><div class="ttdoc">The leading nodes (e.g. primary particles, cosmic rays, ...) </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00415">LArHierarchyHelper.h:415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a98e8b6a1b82143224b3edd23d2d91ef0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lar_content::LArHierarchyHelper::MCHierarchy::CollectContinuations </td>
          <td>(</td>
          <td class="paramtype">const pandora::MCParticle *&#160;</td>
          <td class="paramname"><em>pRoot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pandora::MCParticleList &amp;&#160;</td>
          <td class="paramname"><em>continuingParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pandora::MCParticleList &amp;&#160;</td>
          <td class="paramname"><em>childParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cosAngleTolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Identify downstream particles that represent continuations of the parent particle from a reconstruction perspective. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRoot</td><td>The root MC particle </td></tr>
    <tr><td class="paramname">continuingParticles</td><td>An output list of the particles identified as continuations </td></tr>
    <tr><td class="paramname">childParticles</td><td>An output list of the particles identified as child particles given any continuations </td></tr>
    <tr><td class="paramname">cosAngleTolerance</td><td>The cosine of the maximum angle for which trajectories are considered continuous </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00339">339</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">const</span> MCParticleList &amp;children{pRoot-&gt;GetDaughterList()};</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    MCParticleList foldCandidates;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : children)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">const</span> LArMCParticle *pLArMCParticle{<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>LArMCParticle *<span class="keyword">&gt;</span>(pMCParticle)};</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (!pLArMCParticle)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Only elastic and inelastic scattering can lead to folding</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a059331e39d0dc42f0598583c2a865395">LArMCParticleHelper::IsInelasticScatter</a>(pMCParticle) || <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#ac31296216787d084573cf24faf0ecf40">LArMCParticleHelper::IsElasticScatter</a>(pMCParticle))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keywordflow">if</span> (pMCParticle-&gt;GetParticleId() == pRoot-&gt;GetParticleId())</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                foldCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a> || (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a> &amp;&amp; pLArMCParticle-&gt;GetProcess() != <a class="code" href="namespacelar__content.html#af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea">MC_PROC_N_CAPTURE</a>))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="comment">// Non-scattering process particles become leading candidates unless it&#39;s neutron capture and we&#39;re removing neutrons</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            childParticles.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">const</span> MCParticle *pBestFoldCandidate{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">float</span> bestDp{std::numeric_limits&lt;float&gt;::max()};</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : foldCandidates)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span> (foldCandidates.size() == 1)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">// No alternative options, so this is either the best folding option by default, or a sufficiently large scatter to</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">// treat as a new particle for reconstruction purposes</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">LArMCParticleHelper::AreTopologicallyContinuous</a>(pRoot, pMCParticle, cosAngleTolerance))</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                pBestFoldCandidate = pMCParticle;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="comment">// Assess which, if any, of the children might be a continuation of the trajectory, otherwise move to child candidates</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">LArMCParticleHelper::AreTopologicallyContinuous</a>(pRoot, pMCParticle, cosAngleTolerance))</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> dp{pRoot-&gt;GetMomentum().GetMagnitude() - pMCParticle-&gt;GetMomentum().GetMagnitude()};</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keywordflow">if</span> (dp &lt; bestDp)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    pBestFoldCandidate = pMCParticle;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    bestDp = dp;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (pBestFoldCandidate)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        continuingParticles.emplace_back(pBestFoldCandidate);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keyword">const</span> MCParticleList &amp;newLeadingParticles{pBestFoldCandidate-&gt;GetDaughterList()};</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// We need to add the children as child particles to ensure these sub-hierarchies are explored...</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        childParticles.insert(childParticles.begin(), newLeadingParticles.begin(), newLeadingParticles.end());</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// but this current best fold candidate may have been added to the child particles by previously, so remove it</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> iter{std::find(childParticles.begin(), childParticles.end(), pBestFoldCandidate)};</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (iter != childParticles.end())</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            childParticles.erase(iter);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// Having found a particle to fold back at this level, continue to explore its downstream hierarchy for further folding</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">// opportunities and make their respective children child particles for the folded node we are creating</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a98e8b6a1b82143224b3edd23d2d91ef0">LArHierarchyHelper::MCHierarchy::CollectContinuations</a>(pBestFoldCandidate, continuingParticles, childParticles, cosAngleTolerance);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a98e8b6a1b82143224b3edd23d2d91ef0"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a98e8b6a1b82143224b3edd23d2d91ef0">lar_content::LArHierarchyHelper::MCHierarchy::CollectContinuations</a></div><div class="ttdeci">void CollectContinuations(const pandora::MCParticle *pRoot, pandora::MCParticleList &amp;continuingParticles, pandora::MCParticleList &amp;childParticles, const float cosAngleTolerance) const </div><div class="ttdoc">Identify downstream particles that represent continuations of the parent particle from a reconstructi...</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8cc_source.html#l00339">LArHierarchyHelper.cc:339</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a059331e39d0dc42f0598583c2a865395"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a059331e39d0dc42f0598583c2a865395">lar_content::LArMCParticleHelper::IsInelasticScatter</a></div><div class="ttdeci">static bool IsInelasticScatter(const pandora::MCParticle *const pMCParticle)</div><div class="ttdoc">Check whether or not an MC particle came from an inelastic scattering process. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00844">LArMCParticleHelper.cc:844</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a40117622c117b7dbc425a64df36244de"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">lar_content::LArMCParticleHelper::AreTopologicallyContinuous</a></div><div class="ttdeci">static bool AreTopologicallyContinuous(const pandora::MCParticle *const pMCParent, const pandora::MCParticle *const pMCChild, const float cosAngleTolerance)</div><div class="ttdoc">Determine if two MC particles are topologically continuous within a given tolerance. If the parent does not travel any distance, a travelling parent is sought and the comparison made between this and the child. If no travelling parent can be found, the particles are treated as continuous. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00959">LArMCParticleHelper.cc:959</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ae291b61ef96b0cdbc6b6f24b0c86d188"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</a></div><div class="ttdeci">ReconstructabilityCriteria m_recoCriteria</div><div class="ttdoc">The criteria used to determine if the node is reconstructable. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00416">LArHierarchyHelper.h:416</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_aa5f71eb3beecbcb6f6d30fb43f45c002"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_removeNeutrons</a></div><div class="ttdeci">const bool m_removeNeutrons</div><div class="ttdoc">whether to remove neutrons and their downstream particles </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00121">LArHierarchyHelper.h:121</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_ac31296216787d084573cf24faf0ecf40"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#ac31296216787d084573cf24faf0ecf40">lar_content::LArMCParticleHelper::IsElasticScatter</a></div><div class="ttdeci">static bool IsElasticScatter(const pandora::MCParticle *const pMCParticle)</div><div class="ttdoc">Check whether or not an MC particle came from an elastic scattering process. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00822">LArMCParticleHelper.cc:822</a></div></div>
<div class="ttc" id="namespacelar__content_html_af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea"><div class="ttname"><a href="namespacelar__content.html#af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea">lar_content::MC_PROC_N_CAPTURE</a></div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticle_8h_source.html#l00039">LArMCParticle.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5c077a1944b8d033f5ecd1a4dc4f245"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lar_content::LArHierarchyHelper::MCHierarchy::FillHierarchy </td>
          <td>(</td>
          <td class="paramtype">const pandora::MCParticleList &amp;&#160;</td>
          <td class="paramname"><em>mcParticleList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::CaloHitList &amp;&#160;</td>
          <td class="paramname"><em>caloHitList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1FoldingParameters.html">FoldingParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>foldParameters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an MC hierarchy representation. Without folding this will be a mirror image of the standard MCParticle relationships. However, with folding options selected the hierarchy structure will group together MC particles into nodes based on the folding requirements. </p>
<pre class="fragment">    If only folding back to primaries, the hierarchy will be relatively flat, with a top-level neutrino or test beam
    particle, if appropriate, and then a set of leaf nodes, one for each primary particles also containing the MC particles
    (and corresponding hits) from daughter particles.

    If only folding back to leading shower particles, the hierarchy will largely mirror the standard MCParticle hierarchy,
    but, when a shower particle is reached (for this purpose an electron or photon), this particle and all daughter
    particles will be represented by a single leaf node.

    If folding back to both primary and leading shower particles the hierarchy will again be rather flat, but in this case,
    if a primary track-like particle (i.e. not an electron or photon) has a downstream shower particle then all downstream
    particles above the shower-like particle will be folded into the primary node, but a new, daughter leaf node will be
    created for the shower-like particle and all of its daughters, and a parent-child relationship will be formed between
    the primary node and shower node.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mcParticleList</td><td>The list of MC particles with which to fill the hierarchy </td></tr>
    <tr><td class="paramname">caloHitList</td><td>The list of hits with which to fill the hierarchy </td></tr>
    <tr><td class="paramname">foldParameters</td><td>The folding parameters to use for the hierarchy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00099">99</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> predicate = [](<span class="keyword">const</span> MCParticle *pMCParticle) { <span class="keywordflow">return</span> <a class="code" href="sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(pMCParticle-&gt;GetParticleId()) == NEUTRON; };</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.clear();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> CaloHit *pCaloHit : caloHitList)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">try</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keyword">const</span> MCParticle *pMCParticle{MCParticleHelper::GetMainMCParticle(pCaloHit)};</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>[pMCParticle].emplace_back(pCaloHit);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">const</span> StatusCodeException &amp;)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper.html#a86349327b5139dccbc47cfa7ddd918da">MCParticleSet</a> primarySet;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a> = <a class="code" href="classlar__content_1_1LArHierarchyHelper.html#af9bb0965a61bd2823aed41dd3327b6f9">LArHierarchyHelper::GetMCPrimaries</a>(mcParticleList, primarySet);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    MCParticleList primaries(primarySet.begin(), primarySet.end());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    primaries.sort(<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a04160d2d3772dc1da7e9509c502cbffe">LArMCParticleHelper::SortByMomentum</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a>)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        primaries.erase(std::remove_if(primaries.begin(), primaries.end(), predicate), primaries.end());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (foldParameters.m_foldToTier &amp;&amp; foldParameters.m_tier == 1)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pPrimary : primaries)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            MCParticleList allParticles{pPrimary};</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">LArMCParticleHelper::GetAllDescendentMCParticles</a>(pPrimary, allParticles);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="comment">// Collect track-like and shower-like particles together, but throw out neutrons and descendents</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                MCParticleList dummy;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">LArMCParticleHelper::GetAllDescendentMCParticles</a>(pPrimary, allParticles, allParticles, dummy);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            CaloHitList allHits;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : allParticles)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="comment">// Not all MC particles will have hits</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    <span class="keyword">const</span> CaloHitList &amp;caloHits(<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pMCParticle));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    allHits.insert(allHits.begin(), caloHits.begin(), caloHits.end());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>.emplace_back(<span class="keyword">new</span> Node(*<span class="keyword">this</span>, allParticles, allHits));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (foldParameters.m_foldToLeadingShowers)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pPrimary : primaries)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            MCParticleList allParticles{pPrimary};</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>{<a class="code" href="sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(pPrimary-&gt;GetParticleId())};</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> isShower{<a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == E_MINUS || <a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == PHOTON};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> isNeutron{<a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == NEUTRON};</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (isShower || (isNeutron &amp;&amp; !<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a>))</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">LArMCParticleHelper::GetAllDescendentMCParticles</a>(pPrimary, allParticles);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            CaloHitList allHits;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : allParticles)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="comment">// ATTN - Not all MC particles will have hits</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <span class="keyword">const</span> CaloHitList &amp;caloHits(<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pMCParticle));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    allHits.insert(allHits.begin(), caloHits.begin(), caloHits.end());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            Node *pNode{<span class="keyword">new</span> Node(*<span class="keyword">this</span>, allParticles, allHits)};</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>.emplace_back(pNode);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span> (!(isShower || isNeutron))</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="comment">// Find the children of this particle and recursively add them to the hierarchy</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keyword">const</span> MCParticleList &amp;children{pPrimary-&gt;GetDaughterList()};</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pChild : children)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    pNode-&gt;FillHierarchy(pChild, foldParameters);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (foldParameters.m_foldDynamic)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pPrimary : primaries)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            MCParticleList leadingParticles, childParticles;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            this-&gt;<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a9187e78519a0881b9a74955378543757">InterpretHierarchy</a>(pPrimary, leadingParticles, childParticles, foldParameters.m_cosAngleTolerance);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            CaloHitList allHits;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : leadingParticles)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="comment">// ATTN - Not all MC particles will have hits</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <span class="keyword">const</span> CaloHitList &amp;caloHits(<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pMCParticle));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    allHits.insert(allHits.begin(), caloHits.begin(), caloHits.end());</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            Node *pNode{<span class="keyword">new</span> Node(*<span class="keyword">this</span>, leadingParticles, allHits)};</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>.emplace_back(pNode);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pChild : childParticles)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                pNode-&gt;FillHierarchy(pChild, foldParameters);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// Unfolded and folded to tier &gt; 1 have the same behaviour for primaries</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pPrimary : primaries)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            MCParticleList allParticles{pPrimary};</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            CaloHitList allHits;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : allParticles)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="comment">// ATTN - Not all MC particles will have hits</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    <span class="keyword">const</span> CaloHitList &amp;caloHits(<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pMCParticle));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    allHits.insert(allHits.begin(), caloHits.begin(), caloHits.end());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            Node *pNode{<span class="keyword">new</span> Node(*<span class="keyword">this</span>, allParticles, allHits)};</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>.emplace_back(pNode);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="comment">// Find the children of this particle and recursively add them to the hierarchy</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keyword">const</span> MCParticleList &amp;children{pPrimary-&gt;GetDaughterList()};</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pChild : children)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                pNode-&gt;FillHierarchy(pChild, foldParameters);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    Node *pLeadingLepton{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">float</span> leadingLeptonEnergy{-std::numeric_limits&lt;float&gt;::max()};</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> Node *pNode : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">const</span> MCParticle *pMC{pNode-&gt;GetLeadingMCParticle()};</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (pMC)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a>{<a class="code" href="sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(pMC-&gt;GetParticleId())};</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == MU_MINUS || <a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == E_MINUS || <a class="code" href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> == TAU_MINUS) &amp;&amp; pMC-&gt;GetEnergy() &gt; leadingLeptonEnergy)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                pLeadingLepton = <span class="keyword">const_cast&lt;</span>Node *<span class="keyword">&gt;</span>(pNode);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                leadingLeptonEnergy = pMC-&gt;GetEnergy();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (pLeadingLepton)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        pLeadingLepton-&gt;SetLeadingLepton();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_html_a86349327b5139dccbc47cfa7ddd918da"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper.html#a86349327b5139dccbc47cfa7ddd918da">lar_content::LArHierarchyHelper::MCParticleSet</a></div><div class="ttdeci">std::set&lt; const pandora::MCParticle * &gt; MCParticleSet</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00857">LArHierarchyHelper.h:857</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a697017f6ca07cbb4f47653babf318012"><div class="ttname"><a href="selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a></div><div class="ttdeci">var pdg</div><div class="ttdef"><b>Definition:</b> <a href="selectors_8fcl_source.html#l00014">selectors.fcl:14</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a7b3f1725df00c7dbdf5aa57f5d9448a9"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">lar_content::LArHierarchyHelper::MCHierarchy::m_mcToHitsMap</a></div><div class="ttdeci">std::map&lt; const pandora::MCParticle *, pandora::CaloHitList &gt; m_mcToHitsMap</div><div class="ttdoc">The map between MC particles and calo hits. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00418">LArHierarchyHelper.h:418</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a04160d2d3772dc1da7e9509c502cbffe"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a04160d2d3772dc1da7e9509c502cbffe">lar_content::LArMCParticleHelper::SortByMomentum</a></div><div class="ttdeci">static bool SortByMomentum(const pandora::MCParticle *const pLhs, const pandora::MCParticle *const pRhs)</div><div class="ttdoc">Sort mc particles by their momentum. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00471">LArMCParticleHelper.cc:471</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a9187e78519a0881b9a74955378543757"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a9187e78519a0881b9a74955378543757">lar_content::LArHierarchyHelper::MCHierarchy::InterpretHierarchy</a></div><div class="ttdeci">void InterpretHierarchy(const pandora::MCParticle *const pRoot, pandora::MCParticleList &amp;leadingParticles, pandora::MCParticleList &amp;childParticles, const float cosAngleTolerance) const </div><div class="ttdoc">Interpret the hierarchy below a particular particle to determine if and how it should be folded...</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8cc_source.html#l00249">LArHierarchyHelper.cc:249</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ab0ccb168e0845a1b38af7e74e825ad69"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</a></div><div class="ttdeci">NodeVector m_rootNodes</div><div class="ttdoc">The leading nodes (e.g. primary particles, cosmic rays, ...) </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00415">LArHierarchyHelper.h:415</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ae291b61ef96b0cdbc6b6f24b0c86d188"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</a></div><div class="ttdeci">ReconstructabilityCriteria m_recoCriteria</div><div class="ttdoc">The criteria used to determine if the node is reconstructable. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00416">LArHierarchyHelper.h:416</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_aa5f71eb3beecbcb6f6d30fb43f45c002"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_removeNeutrons</a></div><div class="ttdeci">const bool m_removeNeutrons</div><div class="ttdoc">whether to remove neutrons and their downstream particles </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00121">LArHierarchyHelper.h:121</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a1c62b574138596d616da748d3f75be25"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">lar_content::LArMCParticleHelper::GetAllDescendentMCParticles</a></div><div class="ttdeci">static void GetAllDescendentMCParticles(const pandora::MCParticle *const pMCParticle, pandora::MCParticleList &amp;descendentMCParticleList)</div><div class="ttdoc">Get all descendent mc particles. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00249">LArMCParticleHelper.cc:249</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_html_af9bb0965a61bd2823aed41dd3327b6f9"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper.html#af9bb0965a61bd2823aed41dd3327b6f9">lar_content::LArHierarchyHelper::GetMCPrimaries</a></div><div class="ttdeci">static const pandora::MCParticle * GetMCPrimaries(const pandora::MCParticleList &amp;mcParticleList, MCParticleSet &amp;primaries)</div><div class="ttdoc">Retrieves the primary MC particles from a list and returns the root (neutrino) for hierarchy...</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8cc_source.html#l01424">LArHierarchyHelper.cc:1424</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59b618bd1cce5f09cddae714fe52c63a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lar_content::LArHierarchyHelper::MCHierarchy::GetFlattenedNodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a> &amp;&#160;</td>
          <td class="paramname"><em>nodeVector</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a flat vector of the ndoes in the hierarchy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nodeVector</td><td>The output vector for the nodes in the hierarchy in breadth first order </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00404">404</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a63284ca17c1ec6bdda94d4d55ea4a07a">NodeList</a> queue;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> Node *pNode : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        nodeVector.emplace_back(pNode);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        queue.emplace_back(pNode);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">while</span> (!queue.empty())</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keyword">const</span> <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a> &amp;children{queue.front()-&gt;GetChildren()};</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        queue.pop_front();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> Node *pChild : children)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            nodeVector.emplace_back(pChild);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            queue.emplace_back(pChild);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_acbffe19c103d910824a6ace85f4e256c"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">lar_content::LArHierarchyHelper::MCHierarchy::NodeVector</a></div><div class="ttdeci">std::vector&lt; const Node * &gt; NodeVector</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00124">LArHierarchyHelper.h:124</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ab0ccb168e0845a1b38af7e74e825ad69"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</a></div><div class="ttdeci">NodeVector m_rootNodes</div><div class="ttdoc">The leading nodes (e.g. primary particles, cosmic rays, ...) </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00415">LArHierarchyHelper.h:415</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a63284ca17c1ec6bdda94d4d55ea4a07a"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a63284ca17c1ec6bdda94d4d55ea4a07a">lar_content::LArHierarchyHelper::MCHierarchy::NodeList</a></div><div class="ttdeci">std::list&lt; const Node * &gt; NodeList</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00126">LArHierarchyHelper.h:126</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa93fddd6dd4662b509c035757909c6eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const pandora::MCParticle * lar_content::LArHierarchyHelper::MCHierarchy::GetNeutrino </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the neutrino at the root of the hierarchy if it exists. </p>
<dl class="section return"><dt>Returns</dt><dd>The address of the incident neutrino (nullptr if it doesn't exist) </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00948">948</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae6f1979f4102f5a5f7e7d24ea386f203"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">LArHierarchyHelper::MCHierarchy::NodeVector</a> &amp; lar_content::LArHierarchyHelper::MCHierarchy::GetRootNodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the root nodes in this hierarchy. </p>
<dl class="section return"><dt>Returns</dt><dd>The root nodes in this hierarchy </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00955">955</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;{</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ab0ccb168e0845a1b38af7e74e825ad69"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</a></div><div class="ttdeci">NodeVector m_rootNodes</div><div class="ttdoc">The leading nodes (e.g. primary particles, cosmic rays, ...) </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00415">LArHierarchyHelper.h:415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9187e78519a0881b9a74955378543757"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lar_content::LArHierarchyHelper::MCHierarchy::InterpretHierarchy </td>
          <td>(</td>
          <td class="paramtype">const pandora::MCParticle *const&#160;</td>
          <td class="paramname"><em>pRoot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pandora::MCParticleList &amp;&#160;</td>
          <td class="paramname"><em>leadingParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pandora::MCParticleList &amp;&#160;</td>
          <td class="paramname"><em>childParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cosAngleTolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpret the hierarchy below a particular particle to determine if and how it should be folded. Folded particles are added to the leadingParticles list and child particles are added to the childParticles list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRoot</td><td>The root of the hierarchy to interpret </td></tr>
    <tr><td class="paramname">leadingParticles</td><td>The output list of particles that should be folded into the root particle </td></tr>
    <tr><td class="paramname">childParticles</td><td>The output list of particles that should be considered children of the folded particle </td></tr>
    <tr><td class="paramname">cosAngleTolerance</td><td>The cosine of the maximum angle for which trajectories are considered continuous </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00249">249</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    leadingParticles.emplace_back(pRoot);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    MCParticleList foldCandidates, childCandidates;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">const</span> MCParticleList &amp;children{pRoot-&gt;GetDaughterList()};</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : children)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> LArMCParticle *pLArMCParticle{<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>LArMCParticle *<span class="keyword">&gt;</span>(pMCParticle)};</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (!pLArMCParticle)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a059331e39d0dc42f0598583c2a865395">LArMCParticleHelper::IsInelasticScatter</a>(pMCParticle) || <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#ac31296216787d084573cf24faf0ecf40">LArMCParticleHelper::IsElasticScatter</a>(pMCParticle))</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// Elastic and inelastic scattering can either lead to folding, distinct nodes or disposable hits, all other processes</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// are either distinct nodes, or disposable</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (pMCParticle-&gt;GetParticleId() == pRoot-&gt;GetParticleId())</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                foldCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                childCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a> || (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">m_removeNeutrons</a> &amp;&amp; pLArMCParticle-&gt;GetProcess() != <a class="code" href="namespacelar__content.html#af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea">MC_PROC_N_CAPTURE</a>))</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">// Non-scattering process particles become leading candidates unless it&#39;s neutron capture and we&#39;re removing neutrons</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            childCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keyword">const</span> MCParticle *pBestFoldCandidate{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">float</span> bestDp{std::numeric_limits&lt;float&gt;::max()};</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : foldCandidates)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (foldCandidates.size() == 1)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">// No alternative options, so this is either the best folding option by default, or a sufficiently large scatter to</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">// treat as a new particle for reconstruction purposes</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">LArMCParticleHelper::AreTopologicallyContinuous</a>(pRoot, pMCParticle, cosAngleTolerance))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                pBestFoldCandidate = pMCParticle;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                childCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">// Assess which, if any, of the children might be a continuation of the trajectory, otherwise move to child candidates</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">LArMCParticleHelper::AreTopologicallyContinuous</a>(pRoot, pMCParticle, cosAngleTolerance))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> dp{pRoot-&gt;GetMomentum().GetMagnitude() - pMCParticle-&gt;GetMomentum().GetMagnitude()};</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keywordflow">if</span> (dp &lt; bestDp)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    pBestFoldCandidate = pMCParticle;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    bestDp = dp;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                childCandidates.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (pBestFoldCandidate)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        leadingParticles.emplace_back(pBestFoldCandidate);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// Having found a particle to fold back at this level, continue to explore its downstream hierarchy for further folding</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// opportunities and make their respective children leading particles for the folded node we are creating</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        this-&gt;<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a98e8b6a1b82143224b3edd23d2d91ef0">CollectContinuations</a>(pBestFoldCandidate, leadingParticles, childCandidates, cosAngleTolerance);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pMCParticle : childCandidates)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// Consider if the child particle will produce enough downstream hits to warrant inclusion</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a95db5a2c05a81236628035958fd19029">IsReconstructable</a>(pMCParticle))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            childParticles.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            MCParticleList localHierarchy{pMCParticle};</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            CaloHitList localHits;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">LArMCParticleHelper::GetAllDescendentMCParticles</a>(pMCParticle, localHierarchy);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> MCParticle *pLocalMCParticle : localHierarchy)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pLocalMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    <span class="keyword">const</span> CaloHitList &amp;caloHits(<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pLocalMCParticle));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    localHits.insert(localHits.begin(), caloHits.begin(), caloHits.end());</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a95db5a2c05a81236628035958fd19029">IsReconstructable</a>(localHits))</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                childParticles.emplace_back(pMCParticle);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a98e8b6a1b82143224b3edd23d2d91ef0"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a98e8b6a1b82143224b3edd23d2d91ef0">lar_content::LArHierarchyHelper::MCHierarchy::CollectContinuations</a></div><div class="ttdeci">void CollectContinuations(const pandora::MCParticle *pRoot, pandora::MCParticleList &amp;continuingParticles, pandora::MCParticleList &amp;childParticles, const float cosAngleTolerance) const </div><div class="ttdoc">Identify downstream particles that represent continuations of the parent particle from a reconstructi...</div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8cc_source.html#l00339">LArHierarchyHelper.cc:339</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a7b3f1725df00c7dbdf5aa57f5d9448a9"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">lar_content::LArHierarchyHelper::MCHierarchy::m_mcToHitsMap</a></div><div class="ttdeci">std::map&lt; const pandora::MCParticle *, pandora::CaloHitList &gt; m_mcToHitsMap</div><div class="ttdoc">The map between MC particles and calo hits. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00418">LArHierarchyHelper.h:418</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a059331e39d0dc42f0598583c2a865395"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a059331e39d0dc42f0598583c2a865395">lar_content::LArMCParticleHelper::IsInelasticScatter</a></div><div class="ttdeci">static bool IsInelasticScatter(const pandora::MCParticle *const pMCParticle)</div><div class="ttdoc">Check whether or not an MC particle came from an inelastic scattering process. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00844">LArMCParticleHelper.cc:844</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a40117622c117b7dbc425a64df36244de"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a40117622c117b7dbc425a64df36244de">lar_content::LArMCParticleHelper::AreTopologicallyContinuous</a></div><div class="ttdeci">static bool AreTopologicallyContinuous(const pandora::MCParticle *const pMCParent, const pandora::MCParticle *const pMCChild, const float cosAngleTolerance)</div><div class="ttdoc">Determine if two MC particles are topologically continuous within a given tolerance. If the parent does not travel any distance, a travelling parent is sought and the comparison made between this and the child. If no travelling parent can be found, the particles are treated as continuous. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00959">LArMCParticleHelper.cc:959</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ae291b61ef96b0cdbc6b6f24b0c86d188"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</a></div><div class="ttdeci">ReconstructabilityCriteria m_recoCriteria</div><div class="ttdoc">The criteria used to determine if the node is reconstructable. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00416">LArHierarchyHelper.h:416</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_aa5f71eb3beecbcb6f6d30fb43f45c002"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#aa5f71eb3beecbcb6f6d30fb43f45c002">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_removeNeutrons</a></div><div class="ttdeci">const bool m_removeNeutrons</div><div class="ttdoc">whether to remove neutrons and their downstream particles </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00121">LArHierarchyHelper.h:121</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a95db5a2c05a81236628035958fd19029"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a95db5a2c05a81236628035958fd19029">lar_content::LArHierarchyHelper::MCHierarchy::IsReconstructable</a></div><div class="ttdeci">bool IsReconstructable(const pandora::MCParticle *pMCParticle) const </div><div class="ttdoc">Checks if an individual particle meets reconstructability criteria. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8cc_source.html#l00445">LArHierarchyHelper.cc:445</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_a1c62b574138596d616da748d3f75be25"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#a1c62b574138596d616da748d3f75be25">lar_content::LArMCParticleHelper::GetAllDescendentMCParticles</a></div><div class="ttdeci">static void GetAllDescendentMCParticles(const pandora::MCParticle *const pMCParticle, pandora::MCParticleList &amp;descendentMCParticleList)</div><div class="ttdoc">Get all descendent mc particles. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00249">LArMCParticleHelper.cc:249</a></div></div>
<div class="ttc" id="classlar__content_1_1LArMCParticleHelper_html_ac31296216787d084573cf24faf0ecf40"><div class="ttname"><a href="classlar__content_1_1LArMCParticleHelper.html#ac31296216787d084573cf24faf0ecf40">lar_content::LArMCParticleHelper::IsElasticScatter</a></div><div class="ttdeci">static bool IsElasticScatter(const pandora::MCParticle *const pMCParticle)</div><div class="ttdoc">Check whether or not an MC particle came from an elastic scattering process. </div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticleHelper_8cc_source.html#l00822">LArMCParticleHelper.cc:822</a></div></div>
<div class="ttc" id="namespacelar__content_html_af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea"><div class="ttname"><a href="namespacelar__content.html#af34bcec2b818f020cb2835da09a7c5eda6220ec84d2307c010163beb7f73c36ea">lar_content::MC_PROC_N_CAPTURE</a></div><div class="ttdef"><b>Definition:</b> <a href="LArMCParticle_8h_source.html#l00039">LArMCParticle.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d41b395359579d18ee282172a25a611"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lar_content::LArHierarchyHelper::MCHierarchy::IsNeutrinoHierarchy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if this is a neutrino hierarchy. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether or not this is a neutrino hierarchy. </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00962">962</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a> != <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a95db5a2c05a81236628035958fd19029"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lar_content::LArHierarchyHelper::MCHierarchy::IsReconstructable </td>
          <td>(</td>
          <td class="paramtype">const pandora::MCParticle *&#160;</td>
          <td class="paramname"><em>pMCParticle</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if an individual particle meets reconstructability criteria. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMCParticle</td><td>The MC particle to assess</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not the MC particle meets reconstructability criteria </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00445">445</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.find(pMCParticle) != <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.end())</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nHitsU{0}, nHitsV{0}, nHitsW{0};</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> CaloHit *pCaloHit : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">m_mcToHitsMap</a>.at(pMCParticle))</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keyword">const</span> HitType view{pCaloHit-&gt;GetHitType()};</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">if</span> (view == TPC_VIEW_U)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                ++nHitsU;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (view == TPC_VIEW_V)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                ++nHitsV;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (view == TPC_VIEW_W)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                ++nHitsW;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nHits{nHitsU + nHitsV + nHitsW};</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nGoodViews{0};</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        nGoodViews += nHitsU &gt;= <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#afb172ff3b8948be95364f11b0932760b">m_minHitsForGoodView</a> ? 1 : 0;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        nGoodViews += nHitsV &gt;= <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#afb172ff3b8948be95364f11b0932760b">m_minHitsForGoodView</a> ? 1 : 0;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        nGoodViews += nHitsW &gt;= <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#afb172ff3b8948be95364f11b0932760b">m_minHitsForGoodView</a> ? 1 : 0;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">return</span> nHits &gt;= <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#a0913709542b53fc53551287d96033ece">m_minHits</a> &amp;&amp; nGoodViews &gt;= <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">m_recoCriteria</a>.<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#a81b92f1d3921b1ef32b09aed60418b27">m_minGoodViews</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_afb172ff3b8948be95364f11b0932760b"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#afb172ff3b8948be95364f11b0932760b">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_minHitsForGoodView</a></div><div class="ttdeci">const unsigned int m_minHitsForGoodView</div><div class="ttdoc">the minimum number of Hits for a good view </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00119">LArHierarchyHelper.h:119</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a7b3f1725df00c7dbdf5aa57f5d9448a9"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a7b3f1725df00c7dbdf5aa57f5d9448a9">lar_content::LArHierarchyHelper::MCHierarchy::m_mcToHitsMap</a></div><div class="ttdeci">std::map&lt; const pandora::MCParticle *, pandora::CaloHitList &gt; m_mcToHitsMap</div><div class="ttdoc">The map between MC particles and calo hits. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00418">LArHierarchyHelper.h:418</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ae291b61ef96b0cdbc6b6f24b0c86d188"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ae291b61ef96b0cdbc6b6f24b0c86d188">lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</a></div><div class="ttdeci">ReconstructabilityCriteria m_recoCriteria</div><div class="ttdoc">The criteria used to determine if the node is reconstructable. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00416">LArHierarchyHelper.h:416</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_a0913709542b53fc53551287d96033ece"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#a0913709542b53fc53551287d96033ece">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_minHits</a></div><div class="ttdeci">const unsigned int m_minHits</div><div class="ttdoc">the minimum number of primary good Hits </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00118">LArHierarchyHelper.h:118</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria_html_a81b92f1d3921b1ef32b09aed60418b27"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html#a81b92f1d3921b1ef32b09aed60418b27">lar_content::LArHierarchyHelper::MCHierarchy::ReconstructabilityCriteria::m_minGoodViews</a></div><div class="ttdeci">const unsigned int m_minGoodViews</div><div class="ttdoc">the minimum number of primary good views </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00120">LArHierarchyHelper.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91897c8e02f96ef0d5c0c5cd2b2134f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lar_content::LArHierarchyHelper::MCHierarchy::IsReconstructable </td>
          <td>(</td>
          <td class="paramtype">const pandora::CaloHitList &amp;&#160;</td>
          <td class="paramname"><em>caloHits</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if a set of hits meet reconstructability criteria. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caloHits</td><td>The calo hits to assess</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not the hits meet reconstructability criteria </dd></dl>

</div>
</div>
<a class="anchor" id="a9bd0c0e51813c78525ca3bf46dff59c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lar_content::LArHierarchyHelper::MCHierarchy::IsTestBeamHierarchy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if this is a test beam hierarchy. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether or not this is a test beam hierarchy. </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00969">969</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;{</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">m_pNeutrino</a> == <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_afc05aed7b2ca0498f55711a4da52c248"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#afc05aed7b2ca0498f55711a4da52c248">lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</a></div><div class="ttdeci">const pandora::MCParticle * m_pNeutrino</div><div class="ttdoc">The incident neutrino, if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00417">LArHierarchyHelper.h:417</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a606e15ceac76e8ede3ff9f8dd4544fdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lar_content::LArHierarchyHelper::MCHierarchy::RegisterNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *&#160;</td>
          <td class="paramname"><em>pNode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a node with the hierarchy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pNode</td><td>The node to register </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00426">426</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a51c2b0a562a9bcdd858b294a5b1c3def">m_nodeToIdMap</a>.insert(std::make_pair(pNode, <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">m_nextNodeId</a>));</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    ++<a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">m_nextNodeId</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a3a72a33776ac1afedd9855b0596c7828"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a3a72a33776ac1afedd9855b0596c7828">lar_content::LArHierarchyHelper::MCHierarchy::m_nextNodeId</a></div><div class="ttdeci">int m_nextNodeId</div><div class="ttdoc">The ID to use for the next node. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00420">LArHierarchyHelper.h:420</a></div></div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_a51c2b0a562a9bcdd858b294a5b1c3def"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#a51c2b0a562a9bcdd858b294a5b1c3def">lar_content::LArHierarchyHelper::MCHierarchy::m_nodeToIdMap</a></div><div class="ttdeci">std::map&lt; const Node *, int &gt; m_nodeToIdMap</div><div class="ttdoc">A map from nodes to unique ids. </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00419">LArHierarchyHelper.h:419</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad1ad6c76f51f821bc9b3627248ebb230"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string lar_content::LArHierarchyHelper::MCHierarchy::ToString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Produce a string representation of the hierarchy. </p>
<dl class="section return"><dt>Returns</dt><dd>The string representation of the hierarchy </dd></dl>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8cc_source.html#l00434">434</a> of file <a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    std::string str;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> Node *pNode : <a class="code" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">m_rootNodes</a>)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        str += pNode-&gt;ToString(<span class="stringliteral">&quot;&quot;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">return</span> str;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="ttc" id="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_html_ab0ccb168e0845a1b38af7e74e825ad69"><div class="ttname"><a href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#ab0ccb168e0845a1b38af7e74e825ad69">lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</a></div><div class="ttdeci">NodeVector m_rootNodes</div><div class="ttdoc">The leading nodes (e.g. primary particles, cosmic rays, ...) </div><div class="ttdef"><b>Definition:</b> <a href="LArHierarchyHelper_8h_source.html#l00415">LArHierarchyHelper.h:415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a7b3f1725df00c7dbdf5aa57f5d9448a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;const pandora::MCParticle *, pandora::CaloHitList&gt; lar_content::LArHierarchyHelper::MCHierarchy::m_mcToHitsMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The map between MC particles and calo hits. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00418">418</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3a72a33776ac1afedd9855b0596c7828"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lar_content::LArHierarchyHelper::MCHierarchy::m_nextNodeId</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The ID to use for the next node. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00420">420</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="a51c2b0a562a9bcdd858b294a5b1c3def"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;const <a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1Node.html">Node</a> *, int&gt; lar_content::LArHierarchyHelper::MCHierarchy::m_nodeToIdMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A map from nodes to unique ids. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00419">419</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc05aed7b2ca0498f55711a4da52c248"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const pandora::MCParticle* lar_content::LArHierarchyHelper::MCHierarchy::m_pNeutrino</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The incident neutrino, if it exists. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00417">417</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae291b61ef96b0cdbc6b6f24b0c86d188"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy_1_1ReconstructabilityCriteria.html">ReconstructabilityCriteria</a> lar_content::LArHierarchyHelper::MCHierarchy::m_recoCriteria</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The criteria used to determine if the node is reconstructable. </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00416">416</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab0ccb168e0845a1b38af7e74e825ad69"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlar__content_1_1LArHierarchyHelper_1_1MCHierarchy.html#acbffe19c103d910824a6ace85f4e256c">NodeVector</a> lar_content::LArHierarchyHelper::MCHierarchy::m_rootNodes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The leading nodes (e.g. primary particles, cosmic rays, ...) </p>

<p>Definition at line <a class="el" href="LArHierarchyHelper_8h_source.html#l00415">415</a> of file <a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>larpandoracontent/larpandoracontent/LArHelpers/<a class="el" href="LArHierarchyHelper_8h_source.html">LArHierarchyHelper.h</a></li>
<li>larpandoracontent/larpandoracontent/LArHelpers/<a class="el" href="LArHierarchyHelper_8cc_source.html">LArHierarchyHelper.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
