<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>DaqDecoderICARUSPMT_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_04d670c4adcb884258431ddc1ce2763c.html">icaruscode</a></li><li class="navelem"><a class="el" href="../../dir_94314c0f385d81f04de3b3bdb34c1673.html">icaruscode</a></li><li class="navelem"><a class="el" href="../../dir_25585c08811a47158b7eb78d628d2227.html">Decode</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DaqDecoderICARUSPMT_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file    DaqDecoderICARUSPMT_module.cc</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief   Produces `raw::OpDetWaveform` from V1730 artDAQ data fragments.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @authors Andrea Scarpelli, Gianluca Petrillo (petrillo@slac.stanford.edu)</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * @date    May 21, 2021</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// ICARUS/SBN libraries</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d40/PMTDecoderUtils_8h.html">icaruscode/Decode/DecoderTools/details/PMTDecoderUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d98/FragmentDumper_8h.html">icaruscode/Decode/DecoderTools/Dumpers/FragmentDumper.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d37/IICARUSChannelMap_8h.html">icaruscode/Decode/ChannelMapping/IICARUSChannelMap.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// #include &quot;sbnobj/Common/Trigger/ExtraTriggerInfo.h&quot; // future location of:</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d44/ExtraTriggerInfo_8h.html">icaruscode/Decode/DataProducts/ExtraTriggerInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// #include &quot;sbnobj/Common/Trigger/BeamBits.h&quot; // future location of:</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/da7/BeamBits_8h.html">icaruscode/Decode/BeamBits.h</a>&quot;</span> <span class="comment">// sbn::triggerSource</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/de6/FHiCLutils_8h.html">icarusalg/Utilities/FHiCLutils.h</a>&quot;</span> <span class="comment">// util::fhicl::getOptionalValue()</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d09/BinaryDumpUtils_8h.html">icarusalg/Utilities/BinaryDumpUtils.h</a>&quot;</span> <span class="comment">// icarus::ns::util::bin()</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d9b/PMTconfiguration_8h.html">sbnobj/Common/PMT/Data/PMTconfiguration.h</a>&quot;</span> <span class="comment">// sbn::PMTconfiguration</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;sbndaq-artdaq-core/Overlays/Common/CAENV1730Fragment.hh&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;sbndaq-artdaq-core/Overlays/FragmentType.hh&quot;</span> <span class="comment">// sbndaq::FragmentType</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// LArSoft libraries</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dba/DetectorClocksService_8h.html">lardata/DetectorInfoServices/DetectorClocksService.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dd2/DetectorTimings_8h.html">lardataalg/DetectorInfo/DetectorTimings.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/de4/DetectorClocks_8h.html">lardataalg/DetectorInfo/DetectorClocks.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d6e/spacetime_8h.html">lardataalg/Utilities/quantities/spacetime.h</a>&quot;</span> <span class="comment">// nanoseconds</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d86/intervals__fhicl_8h.html">lardataalg/Utilities/intervals_fhicl.h</a>&quot;</span> <span class="comment">// for nanoseconds in FHiCL</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d85/enumerate_8h.html">larcorealg/CoreUtils/enumerate.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/da2/counter_8h.html">larcorealg/CoreUtils/counter.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h.html">lardataobj/RawData/OpDetWaveform.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d16/TriggerData_8h.html">lardataobj/RawData/TriggerData.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// artDAQ</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;artdaq-core/Data/ContainerFragment.hh&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;artdaq-core/Data/Fragment.hh&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// framework libraries</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;art_root_io/TFileService.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Run.h&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Provenance/EventID.h&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Provenance/Timestamp.h&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;canvas/Utilities/InputTag.h&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/types/TableAs.h&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/types/Sequence.h&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/types/OptionalAtom.h&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/types/Atom.h&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;cetlib_except/exception.h&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// ROOT libraries</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;TTree.h&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// C/C++ standard libraries</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">using namespace </span>util::quantities::time_literals;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">using</span> <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">detinfo::timescales::electronics_time</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">namespace </span>icarus { <span class="keyword">class </span>DaqDecoderICARUSPMT; }<span class="comment"></span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * @brief Produces `raw::OpDetWaveform` from V1730 artDAQ data fragments.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * The module can read fragments from CAEN V1730 readout boards delivered by</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * artDAQ. It produces optical detector waveforms in LArSoft standards.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> * This decoder must support both a off-line mode (for storage and downstream</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> * processing) and a on-line mode (for monitoring).</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> * In particular, the on-line workflow is such that it may not be possible to</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> * access the FHiCL configuration of the job and therefore the PMT configuration</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> * data (see `icarus::PMTconfigurationExtraction` module).</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> * Configuration</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> * --------------</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * The set of supported parameters can be seen on command line by running</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> * `lar --print-description DaqDecoderICARUSPMT`.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * Description of the configuration parameters:</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * * `FragmentsLabels` (list of input tags): a list of possible input data</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> *     products. A valid input data product contain a list of fragments from</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> *     V1730. All input tags are tried. If only one is available, its content</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> *     is used for decoding; otherwise, an exception is thrown.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * * `DiagnosticOutput` (flag, default: `false`): enables additional console</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> *     output, including dumping of the fragments (that is huge output).</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * * `PMTconfigTag` (data product tag, optional): if specified, the pre-trigger</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> *     buffer duration is read from there; although optional, it is strongly</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> *     recommended that this information be provided, since it is essential for</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> *     the correct timing of the PMT waveforms (see</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> *     @ref icarus_PMTDecoder_timestamps &quot;the discussion on time stamps below&quot;).</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * * `BoardSetup` (list of board setup information): each entry specifies some</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> *     information about a specific readout board; the boards are identified by</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> *     their name; if a board is found in input that has no setup information,</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> *     some time corrections are not applied (see</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> *     @ref icarus_PMTDecoder_timestamps &quot;the discussion on time stamps below&quot;).</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> *     Each entry is in the form of a table:</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> *     * `Name` (string, mandatory): the name of the board</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> *        (e.g. `&quot;icaruspmtwwtop01&quot;`); this is use to match the setup</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> *        information to a fragment ID in the PMT configuration.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> *     * `FragmentID` (integral, optional): if specified, allows the corrections</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> *       using setup information to be applied even when no PMT configuration is</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> *       provided (if neither PMT configuration nor setup information including</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> *       `FragmentID` is available, no time correction is applied).</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> *     * `TriggerDelay` (nanoseconds, default: 0 ns): measured delay from the</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> *       primitive trigger time to the execution of the PMT trigger; specify</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> *       the unit! (e.g. `&quot;43 ns&quot;`).</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * * `RequireKnownBoards` (flag, default: `true`): if set, the readout boards</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> *     in input must each have a setup configuration (`BoardSetup`) *and* must</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> *     be present in the PMT DAQ configuration, or an exception is thrown;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> *     if not set, readout boards in input will be processed even when their</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> *     setup or DAQ configuration is not known, at the cost of fewer corrections</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> *     on the timestamps (which should then be considered unreliable).</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * * `RequireBoardConfig` (flag, default: `true`): if set, the readout boards</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> *     which have a setup (`BoardSetup`) are required to be included in the DAQ</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> *     configuration of the input file, or an exception is thrown; if not set,</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> *     missing readout boards are unnoticed.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * * `TriggerTag` (data product tag): tag for the information</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> *     (`sbn::ExtraTriggerInfo`, produced by trigger decoding); if not</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> *     specified, the _art_ event timestamp will be used as trigger time (*not*</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> *     recommended).</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> * * `TTTresetEverySecond` (optional): if set, the decoder will take advantage</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> *     of the assumption that the Trigger Time Tag of all PMT readout boards is</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> *     synchronised with the global trigger time and reset at every change of</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> *     second of the timescale of the latter; this is currently the only</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> *     implementation supporting multiple PMT readout windows on the same board;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> *     if this option is set to `false`, all PMT readout boards are assumed to</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> *     have been triggered at the time of the global trigger. By default, this</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> *     option is set to `true` unless `TriggerTag` is specified empty.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * * `DataTrees` (list of strings, default: none): list of data trees to be</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> *     produced; if none (default), then `TFileService` is not required.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> * * `LogCategory` (string, default: `DaqDecoderICARUSPMT`): name of the message</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> *     facility category where the output is sent.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * Requirements</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * -------------</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * Services required include:</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * * `IICARUSChannelMap` for the association of fragments to LArSoft channel ID;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * * `DetectorClocksService` for the correct decoding of the time stamps</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> *   (always required, even when dumbed-down timestamp decoding is requested);</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * * `TFileService` only if the production of trees or plots is requested.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * Waveform time stamp</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * --------------------</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> * @anchor icarus_PMTDecoder_timestamps</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * All waveforms on the same readout board fragment share the same timestamp.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> * The same readout board can produce different fragments at different times</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> * within an event in which case each fragment will be independently assigned</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> * a timstamp .</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> * The time stamp of the waveform is defined as the time when the first sample</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * of the waveform started (that is, if the sample represent the value of the</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * signal in an interval of 2 ns, the time stamp is pointing at the beginning</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> * of those 2 ns). Whether we can honour that definition, though, is a different</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> * matter.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * The representation of the time stamp is in the</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> * @ref DetectorClocksElectronicsTime &quot;electronics time scale&quot;.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> * Waveforms all originate from a trigger primitive signal being sent to the</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * readout boards by NI7820 FPGA to start the acquisition of the waveform.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * One of these primitives matches the global event trigger, but the</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * corresponding fragment is not treated in any special way.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> * Every delay between when that signal is emitted and when the PMT trigger is</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> * executed shifts the timestamp of the waveform backward.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> * We assign the the time stamp of the waveforms as follow:</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> * 1. the base time is the global trigger time; the global trigger time is read</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> *   from the trigger data, where it is stored as an absolute time in TAI scale;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> *   the global trigger time itself effectively defines the electronics time</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> *   scale used within a _art_ event, so its representation is a fixed number</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> *   that is configured in LArSoft and can be accessed with</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> *   `DetectorClocksData::TriggerTime()`;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> * 2. each V1730 data fragment comes with a time tag (&quot;TTT&quot;) describing the time</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> *   of the end of the readout buffer (unknown whether the start or the end of</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *   the tick of the last sample). This tag is a counter internal to the V1730</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> *   board, incremented every 8 ns. The counter is reset at the beginning of</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> *   every &quot;new&quot; TAI second, and it can thus be easily transformed into a time</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> *   in the same TAI scale as the global trigger; the difference between TTT</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> *   and the global trigger pins down the end of the readout buffer in the</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> *   electronics time scale;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> * 3. a delay is subtracted to the timestamp, which encompasses all fixed delays</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> *   occurring in the trigger signal transportation; the most prominent is the</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> *   delay occurring between the start of the &quot;new&quot; TAI second and when the</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> *   TTT reset signal reaches and is honoured by the readout board.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> *   This value must be independently measured and provided to this decoder via</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> *   configuration as setup information (`TTTresetDelay`); if not present in the</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> *   setup, this delay is not added;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * 4. finally, the time of the beginning of the waveform, that is the target</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> *   for `raw::OpDetWaveform` timestamp, is obtained from the time of its end</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> *   by simply subtracting the readout buffer length.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * A special decoding mode, hoped to be just historical by now, does not rely</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> * on the global trigger time. This mode can be safely used only when the (only)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> * data fragment was triggered by the global trigger (e.g. in the simplest</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> * minimum/zero bias trigger). It has the advantage that it does not use the TTT</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"> * information. It can be enabled explicitly by setting the option</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> * `TTTresetEverySecond` to `true`, or by removing the specification of the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> * trigger time data product tag (`TriggerTag`).</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> * 1. The trigger primitive time is assumed to be the global trigger time too,</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"> *   so that the trigger primitive time in electronics time also matches the</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> *   global trigger time.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"> * 2. upon receiving the trigger primitive signal, the readout board will keep</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> *   some of the samples already digitized, in what we call pre-trigger buffer;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"> *   the size of this buffer is a fixed number of samples which is specified in</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> *   DAQ as a fraction of the complete buffer that is _post-trigger_; this</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> *   amount, converted in time, is subtracted to the trigger time to point back</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> *   to the beginning of the waveform instead that to the trigger primitive</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> *   time. The necessary information is read from the PMT configuration</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> *   (`PMTconfigTag`); if no configuration is available, this offset is not</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> *   subtracted; note that this is a major shift (typically, a few microseconds)</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> *   that should be always included. This step is equivalent to the step (4) of</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"> *   the regular mode, where here the adjustment starts from the trigger</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"> *   primitive time instead than from the end-of-buffer time.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> * 3. a delay is subtracted to the timestamp, which encompasses all fixed delays</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"> *   occurring in the trigger signal transportation; one component of it is the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"> *   relative delay in the propagation of the trigger primitive signal from a</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"> *   board to the next (in fact, every three boards have the trigger signal in</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> *   daisy chain). This value must be independently measured and provided to</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> *   this decoder via configuration as setup information (`TriggerDelay`); if</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> *   not present in the setup, this delay is not added.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> *   Note that the particular contribution of the daisy chain to the delay does</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> *   not need to be explicitly taken into account in the main mode, because the</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> *   TTT reset is independent  and not daisy-chained, so that the TTT times</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> *   are all synchronized and when the primitive trigger arrives (via daisy</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> *   chain) the TTT value at that instant is already including the delay.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> * Data trees</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> * -----------</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> * The module supports the following ROOT trees production on demand:</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> * * `PMTfragments`: data pertaining a single fragment; each entry is about a</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> *   single fragment, and it includes full event ID, event time stamp (from</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> *   _art_, i.e. the one assigned to the event by artDAQ), the ID of the</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> *   fragment the entry is describing, and then the rest of the data, including:</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> *     * `TTT` (64-bit integer): (Extended) Trigger Time Tag value, in readout</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> *       board ticks (each worth 8 ns) from the last board reset;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> *       currently the value includes the 31-bit counter and in addition the</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> *       overflow bit as MSB; the overflow bit is set by the readout board</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> *       the first time the counter passes its limit (2^31) and wraps, and never</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> *       cleared until the next board reset.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *       While the tree has room for the 48-bit version (ETTT), the rest of the</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> *       decoder does not yet support it.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> *     * `trigger` (64-bit signed integer): global trigger time (from the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> *       trigger decoder), in nanoseconds from The Epoch.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> *     * `triggerSec`, `triggerNS` (32-bit integer each): same time as `trigger`</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> *       branch, split into second and nanosecond components.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> *     * `relBeamGateNS`, (32-bit integer): beam gate time opening relative to</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> *       the trigger time, in nanoseconds; it may be affected by rounding.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> *       branch, split into second and nanosecond components.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> *     * `fragTime` (64-bit signed integer), `fragTimeSec` (32-bit signed</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> *       integer): the timestamp of the PMT fragment, assigned by the board</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> *       reader constructing the fragment.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> *     * `fragCount` (unsigned integer): the counter of the fragment within a</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> *       readout board (its &quot;event counter&quot;).</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> *     * `waveformTime` (double): time assigned to the waveforms from this</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> *       fragment (electronics time scale).</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> *     * `waveformSize` (unsigned integer): number of ticks for the waveforms</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> *       from this fragment.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> *     * `triggerBits` (unsigned integer): bits from the `raw::Trigger`.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> *     * `gateCount` (unsigned integer): number of this gate from run start.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> *     * `onGlobalTrigger` (boolean): whether the waveform covers the nominal</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> *       trigger time (which should be equivalent to whether the fragment was</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> *       triggered by the global trigger).</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> * Technical notes</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> * ----------------</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> * In order to correctly reconstruct the time stamp, this module needs several</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> * pieces of information.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> * These include the size of the pre-trigger buffer, which is set by the readout</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> * board configuration, and the delay either between the start of the &quot;new&quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> * second and the execution of the TTT reset, or between the global trigger and</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"> * the time that trigger is received and acted upon in the readout board,</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> * depending of the time stamping mode; in both cases, the delays need to be</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> * measured.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * The first category of information, from readout board configuration, are read</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> * from the input file (`sbn::PMTconfiguration`), while the second category </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> * needs to be specified in the tool FHiCL configuration.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> * PMT configuration is optional, in the sense that it can be omitted; in that</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> * case, some standard values will be used for it. This kind of setup may be</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * good for monitoring, but it does not meet the requirements for physics</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> * analyses.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> * For a board to be served, an entry of that board must be present in the</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> * tool configuration (`BoardSetup`). It is an error for a fragment in input not</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> * to have an entry for the corresponding board setup.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * The module extracts the needed information and matches it into a</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> * sort-of-database keyed by fragment ID, so that it can be quickly applied</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> * when decoding a fragment. The matching is performed by board name.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> * Glossary</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> * ---------</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> * * **setup**, **[PMT] configuration**: this is jargon specific to this tool.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> *     Information about a readout board can come from two sources: the &quot;setup&quot;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> *     is information included in the `BoardSetup` configuration list of this</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> *     tool; the &quot;PMT configuration&quot; is information included in the DAQ</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> *     configuration that is delivered via `PMTconfigTag`.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> * * **TAI** (International Atomic Time): a time standard defining a universal</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> *     time with a precision higher than it will ever matter for ICARUS.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> * * **TTT**: trigger time tag, from the V1730 event record (31 bits); may be:</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> * * **ETTT**: extended trigger time tag, from the V1730 event record (48 bits).</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> * * **trigger delay**: time point when a V1730 board processes a (PMT) trigger</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> *     signal (and increments the TTT register) with respect to the time of the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> *     time stamp of the (SPEXi) global trigger that acquired the event.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * @todo Merge contiguous waveforms on the same channel</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html">  341</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html">icarus::DaqDecoderICARUSPMT</a>: <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// --- BEGIN -- some debugging tree declarations -----------------------------</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  /// Enumerate the supported data trees.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac77b2241f3748694113a37725ba99f47">  346</a></span>&#160;<span class="comment"></span>  <span class="keyword">enum class</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac77b2241f3748694113a37725ba99f47">DataTrees</a>: std::size_t {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    Fragments, <span class="comment">///&lt; Information about fragments</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span>    <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>          <span class="comment">///&lt; Counter.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>  };</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">using</span> TreeNameList_t</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0ead396e4ef1ce58cedf14a3c12f2055">  351</a></span>&#160;    = std::array&lt;std::string, static_cast&lt;std::size_t&gt;(<a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">DataTrees::N</a>)&gt;;</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a836bf665cd811240ff9a6545bcd63e35">  352</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0ead396e4ef1ce58cedf14a3c12f2055">TreeNameList_t</a> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a836bf665cd811240ff9a6545bcd63e35">TreeNames</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  /// Returns a string with all supported tree names.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> std::string listTreeNames(std::string <span class="keyword">const</span>&amp; sep = <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// --- END ---- some debugging tree declarations -----------------------------</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// --- BEGIN -- public data types --------------------------------------------</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  </div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aa026f738dfec06e4a50040d795e724c1">  363</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> = <a class="code" href="../../d9/d1a/namespaceutil_1_1quantities_1_1intervals.html#a439758e928a1b5231e459628ae43fe98">util::quantities::intervals::nanoseconds</a>; <span class="comment">///&lt; Alias.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span>  <span class="comment"></span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  /// Data structure for trigger time.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">  366</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    static_assert(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) &gt;= 4U);</div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html">  368</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html">Split_t</a> {</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html#aa6c769fd7780734a0d445e8e77ab4892">  369</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a7b9b5eb89e02611bfe143e75f6eb1e22">seconds</a> = std::numeric_limits&lt;int&gt;::min(); <span class="comment">///&lt; The ongoing second.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span><span class="comment">        /// Nanoseconds from the start of current second.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html#ad31a778e0fd69663d77427e8c00e79a3">  371</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::numeric_limits&lt;unsigned int&gt;::max</a>();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }; <span class="comment">// Split_t</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment"></span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">    /// Trigger time in nanoseconds from The Epoch.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#af2e3440f33eb484c5c53c3a240f9fd51">  375</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> time = std::numeric_limits&lt;long long int&gt;::min();<span class="comment"></span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    /// Trigger time in nanoseconds from The Epoch (in components).</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#ac58ee0d58238b45d1fcbe6b68c63325f">  377</a></span>&#160;<span class="comment"></span>    <a class="code" href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html">Split_t</a> <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#ac58ee0d58238b45d1fcbe6b68c63325f">split</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    constexpr <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    constexpr <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a>(<span class="keywordtype">int</span> sec, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ns);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    constexpr <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> triggerTime);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }; <span class="comment">// SplitTimestamp_t</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// --- END ---- public data types --------------------------------------------</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// --- BEGIN -- FHiCL configuration ------------------------------------------</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  /// Configuration of the V1730 readout board setup.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html">  390</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html">BoardSetupConfig</a> {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    </div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a9c25e7795e8df92705f9b433e1c74c66">  392</a></span>&#160;    fhicl::Atom&lt;std::string&gt; <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>(<span class="stringliteral">&quot;Name&quot;</span>),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      fhicl::Comment(<span class="stringliteral">&quot;board name, as specified in the DAQ configuration&quot;</span>)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      };</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a475612a63ecc9041269c3bde7f291935">  397</a></span>&#160;    fhicl::OptionalAtom&lt;unsigned int&gt; FragmentID {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>(<span class="stringliteral">&quot;FragmentID&quot;</span>),</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      fhicl::Comment(<span class="stringliteral">&quot;ID of the fragments associated with the board&quot;</span>)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      };</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a8ead9416959f5606724e4d2815fb0583">  402</a></span>&#160;    fhicl::Atom&lt;nanoseconds&gt; TriggerDelay {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>(<span class="stringliteral">&quot;TriggerDelay&quot;</span>),</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      fhicl::Comment</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        (<span class="stringliteral">&quot;from delay from the trigger timestamp to the PMT trigger [ns]&quot;</span>),</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      0_ns</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      };</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    </div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a2ec2c73c5e5163e23cb373e389329f78">  409</a></span>&#160;    fhicl::Atom&lt;nanoseconds&gt; TTTresetDelay {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>(<span class="stringliteral">&quot;TTTresetDelay&quot;</span>),</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      fhicl::Comment</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        (<span class="stringliteral">&quot;assume that V1730 counter (Trigger Time Tag) is reset every second&quot;</span>),</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      0_ns</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      };</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }; <span class="comment">// struct BoardSetupConfig</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">  /// Main tool configuration.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html">  420</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html">Config</a> {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    </div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#ae72c4be677628d6877bb27d23b3dbf31">  422</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#ae72c4be677628d6877bb27d23b3dbf31">Name</a> = <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">  423</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a> = fhicl::Comment;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#aa843d4c370d7f0faa55344e42cadfeb1">  425</a></span>&#160;    fhicl::Sequence&lt;art::InputTag&gt; FragmentsLabels {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;FragmentsLabels&quot;</span>),</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;data product candidates with the PMT fragments from DAQ&quot;</span>),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      std::vector&lt;art::InputTag&gt;{ <span class="stringliteral">&quot;daq:CAENV1730&quot;</span>, <span class="stringliteral">&quot;daq:ContainerCAENV1730&quot;</span> }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      };</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    </div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a584b3b76c51ca263c459ab8ac56fdb99">  431</a></span>&#160;    fhicl::Atom&lt;bool&gt; SurviveExceptions {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;SurviveExceptions&quot;</span>),</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        (<span class="stringliteral">&quot;when the decoding tool throws an exception, print a message and move on&quot;</span>),</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keyword">true</span> <span class="comment">// default</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      };</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    </div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a17d0d8bda96c585303c5360c041e9177">  438</a></span>&#160;    fhicl::Atom&lt;bool&gt; DiagnosticOutput {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;DiagnosticOutput&quot;</span>),</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;enable additional console output&quot;</span>),</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keyword">false</span> <span class="comment">// default</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      };</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a4bcef3dac03dded8ca8a1c8d121543d5">  444</a></span>&#160;    fhicl::Atom&lt;bool&gt; PacketDump {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;PacketDump&quot;</span>),</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;enable dump of the whole V1730 data (huge)&quot;</span>),</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keyword">false</span> <span class="comment">// default</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      };</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    </div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#ae731025b70c7697edcb0c50d24a7846a">  450</a></span>&#160;    fhicl::Atom&lt;bool&gt; RequireKnownBoards {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;RequireKnownBoards&quot;</span>),</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        (<span class="stringliteral">&quot;all readout boards in input must be known (setup+PMT configuration)&quot;</span>),</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">true</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      };</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    </div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a19f6d55eace6e42c07554242b8ee4e60">  457</a></span>&#160;    fhicl::Atom&lt;bool&gt; <a class="code" href="../../d0/db3/stage0__multiTPC__splitstream__east__icarus_8fcl.html#a2e26720297298fbdbea931dcab1bc851">RequireBoardConfig</a> {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;RequireBoardConfig&quot;</span>),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        (<span class="stringliteral">&quot;all readout boards in setup must have a matching PMT configuration&quot;</span>),</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keyword">true</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      };</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    </div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#ae2ee52b4a65467d7d4cc8638e2ee39c8">  464</a></span>&#160;    fhicl::OptionalAtom&lt;art::InputTag&gt; PMTconfigTag {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;PMTconfigTag&quot;</span>),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;input tag for the PMT readout board configuration information&quot;</span>)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      };</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    fhicl::Sequence</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      &lt;fhicl::TableAs&lt;daq::details::BoardSetup_t, BoardSetupConfig&gt;&gt;</div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#afc48a760dd0357e2eef3510c982b78a3">  471</a></span>&#160;    BoardSetup {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;BoardSetup&quot;</span>),</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;list of the setup settings for all relevant V1730 boards&quot;</span>)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      };</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    </div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a277fe709b284d177a150b858f7e1bd7b">  476</a></span>&#160;    fhicl::OptionalAtom&lt;art::InputTag&gt; TriggerTag {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;TriggerTag&quot;</span>),</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;input tag for the global trigger object (sbn::ExtraTriggerInfo)&quot;</span>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      };</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    </div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a6e9623fa4f2a2328c99e7820d7ccf36e">  481</a></span>&#160;    fhicl::OptionalAtom&lt;bool&gt; TTTresetEverySecond {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;TTTresetEverySecond&quot;</span>),</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        (<span class="stringliteral">&quot;assume that V1730 counter (Trigger Time Tag) is reset every second&quot;</span>)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      };</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    </div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a90c135e5b7e2b6783e4218ffe8281a22">  487</a></span>&#160;    fhicl::Sequence&lt;std::string&gt; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac77b2241f3748694113a37725ba99f47">DataTrees</a> {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">fhicl::Name</a>(<span class="stringliteral">&quot;DataTrees&quot;</span>),</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      fhicl::Comment</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        (<span class="stringliteral">&quot;produces the specified ROOT trees (&quot;</span> + listTreeNames(<span class="stringliteral">&quot;,&quot;</span>) + <span class="stringliteral">&quot;)&quot;</span>),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      std::vector&lt;std::string&gt;{} <span class="comment">// default</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      };</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    </div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#a0368d8cfc621e71de7b3acb87986cf54">  494</a></span>&#160;    fhicl::Atom&lt;std::string&gt; LogCategory {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <a class="code" href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a>(<span class="stringliteral">&quot;LogCategory&quot;</span>),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">Comment</a>(<span class="stringliteral">&quot;name of the category for message stream&quot;</span>),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="stringliteral">&quot;PMTDecoder&quot;</span> <span class="comment">// default</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      };</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }; <span class="comment">// Config</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  </div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a135c6ee981d13b84cda2ad24b0265f86">  502</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a135c6ee981d13b84cda2ad24b0265f86">Parameters</a> = art::EDProducer::Table&lt;Config&gt;;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> NoTimestamp</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a23773b2db7b3e602ae81f0b87c5d9ca7">  506</a></span>&#160;    = std::numeric_limits&lt;electronics_time&gt;::min();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// --- END ---- FHiCL configuration ------------------------------------------</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  /// Constructor.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span>  <span class="keyword">explicit</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html">DaqDecoderICARUSPMT</a>(<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a135c6ee981d13b84cda2ad24b0265f86">Parameters</a> <span class="keyword">const</span>&amp; params);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">  /// On a new run: cache PMT configuration information.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> beginRun(art::Run&amp; run) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  /// Processes the event.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> produce(art::Event&amp; event) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  /// Prints a end-of-job message.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> endJob() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">  /// Collection of useful information from fragment data.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">  528</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    artdaq::Fragment::fragment_id_t fragmentID</div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a04a561fb116904daf82f299524571e1c">  530</a></span>&#160;      = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::numeric_limits&lt;artdaq::Fragment::fragment_id_t&gt;::max</a>();</div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a47e1379b1a07905c2557ede62a84ab13">  531</a></span>&#160;    artdaq::Fragment::timestamp_t <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a47e1379b1a07905c2557ede62a84ab13">fragmentTimestamp</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#ac3bbd36e4a3d48293704d1168f1ff949">  532</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eventCounter = 0U;</div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a0b2b506eb6925a77da16ab61f0a46aef">  533</a></span>&#160;    std::uint32_t TTT = 0U;</div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a76f4663507cf7d01fd502942b804c487">  534</a></span>&#160;    std::uint16_t enabledChannels = 0U;</div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a40504304c3ad41f104ba728cb822ffea">  535</a></span>&#160;    std::size_t nSamplesPerChannel = 0U;</div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#af3d954619a31bde44754daa3dc2d4b47">  536</a></span>&#160;    std::uint16_t <span class="keyword">const</span>* data = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }; <span class="comment">// FragmentInfo_t</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  /// Information used in decoding from a board.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">  540</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> {</div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a9271ad5be0f89a2afee59e8f4c77a786">  541</a></span>&#160;    std::string <span class="keyword">const</span> <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a9271ad5be0f89a2afee59e8f4c77a786">name</a>;</div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#ae2ed20faab73502a47213dc2d85f66f1">  542</a></span>&#160;    <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#ae2ed20faab73502a47213dc2d85f66f1">bufferLength</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a8304fba7380518d7482888cc74416cbf">  543</a></span>&#160;    <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a8304fba7380518d7482888cc74416cbf">preTriggerTime</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a97da42f00664b6b8cf940ad2d3ecb37f">  544</a></span>&#160;    <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a97da42f00664b6b8cf940ad2d3ecb37f">PMTtriggerDelay</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#acc3306221dc34c54077491cb7d8509e3">  545</a></span>&#160;    <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#acc3306221dc34c54077491cb7d8509e3">TTTresetDelay</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  };</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  /// Collection of information about the global trigger.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">  549</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">TriggerInfo_t</a> {</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#a9638efe2fcf5e4aac24bb4ec58c1e046">  550</a></span>&#160;    <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> <a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#a9638efe2fcf5e4aac24bb4ec58c1e046">time</a>; <span class="comment">///&lt; Time of the trigger (absolute).</span></div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#ad63c08fbea20716b9edb464c6bbc0d8b">  551</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#ad63c08fbea20716b9edb464c6bbc0d8b">relBeamGateTime</a>; <span class="comment">///&lt; Time of beam gate relative to trigger [ns].</span></div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#afa7753d6873be36255e22bd7e0c8a8ea">  552</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bits = 0x0; <span class="comment">///&lt; Trigger bits.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#a37f913eb7f90c102ec30f30f0080b76b">  553</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gateCount = 0U; <span class="comment">///&lt; Gate number from the beginning of run.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span>  }; <span class="comment">// TriggerInfo_t</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// --- BEGIN -- Configuration parameters -------------------------------------</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  ///&lt; List of candidate data products with artDAQ data fragments.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a49fa56184ca98d1407b221b75f240bf6">  559</a></span>&#160;<span class="comment"></span>  std::vector&lt;art::InputTag&gt; <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a49fa56184ca98d1407b221b75f240bf6">fInputTags</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  </div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad4a3c040261c685aa7bf394e34a50b47">  561</a></span>&#160;  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad4a3c040261c685aa7bf394e34a50b47">fSurviveExceptions</a>; <span class="comment">///&lt; Whether to &quot;ignore&quot; errors.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span>  <span class="comment"></span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">  /// If true will spew endless messages to output.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abe100ec9a3c0b567ceee486359c294d3">  564</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abe100ec9a3c0b567ceee486359c294d3">fDiagnosticOutput</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  </div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8429384dcd9dd4fcdaf9385cfee06d5c">  566</a></span>&#160;  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8429384dcd9dd4fcdaf9385cfee06d5c">fPacketDump</a>; <span class="comment">///&lt; Dump V1730 data.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span>  <span class="comment"></span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  /// Whether info on all input boards is required.</span></div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abb587b1f392bbec78ffd3caa4db30141">  569</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abb587b1f392bbec78ffd3caa4db30141">fRequireKnownBoards</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  /// Whether setup info on all boards is required.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a388517ebb73872038ab7f6fa7b1642fa">  572</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a388517ebb73872038ab7f6fa7b1642fa">fRequireBoardConfig</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  /// Input tag of the PMT configuration.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a345c79060570f79eadc930293d58fdf8">  575</a></span>&#160;<span class="comment"></span>  std::optional&lt;art::InputTag&gt; <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a345c79060570f79eadc930293d58fdf8">fPMTconfigTag</a>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  /// Input tag of the global trigger.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8f59cdf5a47d5d01736ff2d50a49a116">  578</a></span>&#160;<span class="comment"></span>  std::optional&lt;art::InputTag&gt; <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8f59cdf5a47d5d01736ff2d50a49a116">fTriggerTag</a>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  </div>
<div class="line"><a name="l00580"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6bb414ce406b60bac9adb2672a2b5e46">  580</a></span>&#160;  <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6bb414ce406b60bac9adb2672a2b5e46">fTTTresetEverySecond</a>; <span class="comment">///&lt; Whether V1730 TTT is reset every second.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span>  <span class="comment"></span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  /// All board setup settings.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a79fb8a50bd83ae7f98d72195d3da1ad3">  583</a></span>&#160;<span class="comment"></span>  std::vector&lt;daq::details::BoardSetup_t&gt; <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a79fb8a50bd83ae7f98d72195d3da1ad3">fBoardSetup</a>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  </div>
<div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a438d2305736f0fde62a8be59a2f151ee">  585</a></span>&#160;  std::string <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a438d2305736f0fde62a8be59a2f151ee">fLogCategory</a>; <span class="comment">///&lt; Message facility category.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span>  </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// --- END ---- Configuration parameters -------------------------------------</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// --- BEGIN -- Services -----------------------------------------------------</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">  /// Interface to LArSoft configuration for detector timing.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac444eb16f496b54eb2c99b47997cbfd6">  593</a></span>&#160;<span class="comment"></span>  <a class="code" href="../../de/d0f/classdetinfo_1_1DetectorTimings.html">detinfo::DetectorTimings</a> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac444eb16f496b54eb2c99b47997cbfd6">fDetTimings</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  /// Fragment/channel mapping database.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a47e5c3353e8af594cb5eb6f3d728599f">  596</a></span>&#160;<span class="comment"></span>  <a class="code" href="../../d2/d1f/classicarusDB_1_1IICARUSChannelMap.html">icarusDB::IICARUSChannelMap</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a47e5c3353e8af594cb5eb6f3d728599f">fChannelMap</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// --- END ---- Services -----------------------------------------------------</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// --- BEGIN -- Cached values ------------------------------------------------</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">  /// Duration of the optical detector readout sampling tick (i.e. 2 ns; hush!).</span></div>
<div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adcb1a0b36ebf5b5d5e37cd6482855db1">  604</a></span>&#160;<span class="comment"></span>  <a class="code" href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">nanoseconds</a> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adcb1a0b36ebf5b5d5e37cd6482855db1">fOpticalTick</a>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">  /// Trigger time as reported by `detinfo::DetectorClocks` service.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0d8c1c9a9b236c52d18da6c7c81a1007">  607</a></span>&#160;<span class="comment"></span>  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <span class="keyword">const</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0d8c1c9a9b236c52d18da6c7c81a1007">fNominalTriggerTime</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// --- END ---- Cached values ------------------------------------------------</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// --- BEGIN -- Per-run data cache -------------------------------------------</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  /// Find the information on a readout boards by fragment ID.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a838c612581e7404dbeade49316a27008">  615</a></span>&#160;<span class="comment"></span>  std::optional&lt;daq::details::BoardInfoLookup&gt; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a838c612581e7404dbeade49316a27008">fBoardInfoLookup</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// --- END -- Per-run data cache ---------------------------------------------</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  </div>
<div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#af35094c69665f7fcb4313bed0f170476">  620</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fNFailures = 0U; <span class="comment">///&lt; Number of event failures encountered.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span>  </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">// --- BEGIN -- PMT readout configuration ------------------------------------</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">  /// Returns whether PMT configuration information is expected to be available.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a43ebc3efa6258a21dadcd811bb93b118">  626</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a43ebc3efa6258a21dadcd811bb93b118">hasPMTconfiguration</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> fPMTconfigTag.has_value(); }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">  /// Updates the PMT configuration cache. How? Dunno. Placeholder.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> UpdatePMTConfiguration(<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a> <span class="keyword">const</span>* PMTconfig);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">   * @brief Returns a lookup object with board setup and configuration info.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">   * @param PMTconfig the PMT configuration, if available</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">   * @return an object working like lookup table for all fragment information</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">   * This method merges the setup information from the tool configuration with</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">   * the PMT configuration specified in the argument, and returns an object</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">   * that can look up all the information as a single record, with the</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">   * fragment ID as key. In addition, a few intermediate quantities (&quot;facts&quot;,</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">   * see `BoardFacts_t`) are computed and stored in this object.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">   * If a fragment ID is missing, it means that no PMT configuration was</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">   * provided and that the setup information did not include a fragment ID.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">   * If some information (configuration or setup) is missing, the &quot;facts&quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">   * depending on the missing information will have default values.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html">daq::details::BoardInfoLookup</a> matchBoardConfigurationAndSetup</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    (<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a> <span class="keyword">const</span>* PMTconfig) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">  /// Puts together all the needed information for a board.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span>  NeededBoardInfo_t fetchNeededBoardInfo(</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html">daq::details::BoardInfoLookup::BoardInfo_t</a> <span class="keyword">const</span>* boardInfo,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fragmentID</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">  /// Extracts the Trigger Time Tag (31+1 bits) value from the fragment</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> extractTriggerTimeTag(artdaq::Fragment <span class="keyword">const</span>&amp; fragment);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">// --- END -- PMT readout configuration --------------------------------------</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">   * @brief Returns the count of set bits for each set bit.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">   * @tparam NBits the number of bits to test</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">   * @param value the bit mask to be analyzed</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">   * @return a pair: `first` an array with the `NBits` values,</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">   *         `second` the number of bits set</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">   * Much better to go with an example.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">   * Let&#39;s process `setBitIndices&lt;16U&gt;(0x6701)`: `value` is `0110 0111 0000 0001`,</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">   * and we request the `16` least significant bits (`NBits`).</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">   * There are six bit that are set, in position 0, 8, 9, 10, 13 and 14.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">   * The returned value includes the number of set bits (6) as the `second`</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">   * element of the pair, an as `first` an array of 16 indices, one for each bit</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">   * position.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">   * Its values are `0` at `[0]`, `1` at `[8]`, `2` at `[9]`, `3` at `[10]`,</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">   * `4` at `[13]` and `5` at `[14]`. That is, each value represents the number</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">   * of that bit in the list of set bits. All the other indices, associated to</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">   * the bits which are not set, are assigned a value that is equal or larger than</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">   * the number of bits set (i.e. `6` or larger).</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> NBits, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keyword">static</span> constexpr std::pair&lt;std::array&lt;std::size_t, NBits&gt;, std::size_t&gt;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    setBitIndices(T <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a>) noexcept;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// --- BEGIN -- Trees and their data ---------------------------------------</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  /// Data structure for basic event information in simple ROOT trees.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">  692</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">TreeData_EventID_t</a> {</div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a738f55fe8800a2d2ab7b8a40bd5fc6a6">  693</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a738f55fe8800a2d2ab7b8a40bd5fc6a6">run</a>;    <span class="comment">///&lt; Run number.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a70e9a468ad5cab7ef515cc1c5e6a34cb">  694</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a70e9a468ad5cab7ef515cc1c5e6a34cb">subrun</a>; <span class="comment">///&lt; Subrun number.</span></div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a021572fa40002ad48c0095d2efebfa7d">  695</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a021572fa40002ad48c0095d2efebfa7d">event</a>;  <span class="comment">///&lt; Event number.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a4ba8839722afb138b5954bff416fa3cd">  696</a></span>&#160;<span class="comment"></span>    <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a4ba8839722afb138b5954bff416fa3cd">timestamp</a>; <span class="comment">///&lt; Event timestamp (seconds from the epoch).</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span>  }; <span class="comment">// TreeData_EventID_t</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">  /// Structure collecting all data for a fragment ROOT tree.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html">  700</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html">TreeFragment_t</a> {</div>
<div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html">  701</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html">Data_t</a>: <span class="keyword">public</span> <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">TreeData_EventID_t</a> {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      </div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a146bf224165af2a2300950a345e63435">  703</a></span>&#160;      <span class="keywordtype">int</span> fragmentID = 0; <span class="comment">///&lt; ID of the fragment of this entry.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a70ad32e2c5248c9d80af45b0479e67e6">  705</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fragCount = 0U; <span class="comment">///&lt; Counter of the fragment in the board.</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span>      <span class="comment"></span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">      ///&lt; Trigger time tag from the fragment.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a7031377db3bbfd22074293cdd6fed80a">  708</a></span>&#160;<span class="comment"></span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> TriggerTimeTag = 0;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      </div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a12872da021fd8cc906eb5bfb8219fa10">  710</a></span>&#160;      <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> <a class="code" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a12872da021fd8cc906eb5bfb8219fa10">trigger</a>; <span class="comment">///&lt; Global trigger time.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a3c8b05583035ea5eff49e4a2c53940d3">  712</a></span>&#160;      <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> <a class="code" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a3c8b05583035ea5eff49e4a2c53940d3">fragTime</a>; <span class="comment">///&lt; PMT fragment time stamp.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a61496d3d3fa104ba68e5e0f83ba72f1f">  714</a></span>&#160;      <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a61496d3d3fa104ba68e5e0f83ba72f1f">relBeamGate</a>; <span class="comment">///&lt; Beam gate start relative to trigger [ns].</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span>      <span class="comment"></span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">      /// Time assigned to the waveforms.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a98d4f6b16ac3b613ca2eb9a59c1c6114">  717</a></span>&#160;<span class="comment"></span>      <span class="keywordtype">double</span> waveformTime = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      </div>
<div class="line"><a name="l00719"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a497bd18624c4c1ccd860b6e86e5c4a86">  719</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> waveformSize = 0U; <span class="comment">///&lt; Ticks in the waveforms.</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#ae5785deceaaa62581d2071f5269de995">  721</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triggerBits = 0x0; <span class="comment">///&lt; Trigger bits, from `raw::Trigger`.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a49e51f7d1b7a595ffd5d28dae65ba814">  723</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gateCount = 0U; <span class="comment">///&lt; The number of gate from run start.</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"></span>      <span class="comment"></span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">      ///&lt; Whether waveforms cover nominal trigger time.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#acdfcb8cdce5431e4c66cc01e86ca9512">  726</a></span>&#160;<span class="comment"></span>      <span class="keywordtype">bool</span> onGlobalTrigger = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }; <span class="comment">// Data_t</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    </div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html#a217ade83103e1bf78048e7d5d9e1acae">  731</a></span>&#160;    <a class="code" href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html">Data_t</a> <a class="code" href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html#a217ade83103e1bf78048e7d5d9e1acae">data</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno"><a class="line" href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html#a5b155fed7abf525fb1960f7386a4ff8a">  732</a></span>&#160;    TTree* tree = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  }; <span class="comment">// TreeFragment_t</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  </div>
<div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a656b71c0e6caa8d3babf5ac75921e402">  736</a></span>&#160;  std::unique_ptr&lt;TreeData_EventID_t&gt; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a656b71c0e6caa8d3babf5ac75921e402">fEventInfo</a>; <span class="comment">///&lt; Event ID for trees.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"></span>  <span class="comment"></span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">  ///&lt; Tree with fragment information.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a9187d1056776e4469e810f44c6c8832e">  739</a></span>&#160;<span class="comment"></span>  std::unique_ptr&lt;TreeFragment_t&gt; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a9187d1056776e4469e810f44c6c8832e">fTreeFragment</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// --- END ---- Trees and their data -----------------------------------------</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// --- BEGIN -- Timestamps ---------------------------------------------------</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">  /// Retrieves the global trigger time stamp from the event.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"></span>  <a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">TriggerInfo_t</a> fetchTriggerTimestamp(art::Event <span class="keyword">const</span>&amp; event) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">  /// Returns the timestamp for the waveforms in the specified fragment.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"></span>  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> fragmentWaveformTimestamp(</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> triggerTime</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">   * @brief Returns the timestamp for the waveforms in the specified fragment.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">   * This method assumes that all PMT readout board triggers happened at the</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">   * same time as the global trigger.</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">   * Unsurprisingly, this does not work well with multiple PMT windows.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> fragmentWaveformTimestampOnTrigger(</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> triggerTime</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">   * @brief Returns the timestamp for the waveforms in the specified fragment.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">   * This method assumes that the Trigger Time Tag counters are synchronised</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">   * with the global trigger and their value is reset on each new second of </span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">   * the global trigger timescale (International Atomic Time).</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">   * This assumptions enables timestamping of waveforms from the same readout</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">   * boards at different times (&quot;multi-window PMT readout&quot;).</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">   * See `TTTresetEverySecond` configuration option.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> fragmentWaveformTimestampFromTTT(</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">SplitTimestamp_t</a> triggerTime</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">  /// Returns the timestamp difference `a - b`.</span></div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad7a058835202a95cca537b3c97ca3b81">  789</a></span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad7a058835202a95cca537b3c97ca3b81">timestampDiff</a>(std::uint64_t <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>, std::uint64_t b)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>) - static_cast&lt;long long int&gt;(b); }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">  /// Returns the fragment ID to be used with databases.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> constexpr std::size_t effectivePMTboardFragmentID</div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abcad1d6e5899ac5f0fd9cb9fe470a90b">  795</a></span>&#160;    (artdaq::Fragment::fragment_id_t <span class="keywordtype">id</span>)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    { <span class="keywordflow">return</span> <span class="keywordtype">id</span> &amp; 0x0fff; }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// --- END ---- Timestamps ---------------------------------------------------</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// --- BEGIN -- Input data management ----------------------------------------</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">  /// Reads the fragments to be processed.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"></span>  artdaq::Fragments <span class="keyword">const</span>&amp; readInputFragments(art::Event <span class="keyword">const</span>&amp; event) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">  /// Throws an exception if `artdaqFragment` is not of type `CAEN1730`.</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> checkFragmentType(artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">  /// Converts a fragment into a fragment collection</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">  /// (dispatcher based on fragment type).</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"></span>  artdaq::FragmentPtrs makeFragmentCollection</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">  /// Converts a plain fragment into a fragment collection.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"></span>  artdaq::FragmentPtrs makeFragmentCollectionFromFragment</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">  /// Converts a container fragment into a fragment collection.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span>  artdaq::FragmentPtrs makeFragmentCollectionFromContainerFragment</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">  /// Extracts waveforms from the specified fragments from a board.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span>  std::vector&lt;raw::OpDetWaveform&gt; processBoardFragments(</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    artdaq::FragmentPtrs <span class="keyword">const</span>&amp; artdaqFragment,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    TriggerInfo_t <span class="keyword">const</span>&amp; triggerInfo</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    );</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// --- END ---- Input data management ----------------------------------------</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">// --- BEGIN -- Output waveforms ---------------------------------------------</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">  /// Merges &quot;in place&quot; `waveforms` based on timestamp.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">  /// @return the number of original waveforms merged into another</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mergeWaveforms(std::vector&lt;raw::OpDetWaveform&gt;&amp; waveforms) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">  /// Sorts in place the specified waveforms in channel order, then in time.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> sortWaveforms(std::vector&lt;raw::OpDetWaveform&gt;&amp; waveforms) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">  /// Returns pointers to all waveforms including the nominal trigger time.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"></span>  std::vector&lt;raw::OpDetWaveform const*&gt; findWaveformsWithNominalTrigger</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    (std::vector&lt;raw::OpDetWaveform&gt; <span class="keyword">const</span>&amp; waveforms) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">  /// Returns whether `waveform` includes the tick of the nominal trigger time.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> containsGlobalTrigger(<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; waveform) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">  /// Returns whether nominal trigger time is within `nTicks` from `time`.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> containsGlobalTrigger(<a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> time, std::size_t nTicks) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">  /// Returns a waveform merging of the `indices` ones from `allWaveforms`.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">  /// The merged waveforms are emptied of their content.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"></span>  <a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> mergeWaveformGroup(</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    std::vector&lt;raw::OpDetWaveform&gt;&amp; allWaveforms,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    std::vector&lt;std::size_t&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a81b45a59e7128f35719a7ba55a0f8370">indices</a></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a826bf5e4aa740023711cffc7f79247a0">  857</a></span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a826bf5e4aa740023711cffc7f79247a0">waveformStartTime</a>(<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; wf)<span class="keyword"> const</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a>{ wf.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a12a5306398b04085c936ced39e16f192">TimeStamp</a>() }; }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab4515084300ae5c65747a4db8eb9f454">  860</a></span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab4515084300ae5c65747a4db8eb9f454">waveformEndTime</a>(<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; wf)<span class="keyword"> const</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> waveformStartTime(wf) + <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a> * wf.size(); }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">// --- END ---- Output waveforms ---------------------------------------------</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  </div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adad2adc662a6b754d91bbc973d56bff1">  865</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adad2adc662a6b754d91bbc973d56bff1">BoardID_t</a> = <span class="keywordtype">short</span> int; <span class="comment">///&lt; Type used internally to represent board ID.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"></span>  </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">   * @brief Create waveforms and fills trees for the specified artDAQ fragment.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">   * @param artdaqFragment the fragment to process</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">   * @param boardInfo board information needed, from configuration/setup</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">   * @param triggerTime absolute time of the trigger</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">   * @return collection of PMT waveforms from the fragment</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">   * This method fills the information for the PMT fragment tree</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">   * (`fillPMTfragmentTree()`) and creates PMT waveforms from the fragment data</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">   * (`createFragmentWaveforms()`).</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; processFragment(</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">TriggerInfo_t</a> <span class="keyword">const</span>&amp; triggerInfo</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    );</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">  /**</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">   * @brief Creates `raw::OpDetWaveform` objects from the fragment data.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">   * @param fragInfo information extracted from the fragment</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">   * @param timeStamp timestamp of the waveforms in the fragment</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">   * @return collection of newly created `raw::OpDetWaveform`</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">   * All fragment information needed is enclosed in `fragInfo`</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">   * (`extractFragmentInfo()`). The timestamp can be obtained with a call to</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">   * `fragmentWaveformTimestamp()`.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; createFragmentWaveforms</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    (<a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> <span class="keyword">const</span>&amp; fragInfo, <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <span class="keyword">const</span> timeStamp) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">  /// Extracts useful information from fragment data.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"></span>  <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> extractFragmentInfo</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    (artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">  /// Extracts the fragment ID (i.e. board ID) from the specified `fragment`.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adad2adc662a6b754d91bbc973d56bff1">BoardID_t</a> extractFragmentBoardID(artdaq::Fragment <span class="keyword">const</span>&amp; fragment);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">  /// Returns the board information for this fragment.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"></span>  <a class="code" href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">NeededBoardInfo_t</a> neededBoardInfo</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    (artdaq::Fragment::fragment_id_t fragment_id) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">// --- BEGIN -- Tree-related methods -----------------------------------------</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">  /// Declares the use of event information.</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> usesEventInfo();</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">  /// Initializes all requested data trees.</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> initTrees(std::vector&lt;std::string&gt; <span class="keyword">const</span>&amp; treeNames);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">  /// Initializes the event ID part of a tree.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> initEventIDtree(TTree&amp; tree, <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">TreeData_EventID_t</a>&amp; data);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">  /// Initializes the fragment data tree (`fTreeFragment`).</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> initFragmentsTree();</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">  /// Fills the base information of a tree data entry from an _art_ event.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> fillTreeEventID</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    (art::Event <span class="keyword">const</span>&amp; event, <a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">TreeData_EventID_t</a>&amp; treeData) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">  /// Assigns the cached event information to the specified tree data.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> assignEventInfo(<a class="code" href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">TreeData_EventID_t</a>&amp; treeData) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">  /// Fills the PMT fragment tree with the specified information</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">  /// (additional information needs to have been set already).</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> fillPMTfragmentTree(</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">FragmentInfo_t</a> <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">TriggerInfo_t</a> <span class="keyword">const</span>&amp; triggerInfo,</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> waveformTimestamp</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    );</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">  /// Returns the name of the specified tree.</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> std::string <span class="keyword">const</span>&amp; treeName(<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac77b2241f3748694113a37725ba99f47">DataTrees</a> treeID);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">  /// Static initialization.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0ead396e4ef1ce58cedf14a3c12f2055">TreeNameList_t</a> initTreeNames();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// --- END ---- Tree-related methods -----------------------------------------</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}; <span class="comment">// icarus::DaqDecoderICARUSPMT</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">// --- implementation</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">  /// Moves the contend of `src` into the end of `dest`.</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  std::vector&lt;T&gt;&amp; appendTo(std::vector&lt;T&gt;&amp; dest, std::vector&lt;T&gt;&amp;&amp; src) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (dest.empty()) dest = std::move(src);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      dest.reserve(dest.size() + src.size());</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      std::move(src.begin(), src.end(), std::back_inserter(dest));</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    src.clear();</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">return</span> dest;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  } <span class="comment">// appendTo()</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">  /// Returns whether an element `value` is found in `coll`.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Coll, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordtype">bool</span> contains(Coll <span class="keyword">const</span>&amp; coll, T <span class="keyword">const</span>&amp; <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a>) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga4288f30cfde6d98d0f8faf9a386f86d0">cend</a> = <a class="code" href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#gaa1d0cd0cbac37bc1ca4c84daf5343973">end</a>(coll);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">return</span> std::find(<a class="code" href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga624a6c8d8a7c2d3746a644f8cc1c1efe">begin</a>(coll), <a class="code" href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga4288f30cfde6d98d0f8faf9a386f86d0">cend</a>, value) != <a class="code" href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga4288f30cfde6d98d0f8faf9a386f86d0">cend</a>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  } <span class="comment">// contains()</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;} <span class="comment">// local namespace</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keyword">namespace </span>icarus {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">  /// Special function `fhicl::TableAs` uses to convert BoardSetupConfig.</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span>  <a class="code" href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html">daq::details::BoardSetup_t</a> <a class="code" href="../../da/d4d/namespaceicarus.html#a4949202c39928a2a4840f75ae371bfcf">convert</a></div>
<div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="../../da/d4d/namespaceicarus.html#a4949202c39928a2a4840f75ae371bfcf">  985</a></span>&#160;    (<a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html">DaqDecoderICARUSPMT::BoardSetupConfig</a> <span class="keyword">const</span>&amp; config)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">using ::util::fhicl::getOptionalValue</a>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span> {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        config.<a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a9c25e7795e8df92705f9b433e1c74c66">Name</a>()                                          <span class="comment">// name</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      , <a class="code" href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">getOptionalValue</a>(config.<a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a475612a63ecc9041269c3bde7f291935">FragmentID</a>) </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;          .value_or(<a class="code" href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html#a85d5c5b8ec289b33b00092a22c3946a0">daq::details::BoardSetup_t::NoFragmentID</a>)  <span class="comment">// fragmentID</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      , config.<a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a8ead9416959f5606724e4d2815fb0583">TriggerDelay</a>()                                  <span class="comment">// triggerDelay</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      , config.<a class="code" href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a2ec2c73c5e5163e23cb373e389329f78">TTTresetDelay</a>()                                 <span class="comment">// TTTresetDelay</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      };</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  } <span class="comment">// convert(BoardSetupConfig)</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;} <span class="comment">// namespace icarus</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">// --- icarus::DaqDecoderICARUSPMT::SplitTimestamp_t</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;constexpr <a class="code" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#a3d23db0937ae5bbb8f930c711f9320bf">icarus::DaqDecoderICARUSPMT::SplitTimestamp_t::SplitTimestamp_t</a></div>
<div class="line"><a name="l01005"></a><span class="lineno"><a class="line" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#ab6a31ac7030c15d20608443cc2475935"> 1005</a></span>&#160;  (<span class="keywordtype">int</span> sec, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ns)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  : time { <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(sec) * 1<span class="stringliteral">&#39;000&#39;</span>000<span class="stringliteral">&#39;000LL + ns }</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral">  , split { sec, ns }</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">{}</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">constexpr icarus::DaqDecoderICARUSPMT::SplitTimestamp_t::SplitTimestamp_t</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"><a class="line" href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#a3133bca9468e6ce830ef87a4bb201f01"> 1013</a></span>&#160;<span class="stringliteral">  (long long int triggerTime)</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral">  : time { triggerTime }</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="stringliteral">  , split {</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral">      static_cast&lt;int&gt;(time / 1&#39;</span>000<span class="stringliteral">&#39;000&#39;</span>000), <span class="comment">// seconds</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(time % 1<span class="stringliteral">&#39;000&#39;</span>000<span class="stringliteral">&#39;000) // nanoseconds</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="stringliteral">{}</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">namespace icarus {</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral">  std::ostream&amp; operator&lt;&lt;</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"><a class="line" href="../../da/d4d/namespaceicarus.html#aaccb36c60e159d4d41fe3a587dfadb6b"> 1026</a></span>&#160;<span class="stringliteral">    (std::ostream&amp; out, DaqDecoderICARUSPMT::SplitTimestamp_t const&amp; time)</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral">    out &lt;&lt; time.split.seconds &lt;&lt; &#39;</span>.<span class="stringliteral">&#39;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">      &lt;&lt; std::setfill(&#39;</span>0<span class="stringliteral">&#39;) &lt;&lt; std::setw(9) &lt;&lt; time.split.nanoseconds;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral">    return out;</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral">  } // operator&lt;&lt; (std::ostream&amp;, PMTDecoder::SplitTimestamp_t)</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral">} // namespace icarus</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">// --- icarus::DaqDecoderICARUSPMT</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral">// --- template implementation</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">template &lt;std::size_t NBits, typename T&gt;</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">constexpr std::pair&lt;std::array&lt;std::size_t, NBits&gt;, std::size_t&gt;</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6bb239e072cdba0865c98abdffe47f32"> 1043</a></span>&#160;<span class="stringliteral">icarus::DaqDecoderICARUSPMT::setBitIndices(T value) noexcept {</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">  std::pair&lt;std::array&lt;std::size_t, NBits&gt;, std::size_t&gt; res;</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">  auto&amp; [ indices, nSetBits ] = res;</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">  for (std::size_t&amp; index: indices) {</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral">    index = (value &amp; 1)? nSetBits++: NBits;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">    value &gt;&gt;= 1;</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">  } // for</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">  return res;</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">} // icarus::DaqDecoderICARUSPMT::setBitIndices()</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral">icarus::DaqDecoderICARUSPMT::TreeNameList_t const</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral">icarus::DaqDecoderICARUSPMT::TreeNames</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral">  = icarus::DaqDecoderICARUSPMT::initTreeNames();</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a26ee2cc42a6e3b05e1d4882e5b5da2c6"> 1061</a></span>&#160;<span class="stringliteral">auto icarus::DaqDecoderICARUSPMT::initTreeNames() -&gt; TreeNameList_t {</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">  TreeNameList_t names;</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">  names[static_cast&lt;std::size_t&gt;(DataTrees::Fragments)] = &quot;PMTfragments&quot;;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">  return names;</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">} // icarus::DaqDecoderICARUSPMT::initTreeNames()</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adb96383ae278c2dc166f2cecd804ce54"> 1069</a></span>&#160;<span class="stringliteral">std::string const&amp; icarus::DaqDecoderICARUSPMT::treeName(DataTrees treeID)</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">  { return TreeNames[static_cast&lt;std::size_t&gt;(treeID)]; }</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral">std::string icarus::DaqDecoderICARUSPMT::listTreeNames</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abd4d4fa9b67d5ec7c7756a74863c8ba7"> 1075</a></span>&#160;<span class="stringliteral">  (std::string const&amp; sep /* = &quot; &quot; */)</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral">  std::string l;</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral">  for (std::string const&amp; name: TreeNames) {</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral">    if (!l.empty()) l += sep;</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">    l += &#39;</span>\<span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    l += <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    l += <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  } <span class="comment">// for</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">return</span> l;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::listTreeNames()</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"><a class="line" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adb8b4225d29c0acd40125afa0f72ed13"> 1089</a></span>&#160;<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adb8b4225d29c0acd40125afa0f72ed13">icarus::DaqDecoderICARUSPMT::DaqDecoderICARUSPMT</a>(<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a135c6ee981d13b84cda2ad24b0265f86">Parameters</a> <span class="keyword">const</span>&amp; params)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  : art::EDProducer(params)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  , fInputTags{ params().FragmentsLabels() }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  , fSurviveExceptions{ params().SurviveExceptions() }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  , fDiagnosticOutput{ params().DiagnosticOutput() }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  , fPacketDump{ params().PacketDump() }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  , fRequireKnownBoards{ params().RequireKnownBoards() }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  , fRequireBoardConfig{ params().RequireBoardConfig() }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  , fPMTconfigTag{ <a class="code" href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">::util::fhicl::getOptionalValue</a>(params().PMTconfigTag) }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  , fTriggerTag{ <a class="code" href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">::util::fhicl::getOptionalValue</a>(params().TriggerTag) }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  , fTTTresetEverySecond{</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">::util::fhicl::getOptionalValue</a>(params().TTTresetEverySecond)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      .value_or(fTriggerTag.has_value())</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  , fBoardSetup{ params().BoardSetup() }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  , <a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>{ params().LogCategory() }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  , fDetTimings</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    { art::ServiceHandle&lt;detinfo::DetectorClocksService const&gt;()-&gt;DataForJob() }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  , fChannelMap{ *(art::ServiceHandle&lt;icarusDB::IICARUSChannelMap const&gt;{}) }</div>
<div class="line"><a name="l01108"></a><span class="lineno"><a class="line" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f"> 1108</a></span>&#160;  , <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a>{ fDetTimings.OpticalClockPeriod() }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  , fNominalTriggerTime{ fDetTimings.TriggerTime() }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">// consumed data products declaration</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">for</span> (art::InputTag <span class="keyword">const</span>&amp; inputTag: fInputTags)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    consumes&lt;artdaq::Fragments&gt;(inputTag);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">if</span> (fPMTconfigTag) consumes&lt;sbn::PMTconfiguration&gt;(*fPMTconfigTag);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">if</span> (fTriggerTag) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    consumes&lt;std::vector&lt;sbn::ExtraTriggerInfo&gt;&gt;(*fTriggerTag);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (contains(params().DataTrees(), treeName(DataTrees::Fragments)))</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      consumes&lt;std::vector&lt;raw::Trigger&gt;&gt;(*fTriggerTag);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  } <span class="comment">// if trigger</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="comment">// produced data products declaration</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  produces&lt;std::vector&lt;raw::OpDetWaveform&gt;&gt;();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="comment">// additional initialization</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  initTrees(params().DataTrees());</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// configuration dump</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  mf::LogInfo log(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  log &lt;&lt; <span class="stringliteral">&quot;Configuration:&quot;</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n * data from one of &quot;</span> &lt;&lt; fInputTags.size() &lt;&lt; <span class="stringliteral">&quot; data products:&quot;</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">for</span> (art::InputTag <span class="keyword">const</span>&amp; inputTag: fInputTags)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot; &#39;&quot;</span> &lt;&lt; inputTag.encode() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  log</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n * boards with setup: &quot;</span> &lt;&lt; fBoardSetup.size();</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">if</span> (fPMTconfigTag)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * PMT configuration from &#39;&quot;</span> &lt;&lt; fPMTconfigTag-&gt;encode() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">else</span> </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * PMT configuration not used (and some corrections will be skipped)&quot;</span>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span> (fTriggerTag)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * trigger information from: &#39;&quot;</span> &lt;&lt; fTriggerTag-&gt;encode() &lt;&lt; <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * trigger time from event timestamp [fallback]&quot;</span>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">if</span> (fRequireKnownBoards) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * all readout boards in input must be known (from `&quot;</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      &lt;&lt; params().BoardSetup.name() &lt;&lt; <span class="stringliteral">&quot;` or `&quot;</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      &lt;&lt; params().PMTconfigTag.name() &lt;&lt; <span class="stringliteral">&quot;`)&quot;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      ;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * readout boards with no information (from neither `&quot;</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      &lt;&lt; params().BoardSetup.name() &lt;&lt; <span class="stringliteral">&quot;` or `&quot;</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      &lt;&lt; params().PMTconfigTag.name()</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;`) are processed at the best we can (skipping corrections)&quot;</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      ;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span> (fRequireBoardConfig) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * all readout boards in `&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      &lt;&lt; params().BoardSetup.name()</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;` must appear in the PMT configuration from `&quot;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      &lt;&lt; params().PMTconfigTag.name() &lt;&lt; <span class="stringliteral">&quot;`&quot;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      ;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n * all readout boards in `&quot;</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      &lt;&lt; params().BoardSetup.name()</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;` may lack a matching PMT configuration from `&quot;</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      &lt;&lt; params().PMTconfigTag.name() &lt;&lt; <span class="stringliteral">&quot;`&quot;</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      ;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="comment">// sanity checks</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">if</span> (fChannelMap.nPMTfragmentIDs() == 0) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Channel mapping database does not report any PMT fragment ID!\n&quot;</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  } <span class="comment">// if no PMT in database</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::DaqDecoderICARUSPMT()</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6ce17c24e859ea0eef5ab6b9d17305f7">icarus::DaqDecoderICARUSPMT::beginRun</a>(art::Run&amp; run) {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">//sbn::PMTconfiguration const* PMTconfig = fPMTconfigTag</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">//  ? run.getPointerByLabel&lt;sbn::PMTconfiguration&gt;(*fPMTconfigTag): nullptr;</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a> <span class="keyword">const</span>* PMTconfig = fPMTconfigTag</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    ? run.getHandle&lt;<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a>&gt;(*fPMTconfigTag).product(): <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  UpdatePMTConfiguration(PMTconfig);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::beginRun()</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ae787bc4b86f2a6cdc478df20d233b604">icarus::DaqDecoderICARUSPMT::produce</a>(art::Event&amp; event) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// preparation</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="comment">// global trigger</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  TriggerInfo_t <span class="keyword">const</span> triggerInfo = fetchTriggerTimestamp(event);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    mf::LogDebug log { <a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a> };</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">if</span> (fTriggerTag)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot;Trigger time (&#39;&quot;</span> &lt;&lt; fTriggerTag-&gt;encode() &lt;&lt; <span class="stringliteral">&quot;&#39;): &quot;</span>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot;Trigger from event timestamp: &quot;</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    log &lt;&lt; triggerInfo.time &lt;&lt; <span class="stringliteral">&quot; s, bits: &quot;</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        &lt;&lt; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">icarus::ns::util::bin</a>(triggerInfo.bits);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">if</span> (triggerInfo.bits) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot; {&quot;</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">for</span> (std::string <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        : sbn::bits::names&lt;sbn::triggerSource&gt;(triggerInfo.bits))</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        log &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot; }&quot;</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    } <span class="comment">// if</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordflow">if</span> (fTriggerTag) log &lt;&lt; <span class="stringliteral">&quot;, spill count: &quot;</span> &lt;&lt; triggerInfo.gateCount;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  } <span class="comment">// local block</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">// event ID</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">// if needed, fill the record with the basic information of the event</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">if</span> (fEventInfo) fillTreeEventID(event, *fEventInfo);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// output data product initialization</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; opDetWaveforms;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">// pre-processing</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="comment">// processing</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  std::unordered_map&lt;BoardID_t, unsigned int&gt; boardCounts;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordtype">bool</span> duplicateBoards = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordflow">try</span> { <span class="comment">// catch-all</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; fragments = readInputFragments(event);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">for</span> (artdaq::Fragment <span class="keyword">const</span>&amp; fragment: fragments) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      artdaq::FragmentPtrs <span class="keyword">const</span>&amp; fragmentCollection</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        = makeFragmentCollection(fragment);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>(fragmentCollection)) {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        mf::LogWarning(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Found a data fragment (ID=&quot;</span> &lt;&lt; extractFragmentBoardID(fragment)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;) containing no data.&quot;</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      } <span class="comment">// if no data</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      BoardID_t <span class="keyword">const</span> boardID</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        = extractFragmentBoardID(*(fragmentCollection.front()));</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">if</span> (++boardCounts[boardID] &gt; 1U) duplicateBoards = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      appendTo(</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        opDetWaveforms,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        processBoardFragments(fragmentCollection, triggerInfo)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        );</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    } <span class="comment">// for all input fragments</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="keywordflow">catch</span> (cet::exception <span class="keyword">const</span>&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (!fSurviveExceptions) <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    mf::LogError(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Error while attempting to decode PMT data:\n&quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    opDetWaveforms.clear();</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    ++fNFailures;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> (!fSurviveExceptions) <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    mf::LogError(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Error while attempting to decode PMT data.\n&quot;</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    opDetWaveforms.clear();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    ++fNFailures;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (duplicateBoards) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    mf::LogWarning log { <span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span> };</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;found multiple data product entries for the same board:&quot;</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> [ boardID, <a class="code" href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a> ]: boardCounts) {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a> &lt; 2U) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::hex &lt;&lt; boardID &lt;&lt; std::dec &lt;&lt; <span class="stringliteral">&quot; (x&quot;</span> &lt;&lt; <a class="code" href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a> &lt;&lt; <span class="stringliteral">&quot;);&quot;</span>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  } <span class="comment">// if duplicate board fragments</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// post-processing</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  sortWaveforms(opDetWaveforms);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  std::vector&lt;raw::OpDetWaveform const*&gt; waveformsWithTrigger</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    = findWaveformsWithNominalTrigger(opDetWaveforms);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>) &lt;&lt; waveformsWithTrigger.size() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    &lt;&lt; opDetWaveforms.size() &lt;&lt; <span class="stringliteral">&quot; decoded waveforms include trigger time (&quot;</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    &lt;&lt; fNominalTriggerTime &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// output</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keyword">event</span>.put(</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    std::make_unique&lt;std::vector&lt;raw::OpDetWaveform&gt;&gt;(std::move(opDetWaveforms))</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::produce()</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aff651d2ec32b3218f16546ecc536ed94">icarus::DaqDecoderICARUSPMT::endJob</a>() {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">if</span> (fNFailures &gt; 0U) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    mf::LogError(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>) &lt;&lt; <span class="stringliteral">&quot;Encountered errors on &quot;</span> &lt;&lt; fNFailures</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; events. Errors were ignored.&quot;</span>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::endJob()</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;artdaq::Fragments <span class="keyword">const</span>&amp; <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad75ddf2ccb56140f08b197abb6ce1825">icarus::DaqDecoderICARUSPMT::readInputFragments</a></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  (art::Event <span class="keyword">const</span>&amp; event)<span class="keyword"> const</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  art::Handle&lt;artdaq::Fragments&gt; handle;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  art::InputTag selectedInputTag; <span class="comment">// empty</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordflow">for</span> (art::InputTag <span class="keyword">const</span>&amp; inputTag: fInputTags) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;DaqDecoderICARUSPMT trying data product: &#39;&quot;</span> &lt;&lt; inputTag.encode()</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    art::Handle&lt;artdaq::Fragments&gt; thisHandle;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span> (!event.getByLabel&lt;artdaq::Fragments&gt;(inputTag, thisHandle)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (!thisHandle.isValid() || thisHandle-&gt;empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  =&gt; data product: &#39;&quot;</span> &lt;&lt; inputTag.encode() &lt;&lt; <span class="stringliteral">&quot;&#39; is present and has &quot;</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      &lt;&lt; thisHandle-&gt;size() &lt;&lt; <span class="stringliteral">&quot; entries&quot;</span>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (!selectedInputTag.empty()) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Found multiple suitable input candidates: &#39;&quot;</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        &lt;&lt; inputTag.encode() &lt;&lt; <span class="stringliteral">&quot;&#39; and &#39;&quot;</span> &lt;&lt; selectedInputTag &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    selectedInputTag = inputTag;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    handle = thisHandle;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  } <span class="comment">// for</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">if</span> (!handle.isValid()) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    cet::exception e { <span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span> };</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    e &lt;&lt; <span class="stringliteral">&quot;No suitable input data product found among:&quot;</span>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">for</span> (art::InputTag <span class="keyword">const</span>&amp; inputTag: fInputTags)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      e &lt;&lt; <span class="stringliteral">&quot; &#39;&quot;</span> &lt;&lt; inputTag.encode() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordflow">throw</span> e &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keywordflow">return</span> *handle;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::readInputFragments()</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;std::vector&lt;raw::OpDetWaveform const*&gt;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#af5e7a608a4167b338f51929d63f70ff7">icarus::DaqDecoderICARUSPMT::findWaveformsWithNominalTrigger</a></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  (std::vector&lt;raw::OpDetWaveform&gt; <span class="keyword">const</span>&amp; waveforms)<span class="keyword"> const</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  std::vector&lt;raw::OpDetWaveform const*&gt; matchedWaveforms;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; waveform: waveforms) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">if</span> (!containsGlobalTrigger(waveform)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    matchedWaveforms.push_back(&amp;waveform);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  } <span class="comment">// for</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="keywordflow">return</span> matchedWaveforms;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::findWaveformsWithNominalTrigger()</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a94306ec50a954ef985926738a381dec9">icarus::DaqDecoderICARUSPMT::containsGlobalTrigger</a></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  (<a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> time, std::size_t nTicks)<span class="keyword"> const</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">return</span> (fNominalTriggerTime &gt;= time)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    &amp;&amp; (fNominalTriggerTime &lt; time + nTicks * <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::containsGlobalTrigger(time, ticks)</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a94306ec50a954ef985926738a381dec9">icarus::DaqDecoderICARUSPMT::containsGlobalTrigger</a></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  (<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; waveform)<span class="keyword"> const</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">return</span> containsGlobalTrigger</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    (<a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a>{ waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a12a5306398b04085c936ced39e16f192">TimeStamp</a>() }, waveform.size());</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::containsGlobalTrigger(waveform)</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aa213442764bfc065bdc197b03fbcd7fb">icarus::DaqDecoderICARUSPMT::UpdatePMTConfiguration</a></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  (<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a> <span class="keyword">const</span>* PMTconfig)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;{</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  fBoardInfoLookup.emplace(matchBoardConfigurationAndSetup(PMTconfig));</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  mf::LogDebug(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Board information as cached:\n&quot;</span> &lt;&lt; *fBoardInfoLookup;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::UpdatePMTConfiguration()</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a3b67329b1814a67bc9ad3d6b3ef87ed8">icarus::DaqDecoderICARUSPMT::matchBoardConfigurationAndSetup</a></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  (<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a> <span class="keyword">const</span>* PMTconfig) <span class="keyword">const</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  -&gt; <a class="code" href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html">daq::details::BoardInfoLookup</a></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;{</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">   * We need to support the case where no PMT configuration is known</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">   * (that is the standard situation in the online monitor).</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">   * The &quot;strategy&quot; is that in such cases we give up the correct time stamp</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">   * decoding; if the setup information contains a fragment ID, it may be</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">   * possible to do a little better, that is to use the setup information</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">   * (this is not possible without knowing the fragment ID that each bit of</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">   * setup information pertains).</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">   * So the cases for a board are:</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">   * * setup information is not present: encountering such a board will cause</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">   *   an exception to be thrown (implemented elsewhere)</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">   * * PMT configuration and setup present: full configuration</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">   *     * exception thrown if setup fragment ID is present and inconsistent</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">   * * PMT configuration not present: a general warning is printed;</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">   *     * boards with setup fragment ID information: add setup information</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">   *       to the &quot;database&quot; for the board: it will be used for partial</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">   *       timestamp reconstruction</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">   *     * boards without setup fragment ID information: board will not be</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">   *       added into the database; no specific correction will be performed;</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">   *       a warning is printed for each board</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">// dictionary of board configurations (if any)</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  std::vector&lt;std::pair&lt;std::string, sbn::V1730Configuration const*&gt;&gt;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    configByName;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">if</span> (PMTconfig) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (!PMTconfig-&gt;<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html#ad421729a1e29bf061192b19a51213f54">boards</a>.empty())</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      configByName.reserve(PMTconfig-&gt;<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html#ad421729a1e29bf061192b19a51213f54">boards</a>.size());</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html">sbn::V1730Configuration</a> <span class="keyword">const</span>&amp; boardConfig: PMTconfig-&gt;<a class="code" href="../../d4/d46/structsbn_1_1PMTconfiguration.html#ad421729a1e29bf061192b19a51213f54">boards</a>)</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      configByName.emplace_back(boardConfig.<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#afe97e722dd925a04f049c6b2e6113372">boardName</a>, &amp;boardConfig);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    std::sort(configByName.begin(), configByName.end()); <span class="comment">// sorted by board name</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  } <span class="comment">// if we have configuration</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="keyword">auto</span> findPMTconfig = [<span class="keyword">this</span>, &amp;configByName]</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    (std::string <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>) -&gt; <a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html">sbn::V1730Configuration</a> <span class="keyword">const</span>*</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">if</span> (!hasPMTconfiguration()) <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>* ppBoardConfig</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        = <a class="code" href="../../da/db1/namespacedaq_1_1details.html#a4ea2b5b7f772d9564fceb250f6cc6255">daq::details::binarySearch</a>(configByName, <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="keywordflow">if</span> (!ppBoardConfig) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordflow">if</span> (!fRequireBoardConfig) <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;No DAQ configuration found for PMT readout board &#39;&quot;</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          &lt;&lt; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If this is expected, you may skip this check by setting &quot;</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;PMTDecoder tool configuration `RequireBoardConfig` to `false`.\n&quot;</span>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keywordflow">return</span> ppBoardConfig-&gt;second;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }; <span class="comment">// findPMTconfig()</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// the filling is driven by boards configured in the tool</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// (which is how a setup entry is mandatory)</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <a class="code" href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html#a4782907bf07f9600e16310d8d73ac17c">daq::details::BoardInfoLookup::Database_t</a> boardInfoByFragment;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html">daq::details::BoardSetup_t</a> <span class="keyword">const</span>&amp; boardSetup: fBoardSetup) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    std::string <span class="keyword">const</span>&amp; boardName = boardSetup.name;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html">sbn::V1730Configuration</a> <span class="keyword">const</span>* pBoardConfig = findPMTconfig(boardName);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (pBoardConfig) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="comment">// fragment ID from configuration and setup must match if both present</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordflow">if</span> (boardSetup.hasFragmentID()</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        &amp;&amp; (boardSetup.fragmentID != pBoardConfig-&gt;<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#a294d44ef7389cd6a6ee87b81619775fb">fragmentID</a>)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      ) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Board &#39;&quot;</span> &lt;&lt; boardName &lt;&lt; <span class="stringliteral">&quot;&#39; has fragment ID &quot;</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;          &lt;&lt; std::hex &lt;&lt; pBoardConfig-&gt;<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#a294d44ef7389cd6a6ee87b81619775fb">fragmentID</a> &lt;&lt; std::dec</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; but it is set up as &quot;</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          &lt;&lt; std::hex &lt;&lt; boardSetup.fragmentID &lt;&lt; std::dec</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;!\n&quot;</span>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      } <span class="comment">// if fragment ID in setup</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keywordflow">if</span> (boardSetup.hasFragmentID()) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        mf::LogPrint(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Board &#39;&quot;</span> &lt;&lt; boardName</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;&#39; has no configuration information;&quot;</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="stringliteral">&quot; some time stamp corrections will be skipped.&quot;</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="comment">// to avoid this, make a PMT configuration available from input file</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        mf::LogPrint(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Board &#39;&quot;</span> &lt;&lt; boardName</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;&#39; can&#39;t be associated to a fragment ID;&quot;</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="stringliteral">&quot; its time stamp corrections will be skipped.&quot;</span>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">// to avoid this, add a `BoardSetup.FragmentID` entry for it in the</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">// configuration of this tool, or make a PMT configuration available</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">continue</span>; <span class="comment">// no entry for this board at all</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> fragmentID</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      = pBoardConfig? pBoardConfig-&gt;<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#a294d44ef7389cd6a6ee87b81619775fb">fragmentID</a>: boardSetup.fragmentID;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    assert(fragmentID != <a class="code" href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html#a85d5c5b8ec289b33b00092a22c3946a0">daq::details::BoardSetup_t::NoFragmentID</a>);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">nanoseconds</a> <span class="keyword">const</span> preTriggerTime</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      = pBoardConfig</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      ? (pBoardConfig-&gt;<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#a3a67e93e4a5f9f3c63fc98867ed0aeb0">bufferLength</a> * (1.0f - pBoardConfig-&gt;<a class="code" href="../../df/d9c/structsbn_1_1V1730Configuration.html#ae019d5110b0e306338acd7cb0b1b1395">postTriggerFrac</a>))</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        * <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      : <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">nanoseconds</a>{ 0.0 }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      ;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <a class="code" href="../../d6/dbc/structdaq_1_1details_1_1BoardFacts__t.html">daq::details::BoardFacts_t</a> boardFacts {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      preTriggerTime  <span class="comment">// ditto</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      };</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    boardInfoByFragment.push_back({</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      fragmentID,               <span class="comment">// fragmentID</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      &amp;boardSetup,              <span class="comment">// setup</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      pBoardConfig,             <span class="comment">// config</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      std::move(boardFacts)     <span class="comment">// facts</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      });</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  } <span class="comment">// for</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html">daq::details::BoardInfoLookup</a>{ std::move(boardInfoByFragment) };</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::matchBoardConfigurationAndSetup()</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1bc4a4203e4d7c48176fd7c64903b34a">icarus::DaqDecoderICARUSPMT::fetchNeededBoardInfo</a>(</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html">daq::details::BoardInfoLookup::BoardInfo_t</a> <span class="keyword">const</span>* boardInfo,</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fragmentID</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;) <span class="keyword">const</span> -&gt; NeededBoardInfo_t {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d9/d1a/namespaceutil_1_1quantities_1_1intervals.html#a07912d3786fd25377de6216b0c77b532">util::quantities::intervals::microseconds</a>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordflow">return</span> NeededBoardInfo_t{</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="comment">// name</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      ((boardInfo &amp;&amp; boardInfo-&gt;config)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        ? boardInfo-&gt;config-&gt;boardName: (<span class="stringliteral">&quot;&lt;ID=&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(fragmentID)))</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="comment">// bufferLength</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    , ((boardInfo &amp;&amp; boardInfo-&gt;config)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        ? boardInfo-&gt;config-&gt;bufferLength * <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a>: <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">nanoseconds</a>{ 0.0 }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      )</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="comment">// preTriggerTime</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    , (boardInfo? boardInfo-&gt;facts.preTriggerTime: nanoseconds{ 0.0 })</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// PMTtriggerDelay</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    , ((boardInfo &amp;&amp; boardInfo-&gt;setup)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        ? boardInfo-&gt;setup-&gt;triggerDelay: nanoseconds{ 0.0 })</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// TTTresetDelay</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    , ((boardInfo &amp;&amp; boardInfo-&gt;setup)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        ? boardInfo-&gt;setup-&gt;TTTresetDelay: nanoseconds{ 0.0 })</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    };</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fetchNeededBoardInfo()</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab841a6615fbbc7775109bc0c27fdcc42">icarus::DaqDecoderICARUSPMT::fetchTriggerTimestamp</a></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  (art::Event <span class="keyword">const</span>&amp; event) <span class="keyword">const</span> -&gt; TriggerInfo_t</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;{</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">if</span> (!fTriggerTag)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">return</span> { SplitTimestamp_t(event.time().value()), 0U };</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>&amp; extraTrigger</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    = <span class="keyword">event</span>.getProduct&lt;<a class="code" href="../../dc/d51/structsbn_1_1ExtraTriggerInfo.html">sbn::ExtraTriggerInfo</a>&gt;(*fTriggerTag);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> (!extraTrigger.isValid()) {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// this means there is some problem from trigger decoder;</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">// while we might recover additional information from other data products,</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// we expect those to be as problematic.</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Extra trigger information from &#39;&quot;</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      &lt;&lt; fTriggerTag-&gt;encode() &lt;&lt; <span class="stringliteral">&quot;&#39; is marked as invalid!\n&quot;</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordflow">if</span> (fDiagnosticOutput) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    mf::LogVerbatim(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Extended trigger information:\n&quot;</span> &lt;&lt; extraTrigger;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  }</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>&amp; triggers</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    = <span class="keyword">event</span>.getProduct&lt;std::vector&lt;raw::Trigger&gt;&gt;(*fTriggerTag);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="keywordflow">if</span> (triggers.size() != 1U) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">// if this is hit, the decoder needs some development to correctly deal</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// with input with no trigger, or more than one</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; triggers.size() &lt;&lt; <span class="stringliteral">&quot; raw::Trigger from &#39;&quot;</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      &lt;&lt; fTriggerTag-&gt;encode() &lt;&lt; <span class="stringliteral">&quot;&#39;, can deal only with 1.\n&quot;</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <a class="code" href="../../dd/d0b/classraw_1_1Trigger.html">raw::Trigger</a> <span class="keyword">const</span>&amp; trigger = triggers.front();</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <span class="keyword">const</span> relBeamGate = timestampDiff</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    (extraTrigger.beamGateTimestamp, extraTrigger.triggerTimestamp);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> gateCount = extraTrigger.gateID;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">return</span> {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      SplitTimestamp_t</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        { <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(extraTrigger.triggerTimestamp) }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    , relBeamGate</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    , trigger.<a class="code" href="../../dd/d0b/classraw_1_1Trigger.html#a9b37b0218222430596b968c6448cdde2">TriggerBits</a>()</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    , gateCount</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    };</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fetchTriggerTimestamp()</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;artdaq::FragmentPtrs <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1b9dfd8c7f3a60d0edc797fb29d10183">icarus::DaqDecoderICARUSPMT::makeFragmentCollection</a></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment)<span class="keyword"> const</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">switch</span> (sourceFragment.type()) {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">case</span> sbndaq::FragmentType::CAENV1730:</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">return</span> makeFragmentCollectionFromFragment(sourceFragment);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">case</span> artdaq::Fragment::ContainerFragmentType:</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="keywordflow">return</span> makeFragmentCollectionFromContainerFragment(sourceFragment);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Unexpected PMT data product fragment type: &quot;</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sourceFragment.type()) &lt;&lt; <span class="stringliteral">&quot; (&#39;&quot;</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        &lt;&lt; sbndaq::fragmentTypeToString</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;          (static_cast&lt;sbndaq::FragmentType&gt;(sourceFragment.type()))</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;&#39;)\n&quot;</span>;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  } <span class="comment">// switch</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::makeFragmentCollection()</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;artdaq::FragmentPtrs</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aa4c48ee344972b09a388873cbd27962b">icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromFragment</a></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment)<span class="keyword"> const</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  assert(sourceFragment.type() == sbndaq::FragmentType::CAENV1730);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  artdaq::FragmentPtrs fragColl;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  fragColl.push_back(std::make_unique&lt;artdaq::Fragment&gt;(sourceFragment));</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">return</span> fragColl;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromFragment()</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;artdaq::FragmentPtrs</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab654b2336af704e22b6b6a37633d48a2">icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromContainerFragment</a></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; sourceFragment)<span class="keyword"> const</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  assert(sourceFragment.type() == artdaq::Fragment::ContainerFragmentType);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  artdaq::ContainerFragment <span class="keyword">const</span> containerFragment{ sourceFragment };</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">if</span> (containerFragment.block_count() == 0) <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  artdaq::FragmentPtrs fragColl;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> iFrag: <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(containerFragment.block_count()))</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    fragColl.push_back(containerFragment.at(iFrag));</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keywordflow">return</span> fragColl;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromContainerFragment()</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6de83fb86b69c02be16ff45bd61add98">icarus::DaqDecoderICARUSPMT::checkFragmentType</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment)<span class="keyword"> const</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keywordflow">if</span> (artdaqFragment.type() == sbndaq::FragmentType::CAENV1730) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Unexpected PMT fragment data type: &#39;&quot;</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    &lt;&lt; sbndaq::fragmentTypeToString</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      (static_cast&lt;sbndaq::FragmentType&gt;(artdaqFragment.type()))</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::checkFragmentType</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a3b6db1e2904ab2508d54cc234bec67e7">icarus::DaqDecoderICARUSPMT::processBoardFragments</a>(</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  artdaq::FragmentPtrs <span class="keyword">const</span>&amp; artdaqFragments,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  TriggerInfo_t <span class="keyword">const</span>&amp; triggerInfo</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;) -&gt; std::vector&lt;raw::OpDetWaveform&gt; {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">if</span> (artdaqFragments.empty()) <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  artdaq::Fragment <span class="keyword">const</span>&amp; referenceFragment = *(artdaqFragments.front());</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  assert(&amp;referenceFragment);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  checkFragmentType(referenceFragment);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  NeededBoardInfo_t <span class="keyword">const</span> boardInfo</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    = neededBoardInfo(artdaqFragments.front()-&gt;fragmentID());</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; boardInfo.name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; artdaqFragments.size()</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; fragments&quot;</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; waveforms;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="keywordflow">for</span> (artdaq::FragmentPtr <span class="keyword">const</span>&amp; fragment: artdaqFragments)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    appendTo(waveforms, processFragment(*fragment, boardInfo, triggerInfo));</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  mergeWaveforms(waveforms);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordflow">return</span> { waveforms };</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::processBoardFragments()</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a36259032ee3e2aadbfcbfd48f92068d1">icarus::DaqDecoderICARUSPMT::processFragment</a>(</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  NeededBoardInfo_t <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  TriggerInfo_t <span class="keyword">const</span>&amp; triggerInfo</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;) -&gt; std::vector&lt;raw::OpDetWaveform&gt; {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  checkFragmentType(artdaqFragment);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">if</span> (fPacketDump) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    mf::LogVerbatim{ <a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a> } &lt;&lt; <span class="stringliteral">&quot;PMT packet:&quot;</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::string(80, <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; <a class="code" href="../../d3/d0b/namespacesbndaq.html#a8c2910e129a0c67d73d4c1f4607552bf">sbndaq::dumpFragment</a>(artdaqFragment)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::string(80, <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      ;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  } <span class="comment">// if diagnostics</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  FragmentInfo_t <span class="keyword">const</span> fragInfo = extractFragmentInfo(artdaqFragment);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> timeStamp</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    = fragmentWaveformTimestamp(fragInfo, boardInfo, triggerInfo.time);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="keywordflow">if</span> (fTreeFragment) fillPMTfragmentTree(fragInfo, triggerInfo, timeStamp);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordflow">return</span> (timeStamp != NoTimestamp)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    ? createFragmentWaveforms(fragInfo, timeStamp)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    : <a class="code" href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">std</a>::<a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">vector</a>&lt;raw::OpDetWaveform&gt;{}</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    ;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::processFragment()</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a06748e1358cb20f1d70a9c4e9847fc39">icarus::DaqDecoderICARUSPMT::createFragmentWaveforms</a></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  (FragmentInfo_t <span class="keyword">const</span>&amp; fragInfo, <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <span class="keyword">const</span> timeStamp) <span class="keyword">const</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  -&gt; std::vector&lt;raw::OpDetWaveform&gt;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;{</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  assert(timeStamp != NoTimestamp);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> [ chDataMap, nEnabledChannels ]</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    = setBitIndices&lt;16U&gt;(fragInfo.enabledChannels);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; opDetWaveforms; <span class="comment">// output collection</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  std::optional&lt;mf::LogVerbatim&gt; diagOut;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordflow">if</span> (fDiagnosticOutput) diagOut.emplace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="../../de/d35/namespaceicarusDB.html#a0b2ff93e818861e19ade3a1b82e3a417">icarusDB::DigitizerChannelChannelIDPairVec</a> <span class="keyword">const</span>&amp; digitizerChannelVec</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    = fChannelMap.getChannelIDPairVec</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      (effectivePMTboardFragmentID(fragInfo.fragmentID))</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    ;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="keywordflow">if</span> (diagOut)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    (*diagOut) &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; digitizerChannelVec.size() &lt;&lt; <span class="stringliteral">&quot; channels:&quot;</span>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="comment">// allocate the vector outside the loop since we&#39;ll reuse it over and over</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  std::vector&lt;std::uint16_t&gt; wvfm(fragInfo.nSamplesPerChannel);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="comment">// track what we do and what we want to</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  std::uint16_t attemptedChannels = 0;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="comment">// loop over the channels that we know might be in the fragment</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span> [ digitizerChannel, channelID ]: digitizerChannelVec) {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (diagOut)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      (*diagOut) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; digitizerChannel &lt;&lt; <span class="stringliteral">&quot; [=&gt; &quot;</span> &lt;&lt; channelID &lt;&lt; <span class="stringliteral">&quot;];&quot;</span>;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    attemptedChannels |= (1 &lt;&lt; digitizerChannel);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">// find where this channel is in the data fragment</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    std::size_t <span class="keyword">const</span> channelPosInData = chDataMap[digitizerChannel];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">if</span> (channelPosInData &gt;= nEnabledChannels) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Digitizer channel &quot;</span> &lt;&lt; digitizerChannel</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; [=&gt; &quot;</span> &lt;&lt; channelID &lt;&lt; <span class="stringliteral">&quot;] skipped because not enabled.&quot;</span>;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    }</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    std::size_t <span class="keyword">const</span> ch_offset</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      = channelPosInData * fragInfo.nSamplesPerChannel;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    std::copy_n(fragInfo.data + ch_offset, wvfm.size(), wvfm.begin());</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    opDetWaveforms.emplace_back(timeStamp.value(), channelID, wvfm);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMT channel &quot;</span> &lt;&lt; channelID &lt;&lt; <span class="stringliteral">&quot; has &quot;</span> &lt;&lt; wvfm.size()</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; samples (read from entry #&quot;</span> &lt;&lt; channelPosInData</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; in fragment data) starting at electronics time &quot;</span> &lt;&lt; timeStamp;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  } <span class="comment">// for channels</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="keywordflow">if</span> (diagOut) diagOut.reset(); <span class="comment">// destroys and therefore prints out</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="keywordflow">if</span> (attemptedChannels != fragInfo.enabledChannels) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">// this is mostly a warning; regularly, for example,</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// we effectively have 15 channels per board; but all 16 are enabled,</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">// so one channel is not decoded at all</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    mf::LogTrace log(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;Not all data read:&quot;</span>;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keyword">const</span> bit: <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(16U)) {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      std::uint16_t <span class="keyword">const</span> <a class="code" href="../../de/d90/namespacesbn_1_1bits.html#a3b8fd0787ccd1963c6aa5c8bf17f4290">mask</a> = (1 &lt;&lt; bit);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keywordtype">bool</span> <span class="keyword">const</span> attempted = <a class="code" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>(attemptedChannels &amp; mask);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keywordtype">bool</span> <span class="keyword">const</span> enabled = <a class="code" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>(fragInfo.enabledChannels &amp; mask);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keywordflow">if</span> (attempted == enabled) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">if</span> (!enabled) <span class="comment">// and attempted</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;\n  requested channel &quot;</span> &lt;&lt; bit &lt;&lt; <span class="stringliteral">&quot; was not enabled&quot;</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="keywordflow">if</span> (!attempted) <span class="comment">// and enabled</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;\n  data for enabled channel &quot;</span> &lt;&lt; bit &lt;&lt; <span class="stringliteral">&quot; was ignored&quot;</span>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    } <span class="comment">// for bits</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  } <span class="comment">// if request and availability did not match</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordflow">if</span> (diagOut) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    (*diagOut)</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;      - number of waveforms decoded: &quot;</span> &lt;&lt; opDetWaveforms.size();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">if</span> (!opDetWaveforms.empty() &amp;&amp; containsGlobalTrigger(opDetWaveforms.back()))</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      (*diagOut) &lt;&lt; <span class="stringliteral">&quot;      - matches global trigger!&quot;</span>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  } <span class="comment">// if diagnostics</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="keywordflow">return</span> opDetWaveforms;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::createFragmentWaveforms()</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a5bfa1a4b2ace04446c30ddb9c95a3a94">icarus::DaqDecoderICARUSPMT::mergeWaveforms</a></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  (std::vector&lt;raw::OpDetWaveform&gt;&amp; waveforms)<span class="keyword"> const</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  std::size_t <span class="keyword">const</span> nWaveforms = waveforms.size();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">if</span> (nWaveforms &lt; 2) <span class="keywordflow">return</span> 0U;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="comment">// matching criteria: allow rounding error (10 ps)</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="comment">// and require the second time closer than half a tick from the first one</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> matchTimes = [<span class="keyword">this</span>](<a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>, <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> b)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    { <span class="keywordflow">return</span> ((a - 0.01_ns) &lt; b) &amp;&amp; (b  &lt; a + <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a> / 2.0); };</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  sortWaveforms(waveforms);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// define the merging groups</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  std::vector&lt;std::vector&lt;std::size_t&gt;&gt; waveformGroups;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  std::size_t iWave = 0U;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="comment">// start a new group with the next available waveform</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    std::vector&lt;std::size_t&gt; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a>{ iWave }; <span class="comment">// one element: `iWave`</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// merge all following waveforms contiguous to this group</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> currentEnd = waveformEndTime(waveforms[iWave]);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <a class="code" href="../../d9/d63/namespaceraw.html#ab3db8feaa51f2c564eb00582c3d72590">raw::Channel_t</a> <span class="keyword">const</span> currentChannel = waveforms[iWave].ChannelNumber();</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">while</span> (++iWave &lt; nWaveforms) {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; waveform = waveforms[iWave];</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">if</span> (waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>() != currentChannel) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keywordflow">if</span> (!matchTimes(currentEnd, waveformStartTime(waveform))) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a>.push_back(iWave);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      currentEnd = waveformEndTime(waveform);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    } <span class="comment">// while matching times</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    waveformGroups.push_back(std::move(<a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a>));</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  } <span class="keywordflow">while</span> (iWave &lt; nWaveforms);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt; mergedWaveforms;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  mergedWaveforms.reserve(waveformGroups.size());</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a>: waveformGroups)</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    mergedWaveforms.push_back(mergeWaveformGroup(waveforms, <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a>));</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  waveforms = std::move(mergedWaveforms);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="keywordflow">return</span> nWaveforms - waveforms.size();</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::mergeWaveforms()</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ae47c85d39f17ad3c0cae3f46f6423491">icarus::DaqDecoderICARUSPMT::mergeWaveformGroup</a>(</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  std::vector&lt;raw::OpDetWaveform&gt;&amp; allWaveforms,</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  std::vector&lt;std::size_t&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a81b45a59e7128f35719a7ba55a0f8370">indices</a></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="keywordflow">if</span> (indices.empty()) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">throw</span> std::logic_error</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      { <span class="stringliteral">&quot;DaqDecoderICARUSPMT::mergeWaveformGroup(): empty waveform group.&quot;</span> };</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="keyword">auto</span> itIndex = indices.begin();</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> iend = indices.end();</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> mergedWaveform{ std::move(allWaveforms.at(*itIndex)) };</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">  mf::LogTrace(&quot;DaqDecoderICARUSPMT&quot;)</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">    &lt;&lt; &quot;Extending waveform [#&quot; &lt;&lt; (*itIndex) &lt;&lt; &quot;] channel=&quot;</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">    &lt;&lt; mergedWaveform.ChannelNumber() &lt;&lt; &quot; time=&quot;</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">    &lt;&lt; waveformStartTime(mergedWaveform) &lt;&lt; &quot; -- &quot;</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">    &lt;&lt; waveformEndTime(mergedWaveform) &lt;&lt; &quot; (&quot; &lt;&lt; mergedWaveform.size()</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">    &lt;&lt; &quot; samples)&quot;</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">    ;</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="keywordflow">while</span> (++itIndex != iend) {</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keyword">auto</span>&amp; waveform = allWaveforms.at(*itIndex);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    mf::LogTrace(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; - extending waveform channel=&quot;</span> &lt;&lt; mergedWaveform.ChannelNumber()</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; time=&quot;</span> &lt;&lt; waveformStartTime(mergedWaveform) &lt;&lt; <span class="stringliteral">&quot; -- &quot;</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      &lt;&lt; waveformEndTime(mergedWaveform) &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; mergedWaveform.size()</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; samples) with waveform [#&quot;</span> &lt;&lt; (*itIndex) &lt;&lt; <span class="stringliteral">&quot;] channel=&quot;</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      &lt;&lt; waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>() &lt;&lt; <span class="stringliteral">&quot; at time=&quot;</span> &lt;&lt; waveformStartTime(waveform)</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; waveform.size() &lt;&lt; <span class="stringliteral">&quot; samples)&quot;</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      ;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">if</span> (mergedWaveform.ChannelNumber() != waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>()) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordflow">throw</span> std::logic_error{</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="stringliteral">&quot;DaqDecoderICARUSPMT::mergeWaveformGroup(): &quot;</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="stringliteral">&quot;attempt to merge waveforms from channels &quot;</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(mergedWaveform.ChannelNumber())</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        + <span class="stringliteral">&quot; and &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>())</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        };</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">if</span> (waveform.empty()) {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keywordflow">throw</span> std::logic_error{</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="stringliteral">&quot;DaqDecoderICARUSPMT::mergeWaveformGroup(): &quot;</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="stringliteral">&quot;attempt to merge a waveform (channel &quot;</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(mergedWaveform.ChannelNumber())</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        + <span class="stringliteral">&quot;, timestamp &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(waveform.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a12a5306398b04085c936ced39e16f192">TimeStamp</a>()) + <span class="stringliteral">&quot; again&quot;</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        };</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">// raw::OpDetWaveform happen to be `std::vector`, so this will work:</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    std::size_t <span class="keyword">const</span> expectedSize [[maybe_unused]]</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      = mergedWaveform.size() + waveform.size();</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    appendTo(mergedWaveform, std::move(waveform));</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    assert(waveform.empty());</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    assert(mergedWaveform.size() == expectedSize);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  } <span class="comment">// while</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">return</span> mergedWaveform;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::mergeWaveformGroup()</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1de65f72a8ba642fefeaefd3f5afe412">icarus::DaqDecoderICARUSPMT::fillPMTfragmentTree</a>(</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  FragmentInfo_t <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  TriggerInfo_t <span class="keyword">const</span>&amp; triggerInfo,</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> waveformTimestamp</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;) {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keywordflow">if</span> (!fTreeFragment) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  fTreeFragment-&gt;data.fragmentID = fragInfo.fragmentID;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  fTreeFragment-&gt;data.fragCount = fragInfo.eventCounter;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  fTreeFragment-&gt;data.TriggerTimeTag = fragInfo.TTT;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  fTreeFragment-&gt;data.trigger = triggerInfo.time;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  fTreeFragment-&gt;data.relBeamGate = triggerInfo.relBeamGateTime;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  fTreeFragment-&gt;data.fragTime</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    = { <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(fragInfo.fragmentTimestamp) };</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  fTreeFragment-&gt;data.waveformTime = waveformTimestamp.value();</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  fTreeFragment-&gt;data.waveformSize = fragInfo.nSamplesPerChannel;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  fTreeFragment-&gt;data.triggerBits = triggerInfo.bits;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  fTreeFragment-&gt;data.gateCount = triggerInfo.gateCount;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  fTreeFragment-&gt;data.onGlobalTrigger</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    = containsGlobalTrigger(waveformTimestamp, fragInfo.nSamplesPerChannel);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  assignEventInfo(fTreeFragment-&gt;data);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  fTreeFragment-&gt;tree-&gt;Fill();</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fillPMTfragmentTree()</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab580f25b27f7b5673074cc2a0dc4ceb3">icarus::DaqDecoderICARUSPMT::extractFragmentBoardID</a></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; fragment) -&gt; BoardID_t</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;{</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>BoardID_t<span class="keyword">&gt;</span>(fragment.fragmentID());</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::extractFragmentBoardID()</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a63e07abeb25ed8d648a3a11ea36a8edd">icarus::DaqDecoderICARUSPMT::extractFragmentInfo</a></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; artdaqFragment) <span class="keyword">const</span> -&gt; FragmentInfo_t</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;{</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="comment">// fragment ID, timestamp and data begin</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  artdaq::Fragment::fragment_id_t <span class="keyword">const</span> fragment_id</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    = artdaqFragment.<a class="code" href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a04a561fb116904daf82f299524571e1c">fragmentID</a>();</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  artdaq::Fragment::timestamp_t <span class="keyword">const</span> fragmentTimestamp</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    = artdaqFragment.timestamp();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  std::uint16_t <span class="keyword">const</span>* data_begin = <span class="keyword">reinterpret_cast&lt;</span>std::uint16_t <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    (artdaqFragment.dataBeginBytes() + <span class="keyword">sizeof</span>(sbndaq::CAENV1730EventHeader));</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">// event counter, trigger time tag, enabled channels</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  sbndaq::CAENV1730Fragment <span class="keyword">const</span> fragment { artdaqFragment };</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  sbndaq::CAENV1730FragmentMetadata <span class="keyword">const</span>&amp; metafrag = *(fragment.Metadata());</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  sbndaq::CAENV1730EventHeader <span class="keyword">const</span>&amp; header = fragment.Event()-&gt;Header;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> eventCounter = header.eventCounter;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> TTT =  header.triggerTimeTag;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  std::uint16_t <span class="keyword">const</span> enabledChannels = header.ChannelMask();</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="comment">// samples per channel</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="comment">// artDAQ size is measured in 4-byte words</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  std::size_t <span class="keyword">const</span> eventSize = header.eventSize * <span class="keyword">sizeof</span>(std::uint32_t);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  constexpr std::size_t headerSize = <span class="keyword">sizeof</span>(sbndaq::CAENV1730EventHeader);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  std::size_t <span class="keyword">const</span> sampleDataSize = eventSize - headerSize;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  std::size_t <span class="keyword">const</span> samplesInFragment = sampleDataSize / <span class="keyword">sizeof</span>(std::uint16_t);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  std::size_t <span class="keyword">const</span> nChannelsPerBoard = metafrag.nChannels;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  std::size_t <span class="keyword">const</span> nSamplesPerChannel = samplesInFragment / nChannelsPerBoard;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">// diagnostics dump</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="keywordflow">if</span> (fDiagnosticOutput) {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    mf::LogVerbatim{ <a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a> }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;----&gt; PMT Fragment ID: &quot;</span> &lt;&lt; std::hex &lt;&lt; fragment_id &lt;&lt; std::dec</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, size: &quot;</span> &lt;&lt; eventSize &lt;&lt; <span class="stringliteral">&quot; B&quot;</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, data size: &quot;</span> &lt;&lt; samplesInFragment &lt;&lt; <span class="stringliteral">&quot; samples&quot;</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n    &quot;</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  channels/board: &quot;</span> &lt;&lt; nChannelsPerBoard</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, enabled: &quot;</span> &lt;&lt; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">icarus::ns::util::bin</a>(enabledChannels)</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, samples/channel: &quot;</span> &lt;&lt; nSamplesPerChannel</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n    &quot;</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  event counter: &quot;</span> &lt;&lt; eventCounter</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, trigger time tag: &quot;</span> &lt;&lt; TTT</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, time stamp: &quot;</span> &lt;&lt; (fragmentTimestamp / 1<span class="stringliteral">&#39;000&#39;</span>000<span class="stringliteral">&#39;000UL)</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="stringliteral">          &lt;&lt; &quot;.&quot; &lt;&lt; (fragmentTimestamp % 1&#39;</span>000<span class="stringliteral">&#39;000&#39;</span>000UL) &lt;&lt; <span class="stringliteral">&quot; s&quot;</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      ;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  } <span class="comment">// if diagnostics</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">// all done</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">return</span> { <span class="comment">// C++20: write the member names explicitly</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    fragment_id,</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    fragmentTimestamp,</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    eventCounter,</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    TTT,</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    enabledChannels,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    nSamplesPerChannel,</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    data_begin</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    };</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::extractFragmentInfo()</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a47d27bbd6827c7e4630825ff57939519">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestamp</a>(</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  FragmentInfo_t <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  NeededBoardInfo_t <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  SplitTimestamp_t triggerTime</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="comment">// check availability of mapping for this board, otherwise can&#39;t do anything</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  std::size_t <span class="keyword">const</span> fragment_id = fragInfo.fragmentID;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  std::size_t <span class="keyword">const</span> eff_fragment_id = effectivePMTboardFragmentID(fragment_id);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">if</span> (!fChannelMap.hasPMTDigitizerID(eff_fragment_id)) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    mf::LogError(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;*** PMT could not find channel information for fragment: &quot;</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      &lt;&lt; fragment_id</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      ;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">return</span> NoTimestamp;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  }</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="keywordflow">if</span> (fTTTresetEverySecond)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keywordflow">return</span> fragmentWaveformTimestampFromTTT(fragInfo, boardInfo, triggerTime);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">return</span> fragmentWaveformTimestampOnTrigger(fragInfo, boardInfo, triggerTime);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestamp()</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a13b99e41b86536ee333a822f816695ff">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampOnTrigger</a>(</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  FragmentInfo_t <span class="keyword">const</span>&amp; <span class="comment">/* fragInfo */</span>,</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  NeededBoardInfo_t <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  SplitTimestamp_t <span class="comment">/* triggerTime */</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;) <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a> -&gt; <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  nanoseconds <span class="keyword">const</span> preTriggerTime = boardInfo.preTriggerTime;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  nanoseconds <span class="keyword">const</span> PMTtriggerDelay = boardInfo.PMTtriggerDelay;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> timestamp = fNominalTriggerTime - PMTtriggerDelay - preTriggerTime;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>) &lt;&lt; <span class="stringliteral">&quot;V1730 board &#39;&quot;</span> &lt;&lt; boardInfo.<a class="code" href="../../dd/d9d/structdetinfo_1_1timescales_1_1details_1_1timescale__traits__base.html#aa267fed464f5e1e9baee07e1109af09b">name</a></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&#39; has data starting at electronics time &quot;</span> &lt;&lt; timestamp</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; fNominalTriggerTime</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; PMTtriggerDelay &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; preTriggerTime</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    ;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="keywordflow">return</span> timestamp;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampOnTrigger()</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a57c6989ec1720bf1990121079f267a51">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampFromTTT</a>(</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  FragmentInfo_t <span class="keyword">const</span>&amp; fragInfo,</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  NeededBoardInfo_t <span class="keyword">const</span>&amp; boardInfo,</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  SplitTimestamp_t triggerTime</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;) <span class="keyword">const</span> -&gt; <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">   * 1. goal is a timestamp in electronics time</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">   * 2. we have the global trigger time in electronics time</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">   *    (from raw::Trigger data product or from DetectorClocks service)</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">   * 3. board TTT and global trigger time are on the same timescale:</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">   *    their difference directly describes the time of the board trigger</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">   *    relative to the global trigger</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">   * 4. TTT tags the last (or after the last?) sample of the collected waveform;</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">   *    the time of the first sample precedes that tag by the full buffer length</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">   * 5. the PMT trigger itself is subject to a sequence of delays compared to</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">   *    the (local or global) trigger from SPEXi; here we quantify these delays</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">   *    from calibration offsets collectively passed via job configuration.</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keyword">using namespace </span>util::quantities::time_literals;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="comment">// 2. global trigger time</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <a class="code" href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">electronics_time</a> waveformTime = fNominalTriggerTime;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// 3. PMT readout board trigger relative to global trigger time</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> triggerTimeNS = triggerTime.split.nanoseconds;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="comment">// converted into nanoseconds (each TTT tick is 8 nanoseconds):</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> TTT = fragInfo.TTT * 8;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">   * The trigger time tag (TTT) on the PMT readout board is incremented every 8</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">   * nanoseconds, and the board is sent a reset signal every second, matching</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">   * the time of the change of second of the global trigger time scale</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">   * (International Atomic Time from White Rabbit). If the global trigger and</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">   * the trigger of the PMT readout happen at the same instant (which would be</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">   * ideally true for one fragment for each board and each event), the TTT will</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">   * represent exactly the number of nanoseconds of the global trigger passed</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">   * since the last crossing of a second boundary.</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">   * (in practice, this is biassed by the signal creation, propagation and</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">   * interpretation delays, and smeared by the clocks of the SPEXi board sending</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">   * the signal and the CAEN V1730 readout board, which have a period of 25 ns</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">   * and 8 ns, respectively).</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">   * Multiple fragments can be collected from one PMT readout board for the same</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">   * event by sending the board multiple &quot;local&quot; triggers; these triggers are</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">   * all supposed to be in the neighbourhood of the global trigger time;</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">   * in fact, they should not be more than 1 ms away from it, since PMT readout</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">   * enable window is +/- 1 ms around the expected beam arrival time.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">   * In the most common case when global trigger and fragment tag are not</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">   * separated by a boundary of the second</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">   * (e.g. global trigger at 1620&#39;284&#39;028 seconds + 799&#39;800&#39;000 nanoseconds</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">   * and fragment tag 0.5 milliseconds earlier, at 1620&#39;284&#39;028 seconds</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">   * + 799&#39;300&#39;000 nanoseconds, i.e. with a trigger tag around 799&#39;300&#39;000);</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">   * in this example, the fragment is 0.5 ms earlier:</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">   * -500&#39;000 nanoseconds = 799&#39;300&#39;000 (TTT) - 799&#39;800&#39;000 (glob. trigger)</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="keywordtype">int</span> fragmentRelTime = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(TTT) - triggerTimeNS;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="keywordflow">if</span> (TTT &gt; triggerTimeNS + 500<span class="stringliteral">&#39;000&#39;</span>000U) { <span class="comment">// 0.5 seconds</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">     * case when global trigger arrives just after the boundary of the second</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">     * (e.g. global trigger at 1620&#39;284&#39;029 seconds + 300&#39;000 nanoseconds)</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">     * and this fragment was tagged before that crossing (e.g. 0.5 milliseconds</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">     * earlier, at 1620&#39;284&#39;028 seconds + 999&#39;800&#39;000 nanoseconds, i.e. with a</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">     * trigger tag around 999&#39;800&#39;000);</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">     * in this example, the fragment is 0.5 ms earlier: -500&#39;000 nanoseconds =</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">     * 999&#39;800&#39;000 (TTT) - 1&#39;000&#39;000&#39;000 (second step) - 300&#39;000 (glob. trigger)</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">     * and the plain difference,</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">     * 999&#39;800&#39;000 (TTT) - 300&#39;000 (glob. trigger) = 999&#39;500&#39;000,</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">     * must be corrected by removing a whole second:</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    fragmentRelTime -= 1<span class="stringliteral">&#39;000&#39;</span>000<span class="stringliteral">&#39;000;</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="stringliteral">  else if (TTT + 500&#39;</span>000<span class="stringliteral">&#39;000U &lt; triggerTimeNS) { // 0.5 seconds</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="stringliteral">    /*</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="stringliteral">     * case when global trigger arrives just before the boundary of the second</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="stringliteral">     * (e.g. global trigger at 1620&#39;</span>284<span class="stringliteral">&#39;028 seconds + 999&#39;</span>800<span class="stringliteral">&#39;000 nanoseconds)</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="stringliteral">     * and this fragment was tagged after that crossing (e.g. 0.5 milliseconds</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="stringliteral">     * later, at 1620&#39;</span>284<span class="stringliteral">&#39;029 seconds + 300&#39;</span>000 <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">nanoseconds</a>, i.e. with a</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;     * trigger tag around 300<span class="stringliteral">&#39;000 because of the pulse-per-second reset);</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="stringliteral">     * in this example, the fragment is 0.5 ms late: 500&#39;</span>000 nanoseconds =</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;     * 300<span class="stringliteral">&#39;000 (TTT) + 1&#39;</span>000<span class="stringliteral">&#39;000&#39;</span>000 (<a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a> step) - 999<span class="stringliteral">&#39;800&#39;</span>000 (glob. trigger)</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;     * <a class="code" href="../../d9/dd2/selectors_8fcl.html#aadc113fa4af9aeff01481eed2a98e7cc">and</a> <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> plain difference,</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;     * 300<span class="stringliteral">&#39;000 (TTT) - 999&#39;</span>800<span class="stringliteral">&#39;000 (glob. trigger) = -999&#39;</span>500<span class="stringliteral">&#39;000,</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="stringliteral">     * must be corrected by adding a whole second:</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="stringliteral">     */</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="stringliteral">    fragmentRelTime += 1&#39;</span>000<span class="stringliteral">&#39;000&#39;</span>000;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  waveformTime += nanoseconds::castFrom(fragmentRelTime);</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="comment">// 4. correction for relative position of sample tagged by TTT in the buffer</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  waveformTime -= fragInfo.nSamplesPerChannel * <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="comment">// 5. correction for calibrated delays</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">   * Waveform time has been expressed based on the &quot;absolute&quot; trigger time plus</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">   * an offset based on the Trigger Time Tag, which is synchronous with the</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">   * global trigger and reset every second.</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">   * We are missing a possible delay between the time of the trigger time scale</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">   * stepping into a new second and the the time TTT reset is effective.</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">   * </span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  waveformTime += boardInfo.TTTresetDelay;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  mf::LogTrace(<a class="code" href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a>) &lt;&lt; <span class="stringliteral">&quot;V1730 board &#39;&quot;</span> &lt;&lt; boardInfo.name</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&#39; has data starting at electronics time &quot;</span> &lt;&lt; waveformTime</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; fNominalTriggerTime &lt;&lt; <span class="stringliteral">&quot; (global trigger)&quot;</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">nanoseconds</a>(fragmentRelTime) &lt;&lt; <span class="stringliteral">&quot; (TTT - global trigger)&quot;</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; (fragInfo.nSamplesPerChannel * <a class="code" href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a>) &lt;&lt; <span class="stringliteral">&quot; (buffer size)&quot;</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; boardInfo.TTTresetDelay &lt;&lt; <span class="stringliteral">&quot; (reset delay)&quot;</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    ;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordflow">return</span> waveformTime;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  </div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampFromTTT()</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="keyword">auto</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ada0f8e56ef713abb702df4d7e4ba0878">icarus::DaqDecoderICARUSPMT::neededBoardInfo</a></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  (artdaq::Fragment::fragment_id_t fragment_id) <span class="keyword">const</span> -&gt; NeededBoardInfo_t</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;{</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  assert(fBoardInfoLookup);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">   * The trigger time is always the nominal one, because that is the</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">   * reference time of the whole DAQ (PMT, TPC...).</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">   * We only need to know how sooner than the trigger the V1730 buffer</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">   * starts. Oh, and the delay from the global trigger time to when</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">   * the readout board receives and processes the trigger signal.</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <a class="code" href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html">daq::details::BoardInfoLookup::BoardInfo_t</a> <span class="keyword">const</span>* boardInfo</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    = fBoardInfoLookup-&gt;findBoardInfo(fragment_id);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="keywordflow">if</span> (!boardInfo) {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordflow">if</span> (fRequireKnownBoards) {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      cet::exception <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      e &lt;&lt; <span class="stringliteral">&quot;Input fragment has ID &quot;</span> &lt;&lt; fragment_id</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; which has no associated board information (`BoardSetup`&quot;</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordflow">if</span> (!hasPMTconfiguration()) e &lt;&lt; <span class="stringliteral">&quot; + `.FragmentID`&quot;</span>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">throw</span> e &lt;&lt; <span class="stringliteral">&quot;).\n&quot;</span>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    }</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    assert(boardInfo-&gt;<a class="code" href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html#a84a5c2adda193a31aa7f9310edda32d7">fragmentID</a> == fragment_id);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    assert(boardInfo-&gt;<a class="code" href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html#a587922308edd0e03fc7561d14df798e4">setup</a>);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="keywordflow">return</span> fetchNeededBoardInfo(boardInfo, fragment_id);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::neededBoardInfo()</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a232868c27b2e6c33f947d8eff2d64d26">icarus::DaqDecoderICARUSPMT::extractTriggerTimeTag</a></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  (artdaq::Fragment <span class="keyword">const</span>&amp; fragment)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;{</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  sbndaq::CAENV1730Fragment <span class="keyword">const</span> V1730fragment { fragment };</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  sbndaq::CAENV1730EventHeader <span class="keyword">const</span> header = V1730fragment.Event()-&gt;Header;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> TTT { header.triggerTimeTag }; <span class="comment">// prevent narrowing</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keywordflow">return</span> TTT;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::extractTriggerTimeTag()</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a2a15e2b580364dacf6c6ca288fc2e28a">icarus::DaqDecoderICARUSPMT::sortWaveforms</a></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  (std::vector&lt;raw::OpDetWaveform&gt;&amp; waveforms)<span class="keyword"> const</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <span class="keyword">auto</span> byChannelThenTime = []</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    (<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>, <a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>)</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="keywordflow">return</span> (left.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>() != <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>.ChannelNumber())</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        ? left.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">ChannelNumber</a>() &lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>.ChannelNumber()</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        : left.<a class="code" href="../../d0/d29/classraw_1_1OpDetWaveform.html#a12a5306398b04085c936ced39e16f192">TimeStamp</a>() &lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>.TimeStamp();</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    };</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  std::sort(waveforms.begin(), waveforms.end(), byChannelThenTime);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::sortWaveforms()</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6afe7b54b3cda786dd2f4c624b0aa5e0">icarus::DaqDecoderICARUSPMT::initTrees</a></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  (std::vector&lt;std::string&gt; <span class="keyword">const</span>&amp; treeNames)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;{</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="keyword">auto</span> findTree = [](std::string <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>DataTrees<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;          std::distance(TreeNames.begin(),</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          std::find(TreeNames.begin(), TreeNames.end(), <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>))</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        );</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    };</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="keywordflow">for</span> (std::string <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>: treeNames) {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordflow">switch</span> (findTree(<a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)) {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="keywordflow">case</span> DataTrees::Fragments: initFragmentsTree(); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">DataTrees::N</a>:</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;DaqDecoderICARUSPMT&quot;</span>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;initTrees(): no data tree supported with name &#39;&quot;</span> &lt;&lt; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;&#39;.\n&quot;</span>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    } <span class="comment">// switch</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  } <span class="comment">// for names</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::initTrees()</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a9ff39239832f377083789b0a682edd72">icarus::DaqDecoderICARUSPMT::initEventIDtree</a></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  (TTree&amp; tree, TreeData_EventID_t&amp; data)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;{</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  usesEventInfo(); <span class="comment">// this tree includes event information</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  tree.Branch(<span class="stringliteral">&quot;run&quot;</span>, &amp;data.run);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;  tree.Branch(<span class="stringliteral">&quot;subrun&quot;</span>, &amp;data.subrun);</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  tree.Branch(<span class="stringliteral">&quot;event&quot;</span>, &amp;data.event);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  tree.Branch(<span class="stringliteral">&quot;timestamp&quot;</span>, &amp;data.timestamp.time, <span class="stringliteral">&quot;timestamp/L&quot;</span>);</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::initEventIDtree()</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a247d0d387770cf629dd7f60d7069a4a8">icarus::DaqDecoderICARUSPMT::initFragmentsTree</a>() {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="keywordflow">if</span> (fTreeFragment) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  TTree* tree = art::ServiceHandle&lt;art::TFileService&gt;()</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    -&gt;make&lt;TTree&gt;(<span class="stringliteral">&quot;PMTfragments&quot;</span>, <span class="stringliteral">&quot;PMT fragment data&quot;</span>);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  fTreeFragment = std::make_unique&lt;TreeFragment_t&gt;();</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  fTreeFragment-&gt;tree = tree;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="keyword">auto</span>&amp; data = fTreeFragment-&gt;data;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  initEventIDtree(*tree, data);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;fragmentID&quot;</span>, &amp;data.fragmentID);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;fragCount&quot;</span>, &amp;data.fragCount);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;fragTime&quot;</span>, &amp;data.fragTime.time, <span class="stringliteral">&quot;fragTime/L&quot;</span>); <span class="comment">// ROOT 6.24 can&#39;t detect 64-bit</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;fragTimeSec&quot;</span>, &amp;data.fragTime.split.seconds);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;TTT&quot;</span>, &amp;data.TriggerTimeTag, <span class="stringliteral">&quot;TTT/l&quot;</span>); <span class="comment">// ROOT 6.24 can&#39;t detect 64-bit</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;trigger&quot;</span>, &amp;data.trigger.time, <span class="stringliteral">&quot;trigger/L&quot;</span>); <span class="comment">// ROOT 6.24 can&#39;t detect 64-bit</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;triggerSec&quot;</span>, &amp;data.trigger.split.seconds);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;triggerNS&quot;</span>, &amp;data.trigger.split.nanoseconds);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;relBeamGateNS&quot;</span>, &amp;data.relBeamGate, <span class="stringliteral">&quot;relBeamGateNS/I&quot;</span>); <span class="comment">// ROOT 6.24 can&#39;t handle `long` neither</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;waveformTime&quot;</span>, &amp;data.waveformTime);</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;waveformSize&quot;</span>, &amp;data.waveformSize);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;triggerBits&quot;</span>, &amp;data.triggerBits);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;gateCount&quot;</span>, &amp;data.gateCount);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  tree-&gt;Branch(<span class="stringliteral">&quot;onGlobal&quot;</span>, &amp;data.onGlobalTrigger);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::initFragmentsTree()</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac5ef29446afadd6d6d4eb60287205aaf">icarus::DaqDecoderICARUSPMT::usesEventInfo</a>() {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="comment">// the allocation of fEventInfo is the flag for event information usage</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="keywordflow">if</span> (!fEventInfo) fEventInfo = std::make_unique&lt;TreeData_EventID_t&gt;();</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::usesEventInfo()</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a39d5cb9cdf05610a9aef296d878902f4">icarus::DaqDecoderICARUSPMT::assignEventInfo</a></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  (TreeData_EventID_t&amp; treeData)<span class="keyword"> const</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  assert(fEventInfo);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  treeData = *fEventInfo; <span class="comment">// nice slicing</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::assignEventInfo()</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#afb4eb9e49b749047813892670db8e89f">icarus::DaqDecoderICARUSPMT::fillTreeEventID</a></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  (art::Event <span class="keyword">const</span>&amp; event, TreeData_EventID_t&amp; treeData)<span class="keyword"> const</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  art::EventID <span class="keyword">const</span>&amp; <span class="keywordtype">id</span> = <span class="keyword">event</span>.id();</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  treeData.run    = <span class="keywordtype">id</span>.run();</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  treeData.subrun = <span class="keywordtype">id</span>.subRun();</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  treeData.event  = <span class="keywordtype">id</span>.event();</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  art::Timestamp <span class="keyword">const</span>&amp; timestamp = <span class="keyword">event</span>.time();</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  treeData.timestamp</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    = { <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(timestamp.timeHigh()), timestamp.timeLow() };</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  </div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;} <span class="comment">// icarus::DaqDecoderICARUSPMT::fillTreeEventID()</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;DEFINE_ART_MODULE(<a class="code" href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html">icarus::DaqDecoderICARUSPMT</a>)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig_html_a8ead9416959f5606724e4d2815fb0583"><div class="ttname"><a href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a8ead9416959f5606724e4d2815fb0583">icarus::DaqDecoderICARUSPMT::BoardSetupConfig::TriggerDelay</a></div><div class="ttdeci">fhicl::Atom&lt; nanoseconds &gt; TriggerDelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00402">DaqDecoderICARUSPMT_module.cc:402</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a1bc4a4203e4d7c48176fd7c64903b34a"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1bc4a4203e4d7c48176fd7c64903b34a">icarus::DaqDecoderICARUSPMT::fetchNeededBoardInfo</a></div><div class="ttdeci">NeededBoardInfo_t fetchNeededBoardInfo(daq::details::BoardInfoLookup::BoardInfo_t const *boardInfo, unsigned int fragmentID) const </div><div class="ttdoc">Puts together all the needed information for a board. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t_html_a021572fa40002ad48c0095d2efebfa7d"><div class="ttname"><a href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a021572fa40002ad48c0095d2efebfa7d">icarus::DaqDecoderICARUSPMT::TreeData_EventID_t::event</a></div><div class="ttdeci">unsigned int event</div><div class="ttdoc">Event number. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00695">DaqDecoderICARUSPMT_module.cc:695</a></div></div>
<div class="ttc" id="BeamBits_8h_html"><div class="ttname"><a href="../../de/da7/BeamBits_8h.html">BeamBits.h</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ac444eb16f496b54eb2c99b47997cbfd6"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac444eb16f496b54eb2c99b47997cbfd6">icarus::DaqDecoderICARUSPMT::fDetTimings</a></div><div class="ttdeci">detinfo::DetectorTimings const fDetTimings</div><div class="ttdoc">Interface to LArSoft configuration for detector timing. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00593">DaqDecoderICARUSPMT_module.cc:593</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a6ce17c24e859ea0eef5ab6b9d17305f7"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6ce17c24e859ea0eef5ab6b9d17305f7">icarus::DaqDecoderICARUSPMT::beginRun</a></div><div class="ttdeci">void beginRun(art::Run &amp;run) override</div><div class="ttdoc">On a new run: cache PMT configuration information. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t</a></div><div class="ttdoc">Information used in decoding from a board. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00540">DaqDecoderICARUSPMT_module.cc:540</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a79fb8a50bd83ae7f98d72195d3da1ad3"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a79fb8a50bd83ae7f98d72195d3da1ad3">icarus::DaqDecoderICARUSPMT::fBoardSetup</a></div><div class="ttdeci">std::vector&lt; daq::details::BoardSetup_t &gt; const fBoardSetup</div><div class="ttdoc">All board setup settings. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00583">DaqDecoderICARUSPMT_module.cc:583</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig_html_a475612a63ecc9041269c3bde7f291935"><div class="ttname"><a href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a475612a63ecc9041269c3bde7f291935">icarus::DaqDecoderICARUSPMT::BoardSetupConfig::FragmentID</a></div><div class="ttdeci">fhicl::OptionalAtom&lt; unsigned int &gt; FragmentID</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00397">DaqDecoderICARUSPMT_module.cc:397</a></div></div>
<div class="ttc" id="structsbn_1_1V1730Configuration_html_afe97e722dd925a04f049c6b2e6113372"><div class="ttname"><a href="../../df/d9c/structsbn_1_1V1730Configuration.html#afe97e722dd925a04f049c6b2e6113372">sbn::V1730Configuration::boardName</a></div><div class="ttdeci">std::string boardName</div><div class="ttdoc">Name (mnemonic) of the board. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d54/V1730Configuration_8h_source.html#l00052">V1730Configuration.h:52</a></div></div>
<div class="ttc" id="classicarusDB_1_1IICARUSChannelMap_html"><div class="ttname"><a href="../../d2/d1f/classicarusDB_1_1IICARUSChannelMap.html">icarusDB::IICARUSChannelMap</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d37/IICARUSChannelMap_8h_source.html#l00034">IICARUSChannelMap.h:34</a></div></div>
<div class="ttc" id="namespacepmtana_html_a9860e62c78db1dd9c7d635a2832b883a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">pmtana::std</a></div><div class="ttdeci">double std(const std::vector&lt; short &gt; &amp;wf, const double ped_mean, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00042">UtilFunc.cxx:42</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ac5ef29446afadd6d6d4eb60287205aaf"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac5ef29446afadd6d6d4eb60287205aaf">icarus::DaqDecoderICARUSPMT::usesEventInfo</a></div><div class="ttdeci">void usesEventInfo()</div><div class="ttdoc">Declares the use of event information. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_aff651d2ec32b3218f16546ecc536ed94"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aff651d2ec32b3218f16546ecc536ed94">icarus::DaqDecoderICARUSPMT::endJob</a></div><div class="ttdeci">void endJob() override</div><div class="ttdoc">Prints a end-of-job message. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig_html_a9c25e7795e8df92705f9b433e1c74c66"><div class="ttname"><a href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a9c25e7795e8df92705f9b433e1c74c66">icarus::DaqDecoderICARUSPMT::BoardSetupConfig::Name</a></div><div class="ttdeci">fhicl::Atom&lt; std::string &gt; Name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00392">DaqDecoderICARUSPMT_module.cc:392</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a0ead396e4ef1ce58cedf14a3c12f2055"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0ead396e4ef1ce58cedf14a3c12f2055">icarus::DaqDecoderICARUSPMT::TreeNameList_t</a></div><div class="ttdeci">std::array&lt; std::string, static_cast&lt; std::size_t &gt;(DataTrees::N)&gt; TreeNameList_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00351">DaqDecoderICARUSPMT_module.cc:351</a></div></div>
<div class="ttc" id="detectorproperties__icarus_8fcl_html_acfd440223f806c44323dbd1053b99123"><div class="ttname"><a href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a></div><div class="ttdeci">second</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d33/detectorproperties__icarus_8fcl_source.html#l00008">detectorproperties_icarus.fcl:8</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig_html_a2ec2c73c5e5163e23cb373e389329f78"><div class="ttname"><a href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html#a2ec2c73c5e5163e23cb373e389329f78">icarus::DaqDecoderICARUSPMT::BoardSetupConfig::TTTresetDelay</a></div><div class="ttdeci">fhicl::Atom&lt; nanoseconds &gt; TTTresetDelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00409">DaqDecoderICARUSPMT_module.cc:409</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a1de65f72a8ba642fefeaefd3f5afe412"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1de65f72a8ba642fefeaefd3f5afe412">icarus::DaqDecoderICARUSPMT::fillPMTfragmentTree</a></div><div class="ttdeci">void fillPMTfragmentTree(FragmentInfo_t const &amp;fragInfo, TriggerInfo_t const &amp;triggerInfo, electronics_time waveformTimestamp)</div></div>
<div class="ttc" id="namespaceicarusDB_html_a0b2ff93e818861e19ade3a1b82e3a417"><div class="ttname"><a href="../../de/d35/namespaceicarusDB.html#a0b2ff93e818861e19ade3a1b82e3a417">icarusDB::DigitizerChannelChannelIDPairVec</a></div><div class="ttdeci">std::vector&lt; DigitizerChannelChannelIDPair &gt; DigitizerChannelChannelIDPairVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d37/IICARUSChannelMap_8h_source.html#l00027">IICARUSChannelMap.h:27</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ad4a3c040261c685aa7bf394e34a50b47"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad4a3c040261c685aa7bf394e34a50b47">icarus::DaqDecoderICARUSPMT::fSurviveExceptions</a></div><div class="ttdeci">bool const fSurviveExceptions</div><div class="ttdoc">Whether to &amp;quot;ignore&amp;quot; errors. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00561">DaqDecoderICARUSPMT_module.cc:561</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ada0f8e56ef713abb702df4d7e4ba0878"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ada0f8e56ef713abb702df4d7e4ba0878">icarus::DaqDecoderICARUSPMT::neededBoardInfo</a></div><div class="ttdeci">NeededBoardInfo_t neededBoardInfo(artdaq::Fragment::fragment_id_t fragment_id) const </div><div class="ttdoc">Returns the board information for this fragment. </div></div>
<div class="ttc" id="group__LArSoft__CoreUtils__StdUtils_html_ga4288f30cfde6d98d0f8faf9a386f86d0"><div class="ttname"><a href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga4288f30cfde6d98d0f8faf9a386f86d0">util::cend</a></div><div class="ttdeci">decltype(auto) constexpr cend(T &amp;&amp;obj)</div><div class="ttdoc">ADL-aware version of std::cend. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de2/StdUtils_8h_source.html#l00087">StdUtils.h:87</a></div></div>
<div class="ttc" id="namespaceutil_1_1fhicl_html_a7a710f4f9eb8ce2c8206162757289de0"><div class="ttname"><a href="../../da/d95/namespaceutil_1_1fhicl.html#a7a710f4f9eb8ce2c8206162757289de0">util::fhicl::getOptionalValue</a></div><div class="ttdeci">std::optional&lt; typename Optional::value_type &gt; getOptionalValue(Optional const &amp;parameter)</div><div class="ttdoc">Returns the value of an optional parameter as std::optional. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de6/FHiCLutils_8h_source.html#l00188">FHiCLutils.h:188</a></div></div>
<div class="ttc" id="classraw_1_1OpDetWaveform_html_a78d2f3fb8936c775128580505ec61ae2"><div class="ttname"><a href="../../d0/d29/classraw_1_1OpDetWaveform.html#a78d2f3fb8936c775128580505ec61ae2">raw::OpDetWaveform::ChannelNumber</a></div><div class="ttdeci">Channel_t ChannelNumber() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h_source.html#l00065">lardataobj/lardataobj/RawData/OpDetWaveform.h:65</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ae787bc4b86f2a6cdc478df20d233b604"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ae787bc4b86f2a6cdc478df20d233b604">icarus::DaqDecoderICARUSPMT::produce</a></div><div class="ttdeci">void produce(art::Event &amp;event) override</div><div class="ttdoc">Processes the event. </div></div>
<div class="ttc" id="classraw_1_1OpDetWaveform_html"><div class="ttname"><a href="../../d0/d29/classraw_1_1OpDetWaveform.html">raw::OpDetWaveform</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h_source.html#l00025">lardataobj/lardataobj/RawData/OpDetWaveform.h:25</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1Config_html_ae72c4be677628d6877bb27d23b3dbf31"><div class="ttname"><a href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#ae72c4be677628d6877bb27d23b3dbf31">icarus::DaqDecoderICARUSPMT::Config::Name</a></div><div class="ttdeci">fhicl::Name Name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00422">DaqDecoderICARUSPMT_module.cc:422</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t_html_a04a561fb116904daf82f299524571e1c"><div class="ttname"><a href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a04a561fb116904daf82f299524571e1c">icarus::DaqDecoderICARUSPMT::FragmentInfo_t::fragmentID</a></div><div class="ttdeci">artdaq::Fragment::fragment_id_t fragmentID</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00530">DaqDecoderICARUSPMT_module.cc:530</a></div></div>
<div class="ttc" id="classraw_1_1OpDetWaveform_html_a12a5306398b04085c936ced39e16f192"><div class="ttname"><a href="../../d0/d29/classraw_1_1OpDetWaveform.html#a12a5306398b04085c936ced39e16f192">raw::OpDetWaveform::TimeStamp</a></div><div class="ttdeci">TimeStamp_t TimeStamp() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h_source.html#l00066">lardataobj/lardataobj/RawData/OpDetWaveform.h:66</a></div></div>
<div class="ttc" id="classdaq_1_1details_1_1BoardInfoLookup_html"><div class="ttname"><a href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html">daq::details::BoardInfoLookup</a></div><div class="ttdoc">Utility class for fast lookup of board data by fragment ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00090">PMTDecoderUtils.h:90</a></div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardFacts__t_html"><div class="ttname"><a href="../../d6/dbc/structdaq_1_1details_1_1BoardFacts__t.html">daq::details::BoardFacts_t</a></div><div class="ttdoc">Derivative information of a V1730 readout board. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00059">PMTDecoderUtils.h:59</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t_html"><div class="ttname"><a href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html">icarus::DaqDecoderICARUSPMT::TreeData_EventID_t</a></div><div class="ttdoc">Data structure for basic event information in simple ROOT trees. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00692">DaqDecoderICARUSPMT_module.cc:692</a></div></div>
<div class="ttc" id="enumerate_8h_html"><div class="ttname"><a href="../../d5/d85/enumerate_8h.html">enumerate.h</a></div><div class="ttdoc">Definition of util::enumerate(). </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a232868c27b2e6c33f947d8eff2d64d26"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a232868c27b2e6c33f947d8eff2d64d26">icarus::DaqDecoderICARUSPMT::extractTriggerTimeTag</a></div><div class="ttdeci">static unsigned int extractTriggerTimeTag(artdaq::Fragment const &amp;fragment)</div><div class="ttdoc">Extracts the Trigger Time Tag (31+1 bits) value from the fragment. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ac77b2241f3748694113a37725ba99f47"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ac77b2241f3748694113a37725ba99f47">icarus::DaqDecoderICARUSPMT::DataTrees</a></div><div class="ttdeci">DataTrees</div><div class="ttdoc">Enumerate the supported data trees. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00346">DaqDecoderICARUSPMT_module.cc:346</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_1_1intervals_html_a07912d3786fd25377de6216b0c77b532"><div class="ttname"><a href="../../d9/d1a/namespaceutil_1_1quantities_1_1intervals.html#a07912d3786fd25377de6216b0c77b532">util::quantities::intervals::microseconds</a></div><div class="ttdeci">microseconds_as&lt;&gt; microseconds</div><div class="ttdoc">Type of time interval stored in microseconds, in double precision. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6e/spacetime_8h_source.html#l00259">spacetime.h:259</a></div></div>
<div class="ttc" id="IICARUSChannelMap_8h_html"><div class="ttname"><a href="../../d3/d37/IICARUSChannelMap_8h.html">IICARUSChannelMap.h</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_aa4c48ee344972b09a388873cbd27962b"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aa4c48ee344972b09a388873cbd27962b">icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromFragment</a></div><div class="ttdeci">artdaq::FragmentPtrs makeFragmentCollectionFromFragment(artdaq::Fragment const &amp;sourceFragment) const </div><div class="ttdoc">Converts a plain fragment into a fragment collection. </div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_abb587b1f392bbec78ffd3caa4db30141"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abb587b1f392bbec78ffd3caa4db30141">icarus::DaqDecoderICARUSPMT::fRequireKnownBoards</a></div><div class="ttdeci">bool const fRequireKnownBoards</div><div class="ttdoc">Whether info on all input boards is required. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00569">DaqDecoderICARUSPMT_module.cc:569</a></div></div>
<div class="ttc" id="generate__icarus__geometry__splitwire_8pl_html_a09c6b60bb7451f9136e25140ffdff6bd"><div class="ttname"><a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a></div><div class="ttdeci">#define the</div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a5bfa1a4b2ace04446c30ddb9c95a3a94"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a5bfa1a4b2ace04446c30ddb9c95a3a94">icarus::DaqDecoderICARUSPMT::mergeWaveforms</a></div><div class="ttdeci">unsigned int mergeWaveforms(std::vector&lt; raw::OpDetWaveform &gt; &amp;waveforms) const </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html_a9271ad5be0f89a2afee59e8f4c77a786"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a9271ad5be0f89a2afee59e8f4c77a786">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t::name</a></div><div class="ttdeci">std::string const name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00541">DaqDecoderICARUSPMT_module.cc:541</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t_html_a61496d3d3fa104ba68e5e0f83ba72f1f"><div class="ttname"><a href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a61496d3d3fa104ba68e5e0f83ba72f1f">icarus::DaqDecoderICARUSPMT::TreeFragment_t::Data_t::relBeamGate</a></div><div class="ttdeci">long int relBeamGate</div><div class="ttdoc">Beam gate start relative to trigger [ns]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00714">DaqDecoderICARUSPMT_module.cc:714</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t_html"><div class="ttname"><a href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html">icarus::DaqDecoderICARUSPMT::FragmentInfo_t</a></div><div class="ttdoc">Collection of useful information from fragment data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00528">DaqDecoderICARUSPMT_module.cc:528</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t_html"><div class="ttname"><a href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html">icarus::DaqDecoderICARUSPMT::TreeFragment_t::Data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00701">DaqDecoderICARUSPMT_module.cc:701</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a0d8c1c9a9b236c52d18da6c7c81a1007"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a0d8c1c9a9b236c52d18da6c7c81a1007">icarus::DaqDecoderICARUSPMT::fNominalTriggerTime</a></div><div class="ttdeci">electronics_time const fNominalTriggerTime</div><div class="ttdoc">Trigger time as reported by detinfo::DetectorClocks service. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00607">DaqDecoderICARUSPMT_module.cc:607</a></div></div>
<div class="ttc" id="namespacelarg4_html_a42b3ada02e272fe2fa2b641ba06ab7d4"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">larg4::bool</a></div><div class="ttdeci">static constexpr bool</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00588">OpFastScintillation.hh:588</a></div></div>
<div class="ttc" id="PMTDecoderUtils_8h_html"><div class="ttname"><a href="../../d3/d40/PMTDecoderUtils_8h.html">PMTDecoderUtils.h</a></div><div class="ttdoc">Some helpers for PMT decoder tool. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a36259032ee3e2aadbfcbfd48f92068d1"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a36259032ee3e2aadbfcbfd48f92068d1">icarus::DaqDecoderICARUSPMT::processFragment</a></div><div class="ttdeci">std::vector&lt; raw::OpDetWaveform &gt; processFragment(artdaq::Fragment const &amp;artdaqFragment, NeededBoardInfo_t const &amp;boardInfo, TriggerInfo_t const &amp;triggerInfo)</div><div class="ttdoc">Create waveforms and fills trees for the specified artDAQ fragment. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ab4515084300ae5c65747a4db8eb9f454"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab4515084300ae5c65747a4db8eb9f454">icarus::DaqDecoderICARUSPMT::waveformEndTime</a></div><div class="ttdeci">electronics_time waveformEndTime(raw::OpDetWaveform const &amp;wf) const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00860">DaqDecoderICARUSPMT_module.cc:860</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ab841a6615fbbc7775109bc0c27fdcc42"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab841a6615fbbc7775109bc0c27fdcc42">icarus::DaqDecoderICARUSPMT::fetchTriggerTimestamp</a></div><div class="ttdeci">TriggerInfo_t fetchTriggerTimestamp(art::Event const &amp;event) const </div><div class="ttdoc">Retrieves the global trigger time stamp from the event. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a39d5cb9cdf05610a9aef296d878902f4"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a39d5cb9cdf05610a9aef296d878902f4">icarus::DaqDecoderICARUSPMT::assignEventInfo</a></div><div class="ttdeci">void assignEventInfo(TreeData_EventID_t &amp;treeData) const </div><div class="ttdoc">Assigns the cached event information to the specified tree data. </div></div>
<div class="ttc" id="classdaq_1_1details_1_1BoardInfoLookup_html_a4782907bf07f9600e16310d8d73ac17c"><div class="ttname"><a href="../../d3/d5f/classdaq_1_1details_1_1BoardInfoLookup.html#a4782907bf07f9600e16310d8d73ac17c">daq::details::BoardInfoLookup::Database_t</a></div><div class="ttdeci">std::vector&lt; BoardInfo_t &gt; Database_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00106">PMTDecoderUtils.h:106</a></div></div>
<div class="ttc" id="DetectorClocks_8h_html"><div class="ttname"><a href="../../d9/de4/DetectorClocks_8h.html">DetectorClocks.h</a></div><div class="ttdoc">pure virtual base interface for detector clocks </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a6de83fb86b69c02be16ff45bd61add98"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6de83fb86b69c02be16ff45bd61add98">icarus::DaqDecoderICARUSPMT::checkFragmentType</a></div><div class="ttdeci">void checkFragmentType(artdaq::Fragment const &amp;artdaqFragment) const </div><div class="ttdoc">Throws an exception if artdaqFragment is not of type CAEN1730. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_html"><div class="ttname"><a href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html">icarus::DaqDecoderICARUSPMT::TreeFragment_t</a></div><div class="ttdoc">Structure collecting all data for a fragment ROOT tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00700">DaqDecoderICARUSPMT_module.cc:700</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ad7a058835202a95cca537b3c97ca3b81"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad7a058835202a95cca537b3c97ca3b81">icarus::DaqDecoderICARUSPMT::timestampDiff</a></div><div class="ttdeci">static long long int timestampDiff(std::uint64_t a, std::uint64_t b)</div><div class="ttdoc">Returns the timestamp difference a - b. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00789">DaqDecoderICARUSPMT_module.cc:789</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a512aa20fb28b8c00f3d290ba176b40e1"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">icarus::ns::util::bin</a></div><div class="ttdeci">constexpr details::BinObj&lt; T &gt; bin(T value)</div><div class="ttdoc">Returns a wrapper to print the specified data in binary format. </div></div>
<div class="ttc" id="structsbn_1_1V1730Configuration_html_a294d44ef7389cd6a6ee87b81619775fb"><div class="ttname"><a href="../../df/d9c/structsbn_1_1V1730Configuration.html#a294d44ef7389cd6a6ee87b81619775fb">sbn::V1730Configuration::fragmentID</a></div><div class="ttdeci">unsigned int fragmentID</div><div class="ttdoc">DAQ fragment ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d54/V1730Configuration_8h_source.html#l00058">V1730Configuration.h:58</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t_html_a47e1379b1a07905c2557ede62a84ab13"><div class="ttname"><a href="../../d5/d53/structicarus_1_1DaqDecoderICARUSPMT_1_1FragmentInfo__t.html#a47e1379b1a07905c2557ede62a84ab13">icarus::DaqDecoderICARUSPMT::FragmentInfo_t::fragmentTimestamp</a></div><div class="ttdeci">artdaq::Fragment::timestamp_t fragmentTimestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00531">DaqDecoderICARUSPMT_module.cc:531</a></div></div>
<div class="ttc" id="DetectorTimings_8h_html"><div class="ttname"><a href="../../d8/dd2/DetectorTimings_8h.html">DetectorTimings.h</a></div><div class="ttdoc">Interface to detinfo::DetectorClocks. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html_a97da42f00664b6b8cf940ad2d3ecb37f"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a97da42f00664b6b8cf940ad2d3ecb37f">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t::PMTtriggerDelay</a></div><div class="ttdeci">nanoseconds PMTtriggerDelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00544">DaqDecoderICARUSPMT_module.cc:544</a></div></div>
<div class="ttc" id="decode__signalprocess__icarus_8fcl_html_a2a105cb669129f9c63eb7a4c15bf2d9b"><div class="ttname"><a href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a></div><div class="ttdeci">process_name gaushit a</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/decode__signalprocess__icarus_8fcl_source.html#l00037">decode_signalprocess_icarus.fcl:37</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ab654b2336af704e22b6b6a37633d48a2"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab654b2336af704e22b6b6a37633d48a2">icarus::DaqDecoderICARUSPMT::makeFragmentCollectionFromContainerFragment</a></div><div class="ttdeci">artdaq::FragmentPtrs makeFragmentCollectionFromContainerFragment(artdaq::Fragment const &amp;sourceFragment) const </div><div class="ttdoc">Converts a container fragment into a fragment collection. </div></div>
<div class="ttc" id="structsbn_1_1V1730Configuration_html_a3a67e93e4a5f9f3c63fc98867ed0aeb0"><div class="ttname"><a href="../../df/d9c/structsbn_1_1V1730Configuration.html#a3a67e93e4a5f9f3c63fc98867ed0aeb0">sbn::V1730Configuration::bufferLength</a></div><div class="ttdeci">unsigned int bufferLength</div><div class="ttdoc">Ticks in each buffer (recordLength). </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d54/V1730Configuration_8h_source.html#l00061">V1730Configuration.h:61</a></div></div>
<div class="ttc" id="ExtractEnergyDepositionSummary__module_8cc_html_acd3b4ca7dde97531463d00d3714eecc5"><div class="ttname"><a href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc.html#acd3b4ca7dde97531463d00d3714eecc5">fLogCategory</a></div><div class="ttdeci">fDetProps &amp;fDetProps fDetProps &amp;fDetProps fLogCategory</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d11/ExtractEnergyDepositionSummary__module_8cc_source.html#l00301">ExtractEnergyDepositionSummary_module.cc:301</a></div></div>
<div class="ttc" id="group__LArSoft__CoreUtils__StdUtils_html_gaa1d0cd0cbac37bc1ca4c84daf5343973"><div class="ttname"><a href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#gaa1d0cd0cbac37bc1ca4c84daf5343973">util::end</a></div><div class="ttdeci">decltype(auto) constexpr end(T &amp;&amp;obj)</div><div class="ttdoc">ADL-aware version of std::end. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de2/StdUtils_8h_source.html#l00077">StdUtils.h:77</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t_html_a84a5c2adda193a31aa7f9310edda32d7"><div class="ttname"><a href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html#a84a5c2adda193a31aa7f9310edda32d7">daq::details::BoardInfoLookup::BoardInfo_t::fragmentID</a></div><div class="ttdeci">FragmentID_t fragmentID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00097">PMTDecoderUtils.h:97</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a3b67329b1814a67bc9ad3d6b3ef87ed8"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a3b67329b1814a67bc9ad3d6b3ef87ed8">icarus::DaqDecoderICARUSPMT::matchBoardConfigurationAndSetup</a></div><div class="ttdeci">daq::details::BoardInfoLookup matchBoardConfigurationAndSetup(sbn::PMTconfiguration const *PMTconfig) const </div><div class="ttdoc">Returns a lookup object with board setup and configuration info. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t_html_a9638efe2fcf5e4aac24bb4ec58c1e046"><div class="ttname"><a href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#a9638efe2fcf5e4aac24bb4ec58c1e046">icarus::DaqDecoderICARUSPMT::TriggerInfo_t::time</a></div><div class="ttdeci">SplitTimestamp_t time</div><div class="ttdoc">Time of the trigger (absolute). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00550">DaqDecoderICARUSPMT_module.cc:550</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a57c6989ec1720bf1990121079f267a51"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a57c6989ec1720bf1990121079f267a51">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampFromTTT</a></div><div class="ttdeci">electronics_time fragmentWaveformTimestampFromTTT(FragmentInfo_t const &amp;fragInfo, NeededBoardInfo_t const &amp;boardInfo, SplitTimestamp_t triggerTime) const </div><div class="ttdoc">Returns the timestamp for the waveforms in the specified fragment. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a9ff39239832f377083789b0a682edd72"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a9ff39239832f377083789b0a682edd72">icarus::DaqDecoderICARUSPMT::initEventIDtree</a></div><div class="ttdeci">void initEventIDtree(TTree &amp;tree, TreeData_EventID_t &amp;data)</div><div class="ttdoc">Initializes the event ID part of a tree. </div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classraw_1_1Trigger_html"><div class="ttname"><a href="../../dd/d0b/classraw_1_1Trigger.html">raw::Trigger</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/TriggerData_8h_source.html#l00011">TriggerData.h:11</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig_html"><div class="ttname"><a href="../../d4/dbb/structicarus_1_1DaqDecoderICARUSPMT_1_1BoardSetupConfig.html">icarus::DaqDecoderICARUSPMT::BoardSetupConfig</a></div><div class="ttdoc">Configuration of the V1730 readout board setup. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00390">DaqDecoderICARUSPMT_module.cc:390</a></div></div>
<div class="ttc" id="namespacesbn_1_1bits_html_a3b8fd0787ccd1963c6aa5c8bf17f4290"><div class="ttname"><a href="../../de/d90/namespacesbn_1_1bits.html#a3b8fd0787ccd1963c6aa5c8bf17f4290">sbn::bits::mask</a></div><div class="ttdeci">constexpr mask_t&lt; EnumType &gt; mask(EnumType bit, OtherBits...otherBits)</div><div class="ttdoc">Returns a mask with all specified bits set. </div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_adfc119c26975d3bfdc7c6d81dda11f1d"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#adfc119c26975d3bfdc7c6d81dda11f1d">group</a></div><div class="ttdeci">then echo group</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="structsbn_1_1ExtraTriggerInfo_html"><div class="ttname"><a href="../../dc/d51/structsbn_1_1ExtraTriggerInfo.html">sbn::ExtraTriggerInfo</a></div><div class="ttdoc">Additional information on trigger. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d44/ExtraTriggerInfo_8h_source.html#l00044">ExtraTriggerInfo.h:44</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a7b9b5eb89e02611bfe143e75f6eb1e22"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a7b9b5eb89e02611bfe143e75f6eb1e22">util::quantities::seconds</a></div><div class="ttdeci">second seconds</div><div class="ttdoc">Alias for common language habits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6e/spacetime_8h_source.html#l00088">spacetime.h:88</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t_html_ad63c08fbea20716b9edb464c6bbc0d8b"><div class="ttname"><a href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html#ad63c08fbea20716b9edb464c6bbc0d8b">icarus::DaqDecoderICARUSPMT::TriggerInfo_t::relBeamGateTime</a></div><div class="ttdeci">long int relBeamGateTime</div><div class="ttdoc">Time of beam gate relative to trigger [ns]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00551">DaqDecoderICARUSPMT_module.cc:551</a></div></div>
<div class="ttc" id="namespaceicarus_html_a4949202c39928a2a4840f75ae371bfcf"><div class="ttname"><a href="../../da/d4d/namespaceicarus.html#a4949202c39928a2a4840f75ae371bfcf">icarus::convert</a></div><div class="ttdeci">daq::details::BoardSetup_t convert(DaqDecoderICARUSPMT::BoardSetupConfig const &amp;config)</div><div class="ttdoc">Special function fhicl::TableAs uses to convert BoardSetupConfig. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00985">DaqDecoderICARUSPMT_module.cc:985</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a47d27bbd6827c7e4630825ff57939519"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a47d27bbd6827c7e4630825ff57939519">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestamp</a></div><div class="ttdeci">electronics_time fragmentWaveformTimestamp(FragmentInfo_t const &amp;fragInfo, NeededBoardInfo_t const &amp;boardInfo, SplitTimestamp_t triggerTime) const </div><div class="ttdoc">Returns the timestamp for the waveforms in the specified fragment. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a63e07abeb25ed8d648a3a11ea36a8edd"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a63e07abeb25ed8d648a3a11ea36a8edd">icarus::DaqDecoderICARUSPMT::extractFragmentInfo</a></div><div class="ttdeci">FragmentInfo_t extractFragmentInfo(artdaq::Fragment const &amp;artdaqFragment) const </div><div class="ttdoc">Extracts useful information from fragment data. </div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a81b45a59e7128f35719a7ba55a0f8370"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a81b45a59e7128f35719a7ba55a0f8370">geo::vect::indices</a></div><div class="ttdeci">constexpr std::array&lt; std::size_t, geo::vect::dimension&lt; Vector &gt;)&gt; indices()</div><div class="ttdoc">Returns a sequence of indices valid for a vector of the specified type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l02022">geo_vectors_utils.h:2022</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a49fa56184ca98d1407b221b75f240bf6"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a49fa56184ca98d1407b221b75f240bf6">icarus::DaqDecoderICARUSPMT::fInputTags</a></div><div class="ttdeci">std::vector&lt; art::InputTag &gt; const fInputTags</div><div class="ttdoc">&amp;lt; List of candidate data products with artDAQ data fragments. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00559">DaqDecoderICARUSPMT_module.cc:559</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_af5e7a608a4167b338f51929d63f70ff7"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#af5e7a608a4167b338f51929d63f70ff7">icarus::DaqDecoderICARUSPMT::findWaveformsWithNominalTrigger</a></div><div class="ttdeci">std::vector&lt; raw::OpDetWaveform const * &gt; findWaveformsWithNominalTrigger(std::vector&lt; raw::OpDetWaveform &gt; const &amp;waveforms) const </div><div class="ttdoc">Returns pointers to all waveforms including the nominal trigger time. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a838c612581e7404dbeade49316a27008"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a838c612581e7404dbeade49316a27008">icarus::DaqDecoderICARUSPMT::fBoardInfoLookup</a></div><div class="ttdeci">std::optional&lt; daq::details::BoardInfoLookup &gt; fBoardInfoLookup</div><div class="ttdoc">Find the information on a readout boards by fragment ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00615">DaqDecoderICARUSPMT_module.cc:615</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html_acc3306221dc34c54077491cb7d8509e3"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#acc3306221dc34c54077491cb7d8509e3">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t::TTTresetDelay</a></div><div class="ttdeci">nanoseconds TTTresetDelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00545">DaqDecoderICARUSPMT_module.cc:545</a></div></div>
<div class="ttc" id="namespaceSortModuleTimes_html_a805854df4323f914a9a09f4e266b4794"><div class="ttname"><a href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">SortModuleTimes.const</a></div><div class="ttdeci">string const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df3/SortModuleTimes_8py_source.html#l00871">SortModuleTimes.py:871</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html_a8304fba7380518d7482888cc74416cbf"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#a8304fba7380518d7482888cc74416cbf">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t::preTriggerTime</a></div><div class="ttdeci">nanoseconds preTriggerTime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00543">DaqDecoderICARUSPMT_module.cc:543</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a135c6ee981d13b84cda2ad24b0265f86"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a135c6ee981d13b84cda2ad24b0265f86">icarus::DaqDecoderICARUSPMT::Parameters</a></div><div class="ttdeci">art::EDProducer::Table&lt; Config &gt; Parameters</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00502">DaqDecoderICARUSPMT_module.cc:502</a></div></div>
<div class="ttc" id="selectors_8fcl_html_aadc113fa4af9aeff01481eed2a98e7cc"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#aadc113fa4af9aeff01481eed2a98e7cc">and</a></div><div class="ttdeci">return match has_match and(match.match_pdg==11 or match.match_pdg==-11)</div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_abe100ec9a3c0b567ceee486359c294d3"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#abe100ec9a3c0b567ceee486359c294d3">icarus::DaqDecoderICARUSPMT::fDiagnosticOutput</a></div><div class="ttdeci">bool const fDiagnosticOutput</div><div class="ttdoc">If true will spew endless messages to output. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00564">DaqDecoderICARUSPMT_module.cc:564</a></div></div>
<div class="ttc" id="geometry__icarus_8fcl_html_a7cd432ab9c92d3d70fdf422ed970e9d3"><div class="ttname"><a href="../../df/d20/geometry__icarus_8fcl.html#a7cd432ab9c92d3d70fdf422ed970e9d3">Name</a></div><div class="ttdeci">BEGIN_PROLOG vertical distance to the surface Name</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d20/geometry__icarus_8fcl_source.html#l00082">geometry_icarus.fcl:82</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a247d0d387770cf629dd7f60d7069a4a8"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a247d0d387770cf629dd7f60d7069a4a8">icarus::DaqDecoderICARUSPMT::initFragmentsTree</a></div><div class="ttdeci">void initFragmentsTree()</div><div class="ttdoc">Initializes the fragment data tree (fTreeFragment). </div></div>
<div class="ttc" id="selectors_8fcl_html_a1abc6b9e279feba048394f49a85218c9"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a></div><div class="ttdeci">walls no left</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="PMTconfiguration_8h_html"><div class="ttname"><a href="../../de/d9b/PMTconfiguration_8h.html">PMTconfiguration.h</a></div><div class="ttdoc">Information from the configuration of PMT readout. </div></div>
<div class="ttc" id="counter_8h_html"><div class="ttname"><a href="../../d7/da2/counter_8h.html">counter.h</a></div><div class="ttdoc">Test of util::counter and support utilities. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t_html_a738f55fe8800a2d2ab7b8a40bd5fc6a6"><div class="ttname"><a href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a738f55fe8800a2d2ab7b8a40bd5fc6a6">icarus::DaqDecoderICARUSPMT::TreeData_EventID_t::run</a></div><div class="ttdeci">unsigned int run</div><div class="ttdoc">Run number. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00693">DaqDecoderICARUSPMT_module.cc:693</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_html"><div class="ttname"><a href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html">icarus::DaqDecoderICARUSPMT::SplitTimestamp_t</a></div><div class="ttdoc">Data structure for trigger time. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00366">DaqDecoderICARUSPMT_module.cc:366</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a438d2305736f0fde62a8be59a2f151ee"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a438d2305736f0fde62a8be59a2f151ee">icarus::DaqDecoderICARUSPMT::fLogCategory</a></div><div class="ttdeci">std::string const fLogCategory</div><div class="ttdoc">Message facility category. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00585">DaqDecoderICARUSPMT_module.cc:585</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_adcb1a0b36ebf5b5d5e37cd6482855db1"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adcb1a0b36ebf5b5d5e37cd6482855db1">icarus::DaqDecoderICARUSPMT::fOpticalTick</a></div><div class="ttdeci">nanoseconds const fOpticalTick</div><div class="ttdoc">Duration of the optical detector readout sampling tick (i.e. 2 ns; hush!). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00604">DaqDecoderICARUSPMT_module.cc:604</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t_html"><div class="ttname"><a href="../../d0/dcf/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_1_1Split__t.html">icarus::DaqDecoderICARUSPMT::SplitTimestamp_t::Split_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00368">DaqDecoderICARUSPMT_module.cc:368</a></div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardSetup__t_html_a85d5c5b8ec289b33b00092a22c3946a0"><div class="ttname"><a href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html#a85d5c5b8ec289b33b00092a22c3946a0">daq::details::BoardSetup_t::NoFragmentID</a></div><div class="ttdeci">static constexpr unsigned int NoFragmentID</div><div class="ttdoc">Special value to mark the absence of fragment ID information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00042">PMTDecoderUtils.h:42</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_html_a217ade83103e1bf78048e7d5d9e1acae"><div class="ttname"><a href="../../dd/d11/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t.html#a217ade83103e1bf78048e7d5d9e1acae">icarus::DaqDecoderICARUSPMT::TreeFragment_t::data</a></div><div class="ttdeci">Data_t data</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00731">DaqDecoderICARUSPMT_module.cc:731</a></div></div>
<div class="ttc" id="structutil_1_1quantities_1_1concepts_1_1Interval_html"><div class="ttname"><a href="../../d2/dc6/structutil_1_1quantities_1_1concepts_1_1Interval.html">util::quantities::concepts::Interval</a></div><div class="ttdoc">An interval (duration, length, distance) between two quantity points. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d02/intervals_8h_source.html#l00114">intervals.h:114</a></div></div>
<div class="ttc" id="FragmentDumper_8h_html"><div class="ttname"><a href="../../d3/d98/FragmentDumper_8h.html">FragmentDumper.h</a></div><div class="ttdoc">Utility to dump a artDAQ fragment on screen. </div></div>
<div class="ttc" id="namespacedaq_1_1details_html_a4ea2b5b7f772d9564fceb250f6cc6255"><div class="ttname"><a href="../../da/db1/namespacedaq_1_1details.html#a4ea2b5b7f772d9564fceb250f6cc6255">daq::details::binarySearch</a></div><div class="ttdeci">Coll::value_type const * binarySearch(Coll const &amp;coll, Key const &amp;key, KeyExtractor &amp;&amp;extractKey)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00164">PMTDecoderUtils.h:164</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ad75ddf2ccb56140f08b197abb6ce1825"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ad75ddf2ccb56140f08b197abb6ce1825">icarus::DaqDecoderICARUSPMT::readInputFragments</a></div><div class="ttdeci">artdaq::Fragments const &amp; readInputFragments(art::Event const &amp;event) const </div><div class="ttdoc">Reads the fragments to be processed. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t_html_a12872da021fd8cc906eb5bfb8219fa10"><div class="ttname"><a href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a12872da021fd8cc906eb5bfb8219fa10">icarus::DaqDecoderICARUSPMT::TreeFragment_t::Data_t::trigger</a></div><div class="ttdeci">SplitTimestamp_t trigger</div><div class="ttdoc">Global trigger time. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00710">DaqDecoderICARUSPMT_module.cc:710</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a47e5c3353e8af594cb5eb6f3d728599f"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a47e5c3353e8af594cb5eb6f3d728599f">icarus::DaqDecoderICARUSPMT::fChannelMap</a></div><div class="ttdeci">icarusDB::IICARUSChannelMap const &amp; fChannelMap</div><div class="ttdoc">Fragment/channel mapping database. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00596">DaqDecoderICARUSPMT_module.cc:596</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a8f59cdf5a47d5d01736ff2d50a49a116"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8f59cdf5a47d5d01736ff2d50a49a116">icarus::DaqDecoderICARUSPMT::fTriggerTag</a></div><div class="ttdeci">std::optional&lt; art::InputTag &gt; const fTriggerTag</div><div class="ttdoc">Input tag of the global trigger. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00578">DaqDecoderICARUSPMT_module.cc:578</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a826bf5e4aa740023711cffc7f79247a0"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a826bf5e4aa740023711cffc7f79247a0">icarus::DaqDecoderICARUSPMT::waveformStartTime</a></div><div class="ttdeci">electronics_time waveformStartTime(raw::OpDetWaveform const &amp;wf) const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00857">DaqDecoderICARUSPMT_module.cc:857</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a94306ec50a954ef985926738a381dec9"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a94306ec50a954ef985926738a381dec9">icarus::DaqDecoderICARUSPMT::containsGlobalTrigger</a></div><div class="ttdeci">bool containsGlobalTrigger(raw::OpDetWaveform const &amp;waveform) const </div><div class="ttdoc">Returns whether waveform includes the tick of the nominal trigger time. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_html_ac58ee0d58238b45d1fcbe6b68c63325f"><div class="ttname"><a href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#ac58ee0d58238b45d1fcbe6b68c63325f">icarus::DaqDecoderICARUSPMT::SplitTimestamp_t::split</a></div><div class="ttdeci">Split_t split</div><div class="ttdoc">Trigger time in nanoseconds from The Epoch (in components). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00377">DaqDecoderICARUSPMT_module.cc:377</a></div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t_html"><div class="ttname"><a href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html">daq::details::BoardInfoLookup::BoardInfo_t</a></div><div class="ttdoc">Record of information about a readout board. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00096">PMTDecoderUtils.h:96</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_1_1intervals_html_a439758e928a1b5231e459628ae43fe98"><div class="ttname"><a href="../../d9/d1a/namespaceutil_1_1quantities_1_1intervals.html#a439758e928a1b5231e459628ae43fe98">util::quantities::intervals::nanoseconds</a></div><div class="ttdeci">nanoseconds_as&lt;&gt; nanoseconds</div><div class="ttdoc">Type of time interval stored in nanoseconds, in double precision. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6e/spacetime_8h_source.html#l00270">spacetime.h:270</a></div></div>
<div class="ttc" id="intervals__fhicl_8h_html"><div class="ttname"><a href="../../d4/d86/intervals__fhicl_8h.html">intervals_fhicl.h</a></div><div class="ttdoc">Utilities to read interval and point quantity FHiCL configuration. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_aa213442764bfc065bdc197b03fbcd7fb"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#aa213442764bfc065bdc197b03fbcd7fb">icarus::DaqDecoderICARUSPMT::UpdatePMTConfiguration</a></div><div class="ttdeci">bool UpdatePMTConfiguration(sbn::PMTconfiguration const *PMTconfig)</div><div class="ttdoc">Updates the PMT configuration cache. How? Dunno. Placeholder. </div></div>
<div class="ttc" id="DaqDecoderICARUSPMT__module_8cc_html_a3ef230cd8a36c55a34edb0651ec2752f"><div class="ttname"><a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc.html#a3ef230cd8a36c55a34edb0651ec2752f">fOpticalTick</a></div><div class="ttdeci">fOpticalTick</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l01108">DaqDecoderICARUSPMT_module.cc:1108</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a388517ebb73872038ab7f6fa7b1642fa"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a388517ebb73872038ab7f6fa7b1642fa">icarus::DaqDecoderICARUSPMT::fRequireBoardConfig</a></div><div class="ttdeci">bool const fRequireBoardConfig</div><div class="ttdoc">Whether setup info on all boards is required. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00572">DaqDecoderICARUSPMT_module.cc:572</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html">icarus::DaqDecoderICARUSPMT</a></div><div class="ttdoc">Produces raw::OpDetWaveform from V1730 artDAQ data fragments. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00341">DaqDecoderICARUSPMT_module.cc:341</a></div></div>
<div class="ttc" id="lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h_html"><div class="ttname"><a href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h.html">OpDetWaveform.h</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ab580f25b27f7b5673074cc2a0dc4ceb3"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ab580f25b27f7b5673074cc2a0dc4ceb3">icarus::DaqDecoderICARUSPMT::extractFragmentBoardID</a></div><div class="ttdeci">static BoardID_t extractFragmentBoardID(artdaq::Fragment const &amp;fragment)</div><div class="ttdoc">Extracts the fragment ID (i.e. board ID) from the specified fragment. </div></div>
<div class="ttc" id="namespacesbndaq_html_a8c2910e129a0c67d73d4c1f4607552bf"><div class="ttname"><a href="../../d3/d0b/namespacesbndaq.html#a8c2910e129a0c67d73d4c1f4607552bf">sbndaq::dumpFragment</a></div><div class="ttdeci">details::DumpFragWrap dumpFragment(artdaq::Fragment const &amp;frag)</div><div class="ttdoc">Dump a artDAQ fragment into an output stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/FragmentDumper_8cxx_source.html#l00034">FragmentDumper.cxx:34</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00102">WindowPattern.h:102</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_adb8b4225d29c0acd40125afa0f72ed13"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adb8b4225d29c0acd40125afa0f72ed13">icarus::DaqDecoderICARUSPMT::DaqDecoderICARUSPMT</a></div><div class="ttdeci">DaqDecoderICARUSPMT(Parameters const &amp;params)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l01089">DaqDecoderICARUSPMT_module.cc:1089</a></div></div>
<div class="ttc" id="TriggerData_8h_html"><div class="ttname"><a href="../../d9/d16/TriggerData_8h.html">TriggerData.h</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a6bb414ce406b60bac9adb2672a2b5e46"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6bb414ce406b60bac9adb2672a2b5e46">icarus::DaqDecoderICARUSPMT::fTTTresetEverySecond</a></div><div class="ttdeci">bool const fTTTresetEverySecond</div><div class="ttdoc">Whether V1730 TTT is reset every second. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00580">DaqDecoderICARUSPMT_module.cc:580</a></div></div>
<div class="ttc" id="stage0__multiTPC__splitstream__east__icarus_8fcl_html_a2e26720297298fbdbea931dcab1bc851"><div class="ttname"><a href="../../d0/db3/stage0__multiTPC__splitstream__east__icarus_8fcl.html#a2e26720297298fbdbea931dcab1bc851">RequireBoardConfig</a></div><div class="ttdeci">process_name sequence::icarus_stage0_EastHits_TPC physics sequence::icarus_stage0_EastHits_TPC physics pathNUMI physics streamNUMI outputs outBNB drop *_ *_ *_DAQ drop *_daqTPCROI_ *_ drop *_decon1droi_ *_ drop *_decon1DroiTPC *_ *_ *outputs outNUMI drop *_ *_ *_DAQ drop *_daqTPCROI_ *_ drop *_decon1droi_ *_ drop *_decon1DroiTPC *_ *_ *physics producers daqPMT DecoderTool RequireBoardConfig</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db3/stage0__multiTPC__splitstream__east__icarus_8fcl_source.html#l00010">stage0_multiTPC_splitstream_east_icarus.fcl:10</a></div></div>
<div class="ttc" id="spacetime_8h_html"><div class="ttname"><a href="../../d7/d6e/spacetime_8h.html">spacetime.h</a></div><div class="ttdoc">Dimensioned variables representing space or time quantities. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_afb4eb9e49b749047813892670db8e89f"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#afb4eb9e49b749047813892670db8e89f">icarus::DaqDecoderICARUSPMT::fillTreeEventID</a></div><div class="ttdeci">void fillTreeEventID(art::Event const &amp;event, TreeData_EventID_t &amp;treeData) const </div><div class="ttdoc">Fills the base information of a tree data entry from an art event. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorTimings_html"><div class="ttname"><a href="../../de/d0f/classdetinfo_1_1DetectorTimings.html">detinfo::DetectorTimings</a></div><div class="ttdoc">A class exposing an upgraded interface of detinfo::DetectorClocksData. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd2/DetectorTimings_8h_source.html#l00249">DetectorTimings.h:249</a></div></div>
<div class="ttc" id="prova__source_8fcl_html_ab58e1ede8542ac672a1c146fb3870f2e"><div class="ttname"><a href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a></div><div class="ttdeci">process_name largeant stream1 can override from command line with o or output physics producers generator N</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/prova__source_8fcl_source.html#l00033">prova_source.fcl:33</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a06748e1358cb20f1d70a9c4e9847fc39"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a06748e1358cb20f1d70a9c4e9847fc39">icarus::DaqDecoderICARUSPMT::createFragmentWaveforms</a></div><div class="ttdeci">std::vector&lt; raw::OpDetWaveform &gt; createFragmentWaveforms(FragmentInfo_t const &amp;fragInfo, electronics_time const timeStamp) const </div><div class="ttdoc">Creates raw::OpDetWaveform objects from the fragment data. </div></div>
<div class="ttc" id="DetectorClocksService_8h_html"><div class="ttname"><a href="../../d3/dba/DetectorClocksService_8h.html">DetectorClocksService.h</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a8429384dcd9dd4fcdaf9385cfee06d5c"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a8429384dcd9dd4fcdaf9385cfee06d5c">icarus::DaqDecoderICARUSPMT::fPacketDump</a></div><div class="ttdeci">bool const fPacketDump</div><div class="ttdoc">Dump V1730 data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00566">DaqDecoderICARUSPMT_module.cc:566</a></div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t_html_a587922308edd0e03fc7561d14df798e4"><div class="ttname"><a href="../../d7/d8c/structdaq_1_1details_1_1BoardInfoLookup_1_1BoardInfo__t.html#a587922308edd0e03fc7561d14df798e4">daq::details::BoardInfoLookup::BoardInfo_t::setup</a></div><div class="ttdeci">BoardSetup_t const * setup</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00098">PMTDecoderUtils.h:98</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t_html"><div class="ttname"><a href="../../db/dd7/structicarus_1_1DaqDecoderICARUSPMT_1_1TriggerInfo__t.html">icarus::DaqDecoderICARUSPMT::TriggerInfo_t</a></div><div class="ttdoc">Collection of information about the global trigger. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00549">DaqDecoderICARUSPMT_module.cc:549</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a19dd16849ed641adb2aff777fdc4bd8b"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div><div class="ttdeci">then echo fcl name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="FHiCLutils_8h_html"><div class="ttname"><a href="../../d8/de6/FHiCLutils_8h.html">FHiCLutils.h</a></div><div class="ttdoc">Simple helper functions to deal with FHiCL. </div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t_html_a4ba8839722afb138b5954bff416fa3cd"><div class="ttname"><a href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a4ba8839722afb138b5954bff416fa3cd">icarus::DaqDecoderICARUSPMT::TreeData_EventID_t::timestamp</a></div><div class="ttdeci">SplitTimestamp_t timestamp</div><div class="ttdoc">Event timestamp (seconds from the epoch). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00696">DaqDecoderICARUSPMT_module.cc:696</a></div></div>
<div class="ttc" id="ExtraTriggerInfo_8h_html"><div class="ttname"><a href="../../d4/d44/ExtraTriggerInfo_8h.html">ExtraTriggerInfo.h</a></div></div>
<div class="ttc" id="group__LArSoft__CoreUtils__StdUtils_html_ga624a6c8d8a7c2d3746a644f8cc1c1efe"><div class="ttname"><a href="../../dc/ddb/group__LArSoft__CoreUtils__StdUtils.html#ga624a6c8d8a7c2d3746a644f8cc1c1efe">util::begin</a></div><div class="ttdeci">decltype(auto) constexpr begin(T &amp;&amp;obj)</div><div class="ttdoc">ADL-aware version of std::begin. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de2/StdUtils_8h_source.html#l00072">StdUtils.h:72</a></div></div>
<div class="ttc" id="structsbn_1_1V1730Configuration_html_ae019d5110b0e306338acd7cb0b1b1395"><div class="ttname"><a href="../../df/d9c/structsbn_1_1V1730Configuration.html#ae019d5110b0e306338acd7cb0b1b1395">sbn::V1730Configuration::postTriggerFrac</a></div><div class="ttdeci">float postTriggerFrac</div><div class="ttdoc">Fraction of the waveform after the trigger signal (postPercent). </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d54/V1730Configuration_8h_source.html#l00064">V1730Configuration.h:64</a></div></div>
<div class="ttc" id="pmtsimulation__icarus_8fcl_html_a9fc569190f32b40862f18ac3c03a8e49"><div class="ttname"><a href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a></div><div class="ttdeci">temporary value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d36/pmtsimulation__icarus_8fcl_source.html#l00158">pmtsimulation_icarus.fcl:158</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t_html_a3d23db0937ae5bbb8f930c711f9320bf"><div class="ttname"><a href="../../d2/dd4/structicarus_1_1DaqDecoderICARUSPMT_1_1SplitTimestamp__t.html#a3d23db0937ae5bbb8f930c711f9320bf">icarus::DaqDecoderICARUSPMT::SplitTimestamp_t::SplitTimestamp_t</a></div><div class="ttdeci">constexpr SplitTimestamp_t()=default</div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a6afe7b54b3cda786dd2f4c624b0aa5e0"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a6afe7b54b3cda786dd2f4c624b0aa5e0">icarus::DaqDecoderICARUSPMT::initTrees</a></div><div class="ttdeci">void initTrees(std::vector&lt; std::string &gt; const &amp;treeNames)</div><div class="ttdoc">Initializes all requested data trees. </div></div>
<div class="ttc" id="classraw_1_1Trigger_html_a9b37b0218222430596b968c6448cdde2"><div class="ttname"><a href="../../dd/d0b/classraw_1_1Trigger.html#a9b37b0218222430596b968c6448cdde2">raw::Trigger::TriggerBits</a></div><div class="ttdeci">unsigned int TriggerBits() const </div><div class="ttdoc">Trigger Bits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/TriggerData_8h_source.html#l00054">TriggerData.h:54</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a345c79060570f79eadc930293d58fdf8"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a345c79060570f79eadc930293d58fdf8">icarus::DaqDecoderICARUSPMT::fPMTconfigTag</a></div><div class="ttdeci">std::optional&lt; art::InputTag &gt; const fPMTconfigTag</div><div class="ttdoc">Input tag of the PMT configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00575">DaqDecoderICARUSPMT_module.cc:575</a></div></div>
<div class="ttc" id="IntegerRanges__test_8cc_html_abbc7e5f346bfa932ca51b4b07ccef76d"><div class="ttname"><a href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a></div><div class="ttdeci">std::size_t count(Cont const &amp;cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df5/IntegerRanges__test_8cc_source.html#l00029">IntegerRanges_test.cc:29</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a1b9dfd8c7f3a60d0edc797fb29d10183"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a1b9dfd8c7f3a60d0edc797fb29d10183">icarus::DaqDecoderICARUSPMT::makeFragmentCollection</a></div><div class="ttdeci">artdaq::FragmentPtrs makeFragmentCollection(artdaq::Fragment const &amp;sourceFragment) const </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a43ebc3efa6258a21dadcd811bb93b118"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a43ebc3efa6258a21dadcd811bb93b118">icarus::DaqDecoderICARUSPMT::hasPMTconfiguration</a></div><div class="ttdeci">bool hasPMTconfiguration() const </div><div class="ttdoc">Returns whether PMT configuration information is expected to be available. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00626">DaqDecoderICARUSPMT_module.cc:626</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1Config_html"><div class="ttname"><a href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html">icarus::DaqDecoderICARUSPMT::Config</a></div><div class="ttdoc">Main tool configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00420">DaqDecoderICARUSPMT_module.cc:420</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1Config_html_adfdd401934eb4cba260e09a5a404fa39"><div class="ttname"><a href="../../d0/de2/structicarus_1_1DaqDecoderICARUSPMT_1_1Config.html#adfdd401934eb4cba260e09a5a404fa39">icarus::DaqDecoderICARUSPMT::Config::Comment</a></div><div class="ttdeci">fhicl::Comment Comment</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00423">DaqDecoderICARUSPMT_module.cc:423</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t_html_ae2ed20faab73502a47213dc2d85f66f1"><div class="ttname"><a href="../../d1/d1b/structicarus_1_1DaqDecoderICARUSPMT_1_1NeededBoardInfo__t.html#ae2ed20faab73502a47213dc2d85f66f1">icarus::DaqDecoderICARUSPMT::NeededBoardInfo_t::bufferLength</a></div><div class="ttdeci">nanoseconds bufferLength</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00542">DaqDecoderICARUSPMT_module.cc:542</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a2a15e2b580364dacf6c6ca288fc2e28a"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a2a15e2b580364dacf6c6ca288fc2e28a">icarus::DaqDecoderICARUSPMT::sortWaveforms</a></div><div class="ttdeci">void sortWaveforms(std::vector&lt; raw::OpDetWaveform &gt; &amp;waveforms) const </div><div class="ttdoc">Sorts in place the specified waveforms in channel order, then in time. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_ae47c85d39f17ad3c0cae3f46f6423491"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#ae47c85d39f17ad3c0cae3f46f6423491">icarus::DaqDecoderICARUSPMT::mergeWaveformGroup</a></div><div class="ttdeci">raw::OpDetWaveform mergeWaveformGroup(std::vector&lt; raw::OpDetWaveform &gt; &amp;allWaveforms, std::vector&lt; std::size_t &gt; const &amp;indices) const </div></div>
<div class="ttc" id="structdaq_1_1details_1_1BoardSetup__t_html"><div class="ttname"><a href="../../d2/d8f/structdaq_1_1details_1_1BoardSetup__t.html">daq::details::BoardSetup_t</a></div><div class="ttdoc">Information of the setup of a V1730 readout board. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/PMTDecoderUtils_8h_source.html#l00038">PMTDecoderUtils.h:38</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a9187d1056776e4469e810f44c6c8832e"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a9187d1056776e4469e810f44c6c8832e">icarus::DaqDecoderICARUSPMT::fTreeFragment</a></div><div class="ttdeci">std::unique_ptr&lt; TreeFragment_t &gt; fTreeFragment</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00739">DaqDecoderICARUSPMT_module.cc:739</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a74da18d4f0023feee71c1352a99b3910"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">icarus::ns::util::empty</a></div><div class="ttdeci">bool empty(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00555">FixedBins.h:555</a></div></div>
<div class="ttc" id="structsbn_1_1PMTconfiguration_html"><div class="ttname"><a href="../../d4/d46/structsbn_1_1PMTconfiguration.html">sbn::PMTconfiguration</a></div><div class="ttdoc">Class containing configuration for PMT readout. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/PMTconfiguration_8h_source.html#l00045">PMTconfiguration.h:45</a></div></div>
<div class="ttc" id="namespacedetinfo_1_1timescales_html_abd0daf821f464d7aec05b35a43053145"><div class="ttname"><a href="../../dc/d8b/namespacedetinfo_1_1timescales.html#abd0daf821f464d7aec05b35a43053145">detinfo::timescales::electronics_time</a></div><div class="ttdeci">timescale_traits&lt; ElectronicsTimeCategory &gt;::time_point_t electronics_time</div><div class="ttdoc">A point in time on the electronics time scale. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/daf/DetectorTimingTypes_8h_source.html#l00309">DetectorTimingTypes.h:309</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a13b99e41b86536ee333a822f816695ff"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a13b99e41b86536ee333a822f816695ff">icarus::DaqDecoderICARUSPMT::fragmentWaveformTimestampOnTrigger</a></div><div class="ttdeci">electronics_time fragmentWaveformTimestampOnTrigger(FragmentInfo_t const &amp;fragInfo, NeededBoardInfo_t const &amp;boardInfo, SplitTimestamp_t triggerTime) const </div><div class="ttdoc">Returns the timestamp for the waveforms in the specified fragment. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a656b71c0e6caa8d3babf5ac75921e402"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a656b71c0e6caa8d3babf5ac75921e402">icarus::DaqDecoderICARUSPMT::fEventInfo</a></div><div class="ttdeci">std::unique_ptr&lt; TreeData_EventID_t &gt; fEventInfo</div><div class="ttdoc">Event ID for trees. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00736">DaqDecoderICARUSPMT_module.cc:736</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t_html_a70e9a468ad5cab7ef515cc1c5e6a34cb"><div class="ttname"><a href="../../d9/de4/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeData__EventID__t.html#a70e9a468ad5cab7ef515cc1c5e6a34cb">icarus::DaqDecoderICARUSPMT::TreeData_EventID_t::subrun</a></div><div class="ttdeci">unsigned int subrun</div><div class="ttdoc">Subrun number. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00694">DaqDecoderICARUSPMT_module.cc:694</a></div></div>
<div class="ttc" id="BinaryDumpUtils_8h_html"><div class="ttname"><a href="../../d2/d09/BinaryDumpUtils_8h.html">BinaryDumpUtils.h</a></div><div class="ttdoc">Functions to dump the content of binary data chunks to console. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_adad2adc662a6b754d91bbc973d56bff1"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#adad2adc662a6b754d91bbc973d56bff1">icarus::DaqDecoderICARUSPMT::BoardID_t</a></div><div class="ttdeci">short int BoardID_t</div><div class="ttdoc">Type used internally to represent board ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00865">DaqDecoderICARUSPMT_module.cc:865</a></div></div>
<div class="ttc" id="structdetinfo_1_1timescales_1_1details_1_1timescale__traits__base_html_aa267fed464f5e1e9baee07e1109af09b"><div class="ttname"><a href="../../dd/d9d/structdetinfo_1_1timescales_1_1details_1_1timescale__traits__base.html#aa267fed464f5e1e9baee07e1109af09b">detinfo::timescales::details::timescale_traits_base::name</a></div><div class="ttdeci">static std::string name()</div><div class="ttdoc">Name of this time scale. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/daf/DetectorTimingTypes_8h_source.html#l00144">DetectorTimingTypes.h:144</a></div></div>
<div class="ttc" id="structsbn_1_1PMTconfiguration_html_ad421729a1e29bf061192b19a51213f54"><div class="ttname"><a href="../../d4/d46/structsbn_1_1PMTconfiguration.html#ad421729a1e29bf061192b19a51213f54">sbn::PMTconfiguration::boards</a></div><div class="ttdeci">std::vector&lt; sbn::V1730Configuration &gt; boards</div><div class="ttdoc">Configuration of all PMT readout boards. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/PMTconfiguration_8h_source.html#l00052">PMTconfiguration.h:52</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_aa91557fc57eb5a7cedf4200661a07141"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#aa91557fc57eb5a7cedf4200661a07141">util::quantities::nanoseconds</a></div><div class="ttdeci">nanosecond nanoseconds</div><div class="ttdoc">Alias for common language habits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6e/spacetime_8h_source.html#l00139">spacetime.h:139</a></div></div>
<div class="ttc" id="namespaceraw_html_ab3db8feaa51f2c564eb00582c3d72590"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#ab3db8feaa51f2c564eb00582c3d72590">raw::Channel_t</a></div><div class="ttdeci">unsigned int Channel_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/lardataobj_2lardataobj_2RawData_2OpDetWaveform_8h_source.html#l00022">lardataobj/lardataobj/RawData/OpDetWaveform.h:22</a></div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a3b6db1e2904ab2508d54cc234bec67e7"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a3b6db1e2904ab2508d54cc234bec67e7">icarus::DaqDecoderICARUSPMT::processBoardFragments</a></div><div class="ttdeci">std::vector&lt; raw::OpDetWaveform &gt; processBoardFragments(artdaq::FragmentPtrs const &amp;artdaqFragment, TriggerInfo_t const &amp;triggerInfo)</div><div class="ttdoc">Extracts waveforms from the specified fragments from a board. </div></div>
<div class="ttc" id="classicarus_1_1DaqDecoderICARUSPMT_html_a836bf665cd811240ff9a6545bcd63e35"><div class="ttname"><a href="../../d6/db3/classicarus_1_1DaqDecoderICARUSPMT.html#a836bf665cd811240ff9a6545bcd63e35">icarus::DaqDecoderICARUSPMT::TreeNames</a></div><div class="ttdeci">static TreeNameList_t const TreeNames</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00352">DaqDecoderICARUSPMT_module.cc:352</a></div></div>
<div class="ttc" id="structsbn_1_1V1730Configuration_html"><div class="ttname"><a href="../../df/d9c/structsbn_1_1V1730Configuration.html">sbn::V1730Configuration</a></div><div class="ttdoc">Class containing configuration for a V1730 board. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d54/V1730Configuration_8h_source.html#l00045">V1730Configuration.h:45</a></div></div>
<div class="ttc" id="structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t_html_a3c8b05583035ea5eff49e4a2c53940d3"><div class="ttname"><a href="../../d8/dfd/structicarus_1_1DaqDecoderICARUSPMT_1_1TreeFragment__t_1_1Data__t.html#a3c8b05583035ea5eff49e4a2c53940d3">icarus::DaqDecoderICARUSPMT::TreeFragment_t::Data_t::fragTime</a></div><div class="ttdeci">SplitTimestamp_t fragTime</div><div class="ttdoc">PMT fragment time stamp. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d29/DaqDecoderICARUSPMT__module_8cc_source.html#l00712">DaqDecoderICARUSPMT_module.cc:712</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
