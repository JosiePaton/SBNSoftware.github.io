<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>GeometryCore.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_0d059e244e4aff9e806074c98175a747.html">larcorealg</a></li><li class="navelem"><a class="el" href="../../dir_de29c411390e7639bef4bdd96f973c55.html">larcorealg</a></li><li class="navelem"><a class="el" href="../../dir_14b36a4f6e6fb0e5b4852b5ac05ead74.html">Geometry</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">GeometryCore.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d6a/GeometryCore_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file   larcorealg/Geometry/GeometryCore.cxx</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief  Access the description of detector geometry - implementation file</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author brebel@fnal.gov</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * @see    larcorealg/Geometry/GeometryCore.h</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// class header</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de7/GeometryCore_8h.html">larcorealg/Geometry/GeometryCore.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// lar includes</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d09/PhysicalConstants_8h.html">larcoreobj/SimpleTypesAndConstants/PhysicalConstants.h</a>&quot;</span> <span class="comment">// util::pi&lt;&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d96/DereferenceIterator_8h.html">larcorealg/CoreUtils/DereferenceIterator.h</a>&quot;</span> <span class="comment">// lar::util::dereferenceIteratorLoop()</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d38/OpDetGeo_8h.html">larcorealg/Geometry/OpDetGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d8a/AuxDetGeo_8h.html">larcorealg/Geometry/AuxDetGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d42/AuxDetSensitiveGeo_8h.html">larcorealg/Geometry/AuxDetSensitiveGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d63/GeometryBuilderStandard_8h.html">larcorealg/Geometry/GeometryBuilderStandard.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dc6/Decomposer_8h.html">larcorealg/Geometry/Decomposer.h</a>&quot;</span> <span class="comment">// geo::vect::dot()</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d6c/geo__vectors__utils_8h.html">larcorealg/Geometry/geo_vectors_utils.h</a>&quot;</span> <span class="comment">// geo::vect</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/db6/geo__vectors__utils__TVector_8h.html">larcorealg/Geometry/geo_vectors_utils_TVector.h</a>&quot;</span> <span class="comment">// geo::vect</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// Framework includes</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;cetlib/pow.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;cetlib_except/exception.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/types/Table.h&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// ROOT includes</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;TGeoManager.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;TGeoNode.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;TGeoVolume.h&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;TGeoMatrix.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;TGeoBBox.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;TGeoVolume.h&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// #include &lt;Rtypes.h&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// C/C++ includes</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span> <span class="comment">// size_t</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;cctype&gt;</span> <span class="comment">// ::tolower()</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span> <span class="comment">// std::abs() ...</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span> <span class="comment">// std::ostringstream</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::for_each(), std::transform()</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span> <span class="comment">// std::back_inserter()</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span> <span class="comment">// std::swap()</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span> <span class="comment">// std::numeric_limits&lt;&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span> <span class="comment">// std::accumulate</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">namespace </span>geo {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html">lar::util::RealComparisons&lt;geo::Length_t&gt;</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">GeometryCore::coordIs</a>{ 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-8 };</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Constructor.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae51606708dac29cdeebe31a8d7c2d019">   59</a></span>&#160;  <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae51606708dac29cdeebe31a8d7c2d019">GeometryCore::GeometryCore</a>(</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    fhicl::ParameterSet <span class="keyword">const</span>&amp; pset</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    )</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    : fSurfaceY         (pset.<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt; double            &gt;(<span class="stringliteral">&quot;SurfaceY&quot;</span>               ))</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    , fDetectorName     (pset.<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt; <a class="code" href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">std</a>::string       &gt;(<span class="stringliteral">&quot;Name&quot;</span>                   ))</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    , fMinWireZDist     (pset.<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt; double            &gt;(<span class="stringliteral">&quot;MinWireZDist&quot;</span>,     3.0  ))</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    , fPositionWiggle   (pset.<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt; double            &gt;(<span class="stringliteral">&quot;PositionEpsilon&quot;</span>,  1.<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-4))</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    , fBuilderParameters</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      (pset.<a class="code" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a>&lt;fhicl::ParameterSet&gt;(<span class="stringliteral">&quot;Builder&quot;</span>, fhicl::ParameterSet()))</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ada23fd77f611d62ab0684a45122448c3">fDetectorName</a>.begin(), <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ada23fd77f611d62ab0684a45122448c3">fDetectorName</a>.end(),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ada23fd77f611d62ab0684a45122448c3">fDetectorName</a>.begin(), ::tolower);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  } <span class="comment">// GeometryCore::GeometryCore()</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ddb5a3126f15b642aff93549bacd9a7">   75</a></span>&#160;  <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ddb5a3126f15b642aff93549bacd9a7">GeometryCore::~GeometryCore</a>() {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5e06d41ad535850049245df99792c77c">ClearGeometry</a>();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  } <span class="comment">// GeometryCore::~GeometryCore()</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af61021fd8b39bc81feb55d0d6ab5772e">GeometryCore::ApplyChannelMap</a></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af61021fd8b39bc81feb55d0d6ab5772e">   82</a></span>&#160;    (std::unique_ptr&lt;geo::ChannelMapAlg&gt; pChannelMap)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    SortGeometry(pChannelMap-&gt;<a class="code" href="../../d0/dff/classgeo_1_1ChannelMapAlg.html#aa94729290764f72b26341f536ffa5a07">Sorter</a>());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    UpdateAfterSorting(); <span class="comment">// after channel mapping has sorted objects, set their IDs</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    pChannelMap-&gt;<a class="code" href="../../d0/dff/classgeo_1_1ChannelMapAlg.html#ad3bad8326192c816221cb00ab6488344">Initialize</a>(fGeoData);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    fChannelMapAlg = move(pChannelMap);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  } <span class="comment">// GeometryCore::ApplyChannelMap()</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0e8211cab429b722b4ea3131f0d15bc5">   91</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0e8211cab429b722b4ea3131f0d15bc5">GeometryCore::LoadGeometryFile</a>(</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    std::string gdmlfile, std::string rootfile,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../df/d6f/classgeo_1_1GeometryBuilder.html">geo::GeometryBuilder</a>&amp; builder,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">bool</span> bForceReload <span class="comment">/* = false*/</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (gdmlfile.empty()) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;No GDML Geometry file specified!\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (rootfile.empty()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;No ROOT Geometry file specified!\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5e06d41ad535850049245df99792c77c">ClearGeometry</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Open the GDML file, and convert it into ROOT TGeoManager format.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Then lock the gGeoManager to prevent future imports, for example</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// in AuxDetGeometry</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span>( !gGeoManager || bForceReload ){</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> (gGeoManager) TGeoManager::UnlockGeometry();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">else</span> { <span class="comment">// very first time (or so it should)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// [20210630, petrillo@slac.stanford.edu]</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// ROOT 6.22.08 allows us to choose the representation of lengths</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">// in the geometry objects parsed from GDML.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// In LArSoft we want them to be centimeters (ROOT standard).</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// This was tracked as Redmine issue #25990, and I leave this mark</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// because I feel that we&#39;ll be back to it not too far in the future.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// Despite the documentation (ROOT 6.22/08),</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// it seems the units are locked from the beginning,</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">// so we unlock without prejudice.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        TGeoManager::LockDefaultUnits(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        TGeoManager::SetDefaultUnits(TGeoManager::kRootUnits);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        TGeoManager::LockDefaultUnits(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      TGeoManager::Import(rootfile.c_str());</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      gGeoManager-&gt;LockGeometry();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0143911432bbf6cb2a7f44c1a5e901a0">BuildGeometry</a>(builder);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac8bee1ed6ef6b770a77e57a06f30e6a2">fGDMLfile</a> = gdmlfile;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aeecb542b0ece9b3048b43995342444f8">fROOTfile</a> = rootfile;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;New detector geometry loaded from &quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;\n\t&quot;</span> &lt;&lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aeecb542b0ece9b3048b43995342444f8">fROOTfile</a></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;\n\t&quot;</span> &lt;&lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac8bee1ed6ef6b770a77e57a06f30e6a2">fGDMLfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  } <span class="comment">// GeometryCore::LoadGeometryFile()</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad0c6b7440cabfce11024d316fd2deaf7">  146</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0e8211cab429b722b4ea3131f0d15bc5">GeometryCore::LoadGeometryFile</a>(</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    std::string gdmlfile, std::string rootfile,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">bool</span> bForceReload <span class="comment">/* = false*/</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  ) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    fhicl::Table&lt;geo::GeometryBuilderStandard::Config&gt; <span class="keyword">const</span> builderConfig</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      (<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4bf6f74e66f5f8845141d1eaa3cd1079">fBuilderParameters</a>, { <span class="stringliteral">&quot;tool_type&quot;</span> });</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// this is a wink to the understanding that we might be using a art-based</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// service provider configuration sprinkled with tools.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="../../d4/d14/classgeo_1_1GeometryBuilderStandard.html">geo::GeometryBuilderStandard</a> builder{builderConfig()};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0e8211cab429b722b4ea3131f0d15bc5">LoadGeometryFile</a>(gdmlfile, rootfile, builder, bForceReload);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  } <span class="comment">// GeometryCore::LoadGeometryFile()</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5e06d41ad535850049245df99792c77c">  160</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5e06d41ad535850049245df99792c77c">GeometryCore::ClearGeometry</a>()</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>().clear();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>().clear();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a73d5b65328650214261231a7617ca8d2">  168</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a73d5b65328650214261231a7617ca8d2">GeometryCore::SortGeometry</a>(<a class="code" href="../../d5/df5/classgeo_1_1GeoObjectSorter.html">geo::GeoObjectSorter</a> <span class="keyword">const</span>&amp; sorter)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Sorting volumes...&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    sorter.<a class="code" href="../../d5/df5/classgeo_1_1GeoObjectSorter.html#a964b6228af5e304ce882ee0ea1a1222c">SortAuxDets</a>(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    sorter.<a class="code" href="../../d5/df5/classgeo_1_1GeoObjectSorter.html#a12e6c8754865e424fbe7384e486deaa6">SortCryostats</a>(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#abbd8aef3486d368d18ce29eaa9ab2913">geo::CryostatID::CryostatID_t</a> c = 0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a>&amp; cryo: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>())</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      cryo.SortSubVolumes(sorter);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      cryo.UpdateAfterSorting(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a>(c));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      ++c;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  } <span class="comment">// GeometryCore::SortGeometry()</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5b02e6bbab566e3f56c9bc81e50a204c">  187</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5b02e6bbab566e3f56c9bc81e50a204c">GeometryCore::UpdateAfterSorting</a>() {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> c = 0; c &lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>(); ++c)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>()[c].UpdateAfterSorting(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a>(c));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad0aaeb8c801d0f6653151ee3e79479e5">allViews</a>.clear();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; tpc: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6b97a9f84409e28b5ad00b0f7000bc4">IterateTPCs</a>()) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; TPCviews = tpc.Views();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad0aaeb8c801d0f6653151ee3e79479e5">allViews</a>.insert(TPCviews.cbegin(), TPCviews.cend());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  } <span class="comment">// GeometryCore::UpdateAfterSorting()</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa06cc82de2ccb3c591cf6a8309dfa55f">  202</a></span>&#160;  TGeoManager* <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa06cc82de2ccb3c591cf6a8309dfa55f">GeometryCore::ROOTGeoManager</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> gGeoManager;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a231e0d77adfc7461dfacda7a8a29ce35">  208</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a231e0d77adfc7461dfacda7a8a29ce35">GeometryCore::Nchannels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;Nchannels();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a825554c6c9e54428268dba2cd9cf1f97">  214</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a231e0d77adfc7461dfacda7a8a29ce35">GeometryCore::Nchannels</a>(<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;Nchannels(ropid);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  } <span class="comment">// GeometryCore::Nchannels(ROPID)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7870a9d7c4e0d627c360553737d1f110">  221</a></span>&#160;  std::vector&lt;raw::ChannelID_t&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7870a9d7c4e0d627c360553737d1f110">GeometryCore::ChannelsInTPCs</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    std::vector&lt;raw::ChannelID_t&gt; channels;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    channels.reserve(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;Nchannels());</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> &amp; ts: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aacc075ddf778fc7cb52df52b2a7e9e42">IterateTPCsetIDs</a>())</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> t: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;TPCsetToTPCs(ts))</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp; wire: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0617ecedbcbf1d4b6477d4ced96e4f87">IterateWireIDs</a>(t))</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          channels.push_back(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;PlaneWireToChannel(wire));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    std::sort(channels.begin(), channels.end());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">auto</span> last = std::unique(channels.begin(), channels.end());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    channels.erase(last, channels.end());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> channels;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">  244</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">GeometryCore::NOpDets</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>=0;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> cstat=0; cstat!=<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>(); cstat++)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      N += this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(cstat).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a878dc414182852e45470c31341c1ad00">NOpDet</a>();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a33f0c2f4f73e5e751a66bdbe8d26e79e">  253</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a33f0c2f4f73e5e751a66bdbe8d26e79e">GeometryCore::NOpChannels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;NOpChannels(this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">NOpDets</a>());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a07e176f3ff3f93b46c19fffdddbff72b">  259</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a07e176f3ff3f93b46c19fffdddbff72b">GeometryCore::MaxOpChannel</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;MaxOpChannel(this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">NOpDets</a>());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6437421e5404e2d3178d193e72d3b04f">  265</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6437421e5404e2d3178d193e72d3b04f">GeometryCore::NOpHardwareChannels</a>(<span class="keywordtype">int</span> opDet)<span class="keyword"> const</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;NOpHardwareChannels(opDet);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a62e21472ef96c5430d3b52dc2ea6646f">  271</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a62e21472ef96c5430d3b52dc2ea6646f">GeometryCore::OpChannel</a>(<span class="keywordtype">int</span> detNum, <span class="keywordtype">int</span> hardwareChannel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;OpChannel(detNum, hardwareChannel);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a599e17467586ea6edacefcd2dab4c40b">  277</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a599e17467586ea6edacefcd2dab4c40b">GeometryCore::OpDetFromOpChannel</a>(<span class="keywordtype">int</span> opChannel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;OpDetFromOpChannel(opChannel);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a75529802c7b5bfe9772afaa811362187">  283</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a75529802c7b5bfe9772afaa811362187">GeometryCore::HardwareChannelFromOpChannel</a>(<span class="keywordtype">int</span> opChannel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;HardwareChannelFromOpChannel(opChannel);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Is this a valid OpChannel number?</span></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab3d8d6d617341a99e3500f2071eabbb">  290</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab3d8d6d617341a99e3500f2071eabbb">GeometryCore::IsValidOpChannel</a>(<span class="keywordtype">int</span> opChannel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;IsValidOpChannel(opChannel, this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">NOpDets</a>());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#abe664bdd977f8f63aec9b6aaf63e48a6">  296</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#abe664bdd977f8f63aec9b6aaf63e48a6">GeometryCore::NAuxDetSensitive</a>(<span class="keywordtype">size_t</span> <span class="keyword">const</span>&amp; aid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>( aid &gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7e7e9c5ab93b25df1e87d99017709996">NAuxDets</a>() - 1)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;Geometry&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Requested AuxDet index &quot;</span> &lt;&lt; aid</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                       &lt;&lt; <span class="stringliteral">&quot; is out of range: &quot;</span> &lt;&lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7e7e9c5ab93b25df1e87d99017709996">NAuxDets</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>()[aid].NSensitiveVolume();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// Number of different views, or wire orientations</span></div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a17019d019088c33cb6c8ed9e88eb20fc">  307</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a17019d019088c33cb6c8ed9e88eb20fc">GeometryCore::Nviews</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab7bc49ee230e6ee98fe079160203ecd">MaxPlanes</a>();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Return the geometry description of the ith plane in the detector.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// \param cstat : input cryostat number, starting from 0</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// \returns cryostat geometry for ith cryostat</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// \throws geo::Exception if &quot;cstat&quot; is outside allowed range</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">  321</a></span>&#160;  <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">CryostatGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">GeometryCore::Cryostat</a>(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">CryostatID</a> <span class="keyword">const</span>&amp; cryoid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">CryostatGeo</a> <span class="keyword">const</span>* pCryo = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5636bfd60fe3691d52e9b1fd4a63f9a9">CryostatPtr</a>(cryoid);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span>(!pCryo) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Cryostat #&quot;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                           &lt;&lt; cryoid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                           &lt;&lt; <span class="stringliteral">&quot; does not exist\n&quot;</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> *pCryo;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  } <span class="comment">// GeometryCore::Cryostat(CryostatID)</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// Return the geometry description of the ith AuxDet.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// \param ad : input AuxDet number, starting from 0</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// \returns AuxDet geometry for ith AuxDet</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// \throws geo::Exception if &quot;ad&quot; is outside allowed range</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aba6be67cbf069cb648e6e0e33dcb3f5c">  340</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../db/d4f/classgeo_1_1AuxDetGeo.html">AuxDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aba6be67cbf069cb648e6e0e33dcb3f5c">GeometryCore::AuxDet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> ad)<span class="keyword"> const</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span>(ad &gt;= <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7e7e9c5ab93b25df1e87d99017709996">NAuxDets</a>())</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;AuxDet &quot;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    &lt;&lt; ad</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; does not exist\n&quot;</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>()[ad];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab6ddbd2c63910b1d0fc131247a109c9">  352</a></span>&#160;  <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7953310daac7f0bf2f57ceb9760e278f">GeometryCore::FindTPCAtPosition</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// first find the cryostat</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cryo = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#afd05146c702fdd44380922827f3ece3e">PositionToCryostatPtr</a>(point);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (!cryo) <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// then ask it about the TPC</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> tpcid = cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a9cdd522690afc36dd560ef9ce78358e0">PositionToTPCID</a>(point, 1. + <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3de7527301c4a2a14c261d5d93851aee">fPositionWiggle</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (tpcid) <span class="keywordflow">return</span> tpcid;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// return an invalid TPC ID with cryostat information set:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> = cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a388995e3d67347e23b5c0116736481c1">ID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a5076e03f8e666d5173015c80b3dd2a2c">markInvalid</a>();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> tpcid;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  } <span class="comment">// GeometryCore::FindTPCAtPosition()</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#afd05146c702fdd44380922827f3ece3e">GeometryCore::PositionToCryostatPtr</a></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#afd05146c702fdd44380922827f3ece3e">  372</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point) <span class="keyword">const</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryostat: IterateCryostats()) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (cryostat.ContainsPosition(point, 1.0 + fPositionWiggle))</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">return</span> &amp;cryostat;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  } <span class="comment">// GeometryCore::PositionToCryostatPtr()</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a78027f596ceed805d4ed6196d3e53641">GeometryCore::PositionToCryostatID</a></div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a78027f596ceed805d4ed6196d3e53641">  384</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point) <span class="keyword">const</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cryo = PositionToCryostatPtr(point);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> cryo? cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a388995e3d67347e23b5c0116736481c1">ID</a>(): <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a>{};</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  } <span class="comment">// GeometryCore::PositionToCryostatID()</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#abbd8aef3486d368d18ce29eaa9ab2913">geo::CryostatID::CryostatID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa408d7049fbe1ea6c7107d778a5ba64f">GeometryCore::FindCryostatAtPosition</a></div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa408d7049fbe1ea6c7107d778a5ba64f">  393</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; worldLoc) <span class="keyword">const</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cryo = PositionToCryostatPtr(worldLoc);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span> cryo? cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a388995e3d67347e23b5c0116736481c1">ID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>: <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#ab1c75e139655a95f7e66ebca837fd197">geo::CryostatID::InvalidID</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  } <span class="comment">// GeometryCore::FindCryostatAtPosition(Point)</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#abbd8aef3486d368d18ce29eaa9ab2913">geo::CryostatID::CryostatID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa408d7049fbe1ea6c7107d778a5ba64f">GeometryCore::FindCryostatAtPosition</a></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a56656f607743ce77714f0f116fdd1c41">  402</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3]) <span class="keyword">const</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> FindCryostatAtPosition(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldLoc));</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  } <span class="comment">// GeometryCore::FindCryostatAtPosition(double[])</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>* <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9dbc2821f5e6608156cf31d6918d66e8">GeometryCore::PositionToTPCptr</a></div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9dbc2821f5e6608156cf31d6918d66e8">  410</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point) <span class="keyword">const</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cryo = PositionToCryostatPtr(point);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> cryo? cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a2fb0082b4c921474da4a3bd0b01d543b">PositionToTPCptr</a>(point, 1. + fPositionWiggle): <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  } <span class="comment">// GeometryCore::PositionToTPCptr()</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8e154128f6a27b23f95313fb9229f1f6">GeometryCore::PositionToTPC</a></div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8e154128f6a27b23f95313fb9229f1f6">  419</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point) <span class="keyword">const</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>* tpc = PositionToTPCptr(point);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (!tpc) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Can&#39;t find any TPC at position &quot;</span> &lt;&lt; point &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">return</span> *tpc;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  } <span class="comment">// GeometryCore::PositionToTPC()</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8e154128f6a27b23f95313fb9229f1f6">GeometryCore::PositionToTPC</a></div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aaf1b0420c0424f6f3e522f687498d68c">  432</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3], <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">TPCID</a>&amp; tpcid) <span class="keyword">const</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = PositionToTPC(worldLoc);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    tpcid = TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a1664147617bb56a9be21be741f3c96a2">ID</a>();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  } <span class="comment">// GeometryCore::PositionToTPC(double*, TPCID&amp;)</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8e154128f6a27b23f95313fb9229f1f6">GeometryCore::PositionToTPC</a></div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a750c2b5631c98f00deadc3c26bf0c6fb">  442</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;tpc, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;cstat) <span class="keyword">const</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = PositionToTPC(worldLoc);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    cstat = TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a1664147617bb56a9be21be741f3c96a2">ID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    tpc = TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a1664147617bb56a9be21be741f3c96a2">ID</a>().<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  } <span class="comment">// GeometryCore::PositionToTPC(double*, TPCID&amp;)</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4b32e85fa822667ea351cdb1ea8d58d">  452</a></span>&#160;  <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4b32e85fa822667ea351cdb1ea8d58d">GeometryCore::PositionToTPCID</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>* tpc = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9dbc2821f5e6608156cf31d6918d66e8">PositionToTPCptr</a>(point);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> tpc? tpc-&gt;<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a1664147617bb56a9be21be741f3c96a2">ID</a>(): <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a>{};</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  } <span class="comment">// GeometryCore::PositionToTPCID()</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aad1e95cf8d78156a0d09ea1a701d96d6">GeometryCore::PositionToCryostat</a></div>
<div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aad1e95cf8d78156a0d09ea1a701d96d6">  460</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point) <span class="keyword">const</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cstat = PositionToCryostatPtr(point);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> (!cstat) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Can&#39;t find any cryostat at position &quot;</span> &lt;&lt; point &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> *cstat;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  } <span class="comment">// GeometryCore::PositionToCryostat()</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">CryostatGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aad1e95cf8d78156a0d09ea1a701d96d6">GeometryCore::PositionToCryostat</a></div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a71d1195d2f93db7d936d791b7509497c">  473</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span>  worldLoc[3], <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a>&amp; cid) <span class="keyword">const</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#abbd8aef3486d368d18ce29eaa9ab2913">geo::CryostatID::CryostatID_t</a> cstat = FindCryostatAtPosition(worldLoc);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span>(cstat == <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#ab1c75e139655a95f7e66ebca837fd197">geo::CryostatID::InvalidID</a>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Can&#39;t find Cryostat for position (&quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                       &lt;&lt; worldLoc[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                       &lt;&lt; worldLoc[1] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                       &lt;&lt; worldLoc[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    cid = <a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#ab4f9970f327243b3034b830815ed1128">geo::CryostatID</a>(cstat);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">return</span> Cryostat(cid);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  } <span class="comment">// GeometryCore::PositionToCryostat(double[3], CryostatID)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">CryostatGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aad1e95cf8d78156a0d09ea1a701d96d6">GeometryCore::PositionToCryostat</a></div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a30079eac941aa31f31298a8dc4f55d2e">  487</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;cstat) <span class="keyword">const</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> cid;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo = PositionToCryostat(worldLoc, cid);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    cstat = cid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> cryo;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  } <span class="comment">// GeometryCore::PositionToCryostat(double[3], unsigned int)</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad76fb8e5d68c9b0658a6c8af1bb0ba8e">  496</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0593b852bcb047d86f7e008559709198">GeometryCore::FindAuxDetAtPosition</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point, <span class="keywordtype">double</span> <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    std::array&lt;double, 3U&gt; worldPos = {{ point.X(), point.Y(), point.Z() }};</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;NearestAuxDet(worldPos.data(), <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>(), <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  } <span class="comment">// GeometryCore::FindAuxDetAtPosition()</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0593b852bcb047d86f7e008559709198">  505</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0593b852bcb047d86f7e008559709198">GeometryCore::FindAuxDetAtPosition</a>(<span class="keywordtype">double</span> <span class="keyword">const</span>  worldPos[3], <span class="keywordtype">double</span> <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0593b852bcb047d86f7e008559709198">FindAuxDetAtPosition</a>(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldPos), tolerance); }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../db/d4f/classgeo_1_1AuxDetGeo.html">AuxDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f333c0cab2d2d56580c15c7e851ac66">GeometryCore::PositionToAuxDet</a></div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f333c0cab2d2d56580c15c7e851ac66">  511</a></span>&#160;  (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;ad, <span class="keywordtype">double</span> <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>) <span class="keyword">const</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// locate the desired Auxiliary Detector</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    ad = FindAuxDetAtPosition(point, tolerance);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">return</span> AuxDet(ad);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../db/d4f/classgeo_1_1AuxDetGeo.html">AuxDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f333c0cab2d2d56580c15c7e851ac66">GeometryCore::PositionToAuxDet</a></div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af94cbb7a4fa46f9469d376f5b0314bbd">  520</a></span>&#160;  (<span class="keywordtype">double</span> <span class="keyword">const</span>  worldLoc[3], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;ad, <span class="keywordtype">double</span> tolerance) <span class="keyword">const</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  { <span class="keywordflow">return</span> PositionToAuxDet(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldLoc), ad, tolerance); }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a290b33def7dfd5636f7abc2871823588">GeometryCore::FindAuxDetSensitiveAtPosition</a></div>
<div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a290b33def7dfd5636f7abc2871823588">  525</a></span>&#160;  (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point, std::size_t&amp; adg, std::size_t&amp; sv, <span class="keywordtype">double</span> tolerance) <span class="keyword">const</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    adg = FindAuxDetAtPosition(point, tolerance);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    std::array&lt;double, 3U&gt; <span class="keyword">const</span> worldPos = {{ point.X(), point.Y(), point.Z() }};</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    sv  = fChannelMapAlg-&gt;NearestSensitiveAuxDet(worldPos.data(), AuxDets(), <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  } <span class="comment">// GeometryCore::FindAuxDetAtPosition()</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a290b33def7dfd5636f7abc2871823588">GeometryCore::FindAuxDetSensitiveAtPosition</a></div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7da1fcc34d17947fbe1b98029e72ff2c">  536</a></span>&#160;  (<span class="keywordtype">double</span> <span class="keyword">const</span> worldPos[3], <span class="keywordtype">size_t</span>&amp; adg, <span class="keywordtype">size_t</span>&amp; sv, <span class="keywordtype">double</span> tolerance) <span class="keyword">const</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  { <span class="keywordflow">return</span> FindAuxDetSensitiveAtPosition(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldPos), adg, sv, tolerance); }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/df8/classgeo_1_1AuxDetSensitiveGeo.html">AuxDetSensitiveGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a47b701874a169b122ab9ef6f3edd75bf">GeometryCore::PositionToAuxDetSensitive</a></div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a47b701874a169b122ab9ef6f3edd75bf">  542</a></span>&#160;  (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point, <span class="keywordtype">size_t</span>&amp; ad, <span class="keywordtype">size_t</span>&amp; sv, <span class="keywordtype">double</span> tolerance) <span class="keyword">const</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// locate the desired Auxiliary Detector</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    FindAuxDetSensitiveAtPosition(point, ad, sv, tolerance);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> AuxDet(ad).SensitiveVolume(sv);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/df8/classgeo_1_1AuxDetSensitiveGeo.html">AuxDetSensitiveGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a47b701874a169b122ab9ef6f3edd75bf">GeometryCore::PositionToAuxDetSensitive</a></div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9731936fc1514185560ec5d956b5b275">  551</a></span>&#160;  (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3], <span class="keywordtype">size_t</span>&amp; ad, <span class="keywordtype">size_t</span>&amp; sv, <span class="keywordtype">double</span> tolerance) <span class="keyword">const</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  { <span class="keywordflow">return</span> PositionToAuxDetSensitive(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldLoc), ad, sv, tolerance); }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a478f3785602d16b01ebf2bab808b446e">  555</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../db/d4f/classgeo_1_1AuxDetGeo.html">AuxDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a478f3785602d16b01ebf2bab808b446e">GeometryCore::ChannelToAuxDet</a>(std::string <span class="keyword">const</span>&amp; auxDetName,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                             uint32_t    <span class="keyword">const</span>&amp; channel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">size_t</span> adIdx = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;ChannelToAuxDet(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>(), auxDetName, channel);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aba6be67cbf069cb648e6e0e33dcb3f5c">AuxDet</a>(adIdx);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84a322550115530c5e6327a8cc5c5b60">  563</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/df8/classgeo_1_1AuxDetSensitiveGeo.html">AuxDetSensitiveGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84a322550115530c5e6327a8cc5c5b60">GeometryCore::ChannelToAuxDetSensitive</a>(std::string <span class="keyword">const</span>&amp; auxDetName,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                      uint32_t    <span class="keyword">const</span>&amp; channel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keyword">auto</span> idx = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;ChannelToSensitiveAuxDet(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>(), auxDetName, channel);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aba6be67cbf069cb648e6e0e33dcb3f5c">AuxDet</a>(idx.first).<a class="code" href="../../db/d4f/classgeo_1_1AuxDetGeo.html#ac9646d8cfd1b8aad57857851e37215b7">SensitiveVolume</a>(idx.second);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac8f9f42ee96e16ec2d1891949426477d">  572</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">SigType_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">GeometryCore::SignalType</a>(<a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <span class="keyword">const</span> channel)<span class="keyword"> const</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;SignalTypeForChannel(channel);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">  578</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">SigType_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">GeometryCore::SignalType</a>(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// map wire plane -&gt; readout plane -&gt; first channel,</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// then use SignalType(channel)</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> ropid = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f984546847d38e36494d0a462581407">WirePlaneToROP</a>(pid);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (!ropid.isValid) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;SignalType(): Mapping of wire plane &quot;</span> &lt;&lt; std::string(pid)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; to readout plane failed!\n&quot;</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">SignalType</a>(ropid);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  } <span class="comment">// GeometryCore::SignalType(PlaneID)</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6867d8418a5cffc8a7b0d7eb04d851f6">  595</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">View_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">GeometryCore::View</a>(<a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <span class="keyword">const</span> channel)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">return</span> (channel == <a class="code" href="../../d9/d63/namespaceraw.html#ac59223371efaecdc5ef8389bc976a20a">raw::InvalidChannelID</a>)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      ? <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae329b0f520125896d02940bec370fca7">geo::kUnknown</a>: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">View</a>(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af7bb8c9354ff0e8c4fa129c42746aed3">ChannelToROP</a>(channel));</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  } <span class="comment">// GeometryCore::View()</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">  601</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">View_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">GeometryCore::View</a>(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">return</span> pid? <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a93b943c9a953f5b98e166cd21865ad4d">Plane</a>(pid).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#aa5686dd2cfd623b83eeb2b4e18db42ae">View</a>(): <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae329b0f520125896d02940bec370fca7">geo::kUnknown</a>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d78b1f47b011e1f1143c144b602da03">  607</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d78b1f47b011e1f1143c144b602da03">GeometryCore::HasChannel</a>(<a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;HasChannel(channel);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  } <span class="comment">// GeometryCore::HasChannel()</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad482849401c09b5ce4334b853e5ae40d">  613</a></span>&#160;  std::set&lt;PlaneID&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad482849401c09b5ce4334b853e5ae40d">GeometryCore::PlaneIDs</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;PlaneIDs();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">  619</a></span>&#160;  <span class="keyword">const</span> std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">GeometryCore::GetWorldVolumeName</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// For now, and possibly forever, this is a constant (given the</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// definition of &quot;nodeNames&quot; above).</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;volWorld&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">GeometryCore::DetectorEnclosureBox</a></div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">  629</a></span>&#160;    (std::string <span class="keyword">const</span>&amp; <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a> <span class="comment">/* = &quot;volDetEnclosure&quot; */</span>) <span class="keyword">const</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; path = FindDetectorEnclosure(name);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (path.empty()) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;DetectorEnclosureBox(): can&#39;t find enclosure volume &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    TGeoVolume <span class="keyword">const</span>* pEncl = path.back()-&gt;GetVolume();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>* pBox = <span class="keyword">dynamic_cast&lt;</span>TGeoBBox <a class="code" href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">const</a>*<span class="keyword">&gt;</span>(pEncl-&gt;GetShape());</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// check that this is indeed a box</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span> (!pBox) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// at initialisation time we don&#39;t know yet our real ID</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Detector enclosure &#39;&quot;</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39; is not a box! (it is a &quot;</span> &lt;&lt; pEncl-&gt;GetShape()-&gt;IsA()-&gt;GetName()</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="../../d7/d2a/classgeo_1_1LocalTransformation.html">geo::LocalTransformation&lt;TGeoHMatrix&gt;</a> trans(path, path.size() - 1);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// get the half width, height, etc of the cryostat</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> halfwidth  = pBox-&gt;GetDX();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> halfheight = pBox-&gt;GetDY();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> halflength = pBox-&gt;GetDZ();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span> {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      trans.<a class="code" href="../../d7/d2a/classgeo_1_1LocalTransformation.html#ad5fc0e9190e7a3213e592fec90ee7889">LocalToWorld</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>{ -halfwidth, -halfheight, -halflength }),</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      trans.LocalToWorld(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>{ +halfwidth, +halfheight, +halflength })</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      };</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  } <span class="comment">// geo::GeometryCore::DetectorEnclosureBox()</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html">  661</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html">NodeNameMatcherClass</a> {</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">  662</a></span>&#160;    std::set&lt;std::string&gt; <span class="keyword">const</span>* <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">vol_names</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a5427657d57527b83ea35cbbb286e93c7">  664</a></span>&#160;    <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a5427657d57527b83ea35cbbb286e93c7">NodeNameMatcherClass</a>(std::set&lt;std::string&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d90/MCSFitAllPID__module_8cc.html#a379d90f9b00321885d601cbe2c94bf63">names</a>)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      : <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">vol_names</a>(&amp;names) {}</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">    /// Returns whether the specified node matches a set of names</span></div>
<div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#acc3ff2a1e966d8b14888bbf27afca69a">  668</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#acc3ff2a1e966d8b14888bbf27afca69a">operator() </a>(TGeoNode <span class="keyword">const</span>&amp; node)<span class="keyword"> const</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keyword">      </span>{</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">vol_names</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">vol_names</a>-&gt;find(node.GetVolume()-&gt;GetName()) != <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">vol_names</a>-&gt;end();</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }; <span class="comment">// NodeNameMatcherClass</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html">  676</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html">CollectNodesByName</a> {</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a8773ca25a7c5fb877987a52dcd8e2f03">  677</a></span>&#160;    std::vector&lt;TGeoNode const*&gt; <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a8773ca25a7c5fb877987a52dcd8e2f03">nodes</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a325539c36e41fc55cbe61747f1182954">  679</a></span>&#160;    <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a325539c36e41fc55cbe61747f1182954">CollectNodesByName</a>(std::set&lt;std::string&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d90/MCSFitAllPID__module_8cc.html#a379d90f9b00321885d601cbe2c94bf63">names</a>): <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a50f49b835d5794cd81140800b92c93c1">matcher</a>(names) {}</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">    /// If the name of the node matches, records the end node</span></div>
<div class="line"><a name="l00682"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a134dc26dc4867f1627bce2ef1eb8d417">  682</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a134dc26dc4867f1627bce2ef1eb8d417">operator() </a>(TGeoNode <span class="keyword">const</span>&amp; node)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      { <span class="keywordflow">if</span> (<a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a50f49b835d5794cd81140800b92c93c1">matcher</a>(node)) <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a8773ca25a7c5fb877987a52dcd8e2f03">nodes</a>.push_back(&amp;node); }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a02adecd6704b9fb94042fc4dee9be9a9">  685</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a134dc26dc4867f1627bce2ef1eb8d417">operator() </a>(<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">ROOTGeoNodeForwardIterator</a> <span class="keyword">const</span>&amp; iter)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      { <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a134dc26dc4867f1627bce2ef1eb8d417">operator() </a>(**iter); }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a50f49b835d5794cd81140800b92c93c1">  689</a></span>&#160;    <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html">NodeNameMatcherClass</a> <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a50f49b835d5794cd81140800b92c93c1">matcher</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }; <span class="comment">// CollectNodesByName</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="../../df/d87/structgeo_1_1CollectPathsByName.html">  692</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html">CollectPathsByName</a> {</div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="../../df/d87/structgeo_1_1CollectPathsByName.html#ae51b923d6c2526a5d293d84b79c1eeb0">  693</a></span>&#160;    std::vector&lt;std::vector&lt;TGeoNode const*&gt;&gt; <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#ae51b923d6c2526a5d293d84b79c1eeb0">paths</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="../../df/d87/structgeo_1_1CollectPathsByName.html#afd394701c94294645df2fdc0ad377a77">  695</a></span>&#160;    <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#afd394701c94294645df2fdc0ad377a77">CollectPathsByName</a>(std::set&lt;std::string&gt; <span class="keyword">const</span>&amp; <a class="code" href="../../d3/d90/MCSFitAllPID__module_8cc.html#a379d90f9b00321885d601cbe2c94bf63">names</a>): <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#a719856bec52e3f5266873b4d55a8fc89">matcher</a>(names) {}</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">    /// If the name of the node matches, records the node full path</span></div>
<div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="../../df/d87/structgeo_1_1CollectPathsByName.html#aece29fa32520e09d145a5deaab50ef5c">  698</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#aece29fa32520e09d145a5deaab50ef5c">operator() </a>(<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">ROOTGeoNodeForwardIterator</a> <span class="keyword">const</span>&amp; iter)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      { <span class="keywordflow">if</span> (<a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#a719856bec52e3f5266873b4d55a8fc89">matcher</a>(**iter)) <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#ae51b923d6c2526a5d293d84b79c1eeb0">paths</a>.push_back(iter.<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#af80be420e989cc6bb139c5b1bfbeaea6">get_path</a>()); }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="../../df/d87/structgeo_1_1CollectPathsByName.html#a719856bec52e3f5266873b4d55a8fc89">  702</a></span>&#160;    <a class="code" href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html">NodeNameMatcherClass</a> <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#a719856bec52e3f5266873b4d55a8fc89">matcher</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }; <span class="comment">// CollectPathsByName</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  std::vector&lt;TGeoNode const*&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c73552fcd11a47b172ac35407dd4f88">GeometryCore::FindAllVolumes</a></div>
<div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c73552fcd11a47b172ac35407dd4f88">  706</a></span>&#160;    (std::set&lt;std::string&gt; <span class="keyword">const</span>&amp; vol_names) <span class="keyword">const</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html">CollectNodesByName</a> node_collector(vol_names);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">ROOTGeoNodeForwardIterator</a> iNode(ROOTGeoManager()-&gt;GetTopNode());</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    TGeoNode <span class="keyword">const</span>* pCurrentNode;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">while</span> ((pCurrentNode = *iNode)) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      node_collector(*pCurrentNode);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      ++iNode;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    } <span class="comment">// while</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">return</span> node_collector.<a class="code" href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a8773ca25a7c5fb877987a52dcd8e2f03">nodes</a>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  } <span class="comment">// GeometryCore::FindAllVolumes()</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  std::vector&lt;std::vector&lt;TGeoNode const*&gt;&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a10af656ae7ff904a02f5f7670ba71c9d">GeometryCore::FindAllVolumePaths</a></div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a10af656ae7ff904a02f5f7670ba71c9d">  723</a></span>&#160;    (std::set&lt;std::string&gt; <span class="keyword">const</span>&amp; vol_names) <span class="keyword">const</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html">CollectPathsByName</a> path_collector(vol_names);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">ROOTGeoNodeForwardIterator</a> iNode(ROOTGeoManager()-&gt;GetTopNode());</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">while</span> (*iNode) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      path_collector(iNode);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      ++iNode;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    } <span class="comment">// while</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> path_collector.<a class="code" href="../../df/d87/structgeo_1_1CollectPathsByName.html#ae51b923d6c2526a5d293d84b79c1eeb0">paths</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  } <span class="comment">// GeometryCore::FindAllVolumePaths()</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae407ad5c42b4b4614e7e6986a814f479">  740</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae407ad5c42b4b4614e7e6986a814f479">GeometryCore::GetLArTPCVolumeName</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">return</span> std::string(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(tpcid).ActiveVolume()-&gt;GetName());</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d2bca28f28ed7dbcd5a3fb9604650f9">  746</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d2bca28f28ed7dbcd5a3fb9604650f9">GeometryCore::GetCryostatVolumeName</a>(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <span class="keyword">const</span>&amp; cid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">return</span> std::string(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(cid).Volume()-&gt;GetName());</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a93c0f3e32739f934854e649c1ab980c1">  752</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a93c0f3e32739f934854e649c1ab980c1">GeometryCore::DetHalfWidth</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)<span class="keyword">  const</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(tpcid).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad27c155668c5d9f850334cc2e005e7aa">ActiveHalfWidth</a>();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#adb675e4a8b4234008e4e738c4dd090a5">  758</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#adb675e4a8b4234008e4e738c4dd090a5">GeometryCore::DetHalfHeight</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(tpcid).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a0fcad5daf16e14b04be6fdb949429fa0">ActiveHalfHeight</a>();</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3ad8501224048854f35e6b29d9ac4a72">  764</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3ad8501224048854f35e6b29d9ac4a72">GeometryCore::DetLength</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(tpcid).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#adf14d253e55f0968131f4d59bf218fe9">ActiveLength</a>();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a688fc3a2928f8ac7c93dc645214e86b3">GeometryCore::CryostatHalfWidth</a></div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a688fc3a2928f8ac7c93dc645214e86b3">  771</a></span>&#160;    (<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <span class="keyword">const</span>&amp; cid) <span class="keyword">const</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> Cryostat(cid).HalfWidth();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a280b5bf6a5afdad7de99c7481c308d3f">GeometryCore::CryostatHalfHeight</a></div>
<div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a280b5bf6a5afdad7de99c7481c308d3f">  778</a></span>&#160;    (<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <span class="keyword">const</span>&amp; cid) <span class="keyword">const</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">return</span> Cryostat(cid).HalfHeight();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac703a285b794b2605f5349a3f5a47920">  784</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac703a285b794b2605f5349a3f5a47920">GeometryCore::CryostatLength</a>(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <span class="keyword">const</span>&amp; cid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(cid).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a32c9a5b5da4e8135ed17b5ab8b3dea74">Length</a>();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a89e845376c1ce491bbe3c1b8c26dac68">GeometryCore::CryostatBoundaries</a></div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a89e845376c1ce491bbe3c1b8c26dac68">  791</a></span>&#160;    (<span class="keywordtype">double</span>* boundaries, <a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a> <span class="keyword">const</span>&amp; cid) <span class="keyword">const</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo = Cryostat(cid);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    cryo.<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#af6acf6ab68d0798eb317777a80bcb30e">Boundaries</a>(boundaries);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="comment">// GeometryCore::CryostatBoundaries()</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// This method returns the distance between the specified planes.</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// p1 &lt; p2</span></div>
<div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">  800</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">GeometryCore::PlanePitch</a>(</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#abf7d62dd39e4ff6c1f1046a76416448e">geo::PlaneID::PlaneID_t</a> <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a>, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#abf7d62dd39e4ff6c1f1046a76416448e">geo::PlaneID::PlaneID_t</a> p2</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    )<span class="keyword"> const</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(tpcid).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">PlanePitch</a>(p1, p2);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">GeometryCore::PlanePitch</a></div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a117281d01b2af445747ffd2bf0904bd7">  809</a></span>&#160;    (<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2) <span class="keyword">const</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">return</span> PlanePitch(pid1.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#afbbfe0283793584dbbb2f2a8a1079de6">asTPCID</a>(), pid1.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, pid2.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac92f4baa5e8910e9ca023c52eaf360c6">  814</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">GeometryCore::PlanePitch</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a>,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p2,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat)<span class="keyword"> const</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">PlanePitch</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a>(cstat, tpc), p1, p2);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// This method returns the distance between wires in a plane.</span></div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a608b6838f7d8b7be32ea8fca24a7ff32">  824</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a608b6838f7d8b7be32ea8fca24a7ff32">GeometryCore::WirePitch</a>(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a93b943c9a953f5b98e166cd21865ad4d">Plane</a>(planeid).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#abbb4a8a4b112ec8e24cc970a40e8b592">WirePitch</a>();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// This method returns the distance between wires in the specified view</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">// it assumes all planes of a given view have the same pitch</span></div>
<div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6a237a2c906c725c5fad3a5518c08cc9">  832</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a608b6838f7d8b7be32ea8fca24a7ff32">GeometryCore::WirePitch</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view)<span class="keyword"> const</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// look in cryostat 0, tpc 0 to find the plane with the</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// specified view</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>({ 0, 0 }).<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a93b943c9a953f5b98e166cd21865ad4d">Plane</a>(view).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#abbb4a8a4b112ec8e24cc970a40e8b592">WirePitch</a>();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// This method returns the distance between wires in the specified view</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// it assumes all planes of a given view have the same pitch</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1c4a60af9e395182d4ecc267a2362d88">GeometryCore::WireAngleToVertical</a></div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1c4a60af9e395182d4ecc267a2362d88">  843</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> view, <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid) <span class="keyword">const</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// loop over the planes in cryostat 0, tpc 0 to find the plane with the</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// specified view</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = this-&gt;<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>(tpcid);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>(); ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> <span class="keyword">const</span>&amp; plane = TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">if</span> (plane.<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#aa5686dd2cfd623b83eeb2b4e18db42ae">View</a>() == view) <span class="keywordflow">return</span> plane.<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a4aee7822c8ac09d443815098f48fe285">ThetaZ</a>();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;WireAngleToVertical(): no view \&quot;&quot;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      &lt;&lt; <a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a06001188a786e194be6cd97bc5efc8a3">geo::PlaneGeo::ViewName</a>(view) &lt;&lt; <span class="stringliteral">&quot;\&quot; (#&quot;</span> &lt;&lt; ((int) view)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;) in &quot;</span> &lt;&lt; std::string(tpcid);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  } <span class="comment">// GeometryCore::WireAngleToVertical()</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a949c22136e275ebffa8b8303892b09a9">  858</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a949c22136e275ebffa8b8303892b09a9">GeometryCore::MaxTPCs</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxTPCs = 0;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>()) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxTPCsInCryo = cryo.NTPC();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">if</span> (maxTPCsInCryo &gt; maxTPCs) maxTPCs = maxTPCsInCryo;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">return</span> maxTPCs;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  } <span class="comment">// GeometryCore::MaxTPCs()</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00868"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c7b6ee5f43a8c7246f0a4df001af56b">  868</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c7b6ee5f43a8c7246f0a4df001af56b">GeometryCore::TotalNTPC</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// it looks like C++11 lambdas have made STL algorithms easier to use,</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// but only so much:</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">return</span> std::accumulate(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>().<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(), <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>().<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>(), 0U,</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      [](<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum, <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        { <span class="keywordflow">return</span> sum + cryo.<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a2f01042b5618212a40a63bb4ea1ff8f2">NTPC</a>(); }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  } <span class="comment">// GeometryCore::TotalNTPC()</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab7bc49ee230e6ee98fe079160203ecd">  878</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aab7bc49ee230e6ee98fe079160203ecd">GeometryCore::MaxPlanes</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxPlanes = 0;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>()) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxPlanesInCryo = cryo.MaxPlanes();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">if</span> (maxPlanesInCryo &gt; maxPlanes) maxPlanes = maxPlanesInCryo;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">return</span> maxPlanes;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  } <span class="comment">// GeometryCore::MaxPlanes()</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a96e44bf06c54aa7926fefac596d6c177">  888</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a96e44bf06c54aa7926fefac596d6c177">GeometryCore::MaxWires</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxWires = 0;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>&amp; cryo: <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>()) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxWiresInCryo = cryo.MaxWires();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">if</span> (maxWiresInCryo &gt; maxWires) maxWires = maxWiresInCryo;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">return</span> maxWires;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  } <span class="comment">// GeometryCore::MaxWires()</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00898"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a470ce053d8738a2b74570a155861719a">  898</a></span>&#160;  TGeoVolume <span class="keyword">const</span>* <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a470ce053d8738a2b74570a155861719a">GeometryCore::WorldVolume</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">return</span> gGeoManager-&gt;FindVolumeFast(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">GetWorldVolumeName</a>().c_str());</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">  903</a></span>&#160;  <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">GeometryCore::WorldBox</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    TGeoVolume <span class="keyword">const</span>* world = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a470ce053d8738a2b74570a155861719a">WorldVolume</a>();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span>(!world) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;no world volume &#39;&quot;</span> &lt;&lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">GetWorldVolumeName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    TGeoShape <span class="keyword">const</span>* <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = world-&gt;GetShape();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span>(!s) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;world volume &#39;&quot;</span> &lt;&lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">GetWorldVolumeName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39; is shapeless!!!\n&quot;</span>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordtype">double</span> x1, x2, y1, y2, z1, z2;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    s-&gt;GetAxisRange(1, x1, x2);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    s-&gt;GetAxisRange(2, y1, y2);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    s-&gt;GetAxisRange(3, z1, z2);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// geo::BoxBoundedGeo constructor will sort the coordinates as needed</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>{ x1, x2, y1, y2, z1, z2 };</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  } <span class="comment">// GeometryCore::WorldBox()</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4cb07be3e973feb8d44bfa2ba5a6c874">  926</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">GeometryCore::WorldBox</a>(<span class="keywordtype">double</span>* xlo, <span class="keywordtype">double</span>* xhi,</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                          <span class="keywordtype">double</span>* ylo, <span class="keywordtype">double</span>* yhi,</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                          <span class="keywordtype">double</span>* zlo, <span class="keywordtype">double</span>* zhi)<span class="keyword"> const</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> <span class="keyword">const</span> box = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">WorldBox</a>();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (xlo) *xlo = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">MinX</a>();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span> (ylo) *ylo = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">MinY</a>();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">if</span> (zlo) *zlo = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">MinZ</a>();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (xhi) *xhi = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">MaxX</a>();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (yhi) *yhi = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">MaxY</a>();</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> (zhi) *zhi = box.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">MaxZ</a>();</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a88a43c6a47349de09d811ce317d0c532">  940</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a88a43c6a47349de09d811ce317d0c532">GeometryCore::VolumeName</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// check that the given point is in the World volume at least</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    TGeoVolume <span class="keyword">const</span>*volWorld = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a470ce053d8738a2b74570a155861719a">WorldVolume</a>();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">double</span> halflength = ((TGeoBBox*)volWorld-&gt;GetShape())-&gt;GetDZ();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">double</span> halfheight = ((TGeoBBox*)volWorld-&gt;GetShape())-&gt;GetDY();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">double</span> halfwidth  = ((TGeoBBox*)volWorld-&gt;GetShape())-&gt;GetDX();</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(point.x()) &gt; halfwidth  ||</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;       <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(point.y()) &gt; halfheight ||</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;       <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(point.z()) &gt; halflength</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;       ){</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;GeometryCoreBadInputPoint&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;point (&quot;</span> &lt;&lt; point.x() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                              &lt;&lt; point.y() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; point.z() &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                              &lt;&lt; <span class="stringliteral">&quot;is not inside the world volume &quot;</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                              &lt;&lt; <span class="stringliteral">&quot; half width = &quot;</span> &lt;&lt; halfwidth</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                              &lt;&lt; <span class="stringliteral">&quot; half height = &quot;</span> &lt;&lt; halfheight</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                              &lt;&lt; <span class="stringliteral">&quot; half length = &quot;</span> &lt;&lt; halflength</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                              &lt;&lt; <span class="stringliteral">&quot; returning unknown volume name&quot;</span>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keyword">const</span> std::string <a class="code" href="../../de/d0b/evd__uboone__purity_8fcl.html#abe73d2831c042b2e2cc72e24ce065ea8">unknown</a>(<span class="stringliteral">&quot;unknownVolume&quot;</span>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../de/d0b/evd__uboone__purity_8fcl.html#abe73d2831c042b2e2cc72e24ce065ea8">unknown</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">return</span> gGeoManager-&gt;FindNode(point.X(), point.Y(), point.Z())-&gt;GetName();</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00966"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#afb45a152297f95caa5b16f86eaf78554">  966</a></span>&#160;  TGeoMaterial <span class="keyword">const</span>* <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#afb45a152297f95caa5b16f86eaf78554">GeometryCore::Material</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> pNode = gGeoManager-&gt;FindNode(point.X(), point.Y(), point.Z());</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (!pNode) <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> pMedium = pNode-&gt;GetMedium();</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">return</span> pMedium? pMedium-&gt;GetMaterial(): <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ef3bbf81814eb942fc49650ced31bfb">  974</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa830bd0f8c34c670acb8f747331b6a7a">GeometryCore::MaterialName</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// check that the given point is in the World volume at least</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> worldBox = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">WorldBox</a>();</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (!worldBox.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a622d215597bab1d7664e6e6e6d145679">ContainsPosition</a>(point)) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;GeometryCoreBadInputPoint&quot;</span>)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;point &quot;</span> &lt;&lt; point &lt;&lt; <span class="stringliteral">&quot; is not inside the world volume &quot;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        &lt;&lt; worldBox.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#adcb85d99c08984dc3e955c3417ad5954">Min</a>() &lt;&lt; <span class="stringliteral">&quot; -- &quot;</span> &lt;&lt; worldBox.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ace3bda9b9c99ed27d46824811102c4e2">Max</a>()</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;; returning unknown material name&quot;</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keywordflow">return</span> { <span class="stringliteral">&quot;unknownMaterial&quot;</span> };</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> pMaterial = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#afb45a152297f95caa5b16f86eaf78554">Material</a>(point);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (!pMaterial) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;GeometryCoreBadInputPoint&quot;</span>)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;material for point &quot;</span> &lt;&lt; point</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; not found! returning unknown material name&quot;</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="keywordflow">return</span> { <span class="stringliteral">&quot;unknownMaterial&quot;</span> };</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> pMaterial-&gt;GetName();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  std::vector&lt;TGeoNode const*&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae4a32b9f6e0b4c6f7be2da8def634272">GeometryCore::FindDetectorEnclosure</a></div>
<div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae4a32b9f6e0b4c6f7be2da8def634272">  998</a></span>&#160;    (std::string <span class="keyword">const</span>&amp; name <span class="comment">/* = &quot;volDetEnclosure&quot; */</span>) <span class="keyword">const</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;     std::vector&lt;TGeoNode const*&gt; path { ROOTGeoManager()-&gt;GetTopNode() };</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;     <span class="keywordflow">if</span> (!FindFirstVolume(name, path)) path.clear();</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;     <span class="keywordflow">return</span> path;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  } <span class="comment">// FindDetectorEnclosure()</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#acfdf330f5749a04ece04f9ce0cff9c12">GeometryCore::FindFirstVolume</a></div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#acfdf330f5749a04ece04f9ce0cff9c12"> 1007</a></span>&#160;    (std::string <span class="keyword">const</span>&amp; name, std::vector&lt;const TGeoNode*&gt;&amp; path) <span class="keyword">const</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    assert(!path.empty());</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>* pCurrent = path.back();</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// first check the current layer</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span> (strncmp(name.c_str(), pCurrent-&gt;GetName(), name.length()) == 0)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">//explore the next layer down</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>* pCurrentVolume = pCurrent-&gt;GetVolume();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nd = pCurrentVolume-&gt;GetNdaughters();</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nd; ++i) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      path.push_back(pCurrentVolume-&gt;GetNode(i));</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordflow">if</span> (FindFirstVolume(name, path)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      path.pop_back();</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  } <span class="comment">// FindFirstVolume()</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0143911432bbf6cb2a7f44c1a5e901a0"> 1030</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0143911432bbf6cb2a7f44c1a5e901a0">GeometryCore::BuildGeometry</a>(<a class="code" href="../../df/d6f/classgeo_1_1GeometryBuilder.html">geo::GeometryBuilder</a>&amp; builder)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="../../d0/d14/classgeo_1_1GeoNodePath.html">geo::GeoNodePath</a> path{ gGeoManager-&gt;GetTopNode() };</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">Cryostats</a>() = builder.<a class="code" href="../../df/d6f/classgeo_1_1GeometryBuilder.html#a3f2bbe95e2269a5c0ba4a293cefa37ed">extractCryostats</a>(path);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">AuxDets</a>() = builder.<a class="code" href="../../df/d6f/classgeo_1_1GeometryBuilder.html#a211d3ad94eec0ae5ca390a5aa2fe1c26">extractAuxiliaryDetectors</a>(path);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="comment">// Return the total mass of the detector</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af7350949b3e9bf56438e6c059d95dc86"> 1042</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab473a256691e1f78b32c3e974eb7c0f1">GeometryCore::TotalMass</a>(std::string vol)<span class="keyword"> const</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">//the TGeoNode::GetVolume() returns the TGeoVolume of the detector outline</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">//and ROOT calculates the mass in kg for you</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    TGeoVolume *gvol = gGeoManager-&gt;FindVolumeFast(vol.c_str());</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span>(gvol) <span class="keywordflow">return</span> gvol-&gt;Weight();</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;could not find specified volume &#39;&quot;</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                         &lt;&lt; vol</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                         &lt;&lt; <span class="stringliteral">&quot; &#39;to determine total mass\n&quot;</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7ff84b10c51241d621b8b2918c692a51">GeometryCore::MassBetweenPoints</a></div>
<div class="line"><a name="l01056"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7ff84b10c51241d621b8b2918c692a51"> 1056</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a>, <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; p2) <span class="keyword">const</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">//The purpose of this method is to determine the column density</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">//between the two points given.  Do that by starting at p1 and</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">//stepping until you get to the node of p2.  calculate the distance</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">//between the point just inside that node and p2 to get the last</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">//bit of column density</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordtype">double</span> columnD = 0.;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//first initialize a track - get the direction cosines</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a22d2a7c73b2795146b92cd54ded9e817">geo::Vector_t</a> <span class="keyword">const</span> <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = (p2 - <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a>).Unit();</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> dxyz[3] = { dir.X(), dir.Y(), dir.Z() };</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> cp1[3] = { p1.X(), p1.Y(), p1.Z() };</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    gGeoManager-&gt;InitTrack(cp1, dxyz);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">//might be helpful to have a point to a TGeoNode</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    TGeoNode *node = gGeoManager-&gt;GetCurrentNode();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">//check that the points are not in the same volume already.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//if they are in different volumes, keep stepping until you</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">//are in the same volume as the second point</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">while</span>(!gGeoManager-&gt;IsSameLocation(p2.X(), p2.Y(), p2.Z())){</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      gGeoManager-&gt;FindNextBoundary();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      columnD += gGeoManager-&gt;GetStep()*node-&gt;GetMedium()-&gt;GetMaterial()-&gt;GetDensity();</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="comment">//the act of stepping puts you in the next node and returns that node</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      node = gGeoManager-&gt;Step();</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    }<span class="comment">//end loop to get to volume of second point</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">//now you are in the same volume as the last point, but not at that point.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">//get the distance between the current point and the last one</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span> last</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      = <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(gGeoManager-&gt;GetCurrentPoint());</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> lastStep = (p2 - last).R();</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    columnD += lastStep*node-&gt;GetMedium()-&gt;GetMaterial()-&gt;GetDensity();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> columnD;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae34f7c1324064838fd1869dd5f806e0f"> 1098</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae34f7c1324064838fd1869dd5f806e0f">GeometryCore::Info</a>(std::string indent <span class="comment">/* = &quot;&quot; */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    std::ostringstream sstr;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ade5ed7450c103fccfe6137d2d2fff78d">Print</a>(sstr, indent);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">return</span> sstr.str();</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  } <span class="comment">// GeometryCore::Info()</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36"> 1107</a></span>&#160;  std::vector&lt; geo::WireID &gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">GeometryCore::ChannelToWire</a>( <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel )<span class="keyword"> const</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;ChannelToWire(channel);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af7bb8c9354ff0e8c4fa129c42746aed3"> 1113</a></span>&#160;  <a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af7bb8c9354ff0e8c4fa129c42746aed3">GeometryCore::ChannelToROP</a>(<a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel)<span class="keyword"> const</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;ChannelToROP(channel);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  } <span class="comment">// GeometryCore::ChannelToROP()</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae81e63f01473939eb6bc9c2cb5455906">GeometryCore::WireCoordinate</a></div>
<div class="line"><a name="l01121"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7c37cd66a8a3aeba3b6655395f95ce90"> 1121</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; pos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a>(planeid).WireCoordinate(pos);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae81e63f01473939eb6bc9c2cb5455906">GeometryCore::WireCoordinate</a></div>
<div class="line"><a name="l01128"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae81e63f01473939eb6bc9c2cb5455906"> 1128</a></span>&#160;    (<span class="keywordtype">double</span> YPos, <span class="keywordtype">double</span> ZPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">return</span> fChannelMapAlg-&gt;WireCoordinate(YPos, ZPos, planeid);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// The NearestWire and PlaneWireToChannel are attempts to speed</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// up the simulation by memorizing the computationally intensive</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">// setup steps for some geometry calculations.  The results are</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="comment">// valid assuming the wire planes are comprised of straight,</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="comment">// parallel wires with constant pitch across the entire plane, with</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="comment">// a hierarchical numbering scheme - Ben J Oct 2011</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae85bec0c140819ff386eaf19be3b94d3">GeometryCore::NearestWire</a></div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae85bec0c140819ff386eaf19be3b94d3"> 1141</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">return</span> NearestWireID(point, planeid).Wire;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">// return fChannelMapAlg-&gt;NearestWire(worldPos, planeid);</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae85bec0c140819ff386eaf19be3b94d3">GeometryCore::NearestWire</a></div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4b8d1c94d69cc215e4075a9e05aa3fb5"> 1149</a></span>&#160;    (<span class="keyword">const</span> <span class="keywordtype">double</span> worldPos[3], <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> NearestWire(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldPos), planeid);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae85bec0c140819ff386eaf19be3b94d3">GeometryCore::NearestWire</a></div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a172f0cece692d581c754f3c53e02d978"> 1156</a></span>&#160;    (std::vector&lt;double&gt; <span class="keyword">const</span>&amp; worldPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">if</span>(worldPos.size() &gt; 3) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;bad size vector for &quot;</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                                             &lt;&lt; <span class="stringliteral">&quot;worldPos: &quot;</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                                             &lt;&lt; worldPos.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">return</span> NearestWire(worldPos.data(), planeid);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7f9644be6b7a420fbeeb54c9ded33d62">GeometryCore::NearestWireID</a></div>
<div class="line"><a name="l01166"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7f9644be6b7a420fbeeb54c9ded33d62"> 1166</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; worldPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a>(planeid).NearestWireID(worldPos);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7f9644be6b7a420fbeeb54c9ded33d62">GeometryCore::NearestWireID</a></div>
<div class="line"><a name="l01173"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a381aa816c24fca50cb239c760d09ec72"> 1173</a></span>&#160;    (std::vector&lt;double&gt; <span class="keyword">const</span>&amp; worldPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span>(worldPos.size() &gt; 3) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;bad size vector for &quot;</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                                             &lt;&lt; <span class="stringliteral">&quot;worldPos: &quot;</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                                             &lt;&lt; worldPos.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">return</span> NearestWireID(worldPos.data(), planeid);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7f9644be6b7a420fbeeb54c9ded33d62">GeometryCore::NearestWireID</a></div>
<div class="line"><a name="l01183"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3efdfe07c8b190479944e0271ecbadfd"> 1183</a></span>&#160;    (<span class="keyword">const</span> <span class="keywordtype">double</span> worldPos[3], <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">return</span> NearestWireID(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldPos), planeid);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#adf00ac2c31c7e7073d68294f1f67db84">GeometryCore::NearestChannel</a></div>
<div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad4b3cb278eb314e15ccaa2004af37172"> 1190</a></span>&#160;    (<span class="keyword">const</span> <span class="keywordtype">double</span> worldPos[3], <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">return</span> NearestChannel(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(worldPos), planeid);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#adf00ac2c31c7e7073d68294f1f67db84">GeometryCore::NearestChannel</a></div>
<div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae4e32b10b658ad3bc9106765d4695c16"> 1197</a></span>&#160;    (std::vector&lt;double&gt; <span class="keyword">const</span>&amp; worldPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span>(worldPos.size() &gt; 3) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;bad size vector for &quot;</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                                             &lt;&lt; <span class="stringliteral">&quot;worldPos: &quot;</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                                             &lt;&lt; worldPos.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">return</span> NearestChannel(worldPos.data(), planeid);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#adf00ac2c31c7e7073d68294f1f67db84">GeometryCore::NearestChannel</a></div>
<div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#adf00ac2c31c7e7073d68294f1f67db84"> 1207</a></span>&#160;    (<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; worldPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid) <span class="keyword">const</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// This method is supposed to return a channel number rather than</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">//  a wire number.  Perform the conversion here (although, maybe</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">//  faster if we deal in wire numbers rather than channel numbers?)</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">// NOTE on failure both NearestChannel() and upstream:</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">// * according to documentation, should return invalid channel</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">// * in the actual code throw an exception because of a BUG</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">// The following implementation automatically becomes in fact compliant to</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// the documentation if upstreams becomes compliant to.</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// When that happens, just delete this comment.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <span class="keyword">const</span> wireID = NearestWireID(worldPos, planeid);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">return</span> wireID? PlaneWireToChannel(wireID): <a class="code" href="../../d9/d63/namespaceraw.html#ac59223371efaecdc5ef8389bc976a20a">raw::InvalidChannelID</a>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  } <span class="comment">// GeometryCore::NearestChannel()</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="comment">//--------------------------------------</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6c38d4f2515d255850c228d937455b7b"> 1226</a></span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6c38d4f2515d255850c228d937455b7b">GeometryCore::PlaneWireToChannel</a>(<a class="code" href="../../de/db1/structgeo_1_1WireID.html">WireID</a> <span class="keyword">const</span>&amp; wireid)<span class="keyword"> const</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;PlaneWireToChannel(wireid);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// Functions to allow determination if two wires intersect, and if so where.</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// This is useful information during 3D reconstruction.</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab46ba9b18652ff3f4bd363309b6470ab"> 1234</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab46ba9b18652ff3f4bd363309b6470ab">GeometryCore::ValueInRange</a>(<span class="keywordtype">double</span> <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a>, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max)<span class="keyword"> const</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">if</span>(min&gt;max) std::swap(min,max);<span class="comment">//protect against funny business due to wire angles</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(value-min)&lt;1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-6||<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(value-max)&lt;1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-6) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">return</span> (value&gt;=min) &amp;&amp; (value&lt;=max);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ea7260faf3371dd2df6dce530f3100b">GeometryCore::WireEndPoints</a></div>
<div class="line"><a name="l01243"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ea7260faf3371dd2df6dce530f3100b"> 1243</a></span>&#160;    (<a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <span class="keyword">const</span>&amp; wireid, <span class="keywordtype">double</span> *xyzStart, <span class="keywordtype">double</span> *xyzEnd) <span class="keyword">const</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html">Segment_t</a> result = WireEndPoints(wireid);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    xyzStart[0] = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>().X();</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    xyzStart[1] = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>().Y();</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    xyzStart[2] = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>().Z();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    xyzEnd[0]   = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>().X();</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    xyzEnd[1]   = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>().Y();</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    xyzEnd[2]   = result.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>().Z();</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span>(xyzEnd[2]&lt;xyzStart[2]){</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="comment">//ensure that &quot;End&quot; has higher z-value than &quot;Start&quot;</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      std::swap(xyzStart[0],xyzEnd[0]);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      std::swap(xyzStart[1],xyzEnd[1]);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      std::swap(xyzStart[2],xyzEnd[2]);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">if</span>(xyzEnd[1]&lt;xyzStart[1] &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xyzEnd[2]-xyzStart[2])&lt;0.01){</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="comment">// if wire is vertical ensure that &quot;End&quot; has higher y-value than &quot;Start&quot;</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      std::swap(xyzStart[0],xyzEnd[0]);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      std::swap(xyzStart[1],xyzEnd[1]);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      std::swap(xyzStart[2],xyzEnd[2]);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  } <span class="comment">// GeometryCore::WireEndPoints(WireID, 2x double*)</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">//Changed to use WireIDsIntersect(). Apr, 2015 T.Yang</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#adee6114479572ff27f97ac2d22cac53b"> 1271</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#adee6114479572ff27f97ac2d22cac53b">GeometryCore::ChannelsIntersect</a>(<a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> c1,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                   <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> c2,</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                   <span class="keywordtype">double</span> &amp;<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>,</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                   <span class="keywordtype">double</span> &amp;<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// [GP] these errors should be exceptions, and this function is deprecated</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// because it violates interoperability</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    std::vector&lt;geo::WireID&gt; chan1wires = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">ChannelToWire</a>(c1);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (chan1wires.empty()) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      mf::LogError(<span class="stringliteral">&quot;ChannelsIntersect&quot;</span>)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;1st channel &quot;</span> &lt;&lt; c1 &lt;&lt; <span class="stringliteral">&quot; maps to no wire (is it a real one?)&quot;</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    std::vector&lt;geo::WireID&gt; chan2wires = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">ChannelToWire</a>(c2);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">if</span> (chan2wires.empty()) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      mf::LogError(<span class="stringliteral">&quot;ChannelsIntersect&quot;</span>)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;2nd channel &quot;</span> &lt;&lt; c2 &lt;&lt; <span class="stringliteral">&quot; maps to no wire (is it a real one?)&quot;</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">if</span> (chan1wires.size() &gt; 1) {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;ChannelsIntersect&quot;</span>)</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;1st channel &quot;</span> &lt;&lt; c1 &lt;&lt; <span class="stringliteral">&quot; maps to &quot;</span> &lt;&lt; chan2wires.size()</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; wires; using the first!&quot;</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (chan2wires.size() &gt; 1) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      mf::LogError(<span class="stringliteral">&quot;ChannelsIntersect&quot;</span>)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;2nd channel &quot;</span> &lt;&lt; c2 &lt;&lt; <span class="stringliteral">&quot; maps to &quot;</span> &lt;&lt; chan2wires.size()</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; wires; using the first!&quot;</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a> widIntersect;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">WireIDsIntersect</a>(chan1wires[0],chan2wires[0],widIntersect)){</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      y = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      z = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      y = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      z = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a59e61574d3b7e5d3d4741a6efe2927c8"> 1320</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a59e61574d3b7e5d3d4741a6efe2927c8">GeometryCore::IntersectLines</a>(</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordtype">double</span> A_start_x, <span class="keywordtype">double</span> A_start_y, <span class="keywordtype">double</span> A_end_x, <span class="keywordtype">double</span> A_end_y,</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordtype">double</span> B_start_x, <span class="keywordtype">double</span> B_start_y, <span class="keywordtype">double</span> B_end_x, <span class="keywordtype">double</span> B_end_y,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// Equation from http://en.wikipedia.org/wiki/Line%E2%80%93line_intersection</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">// T.Yang Nov, 2014</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">// Notation: x =&gt; coordinate orthogonal to the drift direction and to the beam direction</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">//           y =&gt; direction orthogonal to the previous and to beam direction</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> denom = (A_start_x - A_end_x)*(B_start_y - B_end_y)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      - (A_start_y - A_end_y)*(B_start_x - B_end_x);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">coordIs</a>.<a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#ae4d264e700788cfcba13b5da872e5b98">zero</a>(denom)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = (A_start_x * A_end_y - A_start_y * A_end_x) / denom;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> B = (B_start_x * B_end_y - B_start_y * B_end_x) / denom;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    x = (B_start_x - B_end_x) * A - (A_start_x - A_end_x) * B;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    y = (B_start_y - B_end_y) * A - (A_start_y - A_end_y) * B;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  } <span class="comment">// GeometryCore::IntersectLines()</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a581821b4cc2ef88976a7f9d4ee39da93"> 1347</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a581821b4cc2ef88976a7f9d4ee39da93">GeometryCore::IntersectSegments</a>(</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordtype">double</span> A_start_x, <span class="keywordtype">double</span> A_start_y, <span class="keywordtype">double</span> A_end_x, <span class="keywordtype">double</span> A_end_y,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordtype">double</span> B_start_x, <span class="keywordtype">double</span> B_start_y, <span class="keywordtype">double</span> B_end_x, <span class="keywordtype">double</span> B_end_y,</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordtype">bool</span> bCross = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a59e61574d3b7e5d3d4741a6efe2927c8">IntersectLines</a>(</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      A_start_x, A_start_y, A_end_x, A_end_y,</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      B_start_x, B_start_y, B_end_x, B_end_y,</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      x, y</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      );</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (bCross) {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;IntersectSegments&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;The segments are parallel!&quot;</span>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9ee3a8a8c330bb54b30c83c36fb9ad48">PointWithinSegments</a>(</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      A_start_x, A_start_y, A_end_x, A_end_y,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      B_start_x, B_start_y, B_end_x, B_end_y,</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      x, y</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      );</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  } <span class="comment">// GeometryCore::IntersectSegments()</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a28dac922b1957211d7b454d287f0816e"> 1374</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">GeometryCore::WireIDsIntersect</a>(</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid1, <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid2,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a> &amp; widIntersect</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    static_assert(</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      std::numeric_limits&lt;decltype(widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>)&gt;::has_infinity,</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="stringliteral">&quot;the vector coordinate type can&#39;t represent infinity!&quot;</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      );</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    constexpr <span class="keyword">auto</span> infinity</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      = std::numeric_limits&lt;decltype(widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>)&gt;::infinity();</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa3b07e30b7af5cec06a46108765484ea">WireIDIntersectionCheck</a>(wid1, wid2)) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a> = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a> = infinity;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#ac75d55277b9cf17b597be88d7d5a0605">TPC</a> = <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a6e17844b7495cec8e30f4bf21138de1a">geo::TPCID::InvalidID</a>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// get the endpoints to see if wires intersect</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html">Segment_t</a> <span class="keyword">const</span> w1 = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ea7260faf3371dd2df6dce530f3100b">WireEndPoints</a>(wid1);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html">Segment_t</a> <span class="keyword">const</span> w2 = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ea7260faf3371dd2df6dce530f3100b">WireEndPoints</a>(wid2);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">// TODO extract the coordinates in the right way;</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">// is it any worth, since then the result is in (y, z), whatever it means?</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a6d6bf1fbfc01fffd5287c494fa30a694">cross</a> = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a59e61574d3b7e5d3d4741a6efe2927c8">IntersectLines</a>(</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[1], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[2], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[1], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[2],</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[1], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[2], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[1], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[2],</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>, widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      );</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> (!cross) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a> = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a> = infinity;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#ac75d55277b9cf17b597be88d7d5a0605">TPC</a> = <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a6e17844b7495cec8e30f4bf21138de1a">geo::TPCID::InvalidID</a>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordtype">bool</span> <span class="keyword">const</span> within = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9ee3a8a8c330bb54b30c83c36fb9ad48">PointWithinSegments</a>(</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[1], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[2], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[1], w1.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[2],</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[1], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">start</a>()[2], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[1], w2.<a class="code" href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">end</a>()[2],</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>, widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      );</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#ac75d55277b9cf17b597be88d7d5a0605">TPC</a> = (within? wid1.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>: <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a6e17844b7495cec8e30f4bf21138de1a">geo::TPCID::InvalidID</a>);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// return whether the intersection is within the length of both wires</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">return</span> within;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  } <span class="comment">// GeometryCore::WireIDsIntersect(WireIDIntersection)</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93"> 1423</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">GeometryCore::WireIDsIntersect</a>(</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid1, <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid2,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>&amp; intersection</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  )<span class="keyword"></span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keyword">    const</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">// This is not a real 3D intersection: the wires do not cross, since they</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// are required to belong to two different planes.</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">// After Christopher Backhouse suggestion, we take the point on the first</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// wire which is closest to the other one.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    static_assert(</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      std::numeric_limits&lt;decltype(intersection.X())&gt;::has_infinity,</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="stringliteral">&quot;the vector coordinate type can&#39;t represent infinity!&quot;</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      );</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    constexpr <span class="keyword">auto</span> infinity</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      = std::numeric_limits&lt;decltype(intersection.X())&gt;::infinity();</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa3b07e30b7af5cec06a46108765484ea">WireIDIntersectionCheck</a>(wid1, wid2)) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      intersection = { infinity, infinity, infinity };</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a> <span class="keyword">const</span>&amp; wire1 = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad049620022af30eb998b5843dcf6d10a">Wire</a>(wid1);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a> <span class="keyword">const</span>&amp; wire2 = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad049620022af30eb998b5843dcf6d10a">Wire</a>(wid2);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">// distance of the intersection point from the center of the two wires:</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html">geo::IntersectionPointAndOffsets&lt;geo::Point_t&gt;</a> intersectionAndOffset</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      = <a class="code" href="../../d6/d23/namespacegeo.html#a4f821d2ed6a4f3007af47503920c8d0c">geo::WiresIntersectionAndOffsets</a>(wire1, wire2);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    intersection = intersectionAndOffset.<a class="code" href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#af76137960814f494656c36a9c9002fe3">point</a>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordtype">bool</span> <span class="keyword">const</span> within = (</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(intersectionAndOffset.<a class="code" href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#a410c1759d6ef4372116b3a3d98cb8197">offset1</a>) &lt;= wire1.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>())</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      &amp;&amp; (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(intersectionAndOffset.<a class="code" href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#ac96c199b15a9b61115120ddb3c5363f3">offset2</a>) &lt;= wire2.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">HalfL</a>())</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      );</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">// return whether the intersection is within the length of both wires</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">return</span> within;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  } <span class="comment">// GeometryCore::WireIDsIntersect(Point3D_t)</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">GeometryCore::WireIDsIntersect</a></div>
<div class="line"><a name="l01470"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0f2202b0b9b365a738d3a4247a498faa"> 1470</a></span>&#160;    (<span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid1, <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid2, TVector3&amp; intersection)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keyword">const</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordtype">bool</span> res = WireIDsIntersect(wid1, wid2, p);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    intersection = <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a>(p);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  } <span class="comment">// GeometryCore::WireIDsIntersect(TVector3)</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3334b9ddce59662dd6388f86fb6eca1a">GeometryCore::ThirdPlane</a></div>
<div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3334b9ddce59662dd6388f86fb6eca1a"> 1482</a></span>&#160;    (<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2) <span class="keyword">const</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// how many planes in the TPC pid1 belongs to:</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nPlanes = Nplanes(pid1);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">if</span>(nPlanes != 3) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ThirdPlane() supports only TPCs with 3 planes, and I see &quot;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        &lt;&lt; nPlanes &lt;&lt; <span class="stringliteral">&quot; instead\n&quot;</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#abf7d62dd39e4ff6c1f1046a76416448e">geo::PlaneID::PlaneID_t</a> target_plane = nPlanes;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#abf7d62dd39e4ff6c1f1046a76416448e">geo::PlaneID::PlaneID_t</a> iPlane = 0; iPlane &lt; nPlanes; ++iPlane){</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keywordflow">if</span> ((iPlane == pid1.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>) || (iPlane == pid2.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordflow">if</span> (target_plane != nPlanes) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;ThirdPlane() found too many planes that are not &quot;</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          &lt;&lt; std::string(pid1) &lt;&lt; <span class="stringliteral">&quot; nor &quot;</span> &lt;&lt; std::string(pid2)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;! (first &quot;</span> &lt;&lt; target_plane &lt;&lt; <span class="stringliteral">&quot;, then &quot;</span> &lt;&lt; iPlane &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      } <span class="comment">// if we had a target already</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      target_plane = iPlane;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (target_plane == nPlanes) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ThirdPlane() can&#39;t find a plane that is not &quot;</span> &lt;&lt; std::string(pid1)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; nor &quot;</span> &lt;&lt; std::string(pid2) &lt;&lt; <span class="stringliteral">&quot;!\n&quot;</span>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a05ff5cebd7313582756a33d8e8a5971a">geo::PlaneID</a>(pid1, target_plane);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  } <span class="comment">// GeometryCore::ThirdPlane()</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a02223aae3885b7a39ce61bcba0ae3134">GeometryCore::CheckIndependentPlanesOnSameTPC</a></div>
<div class="line"><a name="l01514"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a02223aae3885b7a39ce61bcba0ae3134"> 1514</a></span>&#160;    (<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2, <span class="keyword">const</span> <span class="keywordtype">char</span>* caller)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span>(pid1.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#afbbfe0283793584dbbb2f2a8a1079de6">asTPCID</a>() != pid2.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#afbbfe0283793584dbbb2f2a8a1079de6">asTPCID</a>()) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        &lt;&lt; caller &lt;&lt; <span class="stringliteral">&quot; needs two planes on the same TPC (got &quot;</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        &lt;&lt; std::string(pid1) &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; std::string(pid2) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">if</span>(pid1 == pid2) { <span class="comment">// was: return 999;</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;GeometryCore&quot;</span>)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        &lt;&lt; caller &lt;&lt; <span class="stringliteral">&quot; needs two different planes, got &quot;</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        &lt;&lt; std::string(pid1) &lt;&lt; <span class="stringliteral">&quot; twice\n&quot;</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  } <span class="comment">// GeometryCore::CheckIndependentPlanesOnSameTPC()</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2e0e08b6fa5b1fd9907f3b8f6899df9d"> 1529</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2e0e08b6fa5b1fd9907f3b8f6899df9d">GeometryCore::ThirdPlaneSlope</a>(</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <span class="keywordtype">double</span> slope1,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2, <span class="keywordtype">double</span> slope2,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; output_plane</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a02223aae3885b7a39ce61bcba0ae3134">CheckIndependentPlanesOnSameTPC</a>(pid1, pid2, <span class="stringliteral">&quot;ThirdPlaneSlope()&quot;</span>);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a> = this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(pid1);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="comment">// We need the &quot;wire coordinate direction&quot; for each plane.</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// This is perpendicular to the wire orientation.</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">// PlaneGeo::PhiZ() defines the right orientation too.</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae572f03626bdad3ed914b23688137dd5">ComputeThirdPlaneSlope</a>(</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(pid1).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a3eadd163eb0c333bbf69e6392e53c831">PhiZ</a>(), slope1,</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(pid2).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a3eadd163eb0c333bbf69e6392e53c831">PhiZ</a>(), slope2,</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(output_plane).<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a3eadd163eb0c333bbf69e6392e53c831">PhiZ</a>()</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      );</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  } <span class="comment">// ThirdPlaneSlope()</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0531d5e578d46c13084671df2cad0d63"> 1550</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2e0e08b6fa5b1fd9907f3b8f6899df9d">GeometryCore::ThirdPlaneSlope</a>(</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <span class="keywordtype">double</span> slope1,</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2, <span class="keywordtype">double</span> slope2</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> target_plane = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3334b9ddce59662dd6388f86fb6eca1a">ThirdPlane</a>(pid1, pid2);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2e0e08b6fa5b1fd9907f3b8f6899df9d">ThirdPlaneSlope</a>(pid1, slope1, pid2, slope2, target_plane);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  } <span class="comment">// ThirdPlaneSlope()</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3d70fb5369a087d2907cf42e62ea7a23"> 1559</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3d70fb5369a087d2907cf42e62ea7a23">GeometryCore::ThirdPlane_dTdW</a>(</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <span class="keywordtype">double</span> slope1,</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2, <span class="keywordtype">double</span> slope2,</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; output_plane</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a02223aae3885b7a39ce61bcba0ae3134">CheckIndependentPlanesOnSameTPC</a>(pid1, pid2, <span class="stringliteral">&quot;ThirdPlane_dTdW()&quot;</span>);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a> = this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(pid1);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>[3], pitch[3];</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> <span class="keyword">const</span>* <span class="keyword">const</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a>[3]</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      = { &amp;TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(pid1), &amp;TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(pid2), &amp;TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(output_plane) };</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// We need wire pitch and &quot;wire coordinate direction&quot; for each plane.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="comment">// The latter is perpendicular to the wire orientation.</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="comment">// PlaneGeo::PhiZ() defines the right orientation too.</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      angle[i] = planes[i]-&gt;<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#a3eadd163eb0c333bbf69e6392e53c831">PhiZ</a>();</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      pitch[i] = planes[i]-&gt;<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html#abbb4a8a4b112ec8e24cc970a40e8b592">WirePitch</a>();</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a647f22592a786aa41e34f9adec9a6377">ComputeThirdPlane_dTdW</a>(</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      angle[0], pitch[0], slope1,</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      angle[1], pitch[1], slope2,</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      angle[2], pitch[2]</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      );</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  } <span class="comment">// GeometryCore::ThirdPlane_dTdW()</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6da6815a2b7498f05d93c9e7abb73c05"> 1590</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3d70fb5369a087d2907cf42e62ea7a23">GeometryCore::ThirdPlane_dTdW</a>(</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid1, <span class="keywordtype">double</span> slope1,</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; pid2, <span class="keywordtype">double</span> slope2</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> target_plane = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3334b9ddce59662dd6388f86fb6eca1a">ThirdPlane</a>(pid1, pid2);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a3d70fb5369a087d2907cf42e62ea7a23">ThirdPlane_dTdW</a>(pid1, slope1, pid2, slope2, target_plane);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  } <span class="comment">// ThirdPlane_dTdW()</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// Given slopes dTime/dWire in two planes, return with the slope in the 3rd plane.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="comment">// Requires slopes to be in the same metrics,</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="comment">// e.g. converted in a distances ratio.</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="comment">// B. Baller August 2014</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">// Rewritten by T. Yang Apr 2015 using the equation in H. Greenlee&#39;s talk:</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">// https://cdcvs.fnal.gov/redmine/attachments/download/1821/larsoft_apr20_2011.pdf</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="comment">// slide 2</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae572f03626bdad3ed914b23688137dd5">GeometryCore::ComputeThirdPlaneSlope</a></div>
<div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae572f03626bdad3ed914b23688137dd5"> 1607</a></span>&#160;    (<span class="keywordtype">double</span> angle1, <span class="keywordtype">double</span> slope1, <span class="keywordtype">double</span> angle2, <span class="keywordtype">double</span> slope2, <span class="keywordtype">double</span> angle3)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// note that, if needed, the trigonometric functions can be pre-calculated.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// Can&#39;t resolve very small slopes</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope1) &lt; 0.001) &amp;&amp; (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope2)) &lt; 0.001) <span class="keywordflow">return</span> 0.001;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// We need the &quot;wire coordinate direction&quot; for each plane.</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">// This is perpendicular to the wire orientation.</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordtype">double</span> slope3 = 0.001;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope1) &gt; 0.001 &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope2) &gt; 0.001) {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      slope3</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        = (</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;          + (1./slope1)*std::sin(angle3-angle2)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          - (1./slope2)*std::sin(angle3-angle1)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        ) / std::sin(angle1-angle2)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        ;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">if</span> (slope3 != 0.) slope3 = 1./slope3;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">else</span> slope3 = 999.;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">return</span> slope3;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  } <span class="comment">// GeometryCore::ComputeThirdPlaneSlope()</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a647f22592a786aa41e34f9adec9a6377"> 1632</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a647f22592a786aa41e34f9adec9a6377">GeometryCore::ComputeThirdPlane_dTdW</a>(</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordtype">double</span> angle1, <span class="keywordtype">double</span> pitch1, <span class="keywordtype">double</span> dTdW1,</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordtype">double</span> angle2, <span class="keywordtype">double</span> pitch2, <span class="keywordtype">double</span> dTdW2,</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordtype">double</span> angle_target, <span class="keywordtype">double</span> pitch_target</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      )</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">// we need to convert dt/dw into homogeneous coordinates, and then back;</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="comment">// slope = [dT * (TDCperiod / driftVelocity)] / [dW * wirePitch]</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="comment">// The coefficient of dT is assumed to be the same for all the planes,</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="comment">// and it finally cancels out. Pitches cancel out only if they are all</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">// the same.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">return</span> pitch_target * <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae572f03626bdad3ed914b23688137dd5">ComputeThirdPlaneSlope</a></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      (angle1, dTdW1 / pitch1, angle2, dTdW2 / pitch2, angle_target);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  } <span class="comment">// GeometryCore::ComputeThirdPlane_dTdW()</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="comment">// This function is called if it is determined that two wires in a single TPC must overlap.</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="comment">// To determine the yz coordinate of the wire intersection, we need to know the</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <span class="comment">// endpoints of both wires in xyz-space, and also their orientation (angle), and the</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// inner dimensions of the TPC frame.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="comment">// Note: This calculation is entirely dependent  on an accurate GDML description of the TPC!</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="comment">// Mitch - Feb., 2011</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">// Changed to use WireIDsIntersect(). It does not check whether the intersection is on both wires (the same as the old behavior). T. Yang - Apr, 2015</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aed0d5fe55e605367888c245e1e94f42e"> 1657</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aed0d5fe55e605367888c245e1e94f42e">GeometryCore::IntersectionPoint</a>(<a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <span class="keyword">const</span>&amp; wid1,</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                   <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> <span class="keyword">const</span>&amp; wid2,</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                                   <span class="keywordtype">double</span> &amp;<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <span class="keywordtype">double</span> &amp;<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a> widIntersect;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordtype">bool</span> <span class="keyword">const</span> found = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">WireIDsIntersect</a>(wid1, wid2, widIntersect);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    y = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    z = widIntersect.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">return</span> found;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">//===  TPC set information</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">//===</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa678c24fa0c223b5932de4aa53c9e980"> 1672</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa678c24fa0c223b5932de4aa53c9e980">GeometryCore::NTPCsets</a>(<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html">readout::CryostatID</a> <span class="keyword">const</span>&amp; cryoid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;NTPCsets(cryoid);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  } <span class="comment">// GeometryCore::NTPCsets()</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac05fe78b3616cc42d0357af1a7fd482a"> 1678</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ac05fe78b3616cc42d0357af1a7fd482a">GeometryCore::MaxTPCsets</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;MaxTPCsets();</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  } <span class="comment">// GeometryCore::MaxTPCsets()</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a099ff33eb88a3f01d386163dbf4adb84"> 1684</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a099ff33eb88a3f01d386163dbf4adb84">GeometryCore::HasTPCset</a>(<a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> <span class="keyword">const</span>&amp; tpcsetid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;HasTPCset(tpcsetid);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  } <span class="comment">// GeometryCore::HasTPCset()</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae6d031563e86bcd7bf63120eacbf54be">GeometryCore::FindTPCsetAtPosition</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae6d031563e86bcd7bf63120eacbf54be"> 1691</a></span>&#160;    (<span class="keywordtype">double</span> <span class="keyword">const</span> worldLoc[3]) <span class="keyword">const</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">return</span> TPCtoTPCset(FindTPCAtPosition(worldLoc));</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  } <span class="comment">// GeometryCore::FindTPCsetAtPosition()</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#abd0804094b01e9dc0f99060067253636"> 1698</a></span>&#160;  <a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#abd0804094b01e9dc0f99060067253636">GeometryCore::TPCtoTPCset</a>(<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)<span class="keyword"> const</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;TPCtoTPCset(tpcid);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  } <span class="comment">// GeometryCore::TPCtoTPCset()</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  std::vector&lt;geo::TPCID&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a78d197211a0bc69da12962660f192b6d">GeometryCore::TPCsetToTPCs</a></div>
<div class="line"><a name="l01706"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a78d197211a0bc69da12962660f192b6d"> 1706</a></span>&#160;    (<a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> <span class="keyword">const</span>&amp; tpcsetid) <span class="keyword">const</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">return</span> fChannelMapAlg-&gt;TPCsetToTPCs(tpcsetid);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  } <span class="comment">// GeometryCore::TPCsetToTPCs()</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="comment">//===  Readout plane information</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="comment">//===</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aaa1e62ce39962969e74548a64de7165d"> 1716</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aaa1e62ce39962969e74548a64de7165d">GeometryCore::NROPs</a>(<a class="code" href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a> <span class="keyword">const</span>&amp; tpcsetid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;NROPs(tpcsetid);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  } <span class="comment">// GeometryCore::NROPs()</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa1aa0c2bfbd129420ba2483a9ba63cb2"> 1722</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa1aa0c2bfbd129420ba2483a9ba63cb2">GeometryCore::MaxROPs</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;MaxROPs();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  } <span class="comment">// GeometryCore::MaxROPs()</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5450631227c094213dd07a8f18f4f065"> 1728</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a5450631227c094213dd07a8f18f4f065">GeometryCore::HasROP</a>(<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;HasROP(ropid);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  } <span class="comment">// GeometryCore::HasROP()</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f984546847d38e36494d0a462581407"> 1734</a></span>&#160;  <a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f984546847d38e36494d0a462581407">GeometryCore::WirePlaneToROP</a>(<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> <span class="keyword">const</span>&amp; planeid)<span class="keyword"> const</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;WirePlaneToROP(planeid);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  } <span class="comment">// GeometryCore::WirePlaneToROP()</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  std::vector&lt;geo::PlaneID&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af826df01a240f8c5bb85eaff915c142b">GeometryCore::ROPtoWirePlanes</a></div>
<div class="line"><a name="l01742"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af826df01a240f8c5bb85eaff915c142b"> 1742</a></span>&#160;    (<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid) <span class="keyword">const</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">return</span> fChannelMapAlg-&gt;ROPtoWirePlanes(ropid);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  } <span class="comment">// GeometryCore::ROPtoWirePlanes()</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  std::vector&lt;geo::TPCID&gt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#abcc5e158364334a4aa26fa4fb16e13a2">GeometryCore::ROPtoTPCs</a></div>
<div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#abcc5e158364334a4aa26fa4fb16e13a2"> 1750</a></span>&#160;    (<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid) <span class="keyword">const</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">return</span> fChannelMapAlg-&gt;ROPtoTPCs(ropid);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  } <span class="comment">// GeometryCore::ROPtoTPCs()</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a97623dac48f6ce80e0d7a695058bad79">GeometryCore::FirstChannelInROP</a></div>
<div class="line"><a name="l01758"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a97623dac48f6ce80e0d7a695058bad79"> 1758</a></span>&#160;    (<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid) <span class="keyword">const</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">return</span> fChannelMapAlg-&gt;FirstChannelInROP(ropid);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  } <span class="comment">// GeometryCore::FirstChannelInROP()</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a535bc5fa1da7d8391c42c632ac9f5d55"> 1765</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">GeometryCore::View</a>(<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">View</a>(<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;FirstWirePlaneInROP(ropid));</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  } <span class="comment">// GeometryCore::View()</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a27b36a6a69932c9ee5365a73c26b5950"> 1771</a></span>&#160;  <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">GeometryCore::SignalType</a>(<a class="code" href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a> <span class="keyword">const</span>&amp; ropid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">fChannelMapAlg</a>-&gt;SignalTypeForROPID(ropid);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  } <span class="comment">// GeometryCore::SignalType(ROPID)</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">// Return gdml string which gives sensitive opdet name</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8344f181fdccb43e9fc912fe056bfbfd"> 1781</a></span>&#160;  std::string <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8344f181fdccb43e9fc912fe056bfbfd">GeometryCore::OpDetGeoName</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c)<span class="keyword"> const</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(c).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a255603db5434e0c99b0ef37d410a00a0">OpDetGeoName</a>();</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">// Convert OpDet, Cryo into unique OpDet number</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae172bb853ab49c44b4f396d5dfdb1848"> 1788</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae172bb853ab49c44b4f396d5dfdb1848">GeometryCore::OpDetFromCryo</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> o, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c )<span class="keyword"> const</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> Loaded=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keyword">static</span> std::vector&lt;unsigned int&gt; LowestID;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NCryo;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="comment">// If not yet loaded static parameters, do it</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">if</span>(Loaded == <span class="keyword">false</span>){</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      Loaded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="comment">// Store the lowest ID for each cryostat</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      NCryo=<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>();</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      LowestID.resize(NCryo + 1);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      LowestID.at(0)=0;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> cryo=0; cryo!=NCryo; ++cryo){</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        LowestID.at(cryo+1)=LowestID.at(cryo)+<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(c).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a878dc414182852e45470c31341c1ad00">NOpDet</a>();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span>( (c &lt; NCryo) &amp;&amp; (o &lt; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(c).NOpDet())){</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="keywordflow">return</span> LowestID.at(c)+o;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;OpDetCryoToOpID Error&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Coordinates c=&quot;</span> &lt;&lt; c</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                                    &lt;&lt; <span class="stringliteral">&quot;, o=&quot;</span> &lt;&lt; o</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                                                    &lt;&lt; <span class="stringliteral">&quot; out of range. Abort\n&quot;</span>;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// if all is well, we never get to this point in the method</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">// but still a good idea to be sure to always return something.</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">return</span> INT_MAX;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ed940e72b58f91ab8c48aafc4a3a351"> 1824</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html">OpDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ed940e72b58f91ab8c48aafc4a3a351">GeometryCore::OpDetGeoFromOpChannel</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> OpChannel)<span class="keyword"> const</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">OpDetGeoFromOpDet</a>(this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a599e17467586ea6edacefcd2dab4c40b">OpDetFromOpChannel</a>(OpChannel));</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81"> 1830</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html">OpDetGeo</a>&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">GeometryCore::OpDetGeoFromOpDet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> OpDet)<span class="keyword"> const</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> Loaded=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keyword">static</span> std::vector&lt;unsigned int&gt; LowestID;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">size_t</span> NCryo;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">// If not yet loaded static parameters, do it</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">if</span>(Loaded == <span class="keyword">false</span>){</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      Loaded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <span class="comment">// Store the lowest ID for each cryostat</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      NCryo=<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">Ncryostats</a>();</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      LowestID.resize(NCryo + 1);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      LowestID[0] = 0;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> cryo = 0; cryo != NCryo; ++cryo){</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        LowestID[cryo+1] = LowestID[cryo] + <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(cryo).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a878dc414182852e45470c31341c1ad00">NOpDet</a>();</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i!=NCryo; ++i){</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordflow">if</span>( (OpDet &gt;= LowestID[i]) &amp;&amp; (OpDet &lt; LowestID[i+1]) ){</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordtype">int</span> c = i;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordtype">int</span> o = OpDet-LowestID[i];</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(c).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a47b248e09ca9a64439deb2530db70d39">OpDet</a>(o);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// If we made it here, we didn&#39;t find the right combination. abort</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;OpID To OpDetCryo error&quot;</span>)&lt;&lt;<span class="stringliteral">&quot;OpID out of range, &quot;</span>&lt;&lt; OpDet &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="comment">// Will not reach due to exception</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">Cryostat</a>(0).<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a47b248e09ca9a64439deb2530db70d39">OpDet</a>(0);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="comment">// Find the closest OpChannel to this point, in the appropriate cryostat</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#af568f0e1bec9a323f0698ea89fe22494"> 1867</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af568f0e1bec9a323f0698ea89fe22494">GeometryCore::GetClosestOpDet</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point)<span class="keyword"> const</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a> <span class="keyword">const</span>* cryo = <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#afd05146c702fdd44380922827f3ece3e">PositionToCryostatPtr</a>(point);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">if</span> (!cryo) <span class="keywordflow">return</span> std::numeric_limits&lt;unsigned int&gt;::max();</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordtype">int</span> o = cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a93d16deefcba1ae4d8367ee203b75b5e">GetClosestOpDet</a>(point);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae172bb853ab49c44b4f396d5dfdb1848">OpDetFromCryo</a>(o, cryo-&gt;<a class="code" href="../../de/da3/classgeo_1_1CryostatGeo.html#a388995e3d67347e23b5c0116736481c1">ID</a>().<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="comment">// Find the closest OpChannel to this point, in the appropriate cryostat</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c052c94a8375d9913bebf6b1a097308"> 1878</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af568f0e1bec9a323f0698ea89fe22494">GeometryCore::GetClosestOpDet</a>(<span class="keywordtype">double</span> <span class="keyword">const</span>* point)<span class="keyword"> const</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#af568f0e1bec9a323f0698ea89fe22494">GetClosestOpDet</a>(<a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a>(point)); }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa3b07e30b7af5cec06a46108765484ea">GeometryCore::WireIDIntersectionCheck</a></div>
<div class="line"><a name="l01884"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#aa3b07e30b7af5cec06a46108765484ea"> 1884</a></span>&#160;    (<span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid1, <span class="keyword">const</span> <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>&amp; wid2) <span class="keyword">const</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">if</span> (wid1.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#afbbfe0283793584dbbb2f2a8a1079de6">asTPCID</a>() != wid2) {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      mf::LogError(<span class="stringliteral">&quot;WireIDIntersectionCheck&quot;</span>)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Comparing two wires on different TPCs: return failure.&quot;</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">if</span> (wid1.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> == wid2.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      mf::LogError(<span class="stringliteral">&quot;WireIDIntersectionCheck&quot;</span>)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Comparing two wires in the same plane: return failure&quot;</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (!HasWire(wid1)) {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      mf::LogError(<span class="stringliteral">&quot;WireIDIntersectionCheck&quot;</span>)</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;1st wire &quot;</span> &lt;&lt; wid1 &lt;&lt; <span class="stringliteral">&quot; does not exist (max wire number: &quot;</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        &lt;&lt; Nwires(wid1.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ada0a7c63318565f37beaf5894f8172ea">planeID</a>()) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">if</span> (!HasWire(wid2)) {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      mf::LogError(<span class="stringliteral">&quot;WireIDIntersectionCheck&quot;</span>)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;2nd wire &quot;</span> &lt;&lt; wid2 &lt;&lt; <span class="stringliteral">&quot; does not exist (max wire number: &quot;</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        &lt;&lt; Nwires(wid2.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ada0a7c63318565f37beaf5894f8172ea">planeID</a>()) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  } <span class="comment">// GeometryCore::WireIDIntersectionCheck()</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"><a class="line" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9ee3a8a8c330bb54b30c83c36fb9ad48"> 1913</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a9ee3a8a8c330bb54b30c83c36fb9ad48">GeometryCore::PointWithinSegments</a>(</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keywordtype">double</span> A_start_x, <span class="keywordtype">double</span> A_start_y, <span class="keywordtype">double</span> A_end_x, <span class="keywordtype">double</span> A_end_y,</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordtype">double</span> B_start_x, <span class="keywordtype">double</span> B_start_y, <span class="keywordtype">double</span> B_end_x, <span class="keywordtype">double</span> B_end_y,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>, <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  ) {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">coordIs</a>.<a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#adf35418fbfa0ddc893d811b333606880">withinSorted</a>(x, A_start_x, A_end_x)</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      &amp;&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">coordIs</a>.<a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#adf35418fbfa0ddc893d811b333606880">withinSorted</a>(y, A_start_y, A_end_y)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      &amp;&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">coordIs</a>.<a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#adf35418fbfa0ddc893d811b333606880">withinSorted</a>(x, B_start_x, B_end_x)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      &amp;&amp; <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">coordIs</a>.<a class="code" href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#adf35418fbfa0ddc893d811b333606880">withinSorted</a>(y, B_start_y, B_end_y)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      ;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  } <span class="comment">// GeometryCore::PointWithinSegments()</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  constexpr <a class="code" href="../../d0/d6d/structgeo_1_1details_1_1geometry__iterator__types_1_1BeginPos__t.html">details::geometry_iterator_types::BeginPos_t</a></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <a class="code" href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#a95d1b2fc16a57920e3a8e2c3705ba039">details::geometry_iterator_types::begin_pos</a>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  constexpr <a class="code" href="../../d3/df2/structgeo_1_1details_1_1geometry__iterator__types_1_1EndPos__t.html">details::geometry_iterator_types::EndPos_t</a></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <a class="code" href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#ac70beaa116eb9d17d1d20e22bf5c89e3">details::geometry_iterator_types::end_pos</a>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  constexpr <a class="code" href="../../dc/d78/structgeo_1_1details_1_1geometry__iterator__types_1_1UndefinedPos__t.html">details::geometry_iterator_types::UndefinedPos_t</a></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <a class="code" href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#a00c926c0c04149ebe0acd7b1b59bf472">details::geometry_iterator_types::undefined_pos</a>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="comment">//--- ROOTGeoNodeForwardIterator</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"><a class="line" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a187b2f0d07a41d886000ae4a593c4520"> 1938</a></span>&#160;  <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">ROOTGeoNodeForwardIterator</a>&amp; <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a187b2f0d07a41d886000ae4a593c4520">ROOTGeoNodeForwardIterator::operator++ </a>() {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.empty()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.size() == 1) { <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.pop_back(); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">// I am done; all my descendants were also done already;</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="comment">// first look at my younger siblings</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html">NodeInfo_t</a>&amp; current = <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.back();</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html">NodeInfo_t</a> <span class="keyword">const</span>&amp; parent = <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>[<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.size() - 2];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">if</span> (++(current.<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a23288067fde8b0e252818a0a01499cf3">sibling</a>) &lt; parent.<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a51739e82dd710eccdfbc1fdcac6a9210">self</a>-&gt;GetNdaughters()) {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="comment">// my next sibling exists, let&#39;s parse his descendents</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      current.<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a51739e82dd710eccdfbc1fdcac6a9210">self</a> = parent.<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a51739e82dd710eccdfbc1fdcac6a9210">self</a>-&gt;GetDaughter(current.<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a23288067fde8b0e252818a0a01499cf3">sibling</a>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a81420aaf87572bbbab3a768b31404e4d">reach_deepest_descendant</a>();</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.pop_back(); <span class="comment">// no sibling, it&#39;s time for mum</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  } <span class="comment">// ROOTGeoNodeForwardIterator::operator++</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"><a class="line" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#af80be420e989cc6bb139c5b1bfbeaea6"> 1957</a></span>&#160;  std::vector&lt;TGeoNode const*&gt; <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#af80be420e989cc6bb139c5b1bfbeaea6">ROOTGeoNodeForwardIterator::get_path</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    std::vector&lt;TGeoNode const*&gt; node_path(<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.size());</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(<a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.begin(), <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.end(), node_path.begin(),</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      [](<a class="code" href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html">NodeInfo_t</a> <span class="keyword">const</span>&amp; node_info){ <span class="keywordflow">return</span> node_info.self; });</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">return</span> node_path;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  } <span class="comment">// ROOTGeoNodeForwardIterator::path()</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"><a class="line" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a81420aaf87572bbbab3a768b31404e4d"> 1969</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a81420aaf87572bbbab3a768b31404e4d">ROOTGeoNodeForwardIterator::reach_deepest_descendant</a>() {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#ac519d884aa424be6ab79d5a501dfa124">Node_t</a> descendent = <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.back().self;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">while</span> (descendent-&gt;GetNdaughters() &gt; 0) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      descendent = descendent-&gt;GetDaughter(0);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.emplace_back(descendent, 0U);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    } <span class="comment">// while</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  } <span class="comment">// ROOTGeoNodeForwardIterator::reach_deepest_descendant()</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"><a class="line" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a1d7d391f931b92957866335829e16379"> 1978</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a1d7d391f931b92957866335829e16379">ROOTGeoNodeForwardIterator::init</a>(TGeoNode <span class="keyword">const</span>* start_node) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.clear();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">if</span> (!start_node) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">current_path</a>.emplace_back(start_node, 0U);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <a class="code" href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a81420aaf87572bbbab3a768b31404e4d">reach_deepest_descendant</a>();</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  } <span class="comment">// ROOTGeoNodeForwardIterator::init()</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;} <span class="comment">// namespace geo</span></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a1664147617bb56a9be21be741f3c96a2"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a1664147617bb56a9be21be741f3c96a2">geo::TPCGeo::ID</a></div><div class="ttdeci">geo::TPCID const &amp; ID() const </div><div class="ttdoc">Returns the identifier of this TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00333">TPCGeo.h:333</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html">geo::OpDetGeo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00043">OpDetGeo.h:43</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_abe664bdd977f8f63aec9b6aaf63e48a6"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#abe664bdd977f8f63aec9b6aaf63e48a6">geo::GeometryCore::NAuxDetSensitive</a></div><div class="ttdeci">unsigned int NAuxDetSensitive(size_t const &amp;aid) const </div><div class="ttdoc">Returns the number of sensitive components of auxiliary detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00296">GeometryCore.cxx:296</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae81e63f01473939eb6bc9c2cb5455906"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae81e63f01473939eb6bc9c2cb5455906">geo::GeometryCore::WireCoordinate</a></div><div class="ttdeci">geo::Length_t WireCoordinate(double YPos, double ZPos, geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the index of the nearest wire to the specified position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01128">GeometryCore.cxx:1128</a></div></div>
<div class="ttc" id="structgeo_1_1details_1_1geometry__iterator__types_1_1EndPos__t_html"><div class="ttname"><a href="../../d3/df2/structgeo_1_1details_1_1geometry__iterator__types_1_1EndPos__t.html">geo::details::geometry_iterator_types::EndPos_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00104">GeometryCore.h:104</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad482849401c09b5ce4334b853e5ae40d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad482849401c09b5ce4334b853e5ae40d">geo::GeometryCore::PlaneIDs</a></div><div class="ttdeci">std::set&lt; PlaneID &gt; const &amp; PlaneIDs() const </div><div class="ttdoc">Returns a list of possible PlaneIDs in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00613">GeometryCore.cxx:613</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a290b33def7dfd5636f7abc2871823588"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a290b33def7dfd5636f7abc2871823588">geo::GeometryCore::FindAuxDetSensitiveAtPosition</a></div><div class="ttdeci">void FindAuxDetSensitiveAtPosition(geo::Point_t const &amp;point, std::size_t &amp;adg, std::size_t &amp;sv, double tolerance=0) const </div><div class="ttdoc">Fills the indices of the sensitive auxiliary detector at location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00525">GeometryCore.cxx:525</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="namespacegeo_html_a22d2a7c73b2795146b92cd54ded9e817"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a22d2a7c73b2795146b92cd54ded9e817">geo::Vector_t</a></div><div class="ttdeci">ROOT::Math::DisplacementVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Vector_t</div><div class="ttdoc">Type for representation of momenta in 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00164">geo_vectors.h:164</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a93d16deefcba1ae4d8367ee203b75b5e"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a93d16deefcba1ae4d8367ee203b75b5e">geo::CryostatGeo::GetClosestOpDet</a></div><div class="ttdeci">unsigned int GetClosestOpDet(geo::Point_t const &amp;point) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/CryostatGeo_8cxx_source.html#l00239">CryostatGeo.cxx:239</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_abcc5e158364334a4aa26fa4fb16e13a2"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#abcc5e158364334a4aa26fa4fb16e13a2">geo::GeometryCore::ROPtoTPCs</a></div><div class="ttdeci">std::vector&lt; geo::TPCID &gt; ROPtoTPCs(readout::ROPID const &amp;ropid) const </div><div class="ttdoc">Returns a list of ID of TPCs the specified ROP spans. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01750">GeometryCore.cxx:1750</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_ab4f9970f327243b3034b830815ed1128"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#ab4f9970f327243b3034b830815ed1128">geo::fhicl::CryostatID</a></div><div class="ttdeci">IDparameter&lt; geo::CryostatID &gt; CryostatID</div><div class="ttdoc">Member type of validated geo::CryostatID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00279">geo_types_fhicl.h:279</a></div></div>
<div class="ttc" id="namespacepmtana_html_a9860e62c78db1dd9c7d635a2832b883a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#a9860e62c78db1dd9c7d635a2832b883a">pmtana::std</a></div><div class="ttdeci">double std(const std::vector&lt; short &gt; &amp;wf, const double ped_mean, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00042">UtilFunc.cxx:42</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a280b5bf6a5afdad7de99c7481c308d3f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a280b5bf6a5afdad7de99c7481c308d3f">geo::GeometryCore::CryostatHalfHeight</a></div><div class="ttdeci">geo::Length_t CryostatHalfHeight(geo::CryostatID const &amp;cid) const </div><div class="ttdoc">Returns the height of the cryostat (y direction) </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00778">GeometryCore.cxx:778</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7d772b417e187b4a44654a36ff59aea4"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7d772b417e187b4a44654a36ff59aea4">geo::GeometryCore::fChannelMapAlg</a></div><div class="ttdeci">std::unique_ptr&lt; const geo::ChannelMapAlg &gt; fChannelMapAlg</div><div class="ttdoc">Object containing the channel to wire mapping. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05522">GeometryCore.h:5522</a></div></div>
<div class="ttc" id="geo__vectors__utils__TVector_8h_html"><div class="ttname"><a href="../../df/db6/geo__vectors__utils__TVector_8h.html">geo_vectors_utils_TVector.h</a></div><div class="ttdoc">Specializations of geo_vectors_utils.h for ROOT old vector types. </div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html_a99e74ffcbcfd46cdb9754cde0a2019a1"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">geo::WireIDIntersection::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">z position of intersection </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00805">geo_types.h:805</a></div></div>
<div class="ttc" id="structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t_html"><div class="ttname"><a href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html">geo::ROOTGeoNodeForwardIterator::NodeInfo_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05608">GeometryCore.h:5608</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a697df19a5c945ce5622c50f80e60fbce"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">geo::TPCGeo::PlanePitch</a></div><div class="ttdeci">double PlanePitch(unsigned int p1=0, unsigned int p2=1) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00388">TPCGeo.cxx:388</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a03c3be304c290d57f8909c25e70cfd81"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">geo::GeometryCore::OpDetGeoFromOpDet</a></div><div class="ttdeci">OpDetGeo const &amp; OpDetGeoFromOpDet(unsigned int OpDet) const </div><div class="ttdoc">Returns the geo::OpDetGeo object for the given detector number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01830">GeometryCore.cxx:1830</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_a06001188a786e194be6cd97bc5efc8a3"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#a06001188a786e194be6cd97bc5efc8a3">geo::PlaneGeo::ViewName</a></div><div class="ttdeci">static std::string ViewName(geo::View_t view)</div><div class="ttdoc">Returns the name of the specified view. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd0/PlaneGeo_8cxx_source.html#l00763">PlaneGeo.cxx:763</a></div></div>
<div class="ttc" id="classgeo_1_1details_1_1geometry__iterator__types_html_a00c926c0c04149ebe0acd7b1b59bf472"><div class="ttname"><a href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#a00c926c0c04149ebe0acd7b1b59bf472">geo::details::geometry_iterator_types::undefined_pos</a></div><div class="ttdeci">static constexpr UndefinedPos_t undefined_pos</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00109">GeometryCore.h:109</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a93b943c9a953f5b98e166cd21865ad4d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a93b943c9a953f5b98e166cd21865ad4d">geo::GeometryCore::Plane</a></div><div class="ttdeci">PlaneGeo const &amp; Plane(unsigned int const p, unsigned int const tpc=0, unsigned int const cstat=0) const </div><div class="ttdoc">Returns the specified wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02994">GeometryCore.h:2994</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a93c0f3e32739f934854e649c1ab980c1"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a93c0f3e32739f934854e649c1ab980c1">geo::GeometryCore::DetHalfWidth</a></div><div class="ttdeci">geo::Length_t DetHalfWidth(geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the half width of the active volume of the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00752">GeometryCore.cxx:752</a></div></div>
<div class="ttc" id="rawdigitfilter__icarus_8fcl_html_aa2b9cfdf9a8f294302be0cdf6affea22"><div class="ttname"><a href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a></div><div class="ttdeci">BEGIN_PROLOG true icarus_rawdigitfilter FilterTools FilterPlane1 Plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5e/rawdigitfilter__icarus_8fcl_source.html#l00008">rawdigitfilter_icarus.fcl:8</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a8c7b6ee5f43a8c7246f0a4df001af56b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c7b6ee5f43a8c7246f0a4df001af56b">geo::GeometryCore::TotalNTPC</a></div><div class="ttdeci">unsigned int TotalNTPC() const </div><div class="ttdoc">Returns the total number of TPCs in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00868">GeometryCore.cxx:868</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a6e17844b7495cec8e30f4bf21138de1a"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a6e17844b7495cec8e30f4bf21138de1a">geo::TPCID::InvalidID</a></div><div class="ttdeci">static constexpr TPCID_t InvalidID</div><div class="ttdoc">Special code for an invalid ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00403">geo_types.h:403</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_acc5b52febd2d52ad93c6a033b0563372"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#acc5b52febd2d52ad93c6a033b0563372">geo::ROOTGeoNodeForwardIterator::current_path</a></div><div class="ttdeci">std::vector&lt; NodeInfo_t &gt; current_path</div><div class="ttdoc">which node, which sibling? </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05615">GeometryCore.h:5615</a></div></div>
<div class="ttc" id="namespaceicarus_1_1waveform__operations_1_1details_html_ae295d3f6cb2f9181dccdf0e3492d44e0"><div class="ttname"><a href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">icarus::waveform_operations::details::transform</a></div><div class="ttdeci">static constexpr Sample_t transform(Sample_t sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/WaveformOperations_8h_source.html#l00145">WaveformOperations.h:145</a></div></div>
<div class="ttc" id="structgeo_1_1NodeNameMatcherClass_html_acc3ff2a1e966d8b14888bbf27afca69a"><div class="ttname"><a href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#acc3ff2a1e966d8b14888bbf27afca69a">geo::NodeNameMatcherClass::operator()</a></div><div class="ttdeci">bool operator()(TGeoNode const &amp;node) const </div><div class="ttdoc">Returns whether the specified node matches a set of names. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00668">GeometryCore.cxx:668</a></div></div>
<div class="ttc" id="namespacegeo_html_a63f4a2aa11d6bebb2b018bf037aef79a"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a63f4a2aa11d6bebb2b018bf037aef79a">geo::Length_t</a></div><div class="ttdeci">double Length_t</div><div class="ttdoc">Type used for coordinates and distances. They are measured in centimeters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00137">geo_vectors.h:137</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0593b852bcb047d86f7e008559709198"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0593b852bcb047d86f7e008559709198">geo::GeometryCore::FindAuxDetAtPosition</a></div><div class="ttdeci">unsigned int FindAuxDetAtPosition(double const worldLoc[3], double tolerance=0) const </div><div class="ttdoc">Returns the index of the auxiliary detector at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00505">GeometryCore.cxx:505</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aad1e95cf8d78156a0d09ea1a701d96d6"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aad1e95cf8d78156a0d09ea1a701d96d6">geo::GeometryCore::PositionToCryostat</a></div><div class="ttdeci">CryostatGeo const &amp; PositionToCryostat(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the cryostat at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00460">GeometryCore.cxx:460</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_a187b2f0d07a41d886000ae4a593c4520"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a187b2f0d07a41d886000ae4a593c4520">geo::ROOTGeoNodeForwardIterator::operator++</a></div><div class="ttdeci">ROOTGeoNodeForwardIterator &amp; operator++()</div><div class="ttdoc">Points to the next node, or to nullptr if there are no more. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01938">GeometryCore.cxx:1938</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="AuxDetSensitiveGeo_8h_html"><div class="ttname"><a href="../../db/d42/AuxDetSensitiveGeo_8h.html">AuxDetSensitiveGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of the sensitive portion of an auxiliary detector. </div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a00e9f4cc75f098ae248476aa1cac869b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e9f4cc75f098ae248476aa1cac869b">geo::GeometryCore::PlanePitch</a></div><div class="ttdeci">geo::Length_t PlanePitch(geo::TPCID const &amp;tpcid, geo::PlaneID::PlaneID_t p1=0, geo::PlaneID::PlaneID_t p2=1) const </div><div class="ttdoc">Returns the distance between two planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00800">GeometryCore.cxx:800</a></div></div>
<div class="ttc" id="classgeo_1_1GeoObjectSorter_html_a12e6c8754865e424fbe7384e486deaa6"><div class="ttname"><a href="../../d5/df5/classgeo_1_1GeoObjectSorter.html#a12e6c8754865e424fbe7384e486deaa6">geo::GeoObjectSorter::SortCryostats</a></div><div class="ttdeci">virtual void SortCryostats(std::vector&lt; geo::CryostatGeo &gt; &amp;cgeo) const =0</div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ade5ed7450c103fccfe6137d2d2fff78d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ade5ed7450c103fccfe6137d2d2fff78d">geo::GeometryCore::Print</a></div><div class="ttdeci">void Print(Stream &amp;&amp;out, std::string indent=&quot;  &quot;) const </div><div class="ttdoc">Prints geometry information with maximum verbosity. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05704">GeometryCore.h:5704</a></div></div>
<div class="ttc" id="classgeo_1_1details_1_1geometry__iterator__types_html_a95d1b2fc16a57920e3a8e2c3705ba039"><div class="ttname"><a href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#a95d1b2fc16a57920e3a8e2c3705ba039">geo::details::geometry_iterator_types::begin_pos</a></div><div class="ttdeci">static constexpr BeginPos_t begin_pos</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00107">GeometryCore.h:107</a></div></div>
<div class="ttc" id="namespacegeo_html_a6baec40eaf3ff161f7eb1a5f0779794f"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a></div><div class="ttdeci">enum geo::_plane_proj View_t</div><div class="ttdoc">Enumerate the possible plane projections. </div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a0fcad5daf16e14b04be6fdb949429fa0"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a0fcad5daf16e14b04be6fdb949429fa0">geo::TPCGeo::ActiveHalfHeight</a></div><div class="ttdeci">double ActiveHalfHeight() const </div><div class="ttdoc">Half height (associated with y coordinate) of active TPC volume [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00099">TPCGeo.h:99</a></div></div>
<div class="ttc" id="classgeo_1_1AuxDetGeo_html_ac9646d8cfd1b8aad57857851e37215b7"><div class="ttname"><a href="../../db/d4f/classgeo_1_1AuxDetGeo.html#ac9646d8cfd1b8aad57857851e37215b7">geo::AuxDetGeo::SensitiveVolume</a></div><div class="ttdeci">AuxDetSensitiveGeo const &amp; SensitiveVolume(size_t sv) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8a/AuxDetGeo_8h_source.html#l00171">AuxDetGeo.h:171</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486ae329b0f520125896d02940bec370fca7"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486ae329b0f520125896d02940bec370fca7">geo::kUnknown</a></div><div class="ttdoc">Unknown view. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00136">geo_types.h:136</a></div></div>
<div class="ttc" id="classgeo_1_1ChannelMapAlg_html_aa94729290764f72b26341f536ffa5a07"><div class="ttname"><a href="../../d0/dff/classgeo_1_1ChannelMapAlg.html#aa94729290764f72b26341f536ffa5a07">geo::ChannelMapAlg::Sorter</a></div><div class="ttdeci">virtual geo::GeoObjectSorter const &amp; Sorter() const =0</div><div class="ttdoc">Returns the object to sort geometry with. </div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ab3391de99203f6a60eeeef152d3adb35"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">geo::TPCGeo::Nplanes</a></div><div class="ttdeci">unsigned int Nplanes() const </div><div class="ttdoc">Number of planes in this tpc. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00165">TPCGeo.h:165</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1RealComparisons_html"><div class="ttname"><a href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html">lar::util::RealComparisons&lt; geo::Length_t &gt;</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a8344f181fdccb43e9fc912fe056bfbfd"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a8344f181fdccb43e9fc912fe056bfbfd">geo::GeometryCore::OpDetGeoName</a></div><div class="ttdeci">std::string OpDetGeoName(unsigned int c=0) const </div><div class="ttdoc">Returns gdml string which gives sensitive opdet name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01781">GeometryCore.cxx:1781</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a647f22592a786aa41e34f9adec9a6377"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a647f22592a786aa41e34f9adec9a6377">geo::GeometryCore::ComputeThirdPlane_dTdW</a></div><div class="ttdeci">static double ComputeThirdPlane_dTdW(double angle1, double pitch1, double dTdW1, double angle2, double pitch2, double dTdW2, double angle_target, double pitch_target)</div><div class="ttdoc">Returns the slope on the third plane, given it in the other two. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01632">GeometryCore.cxx:1632</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1RealComparisons_html_ae4d264e700788cfcba13b5da872e5b98"><div class="ttname"><a href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#ae4d264e700788cfcba13b5da872e5b98">lar::util::RealComparisons::zero</a></div><div class="ttdeci">constexpr bool zero(Value_t value) const </div><div class="ttdoc">Returns whether the value is no farther from 0 than the threshold. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/RealComparisons_8h_source.html#l00073">RealComparisons.h:73</a></div></div>
<div class="ttc" id="PMTconfigurationExtraction__module_8cc_html_ac33ee765f5ad9f134540bac393721cfe"><div class="ttname"><a href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">get</a></div><div class="ttdeci">get()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d87/PMTconfigurationExtraction__module_8cc_source.html#l00168">PMTconfigurationExtraction_module.cc:168</a></div></div>
<div class="ttc" id="OpFlashAlg__test_8cc_html_a9831d5eb20e67514532655869f703820"><div class="ttname"><a href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a></div><div class="ttdeci">auto const tolerance</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3e/OpFlashAlg__test_8cc_source.html#l00009">OpFlashAlg_test.cc:9</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_afd042da19afb090ba80e93ee64d4dec5"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">geo::BoxBoundedGeo::MinX</a></div><div class="ttdeci">double MinX() const </div><div class="ttdoc">Returns the world x coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00088">BoxBoundedGeo.h:88</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_abf7d62dd39e4ff6c1f1046a76416448e"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#abf7d62dd39e4ff6c1f1046a76416448e">geo::PlaneID::PlaneID_t</a></div><div class="ttdeci">unsigned int PlaneID_t</div><div class="ttdoc">Type for the ID number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00473">geo_types.h:473</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a></div><div class="ttdoc">The data type to uniquely identify a Plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00472">geo_types.h:472</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa1aa0c2bfbd129420ba2483a9ba63cb2"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa1aa0c2bfbd129420ba2483a9ba63cb2">geo::GeometryCore::MaxROPs</a></div><div class="ttdeci">unsigned int MaxROPs() const </div><div class="ttdoc">Returns the largest number of ROPs a TPC set in the detector has. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01722">GeometryCore.cxx:1722</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad65f61eddd8ae3f03c1727507bac7b82"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">geo::GeometryCore::DetectorEnclosureBox</a></div><div class="ttdeci">geo::BoxBoundedGeo DetectorEnclosureBox(std::string const &amp;name=&quot;volDetEnclosure&quot;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00629">GeometryCore.cxx:629</a></div></div>
<div class="ttc" id="structreadout_1_1TPCsetID_html"><div class="ttname"><a href="../../d5/d8f/structreadout_1_1TPCsetID.html">readout::TPCsetID</a></div><div class="ttdoc">Class identifying a set of TPC sharing readout channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d64/readout__types_8h_source.html#l00070">readout_types.h:70</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1ca01320887c730e90fddfa2b52db371"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1ca01320887c730e90fddfa2b52db371">geo::GeometryCore::GetWorldVolumeName</a></div><div class="ttdeci">const std::string GetWorldVolumeName() const </div><div class="ttdoc">Return the name of the world volume (needed by Geant4 simulation) </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00619">GeometryCore.cxx:619</a></div></div>
<div class="ttc" id="structgeo_1_1GeometryCore_1_1Segment_html_a1465395d72b0c6955294ba92a04dfb0f"><div class="ttname"><a href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#a1465395d72b0c6955294ba92a04dfb0f">geo::GeometryCore::Segment::start</a></div><div class="ttdeci">Point const &amp; start() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01492">GeometryCore.h:1492</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae4a32b9f6e0b4c6f7be2da8def634272"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae4a32b9f6e0b4c6f7be2da8def634272">geo::GeometryCore::FindDetectorEnclosure</a></div><div class="ttdeci">std::vector&lt; TGeoNode const * &gt; FindDetectorEnclosure(std::string const &amp;name=&quot;volDetEnclosure&quot;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00998">GeometryCore.cxx:998</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a2e0e08b6fa5b1fd9907f3b8f6899df9d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a2e0e08b6fa5b1fd9907f3b8f6899df9d">geo::GeometryCore::ThirdPlaneSlope</a></div><div class="ttdeci">double ThirdPlaneSlope(geo::PlaneID const &amp;pid1, double slope1, geo::PlaneID const &amp;pid2, double slope2, geo::PlaneID const &amp;output_plane) const </div><div class="ttdoc">Returns the slope on the third plane, given it in the other two. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01529">GeometryCore.cxx:1529</a></div></div>
<div class="ttc" id="classgeo_1_1details_1_1geometry__iterator__types_html_ac70beaa116eb9d17d1d20e22bf5c89e3"><div class="ttname"><a href="../../d5/d71/classgeo_1_1details_1_1geometry__iterator__types.html#ac70beaa116eb9d17d1d20e22bf5c89e3">geo::details::geometry_iterator_types::end_pos</a></div><div class="ttdeci">static constexpr EndPos_t end_pos</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00108">GeometryCore.h:108</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a6437421e5404e2d3178d193e72d3b04f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a6437421e5404e2d3178d193e72d3b04f">geo::GeometryCore::NOpHardwareChannels</a></div><div class="ttdeci">unsigned int NOpHardwareChannels(int opDet) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00265">GeometryCore.cxx:265</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa678c24fa0c223b5932de4aa53c9e980"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa678c24fa0c223b5932de4aa53c9e980">geo::GeometryCore::NTPCsets</a></div><div class="ttdeci">unsigned int NTPCsets(readout::CryostatID const &amp;cryoid) const </div><div class="ttdoc">Returns the total number of TPC sets in the specified cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01672">GeometryCore.cxx:1672</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryBuilder_html_a3f2bbe95e2269a5c0ba4a293cefa37ed"><div class="ttname"><a href="../../df/d6f/classgeo_1_1GeometryBuilder.html#a3f2bbe95e2269a5c0ba4a293cefa37ed">geo::GeometryBuilder::extractCryostats</a></div><div class="ttdeci">Cryostats_t extractCryostats(Path_t const &amp;path)</div><div class="ttdoc">Looks for all cryostats under the specified path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/GeometryBuilder_8h_source.html#l00090">GeometryBuilder.h:90</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1f984546847d38e36494d0a462581407"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f984546847d38e36494d0a462581407">geo::GeometryCore::WirePlaneToROP</a></div><div class="ttdeci">readout::ROPID WirePlaneToROP(geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the ID of the ROP planeid belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01734">GeometryCore.cxx:1734</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_adee6114479572ff27f97ac2d22cac53b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#adee6114479572ff27f97ac2d22cac53b">geo::GeometryCore::ChannelsIntersect</a></div><div class="ttdeci">bool ChannelsIntersect(raw::ChannelID_t c1, raw::ChannelID_t c2, double &amp;y, double &amp;z) const </div><div class="ttdoc">Returns an intersection point of two channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01271">GeometryCore.cxx:1271</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a9dbc2821f5e6608156cf31d6918d66e8"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a9dbc2821f5e6608156cf31d6918d66e8">geo::GeometryCore::PositionToTPCptr</a></div><div class="ttdeci">geo::TPCGeo const * PositionToTPCptr(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00410">GeometryCore.cxx:410</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a470ce053d8738a2b74570a155861719a"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a470ce053d8738a2b74570a155861719a">geo::GeometryCore::WorldVolume</a></div><div class="ttdeci">TGeoVolume const * WorldVolume() const </div><div class="ttdoc">Returns a pointer to the world volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00898">GeometryCore.cxx:898</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0c5d3db5d5490bc3fc8fb3bbdb282f36"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">geo::GeometryCore::ChannelToWire</a></div><div class="ttdeci">std::vector&lt; geo::WireID &gt; ChannelToWire(raw::ChannelID_t const channel) const </div><div class="ttdoc">Returns a list of wires connected to the specified TPC channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01107">GeometryCore.cxx:1107</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a96e44bf06c54aa7926fefac596d6c177"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a96e44bf06c54aa7926fefac596d6c177">geo::GeometryCore::MaxWires</a></div><div class="ttdeci">unsigned int MaxWires() const </div><div class="ttdoc">Returns the largest number of wires among all planes in this detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00888">GeometryCore.cxx:888</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ab4b32e85fa822667ea351cdb1ea8d58d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4b32e85fa822667ea351cdb1ea8d58d">geo::GeometryCore::PositionToTPCID</a></div><div class="ttdeci">geo::TPCID PositionToTPCID(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the ID of the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00452">GeometryCore.cxx:452</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ae141949f30631ded82199f4375c21b7e"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">geo::BoxBoundedGeo::MaxX</a></div><div class="ttdeci">double MaxX() const </div><div class="ttdoc">Returns the world x coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00091">BoxBoundedGeo.h:91</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a84a322550115530c5e6327a8cc5c5b60"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a84a322550115530c5e6327a8cc5c5b60">geo::GeometryCore::ChannelToAuxDetSensitive</a></div><div class="ttdeci">const AuxDetSensitiveGeo &amp; ChannelToAuxDetSensitive(std::string const &amp;auxDetName, uint32_t const &amp;channel) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00563">GeometryCore.cxx:563</a></div></div>
<div class="ttc" id="structgeo_1_1GeometryCore_1_1Segment_html_aff85baf4c4ee2a1ab7f1a35b8867dc46"><div class="ttname"><a href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html#aff85baf4c4ee2a1ab7f1a35b8867dc46">geo::GeometryCore::Segment::end</a></div><div class="ttdeci">Point const &amp; end() const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01495">GeometryCore.h:1495</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a581821b4cc2ef88976a7f9d4ee39da93"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a581821b4cc2ef88976a7f9d4ee39da93">geo::GeometryCore::IntersectSegments</a></div><div class="ttdeci">bool IntersectSegments(double A_start_x, double A_start_y, double A_end_x, double A_end_y, double B_start_x, double B_start_y, double B_end_x, double B_end_y, double &amp;x, double &amp;y) const </div><div class="ttdoc">Computes the intersection between two segments on a plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01347">GeometryCore.cxx:1347</a></div></div>
<div class="ttc" id="classgeo_1_1LocalTransformation_html_ad5fc0e9190e7a3213e592fec90ee7889"><div class="ttname"><a href="../../d7/d2a/classgeo_1_1LocalTransformation.html#ad5fc0e9190e7a3213e592fec90ee7889">geo::LocalTransformation::LocalToWorld</a></div><div class="ttdeci">void LocalToWorld(double const *local, double *world) const </div><div class="ttdoc">Transforms a point from local frame to world frame. </div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_acfdf330f5749a04ece04f9ce0cff9c12"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#acfdf330f5749a04ece04f9ce0cff9c12">geo::GeometryCore::FindFirstVolume</a></div><div class="ttdeci">bool FindFirstVolume(std::string const &amp;name, std::vector&lt; const TGeoNode * &gt; &amp;path) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01007">GeometryCore.cxx:1007</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a78027f596ceed805d4ed6196d3e53641"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a78027f596ceed805d4ed6196d3e53641">geo::GeometryCore::PositionToCryostatID</a></div><div class="ttdeci">geo::CryostatID PositionToCryostatID(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the ID of the cryostat at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00384">GeometryCore.cxx:384</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a748e324d604cec19be4553eaa4a8e208"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a748e324d604cec19be4553eaa4a8e208">geo::GeometryCore::SignalType</a></div><div class="ttdeci">SigType_t SignalType(geo::PlaneID const &amp;pid) const </div><div class="ttdoc">Returns the type of signal on the channels of specified TPC plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00578">GeometryCore.cxx:578</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html_ac75d55277b9cf17b597be88d7d5a0605"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html#ac75d55277b9cf17b597be88d7d5a0605">geo::WireIDIntersection::TPC</a></div><div class="ttdeci">unsigned int TPC</div><div class="ttdoc">TPC of intersection. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00806">geo_types.h:806</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html">geo::CryostatGeo</a></div><div class="ttdoc">Geometry information for a single cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00043">CryostatGeo.h:43</a></div></div>
<div class="ttc" id="structgeo_1_1NodeNameMatcherClass_html_a15cb8188ce2f02bed15c26dd9f7ddc62"><div class="ttname"><a href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a15cb8188ce2f02bed15c26dd9f7ddc62">geo::NodeNameMatcherClass::vol_names</a></div><div class="ttdeci">std::set&lt; std::string &gt; const * vol_names</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00662">GeometryCore.cxx:662</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ab4691c2dc44983f6082defa5a34cb001"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ab4691c2dc44983f6082defa5a34cb001">geo::GeometryCore::Ncryostats</a></div><div class="ttdeci">unsigned int Ncryostats() const </div><div class="ttdoc">Returns the number of cryostats in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01994">GeometryCore.h:1994</a></div></div>
<div class="ttc" id="structgeo_1_1CollectNodesByName_html_a134dc26dc4867f1627bce2ef1eb8d417"><div class="ttname"><a href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a134dc26dc4867f1627bce2ef1eb8d417">geo::CollectNodesByName::operator()</a></div><div class="ttdeci">void operator()(TGeoNode const &amp;node)</div><div class="ttdoc">If the name of the node matches, records the end node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00682">GeometryCore.cxx:682</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae6d031563e86bcd7bf63120eacbf54be"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae6d031563e86bcd7bf63120eacbf54be">geo::GeometryCore::FindTPCsetAtPosition</a></div><div class="ttdeci">readout::TPCsetID FindTPCsetAtPosition(double const worldLoc[3]) const </div><div class="ttdoc">Returns the ID of the TPC set at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01691">GeometryCore.cxx:1691</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a33f0c2f4f73e5e751a66bdbe8d26e79e"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a33f0c2f4f73e5e751a66bdbe8d26e79e">geo::GeometryCore::NOpChannels</a></div><div class="ttdeci">unsigned int NOpChannels() const </div><div class="ttdoc">Number of electronics channels for all the optical detectors. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00253">GeometryCore.cxx:253</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a3334b9ddce59662dd6388f86fb6eca1a"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a3334b9ddce59662dd6388f86fb6eca1a">geo::GeometryCore::ThirdPlane</a></div><div class="ttdeci">geo::PlaneID ThirdPlane(geo::PlaneID const &amp;pid1, geo::PlaneID const &amp;pid2) const </div><div class="ttdoc">Returns the plane that is not in the specified arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01482">GeometryCore.cxx:1482</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_af568f0e1bec9a323f0698ea89fe22494"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#af568f0e1bec9a323f0698ea89fe22494">geo::GeometryCore::GetClosestOpDet</a></div><div class="ttdeci">unsigned int GetClosestOpDet(geo::Point_t const &amp;point) const </div><div class="ttdoc">Find the nearest OpChannel to some point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01867">GeometryCore.cxx:1867</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_abd0804094b01e9dc0f99060067253636"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#abd0804094b01e9dc0f99060067253636">geo::GeometryCore::TPCtoTPCset</a></div><div class="ttdeci">readout::TPCsetID TPCtoTPCset(geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the ID of the TPC set tpcid belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01698">GeometryCore.cxx:1698</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa06cc82de2ccb3c591cf6a8309dfa55f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa06cc82de2ccb3c591cf6a8309dfa55f">geo::GeometryCore::ROOTGeoManager</a></div><div class="ttdeci">TGeoManager * ROOTGeoManager() const </div><div class="ttdoc">Access to the ROOT geometry description manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00202">GeometryCore.cxx:202</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a608b6838f7d8b7be32ea8fca24a7ff32"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a608b6838f7d8b7be32ea8fca24a7ff32">geo::GeometryCore::WirePitch</a></div><div class="ttdeci">geo::Length_t WirePitch(geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the distance between two consecutive wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00824">GeometryCore.cxx:824</a></div></div>
<div class="ttc" id="sbnd__flashalgo_8fcl_html_a648c7afac4085c93cd1ba4a75dfe8818"><div class="ttname"><a href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a></div><div class="ttdeci">BEGIN_PROLOG TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d22/sbnd__flashalgo_8fcl_source.html#l00014">sbnd_flashalgo.fcl:14</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae172bb853ab49c44b4f396d5dfdb1848"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae172bb853ab49c44b4f396d5dfdb1848">geo::GeometryCore::OpDetFromCryo</a></div><div class="ttdeci">unsigned int OpDetFromCryo(unsigned int o, unsigned int c) const </div><div class="ttdoc">Get unique opdet number from cryo and internal count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01788">GeometryCore.cxx:1788</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a89e845376c1ce491bbe3c1b8c26dac68"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a89e845376c1ce491bbe3c1b8c26dac68">geo::GeometryCore::CryostatBoundaries</a></div><div class="ttdeci">void CryostatBoundaries(double *boundaries, geo::CryostatID const &amp;cid) const </div><div class="ttdoc">Returns the boundaries of the specified cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00791">GeometryCore.cxx:791</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a599e17467586ea6edacefcd2dab4c40b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a599e17467586ea6edacefcd2dab4c40b">geo::GeometryCore::OpDetFromOpChannel</a></div><div class="ttdeci">unsigned int OpDetFromOpChannel(int opChannel) const </div><div class="ttdoc">Convert unique channel to detector number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00277">GeometryCore.cxx:277</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a231e0d77adfc7461dfacda7a8a29ce35"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a231e0d77adfc7461dfacda7a8a29ce35">geo::GeometryCore::Nchannels</a></div><div class="ttdeci">unsigned int Nchannels() const </div><div class="ttdoc">Returns the number of TPC readout channels in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00208">GeometryCore.cxx:208</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a9ee3a8a8c330bb54b30c83c36fb9ad48"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a9ee3a8a8c330bb54b30c83c36fb9ad48">geo::GeometryCore::PointWithinSegments</a></div><div class="ttdeci">static bool PointWithinSegments(double A_start_x, double A_start_y, double A_end_x, double A_end_y, double B_start_x, double B_start_y, double B_end_x, double B_end_y, double x, double y)</div><div class="ttdoc">Returns whether x and y are within both specified ranges (A and B). </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01913">GeometryCore.cxx:1913</a></div></div>
<div class="ttc" id="structgeo_1_1CollectPathsByName_html_ae51b923d6c2526a5d293d84b79c1eeb0"><div class="ttname"><a href="../../df/d87/structgeo_1_1CollectPathsByName.html#ae51b923d6c2526a5d293d84b79c1eeb0">geo::CollectPathsByName::paths</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TGeoNode const * &gt; &gt; paths</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00693">GeometryCore.cxx:693</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a8e154128f6a27b23f95313fb9229f1f6"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a8e154128f6a27b23f95313fb9229f1f6">geo::GeometryCore::PositionToTPC</a></div><div class="ttdeci">geo::TPCGeo const &amp; PositionToTPC(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00419">GeometryCore.cxx:419</a></div></div>
<div class="ttc" id="structlar_1_1util_1_1RealComparisons_html_adf35418fbfa0ddc893d811b333606880"><div class="ttname"><a href="../../d9/de2/structlar_1_1util_1_1RealComparisons.html#adf35418fbfa0ddc893d811b333606880">lar::util::RealComparisons::withinSorted</a></div><div class="ttdeci">constexpr bool withinSorted(Value_t value, Value_t lower, Value_t upper) const </div><div class="ttdoc">Returns whether value is between bounds (included); bounds are sorted. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/RealComparisons_8h_source.html#l00126">RealComparisons.h:126</a></div></div>
<div class="ttc" id="structgeo_1_1IntersectionPointAndOffsets_html_ac96c199b15a9b61115120ddb3c5363f3"><div class="ttname"><a href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#ac96c199b15a9b61115120ddb3c5363f3">geo::IntersectionPointAndOffsets::offset2</a></div><div class="ttdeci">double offset2</div><div class="ttdoc">Distance from reference point of second line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d76/LineClosestPoint_8h_source.html#l00033">LineClosestPoint.h:33</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a2fb0082b4c921474da4a3bd0b01d543b"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a2fb0082b4c921474da4a3bd0b01d543b">geo::CryostatGeo::PositionToTPCptr</a></div><div class="ttdeci">geo::TPCGeo const * PositionToTPCptr(geo::Point_t const &amp;point, double wiggle) const </div><div class="ttdoc">Returns a pointer to the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/CryostatGeo_8cxx_source.html#l00161">CryostatGeo.cxx:161</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_a05ff5cebd7313582756a33d8e8a5971a"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#a05ff5cebd7313582756a33d8e8a5971a">geo::fhicl::PlaneID</a></div><div class="ttdeci">IDparameter&lt; geo::PlaneID &gt; PlaneID</div><div class="ttdoc">Member type of validated geo::PlaneID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00375">geo_types_fhicl.h:375</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_a4aee7822c8ac09d443815098f48fe285"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#a4aee7822c8ac09d443815098f48fe285">geo::PlaneGeo::ThetaZ</a></div><div class="ttdeci">double ThetaZ() const </div><div class="ttdoc">Angle of the wires from positive z axis; . </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd0/PlaneGeo_8cxx_source.html#l00726">PlaneGeo.cxx:726</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ab473a256691e1f78b32c3e974eb7c0f1"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ab473a256691e1f78b32c3e974eb7c0f1">geo::GeometryCore::TotalMass</a></div><div class="ttdeci">double TotalMass() const </div><div class="ttdoc">Returns the total mass [kg] of the specified volume (default: world). </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01891">GeometryCore.h:1891</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a2f9712306276cf2967c06280d913bb59"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a2f9712306276cf2967c06280d913bb59">geo::GeometryCore::coordIs</a></div><div class="ttdeci">static lar::util::RealComparisons&lt; geo::Length_t &gt; coordIs</div><div class="ttdoc">Value of tolerance for equality comparisons. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01513">GeometryCore.h:1513</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7953310daac7f0bf2f57ceb9760e278f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7953310daac7f0bf2f57ceb9760e278f">geo::GeometryCore::FindTPCAtPosition</a></div><div class="ttdeci">geo::TPCID FindTPCAtPosition(double const worldLoc[3]) const </div><div class="ttdoc">Returns the ID of the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02454">GeometryCore.h:2454</a></div></div>
<div class="ttc" id="GeometryCore_8h_html"><div class="ttname"><a href="../../db/de7/GeometryCore_8h.html">GeometryCore.h</a></div><div class="ttdoc">Access the description of detector geometry. </div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="structgeo_1_1CollectPathsByName_html_aece29fa32520e09d145a5deaab50ef5c"><div class="ttname"><a href="../../df/d87/structgeo_1_1CollectPathsByName.html#aece29fa32520e09d145a5deaab50ef5c">geo::CollectPathsByName::operator()</a></div><div class="ttdeci">void operator()(ROOTGeoNodeForwardIterator const &amp;iter)</div><div class="ttdoc">If the name of the node matches, records the node full path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00698">GeometryCore.cxx:698</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a5450631227c094213dd07a8f18f4f065"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a5450631227c094213dd07a8f18f4f065">geo::GeometryCore::HasROP</a></div><div class="ttdeci">bool HasROP(readout::ROPID const &amp;ropid) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01728">GeometryCore.cxx:1728</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_aa5686dd2cfd623b83eeb2b4e18db42ae"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#aa5686dd2cfd623b83eeb2b4e18db42ae">geo::PlaneGeo::View</a></div><div class="ttdeci">View_t View() const </div><div class="ttdoc">Which coordinate does this plane measure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00184">PlaneGeo.h:184</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0617ecedbcbf1d4b6477d4ced96e4f87"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0617ecedbcbf1d4b6477d4ced96e4f87">geo::GeometryCore::IterateWireIDs</a></div><div class="ttdeci">IteratorBox&lt; wire_id_iterator,&amp;GeometryCore::begin_wire_id,&amp;GeometryCore::end_wire_id &gt; IterateWireIDs() const </div><div class="ttdoc">Enables ranged-for loops on all wire IDs of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l03554">GeometryCore.h:3554</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a255603db5434e0c99b0ef37d410a00a0"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a255603db5434e0c99b0ef37d410a00a0">geo::CryostatGeo::OpDetGeoName</a></div><div class="ttdeci">std::string OpDetGeoName() const </div><div class="ttdoc">Get name of opdet geometry element. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00377">CryostatGeo.h:377</a></div></div>
<div class="ttc" id="structgeo_1_1CollectPathsByName_html_a719856bec52e3f5266873b4d55a8fc89"><div class="ttname"><a href="../../df/d87/structgeo_1_1CollectPathsByName.html#a719856bec52e3f5266873b4d55a8fc89">geo::CollectPathsByName::matcher</a></div><div class="ttdeci">NodeNameMatcherClass matcher</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00702">GeometryCore.cxx:702</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a73d5b65328650214261231a7617ca8d2"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a73d5b65328650214261231a7617ca8d2">geo::GeometryCore::SortGeometry</a></div><div class="ttdeci">void SortGeometry(geo::GeoObjectSorter const &amp;sorter)</div><div class="ttdoc">Runs the sorting of geometry with the sorter provided by channel mapping. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00168">GeometryCore.cxx:168</a></div></div>
<div class="ttc" id="namespaceraw_html_ac59223371efaecdc5ef8389bc976a20a"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#ac59223371efaecdc5ef8389bc976a20a">raw::InvalidChannelID</a></div><div class="ttdeci">constexpr ChannelID_t InvalidChannelID</div><div class="ttdoc">ID of an invalid channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00032">RawTypes.h:32</a></div></div>
<div class="ttc" id="DereferenceIterator_8h_html"><div class="ttname"><a href="../../d7/d96/DereferenceIterator_8h.html">DereferenceIterator.h</a></div><div class="ttdoc">Offer iterators automatically dereferencing their values. </div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aab7bc49ee230e6ee98fe079160203ecd"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aab7bc49ee230e6ee98fe079160203ecd">geo::GeometryCore::MaxPlanes</a></div><div class="ttdeci">unsigned int MaxPlanes() const </div><div class="ttdoc">Returns the largest number of planes among all TPCs in this detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00878">GeometryCore.cxx:878</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html">geo::ROOTGeoNodeForwardIterator</a></div><div class="ttdoc">Iterator to navigate through all the nodes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05590">GeometryCore.h:5590</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad0aaeb8c801d0f6653151ee3e79479e5"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad0aaeb8c801d0f6653151ee3e79479e5">geo::GeometryCore::allViews</a></div><div class="ttdeci">std::set&lt; geo::View_t &gt; allViews</div><div class="ttdoc">All views in the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05526">GeometryCore.h:5526</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_adb675e4a8b4234008e4e738c4dd090a5"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#adb675e4a8b4234008e4e738c4dd090a5">geo::GeometryCore::DetHalfHeight</a></div><div class="ttdeci">geo::Length_t DetHalfHeight(geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the half height of the active volume of the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00758">GeometryCore.cxx:758</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a1e5aaaf25e8609a835e8c7c6fda71456"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div><div class="ttdeci">process_name opflash particleana ie ie y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00091">run_opflash_electron.fcl:91</a></div></div>
<div class="ttc" id="classgeo_1_1LocalTransformation_html"><div class="ttname"><a href="../../d7/d2a/classgeo_1_1LocalTransformation.html">geo::LocalTransformation</a></div><div class="ttdoc">Class to transform between world and local coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d27/LocalTransformation_8h_source.html#l00064">LocalTransformation.h:64</a></div></div>
<div class="ttc" id="Decomposer_8h_html"><div class="ttname"><a href="../../d8/dc6/Decomposer_8h.html">Decomposer.h</a></div><div class="ttdoc">Classes to project and compose a vector on a plane. </div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a47b248e09ca9a64439deb2530db70d39"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a47b248e09ca9a64439deb2530db70d39">geo::CryostatGeo::OpDet</a></div><div class="ttdeci">const OpDetGeo &amp; OpDet(unsigned int iopdet) const </div><div class="ttdoc">Return the iopdet&amp;#39;th optical detector in the cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/CryostatGeo_8cxx_source.html#l00107">CryostatGeo.cxx:107</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_a3eadd163eb0c333bbf69e6392e53c831"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#a3eadd163eb0c333bbf69e6392e53c831">geo::PlaneGeo::PhiZ</a></div><div class="ttdeci">double PhiZ() const </div><div class="ttdoc">Angle from positive z axis of the wire coordinate axis, in radians. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00193">PlaneGeo.h:193</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryBuilder_html_a211d3ad94eec0ae5ca390a5aa2fe1c26"><div class="ttname"><a href="../../df/d6f/classgeo_1_1GeometryBuilder.html#a211d3ad94eec0ae5ca390a5aa2fe1c26">geo::GeometryBuilder::extractAuxiliaryDetectors</a></div><div class="ttdeci">AuxDets_t extractAuxiliaryDetectors(Path_t const &amp;path)</div><div class="ttdoc">Looks for all auxiliary detectors under the specified path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/GeometryBuilder_8h_source.html#l00113">GeometryBuilder.h:113</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a97623dac48f6ce80e0d7a695058bad79"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a97623dac48f6ce80e0d7a695058bad79">geo::GeometryCore::FirstChannelInROP</a></div><div class="ttdeci">raw::ChannelID_t FirstChannelInROP(readout::ROPID const &amp;ropid) const </div><div class="ttdoc">Returns the ID of the first channel in the specified readout plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01758">GeometryCore.cxx:1758</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a5e06d41ad535850049245df99792c77c"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a5e06d41ad535850049245df99792c77c">geo::GeometryCore::ClearGeometry</a></div><div class="ttdeci">void ClearGeometry()</div><div class="ttdoc">Deletes the detector geometry structures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00160">GeometryCore.cxx:160</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a75529802c7b5bfe9772afaa811362187"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a75529802c7b5bfe9772afaa811362187">geo::GeometryCore::HardwareChannelFromOpChannel</a></div><div class="ttdeci">unsigned int HardwareChannelFromOpChannel(int opChannel) const </div><div class="ttdoc">Convert unique channel to hardware channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00283">GeometryCore.cxx:283</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae51606708dac29cdeebe31a8d7c2d019"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae51606708dac29cdeebe31a8d7c2d019">geo::GeometryCore::GeometryCore</a></div><div class="ttdeci">GeometryCore(fhicl::ParameterSet const &amp;pset)</div><div class="ttdoc">Initialize geometry from a given configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00059">GeometryCore.cxx:59</a></div></div>
<div class="ttc" id="namespacegeo_html_a59a0688ea6aaa04f0ffa6451f8083ca1"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a></div><div class="ttdeci">enum geo::_plane_sigtype SigType_t</div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad6b97a9f84409e28b5ad00b0f7000bc4"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6b97a9f84409e28b5ad00b0f7000bc4">geo::GeometryCore::IterateTPCs</a></div><div class="ttdeci">IteratorBox&lt; TPC_iterator,&amp;GeometryCore::begin_TPC,&amp;GeometryCore::end_TPC &gt; IterateTPCs() const </div><div class="ttdoc">Enables ranged-for loops on all TPCs of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02655">GeometryCore.h:2655</a></div></div>
<div class="ttc" id="classgeo_1_1GeoObjectSorter_html"><div class="ttname"><a href="../../d5/df5/classgeo_1_1GeoObjectSorter.html">geo::GeoObjectSorter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dba/GeoObjectSorter_8h_source.html#l00025">GeoObjectSorter.h:25</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa3b07e30b7af5cec06a46108765484ea"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa3b07e30b7af5cec06a46108765484ea">geo::GeometryCore::WireIDIntersectionCheck</a></div><div class="ttdeci">bool WireIDIntersectionCheck(const geo::WireID &amp;wid1, const geo::WireID &amp;wid2) const </div><div class="ttdoc">Wire ID check for WireIDsIntersect methods. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01884">GeometryCore.cxx:1884</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ad27c155668c5d9f850334cc2e005e7aa"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ad27c155668c5d9f850334cc2e005e7aa">geo::TPCGeo::ActiveHalfWidth</a></div><div class="ttdeci">double ActiveHalfWidth() const </div><div class="ttdoc">Half width (associated with x coordinate) of active TPC volume [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00095">TPCGeo.h:95</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae85bec0c140819ff386eaf19be3b94d3"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae85bec0c140819ff386eaf19be3b94d3">geo::GeometryCore::NearestWire</a></div><div class="ttdeci">geo::WireID::WireID_t NearestWire(geo::Point_t const &amp;point, geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the index of wire closest to position in the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01141">GeometryCore.cxx:1141</a></div></div>
<div class="ttc" id="classgeo_1_1GeoObjectSorter_html_a964b6228af5e304ce882ee0ea1a1222c"><div class="ttname"><a href="../../d5/df5/classgeo_1_1GeoObjectSorter.html#a964b6228af5e304ce882ee0ea1a1222c">geo::GeoObjectSorter::SortAuxDets</a></div><div class="ttdeci">virtual void SortAuxDets(std::vector&lt; geo::AuxDetGeo &gt; &amp;adgeo) const =0</div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a></div><div class="ttdoc">Geometry information for a single wire plane.The plane is represented in the geometry by a solid whic...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00082">PlaneGeo.h:82</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="structgeo_1_1NodeNameMatcherClass_html_a5427657d57527b83ea35cbbb286e93c7"><div class="ttname"><a href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html#a5427657d57527b83ea35cbbb286e93c7">geo::NodeNameMatcherClass::NodeNameMatcherClass</a></div><div class="ttdeci">NodeNameMatcherClass(std::set&lt; std::string &gt; const &amp;names)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00664">GeometryCore.cxx:664</a></div></div>
<div class="ttc" id="evd__uboone__purity_8fcl_html_abe73d2831c042b2e2cc72e24ce065ea8"><div class="ttname"><a href="../../de/d0b/evd__uboone__purity_8fcl.html#abe73d2831c042b2e2cc72e24ce065ea8">unknown</a></div><div class="ttdeci">process_name showerreco Particles Coinciding wih the Vertex services ScanOptions nu_mu unknown</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d0b/evd__uboone__purity_8fcl_source.html#l00055">evd_uboone_purity.fcl:55</a></div></div>
<div class="ttc" id="geo__vectors__utils_8h_html"><div class="ttname"><a href="../../d5/d6c/geo__vectors__utils_8h.html">geo_vectors_utils.h</a></div><div class="ttdoc">Utilities to extend the interface of geometry vectors. </div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a67f01c76c031e29c5bcc610f23a0be85"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">geo::BoxBoundedGeo::MinZ</a></div><div class="ttdeci">double MinZ() const </div><div class="ttdoc">Returns the world z coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00118">BoxBoundedGeo.h:118</a></div></div>
<div class="ttc" id="namespaceSortModuleTimes_html_a805854df4323f914a9a09f4e266b4794"><div class="ttname"><a href="../../d7/d8e/namespaceSortModuleTimes.html#a805854df4323f914a9a09f4e266b4794">SortModuleTimes.const</a></div><div class="ttdeci">string const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df3/SortModuleTimes_8py_source.html#l00871">SortModuleTimes.py:871</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0143911432bbf6cb2a7f44c1a5e901a0"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0143911432bbf6cb2a7f44c1a5e901a0">geo::GeometryCore::BuildGeometry</a></div><div class="ttdeci">void BuildGeometry(geo::GeometryBuilder &amp;builder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01030">GeometryCore.cxx:1030</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a2f01042b5618212a40a63bb4ea1ff8f2"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a2f01042b5618212a40a63bb4ea1ff8f2">geo::CryostatGeo::NTPC</a></div><div class="ttdeci">unsigned int NTPC() const </div><div class="ttdoc">Number of TPCs in this cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00181">CryostatGeo.h:181</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00803">geo_types.h:803</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a3ad8501224048854f35e6b29d9ac4a72"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a3ad8501224048854f35e6b29d9ac4a72">geo::GeometryCore::DetLength</a></div><div class="ttdeci">geo::Length_t DetLength(geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the length of the active volume of the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00764">GeometryCore.cxx:764</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a4fc7bfd4e3413fb5c25ca3c72906acac"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a4fc7bfd4e3413fb5c25ca3c72906acac">geo::GeometryCore::Cryostat</a></div><div class="ttdeci">CryostatGeo const &amp; Cryostat(geo::CryostatID const &amp;cryoid) const </div><div class="ttdoc">Returns the specified cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00321">GeometryCore.cxx:321</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a07e176f3ff3f93b46c19fffdddbff72b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a07e176f3ff3f93b46c19fffdddbff72b">geo::GeometryCore::MaxOpChannel</a></div><div class="ttdeci">unsigned int MaxOpChannel() const </div><div class="ttdoc">Largest optical channel number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00259">GeometryCore.cxx:259</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae34f7c1324064838fd1869dd5f806e0f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae34f7c1324064838fd1869dd5f806e0f">geo::GeometryCore::Info</a></div><div class="ttdeci">std::string Info(std::string indent=&quot;  &quot;) const </div><div class="ttdoc">Returns a string with complete geometry information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01098">GeometryCore.cxx:1098</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_adcb85d99c08984dc3e955c3417ad5954"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#adcb85d99c08984dc3e955c3417ad5954">geo::BoxBoundedGeo::Min</a></div><div class="ttdeci">geo::Point_t Min() const </div><div class="ttdoc">Returns the corner point with the smallest coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00133">BoxBoundedGeo.h:133</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a></div><div class="ttdoc">The data type to uniquely identify a TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00386">geo_types.h:386</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7ff84b10c51241d621b8b2918c692a51"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7ff84b10c51241d621b8b2918c692a51">geo::GeometryCore::MassBetweenPoints</a></div><div class="ttdeci">double MassBetweenPoints(geo::Point_t const &amp;p1, geo::Point_t const &amp;p2) const </div><div class="ttdoc">Returns the column density between two points. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01056">GeometryCore.cxx:1056</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a4ddb5a3126f15b642aff93549bacd9a7"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ddb5a3126f15b642aff93549bacd9a7">geo::GeometryCore::~GeometryCore</a></div><div class="ttdeci">~GeometryCore()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00075">GeometryCore.cxx:75</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aed0d5fe55e605367888c245e1e94f42e"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aed0d5fe55e605367888c245e1e94f42e">geo::GeometryCore::IntersectionPoint</a></div><div class="ttdeci">bool IntersectionPoint(geo::WireID const &amp;wid1, geo::WireID const &amp;wid2, double &amp;y, double &amp;z) const </div><div class="ttdoc">Returns the intersection point of two wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01657">GeometryCore.cxx:1657</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a5b02e6bbab566e3f56c9bc81e50a204c"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a5b02e6bbab566e3f56c9bc81e50a204c">geo::GeometryCore::UpdateAfterSorting</a></div><div class="ttdeci">void UpdateAfterSorting()</div><div class="ttdoc">Performs all the updates needed after sorting. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00187">GeometryCore.cxx:187</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a5076e03f8e666d5173015c80b3dd2a2c"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a5076e03f8e666d5173015c80b3dd2a2c">geo::CryostatID::markInvalid</a></div><div class="ttdeci">void markInvalid()</div><div class="ttdoc">Sets the ID as invalid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00240">geo_types.h:240</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a59e61574d3b7e5d3d4741a6efe2927c8"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a59e61574d3b7e5d3d4741a6efe2927c8">geo::GeometryCore::IntersectLines</a></div><div class="ttdeci">bool IntersectLines(double A_start_x, double A_start_y, double A_end_x, double A_end_y, double B_start_x, double B_start_y, double B_end_x, double B_end_y, double &amp;x, double &amp;y) const </div><div class="ttdoc">Computes the intersection between two lines on a plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01320">GeometryCore.cxx:1320</a></div></div>
<div class="ttc" id="classgeo_1_1AuxDetGeo_html"><div class="ttname"><a href="../../db/d4f/classgeo_1_1AuxDetGeo.html">geo::AuxDetGeo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8a/AuxDetGeo_8h_source.html#l00038">AuxDetGeo.h:38</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a57a84b9e6854158fc65a20208a5b4d8d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a57a84b9e6854158fc65a20208a5b4d8d">geo::GeometryCore::View</a></div><div class="ttdeci">View_t View(geo::PlaneID const &amp;pid) const </div><div class="ttdoc">Returns the view (wire orientation) on the channels of specified TPC plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00601">GeometryCore.cxx:601</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad6ee5718d1e5d211d7aa01b78ca773e0"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad6ee5718d1e5d211d7aa01b78ca773e0">geo::GeometryCore::AuxDets</a></div><div class="ttdeci">AuxDetList_t &amp; AuxDets()</div><div class="ttdoc">Return the interfal auxiliary detectors list. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05503">GeometryCore.h:5503</a></div></div>
<div class="ttc" id="structgeo_1_1CollectNodesByName_html_a50f49b835d5794cd81140800b92c93c1"><div class="ttname"><a href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a50f49b835d5794cd81140800b92c93c1">geo::CollectNodesByName::matcher</a></div><div class="ttdeci">NodeNameMatcherClass matcher</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00689">GeometryCore.cxx:689</a></div></div>
<div class="ttc" id="structgeo_1_1IntersectionPointAndOffsets_html_af76137960814f494656c36a9c9002fe3"><div class="ttname"><a href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#af76137960814f494656c36a9c9002fe3">geo::IntersectionPointAndOffsets::point</a></div><div class="ttdeci">Point point</div><div class="ttdoc">Intersection point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d76/LineClosestPoint_8h_source.html#l00031">LineClosestPoint.h:31</a></div></div>
<div class="ttc" id="structreadout_1_1ROPID_html"><div class="ttname"><a href="../../dd/d41/structreadout_1_1ROPID.html">readout::ROPID</a></div><div class="ttdoc">Class identifying a set of planes sharing readout channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d64/readout__types_8h_source.html#l00168">readout_types.h:168</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aba6be67cbf069cb648e6e0e33dcb3f5c"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aba6be67cbf069cb648e6e0e33dcb3f5c">geo::GeometryCore::AuxDet</a></div><div class="ttdeci">AuxDetGeo const &amp; AuxDet(unsigned int const ad=0) const </div><div class="ttdoc">Returns the specified auxiliary detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00340">GeometryCore.cxx:340</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0e8211cab429b722b4ea3131f0d15bc5"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0e8211cab429b722b4ea3131f0d15bc5">geo::GeometryCore::LoadGeometryFile</a></div><div class="ttdeci">void LoadGeometryFile(std::string gdmlfile, std::string rootfile, geo::GeometryBuilder &amp;builder, bool bForceReload=false)</div><div class="ttdoc">Loads the geometry information from the specified files. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00091">GeometryCore.cxx:91</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_adf14d253e55f0968131f4d59bf218fe9"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#adf14d253e55f0968131f4d59bf218fe9">geo::TPCGeo::ActiveLength</a></div><div class="ttdeci">double ActiveLength() const </div><div class="ttdoc">Length (associated with z coordinate) of active TPC volume [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00103">TPCGeo.h:103</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a00e36e8597fcf5d5059e4768f42f5362"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">geo::GeometryCore::NOpDets</a></div><div class="ttdeci">unsigned int NOpDets() const </div><div class="ttdoc">Number of OpDets in the whole detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00244">GeometryCore.cxx:244</a></div></div>
<div class="ttc" id="structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t_html_a23288067fde8b0e252818a0a01499cf3"><div class="ttname"><a href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a23288067fde8b0e252818a0a01499cf3">geo::ROOTGeoNodeForwardIterator::NodeInfo_t::sibling</a></div><div class="ttdeci">int sibling</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05609">GeometryCore.h:5609</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_af80be420e989cc6bb139c5b1bfbeaea6"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#af80be420e989cc6bb139c5b1bfbeaea6">geo::ROOTGeoNodeForwardIterator::get_path</a></div><div class="ttdeci">std::vector&lt; TGeoNode const * &gt; get_path() const </div><div class="ttdoc">Returns the full path of the current node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01957">GeometryCore.cxx:1957</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a3de7527301c4a2a14c261d5d93851aee"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a3de7527301c4a2a14c261d5d93851aee">geo::GeometryCore::fPositionWiggle</a></div><div class="ttdeci">double fPositionWiggle</div><div class="ttdoc">accounting for rounding errors when testing positions </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05517">GeometryCore.h:5517</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a71626e62af098d6a8c09dd97bbf4812b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">geo::BoxBoundedGeo::MaxY</a></div><div class="ttdeci">double MaxY() const </div><div class="ttdoc">Returns the world y coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00106">BoxBoundedGeo.h:106</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="AuxDetGeo_8h_html"><div class="ttname"><a href="../../d4/d8a/AuxDetGeo_8h.html">AuxDetGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of an auxiliary detector. </div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_afbbfe0283793584dbbb2f2a8a1079de6"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#afbbfe0283793584dbbb2f2a8a1079de6">geo::TPCID::asTPCID</a></div><div class="ttdeci">constexpr TPCID const &amp; asTPCID() const </div><div class="ttdoc">Conversion to TPCID (for convenience of notation). </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00446">geo_types.h:446</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a8c73552fcd11a47b172ac35407dd4f88"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a8c73552fcd11a47b172ac35407dd4f88">geo::GeometryCore::FindAllVolumes</a></div><div class="ttdeci">std::vector&lt; TGeoNode const * &gt; FindAllVolumes(std::set&lt; std::string &gt; const &amp;vol_names) const </div><div class="ttdoc">Returns all the nodes with volumes with any of the specified names. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00706">GeometryCore.cxx:706</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_af7bb8c9354ff0e8c4fa129c42746aed3"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#af7bb8c9354ff0e8c4fa129c42746aed3">geo::GeometryCore::ChannelToROP</a></div><div class="ttdeci">readout::ROPID ChannelToROP(raw::ChannelID_t channel) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01113">GeometryCore.cxx:1113</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a62e21472ef96c5430d3b52dc2ea6646f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a62e21472ef96c5430d3b52dc2ea6646f">geo::GeometryCore::OpChannel</a></div><div class="ttdeci">unsigned int OpChannel(int detNum, int hardwareChannel) const </div><div class="ttdoc">Convert detector number and hardware channel to unique channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00271">GeometryCore.cxx:271</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_ac996980052e16111a1efc913778a5f5f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a></div><div class="ttdeci">BEGIN_PROLOG Z planes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a9e88c4815131ef71cf08acc7328e0624"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a9e88c4815131ef71cf08acc7328e0624">geo::WireGeo::HalfL</a></div><div class="ttdeci">double HalfL() const </div><div class="ttdoc">Returns half the length of the wire [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00128">WireGeo.h:128</a></div></div>
<div class="ttc" id="OpDetGeo_8h_html"><div class="ttname"><a href="../../da/d38/OpDetGeo_8h.html">OpDetGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of an optical detector. </div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ac8bee1ed6ef6b770a77e57a06f30e6a2"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ac8bee1ed6ef6b770a77e57a06f30e6a2">geo::GeometryCore::fGDMLfile</a></div><div class="ttdeci">std::string fGDMLfile</div><div class="ttdoc">path to geometry file used for Geant4 simulation </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05513">GeometryCore.h:5513</a></div></div>
<div class="ttc" id="MCSFitAllPID__module_8cc_html_a379d90f9b00321885d601cbe2c94bf63"><div class="ttname"><a href="../../d3/d90/MCSFitAllPID__module_8cc.html#a379d90f9b00321885d601cbe2c94bf63">names</a></div><div class="ttdeci">static const std::vector&lt; std::string &gt; names</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d90/MCSFitAllPID__module_8cc_source.html#l00053">MCSFitAllPID_module.cc:53</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a6e7e4d4d21650dfa9d9f84260465ba93"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a6e7e4d4d21650dfa9d9f84260465ba93">geo::GeometryCore::WireIDsIntersect</a></div><div class="ttdeci">bool WireIDsIntersect(WireID const &amp;wid1, WireID const &amp;wid2, geo::Point_t &amp;intersection) const </div><div class="ttdoc">Computes the intersection between two wires. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01423">GeometryCore.cxx:1423</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1f333c0cab2d2d56580c15c7e851ac66"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1f333c0cab2d2d56580c15c7e851ac66">geo::GeometryCore::PositionToAuxDet</a></div><div class="ttdeci">AuxDetGeo const &amp; PositionToAuxDet(geo::Point_t const &amp;point, unsigned int &amp;ad, double tolerance=0) const </div><div class="ttdoc">Returns the auxiliary detector at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00511">GeometryCore.cxx:511</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad049620022af30eb998b5843dcf6d10a"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad049620022af30eb998b5843dcf6d10a">geo::GeometryCore::Wire</a></div><div class="ttdeci">WireGeo const &amp; Wire(geo::WireID const &amp;wireid) const </div><div class="ttdoc">Returns the specified wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l03419">GeometryCore.h:3419</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_abbd8aef3486d368d18ce29eaa9ab2913"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#abbd8aef3486d368d18ce29eaa9ab2913">geo::CryostatID::CryostatID_t</a></div><div class="ttdeci">unsigned int CryostatID_t</div><div class="ttdoc">Type for the ID number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00191">geo_types.h:191</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a6c38d4f2515d255850c228d937455b7b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a6c38d4f2515d255850c228d937455b7b">geo::GeometryCore::PlaneWireToChannel</a></div><div class="ttdeci">raw::ChannelID_t PlaneWireToChannel(WireID const &amp;wireid) const </div><div class="ttdoc">Returns the ID of the TPC channel connected to the specified wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01226">GeometryCore.cxx:1226</a></div></div>
<div class="ttc" id="GeometryBuilderStandard_8h_html"><div class="ttname"><a href="../../dd/d63/GeometryBuilderStandard_8h.html">GeometryBuilderStandard.h</a></div><div class="ttdoc">Standard implementation of geometry extractor. </div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_afd05146c702fdd44380922827f3ece3e"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#afd05146c702fdd44380922827f3ece3e">geo::GeometryCore::PositionToCryostatPtr</a></div><div class="ttdeci">geo::CryostatGeo const * PositionToCryostatPtr(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the cryostat at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00372">GeometryCore.cxx:372</a></div></div>
<div class="ttc" id="structgeo_1_1CollectNodesByName_html"><div class="ttname"><a href="../../d5/d5f/structgeo_1_1CollectNodesByName.html">geo::CollectNodesByName</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00676">GeometryCore.cxx:676</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a></div><div class="ttdoc">A base class aware of world box coordinatesAn object describing a simple shape can inherit from this ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00033">BoxBoundedGeo.h:33</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_af61021fd8b39bc81feb55d0d6ab5772e"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#af61021fd8b39bc81feb55d0d6ab5772e">geo::GeometryCore::ApplyChannelMap</a></div><div class="ttdeci">void ApplyChannelMap(std::unique_ptr&lt; geo::ChannelMapAlg &gt; pChannelMap)</div><div class="ttdoc">Initializes the geometry to work with this channel map. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00082">GeometryCore.cxx:82</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae572f03626bdad3ed914b23688137dd5"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae572f03626bdad3ed914b23688137dd5">geo::GeometryCore::ComputeThirdPlaneSlope</a></div><div class="ttdeci">static double ComputeThirdPlaneSlope(double angle1, double slope1, double angle2, double slope2, double angle_target)</div><div class="ttdoc">Returns the slope on the third plane, given it in the other two. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01607">GeometryCore.cxx:1607</a></div></div>
<div class="ttc" id="structgeo_1_1CollectNodesByName_html_a325539c36e41fc55cbe61747f1182954"><div class="ttname"><a href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a325539c36e41fc55cbe61747f1182954">geo::CollectNodesByName::CollectNodesByName</a></div><div class="ttdeci">CollectNodesByName(std::set&lt; std::string &gt; const &amp;names)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00679">GeometryCore.cxx:679</a></div></div>
<div class="ttc" id="structgeo_1_1CollectNodesByName_html_a8773ca25a7c5fb877987a52dcd8e2f03"><div class="ttname"><a href="../../d5/d5f/structgeo_1_1CollectNodesByName.html#a8773ca25a7c5fb877987a52dcd8e2f03">geo::CollectNodesByName::nodes</a></div><div class="ttdeci">std::vector&lt; TGeoNode const * &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00677">GeometryCore.cxx:677</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a688fc3a2928f8ac7c93dc645214e86b3"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a688fc3a2928f8ac7c93dc645214e86b3">geo::GeometryCore::CryostatHalfWidth</a></div><div class="ttdeci">geo::Length_t CryostatHalfWidth(geo::CryostatID const &amp;cid) const </div><div class="ttdoc">Returns the half width of the cryostat (x direction) </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00771">GeometryCore.cxx:771</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a878dc414182852e45470c31341c1ad00"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a878dc414182852e45470c31341c1ad00">geo::CryostatGeo::NOpDet</a></div><div class="ttdeci">unsigned int NOpDet() const </div><div class="ttdoc">Number of optical detectors in this TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00361">CryostatGeo.h:361</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a2de0745d12bd608fe66a141667764c69"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a></div><div class="ttdeci">TVector3 toTVector3(Vector const &amp;v)</div><div class="ttdoc">Converts a vector into a TVector3. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/geo__vectors__utils__TVector_8h_source.html#l00043">geo_vectors_utils_TVector.h:43</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_ac519d884aa424be6ab79d5a501dfa124"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#ac519d884aa424be6ab79d5a501dfa124">geo::ROOTGeoNodeForwardIterator::Node_t</a></div><div class="ttdeci">TGeoNode const * Node_t</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05607">GeometryCore.h:5607</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html_a10d38a5448d172ff4c9879e0a349fbc3"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">geo::WireIDIntersection::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">y position of intersection </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00804">geo_types.h:804</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aacc075ddf778fc7cb52df52b2a7e9e42"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aacc075ddf778fc7cb52df52b2a7e9e42">geo::GeometryCore::IterateTPCsetIDs</a></div><div class="ttdeci">IteratorBox&lt; TPCset_id_iterator,&amp;GeometryCore::begin_TPCset_id,&amp;GeometryCore::end_TPCset_id &gt; IterateTPCsetIDs() const </div><div class="ttdoc">Enables ranged-for loops on all TPC set IDs of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05032">GeometryCore.h:5032</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1d2bca28f28ed7dbcd5a3fb9604650f9"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d2bca28f28ed7dbcd5a3fb9604650f9">geo::GeometryCore::GetCryostatVolumeName</a></div><div class="ttdeci">std::string GetCryostatVolumeName(geo::CryostatID const &amp;cid) const </div><div class="ttdoc">Return the name of LAr TPC volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00746">GeometryCore.cxx:746</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_aff3c6d62c880e387d35ab093bdbdcffc"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">geo::BoxBoundedGeo::MaxZ</a></div><div class="ttdeci">double MaxZ() const </div><div class="ttdoc">Returns the world z coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00121">BoxBoundedGeo.h:121</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ac05fe78b3616cc42d0357af1a7fd482a"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ac05fe78b3616cc42d0357af1a7fd482a">geo::GeometryCore::MaxTPCsets</a></div><div class="ttdeci">unsigned int MaxTPCsets() const </div><div class="ttdoc">Returns the largest number of TPC sets any cryostat in the detector has. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01678">GeometryCore.cxx:1678</a></div></div>
<div class="ttc" id="prova__source_8fcl_html_ab58e1ede8542ac672a1c146fb3870f2e"><div class="ttname"><a href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a></div><div class="ttdeci">process_name largeant stream1 can override from command line with o or output physics producers generator N</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/prova__source_8fcl_source.html#l00033">prova_source.fcl:33</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a47b701874a169b122ab9ef6f3edd75bf"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a47b701874a169b122ab9ef6f3edd75bf">geo::GeometryCore::PositionToAuxDetSensitive</a></div><div class="ttdeci">const AuxDetSensitiveGeo &amp; PositionToAuxDetSensitive(geo::Point_t const &amp;point, size_t &amp;ad, size_t &amp;sv, double tolerance=0) const </div><div class="ttdoc">Returns the auxiliary detector at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00542">GeometryCore.cxx:542</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_a1d7d391f931b92957866335829e16379"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a1d7d391f931b92957866335829e16379">geo::ROOTGeoNodeForwardIterator::init</a></div><div class="ttdeci">void init(TGeoNode const *start_node)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01978">GeometryCore.cxx:1978</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a968f535a263d52d92a5e2cb32e37d2f7"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a968f535a263d52d92a5e2cb32e37d2f7">geo::GeometryCore::Cryostats</a></div><div class="ttdeci">CryostatList_t &amp; Cryostats()</div><div class="ttdoc">Return the internal cryostat list. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05497">GeometryCore.h:5497</a></div></div>
<div class="ttc" id="structgeo_1_1GeometryCore_1_1Segment_html"><div class="ttname"><a href="../../d7/dfa/structgeo_1_1GeometryCore_1_1Segment.html">geo::GeometryCore::Segment</a></div><div class="ttdoc">Simple class with two points (a pair with aliases). </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01487">GeometryCore.h:1487</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a478f3785602d16b01ebf2bab808b446e"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a478f3785602d16b01ebf2bab808b446e">geo::GeometryCore::ChannelToAuxDet</a></div><div class="ttdeci">const AuxDetGeo &amp; ChannelToAuxDet(std::string const &amp;auxDetName, uint32_t const &amp;channel) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00555">GeometryCore.cxx:555</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a02223aae3885b7a39ce61bcba0ae3134"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a02223aae3885b7a39ce61bcba0ae3134">geo::GeometryCore::CheckIndependentPlanesOnSameTPC</a></div><div class="ttdeci">static void CheckIndependentPlanesOnSameTPC(geo::PlaneID const &amp;pid1, geo::PlaneID const &amp;pid2, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01514">GeometryCore.cxx:1514</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a6ea7260faf3371dd2df6dce530f3100b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a6ea7260faf3371dd2df6dce530f3100b">geo::GeometryCore::WireEndPoints</a></div><div class="ttdeci">void WireEndPoints(geo::WireID const &amp;wireid, double *xyzStart, double *xyzEnd) const </div><div class="ttdoc">Fills two arrays with the coordinates of the wire end points. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01243">GeometryCore.cxx:1243</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_af826df01a240f8c5bb85eaff915c142b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#af826df01a240f8c5bb85eaff915c142b">geo::GeometryCore::ROPtoWirePlanes</a></div><div class="ttdeci">std::vector&lt; geo::PlaneID &gt; ROPtoWirePlanes(readout::ROPID const &amp;ropid) const </div><div class="ttdoc">Returns a list of ID of planes belonging to the specified ROP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01742">GeometryCore.cxx:1742</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ada23fd77f611d62ab0684a45122448c3"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ada23fd77f611d62ab0684a45122448c3">geo::GeometryCore::fDetectorName</a></div><div class="ttdeci">std::string fDetectorName</div><div class="ttdoc">Name of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05512">GeometryCore.h:5512</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ac703a285b794b2605f5349a3f5a47920"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ac703a285b794b2605f5349a3f5a47920">geo::GeometryCore::CryostatLength</a></div><div class="ttdeci">geo::Length_t CryostatLength(geo::CryostatID const &amp;cid) const </div><div class="ttdoc">Returns the length of the cryostat (z direction) </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00784">GeometryCore.cxx:784</a></div></div>
<div class="ttc" id="structgeo_1_1IntersectionPointAndOffsets_html"><div class="ttname"><a href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html">geo::IntersectionPointAndOffsets</a></div><div class="ttdoc">Data structure for return values of LineClosestPointAndOffsets(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d76/LineClosestPoint_8h_source.html#l00029">LineClosestPoint.h:29</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7f9644be6b7a420fbeeb54c9ded33d62"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7f9644be6b7a420fbeeb54c9ded33d62">geo::GeometryCore::NearestWireID</a></div><div class="ttdeci">geo::WireID NearestWireID(geo::Point_t const &amp;point, geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the ID of wire closest to position in the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01166">GeometryCore.cxx:1166</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryBuilder_html"><div class="ttname"><a href="../../df/d6f/classgeo_1_1GeometryBuilder.html">geo::GeometryBuilder</a></div><div class="ttdoc">Manages the extraction of LArSoft geometry information from ROOT. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/GeometryBuilder_8h_source.html#l00052">GeometryBuilder.h:52</a></div></div>
<div class="ttc" id="structgeo_1_1CollectPathsByName_html"><div class="ttname"><a href="../../df/d87/structgeo_1_1CollectPathsByName.html">geo::CollectPathsByName</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00692">GeometryCore.cxx:692</a></div></div>
<div class="ttc" id="structgeo_1_1NodeNameMatcherClass_html"><div class="ttname"><a href="../../df/dc0/structgeo_1_1NodeNameMatcherClass.html">geo::NodeNameMatcherClass</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00661">GeometryCore.cxx:661</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a19dd16849ed641adb2aff777fdc4bd8b"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div><div class="ttdeci">then echo fcl name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="classgeo_1_1GeoNodePath_html"><div class="ttname"><a href="../../d0/d14/classgeo_1_1GeoNodePath.html">geo::GeoNodePath</a></div><div class="ttdoc">Representation of a node and its ancestry. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dac/GeoNodePath_8h_source.html#l00038">GeoNodePath.h:38</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_afb45a152297f95caa5b16f86eaf78554"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#afb45a152297f95caa5b16f86eaf78554">geo::GeometryCore::Material</a></div><div class="ttdeci">TGeoMaterial const * Material(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the material at the specified position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00966">GeometryCore.cxx:966</a></div></div>
<div class="ttc" id="structgeo_1_1details_1_1geometry__iterator__types_1_1BeginPos__t_html"><div class="ttname"><a href="../../d0/d6d/structgeo_1_1details_1_1geometry__iterator__types_1_1BeginPos__t.html">geo::details::geometry_iterator_types::BeginPos_t</a></div><div class="ttdoc">Structures to distinguish the constructors. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00103">GeometryCore.h:103</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a10af656ae7ff904a02f5f7670ba71c9d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a10af656ae7ff904a02f5f7670ba71c9d">geo::GeometryCore::FindAllVolumePaths</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TGeoNode const * &gt; &gt; FindAllVolumePaths(std::set&lt; std::string &gt; const &amp;vol_names) const </div><div class="ttdoc">Returns paths of all nodes with volumes with the specified names. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00723">GeometryCore.cxx:723</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_abfae2e504dfa44c403614b6cd601f99e"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a></div><div class="ttdeci">finds tracks best matching by angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00064">trackfinderalgorithms.fcl:64</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_af6acf6ab68d0798eb317777a80bcb30e"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#af6acf6ab68d0798eb317777a80bcb30e">geo::CryostatGeo::Boundaries</a></div><div class="ttdeci">geo::BoxBoundedGeo const &amp; Boundaries() const </div><div class="ttdoc">Returns boundaries of the cryostat (in centimetres). </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00115">CryostatGeo.h:115</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a84aba48f49cf9add6cf0641a4527e45b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">geo::GeometryCore::TPC</a></div><div class="ttdeci">TPCGeo const &amp; TPC(unsigned int const tpc=0, unsigned int const cstat=0) const </div><div class="ttdoc">Returns the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02423">GeometryCore.h:2423</a></div></div>
<div class="ttc" id="pmtsimulation__icarus_8fcl_html_a9fc569190f32b40862f18ac3c03a8e49"><div class="ttname"><a href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a></div><div class="ttdeci">temporary value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d36/pmtsimulation__icarus_8fcl_source.html#l00158">pmtsimulation_icarus.fcl:158</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_ab1c75e139655a95f7e66ebca837fd197"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#ab1c75e139655a95f7e66ebca837fd197">geo::CryostatID::InvalidID</a></div><div class="ttdeci">static constexpr CryostatID_t InvalidID</div><div class="ttdoc">Special code for an invalid ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00208">geo_types.h:208</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aaa1e62ce39962969e74548a64de7165d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aaa1e62ce39962969e74548a64de7165d">geo::GeometryCore::NROPs</a></div><div class="ttdeci">unsigned int NROPs(readout::TPCsetID const &amp;tpcsetid) const </div><div class="ttdoc">Returns the total number of ROP in the specified TPC set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01716">GeometryCore.cxx:1716</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a411eea9dd765636914a618ded267558c"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">geo::TPCGeo::Plane</a></div><div class="ttdeci">PlaneGeo const &amp; Plane(geo::View_t view) const </div><div class="ttdoc">Return the plane in the tpc with View_t view. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00263">TPCGeo.cxx:263</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ada0a7c63318565f37beaf5894f8172ea"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ada0a7c63318565f37beaf5894f8172ea">geo::WireID::planeID</a></div><div class="ttdeci">constexpr PlaneID const &amp; planeID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00638">geo_types.h:638</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa830bd0f8c34c670acb8f747331b6a7a"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa830bd0f8c34c670acb8f747331b6a7a">geo::GeometryCore::MaterialName</a></div><div class="ttdeci">std::string MaterialName(TVector3 const &amp;point) const </div><div class="ttdoc">Name of the deepest material containing the point xyz. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01883">GeometryCore.h:1883</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ab46ba9b18652ff3f4bd363309b6470ab"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ab46ba9b18652ff3f4bd363309b6470ab">geo::GeometryCore::ValueInRange</a></div><div class="ttdeci">bool ValueInRange(double value, double min, double max) const </div><div class="ttdoc">Returns whether a value is within the specified range. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01234">GeometryCore.cxx:1234</a></div></div>
<div class="ttc" id="structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t_html_a51739e82dd710eccdfbc1fdcac6a9210"><div class="ttname"><a href="../../d0/d1d/structgeo_1_1ROOTGeoNodeForwardIterator_1_1NodeInfo__t.html#a51739e82dd710eccdfbc1fdcac6a9210">geo::ROOTGeoNodeForwardIterator::NodeInfo_t::self</a></div><div class="ttdeci">Node_t self</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05609">GeometryCore.h:5609</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a17019d019088c33cb6c8ed9e88eb20fc"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a17019d019088c33cb6c8ed9e88eb20fc">geo::GeometryCore::Nviews</a></div><div class="ttdeci">unsigned int Nviews() const </div><div class="ttdoc">Returns the number of views (different wire orientations) </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00307">GeometryCore.cxx:307</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a6d6bf1fbfc01fffd5287c494fa30a694"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a6d6bf1fbfc01fffd5287c494fa30a694">geo::vect::cross</a></div><div class="ttdeci">Vector cross(Vector const &amp;a, Vector const &amp;b)</div><div class="ttdoc">Return cross product of two vectors. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l01190">geo_vectors_utils.h:1190</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="structgeo_1_1CollectPathsByName_html_afd394701c94294645df2fdc0ad377a77"><div class="ttname"><a href="../../df/d87/structgeo_1_1CollectPathsByName.html#afd394701c94294645df2fdc0ad377a77">geo::CollectPathsByName::CollectPathsByName</a></div><div class="ttdeci">CollectPathsByName(std::set&lt; std::string &gt; const &amp;names)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00695">GeometryCore.cxx:695</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a78d197211a0bc69da12962660f192b6d"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a78d197211a0bc69da12962660f192b6d">geo::GeometryCore::TPCsetToTPCs</a></div><div class="ttdeci">std::vector&lt; geo::TPCID &gt; TPCsetToTPCs(readout::TPCsetID const &amp;tpcsetid) const </div><div class="ttdoc">Returns a list of ID of TPCs belonging to the specified TPC set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01706">GeometryCore.cxx:1706</a></div></div>
<div class="ttc" id="PhysicalConstants_8h_html"><div class="ttname"><a href="../../dd/d09/PhysicalConstants_8h.html">PhysicalConstants.h</a></div><div class="ttdoc">Collection of Physical constants used in LArSoft. </div></div>
<div class="ttc" id="classgeo_1_1AuxDetSensitiveGeo_html"><div class="ttname"><a href="../../d5/df8/classgeo_1_1AuxDetSensitiveGeo.html">geo::AuxDetSensitiveGeo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d42/AuxDetSensitiveGeo_8h_source.html#l00034">AuxDetSensitiveGeo.h:34</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_adf00ac2c31c7e7073d68294f1f67db84"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#adf00ac2c31c7e7073d68294f1f67db84">geo::GeometryCore::NearestChannel</a></div><div class="ttdeci">raw::ChannelID_t NearestChannel(geo::Point_t const &amp;worldLoc, geo::PlaneID const &amp;planeid) const </div><div class="ttdoc">Returns the ID of the channel nearest to the specified position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01207">GeometryCore.cxx:1207</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="classgeo_1_1ROOTGeoNodeForwardIterator_html_a81420aaf87572bbbab3a768b31404e4d"><div class="ttname"><a href="../../da/d23/classgeo_1_1ROOTGeoNodeForwardIterator.html#a81420aaf87572bbbab3a768b31404e4d">geo::ROOTGeoNodeForwardIterator::reach_deepest_descendant</a></div><div class="ttdeci">void reach_deepest_descendant()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01969">GeometryCore.cxx:1969</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a9434f534ebf26ef00f38182378df6e8c"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a9434f534ebf26ef00f38182378df6e8c">geo::vect::makePointFromCoords</a></div><div class="ttdeci">GENVECTOR_CONSTEXPR::geo::Point_t makePointFromCoords(Coords &amp;&amp;coords)</div><div class="ttdoc">Creates a geo::Point_t from its coordinates (see makeFromCoords()). </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l01511">geo_vectors_utils.h:1511</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a4bf6f74e66f5f8845141d1eaa3cd1079"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a4bf6f74e66f5f8845141d1eaa3cd1079">geo::GeometryCore::fBuilderParameters</a></div><div class="ttdeci">fhicl::ParameterSet fBuilderParameters</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05521">GeometryCore.h:5521</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_abc0cab4f0fcd826d11aaa8b3dfb2de02"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">geo::BoxBoundedGeo::MinY</a></div><div class="ttdeci">double MinY() const </div><div class="ttdoc">Returns the world y coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00103">BoxBoundedGeo.h:103</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aa408d7049fbe1ea6c7107d778a5ba64f"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aa408d7049fbe1ea6c7107d778a5ba64f">geo::GeometryCore::FindCryostatAtPosition</a></div><div class="ttdeci">geo::CryostatID::CryostatID_t FindCryostatAtPosition(geo::Point_t const &amp;worldLoc) const </div><div class="ttdoc">Returns the index of the cryostat at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00393">GeometryCore.cxx:393</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a3d70fb5369a087d2907cf42e62ea7a23"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a3d70fb5369a087d2907cf42e62ea7a23">geo::GeometryCore::ThirdPlane_dTdW</a></div><div class="ttdeci">double ThirdPlane_dTdW(geo::PlaneID const &amp;pid1, double slope1, geo::PlaneID const &amp;pid2, double slope2, geo::PlaneID const &amp;output_plane) const </div><div class="ttdoc">Returns dT/dW on the third plane, given it in the other two. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01559">GeometryCore.cxx:1559</a></div></div>
<div class="ttc" id="structgeo_1_1details_1_1geometry__iterator__types_1_1UndefinedPos__t_html"><div class="ttname"><a href="../../dc/d78/structgeo_1_1details_1_1geometry__iterator__types_1_1UndefinedPos__t.html">geo::details::geometry_iterator_types::UndefinedPos_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l00105">GeometryCore.h:105</a></div></div>
<div class="ttc" id="structgeo_1_1IntersectionPointAndOffsets_html_a410c1759d6ef4372116b3a3d98cb8197"><div class="ttname"><a href="../../dd/dde/structgeo_1_1IntersectionPointAndOffsets.html#a410c1759d6ef4372116b3a3d98cb8197">geo::IntersectionPointAndOffsets::offset1</a></div><div class="ttdeci">double offset1</div><div class="ttdoc">Distance from reference point of first line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d76/LineClosestPoint_8h_source.html#l00032">LineClosestPoint.h:32</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a4ed940e72b58f91ab8c48aafc4a3a351"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a4ed940e72b58f91ab8c48aafc4a3a351">geo::GeometryCore::OpDetGeoFromOpChannel</a></div><div class="ttdeci">OpDetGeo const &amp; OpDetGeoFromOpChannel(unsigned int OpChannel) const </div><div class="ttdoc">Returns the geo::OpDetGeo object for the given channel number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01824">GeometryCore.cxx:1824</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a949c22136e275ebffa8b8303892b09a9"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a949c22136e275ebffa8b8303892b09a9">geo::GeometryCore::MaxTPCs</a></div><div class="ttdeci">unsigned int MaxTPCs() const </div><div class="ttdoc">Returns the largest number of TPCs a cryostat in the detector has. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00858">GeometryCore.cxx:858</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aeecb542b0ece9b3048b43995342444f8"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aeecb542b0ece9b3048b43995342444f8">geo::GeometryCore::fROOTfile</a></div><div class="ttdeci">std::string fROOTfile</div><div class="ttdoc">path to geometry file for geometry in GeometryCore </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l05514">GeometryCore.h:5514</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ace3bda9b9c99ed27d46824811102c4e2"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ace3bda9b9c99ed27d46824811102c4e2">geo::BoxBoundedGeo::Max</a></div><div class="ttdeci">geo::Point_t Max() const </div><div class="ttdoc">Returns the corner point with the largest coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00136">BoxBoundedGeo.h:136</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_aab3d8d6d617341a99e3500f2071eabbb"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#aab3d8d6d617341a99e3500f2071eabbb">geo::GeometryCore::IsValidOpChannel</a></div><div class="ttdeci">bool IsValidOpChannel(int opChannel) const </div><div class="ttdoc">Is this a valid OpChannel number? </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00290">GeometryCore.cxx:290</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a88a43c6a47349de09d811ce317d0c532"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a88a43c6a47349de09d811ce317d0c532">geo::GeometryCore::VolumeName</a></div><div class="ttdeci">std::string VolumeName(geo::Point_t const &amp;point) const </div><div class="ttdoc">Returns the name of the deepest volume containing specified point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00940">GeometryCore.cxx:940</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a9cdd522690afc36dd560ef9ce78358e0"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a9cdd522690afc36dd560ef9ce78358e0">geo::CryostatGeo::PositionToTPCID</a></div><div class="ttdeci">geo::TPCID PositionToTPCID(geo::Point_t const &amp;point, double wiggle) const </div><div class="ttdoc">Returns the ID of the TPC at specified location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/CryostatGeo_8cxx_source.html#l00138">CryostatGeo.cxx:138</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a622d215597bab1d7664e6e6e6d145679"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a622d215597bab1d7664e6e6e6d145679">geo::BoxBoundedGeo::ContainsPosition</a></div><div class="ttdeci">bool ContainsPosition(geo::Point_t const &amp;point, double wiggle=1.0) const </div><div class="ttdoc">Returns whether this volume contains the specified point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00205">BoxBoundedGeo.h:205</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryBuilderStandard_html"><div class="ttname"><a href="../../d4/d14/classgeo_1_1GeometryBuilderStandard.html">geo::GeometryBuilderStandard</a></div><div class="ttdoc">Extracts of LArSoft geometry information from ROOT. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d63/GeometryBuilderStandard_8h_source.html#l00106">GeometryBuilderStandard.h:106</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1c4a60af9e395182d4ecc267a2362d88"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1c4a60af9e395182d4ecc267a2362d88">geo::GeometryCore::WireAngleToVertical</a></div><div class="ttdeci">double WireAngleToVertical(geo::View_t view, geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the angle of the wires in the specified view from vertical. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00843">GeometryCore.cxx:843</a></div></div>
<div class="ttc" id="test__associatedgroupswithleft__full_8fcl_html_a4814f2598ed6acdb806473d732f33889"><div class="ttname"><a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a></div><div class="ttdeci">physics associatedGroupsWithLeft p1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl_source.html#l00024">test_associatedgroupswithleft_full.fcl:24</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a5636bfd60fe3691d52e9b1fd4a63f9a9"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a5636bfd60fe3691d52e9b1fd4a63f9a9">geo::GeometryCore::CryostatPtr</a></div><div class="ttdeci">CryostatGeo const * CryostatPtr(geo::CryostatID const &amp;cryoid) const </div><div class="ttdoc">Returns the specified cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02046">GeometryCore.h:2046</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7870a9d7c4e0d627c360553737d1f110"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7870a9d7c4e0d627c360553737d1f110">geo::GeometryCore::ChannelsInTPCs</a></div><div class="ttdeci">std::vector&lt; raw::ChannelID_t &gt; ChannelsInTPCs() const </div><div class="ttdoc">Returns an std::vector&amp;lt;ChannelID_t&amp;gt; in all TPCs in a TPCSet. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00221">GeometryCore.cxx:221</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1d78b1f47b011e1f1143c144b602da03"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1d78b1f47b011e1f1143c144b602da03">geo::GeometryCore::HasChannel</a></div><div class="ttdeci">bool HasChannel(raw::ChannelID_t channel) const </div><div class="ttdoc">Returns whether the specified channel exists and is valid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00607">GeometryCore.cxx:607</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html_abbb4a8a4b112ec8e24cc970a40e8b592"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html#abbb4a8a4b112ec8e24cc970a40e8b592">geo::PlaneGeo::WirePitch</a></div><div class="ttdeci">double WirePitch() const </div><div class="ttdoc">Return the wire pitch (in centimeters). It is assumed constant. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00411">PlaneGeo.h:411</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a32c9a5b5da4e8135ed17b5ab8b3dea74"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a32c9a5b5da4e8135ed17b5ab8b3dea74">geo::CryostatGeo::Length</a></div><div class="ttdeci">double Length() const </div><div class="ttdoc">Length of the cryostat [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00107">CryostatGeo.h:107</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a7e7e9c5ab93b25df1e87d99017709996"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a7e7e9c5ab93b25df1e87d99017709996">geo::GeometryCore::NAuxDets</a></div><div class="ttdeci">unsigned int NAuxDets() const </div><div class="ttdoc">Returns the number of auxiliary detectors. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l04549">GeometryCore.h:4549</a></div></div>
<div class="ttc" id="classgeo_1_1ChannelMapAlg_html_ad3bad8326192c816221cb00ab6488344"><div class="ttname"><a href="../../d0/dff/classgeo_1_1ChannelMapAlg.html#ad3bad8326192c816221cb00ab6488344">geo::ChannelMapAlg::Initialize</a></div><div class="ttdeci">virtual void Initialize(GeometryData_t const &amp;geodata)=0</div><div class="ttdoc">Geometry initialisation. </div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html">geo::CryostatID</a></div><div class="ttdoc">The data type to uniquely identify a cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00190">geo_types.h:190</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae407ad5c42b4b4614e7e6986a814f479"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae407ad5c42b4b4614e7e6986a814f479">geo::GeometryCore::GetLArTPCVolumeName</a></div><div class="ttdeci">std::string GetLArTPCVolumeName(geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Return the name of specified LAr TPC volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00740">GeometryCore.cxx:740</a></div></div>
<div class="ttc" id="namespacegeo_html_a4f821d2ed6a4f3007af47503920c8d0c"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a4f821d2ed6a4f3007af47503920c8d0c">geo::WiresIntersectionAndOffsets</a></div><div class="ttdeci">geo::IntersectionPointAndOffsets&lt; geo::Point_t &gt; WiresIntersectionAndOffsets(geo::WireGeo const &amp;wireA, geo::WireGeo const &amp;wireB)</div><div class="ttdoc">Returns the point of wireA that is closest to wireB. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00668">WireGeo.h:668</a></div></div>
<div class="ttc" id="classgeo_1_1CryostatGeo_html_a388995e3d67347e23b5c0116736481c1"><div class="ttname"><a href="../../de/da3/classgeo_1_1CryostatGeo.html#a388995e3d67347e23b5c0116736481c1">geo::CryostatGeo::ID</a></div><div class="ttdeci">geo::CryostatID const &amp; ID() const </div><div class="ttdoc">Returns the identifier of this cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/CryostatGeo_8h_source.html#l00132">CryostatGeo.h:132</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a099ff33eb88a3f01d386163dbf4adb84"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a099ff33eb88a3f01d386163dbf4adb84">geo::GeometryCore::HasTPCset</a></div><div class="ttdeci">bool HasTPCset(readout::TPCsetID const &amp;tpcsetid) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01684">GeometryCore.cxx:1684</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad98ab0388d663b129193c68e831f08f1"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad98ab0388d663b129193c68e831f08f1">geo::GeometryCore::WorldBox</a></div><div class="ttdeci">geo::BoxBoundedGeo WorldBox() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00903">GeometryCore.cxx:903</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
