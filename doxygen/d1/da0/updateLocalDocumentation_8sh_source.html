<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>updateLocalDocumentation.sh Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_04d670c4adcb884258431ddc1ce2763c.html">icaruscode</a></li><li class="navelem"><a class="el" href="../../dir_8494e9adf8c589da363ffe5535955461.html">doc</a></li><li class="navelem"><a class="el" href="../../dir_cc7b6484dc15edf9b2adbd2d357541c1.html">scripts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">updateLocalDocumentation.sh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/da0/updateLocalDocumentation_8sh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#!/usr/bin/env bash</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># Generation of icaruscode Doxygen documentation:</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#  * fetches the latest Doxygen tag files for LArSoft and ROOT</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#    (at most once per day)</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#  * sets up the latest UPS version of `icaruscode` (needed for depedencies)</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#  * checks out the latest tag of `icaruscode` `master` branch</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#  * runs Doxygen (output is expected in the ${OutputDir} directory)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># -----------------------------------------------------</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># Implementation note</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># -----------------------------------------------------</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># This script currently does not support generating documentation from multiple</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># repositories. To implement such support, a possible way is to have the user</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># specify a list of repositories including a main one (say, the first one)</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># which is where the Doxygen configuration file is. Then that configuration file</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># is processed to include as INPUT all the repositories, instead of just one.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># Some additional work is needed to achieve that.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># Changes</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># --------</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># 20200426 (petrillo@slac.stanford.edu) [v1.0]</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#   first version in `icaruscode`; metadata version: 1</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># 20200520 (petrillo@slac.stanford.edu) [v1.1]</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#   using GitHub sources</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># 20201009 (petrillo@slac.stanford.edu) [v1.2]</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#   support additional repositories; metadata version: 2</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># 20210302 (petrillo@slac.stanford.edu) [v1.3]</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#   support for non-`master` release branches (like in `sbnobj`);</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#   in case of tagged target, use the versions from UPS for all repositories</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor"># -- BEGIN -- boilerplate settings and library loading -------------------------</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../d1/da0/updateLocalDocumentation_8sh.html#ac055f5eb40023fec703a6b23dd123a01">   37</a></span>&#160;<span class="preprocessor"></span><a class="code" href="../../d9/dba/publish_8sh.html#ac055f5eb40023fec703a6b23dd123a01">SCRIPTNAME</a>=<span class="stringliteral">&quot;$(basename &quot;</span>$0<span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<a class="code" href="../../d1/d39/testFHiCLfiles__icarus_8sh.html#a41357456068506a5b536a3fa8669a580">SCRIPTDIR</a>=<span class="stringliteral">&quot;$(dirname &quot;</span>$0<span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;declare LibraryToLoad</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordflow">for</span> LibraryToLoad <a class="code" href="../../d2/df7/quiet__Math__Functor__test_8sh.html#adfac98fbd1e85554d2cf0454cdcbc717">in</a> <span class="stringliteral">&#39;settings.sh&#39;</span> <span class="stringliteral">&#39;experiment_settings.sh&#39;</span> <span class="stringliteral">&#39;utilities.sh&#39;</span> ; <span class="keywordflow">do</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a105d60ff52767c8ff2f42edb14ca79a4">source</a> <span class="stringliteral">&quot;${SCRIPTDIR%/}/${LibraryToLoad}&quot;</span> || <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a> $?</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;done</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;unset LibraryToLoad</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor"># -- END -- boilerplate settings and library loading ---------------------------</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"># ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"></span>SCRIPTVERSION=<span class="stringliteral">&quot;1.3&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;declare -ri MetadataVersion=<span class="charliteral">&#39;2&#39;</span> # integral numbers please</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"># ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor"></span><span class="keyword">function</span> <a class="code" href="../../d1/d27/preparseGDML_8cpp.html#aaae643fbdef91be125854f4a5ac75e74">printHelp</a>() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  cat &lt;&lt;EOH</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;Generates <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> documentation of ${<a class="code" href="../../d0/d5e/namespacemanageDataRunDefinitions.html#a2516b4b67da2d2e338b9736939bb605d">ExperimentName</a>}.</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;Usage:  ${<a class="code" href="../../d9/dba/publish_8sh.html#ac055f5eb40023fec703a6b23dd123a01">SCRIPTNAME</a>}  [<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a0a3de24e6979182fb3a5eeee37382f6d">options</a>]</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;Supported <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#a0a3de24e6979182fb3a5eeee37382f6d">options</a>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;--<a class="code" href="../../d0/d5c/ffttest_8sh.html#a4d0e1e8ddf8dbcab8629ba9cd449d615">experiment</a>=EXPERIMENTNAME [autodetect]</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a> of <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> <a class="code" href="../../d0/d5c/ffttest_8sh.html#a4d0e1e8ddf8dbcab8629ba9cd449d615">experiment</a> (<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.g. <span class="stringliteral">&#39;MicroBooNE&#39;</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;--<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a7ed6b5de34b0cf45871c2fd8ada085a2">reponame</a>=REPONAME [autodetect]</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> <a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a> of <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> repository (<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.g. <span class="stringliteral">&#39;uboonecode&#39;</span>)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;--branch=BRANCH , --tag=TAG , --commit=COMMIT</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    use <span class="keyword">this</span> branch, tag or commit instead of branch <span class="stringliteral">&#39;${DefaultBranch}&#39;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> content of <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> repository will be changed</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;--currentbranch , -c</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">do</span> not change <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> branch of <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> GIT repository; <span class="keywordflow">if</span> <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> repository is</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    downloaded, its <span class="keywordflow">default</span> branch is used (<span class="stringliteral">&#39;${DefaultBranch}&#39;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    otherwise, <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> current status is used</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;--clean</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    removes <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> old documentation <span class="keywordflow">if</span> present; by <span class="keywordflow">default</span>, <span class="keyword">this</span> does not happen</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;--force-tags</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    forces <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> update of Doxygen tag files even <span class="keywordflow">if</span> they have been downloaded</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    since <a class="code" href="../../d6/d55/classless.html">less</a> than <a class="code" href="../../d5/d6b/makeNoOverburdenVersionOf_8sh.html#aed8c88c45b85ce77144caff93012211c">one</a> day</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;--<a class="code" href="../../d4/d5d/namespacetriggeredEventList.html#ab29c978583198dfa6be058c898db0939">version</a> , -<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    prints <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a> script version <a class="code" href="../../d9/dd2/selectors_8fcl.html#aadc113fa4af9aeff01481eed2a98e7cc">and</a> exits (hint: it<span class="stringliteral">&#39;s version ${SCRIPTVERSION}</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">--help , -h , -?</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">    prints this usage message and exits</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral">EOH</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">} # printHelp()</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">function printVersion() {</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">  echo &quot;${SCRIPTNAME} version ${SCRIPTVERSION}.&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">} # printVersion()</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral"># ------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">function UpdateTag() {</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">  #</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">  # Downloads the specified tag file and renames it as directed, if older than Age</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">  #</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">  # Usage:  UpdateTag  TagFile URL Description</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">  #</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral">  local -r Age=&#39;</span>yesterday<span class="stringliteral">&#39;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">  local TagFile=&quot;$1&quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">  local URL=&quot;$2&quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">  shift 2</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">  local Description=&quot;$*&quot;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral">  local TempFile=&quot;$(mktemp --dry-run )&quot;</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral">  touch --date=&quot;$Age&quot; &quot;$TempFile&quot;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">  if [[ &quot;$TagFile&quot; -nt &quot;$TempFile&quot; ]] &amp;&amp; isFlagUnset ForceTags ; then</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">    echo &quot;Keeping &#39;</span>${TagFile}<span class="stringliteral">&#39; (run with \`--force-tags\` to override).&quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="stringliteral">  else</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">    echo &quot;Fetching tag file for ${Description} (&#39;</span>${TagFile}<span class="stringliteral">&#39; from &#39;</span>${URL}<span class="stringliteral">&#39;)&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">    wget --output-document &quot;$TagFile&quot; &quot;$URL&quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">    touch &quot;$TagFile&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">  fi</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">  rm &quot;$TempFile&quot;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">} # UpdateTag()</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral">function UpdateROOTtag() {</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral">  local ROOTVersion</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">  ROOTVersion=&quot;$(DetectROOTversion)&quot;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">  LASTFATAL &quot;Can&#39;</span>t detect <a class="code" href="../../d4/d5a/namespaceROOTutils.html#aad4d411c7fe85e8685dc8c640659c6c1">ROOT</a> version!<span class="stringliteral">&quot; # did set up fail?</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">  local ROOTVersionTag=&quot;</span>${ROOTVersion%<span class="comment">/*}&quot;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">  ROOTVersionTag=&quot;${ROOTVersionTag//.}&quot;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">  echo &quot;Fetching Doxygen tag for ROOT version ${ROOTVersion}&quot;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">  UpdateTag &#39;ROOT.tag&#39; &quot;https://root.cern/doc/v${ROOTVersionTag}/ROOT.tag&quot; &quot;ROOT&quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">} # UpdateROOTtag()</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">function UpdateLArSoftTag() {</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">#   local LArSoftVersion=&quot;$(UPSversion &#39;larsoft&#39;)&quot;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">  # Only one documented version: hope you like it</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  UpdateTag &#39;LArSoft.tag&#39; &#39;http://nusoft.fnal.gov/larsoft/doxsvn/html/doxytags-larsoft.xml&#39; &quot;LArSoft&quot;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">} # UpdateLArSoftTag()</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">function PrepareDoxyfile() {</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">  local -r DoxyfileTemplate=&quot;$1&quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  local -r Doxyfile=&quot;$2&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">  # special variables:</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">  ALL_REPO_PATHS=</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  local CodeRepo</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  for CodeRepo in &quot;${CodeRepoNames[@]}&quot; ; do</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">    ALL_REPO_PATHS+=&quot;${ALL_REPO_PATHS:+ }${CodeRepoPaths[$CodeRepo]}&quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  done</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  ReplaceEnvironmentVariables &quot;$DoxyfileTemplate&quot; &quot;$Doxyfile&quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">  unset ALL_REPO_PATHS</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">} # PrepareDoxyfile()</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">function RestoreGITrepository() {</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">  local Path=&quot;$1&quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">  local Commit=&quot;$2&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">  local -i Stashed=&quot;${3:-0}&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">  # restore the status of the repository</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  if [[ -n &quot;$Commit&quot; ]]; then</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">    echo &quot;Restoring the repository (to ${Commit})&quot;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">    git -C &quot;$Path&quot; checkout &quot;$Commit&quot;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">  if [[ -n &quot;$Commit&quot; ]]; then</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    echo &quot;Restoring unstaged content of repository&quot;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    isFlagSet Stashed &amp;&amp; git -C &quot;$Path&quot; stash pop --quiet</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">} # RestoreGITrepository()</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">################################################################################</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">declare -a CodeRepoNames=( )</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">declare -A CodeRepoPaths=( )</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">declare -Ai NewGITclones=( )</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">declare -Ai GITstashedRepos=( )</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">declare -A  GIToldCommits=( )</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">function PrepareRepository() {</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">  # </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  # PrepareRepository CodeRepoName RequestedCodeBranch</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  # </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  local -r CodeRepoName=&quot;$1&quot;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  local -r RequestedCodeBranch=&quot;$2&quot;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  # constraint: it needs to be in the current directory</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  local CodeRepoPath=&quot;$CodeRepoName&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  CodeRepoPaths[$CodeRepoName]=&quot;$CodeRepoPath&quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">  local NewGITclone=0</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  local -i res=0</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  if [[ ! -r &quot;${CodeRepoPath}/.git&quot; ]]; then</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">    local -a GitSources=(</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">      $(GitHubRemoteURL &quot;$CodeRepoName&quot; &quot;$GitHubExperimentGroup&quot; )</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">      $(RedmineGITremoteURL &quot;$CodeRepoName&quot;)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">      )</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">    for GitSource in &quot;${GitSources[@]}&quot; ; do</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">      echo &quot;Attempting to clone the GIT source tree of &#39;${CodeRepoName}&#39; from &#39;${GitSource}&#39;&quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">      git clone &quot;$GitSource&quot; &quot;$CodeRepoName&quot; &gt;&amp;2</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">      res=$?</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">      [[ $res == 0 ]] &amp;&amp; break</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">      echo &quot;  (failed)&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">    done</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">    [[ -r &quot;${CodeRepoPath}/.git&quot; ]] || FATAL 1 &quot;Could not download &#39;${CodeRepoName}&#39; code!&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">    NewGITclone=1</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">  NewGITclones[&quot;$CodeRepoName&quot;]=&quot;$NewGITclone&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">  local -i GITstashed</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">  local GIToldCommit</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">  if [[ &quot;$RequestedCodeBranch&quot; != &#39;HEAD&#39; ]]; then</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    local -r CodeBranch=&quot;${RequestedCodeBranch:-${ReleaseBranches[$CodeRepoName]:-${DefaultBranch}}}&quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    if isFlagUnset NewGITclone ; then</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">      echo &quot;Fetching updates for the existing GIT source tree of &#39;${CodeRepoPath}&#39;&quot;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">      git -C &quot;$CodeRepoPath&quot; fetch</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">    # remove everything that could bother our update;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    # git stash does not tell a script if a stash was created</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    local -i nStashes=&quot;$(cd &quot;$CodeRepoPath&quot; &amp;&amp; git stash list | wc -l)&quot;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    git -C &quot;$CodeRepoPath&quot; stash save --quiet -- &quot;${SCRIPTNAME} temporary for Doxygen generation - $(date)&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">    LASTFATAL &quot;Failed to save local changes in &#39;${CodeRepoPath}&#39;. Giving up.&quot;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    local -i nNewStashes=&quot;$(cd &quot;$CodeRepoPath&quot; &amp;&amp; git stash list | wc -l)&quot;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">    if [[ &quot;$nNewStashes&quot; -gt &quot;$nStashes&quot; ]]; then</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      echo &quot;Changes in GIT repository temporary stashed.&quot;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">      GITstashed+=( &quot;$CodeRepoName&quot; )</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">    # also keep track of where we are</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    GIToldCommit=&quot;$(cd &quot;$CodeRepoPath&quot; &amp;&amp; git reflog -n 1 --format=&#39;format:%H&#39;)&quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">    local OldScriptChecksum=&quot;$(md5sum &lt; &quot;$0&quot;)&quot;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    git -c &#39;advice.detachedHead=false&#39; -C &quot;$CodeRepoPath&quot; checkout &quot;$CodeBranch&quot;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">    local -i res=$?</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    if [[ $res != 0 ]]; then</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">      RestoreGITrepository &quot;$CodeRepoPath&quot; &quot;$GIToldCommit&quot; &quot;$GITstashed&quot;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">      if [[ -n &quot;$RequestedCodeBranch&quot; ]]; then</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">        FATAL &quot;$res&quot; &quot;Failed to check out branch &#39;${CodeBranch}&#39; of GIT repository ${CodeRepoPath}.&quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">      else</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">        echo &quot;Failed to check out branch &#39;${CodeBranch}&#39; of GIT repository ${CodeRepoPath}.&quot;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">      fi</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    if [[ -n &quot;$CodeBranch&quot; ]] &amp;&amp; ! hasGITtag &quot;$CodeBranch&quot; ; then</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">      echo &quot;Updating the GIT branch...&quot;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">      git -C &quot;$CodeRepoPath&quot; rebase</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">      if [[ $res != 0 ]]; then</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">        RestoreGITrepository &quot;$CodeRepoPath&quot; &quot;$GIToldCommit&quot; &quot;$GITstashed&quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">        echo &quot;Failed to update (rebase) branch &#39;${CodeBranch}&#39; of GIT repository ${CodeRepoPath}.&quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">      fi</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    local GITnewCommit=&quot;$(cd &quot;$CodeRepoPath&quot; &amp;&amp; git reflog -n 1 --format=&#39;format:%H&#39;)&quot;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    [[ &quot;$GITnewCommit&quot; == &quot;$GIToldCommit&quot; ]] &amp;&amp; unset GIToldCommit # no change, no need to track</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    local NewScriptChecksum=&quot;$(md5sum &lt; &quot;$0&quot;)&quot;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">    if [[ &quot;$OldScriptChecksum&quot; != &quot;$NewScriptChecksum&quot; ]]; then</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">      FATAL 1 &quot;The attempt to update the repository &#39;${CodeRepoPath}&#39; on the fly caused a change in this script (&#39;${SCRIPTNAME}&#39;). Please update the repository manually and try again.&quot;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">      RestoreGITrepository &quot;$CodeRepoPath&quot; &quot;$GIToldCommit&quot; &quot;$GITstashed&quot;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">  GIToldCommits[&quot;$CodeRepoName&quot;]=&quot;$GIToldCommit&quot;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">  GITstashedRepos[&quot;$CodeRepoName&quot;]=&quot;$GITstashed&quot;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">} # PrepareRepository()</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">function RestoreAllRepositories() {</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  # restore the status of the repositories from stored information</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  local CodeRepoName</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  for CodeRepoName in &quot;${CodeRepoNames[@]}&quot; ; do</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    RestoreGITrepository &quot;${CodeRepoPaths[$CodeRepoName]}&quot; &quot;${GIToldCommits[$CodeRepoName]}&quot; &quot;${GITstashedRepos[$CodeRepoName]:-0}&quot;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  done</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">} # RestoreAllRepositories()</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">function CheckOutSources() {</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">  #</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  # find a Doxygen configuration file</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">  #</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  local -r ExperimentName=&quot;$1&quot;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">  shift</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">  local RepoNames=( &quot;$@&quot; )</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">  local MasterDoxyfile</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  MasterDoxyfile=&quot;$(FindDoxyfile &quot;$ExperimentName&quot;)&quot;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  LASTFATAL &quot;Can&#39;t find a doxygen configuration file for &#39;${ExperimentName}&#39;&quot;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">  [[ -z &quot;${RepoNames[0]}&quot; ]] &amp;&amp; RepoNames[0]=&quot;$(ExperimentCodeProduct &quot;$ExperimentName&quot; )&quot;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">  local ExperimentCodeName=&quot;${RepoNames[0]}&quot;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  # in the future this constraint can be relaxed:</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">  local ExperimentCodeRepoPath=&quot;$ExperimentCodeName&quot;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">  local DateTag=&quot;$(date &#39;+%Y%m%d&#39;)&quot;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">  local DoxygenLog=&quot;${LogDir%/}/$(basename &quot;${MasterDoxyfile%.doxy*}&quot;)-${DateTag}.log&quot;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">  local -r RequestedCodeBranch=&quot;$RequestedExperimentCodeBranch&quot;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  # all the same branch, just because of the simpler interface</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">  local RequestedRepoVersion</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">  for CodeRepoName in &quot;${RepoNames[@]}&quot; ; do</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    RequestedRepoVersion=&quot;$(UPSversion &quot;$CodeRepoName&quot;)&quot;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    [[ $? == 0 ]] || RequestedRepoVersion=&quot;$RequestedCodeBranch&quot;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    echo &quot; === preparing repository &#39;${CodeRepoName}&#39; (${RequestedRepoVersion}) === &quot;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">    PrepareRepository &quot;$CodeRepoName&quot; &quot;$RequestedRepoVersion&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  done</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  echo &quot; === all repositories prepared === &quot;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  local -r ExperimentCodeVersion=&quot;$(cd &quot;$ExperimentCodeRepoPath&quot; &amp;&amp; git describe --abbrev=0)&quot; # use as tag</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">  # special: if no branch was requested in particular, we move to the tagged version of it</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">  if [[ -z &quot;$RequestedCodeBranch&quot; ]]; then</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">    for CodeRepoName in &quot;${RepoNames[@]}&quot; ; do</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">      echo &quot; === Picking tag ${ExperimentCodeVersion} for ${CodeRepoName} ===&quot;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">      local CodeRepoPath=&quot;${CodeRepoPaths[$CodeRepoName]}&quot;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">      git -C &quot;$CodeRepoPath&quot; checkout &quot;$ExperimentCodeVersion&quot; || echo &quot;${CodeRepoName} does not have tag &#39;${ExperimentCodeVersion}&#39;, we&#39;ll use the current branch ($(git -C &quot;$CodeRepoPath&quot; describe)).&quot;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    done</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">    echo &quot; === tag ${ExperimentCodeVersion} selection completed ===&quot;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">  GitDescription=&quot;$(cd &quot;$ExperimentCodeRepoPath&quot; &amp;&amp; git describe 2&gt; /dev/null)&quot;</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">  [[ $? == 0 ]] &amp;&amp; echo &quot;Repository status: ${GitDescription}&quot;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  return 0</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">} # CheckOutSources()</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">################################################################################</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">function RunDoxygen() {</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  #</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  # find a Doxygen configuration file</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  #</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  local -r ExperimentName=&quot;$1&quot;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">  shift</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  local -a AdditionalRepositories=( &quot;$@&quot; )</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  local MasterDoxyfile</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  # search for a Doxyfile in the current directory first</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  MasterDoxyfile=&quot;$(FindDoxyfile &quot;$ExperimentName&quot; &quot;$(pwd)&quot; )&quot;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  LASTFATAL &quot;Can&#39;t find a doxygen configuration file for &#39;${ExperimentName}&#39;&quot;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">  local ExperimentCodeName=&quot;$(ExperimentCodeProduct &quot;$ExperimentName&quot; )&quot;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">  CodeRepoNames=( &quot;$ExperimentCodeName&quot; &quot;${AdditionalRepositories[@]}&quot; )</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">  local DateTag=&quot;$(date &#39;+%Y%m%d&#39;)&quot;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">  local DoxygenLog=&quot;${LogDir%/}/$(basename &quot;${MasterDoxyfile%.doxy*}&quot;)-${DateTag}.log&quot;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  CheckOutSources &quot;$ExperimentName&quot; &quot;${CodeRepoNames[@]}&quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  # in the future this constraint can be relaxed:</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  local ExperimentCodeRepoPath=&quot;${CodeRepoPaths[$ExperimentCodeName]}&quot;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">  local -r ExperimentCodeVersion=&quot;$(cd &quot;$ExperimentCodeRepoPath&quot; &amp;&amp; git describe --abbrev=0)&quot; # use as tag</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  mkdir -p &quot;$LogDir&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">  local -r Doxyfile=&quot;${TMPDIR:-/tmp}/${ExperimentCodeName}-${ExperimentCodeVersion}.doxy&quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">  echo &quot;Creating Doxygen configuration from &#39;${MasterDoxyfile}&#39;...&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  PrepareDoxyfile &quot;$MasterDoxyfile&quot; &quot;$Doxyfile&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">  cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">Now starting Doxygen (log file: &#39;${DoxygenLog}&#39;)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  local ConfiguredOutputDir MetadataFile</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">  ConfiguredOutputDir=&quot;$(ExtractValueFromDoxyfile &#39;HTML_OUTPUT&#39; &quot;$Doxyfile&quot;)&quot;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">  if [[ $? == 0 ]]; then</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">    echo &quot;Directory for HTML output: &#39;${ConfiguredOutputDir}&#39;&quot;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">    MetadataFile=&quot;${ConfiguredOutputDir%/}/${MetadataFileRelPath}&quot;</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">    local OldRunDate OldExperimentCodeName OldVersion</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">    OldRunDate=&quot;$(ExtractFromMetadata &#39;Date&#39; &quot;$MetadataFile&quot;)&quot;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">    OldExperimentCodeName=&quot;$(ExtractFromMetadata &#39;ExperimentCode&#39; &quot;$MetadataFile&quot;)&quot;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">    OldVersion=&quot;$(ExtractFromMetadata &#39;CodeVersion&#39; &quot;$MetadataFile&quot;)&quot;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">    [[ -n &quot;$OldRunDate&quot; ]] &amp;&amp; echo &quot;Existing output created or updated on ${OldRunDate} for ${OldExperimentCodeName} ${OldVersion}.&quot;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  else</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    echo &quot;Could not detect the HTML output directory from &#39;${Doxyfile}&#39;&quot;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">    ConfiguredOutputDir=&#39;&#39; # probably redundant</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  if [[ -n &quot;$ConfiguredOutputDir&quot; ]] &amp;&amp; [[ -d &quot;$ConfiguredOutputDir&quot; ]]; then</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">    if [[ -n &quot;$OldVersion&quot; ]] &amp;&amp; [[ -n &quot;$OldExperimentCodeName&quot; ]] \</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">      &amp;&amp; [[ &quot;$OldVersion&quot; == &quot;$ExperimentCodeVersion&quot; ]] \</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">      &amp;&amp; [[ &quot;$OldExperimentCodeName&quot; == &quot;$ExperimentCodeName&quot; ]] \</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">      &amp;&amp; isFlagUnset CleanOldDocs</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">    then</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">      echo &quot;Existing output not removed as it is from the same version (run with \`--clean\` to override).&quot;</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">    else</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">      echo &quot;Removing old output (&#39;${ConfiguredOutputDir}&#39;)...&quot;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">      rm -rf &quot;$ConfiguredOutputDir&quot;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">    fi</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  local -r DoxygenName=&#39;doxygen&#39;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  local doxygen=&quot;$(which &quot;${DoxygenName[@]}&quot;)&quot;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  local -a Cmd=( $doxygen &quot;$Doxyfile&quot; &quot;&amp;&gt;&quot; &quot;$DoxygenLog&quot; )</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  echo &quot;${Cmd[@]}&quot;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">  eval &quot;${Cmd[@]}&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  local -i ExitCode=$?</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">  if [[ -d &quot;$ConfiguredOutputDir&quot; ]]; then</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">    mv &quot;$Doxyfile&quot; &quot;$ConfiguredOutputDir&quot; &amp;&amp; echo &quot;Doxygen configuration copied into &#39;${ConfiguredOutputDir}&#39;.&quot;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">  # restore the status of the repository</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  RestoreAllRepositories</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  if [[ -d &quot;$ConfiguredOutputDir&quot; ]]; then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    mkdir -p &quot;$(dirname &quot;$MetadataFile&quot;)&quot;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">    cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">Writing metadata into &#39;${MetadataFile}&#39;.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  ### BEGIN metadata version 1:</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">    cat &lt;&lt;EOM &gt; &quot;$MetadataFile&quot;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">MetadataVersion = &#39;${MetadataVersion}&#39;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">Experiment      = &#39;${ExperimentName}&#39;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">Date            = &#39;$(date)&#39;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">Host            = &#39;$(hostname)&#39;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">User            = &#39;$(whoami)&#39;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">Configuration   = &#39;${MasterDoxyfile}&#39;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">ExperimentCode  = &#39;${ExperimentCodeName}&#39;</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">CodeVersion     = &#39;${ExperimentCodeVersion:-&quot;n/a&quot;}&#39;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">GITreference    = &#39;${GitDescription:-&quot;n/a&quot;}&#39;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">WordDirectory   = &#39;$(pwd)&#39;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">CommandLine     = &#39;${Cmd[@]}&#39;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">DoxygenPath     = &#39;${doxygen}&#39;</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">DoxygenVersion  = &#39;$($doxygen --version)&#39;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">LogFile         = &#39;${DoxygenLog}&#39;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">ExitCode        = &#39;${ExitCode}&#39;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">EOM</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  ### END metadata version 1</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">  ### BEGIN metadata version 2:</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">    cat &lt;&lt;EOM &gt;&gt; &quot;$MetadataFile&quot;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">AdditionalRepos = ( ${AdditionalRepositories[@]} )</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">EOM</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">  ### END metadata version 2</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">  cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">${ExperimentCodeVersion:+&quot;This was for ${ExperimentCodeName} ${ExperimentCodeVersion}.&quot;}</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">Doxygen completed its execution.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">  return $ExitCode</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">} # RunDoxygen()</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">################################################################################</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">###  Start here!</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">################################################################################</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"># parameter parsing</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">declare -i NoMoreOptions</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">declare -i DoVersion=0 DoHelp=0</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">declare -i CleanOldDocs=0 ForceTags=0 UpdateBranch=1</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">declare RequestedExperimentCodeBranch</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">declare ExitWithCode</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">declare Param</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">for (( iParam = 1 ; iParam &lt;= $# ; ++iParam )); do</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">  Param=&quot;${!iParam}&quot;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">  if isFlagUnset NoMoreOptions &amp;&amp; [[ &quot;${Param:0:1}&quot; == &#39;-&#39; ]]; then</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">    case &quot;$Param&quot; in</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">      ( &#39;--experiment=&#39;* )         ExperimentName=&quot;${Param#--*=}&quot; ;;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">      ( &#39;--reponame=&#39;* )           ExperimentCodeName=&quot;${Param#--*=}&quot; ;;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">      ( &#39;--branch=&#39;* | &#39;--tag=&#39;* | &#39;--commit=&#39;* )</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">                                   RequestedExperimentCodeBranch=&quot;${Param#--*=}&quot; ;;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">      ( &#39;--currentbranch&#39; | &#39;-c&#39; ) RequestedExperimentCodeBranch=&#39;HEAD&#39; ;;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">      ( &#39;--clean&#39; | &#39;-C&#39; )         CleanOldDocs=1 ;;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">      ( &#39;--force-tags&#39; )           ForceTags=1 ;;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">      ( &#39;--version&#39; | &#39;-V&#39; )       DoVersion=1 ;;</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">      ( &#39;--help&#39; | &#39;-h&#39; | &#39;-?&#39; )   DoHelp=1 ;;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">      ( &#39;-&#39; | &#39;--&#39; )               NoMoreOptions=1 ;;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">      ( * )</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">        ERROR &quot;Unknown option: &#39;${Param}&#39;.&quot;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">        ExitWithCode=1</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">    esac</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">  else</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">    PositionalArguments+=( &quot;$Param&quot; )</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">  fi</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">done</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">if [[ &quot;${#PositionalArguments[@]}&quot; -gt 0 ]]; then</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">  FATAL 1 &quot;Found ${#PositionalArguments[@]} spurious arguments on command line: ${PositionalArguments[@]}.&quot;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">fi</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">: ${ExperimentName:=&quot;$(FindExperiment)&quot;}</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">LASTFATAL &quot;Can&#39;t detect the experiment name.&quot;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">: ${ExperimentCodeName:=&quot;$(ExperimentCodeProduct &quot;$ExperimentName&quot;)&quot;}</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">LASTFATAL &quot;Can&#39;t put together the experiment code repository name for &#39;${ExperimentName}&#39;.&quot;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">if isFlagSet DoVersion ; then</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  printVersion</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  [[ -z &quot;$ExitWithCode&quot; ]] &amp;&amp; ExitWithCode=0</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">fi</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">if isFlagSet DoHelp ; then</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">  printHelp</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  [[ -z &quot;$ExitWithCode&quot; ]] &amp;&amp; ExitWithCode=0</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">fi</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">[[ -n &quot;$ExitWithCode&quot; ]] &amp;&amp; exit &quot;$ExitWithCode&quot;</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">################################################################################</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">declare -i nErrors</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">================================================================================</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">Set up</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">GITrepoName=&quot;$(GITrepositoryName)&quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">[[ $? == 0 ]] &amp;&amp; [[ &quot;$GITrepoName&quot; == &quot;$ExperimentCodeName&quot; ]] &amp;&amp; FATAL 1 &quot;Please do not run this script from within a GIT repository &#39;${ExperimentCodeName}&#39;.&quot;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">ExperimentSetup &quot;$ExperimentName&quot;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">LASTFATAL &quot;Set up not completed, can&#39;t proceed.&quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">================================================================================</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">ROOT tag</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">UpdateROOTtag || let ++nErrors</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">================================================================================</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">LArSoft tag</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">UpdateLArSoftTag || let ++nErrors</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">================================================================================</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">All setup done${nErrors:+&quot; (with ${nErrors})&quot;}</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">[[ -z &quot;$nErrors&quot; ]] || exit 1</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">cat &lt;&lt;EOB</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">================================================================================</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">Now running Doxygen</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">EOB</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">RunDoxygen &quot;$ExperimentName&quot; &quot;${AdditionalRepoNames[@]}&quot;</span></div>
<div class="ttc" id="namespaceROOTutils_html_aad4d411c7fe85e8685dc8c640659c6c1"><div class="ttname"><a href="../../d4/d5a/namespaceROOTutils.html#aad4d411c7fe85e8685dc8c640659c6c1">ROOTutils.ROOT</a></div><div class="ttdeci">tuple ROOT</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da2/icarusalg_2icarusalg_2gallery_2helpers_2python_2ROOTutils_8py_source.html#l00083">icarusalg/icarusalg/gallery/helpers/python/ROOTutils.py:83</a></div></div>
<div class="ttc" id="preparseGDML_8cpp_html_aaae643fbdef91be125854f4a5ac75e74"><div class="ttname"><a href="../../d1/d27/preparseGDML_8cpp.html#aaae643fbdef91be125854f4a5ac75e74">printHelp</a></div><div class="ttdeci">bool printHelp</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d27/preparseGDML_8cpp_source.html#l00431">preparseGDML.cpp:431</a></div></div>
<div class="ttc" id="generate__icarus__geometry__splitwire_8pl_html_accc237606badc0385cb717703091fb61"><div class="ttname"><a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl_source.html#l00430">generate_icarus_geometry_splitwire.pl:430</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a105d60ff52767c8ff2f42edb14ca79a4"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a105d60ff52767c8ff2f42edb14ca79a4">source</a></div><div class="ttdeci">do source</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00032">updateVersionList.sh:32</a></div></div>
<div class="ttc" id="generate__icarus__geometry__splitwire_8pl_html_a09c6b60bb7451f9136e25140ffdff6bd"><div class="ttname"><a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a09c6b60bb7451f9136e25140ffdff6bd">the</a></div><div class="ttdeci">#define the</div></div>
<div class="ttc" id="publish_8sh_html_ac055f5eb40023fec703a6b23dd123a01"><div class="ttname"><a href="../../d9/dba/publish_8sh.html#ac055f5eb40023fec703a6b23dd123a01">SCRIPTNAME</a></div><div class="ttdeci">SCRIPTNAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dba/publish_8sh_source.html#l00021">publish.sh:21</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a7171bc20f34cc335ec48c7f2e2615e6f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a></div><div class="ttdeci">BEGIN_PROLOG V</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="testFHiCLfiles__icarus_8sh_html_a41357456068506a5b536a3fa8669a580"><div class="ttname"><a href="../../d1/d39/testFHiCLfiles__icarus_8sh.html#a41357456068506a5b536a3fa8669a580">SCRIPTDIR</a></div><div class="ttdeci">SCRIPTDIR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/testFHiCLfiles__icarus_8sh_source.html#l00003">testFHiCLfiles_icarus.sh:3</a></div></div>
<div class="ttc" id="namespacemanageDataRunDefinitions_html_a2516b4b67da2d2e338b9736939bb605d"><div class="ttname"><a href="../../d0/d5e/namespacemanageDataRunDefinitions.html#a2516b4b67da2d2e338b9736939bb605d">manageDataRunDefinitions.ExperimentName</a></div><div class="ttdeci">string ExperimentName</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da8/manageDataRunDefinitions_8py_source.html#l00016">manageDataRunDefinitions.py:16</a></div></div>
<div class="ttc" id="namespacetriggeredEventList_html_ab29c978583198dfa6be058c898db0939"><div class="ttname"><a href="../../d4/d5d/namespacetriggeredEventList.html#ab29c978583198dfa6be058c898db0939">triggeredEventList.version</a></div><div class="ttdeci">string version</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dbc/triggeredEventList_8py_source.html#l00333">triggeredEventList.py:333</a></div></div>
<div class="ttc" id="selectors_8fcl_html_aadc113fa4af9aeff01481eed2a98e7cc"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#aadc113fa4af9aeff01481eed2a98e7cc">and</a></div><div class="ttdeci">return match has_match and(match.match_pdg==11 or match.match_pdg==-11)</div></div>
<div class="ttc" id="makeNoOverburdenVersionOf_8sh_html_aed8c88c45b85ce77144caff93012211c"><div class="ttname"><a href="../../d5/d6b/makeNoOverburdenVersionOf_8sh.html#aed8c88c45b85ce77144caff93012211c">one</a></div><div class="ttdeci">then echo Cowardly refusing to create a new FHiCL file with the same name as the original one('${SourceName}').&quot; &gt;&amp;2 exit 1 fi echo &quot;'$</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6b/makeNoOverburdenVersionOf_8sh_source.html#l00065">makeNoOverburdenVersionOf.sh:65</a></div></div>
<div class="ttc" id="quiet__Math__Functor__test_8sh_html_adfac98fbd1e85554d2cf0454cdcbc717"><div class="ttname"><a href="../../d2/df7/quiet__Math__Functor__test_8sh.html#adfac98fbd1e85554d2cf0454cdcbc717">in</a></div><div class="ttdeci">if &amp;&amp;[-z&quot;$BASH_VERSION&quot;] then echo Attempting to switch to bash bash shellSwitch exit fi &amp;&amp;[&quot;$1&quot;= 'shellSwitch'] shift declare a IncludeDirectives for Dir in</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df7/quiet__Math__Functor__test_8sh_source.html#l00023">quiet_Math_Functor_test.sh:23</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_a0a3de24e6979182fb3a5eeee37382f6d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#a0a3de24e6979182fb3a5eeee37382f6d">options</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker options</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00066">find_global_symbol.sh:66</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a19dd16849ed641adb2aff777fdc4bd8b"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div><div class="ttdeci">then echo fcl name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="classless_html"><div class="ttname"><a href="../../d6/d55/classless.html">less</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a7ed6b5de34b0cf45871c2fd8ada085a2"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a7ed6b5de34b0cf45871c2fd8ada085a2">reponame</a></div><div class="ttdeci">reponame</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00254">updateVersionList.sh:254</a></div></div>
<div class="ttc" id="ffttest_8sh_html_a4d0e1e8ddf8dbcab8629ba9cd449d615"><div class="ttname"><a href="../../d0/d5c/ffttest_8sh.html#a4d0e1e8ddf8dbcab8629ba9cd449d615">experiment</a></div><div class="ttdeci">experiment</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/ffttest_8sh_source.html#l00003">ffttest.sh:3</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
