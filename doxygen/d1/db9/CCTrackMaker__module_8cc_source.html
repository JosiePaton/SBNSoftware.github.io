<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>CCTrackMaker_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_e5d091f126962b7bbee30f7df4314892.html">TrackFinder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CCTrackMaker_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/db9/CCTrackMaker__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//  CCTrackMaker</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//  Make tracks using ClusterCrawler clusters and vertex info</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  baller@fnal.gov, October 2014</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  May 2015: Major re-write</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// C++ includes</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// Framework includes</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/Ptr.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// LArSoft includes</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/de9/TPCGeo_8h.html">larcorealg/Geometry/TPCGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">lardata/Utilities/AssociationUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d77/Cluster_8h.html">lardataobj/RecoBase/Cluster.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5c/PFParticle_8h.html">lardataobj/RecoBase/PFParticle.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d34/Seed_8h.html">lardataobj/RecoBase/Seed.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">lardataobj/RecoBase/Track.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d2d/Vertex_8h.html">lardataobj/RecoBase/Vertex.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d60/TrackTrajectoryAlg_8h.html">larreco/RecoAlg/TrackTrajectoryAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d8c/VertexFitAlg_8h.html">larreco/RecoAlg/VertexFitAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../d2/d4d/structCluLen.html">   43</a></span>&#160;<span class="keyword">struct </span>CluLen {</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="../../d2/d4d/structCluLen.html#af2b4b8f0fe8bc09b99b0dbffbdf543d9">   44</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d4d/structCluLen.html#af2b4b8f0fe8bc09b99b0dbffbdf543d9">index</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="../../d2/d4d/structCluLen.html#aeb663404d4e43977d0d71780c784426d">   45</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d2/d4d/structCluLen.html#aeb663404d4e43977d0d71780c784426d">length</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;};</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">   49</a></span>&#160;<a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">greaterThan</a>(CluLen c1, CluLen c2)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">return</span> (c1.length &gt; c2.length);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../d1/db9/CCTrackMaker__module_8cc.html#a3e5cb37db8fe81488c71e2e30f6ea494">   54</a></span>&#160;<a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a3e5cb37db8fe81488c71e2e30f6ea494">lessThan</a>(CluLen c1, CluLen c2)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">return</span> (c1.length &lt; c2.length);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">namespace </span>trkf {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html">   61</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html">CCTrackMaker</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1804f15b502eef3c2fbdcd3494a145b2">CCTrackMaker</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0d8d354996000fa4e1dcfb708eb98ebf">produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae5b26a4f861b7e752c8dead0d0aa5547">   68</a></span>&#160;    std::string <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae5b26a4f861b7e752c8dead0d0aa5547">fHitModuleLabel</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a94a2a3d3bb7d3eb149232898690af34f">   69</a></span>&#160;    std::string <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a94a2a3d3bb7d3eb149232898690af34f">fClusterModuleLabel</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af3f0a4d54ede2a33f192167a0c28ad9f">   70</a></span>&#160;    std::string <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af3f0a4d54ede2a33f192167a0c28ad9f">fVertexModuleLabel</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// services</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">   73</a></span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5738f4a762bb34108c9637a25f788f14">   75</a></span>&#160;    <a class="code" href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html">TrackTrajectoryAlg</a> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5738f4a762bb34108c9637a25f788f14">fTrackTrajectoryAlg</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0140868168e090a8ba650173fd1ec0a1">   76</a></span>&#160;    <a class="code" href="../../de/d1e/classtrkf_1_1VertexFitAlg.html">VertexFitAlg</a> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0140868168e090a8ba650173fd1ec0a1">fVertexFitAlg</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Track matching parameters</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">   79</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae0ecc86e7d9d1ac612b5a2cbeeb16c3a">   80</a></span>&#160;    std::vector&lt;short&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae0ecc86e7d9d1ac612b5a2cbeeb16c3a">fMatchAlgs</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a98c0895c5bdb60954ca366ae3e1f55de">   81</a></span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a98c0895c5bdb60954ca366ae3e1f55de">fXMatchErr</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8e7c944f829bff271e33b9c08050ca0f">   82</a></span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8e7c944f829bff271e33b9c08050ca0f">fAngleMatchErr</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e638e458ab5b35735a41dfb148b115a">   83</a></span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e638e458ab5b35735a41dfb148b115a">fChgAsymFactor</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5b2d5b4abf4e7400ef5b1c20326dd849">   84</a></span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5b2d5b4abf4e7400ef5b1c20326dd849">fMatchMinLen</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa772bfa19b05c2dde8cc74a50b019b44">   85</a></span>&#160;    std::vector&lt;bool&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa772bfa19b05c2dde8cc74a50b019b44">fMakeAlgTracks</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Cluster merging parameters</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a12658c4451147ddb7088831b80b49ff3">   88</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a12658c4451147ddb7088831b80b49ff3">fMaxDAng</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#adbfa9229e9ac20c91d67bf268f137f90">   89</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#adbfa9229e9ac20c91d67bf268f137f90">fChainMaxdX</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0974ec84552eb02740f5e5d44c96f5f1">   90</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0974ec84552eb02740f5e5d44c96f5f1">fChainVtxAng</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af58c2f91c3473bf7892ccf77de8205e7">   91</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af58c2f91c3473bf7892ccf77de8205e7">fMergeChgAsym</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">   92</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">   93</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">fMergeErrorCut</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">   95</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">fChgWindow</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">   96</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// cosmic ray tagging</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">   98</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6a16fd6d099c5b70be16bde37fa89237">   99</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6a16fd6d099c5b70be16bde37fa89237">fDeltaRayCut</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abda96a9914274e8f62d0d48463c05e19">  101</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abda96a9914274e8f62d0d48463c05e19">fMakePFPs</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// vertex fitting</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e00744a4bfb6361b6c4ccc7171460e9">  104</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e00744a4bfb6361b6c4ccc7171460e9">fNVtxTrkHitsFit</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a17a26ed9b1fed0c30aeaabae73b9ce">  105</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a17a26ed9b1fed0c30aeaabae73b9ce">fHitFitErrFac</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// temp</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae9bb4f0e6792d8916c28e8d78bf8803d">  108</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae9bb4f0e6792d8916c28e8d78bf8803d">fuBCode</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// debugging inputs</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6fdebe165f5ff6e4d229597f7ebeff8c">  111</a></span>&#160;    <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6fdebe165f5ff6e4d229597f7ebeff8c">fDebugAlg</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6c39dd3055db6dfc084e8d09a2306007">  112</a></span>&#160;    <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6c39dd3055db6dfc084e8d09a2306007">fDebugPlane</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1e66d2b0768dc475ac70eabb68db66c5">  113</a></span>&#160;    <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1e66d2b0768dc475ac70eabb68db66c5">fDebugCluster</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a09e9af88747093b27d4de745e918a2f4">  114</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a09e9af88747093b27d4de745e918a2f4">fPrintAllClusters</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">  115</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">  117</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">  118</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">  119</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// hit indexing info</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">  122</a></span>&#160;    std::array&lt;unsigned int, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">  123</a></span>&#160;    std::array&lt;unsigned int, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">  124</a></span>&#160;    std::array&lt;unsigned int, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">  125</a></span>&#160;    std::array&lt;unsigned int, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">  126</a></span>&#160;    std::array&lt;std::vector&lt;std::pair&lt;int, int&gt;&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">  128</a></span>&#160;    std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Cluster parameters</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html">  131</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html">clPar</a> {</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">  132</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">Wire</a>;       <span class="comment">// Begin/End Wire</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8fc7c3c2be6182012379aa3d6a65ead0">  133</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8fc7c3c2be6182012379aa3d6a65ead0">X</a>;          <span class="comment">// Begin/End X</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">  134</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">Time</a>;       <span class="comment">// Begin/End Time</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a07afea1ed1eb8424879656d310e43fa3">  135</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a07afea1ed1eb8424879656d310e43fa3">Slope</a>;      <span class="comment">// Begin/End slope</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a68101562612a200b2fa1bcdb0653911e">  136</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a68101562612a200b2fa1bcdb0653911e">Charge</a>;     <span class="comment">// Begin/End charge</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ab76f0d8a09eaa183fc5970d41c86451f">  137</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ab76f0d8a09eaa183fc5970d41c86451f">ChgNear</a>;    <span class="comment">// Charge near the cluster at each end</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a157f27fcc8881e1a4b1c4bd041b4089c">  138</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a157f27fcc8881e1a4b1c4bd041b4089c">Angle</a>;      <span class="comment">// Begin/End angle (radians)</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">  139</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>;        <span class="comment">// Product of end * slope</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8a3e3ffd176057d84fae471dde11b26b">  140</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8a3e3ffd176057d84fae471dde11b26b">VtxIndex</a>;   <span class="comment">// Vertex index</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a77ca74432b71ddb285db07669d280866">  141</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a77ca74432b71ddb285db07669d280866">mVtxIndex</a>;  <span class="comment">// &quot;Maybe&quot; Vertex index</span></div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ac6946175ee0d36410fc75afcb3469718">  142</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ac6946175ee0d36410fc75afcb3469718">BrkIndex</a>;   <span class="comment">// Broken cluster index</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a3ce119073edb914d92954c678f3deadf">  143</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a3ce119073edb914d92954c678f3deadf">MergeError</a>; <span class="comment">// Broken cluster merge error (See MakeClusterChains)</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a1fbb0f4ca065a0aad0681386817c2a11">  144</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a1fbb0f4ca065a0aad0681386817c2a11">EvtIndex</a>;         <span class="comment">// index of the cluster in clusterlist</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a01857bffad3e11abd827506ab7a6c5f0">  145</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a01857bffad3e11abd827506ab7a6c5f0">InTrack</a>;                   <span class="comment">// cluster -&gt; chain index</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a143c524dc2ef6c298f1760df680e600e">  146</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a143c524dc2ef6c298f1760df680e600e">Length</a>;           <span class="comment">// cluster length (wires)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">  147</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">TotChg</a>;                    <span class="comment">// total charge of cluster (or series of clusters)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    };</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// vector of cluster parameters in each plane</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">  150</a></span>&#160;    std::array&lt;std::vector&lt;clPar&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// cluster chain parameters</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html">  153</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html">ClsChainPar</a> {</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a4b457df642eecd0830d977ba84316599">  154</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a4b457df642eecd0830d977ba84316599">Wire</a>;     <span class="comment">// Begin/End Wire</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ac15bef6a5f45f061c2a711172ee235dc">  155</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ac15bef6a5f45f061c2a711172ee235dc">X</a>;        <span class="comment">// Begin/End X</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">  156</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">Time</a>;     <span class="comment">// Begin/End Time</span></div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a2f13d4b106705cd310f0d3b930a2d7f7">  157</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a2f13d4b106705cd310f0d3b930a2d7f7">Slope</a>;    <span class="comment">// Begin/End slope</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a155b7a63501861361bdb7820745e83e0">  158</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a155b7a63501861361bdb7820745e83e0">Angle</a>;    <span class="comment">// Begin/End angle (radians)</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0bcf5f95f4eb20b819fd4c40e20c1944">  159</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0bcf5f95f4eb20b819fd4c40e20c1944">VtxIndex</a>; <span class="comment">// Vertex index</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">  160</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#aa83078b6350f7b1988305812aaa6f5f0">  161</a></span>&#160;      std::array&lt;float, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#aa83078b6350f7b1988305812aaa6f5f0">ChgNear</a>;   <span class="comment">// Charge near the cluster at each end</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0f5bb9cf2d88c85762c75afbc9f75f8e">  162</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0f5bb9cf2d88c85762c75afbc9f75f8e">mBrkIndex</a>; <span class="comment">// a &quot;Maybe&quot; cluster index</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1a8bfc0061395f621f4ff0cff3323f69">  163</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1a8bfc0061395f621f4ff0cff3323f69">Length</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a58a243a4e46d6291fe7e3328b20168ab">  164</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a58a243a4e46d6291fe7e3328b20168ab">TotChg</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a7cf8ca8322df6247139d1643533787c2">  165</a></span>&#160;      std::vector&lt;unsigned short&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a7cf8ca8322df6247139d1643533787c2">ClsIndex</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ab69958f862959f1dfcb0d629cb091332">  166</a></span>&#160;      std::vector&lt;unsigned short&gt; <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ab69958f862959f1dfcb0d629cb091332">Order</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a06df1eaea4bf8e9c2a1e1b0d1c6dfc92">  167</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a06df1eaea4bf8e9c2a1e1b0d1c6dfc92">InTrack</a>; <span class="comment">// cluster -&gt; track ID (-1 if none, 0 if under construction)</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    };</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// vector of cluster parameters in each plane</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">  170</a></span>&#160;    std::array&lt;std::vector&lt;ClsChainPar&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// 3D Vertex info</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html">  173</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html">vtxPar</a> {</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6287f1bde8598db375947c2500f1482e">  174</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6287f1bde8598db375947c2500f1482e">ID</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a0d4f4265ba38db1e8ab25fc261d58b2b">  175</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a0d4f4265ba38db1e8ab25fc261d58b2b">EvtIndex</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a5022f76b3609ba44a14dd11c90b33db1">  176</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a5022f76b3609ba44a14dd11c90b33db1">X</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#abc782fcc584ff5f5a708551ca1d83a9f">  177</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#abc782fcc584ff5f5a708551ca1d83a9f">Y</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a713c6fd0d7f879b75364ae74452926e2">  178</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a713c6fd0d7f879b75364ae74452926e2">Z</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">  179</a></span>&#160;      std::array&lt;unsigned short, 3&gt; <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">nClusInPln</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a490a5e14c08c31648b1a9585466ca262">  180</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a490a5e14c08c31648b1a9585466ca262">Neutrino</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    };</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">  183</a></span>&#160;    std::vector&lt;vtxPar&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// cluster indices assigned to one vertex. Filled in VtxMatch</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">  186</a></span>&#160;    std::array&lt;std::vector&lt;unsigned short&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html">  188</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html">TrkPar</a> {</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">  189</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab4d7787a1e421a81b727e6f4056faebf">  190</a></span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab4d7787a1e421a81b727e6f4056faebf">Proc</a>; <span class="comment">// 1 = VtxMatch, 2 = ...</span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aebe2830d85d2b1581c31e6697132eafa">  191</a></span>&#160;      std::array&lt;std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt;, 3&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aebe2830d85d2b1581c31e6697132eafa">TrkHits</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">  192</a></span>&#160;      std::vector&lt;TVector3&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">  193</a></span>&#160;      std::vector&lt;TVector3&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">TrjDir</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">  194</a></span>&#160;      std::array&lt;short, 2&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#abc9afd6b7a8014d2de8ac0d986307263">  195</a></span>&#160;      std::vector&lt;unsigned short&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#abc9afd6b7a8014d2de8ac0d986307263">ClsEvtIndices</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9aa4f53cbea782d96b6662649767840d">  196</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9aa4f53cbea782d96b6662649767840d">Length</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#af83e4c639152365ce22daa1d25b62fbf">  197</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#af83e4c639152365ce22daa1d25b62fbf">ChgOrder</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9da01ab7b2263c5a16e7a1d38d2bccfb">  198</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9da01ab7b2263c5a16e7a1d38d2bccfb">MomID</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a97a5768f20127c4f890cb30a7a470bdc">  199</a></span>&#160;      std::array&lt;bool, 2&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a97a5768f20127c4f890cb30a7a470bdc">EndInTPC</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a2ef68d231425986b38283d1ebfcff17c">  200</a></span>&#160;      std::array&lt;bool, 2&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a2ef68d231425986b38283d1ebfcff17c">GoodEnd</a>; <span class="comment">// set true if there are hits in all planes at the end point</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ae7bda8938446e323445305f98fab16d3">  201</a></span>&#160;      std::vector&lt;short&gt; <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ae7bda8938446e323445305f98fab16d3">DtrID</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aa75ff1595fb39f88de29c6180e7a825b">  202</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aa75ff1595fb39f88de29c6180e7a825b">PDGCode</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    };</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">  204</a></span>&#160;    std::vector&lt;TrkPar&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Array of pointers to hits in each plane for one track</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">  207</a></span>&#160;    std::array&lt;std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// and for one seed</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">  209</a></span>&#160;    std::array&lt;std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt;, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">seedHits</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// relative charge normalization between planes</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">  211</a></span>&#160;    std::array&lt;float, 3&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// Vector of PFParticle -&gt; track IDs. The first element will be</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// track ID = 0 indicating that this is a neutrino PFParticle and</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// there is no associated track</span></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">  216</a></span>&#160;    std::vector&lt;unsigned short&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// characterize the match between clusters in 2 or 3 planes</span></div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">  219</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a> {</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">  220</a></span>&#160;      std::array&lt;short, 3&gt; <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">  221</a></span>&#160;      std::array&lt;unsigned short, 3&gt; <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">  222</a></span>&#160;      std::array&lt;float, 3&gt; <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">  223</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">  224</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a>; <span class="comment">// wire difference at the matching end</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">  225</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a>; <span class="comment">// angle difference at the matching end</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">  226</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a>;   <span class="comment">// X difference</span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">  227</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a>;  <span class="comment">// Wire,Angle,Time match error</span></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">  228</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">  229</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a>; <span class="comment">// wire difference at the other end</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">  230</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a>; <span class="comment">// angle difference at the other end</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">  231</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a>;   <span class="comment">// time difference at the other end</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a48f733e21cab737693b10ab9e8a3ed5c">  232</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a48f733e21cab737693b10ab9e8a3ed5c">dSP</a>;   <span class="comment">// space point difference</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">  233</a></span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;  <span class="comment">// dAngle dX match error</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    };</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// vector of many match combinations</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">  236</a></span>&#160;    std::vector&lt;MatchPars&gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e">PrintClusters</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8f03643d850fed7e515244ff8d6458bb">PrintTracks</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abf07295700c807597ffb1bf4539cf791">MakeClusterChains</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                           art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a63dbb25ee655bd43ecd28e4cdfbb2b0a">dXClTraj</a>(art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl1,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> end1,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl2);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abba75f158c3a57344767f9698b6f2f3f">FillChgNear</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a3e0d8f0b9f648f8c7a89dd6b7bdea4">FillWireHitRange</a>();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Find clusters that point to vertices but do not have a</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// cluster-vertex association made by ClusterCrawler</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a2cbb2074f639e7b3ccb53dbd3a70fffa">FindMaybeVertices</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// match clusters associated with vertices</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99ffb710bc88a0a7aa7147626bea83f7">VtxMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                  art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// match clusters in all planes</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3d62a62b9729d7a4cd907be927d50a8">PlnMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                  art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// match clusters in all planes</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8603f50b82c749bf5ab503810e0585fc">AngMatch</a>(art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Make the track/vertex and mother/daughter relationships</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a28cca29de67791215899db8137b1497a">MakeFamily</a>();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac82fed743ea63e9f51ff83c81d17f568">TagCosmics</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a05c70b2fb733caf14f6b0ce9b01cc942">FitVertices</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// fill the end matching parameters in the MatchPars struct</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// 2D version</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0">FillEndMatch2</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">ChargeAsym</a>(std::array&lt;float, 3&gt;&amp; mChg);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a736b18c295ea86036959988c0dd424a2">FindMissingCluster</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kpl,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                            <span class="keywordtype">short</span>&amp; kcl,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&amp; kend,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                            <span class="keywordtype">float</span> kWir,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                            <span class="keywordtype">float</span> <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                            <span class="keywordtype">float</span> okWir,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                            <span class="keywordtype">float</span> okX);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">SortMatches</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                     art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> procCode);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// fill the trkHits array using information.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7d7b262985eae63fd20bb60e62ec0c6c">FillTrkHits</a>(art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> imat);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// Seed hits for the seed - hit association</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//    void FindSeedHits(unsigned short itk, unsigned short&amp; end);</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// store the track in the trk vector</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99535ecabdec87327124f7a0ff59aa2d">StoreTrack</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> imat,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> procCode);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// returns the charge along the line between (wire1, time1) and (wire2, time2)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a895813e21607e106d28cded8af22177c">ChargeNear</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire1,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                     <span class="keywordtype">float</span> time1,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire2,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                     <span class="keywordtype">float</span> time2);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// inflate cuts at large angle</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">AngleFactor</a>(<span class="keywordtype">float</span> slope);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }; <span class="comment">// class CCTrackMaker</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1804f15b502eef3c2fbdcd3494a145b2">  316</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1804f15b502eef3c2fbdcd3494a145b2">CCTrackMaker::CCTrackMaker</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset) : EDProducer{pset}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    fHitModuleLabel = pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;HitModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    fClusterModuleLabel = pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;ClusterModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    fVertexModuleLabel = pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;VertexModuleLabel&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// track matching</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    fMatchAlgs = pset.get&lt;std::vector&lt;short&gt;&gt;(<span class="stringliteral">&quot;MatchAlgs&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    fXMatchErr = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;XMatchErr&quot;</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    fAngleMatchErr = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;AngleMatchErr&quot;</span>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    fChgAsymFactor = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;ChgAsymFactor&quot;</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    fMatchMinLen = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;MatchMinLen&quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    fMakeAlgTracks = pset.get&lt;std::vector&lt;bool&gt;&gt;(<span class="stringliteral">&quot;MakeAlgTracks&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Cluster merging</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    fMaxDAng = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;MaxDAng&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    fChainMaxdX = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ChainMaxdX&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    fChainVtxAng = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ChainVtxAng&quot;</span>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    fMergeChgAsym = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;MergeChgAsym&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Cosmic ray tagging</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    fFiducialCut = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;FiducialCut&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    fDeltaRayCut = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;DeltaRayCut&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// make PFParticles</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    fMakePFPs = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;MakePFPs&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// vertex fitting</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    fNVtxTrkHitsFit = pset.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;NVtxTrkHitsFit&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    fHitFitErrFac = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;HitFitErrFac&quot;</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// uB code</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    fuBCode = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;uBCode&quot;</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// debugging inputs</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    fDebugAlg = pset.get&lt;<span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;DebugAlg&quot;</span>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    fDebugPlane = pset.get&lt;<span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;DebugPlane&quot;</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    fDebugCluster = pset.get&lt;<span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;DebugCluster&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    fPrintAllClusters = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;PrintAllClusters&quot;</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Consistency check</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (fMatchAlgs.size() &gt; fXMatchErr.size() || fMatchAlgs.size() &gt; fAngleMatchErr.size() ||</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        fMatchAlgs.size() &gt; fChgAsymFactor.size() || fMatchAlgs.size() &gt; fMatchMinLen.size() ||</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        fMatchAlgs.size() &gt; fMakeAlgTracks.size()) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Incompatible fcl input vector sizes&quot;</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Reality check</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; fMatchAlgs.size(); ++ii) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">if</span> (fAngleMatchErr[ii] &lt;= 0 || fXMatchErr[ii] &lt;= 0) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Invalid matching parameters &quot;</span> &lt;&lt; fAngleMatchErr[ii] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                             &lt;&lt; fXMatchErr[ii];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    produces&lt;std::vector&lt;recob::PFParticle&gt;&gt;();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    produces&lt;art::Assns&lt;recob::PFParticle, recob::Track&gt;&gt;();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    produces&lt;art::Assns&lt;recob::PFParticle, recob::Cluster&gt;&gt;();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    produces&lt;art::Assns&lt;recob::PFParticle, recob::Seed&gt;&gt;();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    produces&lt;art::Assns&lt;recob::PFParticle, recob::Vertex&gt;&gt;();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    produces&lt;std::vector&lt;recob::Vertex&gt;&gt;();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    produces&lt;std::vector&lt;recob::Track&gt;&gt;();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    produces&lt;art::Assns&lt;recob::Track, recob::Hit&gt;&gt;();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    produces&lt;std::vector&lt;recob::Seed&gt;&gt;();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">//------------------------------------------------------------------------------------//</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0d8d354996000fa4e1dcfb708eb98ebf">  378</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0d8d354996000fa4e1dcfb708eb98ebf">CCTrackMaker::produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WirePitch();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">fChgWindow</a> = 40; <span class="comment">// window (ticks) for identifying shower-like clusters</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">auto</span> tcol = std::make_unique&lt;std::vector&lt;recob::Track&gt;&gt;();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">auto</span> thassn = std::make_unique&lt;art::Assns&lt;recob::Track, recob::Hit&gt;&gt;();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keyword">auto</span> vcol = std::make_unique&lt;std::vector&lt;recob::Vertex&gt;&gt;();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">auto</span> pcol = std::make_unique&lt;std::vector&lt;recob::PFParticle&gt;&gt;();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">auto</span> ptassn = std::make_unique&lt;art::Assns&lt;recob::PFParticle, recob::Track&gt;&gt;();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">auto</span> pcassn = std::make_unique&lt;art::Assns&lt;recob::PFParticle, recob::Cluster&gt;&gt;();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">auto</span> psassn = std::make_unique&lt;art::Assns&lt;recob::PFParticle, recob::Seed&gt;&gt;();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">auto</span> pvassn = std::make_unique&lt;art::Assns&lt;recob::PFParticle, recob::Vertex&gt;&gt;();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// seed collection</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">auto</span> scol = std::make_unique&lt;std::vector&lt;recob::Seed&gt;&gt;();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">auto</span> shassn = std::make_unique&lt;art::Assns&lt;recob::Seed, recob::Hit&gt;&gt;();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// all hits</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    art::Handle&lt;std::vector&lt;recob::Hit&gt;&gt; allhitsListHandle;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// cluster list</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    art::Handle&lt;std::vector&lt;recob::Cluster&gt;&gt; clusterListHandle;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Cluster&gt;&gt; clusterlist;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// ClusterCrawler Vertices</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    art::Handle&lt;std::vector&lt;recob::Vertex&gt;&gt; VtxListHandle;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Vertex&gt;&gt; vtxlist;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// get Hits</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.clear();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (evt.getByLabel(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae5b26a4f861b7e752c8dead0d0aa5547">fHitModuleLabel</a>, allhitsListHandle))</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      art::fill_ptr_vector(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>, allhitsListHandle);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// get Clusters</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (evt.getByLabel(fClusterModuleLabel, clusterListHandle))</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      art::fill_ptr_vector(clusterlist, clusterListHandle);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (clusterlist.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// get cluster - hit associations</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    art::FindManyP&lt;recob::Hit&gt; fmCluHits(clusterListHandle, evt, fClusterModuleLabel);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// get Vertices</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (evt.getByLabel(fVertexModuleLabel, VtxListHandle))</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      art::fill_ptr_vector(vtxlist, VtxListHandle);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    art::FindManyP&lt;recob::Cluster, unsigned short&gt; fmVtxCls(VtxListHandle, evt, fVertexModuleLabel);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    std::vector&lt;CluLen&gt; clulens;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl, icl, <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, itr, tID, tIndex;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// maximum error (see MakeClusterChains) for considering clusters broken</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a> = 30;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Cut on the error for a definitely broken cluster. Clusters with fMergeErrorCut &lt; MergeError &lt; fMaxMergeError</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// are possibly broken clusters but we will consider these when matching between planes</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">fMergeErrorCut</a> = 10;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; tmpHits;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Cluster&gt;&gt; tmpCls;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Vertex&gt;&gt; tmpVtx;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// vector for PFParticle constructor</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    std::vector&lt;size_t&gt; dtrIndices;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// some vectors for recob::Seed</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">double</span> sPos[3], sDir[3];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">double</span> sErr[3] = {0, 0, 0};</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a> =</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      art::ServiceHandle&lt;detinfo::DetectorPropertiesService const&gt;()-&gt;DataFor(evt);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// check consistency between clusters and associated hits</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; clusterhits;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; clusterlist.size(); ++icl) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      ipl = clusterlist[icl]-&gt;Plane().Plane;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      clusterhits = fmCluHits.at(icl);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span> (clusterhits[0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire != std::nearbyint(clusterlist[icl]-&gt;EndWire())) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;CCTM Cluster-Hit End wire mis-match &quot;</span> &lt;&lt; clusterhits[0]-&gt;WireID().Wire</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; std::nearbyint(clusterlist[icl]-&gt;EndWire()) &lt;&lt; <span class="stringliteral">&quot; Bail out! \n&quot;</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iht = 0; iht &lt; clusterhits.size(); ++iht) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (clusterhits[iht]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Plane != ipl) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;CCTM Cluster-Hit plane mis-match &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    &lt;&lt; clusterhits[iht]-&gt;WireID().Plane &lt;&lt; <span class="stringliteral">&quot; on hit &quot;</span> &lt;&lt; iht &lt;&lt; <span class="stringliteral">&quot; Bail out! \n&quot;</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        } <span class="comment">// hit-cluster plane mis-match</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      }   <span class="comment">// iht</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }     <span class="comment">// icl</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// end check consistency</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.clear();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.clear();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a> = 0; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a> &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;Ncryostats(); ++<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a> = 0; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a> &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;Cryostat(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>).NTPC(); ++<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;Cryostat(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>).TPC(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>).Nplanes();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a> &gt; 3) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].clear();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].clear();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].clear();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        } <span class="comment">// ipl</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// FillWireHitRange also calculates the charge in each plane</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a3e0d8f0b9f648f8c7a89dd6b7bdea4">FillWireHitRange</a>();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          clulens.clear();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          <span class="comment">// sort clusters by increasing End wire number</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;          <span class="keywordflow">for</span> (icl = 0; icl &lt; clusterlist.size(); ++icl) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">if</span> (clusterlist[icl]-&gt;<a class="code" href="../../d0/da2/namespacetrkf.html#a41d627d46d1a30e41d4f191ff6acebd8">Plane</a>().Cryostat != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (clusterlist[icl]-&gt;<a class="code" href="../../d0/da2/namespacetrkf.html#a41d627d46d1a30e41d4f191ff6acebd8">Plane</a>().TPC != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">if</span> (clusterlist[icl]-&gt;<a class="code" href="../../d0/da2/namespacetrkf.html#a41d627d46d1a30e41d4f191ff6acebd8">Plane</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html#a3825c529ac0384711be08bb5fbbbffce">Plane</a> != ipl) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            CluLen clulen;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            clulen.index = icl;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            clulen.length = clusterlist[icl]-&gt;EndWire();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            clulens.push_back(clulen);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;          <span class="keywordflow">if</span> (clulens.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          <span class="comment">// sort clusters</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          std::sort(clulens.begin(), clulens.end(), <a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a3e5cb37db8fe81488c71e2e30f6ea494">lessThan</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordflow">if</span> (clulens.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; clulens.size(); ++ii) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = clulens[ii].index;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html">clPar</a> clstr;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a1fbb0f4ca065a0aad0681386817c2a11">EvtIndex</a> = icl;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <a class="code" href="../../d9/dda/classrecob_1_1Cluster.html">recob::Cluster</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#afac1ac7b61385644c993fbb774a1922f">cluster</a> = *(clusterlist[icl]);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="comment">// Begin info -&gt; end index 1 (DS)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">Wire</a>[1] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a720fcbb170bdf5dcd37417940d0fa517">StartWire</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">Time</a>[1] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a923d3f02afc879d4f8434d0f1823b0ef">StartTick</a>();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8fc7c3c2be6182012379aa3d6a65ead0">X</a>[1] = (float)<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.ConvertTicksToX(cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a923d3f02afc879d4f8434d0f1823b0ef">StartTick</a>(), ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a157f27fcc8881e1a4b1c4bd041b4089c">Angle</a>[1] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a744b6c09de1d5834791eaa1622ac23c7">StartAngle</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a07afea1ed1eb8424879656d310e43fa3">Slope</a>[1] = std::tan(cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a744b6c09de1d5834791eaa1622ac23c7">StartAngle</a>());</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[1] = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a68101562612a200b2fa1bcdb0653911e">Charge</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] * cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a7395cbe51bad410d585cb800c3547959">StartCharge</a>();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="comment">// this will be filled later</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ab76f0d8a09eaa183fc5970d41c86451f">ChgNear</a>[1] = 0;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8a3e3ffd176057d84fae471dde11b26b">VtxIndex</a>[1] = -1;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a77ca74432b71ddb285db07669d280866">mVtxIndex</a>[1] = -1;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ac6946175ee0d36410fc75afcb3469718">BrkIndex</a>[1] = -1;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a3ce119073edb914d92954c678f3deadf">MergeError</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="comment">// End info -&gt; end index 0 (US)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">Wire</a>[0] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a1ec61aecd2a723775612f42f151b04bb">EndWire</a>();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">Time</a>[0] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a708d4248caba70bed28171bc9adcbb0b">EndTick</a>();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8fc7c3c2be6182012379aa3d6a65ead0">X</a>[0] = (float)<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.ConvertTicksToX(cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a708d4248caba70bed28171bc9adcbb0b">EndTick</a>(), ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a157f27fcc8881e1a4b1c4bd041b4089c">Angle</a>[0] = cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a337e7622b80e3d2236cdfd1181ee050c">EndAngle</a>();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a07afea1ed1eb8424879656d310e43fa3">Slope</a>[0] = std::tan(cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a337e7622b80e3d2236cdfd1181ee050c">EndAngle</a>());</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[0] = 0;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">Time</a>[1] &gt; clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">Time</a>[0]) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[0] = 1;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;              clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[1] = -1;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[0] = -1;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;              clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">Dir</a>[1] = 1;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a68101562612a200b2fa1bcdb0653911e">Charge</a>[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] * cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#aaad7058f36e1959faf207e50d9415367">EndCharge</a>();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="comment">// this will be filled later</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ab76f0d8a09eaa183fc5970d41c86451f">ChgNear</a>[1] = 0;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8a3e3ffd176057d84fae471dde11b26b">VtxIndex</a>[0] = -1;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a77ca74432b71ddb285db07669d280866">mVtxIndex</a>[0] = -1;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ac6946175ee0d36410fc75afcb3469718">BrkIndex</a>[0] = -1;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a3ce119073edb914d92954c678f3deadf">MergeError</a>[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="comment">// other info</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a01857bffad3e11abd827506ab7a6c5f0">InTrack</a> = -1;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a143c524dc2ef6c298f1760df680e600e">Length</a> = (<span class="keywordtype">unsigned</span> short)(0.5 + clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">Wire</a>[1] - clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">Wire</a>[0]);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">TotChg</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] * cluster.<a class="code" href="../../d9/dda/classrecob_1_1Cluster.html#a92fe518dd038696d3e3ae0aa4b3ef3ba">Integral</a>();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">if</span> (clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">TotChg</a> &lt;= 0) clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">TotChg</a> = 1;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            clusterhits = fmCluHits.at(icl);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">if</span> (clusterhits.size() == 0) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;              mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;No associated cluster hits &quot;</span> &lt;&lt; icl;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">// correct charge for missing cluster hits</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">TotChg</a> *= clstr.<a class="code" href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a143c524dc2ef6c298f1760df680e600e">Length</a> / (float)clusterhits.size();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].push_back(clstr);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          } <span class="comment">// ii (icl)</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abba75f158c3a57344767f9698b6f2f3f">FillChgNear</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="comment">// and finally the vertices</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; vtxlist.size(); ++ivx) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          <a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html">vtxPar</a> aVtx;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6287f1bde8598db375947c2500f1482e">ID</a> = ivx + 1;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a0d4f4265ba38db1e8ab25fc261d58b2b">EvtIndex</a> = ivx;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          vtxlist[ivx]-&gt;XYZ(xyz);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a5022f76b3609ba44a14dd11c90b33db1">X</a> = xyz[0];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#abc782fcc584ff5f5a708551ca1d83a9f">Y</a> = xyz[1];</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a713c6fd0d7f879b75364ae74452926e2">Z</a> = xyz[2];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">nClusInPln</a>[0] = 0;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">nClusInPln</a>[1] = 0;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">nClusInPln</a>[2] = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          std::vector&lt;art::Ptr&lt;recob::Cluster&gt;&gt; <span class="keyword">const</span>&amp; vtxCls = fmVtxCls.at(ivx);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          std::vector&lt;const unsigned short*&gt; <span class="keyword">const</span>&amp; vtxClsEnd = fmVtxCls.data(ivx);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> vcass = 0; vcass &lt; vtxCls.size(); ++vcass) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            icl = vtxCls[vcass].key();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">// the cluster plane</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            ipl = vtxCls[vcass]-&gt;Plane().Plane;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            end = *vtxClsEnd[vcass];</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">if</span> (end &gt; 1)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;              <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Invalid end data from vertex - cluster association&quot;</span> &lt;&lt; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordtype">bool</span> gotit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// CCTM end is opposite of CC end</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            end = 1 - <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jcl = 0; jcl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++jcl) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].EvtIndex == icl) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = ivx;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                ++aVtx.<a class="code" href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">nClusInPln</a>[ipl];</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                gotit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;              } <span class="comment">// index check</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            }   <span class="comment">// jcl</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="keywordflow">if</span> (!gotit)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;              <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad index from vertex - cluster association&quot;</span> &lt;&lt; icl;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          } <span class="comment">// icl</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.push_back(aVtx);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        } <span class="comment">// ivx</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">// Find broken clusters</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abf07295700c807597ffb1bf4539cf791">MakeClusterChains</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, fmCluHits);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a2cbb2074f639e7b3ccb53dbd3a70fffa">FindMaybeVertices</a>();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">// call algorithms in the specified order</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.clear();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a> = 0; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a> &lt; fMatchAlgs.size(); ++<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keywordflow">if</span> (fMatchAlgs[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] == 1) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a> = (fDebugAlg == 1);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99ffb710bc88a0a7aa7147626bea83f7">VtxMatch</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, fmCluHits);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordflow">if</span> (fMakeAlgTracks[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>]) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">SortMatches</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, fmCluHits, 1);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fMatchAlgs[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] == 2) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a> = (fDebugAlg == 2);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3d62a62b9729d7a4cd907be927d50a8">PlnMatch</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, fmCluHits);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keywordflow">if</span> (fMakeAlgTracks[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>]) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">SortMatches</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, fmCluHits, 2);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e">PrintClusters</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        } <span class="comment">// algIndex</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.clear();</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">// Determine the vertex/track hierarchy</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> (fMakePFPs) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac82fed743ea63e9f51ff83c81d17f568">TagCosmics</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a28cca29de67791215899db8137b1497a">MakeFamily</a>();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a05c70b2fb733caf14f6b0ce9b01cc942">FitVertices</a>(<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// Make PFParticles -&gt; tracks</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipf = 0; ipf &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.size(); ++ipf) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <span class="comment">// trackID of this PFP</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          tID = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>[ipf];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="keywordflow">if</span> (tID &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size() + 1) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            mf::LogWarning(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad track ID&quot;</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          dtrIndices.clear();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="comment">// load the daughter PFP indices</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;PFParticle &quot;</span> &lt;&lt; ipf &lt;&lt; <span class="stringliteral">&quot; tID &quot;</span> &lt;&lt; tID;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jpf = 0; jpf &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.size(); ++jpf) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            itr = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>[jpf] - 1; <span class="comment">// convert from track ID to track index</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].MomID == tID) dtrIndices.push_back(jpf);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].MomID == tID)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dtr jpf &quot;</span> &lt;&lt; jpf &lt;&lt; <span class="stringliteral">&quot; itr &quot;</span> &lt;&lt; itr;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;          } <span class="comment">// jpf</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> parentIndex = USHRT_MAX;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="keywordflow">if</span> (tID == 0) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">// make neutrino PFP USHRT_MAX == primary PFP</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="../../dc/d21/classrecob_1_1PFParticle.html">recob::PFParticle</a> pfp(14, ipf, parentIndex, dtrIndices);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            pcol-&gt;emplace_back(std::move(pfp));</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Neutrino) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="comment">// make the vertex</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;              xyz[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;              xyz[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              xyz[2] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;              <span class="keywordtype">size_t</span> vStart = vcol-&gt;size();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;              <a class="code" href="../../d5/d52/classrecob_1_1Vertex.html">recob::Vertex</a> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>(xyz, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].ID);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;              vcol-&gt;emplace_back(std::move(vertex));</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;              <span class="keywordtype">size_t</span> vEnd = vcol-&gt;size();</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;              <span class="comment">// PFParticle - vertex association</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;              <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *pcol, *vcol, *pvassn, vStart, vEnd);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].ID = -<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].ID;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            } <span class="comment">// ivx</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tID &gt; 0) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="comment">// make non-neutrino PFP. Need to find the parent PFP index</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="comment">// Track index of this PFP</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            tIndex = tID - 1;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="comment">// trackID of this PFP parent</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.size(); ++ii) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>[ii] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].MomID) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                parentIndex = ii;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;              }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            } <span class="comment">// ii</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="comment">// PFParticle</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;daughters tID &quot;</span> &lt;&lt; tID &lt;&lt; <span class="stringliteral">&quot; pdg &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].PDGCode &lt;&lt; <span class="stringliteral">&quot; ipf &quot;</span> &lt;&lt; ipf</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; parentIndex &quot;</span> &lt;&lt; parentIndex &lt;&lt; <span class="stringliteral">&quot; dtr size &quot;</span> &lt;&lt; dtrIndices.size();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <a class="code" href="../../dc/d21/classrecob_1_1PFParticle.html">recob::PFParticle</a> pfp(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].PDGCode, ipf, parentIndex, dtrIndices);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            pcol-&gt;emplace_back(std::move(pfp));</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="comment">// track</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">// make the track</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordtype">size_t</span> tStart = tcol-&gt;size();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a> <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>(</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;              <a class="code" href="../../de/de5/classrecob_1_1TrackTrajectory.html">recob::TrackTrajectory</a>(<a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a2253bf96e69f939f133551c86bdd2e37">recob::tracking::convertCollToPoint</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrjPos),</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                     <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a159ae849126aae38dcc0675e448c0727">recob::tracking::convertCollToVector</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrjDir),</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                     <a class="code" href="../../d9/dca/classrecob_1_1Track.html#a79f1b57342d70962685e749753d76ad1">recob::Track::Flags_t</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.size()),</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                     <span class="keyword">false</span>),</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;              0,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;              -1.,</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;              0,</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;              <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a>(),</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;              <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a>(),</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;              tID);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            tcol-&gt;emplace_back(std::move(<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>));</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordtype">size_t</span> tEnd = tcol-&gt;size();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="comment">// PFParticle - track association</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *pcol, *tcol, *ptassn, tStart, tEnd);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="comment">// flag this track as already put in the event</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].ID = -<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].ID;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">// track -&gt; hits association</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            tmpHits.clear();</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;              tmpHits.insert(</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                tmpHits.end(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrkHits[ipl].begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrkHits[ipl].end());</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *tcol, tmpHits, *thassn);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="comment">// Find seed hits and the end of the track that is best</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            end = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="comment">//            FindSeedHits(tIndex, end);</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj = 0;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">if</span> (end &gt; 0) itj = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrjPos.size() - 1;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; 3; ++ii) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;              sPos[ii] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrjPos[itj](ii);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              sDir[ii] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].TrjDir[itj](ii);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            } <span class="comment">// ii</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordtype">size_t</span> sStart = scol-&gt;size();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a> <a class="code" href="../../d5/d56/NeutronOsc__module_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a>(sPos, sDir, sErr, sErr);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            scol-&gt;emplace_back(std::move(seed));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordtype">size_t</span> sEnd = scol-&gt;size();</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="comment">// PFP-seed association</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *pcol, *scol, *psassn, sStart, sEnd);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="comment">// Seed-hit association</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            tmpHits.clear();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;              tmpHits.insert(tmpHits.end(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">seedHits</a>[ipl].begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">seedHits</a>[ipl].end());</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *scol, tmpHits, *shassn);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="comment">// cluster association</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="comment">// PFP-cluster association</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            tmpCls.clear();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].ClsEvtIndices.size(); ++ii) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;              icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[tIndex].ClsEvtIndices[ii];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;              tmpCls.push_back(clusterlist[icl]);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            } <span class="comment">// ii</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *pcol, tmpCls, *pcassn);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          } <span class="comment">// non-neutrino PFP</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }   <span class="comment">// ipf</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="comment">// make non-PFP tracks</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itr = 0; itr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itr) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          <span class="comment">// ignore already saved tracks</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a> <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>(</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <a class="code" href="../../de/de5/classrecob_1_1TrackTrajectory.html">recob::TrackTrajectory</a>(<a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a2253bf96e69f939f133551c86bdd2e37">recob::tracking::convertCollToPoint</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos),</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                   <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#a159ae849126aae38dcc0675e448c0727">recob::tracking::convertCollToVector</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjDir),</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                   <a class="code" href="../../d9/dca/classrecob_1_1Track.html#a79f1b57342d70962685e749753d76ad1">recob::Track::Flags_t</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.size()),</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                   <span class="keyword">false</span>),</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            0,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            -1.,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            0,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a>(),</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a>(),</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          tcol-&gt;emplace_back(std::move(<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>));</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          tmpHits.clear();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            tmpHits.insert(</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              tmpHits.end(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrkHits[ipl].begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrkHits[ipl].end());</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <a class="code" href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a>(evt, *tcol, tmpHits, *thassn);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        } <span class="comment">// itr</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment">// make remnant vertices</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          xyz[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          xyz[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          xyz[2] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <a class="code" href="../../d5/d52/classrecob_1_1Vertex.html">recob::Vertex</a> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>(xyz, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].ID);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          vcol-&gt;emplace_back(std::move(vertex));</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">if</span> (fDebugAlg &gt; 0) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8f03643d850fed7e515244ff8d6458bb">PrintTracks</a>();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordtype">double</span> orphanLen = 0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &gt; 40 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].InTrack &lt; 0) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;              orphanLen += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Length;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;              <span class="comment">// unused cluster</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Orphan long cluster &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Wire[0]</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Time[0] &lt;&lt; <span class="stringliteral">&quot; length &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          } <span class="comment">// icl</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].clear();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].clear();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        } <span class="comment">// ipl</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Total orphan length &quot;</span> &lt;&lt; orphanLen &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].clear();</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">seedHits</a>[ipl].clear();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].clear();</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      } <span class="comment">// tpc</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }   <span class="comment">// cstat</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    evt.put(std::move(pcol));</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    evt.put(std::move(ptassn));</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    evt.put(std::move(pcassn));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    evt.put(std::move(pvassn));</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    evt.put(std::move(psassn));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    evt.put(std::move(tcol));</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    evt.put(std::move(thassn));</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    evt.put(std::move(scol));</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    evt.put(std::move(vcol));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// final cleanup</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.clear();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.clear();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.clear();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.clear();</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.clear();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  } <span class="comment">// produce</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a05c70b2fb733caf14f6b0ce9b01cc942">  809</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a05c70b2fb733caf14f6b0ce9b01cc942">CCTrackMaker::FitVertices</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    std::vector&lt;std::vector&lt;geo::WireID&gt;&gt; hitWID;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    std::vector&lt;std::vector&lt;double&gt;&gt; hitX;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    std::vector&lt;std::vector&lt;double&gt;&gt; hitXErr;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    TVector3 pos, posErr;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    std::vector&lt;TVector3&gt; trkDir;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    std::vector&lt;TVector3&gt; trkDirErr;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordtype">float</span> ChiDOF;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (fNVtxTrkHitsFit == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx, indx2, iht, nHitsFit;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Neutrino) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      hitWID.clear();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      hitX.clear();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      hitXErr.clear();</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      trkDir.clear();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// find the tracks associated with this vertex</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> thePln, theTPC, theCst;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itk = 0; itk &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itk) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] != ivx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj = 0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> == 1) itj = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos.size() - 1;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          <span class="comment">// increase the size of the hit vectors by 1 for this track</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          indx = hitX.size();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          hitWID.resize(indx + 1);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          hitX.resize(indx + 1);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          hitXErr.resize(indx + 1);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          trkDir.resize(indx + 1);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          trkDir[indx] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjDir[itj];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &lt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="comment">// make slots for the hits on this track in this plane</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            nHitsFit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl].size();</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span> (nHitsFit &gt; fNVtxTrkHitsFit) nHitsFit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e00744a4bfb6361b6c4ccc7171460e9">fNVtxTrkHitsFit</a>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            indx2 = hitWID[indx].size();</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            hitWID[indx].resize(indx2 + nHitsFit);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            hitX[indx].resize(indx2 + nHitsFit);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            hitXErr[indx].resize(indx2 + nHitsFit);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; nHitsFit; ++ii) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> == 0) { iht = ii; }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                iht = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl].size() - ii - 1;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;              }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;              hitWID[indx][indx2 + ii] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;WireID();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;              thePln = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;WireID().Plane;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              theTPC = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;WireID().TPC;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              theCst = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;WireID().Cryostat;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;              hitX[indx][indx2 + ii] = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;PeakTime(), thePln, theTPC, theCst);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;              hitXErr[indx][indx2 + ii] = fHitFitErrFac * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrkHits[ipl][iht]-&gt;RMS();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            } <span class="comment">// ii</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        }     <span class="comment">// end</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }       <span class="comment">// itk</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">if</span> (hitX.size() &lt; 2) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Not enough hits to fit vtx &quot;</span> &lt;&lt; ivx;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      } <span class="comment">// hitX.size() &lt; 2</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      pos(0) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      pos(1) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      pos(2) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0140868168e090a8ba650173fd1ec0a1">fVertexFitAlg</a>.<a class="code" href="../../de/d1e/classtrkf_1_1VertexFitAlg.html#a8ada40cd1cc04ded40b8784b37b4c2d5">VertexFit</a>(hitWID, hitX, hitXErr, pos, posErr, trkDir, trkDirErr, ChiDOF);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">if</span> (ChiDOF &gt; 3000) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">// update the vertex position</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X = pos(0);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y = pos(1);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z = pos(2);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="comment">// and the track trajectory</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> fitTrk = 0;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itk = 0; itk &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itk) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] != ivx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj = 0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> == 1) itj = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos.size() - 1;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjDir[itj] = trkDir[fitTrk];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          ++fitTrk;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      }   <span class="comment">// itk</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }     <span class="comment">// ivx</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  }       <span class="comment">// FitVertices</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00897"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abba75f158c3a57344767f9698b6f2f3f">  897</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abba75f158c3a57344767f9698b6f2f3f">CCTrackMaker::FillChgNear</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// fills the CHgNear array</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire, nwires, indx;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>, ctime, cx, chgWinLo, chgWinHi;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordtype">float</span> cnear;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="comment">// find the nearby charge at the US and DS ends</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        nwires = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Length / 2;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> (nwires &lt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">// maximum of 30 wires for long clusters</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">if</span> (nwires &gt; 30) nwires = 30;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          cnear = 0;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="comment">// direction for adding/subtracting wire numbers</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          dir = 1 - 2 * <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = 0; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> &lt; nwires; ++<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            wire = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] + dir * <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            cx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].X[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] + dir * w * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Slope[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            ctime = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(cx, ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            chgWinLo = ctime - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">fChgWindow</a>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            chgWinHi = ctime + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">fChgWindow</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            indx = wire - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl];</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firhit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].first;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lashit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].second;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = firhit; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt; lashit; ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size() - 1) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;FillChgNear bad lashit &quot;</span> &lt;&lt; lashit &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;              }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;PeakTime() &lt; chgWinLo) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;PeakTime() &gt; chgWinHi) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              cnear += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;Integral();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            } <span class="comment">// hit</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          }   <span class="comment">// w</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          cnear /= (float)(nwires - 1);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="keywordflow">if</span> (cnear &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Charge[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>]) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].ChgNear[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] * cnear / <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Charge[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].ChgNear[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = 0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      }   <span class="comment">// icl</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }     <span class="comment">// ipl</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  } <span class="comment">// FillChgNear</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a28cca29de67791215899db8137b1497a">  952</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a28cca29de67791215899db8137b1497a">CCTrackMaker::MakeFamily</a>()</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// define the track/vertex and mother/daughter relationships</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx, itr, ipl, ii, jtr;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nus, nds, nuhs, ndhs;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordtype">float</span> longUSTrk, longDSTrk, <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#ae8d1069d1d4353f940d950bdbfa0466e">qual</a>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// min distance^2 between a neutrino vertex candidate and a through</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// going muon</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">float</span> tgMuonCut2 = 9;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// struct for neutrino vertex candidates</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keyword">struct </span>NuVtx {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> VtxIndex;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nUSTk;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDSTk;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nUSHit;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDSHit;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordtype">float</span> longUSTrk;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordtype">float</span> longDSTrk;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordtype">float</span> Qual;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    };</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    std::vector&lt;NuVtx&gt; nuVtxCand;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    NuVtx aNuVtx;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">// analyze all of the vertices</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordtype">float</span> best = 999, dx, dy, dz, dr;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordtype">short</span> imbest = -1;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordtype">bool</span> skipVtx;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">for</span> (ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Neutrino = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      nus = 0;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      nds = 0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      nuhs = 0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      ndhs = 0;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      longUSTrk = 0;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      longDSTrk = 0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      skipVtx = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="comment">// skip vertices that are close to through-going muons</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <span class="keywordflow">for</span> (itr = 0; itr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itr) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].PDGCode != 13) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">for</span> (itj = 0; itj &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.size(); ++itj) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;          dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](0) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          dy = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](1) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;          dz = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](2) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          dr = dx * dx + dy * dy + dz * dz;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          <span class="keywordflow">if</span> (dr &lt; tgMuonCut2) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            skipVtx = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <span class="keywordflow">if</span> (skipVtx) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        } <span class="comment">// itj</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">if</span> (skipVtx) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      } <span class="comment">// itr</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">if</span> (skipVtx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">for</span> (itr = 0; itr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itr) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[0] == ivx) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="comment">// DS-going track</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          ++nds;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &gt; longDSTrk) longDSTrk = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].Length;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            ndhs += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrkHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="comment">//  std::cout&lt;&lt;&quot;MakeFamily: ivx &quot;&lt;&lt;ivx&lt;&lt;&quot; DS itr &quot;&lt;&lt;trk[itr].ID&lt;&lt;&quot; len &quot;&lt;&lt;trk[itr].Length&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        } <span class="comment">// DS-going track</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="comment">// Reject this vertex as a neutrino candidate if the track being</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="comment">// considered has a starting vertex</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1] == ivx &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[0] &gt;= 0) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          skipVtx = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        } <span class="comment">// trk[itr].VtxIndex[0] &gt; 0</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1] == ivx &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[0] &lt; 0) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          <span class="comment">// US-going track w no US vertex</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          ++nus;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &gt; longUSTrk) longUSTrk = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].Length;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            nuhs += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrkHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="comment">//  std::cout&lt;&lt;&quot;MakeFamily: ivx &quot;&lt;&lt;ivx&lt;&lt;&quot; US itr &quot;&lt;&lt;trk[itr].ID&lt;&lt;&quot; len &quot;&lt;&lt;trk[itr].Length&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        } <span class="comment">// US-going track</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      }   <span class="comment">// itr</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">if</span> (skipVtx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (nds == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      qual = 1 / (float)nds;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      qual /= (float)ndhs;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">if</span> (nus &gt; 0) qual *= (float)nuhs / (<span class="keywordtype">float</span>)ndhs;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">if</span> (qual &lt; best) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        best = <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#ae8d1069d1d4353f940d950bdbfa0466e">qual</a>;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        imbest = ivx;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="keywordflow">if</span> (nds &gt; 0 &amp;&amp; longDSTrk &gt; 5) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">// at least one longish track going DS</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        aNuVtx.VtxIndex = ivx;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        aNuVtx.nUSTk = nus;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        aNuVtx.nDSTk = nds;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        aNuVtx.nUSHit = nuhs;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        aNuVtx.nDSHit = ndhs;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        aNuVtx.longUSTrk = longUSTrk;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        aNuVtx.longDSTrk = longDSTrk;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        aNuVtx.Qual = <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#ae8d1069d1d4353f940d950bdbfa0466e">qual</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        nuVtxCand.push_back(aNuVtx);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">    mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;&quot;Neutrino vtx candidates&quot;;</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">    for(unsigned short ican = 0; ican &lt; nuVtxCand.size(); ++ican)</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">       mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;&quot;Can &quot;&lt;&lt;ican&lt;&lt;&quot; vtx &quot;&lt;&lt;nuVtxCand[ican].VtxIndex&lt;&lt;&quot; nUSTk &quot;&lt;&lt;nuVtxCand[ican].nUSTk</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">        &lt;&lt;&quot; nUSHit &quot;&lt;&lt;nuVtxCand[ican].nUSHit&lt;&lt;&quot; longUS &quot;&lt;&lt;nuVtxCand[ican].longUSTrk&lt;&lt;&quot; nDSTk &quot;&lt;&lt;nuVtxCand[ican].nDSTk</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">        &lt;&lt;&quot; nDSHit &quot;&lt;&lt;nuVtxCand[ican].nDSHit&lt;&lt;&quot; longDS &quot;&lt;&lt;nuVtxCand[ican].longDSTrk&lt;&lt;&quot; Qual &quot;&lt;&lt;nuVtxCand[ican].Qual;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span> (imbest &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// Found the neutrino interaction vertex</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    ivx = imbest;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Neutrino = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// Put a 0 into the PFParticle -&gt; track vector to identify a neutrino</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// track with no trajectory or hits</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(0);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// list of DS-going current generation daughters so we can fix next</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">// generation daughter assignments. This code section assumes that there</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">// are no decays or 2ndry interactions with US-going primary tracks.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    std::vector&lt;unsigned short&gt; dtrGen;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    std::vector&lt;unsigned short&gt; dtrNextGen;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">for</span> (itr = 0; itr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itr) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[0] == ivx) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="comment">// DS-going primary track</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].MomID = 0;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="comment">// call every track coming from a neutrino vertex a proton</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].PDGCode = 2212;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        dtrGen.push_back(itr);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      } <span class="comment">// DS-going primary track</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1] == ivx) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// US-going primary track</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].MomID = 0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="comment">// call every track coming from a neutrino vertex a proton</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].PDGCode = 2212;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="comment">// reverse the track trajectory</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        std::reverse(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.end());</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjDir.size(); ++ii)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjDir[ii] = -<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjDir[ii];</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      } <span class="comment">// DS-going primary track</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }   <span class="comment">// itr</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (dtrGen.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tmp, indx;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nit = 0;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// follow daughters through all generations (&lt; 10). Daughter tracks</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">// may go US or DS</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">while</span> (nit &lt; 10) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      ++nit;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      dtrNextGen.clear();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="comment">// Look for next generation daughters</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; dtrGen.size(); ++ii) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        itr = dtrGen[ii];</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1] &gt;= 0) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          <span class="comment">// found a DS vertex</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          ivx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1];</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;          <span class="comment">// look for a track associated with this vertex</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          <span class="keywordflow">for</span> (jtr = 0; jtr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++jtr) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="keywordflow">if</span> (jtr == itr) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[0] == ivx) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              <span class="comment">// DS-going track</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;              indx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID.size();</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID.resize(indx + 1);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID[indx] = jtr;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;              <span class="comment">//              std::cout&lt;&lt;&quot;itr &quot;&lt;&lt;itr&lt;&lt;&quot; dtr &quot;&lt;&lt;jtr&lt;&lt;&quot; DtrID size &quot;&lt;&lt;trk[itr].DtrID.size()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].MomID = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;              <span class="comment">// call all daughters pions</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].PDGCode = 211;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;              dtrNextGen.push_back(jtr);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].ID);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            } <span class="comment">// DS-going track</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[1] == ivx) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              <span class="comment">// US-going track</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;              indx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID.size();</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID.resize(indx + 1);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].DtrID[indx] = jtr;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;              <span class="comment">//              std::cout&lt;&lt;&quot;itr &quot;&lt;&lt;itr&lt;&lt;&quot; dtr &quot;&lt;&lt;jtr&lt;&lt;&quot; DtrID size &quot;&lt;&lt;trk[itr].DtrID.size()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].MomID = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;              <span class="comment">// call all daughters pions</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].PDGCode = 211;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;              dtrNextGen.push_back(jtr);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].ID);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;              <span class="comment">// reverse the track trajectory</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;              std::reverse(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].TrjPos.begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].TrjPos.end());</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = 0; jj &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].TrjDir.size(); ++jj)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].TrjDir[jj] = -<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].TrjDir[jj];</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;              <span class="comment">// interchange the trk - vtx assignments</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              tmp = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[0];</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[1];</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[jtr].VtxIndex[1] = tmp;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            } <span class="comment">// DS-going track</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;          }   <span class="comment">// jtr</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        }     <span class="comment">// trk[itr].VtxIndex[0] &gt;= 0</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      }       <span class="comment">// ii (itr)</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="comment">// break out if no next gen daughters found</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">if</span> (dtrNextGen.size() == 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      dtrGen = dtrNextGen;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    } <span class="comment">// nit</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  } <span class="comment">// MakeFamily</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac82fed743ea63e9f51ff83c81d17f568"> 1165</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac82fed743ea63e9f51ff83c81d17f568">CCTrackMaker::TagCosmics</a>()</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">// Make cosmic ray PFParticles</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipf, itj;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordtype">bool</span> skipit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="comment">// Y,Z limits of the detector</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordtype">double</span> world[3] = {0., 0., 0.};</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; thetpc = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;TPC(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    thetpc.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(local, world);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">float</span> XLo = world[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetHalfWidth(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">float</span> XHi = world[0] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetHalfWidth(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordtype">float</span> YLo = world[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetHalfHeight(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordtype">float</span> YHi = world[1] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetHalfHeight(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">float</span> ZLo = world[2] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetLength(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) / 2 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordtype">float</span> ZHi = world[2] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetLength(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) / 2 - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">fFiducialCut</a>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordtype">bool</span> startsIn, endsIn;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itk = 0; itk &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itk) {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="comment">// ignore already used tracks</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="comment">// ignore short tracks (&lt; 10 cm)</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="comment">// check for already identified PFPs</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      skipit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">for</span> (ipf = 0; ipf &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.size(); ++ipf) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>[ipf] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].ID) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          skipit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      } <span class="comment">// ipf</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">if</span> (skipit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      startsIn = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](0) &lt; XLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](0) &gt; XHi) startsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](1) &lt; YLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](1) &gt; YHi) startsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](2) &lt; ZLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[0](2) &gt; ZHi) startsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;Trk &quot;&lt;&lt;trk[itk].ID&lt;&lt;&quot; X0 &quot;&lt;&lt;(int)trk[itk].TrjPos[0](0)&lt;&lt;&quot; Y0 &quot;&lt;&lt;(int)trk[itk].TrjPos[0](1)&lt;&lt;&quot; Z0 &quot;&lt;&lt;(int)trk[itk].TrjPos[0](2)&lt;&lt;&quot; startsIn &quot;&lt;&lt;startsIn&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (startsIn) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      endsIn = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      itj = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos.size() - 1;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](0) &lt; XLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](0) &gt; XHi) endsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](1) &lt; YLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](1) &gt; YHi) endsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](2) &lt; ZLo || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].TrjPos[itj](2) &gt; ZHi) endsIn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;     X1 &quot;&lt;&lt;(int)trk[itk].TrjPos[itj](0)&lt;&lt;&quot; Y1 &quot;&lt;&lt;(int)trk[itk].TrjPos[itj](1)&lt;&lt;&quot; Z1 &quot;&lt;&lt;(int)trk[itk].TrjPos[itj](2)&lt;&lt;&quot; endsIn &quot;&lt;&lt;endsIn&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">if</span> (endsIn) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="comment">// call it a cosmic muon</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].PDGCode = 13;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">pfpToTrkID</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].ID);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    } <span class="comment">// itk</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span> (fDeltaRayCut &lt;= 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itk = 0; itk &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itk) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="comment">// find a tagged cosmic ray</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itk].PDGCode != 13) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    } <span class="comment">// itk</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  } <span class="comment">// TagCosmics</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99ffb710bc88a0a7aa7147626bea83f7"> 1230</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99ffb710bc88a0a7aa7147626bea83f7">CCTrackMaker::VtxMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                         art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">// Use vertex assignments to match clusters</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx, ii, ipl, icl, jj, jpl, jcl, kk, kpl, kcl;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordtype">short</span> idir, iend, jdir, jend, kdir, kend, ioend;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">for</span> (ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="comment">// list of cluster chains associated with this vertex in each plane</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].clear();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;          <span class="keywordflow">for</span> (iend = 0; iend &lt; 2; ++iend) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].push_back(icl);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          } <span class="comment">// end</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        }   <span class="comment">// icl</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      }     <span class="comment">// ipl</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;VtxMatch: Vertex ID &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot;ipl &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; cls&quot;</span>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].size(); ++ii)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl][ii];</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        } <span class="comment">// ipl</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      }   <span class="comment">// prt</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">// match between planes, requiring clusters matched to this vertex</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      iend = 0;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      jend = 0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordtype">bool</span> gotkcl;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keywordtype">float</span> totErr;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">if</span> (nplanes == 2 &amp;&amp; ipl &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].size(); ++ii) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl][ii];</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <span class="comment">// ignore used clusters</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          jpl = (ipl + 1) % nplanes;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;          kpl = (jpl + 1) % nplanes;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          <span class="keywordflow">for</span> (jj = 0; jj &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[jpl].size(); ++jj) {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            jcl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[jpl][jj];</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <span class="keywordflow">for</span> (iend = 0; iend &lt; 2; ++iend) {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend] != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;              ioend = 1 - iend;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;              idir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Dir[iend];</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;              <span class="keywordflow">for</span> (jend = 0; jend &lt; 2; ++jend) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].VtxIndex[jend] != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                jdir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Dir[jend];</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                <span class="keywordflow">if</span> (idir != 0 &amp;&amp; jdir != 0 &amp;&amp; idir != jdir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                <span class="comment">// ignore outrageously bad other end X matches</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[1 - jend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[ioend]) &gt; 50)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a> match;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] = icl;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl] = iend;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[jpl] = jcl;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[jpl] = jend;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = ivx;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = -1;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="comment">// set large so that DupMatch doesn&#39;t get confused when called before FillEndMatch</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 1E6;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = 1E6;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                <span class="keywordflow">if</span> (nplanes == 2) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0">FillEndMatch2</a>(detProp, match);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;FillEndMatch2: Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &lt;&lt; <span class="stringliteral">&quot; oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                  <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &gt; 100) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = -1;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = 0;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                  mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;VtxMatch: check &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iend &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; jpl</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jcl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jend &lt;&lt; <span class="stringliteral">&quot; for cluster in kpl &quot;</span> &lt;&lt; kpl;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                gotkcl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                <span class="keywordflow">for</span> (kk = 0; kk &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[kpl].size(); ++kk) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                  kcl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[kpl][kk];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                  <span class="keywordflow">for</span> (kend = 0; kend &lt; 2; ++kend) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                    kdir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Dir[kend];</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    <span class="keywordflow">if</span> (idir != 0 &amp;&amp; kdir != 0 &amp;&amp; idir != kdir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].VtxIndex[kend] != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                    <span class="comment">// rough check of other end match</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                    <span class="comment">// TODO: SHOWER-LIKE CLUSTER CHECK</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = kcl;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = kend;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                    <span class="comment">// first call to ignore redundant matches</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    <span class="comment">// ignore if no signal at the other end</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                    <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &gt; 100) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    <span class="comment">// second call to keep matches with better error</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                    gotkcl = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    <span class="comment">//                    break;</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                  } <span class="comment">// kend</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                }   <span class="comment">// kk -&gt; kcl</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                <span class="keywordflow">if</span> (gotkcl) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <span class="comment">// look for a cluster that missed the vertex assignment</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                <span class="keywordtype">float</span> best = 10;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                <span class="keywordtype">short</span> kbst = -1;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kbend = 0;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                  mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxMatch: look for missed cluster chain in kpl&quot;</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                <span class="keywordflow">for</span> (kcl = 0; kcl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl].size(); ++kcl) {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                  <span class="keywordflow">for</span> (kend = 0; kend &lt; 2; ++kend) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    kdir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Dir[kend];</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    <span class="keywordflow">if</span> (idir != 0 &amp;&amp; kdir != 0 &amp;&amp; idir != kdir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].VtxIndex[kend] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    <span class="comment">// make a rough dX cut at the match end</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[kend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>) &gt; 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    <span class="comment">// and at the other end</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                    <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].X[1 - kend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[ioend]) &gt; 50)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                    <span class="comment">// check the error</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = kcl;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = kend;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    totErr = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                      myprt &lt;&lt; <span class="stringliteral">&quot;VtxMatch: Chk missing cluster match &quot;</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ii)</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                        myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ii] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ii];</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                      myprt &lt;&lt; <span class="stringliteral">&quot; Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                    }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                    <span class="keywordflow">if</span> (totErr &gt; 100) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    <span class="keywordflow">if</span> (totErr &lt; best) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                      best = totErr;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                      kbst = kcl;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                      kbend = kend;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                  } <span class="comment">// kend</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                }   <span class="comment">// kcl</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                <span class="keywordflow">if</span> (kbst &gt;= 0) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                  <span class="comment">// found a decent match</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = kbst;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = kbend;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                  <span class="comment">// assign the vertex to this cluster</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kbst].VtxIndex[kbend] = ivx;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                  <span class="comment">// and update vxCls</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[kpl].push_back(kbst);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                  <span class="comment">// Try a 2 plane match if a 3 plane match didn&#39;t work</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = -1;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = 0;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                  <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &lt; 100) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;              } <span class="comment">// jend</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            }   <span class="comment">// iend</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          }     <span class="comment">// jj</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        }       <span class="comment">// ii -&gt; icl</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      }         <span class="comment">// ipl</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">SortMatches</a>(detProp, fmCluHits, 1);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">vxCls</a>[ipl].clear();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  } <span class="comment">// VtxMatch</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a2cbb2074f639e7b3ccb53dbd3a70fffa"> 1414</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a2cbb2074f639e7b3ccb53dbd3a70fffa">CCTrackMaker::FindMaybeVertices</a>()</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// Project clusters to vertices and fill mVtxIndex. No requirement is</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">// made that charge exists on the line between the Begin (End) of the</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="comment">// cluster and the vertex</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl, icl, <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, ivx, oend;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordtype">float</span> best, dWire, dX;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordtype">short</span> ibstvx;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="keywordflow">for</span> (end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          <span class="comment">// ignore already attached clusters</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].VtxIndex[end] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          ibstvx = -1;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          best = 1.;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          <span class="comment">// index of the other end</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;          oend = 1 - <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="keywordflow">for</span> (ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="comment">// ignore if the other end is attached to this vertex (which can happen with short clusters)</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].VtxIndex[oend] == ivx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            dWire = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z, ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) -</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">             if(prt) std::cout&lt;&lt;&quot;FMV: ipl &quot;&lt;&lt;ipl&lt;&lt;&quot; icl &quot;&lt;&lt;icl&lt;&lt;&quot; end &quot;&lt;&lt;end</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">             &lt;&lt;&quot; vtx wire &quot;&lt;&lt;geom-&gt;WireCoordinate(vtx[ivx].Y, vtx[ivx].Z, ipl, tpc, cstat)</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">             &lt;&lt;&quot; cls wire &quot;&lt;&lt;cls[ipl][icl].Wire[end]</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">             &lt;&lt;&quot; dWire &quot;&lt;&lt;dWire&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;              <span class="keywordflow">if</span> (dWire &gt; 30 || dWire &lt; -2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;              <span class="keywordflow">if</span> (dWire &lt; -30 || dWire &gt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="comment">// project the cluster to the vertex wire</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            dX = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[end] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Slope[end] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * dWire -</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="comment">//            if(prt) std::cout&lt;&lt;&quot;dX &quot;&lt;&lt;dX&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <span class="keywordflow">if</span> (dX &lt; best) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;              best = dX;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;              ibstvx = ivx;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          } <span class="comment">// ivx</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          <span class="keywordflow">if</span> (ibstvx &gt;= 0) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="comment">// attach</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = ibstvx;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].mVtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = ibstvx;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      }   <span class="comment">// icl</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    }     <span class="comment">// ipl</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  } <span class="comment">// FindMaybeVertices</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abf07295700c807597ffb1bf4539cf791"> 1473</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abf07295700c807597ffb1bf4539cf791">CCTrackMaker::MakeClusterChains</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                  art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl, icl, icl1, icl2;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordtype">float</span> dw, dx, dWCut, dw1Max, dw2Max;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordtype">float</span> dA, dA2, dACut = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a12658c4451147ddb7088831b80b49ff3">fMaxDAng</a>, chgAsymCut;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordtype">float</span> dXCut, chgasym, mrgErr;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">// long straight clusters</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordtype">bool</span> ls1, ls2;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordtype">bool</span> gotprt = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; 1) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">for</span> (icl1 = 0; icl1 &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size() - 1; ++icl1) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a> = (fDebugAlg == 666 &amp;&amp; ipl == fDebugPlane &amp;&amp; icl1 == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1e66d2b0768dc475ac70eabb68db66c5">fDebugCluster</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) gotprt = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          <span class="comment">// maximum delta Wire overlap is 10% of the total length</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          dw1Max = 0.6 * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Length;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          ls1 = (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Length &gt; 100 &amp;&amp;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                 fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[1]) &lt; 0.04);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          <span class="keywordflow">for</span> (icl2 = icl1 + 1; icl2 &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl2) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            ls2 = (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Length &gt; 100 &amp;&amp;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                   fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[1]) &lt; 0.04);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            dw2Max = 0.6 * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Length;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="comment">// set overlap cut to be the shorter of the two</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            dWCut = dw1Max;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            <span class="keywordflow">if</span> (dw2Max &lt; dWCut) dWCut = dw2Max;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            <span class="comment">// but not exceeding 20 for very long clusters</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <span class="keywordflow">if</span> (dWCut &gt; 100) dWCut = 100;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="keywordflow">if</span> (dWCut &lt; 2) dWCut = 2;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            chgAsymCut = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af58c2f91c3473bf7892ccf77de8205e7">fMergeChgAsym</a>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="comment">// Compare end 1 of icl1 with end 0 of icl2</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;MCC P:C:W icl1 &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1]</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; vtx &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].VtxIndex[1] &lt;&lt; <span class="stringliteral">&quot; ls1 &quot;</span> &lt;&lt; ls1 &lt;&lt; <span class="stringliteral">&quot; icl2 &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                &lt;&lt; icl2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0] &lt;&lt; <span class="stringliteral">&quot; vtx &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].VtxIndex[0]</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; ls2 &quot;</span> &lt;&lt; ls2 &lt;&lt; <span class="stringliteral">&quot; dWCut &quot;</span> &lt;&lt; dWCut;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0]) &gt; dWCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <span class="comment">// ignore if the clusters begin/end on the same wire</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            <span class="comment">//            if(cls[ipl][icl1].Wire[1]  == cls[ipl][icl2].Wire[0]) continue;</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="comment">// or if the angle exceeds the cut</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            <span class="keywordtype">float</span> af = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">AngleFactor</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[1]);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            dACut = fMaxDAng * af;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            dXCut = fChainMaxdX * 5 * af;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            dA = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[0]);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="comment">// compare the match angle at the opposite ends of the clusters.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="comment">// May have a bad end/begin angle if there is a delta-ray in the middle</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            dA2 = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[1]);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; dA &quot;</span> &lt;&lt; dA &lt;&lt; <span class="stringliteral">&quot; dA2 &quot;</span> &lt;&lt; dA2 &lt;&lt; <span class="stringliteral">&quot; DACut &quot;</span> &lt;&lt; dACut &lt;&lt; <span class="stringliteral">&quot; dXCut &quot;</span> &lt;&lt; dXCut;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="keywordflow">if</span> (dA2 &lt; dA) dA = dA2;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="comment">// ignore vertices that have only two associated clusters and</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <span class="comment">// the angle is small</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="keywordflow">if</span> (dA &lt; fChainVtxAng &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].VtxIndex[1] &gt;= 0) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;              dw = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1]);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;              dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[1] * dw * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> -</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                   <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0];</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].VtxIndex[1];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].nClusInPln[ipl] == 2 &amp;&amp; fabs(dx) &lt; 1) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].VtxIndex[1] = -2;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].VtxIndex[0] = -2;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].nClusInPln[ipl] = 0;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; clobbered vertex &quot;</span> &lt;&lt; ivx;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;              } <span class="comment">// vertices match</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            }   <span class="comment">// dA &lt; 0.1 &amp;&amp; ...</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="comment">// don&#39;t merge if a vertex exists at these ends</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].VtxIndex[1] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].VtxIndex[0] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="comment">// expand the angle match cut for clusters that appear to be stopping</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1] &lt; 3 &amp;&amp;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; 3 || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; 3)) {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Stopping cluster&quot;</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;              dACut *= 1.5;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;              chgAsymCut *= 1.5;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;              dXCut *= 3;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            } <span class="comment">// stopping US cluster</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <span class="comment">// find the angle made by the endpoints of the clusters</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            dw = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1]);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordflow">if</span> (dw != 0) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;              dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1];</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;              <span class="keywordtype">float</span> dA3 = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(atan(dx / dw) - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[1]);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dA3 &quot;</span> &lt;&lt; dA3;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;              <span class="keywordflow">if</span> (dA3 &gt; dA) dA = dA3;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="comment">// angle matching</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <span class="keywordflow">if</span> (dA &gt; dACut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; rough dX &quot;</span> &lt;&lt; fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[0]) &lt;&lt; <span class="stringliteral">&quot; cut = 20&quot;</span>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            <span class="comment">// make a rough dX cut</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0]) &gt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="comment">// handle cosmic ray clusters that are broken at delta rays</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keywordflow">if</span> (ls1 || ls2) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;              <span class="comment">// tighter angle cuts but no charge cut</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;              <span class="keywordflow">if</span> (dA &gt; fChainVtxAng) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;              chgasym = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Charge[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Charge[0]);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;              chgasym /= <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Charge[1] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Charge[0];</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; chgasym &quot;</span> &lt;&lt; chgasym &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; chgAsymCut;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;              <span class="keywordflow">if</span> (chgasym &gt; chgAsymCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            } <span class="comment">// ls1 || ls2</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <span class="comment">// project the longer cluster to the end of the shorter one</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a>) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;              dw = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1]);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;              dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[1] * dw * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> -</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                   <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0];</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;              dw = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[0]);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;              dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Slope[0] * dw * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> -</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                   <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1];</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <span class="comment">// handle overlapping clusters</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            <span class="keywordflow">if</span> (dA2 &lt; 0.01 &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(dx) &gt; dXCut &amp;&amp; dx &lt; -1) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;              dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a63dbb25ee655bd43ecd28e4cdfbb2b0a">dXClTraj</a>(fmCluHits, ipl, icl1, 1, icl2);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; new dx from dXClTraj &quot;</span> &lt;&lt; dx;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; X0 &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[1] &lt;&lt; <span class="stringliteral">&quot; slp &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[1] &lt;&lt; <span class="stringliteral">&quot; dw &quot;</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                &lt;&lt; dw &lt;&lt; <span class="stringliteral">&quot; oX &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[0] &lt;&lt; <span class="stringliteral">&quot; dx &quot;</span> &lt;&lt; dx &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; dXCut;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">if</span> (fabs(dx) &gt; dXCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="comment">// calculate a merge error that will be used to adjudicate between multiple merge attempts AngleFactor</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="keywordtype">float</span> xerr = dx / dXCut;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="keywordtype">float</span> aerr = dA / dACut;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            mrgErr = xerr * xerr + aerr * aerr;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;icl1 mrgErr &quot;</span> &lt;&lt; mrgErr &lt;&lt; <span class="stringliteral">&quot; MergeError &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].MergeError[1]</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; icl2 MergeError &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].MergeError[0];</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="comment">// this merge better than a previous one?</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            <span class="keywordflow">if</span> (mrgErr &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].MergeError[1]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="keywordflow">if</span> (mrgErr &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].MergeError[0]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            <span class="comment">// un-merge icl1 - this should always be true but check anyway</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].BrkIndex[1] &gt;= 0) {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ocl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].BrkIndex[1];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;clobber old icl1 BrkIndex &quot;</span> &lt;&lt; ocl;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[0] == icl1) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[0] = -1;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].MergeError[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;              }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[1] == icl1) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[1] = -1;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].MergeError[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;              }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            } <span class="comment">// cls[ipl][icl1].BrkIndex[1] &gt;= 0</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].BrkIndex[1] = icl2;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].MergeError[1] = mrgErr;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="comment">// un-merge icl2</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].BrkIndex[0] &gt;= 0) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ocl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].BrkIndex[0];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;clobber old icl2 BrkIndex &quot;</span> &lt;&lt; ocl;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[0] == icl1) {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[0] = -1;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].MergeError[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;              }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[1] == icl1) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].BrkIndex[1] = -1;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][ocl].MergeError[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">fMaxMergeError</a>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;              }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            } <span class="comment">// cls[ipl][icl2].BrkIndex[0] &gt;= 0</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].BrkIndex[0] = icl1;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].MergeError[0] = mrgErr;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; merge &quot;</span> &lt;&lt; icl1 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; icl2;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          } <span class="comment">// icl2</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        }   <span class="comment">// icl1</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="comment">// look for broken clusters in which have a C shape similar to a Begin-Begin vertex. The clusters</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="comment">// will have large and opposite sign angles</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keywordtype">bool</span> gotone;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">for</span> (icl1 = 0; icl1 &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size() - 1; ++icl1) {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          gotone = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;          <span class="keywordflow">for</span> (icl2 = icl1 + 1; icl2 &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl2) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="comment">// check both ends</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              <span class="comment">// Ignore already identified broken clusters</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].BrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].BrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;              <span class="comment">// require a large angle cluster</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>]) &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;              <span class="comment">// and a second large angle cluster</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[end]) &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;BrokenC: clusters &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                  &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Time[end] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[end] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                  &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Time[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot; angles &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Angle[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                  &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Angle[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot; dWire &quot;</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                  &lt;&lt; fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[end] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[end]);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[end] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[end]) &gt; 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;              <span class="comment">// This is really crude but maybe OK</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;              <span class="comment">// project 1 -&gt; 2</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;              <span class="keywordtype">float</span> dsl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Slope[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;              <span class="keywordtype">float</span> fvw =</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].X[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] -</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                 <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].X[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Slope[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>]) /</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                dsl;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; fvw &quot;</span> &lt;&lt; fvw;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[end] - fvw) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[end] - fvw) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].BrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = icl2;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;              <span class="comment">// TODO This could use some improvement if necessary</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].MergeError[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = 1;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].BrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = icl1;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].MergeError[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = 1;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;              gotone = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;              dx = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[end] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[end]);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;BrokenC: icl1:W &quot;</span> &lt;&lt; icl1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot; icl2:W &quot;</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                  &lt;&lt; icl2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl2].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot; end &quot;</span> &lt;&lt; end &lt;&lt; <span class="stringliteral">&quot; dx &quot;</span> &lt;&lt; dx;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            } <span class="comment">// end</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            <span class="keywordflow">if</span> (gotone) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;          } <span class="comment">// icl2</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        }   <span class="comment">// icl1</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      } <span class="comment">// cls[ipl].size() &gt; 1</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="comment">// follow mother-daughter broken clusters and put them in the cluster chain array</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, mom, momBrkEnd, dtrBrkEnd, nit;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keywordtype">short</span> dtr;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      std::vector&lt;bool&gt; gotcl(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        gotcl[icl] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ipl &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; cls.size() &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      std::vector&lt;unsigned short&gt; sCluster;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      std::vector&lt;unsigned short&gt; sOrder;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        sCluster.clear();</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        sOrder.clear();</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">if</span> (gotcl[icl]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="comment">// don&#39;t start with a cluster broken at both ends</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[0] &gt;= 0 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[1] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keywordflow">for</span> (end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[end] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].MergeError[end] &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">fMergeErrorCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;          gotcl[icl] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          mom = icl;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          <span class="comment">// end where the mom is broken</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          momBrkEnd = <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          sCluster.push_back(mom);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;          <span class="keywordflow">if</span> (momBrkEnd == 1) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <span class="comment">// typical case - broken at the DS end</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            sOrder.push_back(0);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <span class="comment">// broken at the US end</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            sOrder.push_back(1);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          }</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          dtr = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;          nit = 0;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;          <span class="keywordflow">while</span> (dtr &gt;= 0 &amp;&amp; dtr &lt; (<span class="keywordtype">short</span>)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &amp;&amp; nit &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            <span class="comment">// determine which end of the dtr should be attached to mom</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="keywordflow">for</span> (dtrBrkEnd = 0; dtrBrkEnd &lt; 2; ++dtrBrkEnd)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][dtr].BrkIndex[dtrBrkEnd] == mom) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            <span class="keywordflow">if</span> (dtrBrkEnd == 2) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;              gotcl[icl] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="comment">// check for reasonable merge error</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][dtr].MergeError[dtrBrkEnd] &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">fMergeErrorCut</a>) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;              sCluster.push_back(dtr);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;              sOrder.push_back(dtrBrkEnd);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;              gotcl[dtr] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            ++nit;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            <span class="comment">// set up to check the new mom</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            mom = dtr;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="comment">// at the other end</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            momBrkEnd = 1 - dtrBrkEnd;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="comment">// with the new dtr</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            dtr = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][mom].BrkIndex[momBrkEnd];</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;          } <span class="comment">// dtr &gt;= 0 ...</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;          <span class="keywordflow">if</span> (dtrBrkEnd == 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="keywordflow">if</span> (!gotcl[icl]) {</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          <span class="comment">// a single unbroken cluster</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;          sCluster.push_back(icl);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          sOrder.push_back(0);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keywordflow">if</span> (sCluster.size() == 0) {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MakeClusterChains error in plane &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; cluster &quot;</span> &lt;&lt; icl;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html">ClsChainPar</a> ccp;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="comment">// fill the struct parameters assuming this is a cluster chain containing only one cluster</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jcl = sCluster[0];</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keywordflow">if</span> (jcl &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops MCC\n&quot;</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> oend;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="keywordflow">for</span> (end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;          oend = <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;          <span class="keywordflow">if</span> (sOrder[0] &gt; 0) oend = 1 - <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a4b457df642eecd0830d977ba84316599">Wire</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Wire[oend];</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">Time</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Time[oend];</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ac15bef6a5f45f061c2a711172ee235dc">X</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].X[oend];</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a2f13d4b106705cd310f0d3b930a2d7f7">Slope</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Slope[oend];</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a155b7a63501861361bdb7820745e83e0">Angle</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Angle[oend];</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Dir[oend];</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0bcf5f95f4eb20b819fd4c40e20c1944">VtxIndex</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].VtxIndex[oend];</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#aa83078b6350f7b1988305812aaa6f5f0">ChgNear</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].ChgNear[oend];</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0f5bb9cf2d88c85762c75afbc9f75f8e">mBrkIndex</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].BrkIndex[oend];</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1a8bfc0061395f621f4ff0cff3323f69">Length</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Length;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a58a243a4e46d6291fe7e3328b20168ab">TotChg</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a06df1eaea4bf8e9c2a1e1b0d1c6dfc92">InTrack</a> = -1;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 1; ii &lt; sCluster.size(); ++ii) {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          jcl = sCluster[ii];</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;          <span class="keywordflow">if</span> (jcl &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops MCC\n&quot;</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          <span class="comment">// end is the end where the break is being mended</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;          end = sOrder[ii];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;          <span class="keywordflow">if</span> (end &gt; 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops2 MCC\n&quot;</span>;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;          oend = 1 - <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;          <span class="comment">// update the parameters at the other end of the chain</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a4b457df642eecd0830d977ba84316599">Wire</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Wire[oend];</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">Time</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Time[oend];</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ac15bef6a5f45f061c2a711172ee235dc">X</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].X[oend];</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a2f13d4b106705cd310f0d3b930a2d7f7">Slope</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Slope[oend];</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a155b7a63501861361bdb7820745e83e0">Angle</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Angle[oend];</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Dir[oend];</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0bcf5f95f4eb20b819fd4c40e20c1944">VtxIndex</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].VtxIndex[oend];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#aa83078b6350f7b1988305812aaa6f5f0">ChgNear</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].ChgNear[oend];</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0f5bb9cf2d88c85762c75afbc9f75f8e">mBrkIndex</a>[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].BrkIndex[oend];</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1a8bfc0061395f621f4ff0cff3323f69">Length</a> += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].Length;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a58a243a4e46d6291fe7e3328b20168ab">TotChg</a> += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][jcl].TotChg;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a7cf8ca8322df6247139d1643533787c2">ClsIndex</a> = sCluster;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ab69958f862959f1dfcb0d629cb091332">Order</a> = sOrder;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="comment">// redo the direction</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <span class="keywordflow">if</span> (ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">Time</a>[1] &gt; ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">Time</a>[0]) {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[0] = 1;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[1] = -1;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[0] = -1;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          ccp.<a class="code" href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">Dir</a>[1] = 1;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        }</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].push_back(ccp);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      } <span class="comment">// icl</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="comment">// re-index mBrkIndex to point to a cluster chain, not a cluster</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> brkCls;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keywordtype">bool</span> gotit;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ccl = 0; ccl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size(); ++ccl) {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].mBrkIndex[end] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          brkCls = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].mBrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;          gotit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;          <span class="comment">// find this cluster index in a cluster chain</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ccl2 = 0; ccl2 &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size(); ++ccl2) {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            <span class="keywordflow">if</span> (ccl2 == ccl) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <span class="keywordflow">if</span> (std::find(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl2].ClsIndex.begin(),</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl2].ClsIndex.end(),</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                          brkCls) == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl2].ClsIndex.end())</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;            <span class="comment">// found it</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].mBrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = ccl2;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            gotit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;          } <span class="comment">// ccl2</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;          <span class="keywordflow">if</span> (!gotit)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MCC: Cluster chain &quot;</span> &lt;&lt; ccl &lt;&lt; <span class="stringliteral">&quot; end &quot;</span> &lt;&lt; end</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot; Failed to find brkCls &quot;</span> &lt;&lt; brkCls &lt;&lt; <span class="stringliteral">&quot; in plane &quot;</span> &lt;&lt; ipl;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        } <span class="comment">// end</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      }   <span class="comment">// ccl</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">if</span> (gotprt) <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e">PrintClusters</a>(detProp);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  } <span class="comment">// MakeClusterChains</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a63dbb25ee655bd43ecd28e4cdfbb2b0a"> 1876</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a63dbb25ee655bd43ecd28e4cdfbb2b0a">CCTrackMaker::dXClTraj</a>(art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl,</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl1,</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> end1,</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl2)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">// project cluster icl1 at end1 to find the best intersection with icl2</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordtype">float</span> dw, dx, best = 999;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; clusterhits = fmCluHits.at(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].EvtIndex);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = 0; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt; clusterhits.size(); ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      dw = clusterhits[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Wire[end1];</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      dx = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Time[end1] + dw * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">fWirePitch</a> * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl1].Slope[end1] -</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                clusterhits[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;PeakTime());</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keywordflow">if</span> (dx &lt; best) best = dx;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="keywordflow">if</span> (dx &lt; 0.01) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    } <span class="comment">// hit</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">return</span> best;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  } <span class="comment">// dXClTraj</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99535ecabdec87327124f7a0ff59aa2d"> 1897</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99535ecabdec87327124f7a0ff59aa2d">CCTrackMaker::StoreTrack</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                           art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> imat,</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> procCode)</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">// store the current &quot;under construction&quot; track in the trk vector</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html">TrkPar</a> newtrk;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">if</span> (imat &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size() - 1) {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad imat in StoreTrack&quot;</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">// ensure there are at least 2 hits in at least 2 planes</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nhitinpl = 0;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; 1) ++nhitinpl;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordflow">if</span> (nhitinpl &lt; 2) {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;StoreTrack: Not enough hits in each plane\n&quot;</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;In StoreTrack: matcomb &quot;</span> &lt;&lt; imat &lt;&lt; <span class="stringliteral">&quot; cluster chains &quot;</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[2];</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">// Track hit vectors for fitting the trajectory</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    std::array&lt;std::vector&lt;geo::WireID&gt;, 3&gt; trkWID;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    std::array&lt;std::vector&lt;double&gt;, 3&gt; trkX;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    std::array&lt;std::vector&lt;double&gt;, 3&gt; trkXErr;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">// track trajectory for a track</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    std::vector&lt;TVector3&gt; trkPos;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    std::vector&lt;TVector3&gt; trkDir;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size() + 1;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab4d7787a1e421a81b727e6f4056faebf">Proc</a> = procCode;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aebe2830d85d2b1581c31e6697132eafa">TrkHits</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a> = {{-1, -1}};</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#af83e4c639152365ce22daa1d25b62fbf">ChgOrder</a> = 0;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9da01ab7b2263c5a16e7a1d38d2bccfb">MomID</a> = -1;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a97a5768f20127c4f890cb30a7a470bdc">EndInTPC</a> = {{<span class="keyword">false</span>, <span class="keyword">false</span>}};</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a2ef68d231425986b38283d1ebfcff17c">GoodEnd</a> = {{<span class="keyword">false</span>, <span class="keyword">false</span>}};</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ae7bda8938446e323445305f98fab16d3">DtrID</a> = {0};</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aa75ff1595fb39f88de29c6180e7a825b">PDGCode</a> = -1;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl, icl, iht;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CCTM: Make traj for track &quot;</span> &lt;&lt; newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a> &lt;&lt; <span class="stringliteral">&quot; procCode &quot;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                              &lt;&lt; procCode &lt;&lt; <span class="stringliteral">&quot; nhits in planes &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[0].size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[1].size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[2].size();</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="comment">// make the track trajectory</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">if</span> (nplanes == 2) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      trkWID[2].resize(0);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      trkX[2].resize(0);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      trkXErr[2].resize(0);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      trkWID[ipl].resize(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      trkX[ipl].resize(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      trkXErr[ipl].resize(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].size(); ++iht) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        trkWID[ipl][iht] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][iht]-&gt;WireID();</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        trkX[ipl][iht] = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][iht]-&gt;PeakTime(), ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        trkXErr[ipl][iht] =</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;          fHitFitErrFac * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][iht]-&gt;RMS() * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][iht]-&gt;Multiplicity();</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      } <span class="comment">// iht</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5738f4a762bb34108c9637a25f788f14">fTrackTrajectoryAlg</a>.<a class="code" href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html#a10fb05f930beefa0e0a7da711e35edb9">TrackTrajectory</a>(trkWID, trkX, trkXErr, trkPos, trkDir);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordflow">if</span> (trkPos.size() &lt; 2) {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;StoreTrack: No trajectory points on failed track &quot;</span> &lt;&lt; newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; in StoreTrack: matcomb &quot;</span> &lt;&lt; imat &lt;&lt; <span class="stringliteral">&quot; cluster chains &quot;</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                           &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                           &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[2];</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="comment">// make a garbage trajectory</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      trkPos.resize(2);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      trkPos[1](2) = 1;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      trkDir.resize(2);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      trkDir[1](2) = 1;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a> = trkPos;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">TrjDir</a> = trkDir;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; number of traj points &quot;</span> &lt;&lt; trkPos.size();</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">// determine if each end is good in the sense that there are hits in each plane</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">// that are consistent in time and are presumed to form a good 3D space point</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, nClose, indx, jndx;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keywordtype">float</span> xErr;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">for</span> (end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      nClose = 0;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; nplanes - 1; ++ipl) {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keywordflow">if</span> (trkX[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jpl = ipl + 1; jpl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++jpl) {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;          <span class="keywordflow">if</span> (trkX[jpl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;          <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            indx = 0;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            jndx = 0;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            indx = trkXErr[ipl].size() - 1;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            jndx = trkXErr[jpl].size() - 1;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;          }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          xErr = 3 * (trkXErr[ipl][indx] + trkXErr[jpl][jndx]);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(trkX[ipl][indx] - trkX[jpl][jndx]) &lt; xErr) ++nClose;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        } <span class="comment">// jpl</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="keywordflow">if</span> (nClose == nplanes) newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a2ef68d231425986b38283d1ebfcff17c">GoodEnd</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    } <span class="comment">// end</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="comment">// set trajectory end points to a vertex if one exists</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx, itj, ccl;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordtype">float</span> dx, dy, dz, dr0, dr1;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> attachEnd;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">for</span> (end = 0; end &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      ivx = USHRT_MAX;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="keywordflow">if</span> (end == 0 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Vtx &gt;= 0) ivx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Vtx;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="keywordflow">if</span> (end == 1 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].oVtx &gt;= 0) ivx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].oVtx;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keywordflow">if</span> (ivx == USHRT_MAX) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="comment">// determine the proper end using the TrjPos order and brute force</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      itj = 0;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](0);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      dy = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](1);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      dz = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](2);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      dr0 = dx * dx + dy * dy + dz * dz;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      itj = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>.size() - 1;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      dx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](0);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      dy = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](1);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      dz = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](2);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      dr1 = dx * dx + dy * dy + dz * dz;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      attachEnd = 1;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordflow">if</span> (dr0 &lt; dr1) {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        itj = 0;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        attachEnd = 0;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="comment">// a really bad match to the vertex</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keywordflow">if</span> (dr0 &gt; 5) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="comment">// a really bad match to the vertex</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <span class="keywordflow">if</span> (dr1 &gt; 5) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](0) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](1) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](2) = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a>[attachEnd] = ivx;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="comment">// correct the trajectory direction</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordflow">if</span> (itj == 0) {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        dir = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[1] - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[0];</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">TrjDir</a>[0] = dir.Unit();</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        dir = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj - 1] - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj];</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">TrjDir</a>[itj] = dir.Unit();</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    } <span class="comment">// end</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">if</span> (newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a>[0] &gt;= 0 &amp;&amp; newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a>[0] == newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">VtxIndex</a>[1]) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;StoreTrack: Trying to attach a vertex to both ends of a track. imat = &quot;</span> &lt;&lt; imat;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="comment">// calculate the length</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9aa4f53cbea782d96b6662649767840d">Length</a> = 0;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a22bf6b956ca4ad2050a44810c80c805f">norm</a>;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>, Y, Z;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj = 1; itj &lt; newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>.size(); ++itj) {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      X = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](0) - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj - 1](0);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      Y = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](1) - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj - 1](1);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      Z = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj](2) - newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">TrjPos</a>[itj - 1](2);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      norm = sqrt(X * X + Y * Y + Z * Z);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9aa4f53cbea782d96b6662649767840d">Length</a> += <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a22bf6b956ca4ad2050a44810c80c805f">norm</a>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="comment">// store the cluster -&gt; track assignment</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#abc9afd6b7a8014d2de8ac0d986307263">ClsEvtIndices</a>.clear();</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      ccl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[ipl];</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="keywordflow">if</span> (ccl &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops StoreTrack\n&quot;</span>;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].InTrack = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a>;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icc = 0; icc &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex.size(); ++icc) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex[icc];</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <span class="keywordflow">if</span> (icl &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops StoreTrack\n&quot;</span>;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].InTrack = newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a>;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex &gt; fmCluHits.size() - 1) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;ooops2 store track EvtIndex &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex &lt;&lt; <span class="stringliteral">&quot; size &quot;</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                    &lt;&lt; fmCluHits.size() &lt;&lt; <span class="stringliteral">&quot; icl &quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#abc9afd6b7a8014d2de8ac0d986307263">ClsEvtIndices</a>.push_back(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      } <span class="comment">// icc</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; track ID &quot;</span> &lt;&lt; newtrk.<a class="code" href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">ID</a> &lt;&lt; <span class="stringliteral">&quot; stored in StoreTrack&quot;</span>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.push_back(newtrk);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  } <span class="comment">// StoreTrack</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3d62a62b9729d7a4cd907be927d50a8"> 2105</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3d62a62b9729d7a4cd907be927d50a8">CCTrackMaker::PlnMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                         art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits)</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="comment">// Match clusters in all planes</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="comment">//    unsigned short ipl, icl, jpl, jcl, kpl, kcl;</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keywordtype">bool</span> ignoreSign;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="keywordtype">float</span> kSlp, kAng, <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>, kWir, okWir;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordtype">short</span> idir, ioend, jdir, joend, kdir;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordtype">double</span> yp, zp;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordtype">float</span> tpcSizeY = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetHalfWidth();</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordtype">float</span> tpcSizeZ = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;DetLength();</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="keywordtype">float</span> dxcut = 2;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordtype">float</span> dxkcut;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordtype">float</span> dwcut = 6;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">if</span> (fuBCode) {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      dxcut = 20;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      dwcut = 60;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="comment">// temp array for making a rough charge asymmetry cut</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    std::array&lt;float, 3&gt; mchg;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="comment">// skip short clusters</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; fMatchMinLen[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jpl = (ipl + 1) % nplanes;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kpl = (jpl + 1) % nplanes;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jcl = 0; jcl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl].size(); ++jcl) {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;          <span class="comment">// skip short clusters</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; fMatchMinLen[algIndex]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;          <span class="comment">// make first charge asymmetry cut</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;          mchg[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;          mchg[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].TotChg;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;          mchg[2] = mchg[1];</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;          <span class="keywordflow">if</span> (fChgAsymFactor[algIndex] &gt; 0 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">ChargeAsym</a>(mchg) &gt; 0.5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iend = 0; iend &lt; 2; ++iend) {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            idir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Dir[iend];</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jend = 0; jend &lt; 2; ++jend) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;              jdir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Dir[jend];</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;              <span class="keywordflow">if</span> (idir != 0 &amp;&amp; jdir != 0 &amp;&amp; idir != jdir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;              <span class="comment">// make an X cut</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;              <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[iend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[jend]) &gt; dxcut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;              ioend = 1 - iend;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;              joend = 1 - jend;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;              <span class="comment">// Find the expected third (k) plane parameters</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;              kSlp = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;ThirdPlaneSlope(ipl,</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                                           <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[iend],</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                                           jpl,</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                           <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[jend],</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                           <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>,</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                                           <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;              kAng = atan(kSlp);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;              <span class="comment">// Ensure the match end is within the TPC</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;IntersectionPoint((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Wire[iend]),</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                                      (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Wire[jend]),</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                      ipl,</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                                      jpl,</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                                      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>,</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                                      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>,</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                      yp,</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                                      zp);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;              <span class="keywordflow">if</span> (yp &gt; tpcSizeY || yp &lt; -tpcSizeY) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;              <span class="keywordflow">if</span> (zp &lt; 0 || zp &gt; tpcSizeZ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;              kX = 0.5 * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[jend]);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;              kWir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(yp, zp, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;              <span class="comment">// now look at the other end</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;IntersectionPoint((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Wire[ioend]),</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                                      (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Wire[joend]),</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                                      ipl,</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                                      jpl,</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                                      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>,</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                                      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>,</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                                      yp,</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                                      zp);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;              <span class="keywordflow">if</span> (yp &gt; tpcSizeY || yp &lt; -tpcSizeY) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;              <span class="keywordflow">if</span> (zp &lt; 0 || zp &gt; tpcSizeZ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;              okWir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(yp, zp, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;PlnMatch: chk i &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iend &lt;&lt; <span class="stringliteral">&quot; idir &quot;</span> &lt;&lt; idir</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; X &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend] &lt;&lt; <span class="stringliteral">&quot; j &quot;</span> &lt;&lt; jpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jcl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                  &lt;&lt; jend &lt;&lt; <span class="stringliteral">&quot; jdir &quot;</span> &lt;&lt; jdir &lt;&lt; <span class="stringliteral">&quot; X &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[jend];</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;PlnMatch: chk j &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iend &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; jpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                  &lt;&lt; jcl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jend &lt;&lt; <span class="stringliteral">&quot; iSlp &quot;</span> &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                  &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[iend] &lt;&lt; <span class="stringliteral">&quot; jSlp &quot;</span> &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                  &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[jend] &lt;&lt; <span class="stringliteral">&quot; kWir &quot;</span> &lt;&lt; (int)kWir &lt;&lt; <span class="stringliteral">&quot; okWir &quot;</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                  &lt;&lt; (<span class="keywordtype">int</span>)okWir &lt;&lt; <span class="stringliteral">&quot; kSlp &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; kSlp &lt;&lt; <span class="stringliteral">&quot; kAng &quot;</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                  &lt;&lt; std::setprecision(2) &lt;&lt; kAng &lt;&lt; <span class="stringliteral">&quot; kX &quot;</span> &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;              <span class="comment">// handle the case near pi/2, where the errors on large slopes</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;              <span class="comment">// could result in a wrong-sign kAng</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;              ignoreSign = (fabs(kSlp) &gt; 1.5);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;              <span class="keywordflow">if</span> (ignoreSign) kAng = fabs(kAng);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;              dxkcut = dxcut * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">AngleFactor</a>(kSlp);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;              <span class="keywordtype">bool</span> gotkcl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kcl = 0; kcl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl].size(); ++kcl) {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                <span class="comment">// make second charge asymmetry cut</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                mchg[0] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                mchg[1] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].TotChg;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                mchg[2] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].TotChg;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                <span class="keywordflow">if</span> (fChgAsymFactor[algIndex] &gt; 0 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">ChargeAsym</a>(mchg) &gt; 0.5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kend = 0; kend &lt; 2; ++kend) {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                  kdir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Dir[kend];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                  <span class="keywordflow">if</span> (idir != 0 &amp;&amp; kdir != 0 &amp;&amp; idir != kdir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                    mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; kcl &quot;</span> &lt;&lt; kcl &lt;&lt; <span class="stringliteral">&quot; kend &quot;</span> &lt;&lt; kend &lt;&lt; <span class="stringliteral">&quot; dx &quot;</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                      &lt;&lt; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[kend] - kX) &lt;&lt; <span class="stringliteral">&quot; dxkcut &quot;</span> &lt;&lt; dxkcut;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[kend] - kX) &gt; dxkcut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                  <span class="comment">// rough dWire cut</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                    mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; kcl &quot;</span> &lt;&lt; kcl &lt;&lt; <span class="stringliteral">&quot; kend &quot;</span> &lt;&lt; kend &lt;&lt; <span class="stringliteral">&quot; dw &quot;</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                      &lt;&lt; (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Wire[kend] - kWir) &lt;&lt; <span class="stringliteral">&quot; ignoreSign &quot;</span> &lt;&lt; ignoreSign;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                  <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Wire[kend] - kWir) &gt; dwcut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; chk k &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; kcl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; kend;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                  <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a> match;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] = icl;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl] = iend;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[jpl] = jcl;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[jpl] = jend;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = kcl;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = kend;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 100;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] = 0;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[jpl] = 0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] = 0;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend];</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                  match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = -1;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                    mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; PlnMatch: match k &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl]</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] &lt;&lt; <span class="stringliteral">&quot; oChg &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl]</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; mErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &lt;&lt; <span class="stringliteral">&quot; oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                  <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                  <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &gt; 10 || match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &gt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dup? &quot;</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                  gotkcl = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                } <span class="comment">// kend</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;              }   <span class="comment">// kcl</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; PlnMatch: gotkcl &quot;</span> &lt;&lt; gotkcl;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;              <span class="keywordflow">if</span> (!gotkcl) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                <span class="comment">// make a 2-plane match and try again</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a> match;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] = icl;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl] = iend;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[jpl] = jcl;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[jpl] = jend;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = -1;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = 0;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 100;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">DupMatch</a>(match)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] = 0;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[jpl] = 0;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] = 0;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend];</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = -1;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">FillEndMatch</a>(detProp, match);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                  mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; Tried 2-plane match&quot;</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; k &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] &lt;&lt; <span class="stringliteral">&quot; Chg &quot;</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                    &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] &lt;&lt; <span class="stringliteral">&quot; Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &lt;&lt; <span class="stringliteral">&quot; match.oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> &gt; 10 || match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &gt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.push_back(match);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;              } <span class="comment">// !gotkcl</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            }   <span class="comment">// jend</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;          }     <span class="comment">// iend</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        }       <span class="comment">// jcl</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      }         <span class="comment">// icl</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    }           <span class="comment">// ipl</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  } <span class="comment">// PlnMatch</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73"> 2296</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">CCTrackMaker::DupMatch</a>(<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match)</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMatCl, nMiss;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordtype">float</span> toterr = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> imat = 0; imat &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size(); ++imat) {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <span class="comment">// check for exact matches</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[0] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[0] &amp;&amp; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[1] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[1] &amp;&amp;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;          match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[2] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[2]) {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="comment">// compare the error</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordflow">if</span> (toterr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Err + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].oErr) {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;          <span class="comment">// keep the better one</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[0] = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[0];</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[1] = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[1];</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[2] = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[2];</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Vtx = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].dWir = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].dAng = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a>;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].dX = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a>;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Err = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a>;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].oVtx = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].odWir = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a>;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].odAng = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a>;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].odX = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a>;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].oErr = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      } <span class="comment">// test</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="comment">// check for a 3-plane match vs 2-plane match</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      nMatCl = 0;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      nMiss = 0;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] &gt;= 0) {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;          <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[ipl] &amp;&amp;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;              (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[0] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[0] || match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[1] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[1]))</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            ++nMatCl;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;          ++nMiss;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">if</span> (nMatCl == 2 &amp;&amp; nMiss == 1) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    } <span class="comment">// imat</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  } <span class="comment">// DupMatch</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf"> 2345</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">CCTrackMaker::SortMatches</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                            art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits,</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> procCode)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="comment">// sort cluster matches by increasing total match error. Find the minimum total error of all</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="comment">// cluster match combinations and make tracks from them</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    CluLen merr;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    std::vector&lt;CluLen&gt; materr;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii, im;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="comment">// sort by decreasing error</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size(); ++ii) {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      merr.index = ii;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      merr.length = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[ii].Err + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[ii].oErr;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      materr.push_back(merr);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    std::sort(materr.begin(), materr.end(), <a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a3e5cb37db8fe81488c71e2e30f6ea494">lessThan</a>);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;SortMatches\n&quot;</span>;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;   ii    im  Vx   Err     dW     dA     dX  oVx   oErr    odW   odA    odX   Asym  &quot;</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;               <span class="stringliteral">&quot; icl   jcl   kcl \n&quot;</span>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; materr.size(); ++ii) {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        im = materr[ii].index;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="keywordtype">float</span> asym =</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;          fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[0] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[1]) / (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[0] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[1]);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        asym *=</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;          fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[1] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[2]) / (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[1] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Chg[2]);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        myprt &lt;&lt; std::fixed &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; ii &lt;&lt; std::setw(5) &lt;&lt; im</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;              &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Vtx &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Err &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].dWir</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;              &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].dAng &lt;&lt; std::setw(7)</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;              &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].dX &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].oVtx</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;              &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].oErr &lt;&lt; std::setw(7)</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;              &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].odWir &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].odAng &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].odX</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;              &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(3) &lt;&lt; asym &lt;&lt; <span class="stringliteral">&quot; 0:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Cls[0] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].End[0] &lt;&lt; <span class="stringliteral">&quot; 1:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Cls[1] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].End[1];</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a> &gt; 2) myprt &lt;&lt; <span class="stringliteral">&quot; 2:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Cls[2] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].End[2];</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    }   <span class="comment">// prt</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="comment">// define an array to ensure clusters are only used once</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    std::array&lt;std::vector&lt;bool&gt;, 3&gt; pclUsed;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      pclUsed[ipl].resize(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="comment">// count the total number of clusters and length used in matcomb</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> matcombTotCl = 0;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordtype">float</span> matcombTotLen = 0;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size(); ++ii) {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[ii].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[ii].Cls[ipl];</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        ++matcombTotCl;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        matcombTotLen += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Length;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      }</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Number of clusters to match &quot;</span> &lt;&lt; matcombTotCl &lt;&lt; <span class="stringliteral">&quot; total length &quot;</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                              &lt;&lt; matcombTotLen;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keywordflow">if</span> (matcombTotLen &lt;= 0) {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;SortMatches: bad matcomb total length &quot;</span> &lt;&lt; matcombTotLen;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="comment">// vector of matcomb indices of unique cluster matches</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    std::vector&lt;unsigned short&gt; matIndex;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="comment">// vector of matcomb indices of unique cluster matches that have the best total error</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    std::vector&lt;unsigned short&gt; bestMatIndex;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordtype">float</span> totLen, totErr, bestTotErr = 9999;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="comment">// start with the best match</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj, jm, nused, jcl;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="comment">// fraction of the length of all clustters in matcomb that are used in a match</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordtype">float</span> fracLen;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; materr.size(); ++ii) {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      im = materr[ii].index;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      matIndex.clear();</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="comment">// skip really bad matches</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Err &gt; bestTotErr) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      totLen = 0;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      <span class="comment">// initialize pclUsed and flag the clusters in this match</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <span class="comment">// initialize to no clusters used</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        <a class="code" href="../../d0/da2/namespacetrkf.html#a70c1b5920b45babb363628ea6e073ea8">std::fill</a>(pclUsed[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(), pclUsed[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="comment">// check for 2 plane match</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Cls[ipl];</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        pclUsed[ipl][icl] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        totLen += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Length;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="comment">// Initialize the error sum</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      totErr = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[im].Err;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="comment">// Save the index</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      matIndex.push_back(im);</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">// look for matches in the rest of the list that are not already matched.</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordflow">for</span> (jj = 0; jj &lt; materr.size(); ++jj) {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <span class="keywordflow">if</span> (jj == ii) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        jm = materr[jj].index;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <span class="comment">// skip really bad matches</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Err &gt; bestTotErr) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="comment">// check for non-unique cluster indices</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        nused = 0;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;          jcl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Cls[ipl];</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;          <span class="keywordflow">if</span> (pclUsed[ipl][jcl]) ++nused;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;          <span class="comment">// This cluster chain was used in a previous match</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;          <span class="keywordflow">if</span> (nused &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;          totLen += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][jcl].Length;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        <span class="comment">// at least one of the clusters in this match have been used</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        <span class="keywordflow">if</span> (nused != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <span class="comment">// found a match with an unmatched set of clusters. Update the total error and flag them</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        totErr += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Err;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        matIndex.push_back(jm);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="comment">// Flag the clusters used and see if all of them are used</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;          jcl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[jm].Cls[ipl];</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;          pclUsed[ipl][jcl] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      }   <span class="comment">// jm</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keywordflow">if</span> (totLen == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      nused = 0;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = 0; indx &lt; pclUsed[ipl].size(); ++indx)</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;          <span class="keywordflow">if</span> (pclUsed[ipl][indx]) ++nused;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <span class="keywordflow">if</span> (totLen &gt; matcombTotLen) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Oops &quot;</span> &lt;&lt; totLen &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; matcombTotLen &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="comment">// weight the total error by the total length of all clusters</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      fracLen = totLen / matcombTotLen;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      totErr /= fracLen;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;match &quot;</span> &lt;&lt; im &lt;&lt; <span class="stringliteral">&quot; totErr &quot;</span> &lt;&lt; totErr &lt;&lt; <span class="stringliteral">&quot; nused &quot;</span> &lt;&lt; nused &lt;&lt; <span class="stringliteral">&quot; fracLen &quot;</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;              &lt;&lt; fracLen &lt;&lt; <span class="stringliteral">&quot; totLen &quot;</span> &lt;&lt; totLen &lt;&lt; <span class="stringliteral">&quot; mat: &quot;</span>;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = 0; indx &lt; matIndex.size(); ++indx)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; matIndex[indx];</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      } <span class="comment">// prt</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <span class="comment">// check for more used clusters and a better total error</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keywordflow">if</span> (totErr &lt; bestTotErr) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        bestTotErr = totErr;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        bestMatIndex = matIndex;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        <span class="keywordflow">if</span> (nused == matcombTotCl) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;          mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot;bestTotErr &quot;</span> &lt;&lt; bestTotErr &lt;&lt; <span class="stringliteral">&quot; nused &quot;</span> &lt;&lt; nused &lt;&lt; <span class="stringliteral">&quot; matcombTotCl &quot;</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                &lt;&lt; matcombTotCl &lt;&lt; <span class="stringliteral">&quot; mat: &quot;</span>;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = 0; indx &lt; bestMatIndex.size(); ++indx)</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; bestMatIndex[indx];</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        } <span class="comment">// prt</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <span class="comment">// stop looking if we have found everything</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="keywordflow">if</span> (fracLen &gt; 0.999) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      } <span class="comment">// totErr &lt; bestTotErr</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    }   <span class="comment">// im</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keywordflow">if</span> (bestTotErr &gt; 9000) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; bestMatIndex.size(); ++ii) {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      im = bestMatIndex[ii];</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7d7b262985eae63fd20bb60e62ec0c6c">FillTrkHits</a>(fmCluHits, im);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="comment">// look for missing clusters?</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="comment">// store this track with processor code 1</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99535ecabdec87327124f7a0ff59aa2d">StoreTrack</a>(detProp, fmCluHits, im, procCode);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  } <span class="comment">// SortMatches</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0"> 2526</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0">CCTrackMaker::FillEndMatch2</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match)</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="comment">// 2D version of FillEndMatch</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 100;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = 100;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[2] = 0;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a> = 0;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a> = 0;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a> = 0;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a> = 0;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jpl = 1;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[0] &lt; 0 || match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[1] &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl];</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl];</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="comment">// cluster i match end</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="keywordtype">float</span> miX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend];</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="comment">// cluster i other end</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> oiend = 1 - iend;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordtype">float</span> oiX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[oiend];</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jcl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[jpl];</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[jpl];</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[jpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].TotChg;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="comment">// cluster j match end</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordtype">float</span> mjX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[jend];</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="comment">// cluster j other end</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ojend = 1 - jend;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordtype">float</span> ojX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[ojend];</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="comment">// look for a match end vertex match</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = -1;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend] &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].VtxIndex[jend]) {</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend];</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      miX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>].X;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      mjX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>].X;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    }</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// look for an other end vertex match</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = -1;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[oiend] &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[oiend] == <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].VtxIndex[ojend]) {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[oiend];</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      oiX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>].X;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      ojX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>].X;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    }</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="comment">// find the charge asymmetry</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordtype">float</span> chgAsym = 1;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="keywordflow">if</span> (fChgAsymFactor[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] &gt; 0) {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      chgAsym = fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] - match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[jpl]) / (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] + match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[jpl]);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordflow">if</span> (chgAsym &gt; 0.5) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      chgAsym = 1 + fChgAsymFactor[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] * chgAsym;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    }</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="comment">// find the error at the match end</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="keywordtype">float</span> maxSlp = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[iend]);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[jend]) &gt; maxSlp)</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      maxSlp = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[jend]);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="keywordtype">float</span> sigmaX = fXMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] + <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(maxSlp, (<span class="keywordtype">float</span>)20);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> = fabs(miX - mjX);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = chgAsym * match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> / sigmaX;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="comment">// find the error at the other end</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    maxSlp = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[oiend]);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[ojend]) &gt; maxSlp)</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      maxSlp = fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[ojend]);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    sigmaX = fXMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] + <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(maxSlp, (<span class="keywordtype">float</span>)20);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> = fabs(oiX - ojX);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = chgAsym * match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> / sigmaX;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM2: m &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iend &lt;&lt; <span class="stringliteral">&quot; miX &quot;</span> &lt;&lt; miX</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; jpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jcl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; jend &lt;&lt; <span class="stringliteral">&quot; mjX &quot;</span> &lt;&lt; mjX</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; match.dX &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> &lt;&lt; <span class="stringliteral">&quot; match.Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; chgAsym &quot;</span> &lt;&lt; chgAsym &lt;&lt; <span class="stringliteral">&quot; o &quot;</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; oiX &quot;</span> &lt;&lt; oiX &lt;&lt; <span class="stringliteral">&quot; ojX &quot;</span> &lt;&lt; ojX &lt;&lt; <span class="stringliteral">&quot; match.odX &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; match.oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  } <span class="comment">// FillEndMatch2</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280"> 2615</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">CCTrackMaker::FillEndMatch</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, <a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">MatchPars</a>&amp; match)</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="comment">// fill the matching parameters for this cluster match. The calling routine</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="comment">// should set the match end vertex ID (if applicable) as well as the</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="comment">// cluster IDs and matching ends in each plane. Note that the matching variables</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="comment">// Note that dWir, dAng and dTim are not filled if there is a vertex (match.Vtx &gt;= 0).</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="comment">// Likewise, odWir, odAng and odX are not filled if there is a vertex match</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="comment">// at the other end</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a> == 2) {</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0">FillEndMatch2</a>(detProp, match);</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    }</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    std::array&lt;short, 3&gt; mVtx;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    std::array&lt;short, 3&gt; oVtx;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    std::array&lt;float, 3&gt; oWir;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    std::array&lt;float, 3&gt; oSlp;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    std::array&lt;float, 3&gt; oAng;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    std::array&lt;float, 3&gt; oX;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    std::array&lt;float, 3&gt; mChg;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, ipl, iend, jpl, jend, kpl, kend, oend;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="keywordtype">short</span> icl, jcl, kcl;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      mVtx[ipl] = -1;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      oVtx[ipl] = -1;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      oWir[ipl] = -66;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      oSlp[ipl] = -66;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      oAng[ipl] = -66;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      oX[ipl] = -66;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      mChg[ipl] = -1;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="comment">// initialize parameters that shouldn&#39;t have been set by the calling routine</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a> = 0;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a> = 0;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> = 0;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 100;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a> = 0;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a> = 0;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> = 0;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = 100;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = -1;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;FEM &quot;</span>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl];</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      }</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordtype">short</span> missingPlane = -1;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nClInPln = 0;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="comment">// number of vertex matches at each end</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="keywordtype">short</span> aVtx = -1;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> novxmat = 0;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordtype">short</span> aoVtx = -1;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nvxmat = 0;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nShortCl = 0;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <span class="comment">// fill the other end parameters in each plane</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl] &lt; 0) {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        missingPlane = ipl;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      ++nClInPln;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      icl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl];</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      mChg[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      iend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl];</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      mVtx[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[iend];</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">Length</a> &lt; 6) ++nShortCl;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keywordflow">if</span> (mVtx[ipl] &gt;= 0) {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">if</span> (aVtx &lt; 0) aVtx = mVtx[ipl];</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <span class="keywordflow">if</span> (mVtx[ipl] == aVtx) ++nvxmat;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      }</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: m &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iend &lt;&lt; <span class="stringliteral">&quot; Vtx &quot;</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                &lt;&lt; mVtx[ipl] &lt;&lt; <span class="stringliteral">&quot;  Wir &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Wire[iend]</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                                &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; <span class="stringliteral">&quot; Slp &quot;</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[iend] &lt;&lt; std::fixed</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                                &lt;&lt; std::setprecision(1) &lt;&lt; <span class="stringliteral">&quot; X &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend];</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      oend = 1 - iend;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      oWir[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Wire[oend];</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      oAng[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Angle[oend];</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      oSlp[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[oend];</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      oX[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[oend];</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      oVtx[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].VtxIndex[oend];</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordflow">if</span> (oVtx[ipl] &gt;= 0) {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="keywordflow">if</span> (aoVtx &lt; 0) aoVtx = oVtx[ipl];</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <span class="keywordflow">if</span> (oVtx[ipl] == aoVtx) ++novxmat;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      }</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;     o &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; oend &lt;&lt; <span class="stringliteral">&quot; oVtx &quot;</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                                &lt;&lt; oVtx[ipl] &lt;&lt; <span class="stringliteral">&quot; oWir &quot;</span> &lt;&lt; oWir[ipl] &lt;&lt; std::fixed</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                                &lt;&lt; std::setprecision(3) &lt;&lt; <span class="stringliteral">&quot; oSlp &quot;</span> &lt;&lt; oSlp[ipl] &lt;&lt; std::fixed</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                                &lt;&lt; std::setprecision(1) &lt;&lt; <span class="stringliteral">&quot; oX &quot;</span> &lt;&lt; oX[ipl] &lt;&lt; <span class="stringliteral">&quot; Chg &quot;</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                                &lt;&lt; (int)mChg[ipl];</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordtype">bool</span> isShort = (nShortCl &gt; 1);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <span class="keywordflow">if</span> (nClInPln &lt; 2) {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Not enough matched planes supplied&quot;</span>;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: Vtx m &quot;</span> &lt;&lt; aVtx &lt;&lt; <span class="stringliteral">&quot; count &quot;</span> &lt;&lt; nvxmat &lt;&lt; <span class="stringliteral">&quot; o &quot;</span> &lt;&lt; aoVtx</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; count &quot;</span> &lt;&lt; novxmat &lt;&lt; <span class="stringliteral">&quot; missingPlane &quot;</span> &lt;&lt; missingPlane</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; nClInPln &quot;</span> &lt;&lt; nClInPln;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="comment">// perfect match</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <span class="keywordflow">if</span> (nvxmat == 3 &amp;&amp; novxmat == 3) {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = aVtx;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 0;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = aoVtx;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = 0;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="comment">// 2-plane vertex match?</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="comment">// factors applied to error = 1 (no vtx), 0.5 (2 pln vtx), 0.33 (3 pln vtx)</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordtype">float</span> vxFactor = 1;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keywordtype">float</span> ovxFactor = 1;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keywordflow">if</span> (nClInPln == 3) {</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="comment">// a cluster in all 3 planes</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="keywordflow">if</span> (nvxmat == 3) {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="comment">// and all vertex assignments agree at the match end</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = aVtx;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        vxFactor = 0.33;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      <span class="keywordflow">if</span> (novxmat == 3) {</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="comment">// and all vertex assignments agree at the other end</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = aoVtx;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        ovxFactor = 0.33;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      }</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="comment">// a cluster in 2 planes</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="keywordflow">if</span> (nvxmat == 2) {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> = aVtx;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        vxFactor = 0.5;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="keywordflow">if</span> (novxmat == 2) {</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> = aoVtx;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        ovxFactor = 0.5;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    } <span class="comment">// nClInPln</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="comment">// find wire, X and Time at both ends</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="comment">// Find the &quot;other end&quot; matching parameters with</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <span class="comment">// two cases: a 3-plane match or a 2-plane match</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="comment">// and with/without an other end vertex</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordtype">double</span> ypos, zpos;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="keywordtype">float</span> kWir, okWir;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="keywordtype">float</span> kSlp, okSlp, kAng, okAng, okX, <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>, kTim, okTim;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordflow">if</span> (nClInPln == 3) {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      ipl = 0;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      jpl = 1;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      kpl = 2;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    }</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="comment">// 2-plane match</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      kpl = missingPlane;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <span class="keywordflow">if</span> (kpl == 0) {</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        ipl = 1;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        jpl = 2;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (kpl == 1) {</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        ipl = 2;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        jpl = 0;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      }</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        ipl = 0;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        jpl = 1;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      } <span class="comment">// kpl test</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    }   <span class="comment">// missing plane</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    iend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[ipl];</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    jend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[jpl];</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    icl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[ipl];</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    jcl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[jpl];</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">if</span> (nplanes &gt; 2) {</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      kcl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl];</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      kend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl];</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment">    /////////// Wire, Angle, X and Time at the Other end</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"></span>    okSlp = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;ThirdPlaneSlope(ipl, oSlp[ipl], jpl, oSlp[jpl], <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    okAng = atan(okSlp);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="comment">// handle the case near pi/2, where the errors on large slopes could result in</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="comment">// a wrong-sign kAng</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keywordtype">bool</span> ignoreSign = (fabs(okSlp) &gt; 10);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="keywordflow">if</span> (ignoreSign) okAng = fabs(okAng);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> &gt;= 0) {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      <span class="comment">// a vertex exists at the other end</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      okWir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>].Y, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>].Z, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      okX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a>].X;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    }</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      <span class="comment">// no vertex at the other end</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;IntersectionPoint(oWir[ipl], oWir[jpl], ipl, jpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, ypos, zpos);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      okWir = (0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(ypos, zpos, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>));</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      okX = 0.5 * (oX[ipl] + oX[jpl]);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    }</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    okTim = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(okX, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: oEnd&quot;</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; kpl &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot; okSlp &quot;</span> &lt;&lt; okSlp &lt;&lt; <span class="stringliteral">&quot; okAng &quot;</span> &lt;&lt; okAng</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; okWir &quot;</span> &lt;&lt; (int)okWir &lt;&lt; <span class="stringliteral">&quot; okX &quot;</span> &lt;&lt; okX;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment">    /////////// Wire, Angle, X and Time at the Match end</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    kSlp = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;ThirdPlaneSlope(</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Slope[iend], jpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Slope[jend], <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    kAng = atan(kSlp);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="keywordflow">if</span> (ignoreSign) kAng = fabs(kAng);</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> &gt;= 0) {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size() == 0 || (<span class="keywordtype">unsigned</span> int)match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size() - 1) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: Bad match.Vtx &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> &lt;&lt; <span class="stringliteral">&quot; vtx size &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size();</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="comment">// a vertex exists at the match end</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      kWir = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>].Y, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>].Z, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      kX = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a>].X;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    }</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      <span class="comment">// no vertex at the match end</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;IntersectionPoint(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].Wire[iend],</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].Wire[jend],</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                              ipl,</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                              jpl,</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>,</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                              <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>,</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                              ypos,</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                              zpos);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      kWir = (0.5 + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(ypos, zpos, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>));</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      kX = 0.5 * (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend] + <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[jend]);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    }</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    kTim = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(kX, kpl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: mEnd&quot;</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; kpl &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot; kSlp &quot;</span> &lt;&lt; kSlp &lt;&lt; <span class="stringliteral">&quot; kAng &quot;</span> &lt;&lt; kAng &lt;&lt; <span class="stringliteral">&quot; kX &quot;</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                              &lt;&lt; <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="comment">// try to find a 3-plane match using this information</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keywordflow">if</span> (nClInPln &lt; 3 &amp;&amp; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a736b18c295ea86036959988c0dd424a2">FindMissingCluster</a>(kpl, kcl, kend, kWir, kX, okWir, okX)) {</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      nClInPln = 3;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="comment">// update local variables</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl] = kcl;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl] = kend;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].TotChg;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      mChg[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].TotChg;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      oend = 1 - kend;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      oWir[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Wire[oend];</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      oX[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].X[oend];</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      oAng[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Angle[oend];</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      oSlp[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Slope[oend];</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    } <span class="comment">// FindMissingCluster</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="comment">// decide whether to continue with a 2-plane match. The distance between match and other end should</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="comment">// be large enough to create a cluster</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordflow">if</span> (nClInPln == 2 &amp;&amp; fabs(okWir - kWir) &gt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <span class="comment">// Calculate the cluster charge asymmetry. This factor will be applied</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="comment">// to the error of the end matches</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordtype">float</span> chgAsym = 1;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="comment">// Get the charge in the plane without a matching cluster</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <span class="keywordflow">if</span> (nClInPln &lt; 3 &amp;&amp; mChg[missingPlane] &lt;= 0) {</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      <span class="keywordflow">if</span> (missingPlane != kpl)</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM bad missingPlane &quot;</span> &lt;&lt; missingPlane &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;      mChg[kpl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a895813e21607e106d28cded8af22177c">ChargeNear</a>(kpl, (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)kWir, kTim, (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)okWir, okTim);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">Chg</a>[kpl] = mChg[kpl];</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: Missing cluster in &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot; ChargeNear &quot;</span> &lt;&lt; (int)kWir</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)kTim &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (int)okWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)okTim</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; chg &quot;</span> &lt;&lt; mChg[kpl];</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;      <span class="keywordflow">if</span> (mChg[kpl] &lt;= 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="keywordflow">if</span> (fChgAsymFactor[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] &gt; 0) {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      chgAsym = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">ChargeAsym</a>(mChg);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="keywordflow">if</span> (chgAsym &gt; 0.5) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      chgAsym = 1 + fChgAsymFactor[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] * chgAsym;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    }</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FEM: charge asymmetry factor &quot;</span> &lt;&lt; chgAsym;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordtype">float</span> sigmaX, sigmaA;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordtype">float</span> da, dx, dw;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment">    /////////// Matching error at the Match end</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="comment"></span>    <span class="comment">// check for vertex consistency at the match end</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    aVtx = -1;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="keywordtype">bool</span> allPlnVtxMatch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordflow">if</span> (nClInPln == 3) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nmvtx = 0;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ii) {</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        <span class="keywordflow">if</span> (mVtx[ii] &gt;= 0) {</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          <span class="keywordflow">if</span> (aVtx &lt; 0) aVtx = mVtx[ii];</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          ++nmvtx;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        }</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <span class="comment">// same vertex in all planes</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <span class="keywordflow">if</span> (nmvtx) allPlnVtxMatch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    } <span class="comment">// nClInPln</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="comment">// inflate the X match error to allow for missing one wire on the end of a cluster</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    sigmaX = fXMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] + <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(kSlp, (<span class="keywordtype">float</span>)20);</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    sigmaA = fAngleMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">AngleFactor</a>(kSlp);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;bb &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a> &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; fXMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                              &lt;&lt; fAngleMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] &lt;&lt; <span class="stringliteral">&quot; kslp &quot;</span> &lt;&lt; kSlp;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keywordflow">if</span> (nClInPln == 3) {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      kcl = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">Cls</a>[kpl];</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      kend = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">End</a>[kpl];</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      dw = kWir - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Wire[kend];</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a> = dw;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keywordflow">if</span> (fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a>) &gt; 100) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">Vtx</a> &gt;= 0) { match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> = kX - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].X[kend]; }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[iend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[jend]) +</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                   <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[iend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[kend]);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      }</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dw &quot;</span> &lt;&lt; dw &lt;&lt; <span class="stringliteral">&quot; dx &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a>;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <span class="comment">// TODO: Angle matching has problems with short clusters</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">if</span> (!isShort) {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <span class="keywordflow">if</span> (ignoreSign) { match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a> = kAng - fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Angle[kend]); }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a> = kAng - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][kcl].Angle[kend];</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      } <span class="comment">// !isShort</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      da = fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a>) / sigmaA;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      dx = fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a>) / sigmaX;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <span class="keywordflow">if</span> (allPlnVtxMatch) {</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="comment">// matched vertex. Use angle for match error</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = vxFactor * chgAsym * da / 3;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; 3-pln w Vtx  match.Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a>;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      }</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        dw /= 2;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        <span class="comment">// divide by 9</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = vxFactor * chgAsym * sqrt(dx * dx + da * da + dw * dw) / 9;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; 3-pln match.Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a>;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      <span class="comment">// 2-plane match</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">dWir</a> = -1;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">dAng</a> = -1;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][icl].X[iend] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[jpl][jcl].X[jend];</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      <span class="comment">// degrade error by 3 for 2-plane matches</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a> = 3 + vxFactor * chgAsym * fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">dX</a>) / sigmaX;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; 2-pln Err &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">Err</a>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    } <span class="comment">// !(nClInPln == 3)</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment">    /////////// Matching error at the Other end</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (nClInPln == 3) {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <span class="comment">// A cluster in all 3 planes</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      dw = okWir - oWir[kpl];</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a> = dw;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      <span class="keywordflow">if</span> (match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">oVtx</a> &gt;= 0) { match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> = okX - oX[kpl]; }</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(oX[ipl] - oX[jpl]) + <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(oX[ipl] - oX[kpl]);</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      }</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; odw &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">odWir</a> &lt;&lt; <span class="stringliteral">&quot; odx &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> &lt;&lt; <span class="stringliteral">&quot; sigmaX &quot;</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                                &lt;&lt; sigmaX;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="comment">// TODO: CHECK FOR SHOWER-LIKE CLUSTER OTHER END MATCH</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      <span class="keywordflow">if</span> (!isShort) {</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        <span class="keywordflow">if</span> (ignoreSign) { match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a> = okAng - fabs(oAng[kpl]); }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;          match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a> = okAng - oAng[kpl];</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      } <span class="comment">// !isShort</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      da = match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">odAng</a> / sigmaA;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      dx = fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a>) / sigmaX;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      <span class="comment">// error for wire number match</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      dw /= 2;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      <span class="comment">// divide by number of planes with clusters * 3 for dx, da and dw</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = ovxFactor * chgAsym * sqrt(dx * dx + da * da + dw * dw) / 9;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; 3-pln match.oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    }</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      <span class="comment">// Only 2 clusters in 3 planes</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a> = (oX[ipl] - oX[jpl]) / sigmaX;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a> = 3 + ovxFactor * chgAsym * fabs(match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">odX</a>);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; 2-pln match.oErr &quot;</span> &lt;&lt; match.<a class="code" href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">oErr</a>;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  } <span class="comment">// FillEndMatch</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a736b18c295ea86036959988c0dd424a2"> 3018</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a736b18c295ea86036959988c0dd424a2">CCTrackMaker::FindMissingCluster</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kpl,</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                                   <span class="keywordtype">short</span>&amp; kcl,</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&amp; kend,</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                                   <span class="keywordtype">float</span> kWir,</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                                   <span class="keywordtype">float</span> <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>,</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                                   <span class="keywordtype">float</span> okWir,</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                                   <span class="keywordtype">float</span> okX)</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="comment">// try to attach a missing cluster to the cluster chain kcl. kend is the &quot;match end&quot;</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> okend;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordtype">float</span> dxcut;</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keywordflow">if</span> (kcl &gt;= 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="comment">// Look for a missing cluster with loose cuts</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="keywordtype">float</span> kslp = fabs((okX - kX) / (okWir - kWir));</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <span class="keywordflow">if</span> (kslp &gt; 20) kslp = 20;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="comment">// expand dX cut assuming there is a missing hit on the end of a cluster =&gt; 1 wire</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    dxcut = 3 * fXMatchErr[<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">algIndex</a>] + kslp;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nfound = 0;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> foundCl = 0, foundEnd = 0;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ccl = 0; ccl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl].size(); ++ccl) {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][ccl].InTrack &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      <span class="comment">// require a match at both ends</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        okend = 1 - <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][ccl].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] - kWir) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][ccl].Wire[okend] - okWir) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        <span class="comment">// require at least one end to match</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][ccl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] - kX) &gt; dxcut &amp;&amp;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            fabs(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[kpl][ccl].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>[okend] - okX) &gt; dxcut)</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        ++nfound;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        foundCl = ccl;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        foundEnd = <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      } <span class="comment">// end</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    }   <span class="comment">// ccl</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordflow">if</span> (nfound == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="keywordflow">if</span> (nfound &gt; 1) {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FindMissingCluster: Found too many matches. Write some code &quot;</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                              &lt;&lt; nfound;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    kcl = foundCl;</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    kend = foundEnd;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  } <span class="comment">// FindMissingCluster</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3"> 3070</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">CCTrackMaker::ChargeAsym</a>(std::array&lt;float, 3&gt;&amp; mChg)</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  {</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="comment">// find charge asymmetry between the cluster with the highest (lowest)</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    <span class="comment">// charge</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="keywordtype">float</span> big = 0, small = 1.E9;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; 3; ++ii) {</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      <span class="keywordflow">if</span> (mChg[ii] &lt; small) small = mChg[ii];</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      <span class="keywordflow">if</span> (mChg[ii] &gt; big) big = mChg[ii];</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    <span class="comment">// chgAsym varies between 0 (perfect charge match) and 1 (dreadfull)</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="keywordflow">return</span> (big - small) / (big + small);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  } <span class="comment">// CalculateChargeAsym</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7d7b262985eae63fd20bb60e62ec0c6c"> 3085</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7d7b262985eae63fd20bb60e62ec0c6c">CCTrackMaker::FillTrkHits</a>(art::FindManyP&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; fmCluHits, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> imat)</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  {</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="comment">// Fills the trkHits vector using cluster hits associated with the match combo imat</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl)</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].clear();</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    <span class="keywordflow">if</span> (imat &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>.size()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; clusterhits;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icc, ccl, icl, ecl, iht, ii;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="keywordtype">short</span> endOrder, fillOrder;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;In FillTrkHits: matcomb &quot;</span> &lt;&lt; imat &lt;&lt; <span class="stringliteral">&quot; cluster chains &quot;</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                              &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[2];</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[ipl] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="comment">// ccl is the cluster chain index</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      ccl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].Cls[ipl];</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      <span class="comment">// endOrder = 1 for normal order (hits added from US to DS), and -1 for reverse order</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;      endOrder = 1 - 2 * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">matcomb</a>[imat].End[ipl];</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      <span class="comment">// re-order the sequence of cluster indices for reverse order</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <span class="keywordflow">if</span> (endOrder &lt; 0) {</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        std::reverse(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex.begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex.end());</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        std::reverse(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order.begin(), <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order.end());</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order.size(); ++ii)</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order[ii] = 1 - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order[ii];</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      }</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="keywordflow">if</span> (ccl &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() - 1) {</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad cluster chain index &quot;</span> &lt;&lt; ccl &lt;&lt; <span class="stringliteral">&quot; in plane &quot;</span> &lt;&lt; ipl;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      }</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="comment">// loop over all the clusters in the chain</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">for</span> (icc = 0; icc &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex.size(); ++icc) {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        icl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex[icc];</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="keywordflow">if</span> (icl &gt; fmCluHits.size() - 1) {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;oops in FTH &quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot; clsChain size &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;          <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        ecl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        <span class="keywordflow">if</span> (ecl &gt; fmCluHits.size() - 1) {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FTH bad EvtIndex &quot;</span> &lt;&lt; ecl &lt;&lt; <span class="stringliteral">&quot; fmCluHits size &quot;</span> &lt;&lt; fmCluHits.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        clusterhits = fmCluHits.at(ecl);</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        <span class="keywordflow">if</span> (clusterhits.size() == 0) {</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FTH no cluster hits for EvtIndex &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        indx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].size();</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].resize(indx + clusterhits.size());</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <span class="comment">// ensure the hit fill ordering is consistent</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        fillOrder = 1 - 2 * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order[icc];</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        <span class="comment">//        mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;&quot;FillOrder ipl &quot;&lt;&lt;ipl&lt;&lt;&quot; ccl &quot;&lt;&lt;ccl&lt;&lt;&quot; icl &quot;&lt;&lt;icl&lt;&lt;&quot; endOrder &quot;&lt;&lt;endOrder&lt;&lt;&quot; fillOrder &quot;&lt;&lt;fillOrder;</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="keywordflow">if</span> (fillOrder == 1) {</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;          <span class="comment">//          mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;&quot; first hit &quot;&lt;&lt;clusterhits[0]-&gt;WireID().Wire&lt;&lt;&quot;:&quot;&lt;&lt;(int)clusterhits[0]-&gt;PeakTime();</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;          <span class="keywordflow">for</span> (iht = 0; iht &lt; clusterhits.size(); ++iht) {</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;            <span class="keywordflow">if</span> (indx + iht &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() - 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FTH oops3\n&quot;</span>;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][indx + iht] = clusterhits[iht];</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        }</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;          <span class="comment">//          iht = clusterhits.size() - 1;</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;          <span class="comment">//          mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;&quot; first hit &quot;&lt;&lt;clusterhits[iht]-&gt;WireID().Wire&lt;&lt;&quot;:&quot;&lt;&lt;(int)clusterhits[iht]-&gt;PeakTime();</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;          <span class="keywordflow">for</span> (ii = 0; ii &lt; clusterhits.size(); ++ii) {</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            iht = clusterhits.size() - 1 - ii;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;            <span class="keywordflow">if</span> (indx + ii &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() - 1) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FTH oops4\n&quot;</span>;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][indx + ii] = clusterhits[iht];</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;          } <span class="comment">// ii</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        }</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      } <span class="comment">// icc</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      ii = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl].size() - 1;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">prt</a>)</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;plane &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; first p &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][0]-&gt;WireID().Plane</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; w &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][0]-&gt;WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                                &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][0]-&gt;PeakTime() &lt;&lt; <span class="stringliteral">&quot; last p &quot;</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][ii]-&gt;WireID().Plane &lt;&lt; <span class="stringliteral">&quot; w &quot;</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][ii]-&gt;WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                                &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkHits</a>[ipl][ii]-&gt;PeakTime();</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;      <span class="comment">//      for(ii = 0; ii &lt; trkHits[ipl].size(); ++ii) mf::LogVerbatim(&quot;CCTM&quot;)&lt;&lt;ii&lt;&lt;&quot; p &quot;&lt;&lt;trkHits[ipl][ii]-&gt;WireID().Plane&lt;&lt;&quot; w &quot;&lt;&lt;trkHits[ipl][ii]-&gt;WireID().Wire&lt;&lt;&quot; t &quot;&lt;&lt;(int)trkHits[ipl][ii]-&gt;PeakTime();</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="comment">// TODO Check the ends of trkHits to see if there are missing hits that should have been included</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <span class="comment">// in a cluster</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  } <span class="comment">// FillTrkHits</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8f03643d850fed7e515244ff8d6458bb"> 3180</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8f03643d850fed7e515244ff8d6458bb">CCTrackMaker::PrintTracks</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;********* PrintTracks \n&quot;</span>;</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;vtx  Index    X      Y      Z\n&quot;</span>;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; ivx &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].EvtIndex;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      myprt &lt;&lt; std::fixed;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Neutrino) myprt &lt;&lt; <span class="stringliteral">&quot; Neutrino vertex&quot;</span>;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Tracks \n&quot;</span>;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;trk  ID  Proc nht nTrj  sX     sY     sZ     eX     eY     eZ  sVx eVx sGd eGd &quot;</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;             <span class="stringliteral">&quot;ChgOrd  dirZ Mom PDG     ClsIndices\n&quot;</span>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itr = 0; itr &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>.size(); ++itr) {</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; itr &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ID;</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].Proc;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nht = 0;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; 3; ++ii)</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        nht += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrkHits[ii].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>();</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; nht;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      myprt &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.size();</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      myprt &lt;&lt; std::fixed;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[0](0);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[0](1);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[0](2);</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itj = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos.size() - 1;</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](0);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](1);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjPos[itj](2);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      myprt &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[0] &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].VtxIndex[1];</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      myprt &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].GoodEnd[0];</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;      myprt &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].GoodEnd[1];</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      myprt &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ChgOrder;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].TrjDir[itj](2);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].MomID;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].PDGCode &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ClsEvtIndices.size(); ++ii)</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trk</a>[itr].ClsEvtIndices[ii];</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    } <span class="comment">// itr</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  } <span class="comment">// PrintTracks</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e"> 3230</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e">CCTrackMaker::PrintClusters</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTime;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    mf::LogVerbatim myprt(<span class="stringliteral">&quot;CCTM&quot;</span>);</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;******* PrintClusters *********  Num_Clusters_in             Wire:Time\n&quot;</span>;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;vtx  Index    X       Y       Z  Pln0 Pln1 Pln2          Pln0    Pln1    Pln2\n&quot;</span>;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; ivx &lt;&lt; std::setw(7) &lt;&lt; ivx;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      myprt &lt;&lt; std::fixed;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].X;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].nClusInPln[0];</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].nClusInPln[1];</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].nClusInPln[2];</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="keywordtype">int</span> time = (0.5 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>, ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>));</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        <span class="keywordtype">int</span> wire = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;WireCoordinate(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Y, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">vtx</a>[ivx].Z, ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>);</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; time;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Cluster chains in Plane &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;ipl   ccl  Len    Chg    W0:T0     Ang0 Dir0  Vx0  mBk0   W1:T1     Ang1 Dir1  Vx1 &quot;</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;               <span class="stringliteral">&quot; mBk1  InTk    cls:Order \n&quot;</span>;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ccl = 0; ccl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl].size(); ++ccl) {</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; ipl;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; ccl;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Length;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].TotChg;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;          iTime = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Time[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                &lt;&lt; std::setprecision(1) &lt;&lt; iTime;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;          <span class="keywordflow">if</span> (iTime &lt; 10) { myprt &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>; }</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 100) {</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            myprt &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;          }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 1000)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Angle[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Dir[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;          myprt &lt;&lt; std::fixed &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::setprecision(1)</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].mBrkIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;          <span class="comment">//          myprt&lt;&lt;std::fixed&lt;&lt;std::right&lt;&lt;std::setw(6)&lt;&lt;std::setprecision(1)&lt;&lt;clsChain[ipl][ccl].ChgNear[end];</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        }</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].InTrack;</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex.size(); ++ii)</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].ClsIndex[ii] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">clsChain</a>[ipl][ccl].Order[ii];</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      } <span class="comment">// ccl</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="keywordflow">if</span> (fPrintAllClusters) {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Clusters in Plane &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;ipl  icl  Evt   Len     Chg   W0:T0     Ang0 Dir0  Vx0  CN0   W1:T1      Ang1  &quot;</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                 <span class="stringliteral">&quot;Dir1  Vx1  CN1 InTk Brk0 MrgEr0 Brk1 MrgEr1\n&quot;</span>;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl].size(); ++icl) {</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; ipl;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; icl;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].EvtIndex;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Length;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].TotChg;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> = 0; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> &lt; 2; ++<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>) {</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            iTime = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Time[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;            myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Wire[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iTime;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;            <span class="keywordflow">if</span> (iTime &lt; 10) { myprt &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>; }</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 100) {</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;              myprt &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            }</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 1000)</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;              myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;            myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Angle[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;            myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].Dir[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;            myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].VtxIndex[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;            myprt &lt;&lt; std::fixed &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; std::setprecision(1)</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                  &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].ChgNear[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>];</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;          }</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;          myprt &lt;&lt; std::fixed;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].InTrack;</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[0];</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1)</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].MergeError[0];</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].BrkIndex[1];</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;          myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::setprecision(1)</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">cls</a>[ipl][icl].MergeError[1];</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        } <span class="comment">// icl</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      }   <span class="comment">// fPrintAllClusters</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    }     <span class="comment">// ipl</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  }       <span class="comment">// PrintClusters</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2"> 3330</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">CCTrackMaker::AngleFactor</a>(<span class="keywordtype">float</span> slope)</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;  {</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keywordtype">float</span> slp = fabs(slope);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keywordflow">if</span> (slp &gt; 10.) slp = 30.;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="comment">// return a value between 1 and 46</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    <span class="keywordflow">return</span> 1 + 0.05 * slp * slp;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  } <span class="comment">// AngleFactor</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a895813e21607e106d28cded8af22177c"> 3340</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a895813e21607e106d28cded8af22177c">CCTrackMaker::ChargeNear</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl,</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire1,</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                           <span class="keywordtype">float</span> time1,</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire2,</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                           <span class="keywordtype">float</span> time2)</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  {</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <span class="comment">// returns the hit charge along a line between (wire1, time1) and</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="comment">// (wire2, time2)</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <span class="comment">// put in increasing wire order (wire2 &gt; wire1)</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> w1 = wire1;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> w2 = wire2;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    <span class="keywordtype">double</span> t1 = time1;</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    <span class="keywordtype">double</span> t2 = time2;</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <span class="keywordtype">double</span> slp, prtime;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="keywordflow">if</span> (w1 == w2) { slp = 0; }</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      <span class="keywordflow">if</span> (w1 &gt; w2) {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        w1 = wire2;</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        w2 = wire1;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        t1 = time2;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        t2 = time1;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      }</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      slp = (t2 - t1) / (w2 - w1);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    <span class="keywordtype">float</span> chg = 0;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = 0; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size(); ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().TPC != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Plane != ipl) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      wire = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;      <span class="keywordflow">if</span> (wire &lt; w1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      <span class="keywordflow">if</span> (wire &gt; w2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;      prtime = t1 + (wire - w1) * slp;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;prtime &quot;&lt;&lt;wire&lt;&lt;&quot;:&quot;&lt;&lt;(int)prtime&lt;&lt;&quot; hit &quot;&lt;&lt;allhits[hit]-&gt;PeakTimeMinusRMS(3)&lt;&lt;&quot; &quot;&lt;&lt;allhits[hit]-&gt;PeakTimePlusRMS(3)&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;      <span class="keywordflow">if</span> (prtime &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;PeakTimePlusRMS(3)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <span class="keywordflow">if</span> (prtime &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;PeakTimeMinusRMS(3)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;      chg += <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] * <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;Integral();</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    } <span class="comment">// hit</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="keywordflow">return</span> chg;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  } <span class="comment">// ChargeNear</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"><a class="line" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a3e0d8f0b9f648f8c7a89dd6b7bdea4"> 3387</a></span>&#160;  <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a3e0d8f0b9f648f8c7a89dd6b7bdea4">CCTrackMaker::FillWireHitRange</a>()</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;  {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <span class="comment">// fills the WireHitRange vector. Slightly modified version of the one in ClusterCrawlerAlg</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipl;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="comment">// initialize everything</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl] = INT_MAX;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] = 0;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl] = INT_MAX;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl] = 0;</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl].clear();</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] = 0;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    }</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="comment">// find the first and last wire with a hit</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> oldipl = 0;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = 0; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size(); ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().TPC != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      ipl = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Plane;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">geom</a>-&gt;Nwires(ipl, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">tpc</a>, <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">cstat</a>)) {</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl]) {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Invalid WireID().Wire &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        }</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      <span class="comment">//      ChgNorm[ipl] += allhits[hit]-&gt;Integral();</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      <span class="keywordflow">if</span> (ipl &lt; oldipl) {</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Hits are not in increasing-plane order\n&quot;</span>;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      }</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      oldipl = ipl;</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl] == INT_MAX) {</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl] = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      }</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl] = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire;</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    } <span class="comment">// hit</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="comment">// xxx</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl]) {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Invalid first/last wire in plane &quot;</span> &lt;&lt; ipl;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="comment">// normalize charge in induction planes to the collection plane</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    <span class="comment">//    for(ipl = 0; ipl &lt; nplanes; ++ipl) ChgNorm[ipl] = ChgNorm[nplanes - 1] / ChgNorm[ipl];</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl)</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">ChgNorm</a>[ipl] = 1;</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    <span class="comment">// get the service to learn about channel status</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="comment">//lariov::ChannelStatusProvider const&amp; channelStatus</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    <span class="comment">//  = art::ServiceHandle&lt;lariov::ChannelStatusService const&gt;()-&gt;GetProvider();</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="comment">// now we can define the WireHitRange vector.</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keywordtype">int</span> sflag, nwires, wire;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indx, thisWire, thisHit, lastFirstHit;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="comment">//uint32_t chan;</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      nwires = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl] + 1;</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl].resize(nwires);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      <span class="comment">// start by defining the &quot;no hits on wire&quot; condition</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;      sflag = -2;</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;      <span class="keywordflow">for</span> (wire = 0; wire &lt; nwires; ++wire)</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][wire] = std::make_pair(sflag, sflag);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      <span class="comment">// overwrite with the &quot;dead wires&quot; condition</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      sflag = -1;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <span class="keywordflow">for</span> (wire = 0; wire &lt; nwires; ++wire) {</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        <span class="comment">//chan = geom-&gt;PlaneWireToChannel(ipl, wire, tpc, cstat);</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;        <span class="comment">//if(channelStatus.IsBad(chan)) {</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        <span class="comment">//  indx = wire - firstWire[ipl];</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;        <span class="comment">//  WireHitRange[ipl][indx] = std::make_pair(sflag, sflag);</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      } <span class="comment">// wire</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;      <span class="comment">// next overwrite with the index of the first/last hit on each wire</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] = firstWire[ipl];</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;      thisHit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl];</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;      lastFirstHit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl];</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl]; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt;= <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl]; ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        thisWire = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        <span class="keywordflow">if</span> (thisWire &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl]) {</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          indx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] - firstWire[ipl];</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          <span class="keywordtype">int</span> tmp1 = lastFirstHit;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;          <span class="keywordtype">int</span> tmp2 = thisHit;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx] = std::make_pair(tmp1, tmp2);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;          <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] = thisWire;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;          lastFirstHit = thisHit;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        }</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (thisWire &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl]) {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CCTM&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Hit not in proper order in plane &quot;</span> &lt;&lt; ipl;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;          <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        }</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        ++thisHit;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      } <span class="comment">// hit</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      <span class="comment">// define the last wire</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      indx = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] - firstWire[ipl];</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      <span class="keywordtype">int</span> tmp1 = lastFirstHit;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      ++<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl];</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      <span class="keywordtype">int</span> tmp2 = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl];</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;      <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx] = std::make_pair(tmp1, tmp2);</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;      <span class="comment">// add one to lastWire and lastHit for more standard indexing</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      ++<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl];</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="comment">// error checking</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl] &lt; INT_MAX) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl] &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">firstHit</a>[ipl] &lt; INT_MAX) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">lastHit</a>[ipl] &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FWHR problem\n&quot;</span>;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    } <span class="comment">// ipl</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nht = 0;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    std::vector&lt;bool&gt; hchk(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size());</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; hchk.size(); ++ii)</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;      hchk[ii] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">nplanes</a>; ++ipl) {</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl]; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> &lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">lastWire</a>[ipl]; ++<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>) {</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        indx = <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> - <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">firstWire</a>[ipl];</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;        <span class="keywordflow">if</span> (indx &gt; lastWire[ipl]) {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FWHR bad index &quot;</span> &lt;&lt; indx &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;          <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;        }</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        <span class="comment">// no hit on this wire</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firhit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].first;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lashit = <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">WireHitRange</a>[ipl][indx].second;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = firhit; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt; lashit; ++<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          ++nht;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &gt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size() - 1) {</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FWHR: Bad hchk &quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;          }</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;          hchk[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a> != ipl || <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire != <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>) {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FWHR bad plane &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Plane &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ipl</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; or wire &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>]-&gt;WireID().Wire &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;          }</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;        } <span class="comment">// hit</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      }   <span class="comment">// w</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    }     <span class="comment">// ipl</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <span class="keywordflow">if</span> (nht != <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size()) {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FWHR hit count problem &quot;</span> &lt;&lt; nht &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; hchk.size(); ++ii)</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        <span class="keywordflow">if</span> (!hchk[ii])</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[ii]-&gt;WireID().Plane &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                    &lt;&lt; <a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[ii]-&gt;WireID().Wire &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (int)<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">allhits</a>[ii]-&gt;PeakTime() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a>(1);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    }</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;  } <span class="comment">// FillWireHitRange</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;  DEFINE_ART_MODULE(<a class="code" href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html">CCTrackMaker</a>)</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;} <span class="comment">// namespace</span></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a2cbb2074f639e7b3ccb53dbd3a70fffa"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a2cbb2074f639e7b3ccb53dbd3a70fffa">trkf::CCTrackMaker::FindMaybeVertices</a></div><div class="ttdeci">void FindMaybeVertices()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01414">CCTrackMaker_module.cc:1414</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_a2e91c077dea2ff30aae790c67de81ea2"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a></div><div class="ttdeci">process_name vertex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ae5b26a4f861b7e752c8dead0d0aa5547"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae5b26a4f861b7e752c8dead0d0aa5547">trkf::CCTrackMaker::fHitModuleLabel</a></div><div class="ttdeci">std::string fHitModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00068">CCTrackMaker_module.cc:68</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_ab4d7787a1e421a81b727e6f4056faebf"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab4d7787a1e421a81b727e6f4056faebf">trkf::CCTrackMaker::TrkPar::Proc</a></div><div class="ttdeci">unsigned short Proc</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00190">CCTrackMaker_module.cc:190</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a0974ec84552eb02740f5e5d44c96f5f1"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0974ec84552eb02740f5e5d44c96f5f1">trkf::CCTrackMaker::fChainVtxAng</a></div><div class="ttdeci">float fChainVtxAng</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00090">CCTrackMaker_module.cc:90</a></div></div>
<div class="ttc" id="namespacetca_html_a4f3087743ae6823cd5b6e9ff1a344843"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a4f3087743ae6823cd5b6e9ff1a344843">tca::Length</a></div><div class="ttdeci">float Length(const PFPStruct &amp;pfp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/PFPUtils_8cxx_source.html#l03303">PFPUtils.cxx:3303</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a0bcf5f95f4eb20b819fd4c40e20c1944"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0bcf5f95f4eb20b819fd4c40e20c1944">trkf::CCTrackMaker::ClsChainPar::VtxIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; VtxIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00159">CCTrackMaker_module.cc:159</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a713c6fd0d7f879b75364ae74452926e2"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a713c6fd0d7f879b75364ae74452926e2">trkf::CCTrackMaker::vtxPar::Z</a></div><div class="ttdeci">float Z</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00178">CCTrackMaker_module.cc:178</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ad5a168c951b87d1ae50981b674de7e98"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ad5a168c951b87d1ae50981b674de7e98">trkf::CCTrackMaker::matcomb</a></div><div class="ttdeci">std::vector&lt; MatchPars &gt; matcomb</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00236">CCTrackMaker_module.cc:236</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a895813e21607e106d28cded8af22177c"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a895813e21607e106d28cded8af22177c">trkf::CCTrackMaker::ChargeNear</a></div><div class="ttdeci">float ChargeNear(unsigned short ipl, unsigned short wire1, float time1, unsigned short wire2, float time2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03340">CCTrackMaker_module.cc:3340</a></div></div>
<div class="ttc" id="VertexFitAlg_8h_html"><div class="ttname"><a href="../../d2/d8c/VertexFitAlg_8h.html">VertexFitAlg.h</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ab879f8c96f85066bdfc93c195dbec7de"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab879f8c96f85066bdfc93c195dbec7de">trkf::CCTrackMaker::geom</a></div><div class="ttdeci">art::ServiceHandle&lt; geo::Geometry const  &gt; geom</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00073">CCTrackMaker_module.cc:73</a></div></div>
<div class="ttc" id="PFParticle_8h_html"><div class="ttname"><a href="../../d8/d5c/PFParticle_8h.html">PFParticle.h</a></div></div>
<div class="ttc" id="TrackTrajectoryAlg_8h_html"><div class="ttname"><a href="../../d2/d60/TrackTrajectoryAlg_8h.html">TrackTrajectoryAlg.h</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ae9bb4f0e6792d8916c28e8d78bf8803d"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae9bb4f0e6792d8916c28e8d78bf8803d">trkf::CCTrackMaker::fuBCode</a></div><div class="ttdeci">bool fuBCode</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00108">CCTrackMaker_module.cc:108</a></div></div>
<div class="ttc" id="generate__icarus__geometry__splitwire_8pl_html_accc237606badc0385cb717703091fb61"><div class="ttname"><a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#accc237606badc0385cb717703091fb61">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl_source.html#l00430">generate_icarus_geometry_splitwire.pl:430</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_afac1ac7b61385644c993fbb774a1922f"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#afac1ac7b61385644c993fbb774a1922f">cluster</a></div><div class="ttdeci">process_name cluster</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a6573f924775a6c649d11a71abc8bd351"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a6573f924775a6c649d11a71abc8bd351">trkf::CCTrackMaker::MatchPars::oVtx</a></div><div class="ttdeci">short oVtx</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00228">CCTrackMaker_module.cc:228</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_abda96a9914274e8f62d0d48463c05e19"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abda96a9914274e8f62d0d48463c05e19">trkf::CCTrackMaker::fMakePFPs</a></div><div class="ttdeci">bool fMakePFPs</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00101">CCTrackMaker_module.cc:101</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_af3f0a4d54ede2a33f192167a0c28ad9f"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af3f0a4d54ede2a33f192167a0c28ad9f">trkf::CCTrackMaker::fVertexModuleLabel</a></div><div class="ttdeci">std::string fVertexModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00070">CCTrackMaker_module.cc:70</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_aa75ff1595fb39f88de29c6180e7a825b"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aa75ff1595fb39f88de29c6180e7a825b">trkf::CCTrackMaker::TrkPar::PDGCode</a></div><div class="ttdeci">short PDGCode</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00202">CCTrackMaker_module.cc:202</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_aedd77b5ebb70d48a9b4673b8efcbc32e"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#aedd77b5ebb70d48a9b4673b8efcbc32e">recob::tracking::SMatrixSym55</a></div><div class="ttdeci">ROOT::Math::SMatrix&lt; Double32_t, 5, 5, ROOT::Math::MatRepSym&lt; Double32_t, 5 &gt; &gt; SMatrixSym55</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00085">TrackingTypes.h:85</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a08840ef81b7f03a479c6259ed3858d04"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a08840ef81b7f03a479c6259ed3858d04">trkf::CCTrackMaker::ChgNorm</a></div><div class="ttdeci">std::array&lt; float, 3 &gt; ChgNorm</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00211">CCTrackMaker_module.cc:211</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_a159ae849126aae38dcc0675e448c0727"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#a159ae849126aae38dcc0675e448c0727">recob::tracking::convertCollToVector</a></div><div class="ttdeci">std::vector&lt; Vector_t &gt; convertCollToVector(std::vector&lt; Vector &gt; const &amp;coll)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00058">TrackingTypes.h:58</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a6e638e458ab5b35735a41dfb148b115a"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e638e458ab5b35735a41dfb148b115a">trkf::CCTrackMaker::fChgAsymFactor</a></div><div class="ttdeci">std::vector&lt; float &gt; fChgAsymFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00083">CCTrackMaker_module.cc:83</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a34f727877a6a42a13423dc98e62a790c"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a34f727877a6a42a13423dc98e62a790c">trkf::CCTrackMaker::MatchPars::End</a></div><div class="ttdeci">std::array&lt; unsigned short, 3 &gt; End</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00221">CCTrackMaker_module.cc:221</a></div></div>
<div class="ttc" id="classrecob_1_1Seed_html"><div class="ttname"><a href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d34/Seed_8h_source.html#l00020">Seed.h:20</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a5a557ab5ca9437c9fce7bf387705a32d"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5a557ab5ca9437c9fce7bf387705a32d">trkf::CCTrackMaker::firstWire</a></div><div class="ttdeci">std::array&lt; unsigned int, 3 &gt; firstWire</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00122">CCTrackMaker_module.cc:122</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a143c524dc2ef6c298f1760df680e600e"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a143c524dc2ef6c298f1760df680e600e">trkf::CCTrackMaker::clPar::Length</a></div><div class="ttdeci">unsigned short Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00146">CCTrackMaker_module.cc:146</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a7f2b66bfb4acb8ad04a610c067c96ea0"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7f2b66bfb4acb8ad04a610c067c96ea0">trkf::CCTrackMaker::FillEndMatch2</a></div><div class="ttdeci">void FillEndMatch2(detinfo::DetectorPropertiesData const &amp;detProp, MatchPars &amp;match)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l02526">CCTrackMaker_module.cc:2526</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">geo::kX</a></div><div class="ttdoc">Planes which measure X direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00134">geo_types.h:134</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a377819fa17fcbaef06576555b82dffbf"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a377819fa17fcbaef06576555b82dffbf">trkf::CCTrackMaker::SortMatches</a></div><div class="ttdeci">void SortMatches(detinfo::DetectorPropertiesData const &amp;detProp, art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits, unsigned short procCode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l02345">CCTrackMaker_module.cc:2345</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a46159f675b2da8db3dcb85e51957801b"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a46159f675b2da8db3dcb85e51957801b">trkf::CCTrackMaker::allhits</a></div><div class="ttdeci">std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt; allhits</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00128">CCTrackMaker_module.cc:128</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a2df7c4f327596e886a5ca45bd2af59bd"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a2df7c4f327596e886a5ca45bd2af59bd">trkf::CCTrackMaker::clPar::Dir</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; Dir</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00139">CCTrackMaker_module.cc:139</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a79f1b57342d70962685e749753d76ad1"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a79f1b57342d70962685e749753d76ad1">recob::Track::Flags_t</a></div><div class="ttdeci">TrackTrajectory::Flags_t Flags_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00068">bj/lardataobj/RecoBase/Track.h:68</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a99535ecabdec87327124f7a0ff59aa2d"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99535ecabdec87327124f7a0ff59aa2d">trkf::CCTrackMaker::StoreTrack</a></div><div class="ttdeci">void StoreTrack(detinfo::DetectorPropertiesData const &amp;detProp, art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits, unsigned short imat, unsigned short procCode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01897">CCTrackMaker_module.cc:1897</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a720fcbb170bdf5dcd37417940d0fa517"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a720fcbb170bdf5dcd37417940d0fa517">recob::Cluster::StartWire</a></div><div class="ttdeci">float StartWire() const </div><div class="ttdoc">Returns the wire coordinate of the start of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00286">Cluster.h:286</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a3e3463c8d142ae6c603ba20ed92ec22d"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3e3463c8d142ae6c603ba20ed92ec22d">trkf::CCTrackMaker::nplanes</a></div><div class="ttdeci">unsigned short nplanes</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00117">CCTrackMaker_module.cc:117</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a9024d9d89d52b3ced28df02b4e101a0b"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a9024d9d89d52b3ced28df02b4e101a0b">trkf::CCTrackMaker::seedHits</a></div><div class="ttdeci">std::array&lt; std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt;, 3 &gt; seedHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00209">CCTrackMaker_module.cc:209</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classrecob_1_1tracking_1_1Plane_html_a3825c529ac0384711be08bb5fbbbffce"><div class="ttname"><a href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html#a3825c529ac0384711be08bb5fbbbffce">recob::tracking::Plane::Plane</a></div><div class="ttdeci">Plane(const Point_t &amp;planePos, const Vector_t &amp;planeDir)</div><div class="ttdoc">Constructor from reference position on the plane and direction orthogonal to the plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1e/TrackingPlane_8h_source.html#l00061">TrackingPlane.h:61</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a94a2a3d3bb7d3eb149232898690af34f"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a94a2a3d3bb7d3eb149232898690af34f">trkf::CCTrackMaker::fClusterModuleLabel</a></div><div class="ttdeci">std::string fClusterModuleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00069">CCTrackMaker_module.cc:69</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a5738f4a762bb34108c9637a25f788f14"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5738f4a762bb34108c9637a25f788f14">trkf::CCTrackMaker::fTrackTrajectoryAlg</a></div><div class="ttdeci">TrackTrajectoryAlg fTrackTrajectoryAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00075">CCTrackMaker_module.cc:75</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_aa83078b6350f7b1988305812aaa6f5f0"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#aa83078b6350f7b1988305812aaa6f5f0">trkf::CCTrackMaker::ClsChainPar::ChgNear</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; ChgNear</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00161">CCTrackMaker_module.cc:161</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html">recob::Cluster</a></div><div class="ttdoc">Set of hits with a 2D structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00071">Cluster.h:71</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_ac6946175ee0d36410fc75afcb3469718"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ac6946175ee0d36410fc75afcb3469718">trkf::CCTrackMaker::clPar::BrkIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; BrkIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00142">CCTrackMaker_module.cc:142</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a708d4248caba70bed28171bc9adcbb0b"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a708d4248caba70bed28171bc9adcbb0b">recob::Cluster::EndTick</a></div><div class="ttdeci">float EndTick() const </div><div class="ttdoc">Returns the tick coordinate of the end of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00342">Cluster.h:342</a></div></div>
<div class="ttc" id="standard__reco_8fcl_html_a8e7c4631bab825a68b0a82d8223c2ec2"><div class="ttname"><a href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a></div><div class="ttdeci">process_name use argoneut_mc_hitfinder track</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df2/standard__reco_8fcl_source.html#l00036">standard_reco.fcl:36</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a25f8869b1ffe86e6bf0d577dd4bdac77"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a25f8869b1ffe86e6bf0d577dd4bdac77">trkf::CCTrackMaker::pfpToTrkID</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; pfpToTrkID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00216">CCTrackMaker_module.cc:216</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_afca69baf9bd567c0ec959470e9837eb0"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afca69baf9bd567c0ec959470e9837eb0">trkf::CCTrackMaker::TrkPar::TrjPos</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; TrjPos</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00192">CCTrackMaker_module.cc:192</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a4cb747f44557ebf76ff46f21d5bccf02"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4cb747f44557ebf76ff46f21d5bccf02">trkf::CCTrackMaker::trk</a></div><div class="ttdeci">std::vector&lt; TrkPar &gt; trk</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00204">CCTrackMaker_module.cc:204</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a0a3e0d8f0b9f648f8c7a89dd6b7bdea4"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a3e0d8f0b9f648f8c7a89dd6b7bdea4">trkf::CCTrackMaker::FillWireHitRange</a></div><div class="ttdeci">void FillWireHitRange()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03387">CCTrackMaker_module.cc:3387</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a63dbb25ee655bd43ecd28e4cdfbb2b0a"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a63dbb25ee655bd43ecd28e4cdfbb2b0a">trkf::CCTrackMaker::dXClTraj</a></div><div class="ttdeci">float dXClTraj(art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits, unsigned short ipl, unsigned short icl1, unsigned short end1, unsigned short icl2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01876">CCTrackMaker_module.cc:1876</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a6287f1bde8598db375947c2500f1482e"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6287f1bde8598db375947c2500f1482e">trkf::CCTrackMaker::vtxPar::ID</a></div><div class="ttdeci">short ID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00174">CCTrackMaker_module.cc:174</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ab3d62a62b9729d7a4cd907be927d50a8"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3d62a62b9729d7a4cd907be927d50a8">trkf::CCTrackMaker::PlnMatch</a></div><div class="ttdeci">void PlnMatch(detinfo::DetectorPropertiesData const &amp;detProp, art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l02105">CCTrackMaker_module.cc:2105</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a936d45310778d5fc4fe81057c667e280"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a936d45310778d5fc4fe81057c667e280">trkf::CCTrackMaker::prt</a></div><div class="ttdeci">bool prt</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00115">CCTrackMaker_module.cc:115</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a736b18c295ea86036959988c0dd424a2"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a736b18c295ea86036959988c0dd424a2">trkf::CCTrackMaker::FindMissingCluster</a></div><div class="ttdeci">bool FindMissingCluster(unsigned short kpl, short &amp;kcl, unsigned short &amp;kend, float kWir, float kX, float okWir, float okX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03018">CCTrackMaker_module.cc:3018</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_abc99a6861ab56843cce15094af8020ef"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#abc99a6861ab56843cce15094af8020ef">trkf::CCTrackMaker::MatchPars::odWir</a></div><div class="ttdeci">float odWir</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00229">CCTrackMaker_module.cc:229</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a8e7c944f829bff271e33b9c08050ca0f"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8e7c944f829bff271e33b9c08050ca0f">trkf::CCTrackMaker::fAngleMatchErr</a></div><div class="ttdeci">std::vector&lt; float &gt; fAngleMatchErr</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00082">CCTrackMaker_module.cc:82</a></div></div>
<div class="ttc" id="Seed_8h_html"><div class="ttname"><a href="../../de/d34/Seed_8h.html">Seed.h</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_ab76f0d8a09eaa183fc5970d41c86451f"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ab76f0d8a09eaa183fc5970d41c86451f">trkf::CCTrackMaker::clPar::ChgNear</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; ChgNear</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00137">CCTrackMaker_module.cc:137</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a6a16fd6d099c5b70be16bde37fa89237"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6a16fd6d099c5b70be16bde37fa89237">trkf::CCTrackMaker::fDeltaRayCut</a></div><div class="ttdeci">float fDeltaRayCut</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00099">CCTrackMaker_module.cc:99</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a77c6b6f2189707ada2a7e7939d5e1c87"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a77c6b6f2189707ada2a7e7939d5e1c87">trkf::CCTrackMaker::cls</a></div><div class="ttdeci">std::array&lt; std::vector&lt; clPar &gt;, 3 &gt; cls</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00150">CCTrackMaker_module.cc:150</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a05c70b2fb733caf14f6b0ce9b01cc942"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a05c70b2fb733caf14f6b0ce9b01cc942">trkf::CCTrackMaker::FitVertices</a></div><div class="ttdeci">void FitVertices(detinfo::DetectorPropertiesData const &amp;detProp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00809">CCTrackMaker_module.cc:809</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a744b6c09de1d5834791eaa1622ac23c7"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a744b6c09de1d5834791eaa1622ac23c7">recob::Cluster::StartAngle</a></div><div class="ttdeci">float StartAngle() const </div><div class="ttdoc">Returns the starting angle of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00475">Cluster.h:475</a></div></div>
<div class="ttc" id="classrecob_1_1Vertex_html"><div class="ttname"><a href="../../d5/d52/classrecob_1_1Vertex.html">recob::Vertex</a></div><div class="ttdoc">Definition of vertex object for LArSoft. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/Vertex_8h_source.html#l00035">Vertex.h:35</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a07afea1ed1eb8424879656d310e43fa3"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a07afea1ed1eb8424879656d310e43fa3">trkf::CCTrackMaker::clPar::Slope</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Slope</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00135">CCTrackMaker_module.cc:135</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_a97a5768f20127c4f890cb30a7a470bdc"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a97a5768f20127c4f890cb30a7a470bdc">trkf::CCTrackMaker::TrkPar::EndInTPC</a></div><div class="ttdeci">std::array&lt; bool, 2 &gt; EndInTPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00199">CCTrackMaker_module.cc:199</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html">trkf::CCTrackMaker::ClsChainPar</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00153">CCTrackMaker_module.cc:153</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a8603f50b82c749bf5ab503810e0585fc"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8603f50b82c749bf5ab503810e0585fc">trkf::CCTrackMaker::AngMatch</a></div><div class="ttdeci">void AngMatch(art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits)</div></div>
<div class="ttc" id="make__xml__premcc1_80_8sh_html_ae8d1069d1d4353f940d950bdbfa0466e"><div class="ttname"><a href="../../d5/d61/make__xml__premcc1_80_8sh.html#ae8d1069d1d4353f940d950bdbfa0466e">qual</a></div><div class="ttdeci">then qual</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d61/make__xml__premcc1_80_8sh_source.html#l00065">make_xml_premcc1.0.sh:65</a></div></div>
<div class="ttc" id="make__xml__premcc1_80_8sh_html_a6a381711e6b60dd64d5ecdb1d135c1b8"><div class="ttname"><a href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a></div><div class="ttdeci">then local</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d61/make__xml__premcc1_80_8sh_source.html#l00085">make_xml_premcc1.0.sh:85</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_abc782fcc584ff5f5a708551ca1d83a9f"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#abc782fcc584ff5f5a708551ca1d83a9f">trkf::CCTrackMaker::vtxPar::Y</a></div><div class="ttdeci">float Y</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00177">CCTrackMaker_module.cc:177</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a490a5e14c08c31648b1a9585466ca262"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a490a5e14c08c31648b1a9585466ca262">trkf::CCTrackMaker::vtxPar::Neutrino</a></div><div class="ttdeci">bool Neutrino</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00180">CCTrackMaker_module.cc:180</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a81782980d6e8c472c77dc56ab356dd88"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a81782980d6e8c472c77dc56ab356dd88">trkf::CCTrackMaker::trkHits</a></div><div class="ttdeci">std::array&lt; std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt;, 3 &gt; trkHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00207">CCTrackMaker_module.cc:207</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a6fdebe165f5ff6e4d229597f7ebeff8c"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6fdebe165f5ff6e4d229597f7ebeff8c">trkf::CCTrackMaker::fDebugAlg</a></div><div class="ttdeci">short fDebugAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00111">CCTrackMaker_module.cc:111</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a5af12a5c67871f2a00d29ffcba8a4a32"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a5af12a5c67871f2a00d29ffcba8a4a32">trkf::CCTrackMaker::clPar::TotChg</a></div><div class="ttdeci">float TotChg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00147">CCTrackMaker_module.cc:147</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_aa4c62bfbac26e2cb32725254b67d4968"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa4c62bfbac26e2cb32725254b67d4968">trkf::CCTrackMaker::clsChain</a></div><div class="ttdeci">std::array&lt; std::vector&lt; ClsChainPar &gt;, 3 &gt; clsChain</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00170">CCTrackMaker_module.cc:170</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_aaad7058f36e1959faf207e50d9415367"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#aaad7058f36e1959faf207e50d9415367">recob::Cluster::EndCharge</a></div><div class="ttdeci">float EndCharge() const </div><div class="ttdoc">Returns the charge on the last wire of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00498">Cluster.h:498</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_ac15bef6a5f45f061c2a711172ee235dc"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ac15bef6a5f45f061c2a711172ee235dc">trkf::CCTrackMaker::ClsChainPar::X</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; X</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00155">CCTrackMaker_module.cc:155</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a12658c4451147ddb7088831b80b49ff3"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a12658c4451147ddb7088831b80b49ff3">trkf::CCTrackMaker::fMaxDAng</a></div><div class="ttdeci">float fMaxDAng</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00088">CCTrackMaker_module.cc:88</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a1ede2ee3f61fba5495427df001887354"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a1ede2ee3f61fba5495427df001887354">trkf::CCTrackMaker::MatchPars::dWir</a></div><div class="ttdeci">float dWir</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00224">CCTrackMaker_module.cc:224</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a4df7983ee33319f352fca52084e51a73"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a4df7983ee33319f352fca52084e51a73">trkf::CCTrackMaker::DupMatch</a></div><div class="ttdeci">bool DupMatch(MatchPars &amp;match)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l02296">CCTrackMaker_module.cc:2296</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ab3548b7df80fcac129d4f3594666b051"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ab3548b7df80fcac129d4f3594666b051">trkf::CCTrackMaker::algIndex</a></div><div class="ttdeci">unsigned short algIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00079">CCTrackMaker_module.cc:79</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a7d7b262985eae63fd20bb60e62ec0c6c"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a7d7b262985eae63fd20bb60e62ec0c6c">trkf::CCTrackMaker::FillTrkHits</a></div><div class="ttdeci">void FillTrkHits(art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits, unsigned short imat)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03085">CCTrackMaker_module.cc:3085</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_a48509e22b6681725c899fc354de43ae2"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">geo::fhicl::WireID</a></div><div class="ttdeci">IDparameter&lt; geo::WireID &gt; WireID</div><div class="ttdoc">Member type of validated geo::WireID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00407">geo_types_fhicl.h:407</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a1fbb0f4ca065a0aad0681386817c2a11"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a1fbb0f4ca065a0aad0681386817c2a11">trkf::CCTrackMaker::clPar::EvtIndex</a></div><div class="ttdeci">unsigned short EvtIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00144">CCTrackMaker_module.cc:144</a></div></div>
<div class="ttc" id="structCluLen_html_aeb663404d4e43977d0d71780c784426d"><div class="ttname"><a href="../../d2/d4d/structCluLen.html#aeb663404d4e43977d0d71780c784426d">CluLen::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00045">CCTrackMaker_module.cc:45</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_a9da01ab7b2263c5a16e7a1d38d2bccfb"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9da01ab7b2263c5a16e7a1d38d2bccfb">trkf::CCTrackMaker::TrkPar::MomID</a></div><div class="ttdeci">short MomID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00198">CCTrackMaker_module.cc:198</a></div></div>
<div class="ttc" id="classrecob_1_1TrackTrajectory_html"><div class="ttname"><a href="../../de/de5/classrecob_1_1TrackTrajectory.html">recob::TrackTrajectory</a></div><div class="ttdoc">A trajectory in space reconstructed from hits. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/TrackTrajectory_8h_source.html#l00062">TrackTrajectory.h:62</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a5b2d5b4abf4e7400ef5b1c20326dd849"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5b2d5b4abf4e7400ef5b1c20326dd849">trkf::CCTrackMaker::fMatchMinLen</a></div><div class="ttdeci">std::vector&lt; float &gt; fMatchMinLen</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00084">CCTrackMaker_module.cc:84</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ac8dcbe3cf27f78509a2378c424aae280"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac8dcbe3cf27f78509a2378c424aae280">trkf::CCTrackMaker::FillEndMatch</a></div><div class="ttdeci">void FillEndMatch(detinfo::DetectorPropertiesData const &amp;detProp, MatchPars &amp;match)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l02615">CCTrackMaker_module.cc:2615</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a0d4f4265ba38db1e8ab25fc261d58b2b"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a0d4f4265ba38db1e8ab25fc261d58b2b">trkf::CCTrackMaker::vtxPar::EvtIndex</a></div><div class="ttdeci">unsigned short EvtIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00175">CCTrackMaker_module.cc:175</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a1804f15b502eef3c2fbdcd3494a145b2"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1804f15b502eef3c2fbdcd3494a145b2">trkf::CCTrackMaker::CCTrackMaker</a></div><div class="ttdeci">CCTrackMaker(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00316">CCTrackMaker_module.cc:316</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_af58c2f91c3473bf7892ccf77de8205e7"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af58c2f91c3473bf7892ccf77de8205e7">trkf::CCTrackMaker::fMergeChgAsym</a></div><div class="ttdeci">float fMergeChgAsym</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00091">CCTrackMaker_module.cc:91</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_ab69958f862959f1dfcb0d629cb091332"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ab69958f862959f1dfcb0d629cb091332">trkf::CCTrackMaker::ClsChainPar::Order</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; Order</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00166">CCTrackMaker_module.cc:166</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_aa6995d5914ba33ed90d0bd654c19c9a2"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa6995d5914ba33ed90d0bd654c19c9a2">trkf::CCTrackMaker::AngleFactor</a></div><div class="ttdeci">float AngleFactor(float slope)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03330">CCTrackMaker_module.cc:3330</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_ab36be8d2a52c3977ac19ddc041f57805"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ab36be8d2a52c3977ac19ddc041f57805">trkf::CCTrackMaker::TrkPar::VtxIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; VtxIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00194">CCTrackMaker_module.cc:194</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html">trkf::CCTrackMaker::vtxPar</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00173">CCTrackMaker_module.cc:173</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a77ca74432b71ddb285db07669d280866"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a77ca74432b71ddb285db07669d280866">trkf::CCTrackMaker::clPar::mVtxIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; mVtxIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00141">CCTrackMaker_module.cc:141</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_ae7bda8938446e323445305f98fab16d3"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#ae7bda8938446e323445305f98fab16d3">trkf::CCTrackMaker::TrkPar::DtrID</a></div><div class="ttdeci">std::vector&lt; short &gt; DtrID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00201">CCTrackMaker_module.cc:201</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a8c983c9b2363f7464e737ad6b46eb84b"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a8c983c9b2363f7464e737ad6b46eb84b">trkf::CCTrackMaker::MatchPars::dAng</a></div><div class="ttdeci">float dAng</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00225">CCTrackMaker_module.cc:225</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a00f7ded3b81f5236f71f815b5792bc32"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a00f7ded3b81f5236f71f815b5792bc32">trkf::CCTrackMaker::MatchPars::oErr</a></div><div class="ttdeci">float oErr</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00233">CCTrackMaker_module.cc:233</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a359d6255bb14f321d76e6085204ea52a"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">detinfo::DetectorPropertiesData::ConvertXToTicks</a></div><div class="ttdeci">double ConvertXToTicks(double X, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00099">DetectorPropertiesData.cc:99</a></div></div>
<div class="ttc" id="NeutronOsc__module_8cc_html_ae21f357c223957d36046a0d71cc6aed7"><div class="ttname"><a href="../../d5/d56/NeutronOsc__module_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a></div><div class="ttdeci">unsigned int seed</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d56/NeutronOsc__module_8cc_source.html#l00128">NeutronOsc_module.cc:128</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a8ea73c96aaf1fd39e63b17a6bd3bae03"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8ea73c96aaf1fd39e63b17a6bd3bae03">trkf::CCTrackMaker::vtx</a></div><div class="ttdeci">std::vector&lt; vtxPar &gt; vtx</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00183">CCTrackMaker_module.cc:183</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a3ce119073edb914d92954c678f3deadf"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a3ce119073edb914d92954c678f3deadf">trkf::CCTrackMaker::clPar::MergeError</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; MergeError</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00143">CCTrackMaker_module.cc:143</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a0d8d354996000fa4e1dcfb708eb98ebf"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0d8d354996000fa4e1dcfb708eb98ebf">trkf::CCTrackMaker::produce</a></div><div class="ttdeci">void produce(art::Event &amp;evt) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00378">CCTrackMaker_module.cc:378</a></div></div>
<div class="ttc" id="namespacetrkf_html_a70c1b5920b45babb363628ea6e073ea8"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a70c1b5920b45babb363628ea6e073ea8">trkf::fill</a></div><div class="ttdeci">void fill(const art::PtrVector&lt; recob::Hit &gt; &amp;hits, int only_plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d74/KHitContainer_8cxx_source.html#l00018">KHitContainer.cxx:18</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_a2ef68d231425986b38283d1ebfcff17c"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a2ef68d231425986b38283d1ebfcff17c">trkf::CCTrackMaker::TrkPar::GoodEnd</a></div><div class="ttdeci">std::array&lt; bool, 2 &gt; GoodEnd</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00200">CCTrackMaker_module.cc:200</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html">trkf::CCTrackMaker::clPar</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00131">CCTrackMaker_module.cc:131</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_aa15aa43b81c3b39af0da82b0df1e382b"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa15aa43b81c3b39af0da82b0df1e382b">trkf::CCTrackMaker::tpc</a></div><div class="ttdeci">unsigned int tpc</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00119">CCTrackMaker_module.cc:119</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a28cca29de67791215899db8137b1497a"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a28cca29de67791215899db8137b1497a">trkf::CCTrackMaker::MakeFamily</a></div><div class="ttdeci">void MakeFamily()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00952">CCTrackMaker_module.cc:952</a></div></div>
<div class="ttc" id="namespacerecob_1_1tracking_html_a2253bf96e69f939f133551c86bdd2e37"><div class="ttname"><a href="../../d6/d6b/namespacerecob_1_1tracking.html#a2253bf96e69f939f133551c86bdd2e37">recob::tracking::convertCollToPoint</a></div><div class="ttdeci">std::vector&lt; Point_t &gt; convertCollToPoint(std::vector&lt; Point &gt; const &amp;coll)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da9/TrackingTypes_8h_source.html#l00055">TrackingTypes.h:55</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a4b457df642eecd0830d977ba84316599"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a4b457df642eecd0830d977ba84316599">trkf::CCTrackMaker::ClsChainPar::Wire</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Wire</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00154">CCTrackMaker_module.cc:154</a></div></div>
<div class="ttc" id="Cluster_8h_html"><div class="ttname"><a href="../../d8/d77/Cluster_8h.html">Cluster.h</a></div><div class="ttdoc">Declaration of cluster object. </div></div>
<div class="ttc" id="Vertex_8h_html"><div class="ttname"><a href="../../d9/d2d/Vertex_8h.html">Vertex.h</a></div></div>
<div class="ttc" id="classtrkf_1_1TrackTrajectoryAlg_html_a10fb05f930beefa0e0a7da711e35edb9"><div class="ttname"><a href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html#a10fb05f930beefa0e0a7da711e35edb9">trkf::TrackTrajectoryAlg::TrackTrajectory</a></div><div class="ttdeci">void TrackTrajectory(std::array&lt; std::vector&lt; geo::WireID &gt;, 3 &gt; trkWID, std::array&lt; std::vector&lt; double &gt;, 3 &gt; trkX, std::array&lt; std::vector&lt; double &gt;, 3 &gt; trkXErr, std::vector&lt; TVector3 &gt; &amp;TrajPos, std::vector&lt; TVector3 &gt; &amp;TrajDir)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d02/TrackTrajectoryAlg_8cxx_source.html#l00023">TrackTrajectoryAlg.cxx:23</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html">trkf::CCTrackMaker</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00061">CCTrackMaker_module.cc:61</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a5f07f5f8678ae31a3a7a31fb7ee0e92f"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5f07f5f8678ae31a3a7a31fb7ee0e92f">trkf::CCTrackMaker::firstHit</a></div><div class="ttdeci">std::array&lt; unsigned int, 3 &gt; firstHit</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00124">CCTrackMaker_module.cc:124</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a68101562612a200b2fa1bcdb0653911e"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a68101562612a200b2fa1bcdb0653911e">trkf::CCTrackMaker::clPar::Charge</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Charge</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00136">CCTrackMaker_module.cc:136</a></div></div>
<div class="ttc" id="bj_2lardataobj_2RecoBase_2Track_8h_html"><div class="ttname"><a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">Track.h</a></div><div class="ttdoc">Provides recob::Track data product. </div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a7cf8ca8322df6247139d1643533787c2"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a7cf8ca8322df6247139d1643533787c2">trkf::CCTrackMaker::ClsChainPar::ClsIndex</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; ClsIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00165">CCTrackMaker_module.cc:165</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_abf07295700c807597ffb1bf4539cf791"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abf07295700c807597ffb1bf4539cf791">trkf::CCTrackMaker::MakeClusterChains</a></div><div class="ttdeci">void MakeClusterChains(detinfo::DetectorPropertiesData const &amp;detProp, art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01473">CCTrackMaker_module.cc:1473</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a22bf6b956ca4ad2050a44810c80c805f"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a22bf6b956ca4ad2050a44810c80c805f">geo::vect::norm</a></div><div class="ttdeci">auto norm(Vector const &amp;v)</div><div class="ttdoc">Return norm of the specified vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6c/geo__vectors__utils_8h_source.html#l01202">geo_vectors_utils.h:1202</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_abc9afd6b7a8014d2de8ac0d986307263"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#abc9afd6b7a8014d2de8ac0d986307263">trkf::CCTrackMaker::TrkPar::ClsEvtIndices</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; ClsEvtIndices</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00195">CCTrackMaker_module.cc:195</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a815c7a7bbac63acc8fad2c4c234b7c01"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a815c7a7bbac63acc8fad2c4c234b7c01">trkf::CCTrackMaker::fWirePitch</a></div><div class="ttdeci">float fWirePitch</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00096">CCTrackMaker_module.cc:96</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_aa0c045aacf003c971fafbd11af6a95d3"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa0c045aacf003c971fafbd11af6a95d3">trkf::CCTrackMaker::lastWire</a></div><div class="ttdeci">std::array&lt; unsigned int, 3 &gt; lastWire</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00123">CCTrackMaker_module.cc:123</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ade8bf88ea307dcc1ca33eb16705d8ce0"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ade8bf88ea307dcc1ca33eb16705d8ce0">trkf::CCTrackMaker::fFiducialCut</a></div><div class="ttdeci">float fFiducialCut</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00098">CCTrackMaker_module.cc:98</a></div></div>
<div class="ttc" id="classrecob_1_1tracking_1_1Plane_html"><div class="ttname"><a href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">recob::tracking::Plane</a></div><div class="ttdoc">Class defining a plane for tracking. It provides various functionalities to convert track parameters ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1e/TrackingPlane_8h_source.html#l00037">TrackingPlane.h:37</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a3a31446703c86b8b403176c4c02b61a1"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a3a31446703c86b8b403176c4c02b61a1">trkf::CCTrackMaker::fMaxMergeError</a></div><div class="ttdeci">float fMaxMergeError</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00092">CCTrackMaker_module.cc:92</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8e4b4b8d755ffded5a9f956ae7c9c1ec"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">detinfo::DetectorPropertiesData::ConvertTicksToX</a></div><div class="ttdeci">double ConvertTicksToX(double ticks, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00115">DetectorPropertiesData.cc:115</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_adbfa9229e9ac20c91d67bf268f137f90"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#adbfa9229e9ac20c91d67bf268f137f90">trkf::CCTrackMaker::fChainMaxdX</a></div><div class="ttdeci">float fChainMaxdX</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00089">CCTrackMaker_module.cc:89</a></div></div>
<div class="ttc" id="structCluLen_html_af2b4b8f0fe8bc09b99b0dbffbdf543d9"><div class="ttname"><a href="../../d2/d4d/structCluLen.html#af2b4b8f0fe8bc09b99b0dbffbdf543d9">CluLen::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00044">CCTrackMaker_module.cc:44</a></div></div>
<div class="ttc" id="classtrkf_1_1TrackTrajectoryAlg_html"><div class="ttname"><a href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html">trkf::TrackTrajectoryAlg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d60/TrackTrajectoryAlg_8h_source.html#l00026">TrackTrajectoryAlg.h:26</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="CCTrackMaker__module_8cc_html_a60fd6c12d997bc64d7d3ac6835841fe0"><div class="ttname"><a href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">greaterThan</a></div><div class="ttdeci">bool greaterThan(CluLen c1, CluLen c2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00049">CCTrackMaker_module.cc:49</a></div></div>
<div class="ttc" id="namespaceutil_html_ac016dc123242a7f1d5c81594de910717"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#ac016dc123242a7f1d5c81594de910717">util::CreateAssn</a></div><div class="ttdeci">bool CreateAssn(art::Event &amp;evt, std::vector&lt; T &gt; const &amp;a, art::Ptr&lt; U &gt; const &amp;b, art::Assns&lt; U, T &gt; &amp;assn, std::string a_instance, size_t index=UINT_MAX)</div><div class="ttdoc">Creates a single one-to-one association. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h_source.html#l00581">lardata/lardata/Utilities/AssociationUtil.h:581</a></div></div>
<div class="ttc" id="classtrkf_1_1VertexFitAlg_html_a8ada40cd1cc04ded40b8784b37b4c2d5"><div class="ttname"><a href="../../de/d1e/classtrkf_1_1VertexFitAlg.html#a8ada40cd1cc04ded40b8784b37b4c2d5">trkf::VertexFitAlg::VertexFit</a></div><div class="ttdeci">void VertexFit(std::vector&lt; std::vector&lt; geo::WireID &gt;&gt; const &amp;hitWID, std::vector&lt; std::vector&lt; double &gt;&gt; const &amp;hitX, std::vector&lt; std::vector&lt; double &gt;&gt; const &amp;hitXErr, TVector3 &amp;VtxPos, TVector3 &amp;VtxPosErr, std::vector&lt; TVector3 &gt; &amp;TrkDir, std::vector&lt; TVector3 &gt; &amp;TrkDirErr, float &amp;ChiDOF) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de3/VertexFitAlg_8cxx_source.html#l00085">VertexFitAlg.cxx:85</a></div></div>
<div class="ttc" id="classrecob_1_1PFParticle_html"><div class="ttname"><a href="../../dc/d21/classrecob_1_1PFParticle.html">recob::PFParticle</a></div><div class="ttdoc">Hierarchical representation of particle flow. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/PFParticle_8h_source.html#l00044">PFParticle.h:44</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_afc2c0faaa3cea9169464e32577d13091"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#afc2c0faaa3cea9169464e32577d13091">trkf::CCTrackMaker::TrkPar::ID</a></div><div class="ttdeci">short ID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00189">CCTrackMaker_module.cc:189</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_ae3f253f6df80fe490cc7c358d5c85070"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#ae3f253f6df80fe490cc7c358d5c85070">trkf::CCTrackMaker::ClsChainPar::Time</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Time</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00156">CCTrackMaker_module.cc:156</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a7395cbe51bad410d585cb800c3547959"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a7395cbe51bad410d585cb800c3547959">recob::Cluster::StartCharge</a></div><div class="ttdeci">float StartCharge() const </div><div class="ttdoc">Returns the charge on the first wire of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00454">Cluster.h:454</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a2f13d4b106705cd310f0d3b930a2d7f7"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a2f13d4b106705cd310f0d3b930a2d7f7">trkf::CCTrackMaker::ClsChainPar::Slope</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Slope</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00157">CCTrackMaker_module.cc:157</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a01857bffad3e11abd827506ab7a6c5f0"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a01857bffad3e11abd827506ab7a6c5f0">trkf::CCTrackMaker::clPar::InTrack</a></div><div class="ttdeci">short InTrack</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00145">CCTrackMaker_module.cc:145</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a8a3e3ffd176057d84fae471dde11b26b"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8a3e3ffd176057d84fae471dde11b26b">trkf::CCTrackMaker::clPar::VtxIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; VtxIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00140">CCTrackMaker_module.cc:140</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ac6a32f9a5f820542c1d049b35d7e132e"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac6a32f9a5f820542c1d049b35d7e132e">trkf::CCTrackMaker::PrintClusters</a></div><div class="ttdeci">void PrintClusters(detinfo::DetectorPropertiesData const &amp;detProp) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03230">CCTrackMaker_module.cc:3230</a></div></div>
<div class="ttc" id="lardata_2lardata_2Utilities_2AssociationUtil_8h_html"><div class="ttname"><a href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">AssociationUtil.h</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a1d17f75cbd0d100989a24a4d0f8114cc"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1d17f75cbd0d100989a24a4d0f8114cc">trkf::CCTrackMaker::fMergeErrorCut</a></div><div class="ttdeci">float fMergeErrorCut</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00093">CCTrackMaker_module.cc:93</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a978557600410975950dd2aa92ac84a87"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a978557600410975950dd2aa92ac84a87">trkf::CCTrackMaker::MatchPars::Err</a></div><div class="ttdeci">float Err</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00227">CCTrackMaker_module.cc:227</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a265e62f483761e8c28f8e8d4bf7db6ec"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a265e62f483761e8c28f8e8d4bf7db6ec">trkf::CCTrackMaker::fChgWindow</a></div><div class="ttdeci">float fChgWindow</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00095">CCTrackMaker_module.cc:95</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a5e9f77cf475360503f04e8c33ea5fcfa"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a5e9f77cf475360503f04e8c33ea5fcfa">trkf::CCTrackMaker::lastHit</a></div><div class="ttdeci">std::array&lt; unsigned int, 3 &gt; lastHit</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00125">CCTrackMaker_module.cc:125</a></div></div>
<div class="ttc" id="classtrkf_1_1VertexFitAlg_html"><div class="ttname"><a href="../../de/d1e/classtrkf_1_1VertexFitAlg.html">trkf::VertexFitAlg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d8c/VertexFitAlg_8h_source.html#l00028">VertexFitAlg.h:28</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a8fc7c3c2be6182012379aa3d6a65ead0"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a8fc7c3c2be6182012379aa3d6a65ead0">trkf::CCTrackMaker::clPar::X</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; X</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00133">CCTrackMaker_module.cc:133</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a8f03643d850fed7e515244ff8d6458bb"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a8f03643d850fed7e515244ff8d6458bb">trkf::CCTrackMaker::PrintTracks</a></div><div class="ttdeci">void PrintTracks() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03180">CCTrackMaker_module.cc:3180</a></div></div>
<div class="ttc" id="CCTrackMaker__module_8cc_html_a3e5cb37db8fe81488c71e2e30f6ea494"><div class="ttname"><a href="../../d1/db9/CCTrackMaker__module_8cc.html#a3e5cb37db8fe81488c71e2e30f6ea494">lessThan</a></div><div class="ttdeci">bool lessThan(CluLen c1, CluLen c2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00054">CCTrackMaker_module.cc:54</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a1bff4e6bb19162da2f7eeb35f620e1b2"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1bff4e6bb19162da2f7eeb35f620e1b2">trkf::CCTrackMaker::ClsChainPar::Dir</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; Dir</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00160">CCTrackMaker_module.cc:160</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a5022f76b3609ba44a14dd11c90b33db1"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a5022f76b3609ba44a14dd11c90b33db1">trkf::CCTrackMaker::vtxPar::X</a></div><div class="ttdeci">float X</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00176">CCTrackMaker_module.cc:176</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a1a8bfc0061395f621f4ff0cff3323f69"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a1a8bfc0061395f621f4ff0cff3323f69">trkf::CCTrackMaker::ClsChainPar::Length</a></div><div class="ttdeci">unsigned short Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00163">CCTrackMaker_module.cc:163</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ac585beb768f84f15c69398fef61ad756"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac585beb768f84f15c69398fef61ad756">trkf::CCTrackMaker::cstat</a></div><div class="ttdeci">unsigned int cstat</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00118">CCTrackMaker_module.cc:118</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a48f733e21cab737693b10ab9e8a3ed5c"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a48f733e21cab737693b10ab9e8a3ed5c">trkf::CCTrackMaker::MatchPars::dSP</a></div><div class="ttdeci">float dSP</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00232">CCTrackMaker_module.cc:232</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html">trkf::CCTrackMaker::MatchPars</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00219">CCTrackMaker_module.cc:219</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a09e9af88747093b27d4de745e918a2f4"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a09e9af88747093b27d4de745e918a2f4">trkf::CCTrackMaker::fPrintAllClusters</a></div><div class="ttdeci">bool fPrintAllClusters</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00114">CCTrackMaker_module.cc:114</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_a33a8fa5d69b286990695e81b585cfdc0"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a33a8fa5d69b286990695e81b585cfdc0">trkf::CCTrackMaker::TrkPar::TrjDir</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; TrjDir</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00193">CCTrackMaker_module.cc:193</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_a9aa4f53cbea782d96b6662649767840d"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#a9aa4f53cbea782d96b6662649767840d">trkf::CCTrackMaker::TrkPar::Length</a></div><div class="ttdeci">float Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00196">CCTrackMaker_module.cc:196</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_ab0b275f9dddb67b014a8f331b3ad6851"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab0b275f9dddb67b014a8f331b3ad6851">trkf::CCTrackMaker::MatchPars::odAng</a></div><div class="ttdeci">float odAng</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00230">CCTrackMaker_module.cc:230</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a155b7a63501861361bdb7820745e83e0"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a155b7a63501861361bdb7820745e83e0">trkf::CCTrackMaker::ClsChainPar::Angle</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00158">CCTrackMaker_module.cc:158</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a4647ae2202555506edff57b98d750457"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a4647ae2202555506edff57b98d750457">trkf::CCTrackMaker::MatchPars::odX</a></div><div class="ttdeci">float odX</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00231">CCTrackMaker_module.cc:231</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_aaab5f6d99fa4c156a0ab0f01a77422dc"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#aaab5f6d99fa4c156a0ab0f01a77422dc">trkf::CCTrackMaker::MatchPars::dX</a></div><div class="ttdeci">float dX</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00226">CCTrackMaker_module.cc:226</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a58a243a4e46d6291fe7e3328b20168ab"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a58a243a4e46d6291fe7e3328b20168ab">trkf::CCTrackMaker::ClsChainPar::TotChg</a></div><div class="ttdeci">float TotChg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00164">CCTrackMaker_module.cc:164</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_abba75f158c3a57344767f9698b6f2f3f"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#abba75f158c3a57344767f9698b6f2f3f">trkf::CCTrackMaker::FillChgNear</a></div><div class="ttdeci">void FillChgNear(detinfo::DetectorPropertiesData const &amp;detProp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00897">CCTrackMaker_module.cc:897</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00007">DataStructs.cxx:7</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_aa772bfa19b05c2dde8cc74a50b019b44"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#aa772bfa19b05c2dde8cc74a50b019b44">trkf::CCTrackMaker::fMakeAlgTracks</a></div><div class="ttdeci">std::vector&lt; bool &gt; fMakeAlgTracks</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00085">CCTrackMaker_module.cc:85</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ae0ecc86e7d9d1ac612b5a2cbeeb16c3a"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ae0ecc86e7d9d1ac612b5a2cbeeb16c3a">trkf::CCTrackMaker::fMatchAlgs</a></div><div class="ttdeci">std::vector&lt; short &gt; fMatchAlgs</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00080">CCTrackMaker_module.cc:80</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a98c0895c5bdb60954ca366ae3e1f55de"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a98c0895c5bdb60954ca366ae3e1f55de">trkf::CCTrackMaker::fXMatchErr</a></div><div class="ttdeci">std::vector&lt; float &gt; fXMatchErr</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00081">CCTrackMaker_module.cc:81</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_ac82fed743ea63e9f51ff83c81d17f568"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#ac82fed743ea63e9f51ff83c81d17f568">trkf::CCTrackMaker::TagCosmics</a></div><div class="ttdeci">void TagCosmics()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01165">CCTrackMaker_module.cc:1165</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a0a17a26ed9b1fed0c30aeaabae73b9ce"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0a17a26ed9b1fed0c30aeaabae73b9ce">trkf::CCTrackMaker::fHitFitErrFac</a></div><div class="ttdeci">float fHitFitErrFac</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00105">CCTrackMaker_module.cc:105</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_ab374ac897ae981fe1906b1dfa976031c"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#ab374ac897ae981fe1906b1dfa976031c">trkf::CCTrackMaker::MatchPars::Vtx</a></div><div class="ttdeci">short Vtx</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00223">CCTrackMaker_module.cc:223</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a337e7622b80e3d2236cdfd1181ee050c"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a337e7622b80e3d2236cdfd1181ee050c">recob::Cluster::EndAngle</a></div><div class="ttdeci">float EndAngle() const </div><div class="ttdoc">Returns the ending angle of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00519">Cluster.h:519</a></div></div>
<div class="ttc" id="namespacetrkf_html_a41d627d46d1a30e41d4f191ff6acebd8"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a41d627d46d1a30e41d4f191ff6acebd8">trkf::Plane</a></div><div class="ttdeci">recob::tracking::Plane Plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2f/TrackState_8h_source.html#l00017">TrackState.h:17</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_af0c90784ec6d9b0a2f376cc626a265b3"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#af0c90784ec6d9b0a2f376cc626a265b3">trkf::CCTrackMaker::ChargeAsym</a></div><div class="ttdeci">float ChargeAsym(std::array&lt; float, 3 &gt; &amp;mChg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l03070">CCTrackMaker_module.cc:3070</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_ad0ed6a749bd737a6bb6b540595b20dbb"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#ad0ed6a749bd737a6bb6b540595b20dbb">trkf::CCTrackMaker::clPar::Wire</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Wire</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00132">CCTrackMaker_module.cc:132</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a0f1d91111d67ae44f150e6cf9d874e8c"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a0f1d91111d67ae44f150e6cf9d874e8c">trkf::CCTrackMaker::MatchPars::Cls</a></div><div class="ttdeci">std::array&lt; short, 3 &gt; Cls</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00220">CCTrackMaker_module.cc:220</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a1e66d2b0768dc475ac70eabb68db66c5"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1e66d2b0768dc475ac70eabb68db66c5">trkf::CCTrackMaker::fDebugCluster</a></div><div class="ttdeci">short fDebugCluster</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00113">CCTrackMaker_module.cc:113</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a99ffb710bc88a0a7aa7147626bea83f7"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a99ffb710bc88a0a7aa7147626bea83f7">trkf::CCTrackMaker::VtxMatch</a></div><div class="ttdeci">void VtxMatch(detinfo::DetectorPropertiesData const &amp;detProp, art::FindManyP&lt; recob::Hit &gt; const &amp;fmCluHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l01230">CCTrackMaker_module.cc:1230</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a923d3f02afc879d4f8434d0f1823b0ef"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a923d3f02afc879d4f8434d0f1823b0ef">recob::Cluster::StartTick</a></div><div class="ttdeci">float StartTick() const </div><div class="ttdoc">Returns the tick coordinate of the start of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00297">Cluster.h:297</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_aebe2830d85d2b1581c31e6697132eafa"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#aebe2830d85d2b1581c31e6697132eafa">trkf::CCTrackMaker::TrkPar::TrkHits</a></div><div class="ttdeci">std::array&lt; std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt;, 3 &gt; TrkHits</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00191">CCTrackMaker_module.cc:191</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html">trkf::CCTrackMaker::TrkPar</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00188">CCTrackMaker_module.cc:188</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a6c39dd3055db6dfc084e8d09a2306007"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6c39dd3055db6dfc084e8d09a2306007">trkf::CCTrackMaker::fDebugPlane</a></div><div class="ttdeci">short fDebugPlane</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00112">CCTrackMaker_module.cc:112</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3f663d96f6fe0ad88a84fa7dd0c9fc77"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">geo::TPCGeo::LocalToWorld</a></div><div class="ttdeci">void LocalToWorld(const double *tpc, double *world) const </div><div class="ttdoc">Transform point from local TPC frame to world frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00563">TPCGeo.h:563</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a0140868168e090a8ba650173fd1ec0a1"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a0140868168e090a8ba650173fd1ec0a1">trkf::CCTrackMaker::fVertexFitAlg</a></div><div class="ttdeci">VertexFitAlg fVertexFitAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00076">CCTrackMaker_module.cc:76</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a158687c79e9387eecab5e1c7aed572ea"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a158687c79e9387eecab5e1c7aed572ea">trkf::CCTrackMaker::clPar::Time</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; Time</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00134">CCTrackMaker_module.cc:134</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1MatchPars_html_a808973bbbb7b380a8fafaddbb004cb31"><div class="ttname"><a href="../../d6/d42/structtrkf_1_1CCTrackMaker_1_1MatchPars.html#a808973bbbb7b380a8fafaddbb004cb31">trkf::CCTrackMaker::MatchPars::Chg</a></div><div class="ttdeci">std::array&lt; float, 3 &gt; Chg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00222">CCTrackMaker_module.cc:222</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a></div><div class="ttdoc">Track from a non-cascading particle.A recob::Track consists of a recob::TrackTrajectory, plus additional members relevant for a &amp;quot;fitted&amp;quot; track: </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00049">bj/lardataobj/RecoBase/Track.h:49</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1clPar_html_a157f27fcc8881e1a4b1c4bd041b4089c"><div class="ttname"><a href="../../de/df9/structtrkf_1_1CCTrackMaker_1_1clPar.html#a157f27fcc8881e1a4b1c4bd041b4089c">trkf::CCTrackMaker::clPar::Angle</a></div><div class="ttdeci">std::array&lt; float, 2 &gt; Angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00138">CCTrackMaker_module.cc:138</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1TrkPar_html_af83e4c639152365ce22daa1d25b62fbf"><div class="ttname"><a href="../../d5/dd6/structtrkf_1_1CCTrackMaker_1_1TrkPar.html#af83e4c639152365ce22daa1d25b62fbf">trkf::CCTrackMaker::TrkPar::ChgOrder</a></div><div class="ttdeci">short ChgOrder</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00197">CCTrackMaker_module.cc:197</a></div></div>
<div class="ttc" id="TPCGeo_8h_html"><div class="ttname"><a href="../../df/de9/TPCGeo_8h.html">TPCGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a23be6cc31d6cfefc28c42ecb91160a35"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a23be6cc31d6cfefc28c42ecb91160a35">trkf::CCTrackMaker::WireHitRange</a></div><div class="ttdeci">std::array&lt; std::vector&lt; std::pair&lt; int, int &gt; &gt;, 3 &gt; WireHitRange</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00126">CCTrackMaker_module.cc:126</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a06df1eaea4bf8e9c2a1e1b0d1c6dfc92"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a06df1eaea4bf8e9c2a1e1b0d1c6dfc92">trkf::CCTrackMaker::ClsChainPar::InTrack</a></div><div class="ttdeci">short InTrack</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00167">CCTrackMaker_module.cc:167</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a1175ea372739fb281f3bfbaea37d377b"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a1175ea372739fb281f3bfbaea37d377b">trkf::CCTrackMaker::vxCls</a></div><div class="ttdeci">std::array&lt; std::vector&lt; unsigned short &gt;, 3 &gt; vxCls</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00186">CCTrackMaker_module.cc:186</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1vtxPar_html_a6bd99892392bc8aa84eb7fc5195cc5fb"><div class="ttname"><a href="../../d3/d8b/structtrkf_1_1CCTrackMaker_1_1vtxPar.html#a6bd99892392bc8aa84eb7fc5195cc5fb">trkf::CCTrackMaker::vtxPar::nClusInPln</a></div><div class="ttdeci">std::array&lt; unsigned short, 3 &gt; nClusInPln</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00179">CCTrackMaker_module.cc:179</a></div></div>
<div class="ttc" id="classtrkf_1_1CCTrackMaker_html_a6e00744a4bfb6361b6c4ccc7171460e9"><div class="ttname"><a href="../../d5/d3e/classtrkf_1_1CCTrackMaker.html#a6e00744a4bfb6361b6c4ccc7171460e9">trkf::CCTrackMaker::fNVtxTrkHitsFit</a></div><div class="ttdeci">unsigned short fNVtxTrkHitsFit</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00104">CCTrackMaker_module.cc:104</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a92fe518dd038696d3e3ae0aa4b3ef3ba"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a92fe518dd038696d3e3ae0aa4b3ef3ba">recob::Cluster::Integral</a></div><div class="ttdeci">float Integral() const </div><div class="ttdoc">Returns the total charge of the cluster from hit shape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00600">Cluster.h:600</a></div></div>
<div class="ttc" id="classrecob_1_1Cluster_html_a1ec61aecd2a723775612f42f151b04bb"><div class="ttname"><a href="../../d9/dda/classrecob_1_1Cluster.html#a1ec61aecd2a723775612f42f151b04bb">recob::Cluster::EndWire</a></div><div class="ttdeci">float EndWire() const </div><div class="ttdoc">Returns the wire coordinate of the end of the cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d77/Cluster_8h_source.html#l00329">Cluster.h:329</a></div></div>
<div class="ttc" id="structtrkf_1_1CCTrackMaker_1_1ClsChainPar_html_a0f5bb9cf2d88c85762c75afbc9f75f8e"><div class="ttname"><a href="../../df/d73/structtrkf_1_1CCTrackMaker_1_1ClsChainPar.html#a0f5bb9cf2d88c85762c75afbc9f75f8e">trkf::CCTrackMaker::ClsChainPar::mBrkIndex</a></div><div class="ttdeci">std::array&lt; short, 2 &gt; mBrkIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00162">CCTrackMaker_module.cc:162</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
