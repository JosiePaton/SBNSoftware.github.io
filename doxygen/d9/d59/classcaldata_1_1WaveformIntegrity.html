<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>caldata::WaveformIntegrity Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../db/d6d/namespacecaldata.html">caldata</a></li><li class="navelem"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html">WaveformIntegrity</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dd/d01/classcaldata_1_1WaveformIntegrity-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">caldata::WaveformIntegrity Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for caldata::WaveformIntegrity:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d9/d59/classcaldata_1_1WaveformIntegrity.png" usemap="#caldata::WaveformIntegrity_map" alt=""/>
  <map id="caldata::WaveformIntegrity_map" name="caldata::WaveformIntegrity_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae4de88ca445f91ee36bb2c07e8613d7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#ae4de88ca445f91ee36bb2c07e8613d7e">WaveformIntegrity</a> (fhicl::ParameterSet const &amp;, art::ProcessingFrame const &amp;)</td></tr>
<tr class="separator:ae4de88ca445f91ee36bb2c07e8613d7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9767da767260f4febfb1248b85fc99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a1a9767da767260f4febfb1248b85fc99">produce</a> (art::Event &amp;evt, art::ProcessingFrame const &amp;) override</td></tr>
<tr class="separator:a1a9767da767260f4febfb1248b85fc99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4996063ef72d37537a17dcbd7b9e9d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#af4996063ef72d37537a17dcbd7b9e9d7">reconfigure</a> (fhicl::ParameterSet const &amp;<a class="el" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</td></tr>
<tr class="separator:af4996063ef72d37537a17dcbd7b9e9d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9334b4a176839e251ea58bcb02b0f928"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a9334b4a176839e251ea58bcb02b0f928">fixTheFreakingWaveform</a> (const std::vector&lt; float &gt; &amp;, <a class="el" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a>, std::vector&lt; float &gt; &amp;) const </td></tr>
<tr class="separator:a9334b4a176839e251ea58bcb02b0f928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b4fa849b67dd8776133275ca809c2a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a71b4fa849b67dd8776133275ca809c2a">getTruncatedRMS</a> (const std::vector&lt; float &gt; &amp;) const </td></tr>
<tr class="separator:a71b4fa849b67dd8776133275ca809c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abfce9957333144b990d5c7fa6a238983"><td class="memItemLeft" align="right" valign="top">std::vector&lt; art::InputTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">fNewRawDigitLabelVec</a></td></tr>
<tr class="memdesc:abfce9957333144b990d5c7fa6a238983"><td class="mdescLeft">&#160;</td><td class="mdescRight">New Raw Digits.  <a href="#abfce9957333144b990d5c7fa6a238983">More...</a><br/></td></tr>
<tr class="separator:abfce9957333144b990d5c7fa6a238983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc299cc157e5ae46c71fc4bc18ebadbb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; art::InputTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">fOldRawDigitLabelVec</a></td></tr>
<tr class="memdesc:abc299cc157e5ae46c71fc4bc18ebadbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">From previous run.  <a href="#abc299cc157e5ae46c71fc4bc18ebadbb">More...</a><br/></td></tr>
<tr class="separator:abc299cc157e5ae46c71fc4bc18ebadbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42fc8e87a85f2a14f25abcc840123f0c"><td class="memItemLeft" align="right" valign="top">icarus_signal_processing::WaveformTools<br class="typebreak"/>
&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a42fc8e87a85f2a14f25abcc840123f0c">fWaveformTool</a></td></tr>
<tr class="separator:a42fc8e87a85f2a14f25abcc840123f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c802b0d18fef20686293b4b83582c0"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a07c802b0d18fef20686293b4b83582c0">fGeometry</a> = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d8/df3/classgeo_1_1Geometry.html">geo::Geometry</a>&gt;()</td></tr>
<tr class="separator:a07c802b0d18fef20686293b4b83582c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1910e599641fa0c3b6db89a08fb0d902"><td class="memItemLeft" align="right" valign="top">const <br class="typebreak"/>
<a class="el" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a1910e599641fa0c3b6db89a08fb0d902">fChannelFilter</a> = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d9/d1c/classlariov_1_1ChannelStatusService.html">lariov::ChannelStatusService</a>&gt;()</td></tr>
<tr class="separator:a1910e599641fa0c3b6db89a08fb0d902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f031688492d3113b9c0a5a8a6d67b4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d4/da6/classlariov_1_1DetPedestalProvider.html">lariov::DetPedestalProvider</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#aa7f031688492d3113b9c0a5a8a6d67b4">fPedRetrievalAlg</a> = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d6/d4e/classlariov_1_1DetPedestalService.html">lariov::DetPedestalService</a>&gt;()</td></tr>
<tr class="separator:aa7f031688492d3113b9c0a5a8a6d67b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00065">65</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae4de88ca445f91ee36bb2c07e8613d7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">caldata::WaveformIntegrity::WaveformIntegrity </td>
          <td>(</td>
          <td class="paramtype">fhicl::ParameterSet const &amp;&#160;</td>
          <td class="paramname"><em>pset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">art::ProcessingFrame const &amp;&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00098">98</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                                                                                    : art::ReplicatedProducer(pset,frame)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    this-&gt;<a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#af4996063ef72d37537a17dcbd7b9e9d7">reconfigure</a>(pset);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_af4996063ef72d37537a17dcbd7b9e9d7"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#af4996063ef72d37537a17dcbd7b9e9d7">caldata::WaveformIntegrity::reconfigure</a></div><div class="ttdeci">void reconfigure(fhicl::ParameterSet const &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00104">WaveformIntegrity_module.cc:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9334b4a176839e251ea58bcb02b0f928"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float caldata::WaveformIntegrity::fixTheFreakingWaveform </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>waveform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a>&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>fixedWaveform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00219">219</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// do rms calculation - the old fashioned way and over all adc values</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    std::vector&lt;float&gt; locWaveform = waveform;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// sort in ascending order so we can truncate the sume</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::sort(locWaveform.begin(), locWaveform.end(),[](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>){<span class="keywordflow">return</span> std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>) &lt; std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>);});</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Get the mean of the waveform we&#39;re checking...</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">float</span> sumWaveform  = std::accumulate(locWaveform.begin(),locWaveform.begin() + locWaveform.size()/2, 0.);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">float</span> meanWaveform = sumWaveform / float(locWaveform.size()/2);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    std::vector&lt;float&gt; locWaveformDiff(locWaveform.size()/2);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(locWaveform.begin(),locWaveform.begin() + locWaveform.size()/2,locWaveformDiff.begin(), std::bind(std::minus&lt;float&gt;(),std::placeholders::_1,meanWaveform));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">float</span> localRMS = std::inner_product(locWaveformDiff.begin(), locWaveformDiff.end(), locWaveformDiff.begin(), 0.);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    localRMS = std::sqrt(<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">float</span>(0.),localRMS / <span class="keywordtype">float</span>(locWaveformDiff.size())));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">float</span> threshold = 6. * localRMS;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    std::vector&lt;float&gt;::iterator threshItr = std::find_if(locWaveform.begin(),locWaveform.end(),[threshold](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val){<span class="keywordflow">return</span> std::fabs(val) &gt; threshold;});</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//int minNumBins = std::max(int(fTruncRMSMinFraction * locWaveform.size()),int(std::distance(locWaveform.begin(),threshItr)));</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> minNumBins = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">int</span>(0.8 * locWaveform.size()),<span class="keywordtype">int</span>(std::distance(locWaveform.begin(),threshItr)));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// recalculate the mean</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">float</span> aveSum      = std::accumulate(locWaveform.begin(), locWaveform.begin() + minNumBins, 0.);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">float</span> newPedestal = aveSum / minNumBins;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// recalculate the rms</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    locWaveformDiff.resize(minNumBins);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(locWaveform.begin(),locWaveform.begin() + minNumBins,locWaveformDiff.begin(), std::bind(std::minus&lt;float&gt;(),std::placeholders::_1,newPedestal));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    localRMS = std::inner_product(locWaveform.begin(), locWaveform.begin() + minNumBins, locWaveform.begin(), 0.);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    localRMS = std::sqrt(<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">float</span>(0.),localRMS / <span class="keywordtype">float</span>(minNumBins)));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Set the waveform to the new baseline</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(waveform.begin(), waveform.end(), fixedWaveform.begin(), [newPedestal](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val){<span class="keywordflow">return</span> val - newPedestal;});</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> localRMS;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="ttc" id="namespaceicarus_1_1waveform__operations_1_1details_html_ae295d3f6cb2f9181dccdf0e3492d44e0"><div class="ttname"><a href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">icarus::waveform_operations::details::transform</a></div><div class="ttdeci">static constexpr Sample_t transform(Sample_t sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/WaveformOperations_8h_source.html#l00145">WaveformOperations.h:145</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a1abc6b9e279feba048394f49a85218c9"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a></div><div class="ttdeci">walls no left</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a71b4fa849b67dd8776133275ca809c2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float caldata::WaveformIntegrity::getTruncatedRMS </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>waveform</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00196">196</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// do rms calculation - the old fashioned way and over all adc values</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    std::vector&lt;float&gt; locWaveform = waveform;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// sort in ascending order so we can truncate the sume</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    std::sort(locWaveform.begin(), locWaveform.end(),[](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>){<span class="keywordflow">return</span> std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>) &lt; std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>);});</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">float</span> threshold = 10.; <span class="comment">//fTruncRMSThreshold;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    std::vector&lt;float&gt;::iterator threshItr = std::find_if(locWaveform.begin(),locWaveform.end(),[threshold](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val){<span class="keywordflow">return</span> std::fabs(val) &gt; threshold;});</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//int minNumBins = std::max(int(fTruncRMSMinFraction * locWaveform.size()),int(std::distance(locWaveform.begin(),threshItr)));</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">int</span> minNumBins = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">int</span>(0.8 * locWaveform.size()),<span class="keywordtype">int</span>(std::distance(locWaveform.begin(),threshItr)));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// Get the truncated sum</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">float</span> truncRms = std::inner_product(locWaveform.begin(), locWaveform.begin() + minNumBins, locWaveform.begin(), 0.);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    truncRms = std::sqrt(<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0.,truncRms / <span class="keywordtype">double</span>(minNumBins)));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> truncRms;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a1abc6b9e279feba048394f49a85218c9"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a></div><div class="ttdeci">walls no left</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a9767da767260f4febfb1248b85fc99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void caldata::WaveformIntegrity::produce </td>
          <td>(</td>
          <td class="paramtype">art::Event &amp;&#160;</td>
          <td class="paramname"><em>evt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">art::ProcessingFrame const &amp;&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00114">114</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// We loop over the collection of RawDigits in our input list</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// This is not done multi threaded as a way to cut down on overall job memory usage...</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">fNewRawDigitLabelVec</a>.size() != <a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">fOldRawDigitLabelVec</a>.size()) </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WaveformIntegrity not given equal size product label vectors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> prodIdx = 0; prodIdx &lt; <a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">fNewRawDigitLabelVec</a>.size(); prodIdx++)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        art::Handle&lt;std::vector&lt;raw::RawDigit&gt;&gt; newRawDigitHandle;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>.getByLabel(<a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">fNewRawDigitLabelVec</a>[prodIdx],newRawDigitHandle);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        art::Handle&lt;std::vector&lt;raw::RawDigit&gt;&gt; oldRawDigitHandle;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>.getByLabel(<a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">fOldRawDigitLabelVec</a>[prodIdx],oldRawDigitHandle);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (!newRawDigitHandle-&gt;size() || !oldRawDigitHandle-&gt;size())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WaveformIntegrity found a zero length buffer&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> chanIdx = 0; chanIdx &lt; newRawDigitHandle-&gt;size(); chanIdx++)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">// get the reference to the current raw::RawDigit</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            art::Ptr&lt;raw::RawDigit&gt; newDigitVec(newRawDigitHandle, chanIdx);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            art::Ptr&lt;raw::RawDigit&gt; oldDigitVec(oldRawDigitHandle, chanIdx);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> newChannel = newDigitVec-&gt;Channel();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> oldChannel = oldDigitVec-&gt;Channel();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">if</span> (newChannel != oldChannel)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;WaveformIntegrity finds channel mismatch, idx: &quot;</span> &lt;&lt; chanIdx &lt;&lt; <span class="stringliteral">&quot;, new channel: &quot;</span> &lt;&lt; newChannel &lt;&lt; <span class="stringliteral">&quot;, old channel: &quot;</span> &lt;&lt; oldChannel &lt;&lt; std::endl;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordtype">size_t</span> dataSize = newDigitVec-&gt;Samples();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            std::vector&lt;short&gt; newRawADC(dataSize);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            std::vector&lt;short&gt; oldRawADC(dataSize);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// uncompress the data</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="../../d9/d63/namespaceraw.html#adb44765eee4a6e600cb97fff8d7a6095">raw::Uncompress</a>(newDigitVec-&gt;ADCs(), newRawADC, newDigitVec-&gt;Compression());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="../../d9/d63/namespaceraw.html#adb44765eee4a6e600cb97fff8d7a6095">raw::Uncompress</a>(oldDigitVec-&gt;ADCs(), oldRawADC, oldDigitVec-&gt;Compression());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (newRawADC != oldRawADC)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                std::vector&lt;short&gt; diffVec;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                std::vector&lt;short&gt; idxVec;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> tickIdx = 0; tickIdx &lt; newRawADC.size(); tickIdx++)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <span class="keywordflow">if</span> (newRawADC[tickIdx] != oldRawADC[tickIdx])</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        diffVec.push_back(newRawADC[tickIdx] - oldRawADC[tickIdx]);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        idxVec.push_back(tickIdx);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="keywordtype">short</span> maxDiff = *std::max_element(diffVec.begin(),diffVec.end());</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordtype">short</span> minDiff = *std::min_element(diffVec.begin(),diffVec.end());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                std::vector&lt;geo::WireID&gt; wireIDVec = <a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a07c802b0d18fef20686293b4b83582c0">fGeometry</a>-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">ChannelToWire</a>(newChannel);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;==&gt; Channel: &quot;</span> &lt;&lt; newChannel &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; wireIDVec[0] &lt;&lt; <span class="stringliteral">&quot; - has &quot;</span> &lt;&lt; diffVec.size() &lt;&lt; <span class="stringliteral">&quot; max/min: &quot;</span> &lt;&lt; maxDiff &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; minDiff &lt;&lt; std::endl;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//                for(size_t idx = 0; diffVec.size(); idx++) std::cout &lt;&lt; idxVec[idx] &lt;&lt; &quot;/&quot; &lt;&lt; diffVec[idx] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//                std::cout &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;} <span class="comment">// produce</span></div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_a07c802b0d18fef20686293b4b83582c0"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#a07c802b0d18fef20686293b4b83582c0">caldata::WaveformIntegrity::fGeometry</a></div><div class="ttdeci">const geo::GeometryCore * fGeometry</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00089">WaveformIntegrity_module.cc:89</a></div></div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_abc299cc157e5ae46c71fc4bc18ebadbb"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">caldata::WaveformIntegrity::fOldRawDigitLabelVec</a></div><div class="ttdeci">std::vector&lt; art::InputTag &gt; fOldRawDigitLabelVec</div><div class="ttdoc">From previous run. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00085">WaveformIntegrity_module.cc:85</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0c5d3db5d5490bc3fc8fb3bbdb282f36"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">geo::GeometryCore::ChannelToWire</a></div><div class="ttdeci">std::vector&lt; geo::WireID &gt; ChannelToWire(raw::ChannelID_t const channel) const </div><div class="ttdoc">Returns a list of wires connected to the specified TPC channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01107">GeometryCore.cxx:1107</a></div></div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_abfce9957333144b990d5c7fa6a238983"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">caldata::WaveformIntegrity::fNewRawDigitLabelVec</a></div><div class="ttdeci">std::vector&lt; art::InputTag &gt; fNewRawDigitLabelVec</div><div class="ttdoc">New Raw Digits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00084">WaveformIntegrity_module.cc:84</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00007">DataStructs.cxx:7</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="namespaceraw_html_adb44765eee4a6e600cb97fff8d7a6095"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#adb44765eee4a6e600cb97fff8d7a6095">raw::Uncompress</a></div><div class="ttdeci">void Uncompress(const std::vector&lt; short &gt; &amp;adc, std::vector&lt; short &gt; &amp;uncompressed, raw::Compress_t compress)</div><div class="ttdoc">Uncompresses a raw data buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df4/raw_8cxx_source.html#l00776">raw.cxx:776</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af4996063ef72d37537a17dcbd7b9e9d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void caldata::WaveformIntegrity::reconfigure </td>
          <td>(</td>
          <td class="paramtype">fhicl::ParameterSet const &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00104">104</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Recover the parameters</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">fNewRawDigitLabelVec</a> = pset.get&lt; std::vector&lt;art::InputTag&gt;&gt; (<span class="stringliteral">&quot;NewRawDigitLabelVec&quot;</span>, {<span class="stringliteral">&quot;daqTPC&quot;</span>});</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">fOldRawDigitLabelVec</a> = pset.get&lt; std::vector&lt;art::InputTag&gt;&gt; (<span class="stringliteral">&quot;OldRawDigitLabelVec&quot;</span>, {<span class="stringliteral">&quot;daqTPC&quot;</span>});</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_abc299cc157e5ae46c71fc4bc18ebadbb"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abc299cc157e5ae46c71fc4bc18ebadbb">caldata::WaveformIntegrity::fOldRawDigitLabelVec</a></div><div class="ttdeci">std::vector&lt; art::InputTag &gt; fOldRawDigitLabelVec</div><div class="ttdoc">From previous run. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00085">WaveformIntegrity_module.cc:85</a></div></div>
<div class="ttc" id="classcaldata_1_1WaveformIntegrity_html_abfce9957333144b990d5c7fa6a238983"><div class="ttname"><a href="../../d9/d59/classcaldata_1_1WaveformIntegrity.html#abfce9957333144b990d5c7fa6a238983">caldata::WaveformIntegrity::fNewRawDigitLabelVec</a></div><div class="ttdeci">std::vector&lt; art::InputTag &gt; fNewRawDigitLabelVec</div><div class="ttdoc">New Raw Digits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00084">WaveformIntegrity_module.cc:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a1910e599641fa0c3b6db89a08fb0d902"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a>* caldata::WaveformIntegrity::fChannelFilter = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d9/d1c/classlariov_1_1ChannelStatusService.html">lariov::ChannelStatusService</a>&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00090">90</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a07c802b0d18fef20686293b4b83582c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a>* caldata::WaveformIntegrity::fGeometry = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d8/df3/classgeo_1_1Geometry.html">geo::Geometry</a>&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00089">89</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abfce9957333144b990d5c7fa6a238983"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;art::InputTag&gt; caldata::WaveformIntegrity::fNewRawDigitLabelVec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>New Raw Digits. </p>

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00084">84</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abc299cc157e5ae46c71fc4bc18ebadbb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;art::InputTag&gt; caldata::WaveformIntegrity::fOldRawDigitLabelVec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>From previous run. </p>

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00085">85</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa7f031688492d3113b9c0a5a8a6d67b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d4/da6/classlariov_1_1DetPedestalProvider.html">lariov::DetPedestalProvider</a>* caldata::WaveformIntegrity::fPedRetrievalAlg = <a class="el" href="../../d7/d0b/namespacelar.html#a4f0075a9ded49ca69dbd4d16db9c1edd">lar::providerFrom</a>&lt;<a class="el" href="../../d6/d4e/classlariov_1_1DetPedestalService.html">lariov::DetPedestalService</a>&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00091">91</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a42fc8e87a85f2a14f25abcc840123f0c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">icarus_signal_processing::WaveformTools&lt;float&gt; caldata::WaveformIntegrity::fWaveformTool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html#l00087">87</a> of file <a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../d8/dd6/WaveformIntegrity__module_8cc_source.html">WaveformIntegrity_module.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
