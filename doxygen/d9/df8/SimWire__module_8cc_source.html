<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>SimWire_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_c1de2b5dcb01608846a246cb763d5e03.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_64cfb79233dad4b4de390a7389ba145b.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_1d034eb268bf7fb6edfcdc1393cd6ea9.html">DetSim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimWire_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/df8/SimWire__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// SimWire class designed to simulate signal on a wire in the TPC</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// katori@fnal.gov</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// - Revised to use sim::RawDigit instead of rawdata::RawDigit, and to</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// - save the electron clusters associated with each digit.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// mwang@fnal.gov (2/04/21)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// - Revised field response functions with quadratic and sinusoidal for</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//   collection and induction planes, respectively</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// - Updated electronics response with uBooNE spice-based model</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// - Included more realistic noise models:</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//   (a) modified uBooNE model -&gt; &quot;ModUBooNE&quot; in fcl</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//   (b) ArgoNeuT data driven model -&gt; &quot;ArgoNeuT&quot; in fcl</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// - Included following distributions for fluctuating magnitude of</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//   noise frequency components:</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//   (a) simple modified Poisson -&gt; &quot;SimplePoisson&quot; in fcl</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//   (b) weighted Poisson from ArgoNeuT DDN -&gt; &quot;WeightedPoisson&quot; in fcl</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// - Included choice for generating unique noise in each channel for</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//   each event</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// - Updated ConvoluteResponseFunctions() to do things in same fashion</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//   as in a typical SignalShapingXXX service for a particular XXX</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//   experiment</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// ROOT includes</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;TComplex.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;TMath.h&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// C++ includes</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// Framework includes</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;art_root_io/TFileService.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;cetlib/search_path.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// art extensions</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;nurandom/RandomUtils/NuRandomService.h&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;CLHEP/Random/RandFlat.h&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// LArSoft includes</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d80/PlaneGeo_8h.html">larcorealg/Geometry/PlaneGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dba/DetectorClocksService_8h.html">lardata/DetectorInfoServices/DetectorClocksService.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d33/LArFFT_8h.html">lardata/Utilities/LArFFT.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d5a/RawDigit_8h.html">lardataobj/RawData/RawDigit.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/df4/raw_8h.html">lardataobj/RawData/raw.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/dde/SimChannel_8h.html">lardataobj/Simulation/SimChannel.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// Detector simulation of raw signals on wires</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">namespace </span>detsim {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html">   66</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html">SimWire</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a47b2e428d62ac81b4b7a909ddd476073">SimWire</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac9f60575d6e33c8e5eff3bf81e25de51">produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2cc113144c45c211db2280336c6bbccb">beginJob</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a466a648804ededad9d464b67cdf2d8f8">ConvoluteResponseFunctions</a>(); <span class="comment">///&lt; convolute electronics and field response</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae7d6d9e899e167bc0da3f2396edc238b">SetFieldResponse</a>(); <span class="comment">///&lt; response of wires to field</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a680afe9358f2b618fe1d08d86e13ba0d">SetElectResponse</a>(); <span class="comment">///&lt; response of electronics</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">GenNoise</a>(std::vector&lt;float&gt;&amp; <a class="code" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">array</a>, CLHEP::HepRandomEngine&amp; engine);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a7a653c5f53003d7e71f1f075a681b91b">   81</a></span>&#160;    std::string <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a7a653c5f53003d7e71f1f075a681b91b">fDriftEModuleLabel</a>; <span class="comment">///&lt; module making the ionization electrons</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#af354217147307be2d7e66789d07d88c4">   82</a></span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/d63/namespaceraw.html#a5cccb6911a757c829a5ed5c61ad85a21">raw::Compress_t</a> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af354217147307be2d7e66789d07d88c4">fCompression</a>;   <span class="comment">///&lt; compression type to use</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">   84</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>;                         <span class="comment">///&lt; number of ticks of the clock</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a8681181612fc002504b624053a906aa8">   85</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8681181612fc002504b624053a906aa8">fSampleRate</a>;                  <span class="comment">///&lt; sampling rate in ns</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a8d665f5a906a1b6d8a64bbc46554c29d">   86</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8d665f5a906a1b6d8a64bbc46554c29d">fNSamplesReadout</a>;       <span class="comment">///&lt; number of ADC readout samples in 1 readout frame</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a75a03e732db4a45023fc227bd4c8fd90">   87</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a75a03e732db4a45023fc227bd4c8fd90">fCol3DCorrection</a>;             <span class="comment">///&lt; correction factor to account for 3D path of</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span><span class="comment">                                         ///&lt; electrons thru wires</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aa0ea9ac3eb629f559ed72f48e0130cd1">   89</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa0ea9ac3eb629f559ed72f48e0130cd1">fInd3DCorrection</a>;             <span class="comment">///&lt; correction factor to account for 3D path of</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span><span class="comment">                                         ///&lt; electrons thru wires</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">   91</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">fNElectResp</a>;            <span class="comment">///&lt; number of entries from response to use</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aab5fea718b5e679a58b050bf939bfeed">   92</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab5fea718b5e679a58b050bf939bfeed">fInputFieldRespSamplingPeriod</a>; <span class="comment">///&lt; Sampling period in the input field response.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#addd821657d78177b01d8183749b0dc33">   93</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#addd821657d78177b01d8183749b0dc33">fShapeTimeConst</a>;               <span class="comment">///&lt; time constants for exponential shaping</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a6d43d1ce26cb22cde893bd07007d4c0e">   94</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a6d43d1ce26cb22cde893bd07007d4c0e">fADCPerPCAtLowestASICGain</a>;     <span class="comment">///&lt; ADCs/pC at lowest gain setting of 4.7 mV/fC</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a7e2db4120c20af6641f290ff9b632f49">   95</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a7e2db4120c20af6641f290ff9b632f49">fASICGainInMVPerFC</a>;            <span class="comment">///&lt; actual gain setting used in mV/fC </span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">   96</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>;                   <span class="comment">///&lt; number of noise channels to generate</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">   97</a></span>&#160;<span class="comment"></span>    std::string <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">fNoiseModelChoice</a>;        <span class="comment">///&lt; choice for noise model</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">   98</a></span>&#160;<span class="comment"></span>    std::string <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">fNoiseFluctChoice</a>;        <span class="comment">///&lt; choice for noise freq component mag fluctuations</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a12b5cf08b01eef202b66b83493cec775">  100</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a12b5cf08b01eef202b66b83493cec775">fFieldRespTOffset</a>;   <span class="comment">///&lt; field response time offset in ticks</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ae8be51c83e40d2b3de7396df2369a51d">  101</a></span>&#160;<span class="comment"></span>    std::vector&lt;int&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae8be51c83e40d2b3de7396df2369a51d">fCalibRespTOffset</a>;   <span class="comment">///&lt; calib response time offset in ticks</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a93d824fb535f62f8da351b22a1fc506a">  102</a></span>&#160;<span class="comment"></span>    std::vector&lt;float&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a93d824fb535f62f8da351b22a1fc506a">fColFieldParams</a>;   <span class="comment">///&lt; collection plane field function parameterization</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">  103</a></span>&#160;<span class="comment"></span>    std::vector&lt;float&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">fIndFieldParams</a>;   <span class="comment">///&lt; induction plane field function parameterization</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">  104</a></span>&#160;<span class="comment"></span>    std::vector&lt;double&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>; <span class="comment">///&lt; response function for the field @ collection plane</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">  105</a></span>&#160;<span class="comment"></span>    std::vector&lt;double&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>; <span class="comment">///&lt; response function for the field @ induction plane</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">  106</a></span>&#160;<span class="comment"></span>    std::vector&lt;TComplex&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>;       <span class="comment">///&lt; response function for the field @ collection plane</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">  107</a></span>&#160;<span class="comment"></span>    std::vector&lt;TComplex&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>;       <span class="comment">///&lt; response function for the field @ induction plane</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">  108</a></span>&#160;<span class="comment"></span>    std::vector&lt;double&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>;    <span class="comment">///&lt; response function for the electronics</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">  109</a></span>&#160;<span class="comment"></span>    std::vector&lt;std::vector&lt;float&gt;&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>; <span class="comment">///&lt; noise on each channel for each time</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">  110</a></span>&#160;<span class="comment"></span>    std::vector&lt;double&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>;     <span class="comment">///&lt; noise model params</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">  111</a></span>&#160;<span class="comment"></span>    std::vector&lt;double&gt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">fNoiseFluctPar</a>;     <span class="comment">///&lt; Poisson noise fluctuations params</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">  113</a></span>&#160;    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">fIndFieldResp</a>; <span class="comment">///&lt; response function for the field @ induction plane</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a0bd44844ad3bf1ba52c50d0d1d83188f">  114</a></span>&#160;<span class="comment"></span>    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a0bd44844ad3bf1ba52c50d0d1d83188f">fColFieldResp</a>; <span class="comment">///&lt; response function for the field @ collection plane</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">  115</a></span>&#160;<span class="comment"></span>    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">fElectResp</a>;    <span class="comment">///&lt; response function for the electronics</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">  116</a></span>&#160;<span class="comment"></span>    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">fColTimeShape</a>; <span class="comment">///&lt; convoluted shape for field x electronics @ col plane</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#aed063e449bbb1a01ee96e63d4db4355b">  117</a></span>&#160;<span class="comment"></span>    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aed063e449bbb1a01ee96e63d4db4355b">fIndTimeShape</a>; <span class="comment">///&lt; convoluted shape for field x electronics @ ind plane</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a8007a4fd69af64a57c94941b45a3116e">  118</a></span>&#160;<span class="comment"></span>    TH1D* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8007a4fd69af64a57c94941b45a3116e">fNoiseDist</a>;    <span class="comment">///&lt; distribution of noise counts</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">  119</a></span>&#160;<span class="comment"></span>    TF1* <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a>;    <span class="comment">///&lt; Poisson dist for fluctuations in magnitude of noise freq components</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">  121</a></span>&#160;    CLHEP::HepRandomEngine&amp; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">fEngine</a>; <span class="comment">///&lt; Random-number engine owned by art</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span>  }; <span class="comment">// class SimWire</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">namespace </span>detsim {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a47b2e428d62ac81b4b7a909ddd476073">  129</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a47b2e428d62ac81b4b7a909ddd476073">SimWire::SimWire</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    : EDProducer{pset}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    , fDriftEModuleLabel{pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;DriftEModuleLabel&quot;</span>)}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    , <a class="code" href="../../d2/d1a/namespacedetsim.html#a1694416336c9bd0bab8a3ded1795ccae">fCompression</a>{pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;CompressionType&quot;</span>) == <span class="stringliteral">&quot;Huffman&quot;</span> ? <a class="code" href="../../d9/d63/namespaceraw.html#a75392ac34cff2e6c998dcc1cb35670c4a91cda9f28ca81dc8c31f9618b50f3e6c">raw::kHuffman</a> :</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                                           <a class="code" href="../../d9/d63/namespaceraw.html#a75392ac34cff2e6c998dcc1cb35670c4a76fb4ec9d88a77500a556aab12c35703">raw::kNone</a>}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    , fCol3DCorrection{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;Col3DCorrection&quot;</span>)}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    , fInd3DCorrection{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;Ind3DCorrection&quot;</span>)}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    , fInputFieldRespSamplingPeriod{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;InputFieldRespSamplingPeriod&quot;</span>)}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    , fShapeTimeConst{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ShapeTimeConst&quot;</span>)}</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    , fADCPerPCAtLowestASICGain{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ADCPerPCAtLowestASICGain&quot;</span>)}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    , fASICGainInMVPerFC{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ASICGainInMVPerFC&quot;</span>)}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    , fNoiseNchToSim{pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NoiseNchToSim&quot;</span>)}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    , fNoiseModelChoice{pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;NoiseModelChoice&quot;</span>)}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    , fNoiseFluctChoice{pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;NoiseFluctChoice&quot;</span>)}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    , fFieldRespTOffset{pset.get&lt;std::vector&lt;int&gt;&gt;(<span class="stringliteral">&quot;FieldRespTOffset&quot;</span>)}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    , fCalibRespTOffset{pset.get&lt;std::vector&lt;int&gt;&gt;(<span class="stringliteral">&quot;CalibRespTOffset&quot;</span>)}</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    , fColFieldParams{pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;ColFieldParams&quot;</span>)}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    , fIndFieldParams{pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;IndFieldParams&quot;</span>)}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    , fNoiseModelPar{pset.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;NoiseModelPar&quot;</span>)}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    , fNoiseFluctPar{pset.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;NoiseFluctPar&quot;</span>)}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// create a default random engine; obtain the random seed from NuRandomService,</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// unless overridden in configuration with key &quot;Seed&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    , <a class="code" href="../../d4/d4d/namespaceevgen.html#ac64ce9233583b081586d153cc2f2056b">fEngine</a>(art::ServiceHandle&lt;rndm::NuRandomService&gt; {}-&gt;createEngine(*<span class="keyword">this</span>, pset, <span class="stringliteral">&quot;Seed&quot;</span>))</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d2/d1a/namespacedetsim.html#a24f2cd7262ab68b7731b94f7daabc56a">  152</a></span>&#160;  {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> clockData = art::ServiceHandle&lt;detinfo::DetectorClocksService const&gt;()-&gt;DataForJob();</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">  154</a></span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a> =</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      art::ServiceHandle&lt;detinfo::DetectorPropertiesService const&gt;()-&gt;DataForJob(clockData);</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../d2/d1a/namespacedetsim.html#a4a36ea620146245a8999b4710108c08c">  156</a></span>&#160;    <a class="code" href="../../d2/d1a/namespacedetsim.html#a4a36ea620146245a8999b4710108c08c">fSampleRate</a> = <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData);</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../d2/d1a/namespacedetsim.html#ae342ea79321ce8ab83dec41dba06434e">  157</a></span>&#160;    <a class="code" href="../../d2/d1a/namespacedetsim.html#ae342ea79321ce8ab83dec41dba06434e">fNSamplesReadout</a> = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>.NumberTimeSamples();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">MF_LOG_WARNING</a>(<span class="stringliteral">&quot;SimWire&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;SimWire is an example module that works for the &quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;MicroBooNE detector.  Each experiment should implement &quot;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;its own version of this module to simulate electronics &quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;response.&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    produces&lt;std::vector&lt;raw::RawDigit&gt;&gt;();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a2cc113144c45c211db2280336c6bbccb">  169</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2cc113144c45c211db2280336c6bbccb">SimWire::beginJob</a>()</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// ... get access to the TFile service</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8007a4fd69af64a57c94941b45a3116e">fNoiseDist</a> = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;Noise&quot;</span>, <span class="stringliteral">&quot;;Noise (ADC);&quot;</span>, 1000, -10., 10.);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    art::ServiceHandle&lt;util::LArFFT const&gt; fFFT;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a> = fFFT-&gt;FFTSize();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// ... Poisson dist function for fluctuating magnitude of noise frequency component</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">fNoiseFluctChoice</a> == <span class="stringliteral">&quot;SimplePoisson&quot;</span> ) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// .. simple modified Poisson with (x-1)! in denominator</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">double</span> params[1];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a> = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;_poisson&quot;</span>, <span class="stringliteral">&quot;[0]**(x) * exp(-[0]) / ROOT::Math::tgamma(x)&quot;</span>, 0, 5.);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      params[0] = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">fNoiseFluctPar</a>[0];  <span class="comment">// Poisson mean</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a>-&gt;SetParameters(params);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">fNoiseFluctChoice</a> == <span class="stringliteral">&quot;WeightedPoisson&quot;</span> ) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// .. weighted Poisson in ArgoNeuT DDN model</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">double</span> params[3];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a> = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;_poisson&quot;</span>, <span class="stringliteral">&quot;[0]*pow([1]/[2], x/[2])*exp(-[1]/[2])/ROOT::Math::tgamma(x/[2]+1.)&quot;</span>, 0, 5.);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      params[0] = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">fNoiseFluctPar</a>[0];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      params[1] = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">fNoiseFluctPar</a>[1];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      params[2] = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">fNoiseFluctPar</a>[2];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a>-&gt;SetParameters(params);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SimWire::beginJob&quot;</span>) &lt;&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">fNoiseFluctChoice</a></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; is an unknown noise fluctuation choice&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// ... generate the noise in advance depending on value of fNoiseNchToSim:</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">//     positive - generate N=fNoiseNchToSim channels &amp; randomly pick from pool when adding to signal</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//     zero     - no noise</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">//     negative - generate unique noise for each channel for each event</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>&gt;0) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>&gt;10000) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SimWire::beginJob&quot;</span>) &lt;&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; noise channels requested exceeds 10000&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>.size(); ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">GenNoise</a>(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>], <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">fEngine</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>; ++i) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8007a4fd69af64a57c94941b45a3116e">fNoiseDist</a>-&gt;Fill(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>[p][i]);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// ... set field response and electronics response, then convolute them</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae7d6d9e899e167bc0da3f2396edc238b">SetFieldResponse</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a680afe9358f2b618fe1d08d86e13ba0d">SetElectResponse</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a466a648804ededad9d464b67cdf2d8f8">ConvoluteResponseFunctions</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ac9f60575d6e33c8e5eff3bf81e25de51">  226</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac9f60575d6e33c8e5eff3bf81e25de51">SimWire::produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// ... generate unique noise for each channel in each event</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>&lt;0) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>.clear();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>.resize(geo-&gt;Nchannels());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; geo-&gt;Nchannels(); ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>){</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">GenNoise</a>(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>], <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">fEngine</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// ... make a vector of const sim::SimChannel* that has same number</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//     of entries as the number of channels in the detector</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">//     and set the entries for the channels that have signal on them</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//     using the chanHandle</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    std::vector&lt;const sim::SimChannel*&gt; chanHandle;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    evt.getView(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a7a653c5f53003d7e71f1f075a681b91b">fDriftEModuleLabel</a>,chanHandle);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    std::vector&lt;const sim::SimChannel*&gt; channels(geo-&gt;Nchannels());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> c = 0; c &lt; chanHandle.size(); ++c){</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      channels[chanHandle[c]-&gt;Channel()] = chanHandle[c];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// ... make an unique_ptr of sim::SimDigits that allows ownership of the produced</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//     digits to be transferred to the art::Event after the put statement below</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">auto</span> digcol = std::make_unique&lt;std::vector&lt;raw::RawDigit&gt;&gt;();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    art::ServiceHandle&lt;util::LArFFT&gt; fFFT;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// ... Add all channels</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    CLHEP::RandFlat flat(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">fEngine</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    std::map&lt;int,double&gt;::iterator mapIter;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan = 0; chan &lt; geo-&gt;Nchannels(); chan++) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      std::vector&lt;short&gt; adcvec(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      std::vector&lt;double&gt; fChargeWork(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span>( channels[chan] ){</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// .. get the sim::SimChannel for this channel</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a>* sc = channels[chan];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// .. loop over the tdcs and grab the number of electrons for each</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t = 0; t &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>; ++t)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          fChargeWork[t] = sc-&gt;<a class="code" href="../../d0/daf/classsim_1_1SimChannel.html#a7f0a222d6c3b11979cac01aab1245a53">Charge</a>(t);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">int</span> time_offset = 0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// .. Convolve charge with appropriate response function</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span>(geo-&gt;SignalType(chan) == <a class="code" href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8">geo::kInduction</a>){</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          fFFT-&gt;Convolute(fChargeWork,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          time_offset = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a12b5cf08b01eef202b66b83493cec775">fFieldRespTOffset</a>[1]+<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae8be51c83e40d2b3de7396df2369a51d">fCalibRespTOffset</a>[1];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          fFFT-&gt;Convolute(fChargeWork,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          time_offset = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a12b5cf08b01eef202b66b83493cec775">fFieldRespTOffset</a>[0]+<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae8be51c83e40d2b3de7396df2369a51d">fCalibRespTOffset</a>[0];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// .. Apply field response offset</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        std::vector&lt;int&gt; temp;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span> (time_offset &lt;=0){</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          temp.assign(fChargeWork.begin(),fChargeWork.begin()-time_offset);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          fChargeWork.erase(fChargeWork.begin(),fChargeWork.begin()-time_offset);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          fChargeWork.insert(fChargeWork.end(),temp.begin(),temp.end());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          temp.assign(fChargeWork.end()-time_offset,fChargeWork.end());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          fChargeWork.erase(fChargeWork.end()-time_offset,fChargeWork.end());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          fChargeWork.insert(fChargeWork.begin(),temp.begin(),temp.end());</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// ... Add noise to signal depending on value of fNoiseNchToSim</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>!=0){</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordtype">int</span> noisechan = chan;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">fNoiseNchToSim</a>&gt;0){</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          noisechan = TMath::Nint(flat.fire()*(1.*(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>.size()-1)+0.1));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>; ++i){</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          adcvec[i] = (short)TMath::Nint(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">fNoise</a>[noisechan][i] + fChargeWork[i]);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>; ++i){</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          adcvec[i] = (short)TMath::Nint(fChargeWork[i]);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      adcvec.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8d665f5a906a1b6d8a64bbc46554c29d">fNSamplesReadout</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">// ... compress the adc vector using the desired compression scheme,</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">//     if raw::kNone is selected nothing happens to adcvec</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">//     This shrinks adcvec, if fCompression is not kNone.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="../../d9/d63/namespaceraw.html#a24a5165586cd3126a6ae7e80ee82ae4d">raw::Compress</a>(adcvec, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af354217147307be2d7e66789d07d88c4">fCompression</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">// ... add this digit to the collection</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      digcol-&gt;emplace_back(chan, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, move(adcvec), <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af354217147307be2d7e66789d07d88c4">fCompression</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }<span class="comment">//end loop over channels</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    evt.put(std::move(digcol));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a466a648804ededad9d464b67cdf2d8f8">  335</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a466a648804ededad9d464b67cdf2d8f8">SimWire::ConvoluteResponseFunctions</a>()</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>, <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a10eae1fb7996a75ca0c4c7c78e05874a">ticks</a>, peak;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    std::vector&lt;double&gt; col(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    std::vector&lt;double&gt; ind(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    std::vector&lt;TComplex&gt; kern(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2 + 1);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    std::vector&lt;double&gt; delta(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    art::ServiceHandle&lt;util::LArFFT&gt; fFFT;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// ... do collection plane</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2+1);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    fFFT-&gt;DoFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    fFFT-&gt;DoFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>, kern);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;kern.size(); ++i)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>[i] *= kern[i];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    fFFT-&gt;DoInvFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>, col);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    delta[0] = 1.0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    peak = fFFT-&gt;PeakCorrelation(delta, col);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    tick = 0.;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    ticks =  tick - peak;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    fFFT-&gt;ShiftData(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>, ticks);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    fFFT-&gt;DoInvFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">fColShape</a>, col);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// ... do induction plane</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2+1);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    fFFT-&gt;DoFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    kern.clear();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    kern.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2 + 1);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    fFFT-&gt;DoFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>, kern);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;kern.size(); ++i)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>[i] *= kern[i];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    fFFT-&gt;DoInvFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>, ind);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    delta.resize(0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    delta.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    delta[0] = 1.0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    peak = fFFT-&gt;PeakCorrelation(delta, ind);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    tick = 0.;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ticks =  tick - peak;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    fFFT-&gt;ShiftData(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>, ticks);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    fFFT-&gt;DoInvFFT(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">fIndShape</a>, ind);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// ... write the time-domain shapes out to a file</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">fColTimeShape</a> = tfs-&gt;make&lt;TH1D&gt;(</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="stringliteral">&quot;ConvolutedCollection&quot;</span>,<span class="stringliteral">&quot;;ticks; Electronics#timesCollection&quot;</span>,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aed063e449bbb1a01ee96e63d4db4355b">fIndTimeShape</a> = tfs-&gt;make&lt;TH1D&gt;(</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="stringliteral">&quot;ConvolutedInduction&quot;</span>,<span class="stringliteral">&quot;;ticks; Electronics#timesInduction&quot;</span>,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// ... check that you did the right thing</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ind.size(); ++i){</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">fColTimeShape</a>-&gt;Fill(i, col[i]);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      fIndTimeShape-&gt;Fill(i, ind[i]);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">fColTimeShape</a>-&gt;Write();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    fIndTimeShape-&gt;Write();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">  404</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">SimWire::GenNoise</a>(std::vector&lt;float&gt;&amp; noise, CLHEP::HepRandomEngine&amp; engine)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    CLHEP::RandFlat flat(engine);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    noise.clear();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    noise.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    std::vector&lt;TComplex&gt; noiseFrequency(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2+1, 0.); <span class="comment">// noise in frequency space</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">double</span> pval = 0.;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">double</span> phase = 0.;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">double</span> rnd[2] = {0.};</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// .. width of frequencyBin in kHz</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">double</span> binWidth = 1.0/(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>*<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a8681181612fc002504b624053a906aa8">fSampleRate</a>*1.0e-6);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>/2+1; ++i) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>=(i+0.5)*binWidth;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">fNoiseModelChoice</a> == <span class="stringliteral">&quot;Legacy&quot;</span> ) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// ... Legacy exponential model kept here for reference:</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">//     par[0]=NoiseFact, par[1]=NoiseWidth, par[2]=LowCutoff, par[3-7]=0</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">//     example parameter values for fcl: NoiseModelPar:[ 1.32e-1,120,7.5,0,0,0,0,0 ]</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        pval = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[0] * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-(<span class="keywordtype">double</span>)i * binWidth / <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[1]);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">double</span> lofilter = 1.0 / (1.0 + <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-(i - <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[2] / binWidth) / 0.5));</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        flat.fireArray(1, rnd, 0, 1);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        pval *= lofilter * (0.9 + 0.2 * rnd[0]);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">fNoiseModelChoice</a> == <span class="stringliteral">&quot;ModUBooNE&quot;</span> ) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// ... Modified uBooNE model with additive exp to account for low freq region:</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">//     example parameter values for fcl: NoiseModelPar:[</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">//                                         4450.,-530.,280.,110.,</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">//                                         -0.85,18.,0.064,74. ]</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        pval = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[0]*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5*pow((x-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[1])/<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[2],2))</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                         *<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5*pow(x/<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[3],<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[4]))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                         +<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[5]+<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[6]*(x-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[7]));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordtype">double</span> randomizer = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a>-&gt;GetRandom();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        pval = pval * randomizer/<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">fNoiseModelChoice</a> == <span class="stringliteral">&quot;ArgoNeuT&quot;</span> ) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// ... ArgoNeuT data driven model:</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">//     In fcl set parameters to: NoiseModelPar:[</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">//                                 5000,-5.52058e2,2.81587e2,-5.66561e1,</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//                                 4.10817e1,1.76284e1,1e-1,5.97838e1 ]</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        pval = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[0]*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5*pow((x-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[1])/<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[2],2))</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                         *((<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[3]/(x+<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[4]))+1)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                         +<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[5]+<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[6]*(x-<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">fNoiseModelPar</a>[7]));</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordtype">double</span> randomizer = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">fNoiseFluct</a>-&gt;GetRandom();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        pval = pval * randomizer/<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;SimWire::GenNoise&quot;</span>) &lt;&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">fNoiseModelChoice</a></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; is an unknown choice for the noise model&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      flat.fireArray(1,rnd,0,1);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      phase = rnd[0]*2.*TMath::Pi();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      TComplex tc(pval*cos(phase),pval*sin(phase));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      noiseFrequency[i] += tc;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// .. inverse FFT MCSignal</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    art::ServiceHandle&lt;util::LArFFT&gt; fFFT;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    fFFT-&gt;DoInvFFT(noiseFrequency, noise);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    noiseFrequency.clear();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// .. multiply each noise value by fNTicks as the InvFFT</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//    divides each bin by fNTicks assuming that a forward FFT</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//    has already been done.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; noise.size(); ++i)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      noise[i] *= 1. * <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#ae7d6d9e899e167bc0da3f2396edc238b">  478</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae7d6d9e899e167bc0da3f2396edc238b">SimWire::SetFieldResponse</a>()</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// ... Files to write the response functions to</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">fIndFieldResp</a> = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;InductionFieldResponse&quot;</span>,<span class="stringliteral">&quot;;t (ns);Induction Response&quot;</span>,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a0bd44844ad3bf1ba52c50d0d1d83188f">fColFieldResp</a> = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;CollectionFieldResponse&quot;</span>,<span class="stringliteral">&quot;;t (ns);Collection Response&quot;</span>,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>.resize(fNTicks, 0.);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>.resize(fNTicks, 0.);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// ... First set response for collection plane</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">int</span> nbinc = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a93d824fb535f62f8da351b22a1fc506a">fColFieldParams</a>[0];</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">double</span> integral = 0.;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nbinc; ++i) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>[i] = i * i;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      integral += <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>[i];</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbinc; ++i) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>[i] *= <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a93d824fb535f62f8da351b22a1fc506a">fColFieldParams</a>[1]/integral;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      fColFieldResp-&gt;Fill(i, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">fColFieldResponse</a>[i]);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// ... Now set response for induction plane</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">int</span> nbini = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">fIndFieldParams</a>[0];</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lastbini = 2 * nbini;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    integral = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; lastbini; ++i) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordtype">double</span> ang = i * TMath::Pi() / nbini;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i] = sin(ang);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i] &gt; 0) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        integral += <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i] *= <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">fIndFieldParams</a>[2]; <span class="comment">// scale the negative lobe by 10% (from ArgoNeuT)</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    ++lastbini;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; lastbini; ++i) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i] *= <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">fIndFieldParams</a>[1]/integral;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">fIndFieldResp</a>-&gt;Fill(i, <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">fIndFieldResponse</a>[i]);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// ... Save the field responses</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    fColFieldResp-&gt;Write();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">fIndFieldResp</a>-&gt;Write();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="../../d8/de6/classdetsim_1_1SimWire.html#a680afe9358f2b618fe1d08d86e13ba0d">  531</a></span>&#160;  <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a680afe9358f2b618fe1d08d86e13ba0d">SimWire::SetElectResponse</a>()</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>.resize(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>, 0.);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    std::vector&lt;double&gt; time(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>,0.);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// ... Gain and shaping time variables from fcl file:    </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">double</span> Ao = 1.0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">double</span> To = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#addd821657d78177b01d8183749b0dc33">fShapeTimeConst</a>;  <span class="comment">//peaking time</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// ... this is actually sampling time, in ns</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;SimWire::SetElectResponse&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Check sampling intervals: &quot;</span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                             &lt;&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab5fea718b5e679a58b050bf939bfeed">fInputFieldRespSamplingPeriod</a> &lt;&lt; <span class="stringliteral">&quot; ns&quot;</span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                             &lt;&lt; <span class="stringliteral">&quot;Check number of samples: &quot;</span> &lt;&lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">fNTicks</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// ... The following sets the microboone electronics response function in </span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">//     time-space. Function comes from BNL SPICE simulation of DUNE35t </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">//     electronics. SPICE gives the electronics transfer function in </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">//     frequency-space. The inverse laplace transform of that function </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">//     (in time-space) was calculated in Mathematica and is what is being </span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">//     used below. Parameters Ao and To are cumulative gain/timing parameters </span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">//     from the full (ASIC-&gt;Intermediate amp-&gt;Receiver-&gt;ADC) electronics chain. </span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">//     They have been adjusted to make the SPICE simulation to match the </span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//     actual electronics response. Default params are Ao=1.4, To=0.5us. </span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a> = 0;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>.size(); ++i) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="comment">// ... convert time to microseconds, to match fElectResponse[i] definition</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      time[i] = (1.*i)*<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aab5fea718b5e679a58b050bf939bfeed">fInputFieldRespSamplingPeriod</a> *1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-3; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>[i] = </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        4.31054*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.94809*time[i]/To)*Ao - 2.6202*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*cos(1.19361*time[i]/To)*Ao</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        -2.6202*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*cos(1.19361*time[i]/To)*cos(2.38722*time[i]/To)*Ao</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        +0.464924*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*cos(2.5928*time[i]/To)*Ao</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        +0.464924*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*cos(2.5928*time[i]/To)*cos(5.18561*time[i]/To)*Ao</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        +0.762456*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*sin(1.19361*time[i]/To)*Ao</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        -0.762456*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*cos(2.38722*time[i]/To)*sin(1.19361*time[i]/To)*Ao</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        +0.762456*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*cos(1.19361*time[i]/To)*sin(2.38722*time[i]/To)*Ao</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        -2.6202*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.82833*time[i]/To)*sin(1.19361*time[i]/To)*sin(2.38722*time[i]/To)*Ao </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        -0.327684*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*sin(2.5928*time[i]/To)*Ao + </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        +0.327684*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*cos(5.18561*time[i]/To)*sin(2.5928*time[i]/To)*Ao</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        -0.327684*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*cos(2.5928*time[i]/To)*sin(5.18561*time[i]/To)*Ao</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        +0.464924*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-2.40318*time[i]/To)*sin(2.5928*time[i]/To)*sin(5.18561*time[i]/To)*Ao;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>[i] &gt; max) max = <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>[i];</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }<span class="comment">// end loop over time buckets</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// ... &quot;normalize&quot; fElectResponse[i], before the convolution   </span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ae5523f84c7884451cef6ac6241de2b91">element</a> : <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">fElectResponse</a>) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ae5523f84c7884451cef6ac6241de2b91">element</a> /= <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ae5523f84c7884451cef6ac6241de2b91">element</a> *= <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a6d43d1ce26cb22cde893bd07007d4c0e">fADCPerPCAtLowestASICGain</a> * 1.60217657e-7;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ae5523f84c7884451cef6ac6241de2b91">element</a> *= <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#a7e2db4120c20af6641f290ff9b632f49">fASICGainInMVPerFC</a> / 4.7; <span class="comment">// relative to lowest gain setting of 4.7 mV/fC</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">fNElectResp</a> = fElectResponse.size();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// ... write the response out to a file</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">fElectResp</a> = tfs-&gt;make&lt;TH1D&gt;(</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="stringliteral">&quot;ElectronicsResponse&quot;</span>,<span class="stringliteral">&quot;;t (ns);Electronics Response&quot;</span>,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">fNElectResp</a>,0,<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">fNElectResp</a>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">fNElectResp</a>; ++i) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">fElectResp</a>-&gt;Fill(i, fElectResponse[i]);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">fElectResp</a>-&gt;Write();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;DEFINE_ART_MODULE(<a class="code" href="../../d8/de6/classdetsim_1_1SimWire.html">detsim::SimWire</a>)</div>
<div class="ttc" id="namespaceraw_html_a75392ac34cff2e6c998dcc1cb35670c4a91cda9f28ca81dc8c31f9618b50f3e6c"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#a75392ac34cff2e6c998dcc1cb35670c4a91cda9f28ca81dc8c31f9618b50f3e6c">raw::kHuffman</a></div><div class="ttdoc">Huffman Encoding. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00010">RawTypes.h:10</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a8d665f5a906a1b6d8a64bbc46554c29d"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a8d665f5a906a1b6d8a64bbc46554c29d">detsim::SimWire::fNSamplesReadout</a></div><div class="ttdeci">unsigned int fNSamplesReadout</div><div class="ttdoc">number of ADC readout samples in 1 readout frame </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00086">SimWire_module.cc:86</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a2bd6507cff570e9adaf8b2c643ce96ff"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a2bd6507cff570e9adaf8b2c643ce96ff">detsim::SimWire::fNoiseModelChoice</a></div><div class="ttdeci">std::string fNoiseModelChoice</div><div class="ttdoc">choice for noise model </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00097">SimWire_module.cc:97</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aac28b5c41c9de071e1dc6698d59ffc3c"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aac28b5c41c9de071e1dc6698d59ffc3c">detsim::SimWire::fColShape</a></div><div class="ttdeci">std::vector&lt; TComplex &gt; fColShape</div><div class="ttdoc">response function for the field @ collection plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00106">SimWire_module.cc:106</a></div></div>
<div class="ttc" id="namespaceraw_html_a5cccb6911a757c829a5ed5c61ad85a21"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#a5cccb6911a757c829a5ed5c61ad85a21">raw::Compress_t</a></div><div class="ttdeci">enum raw::_compress Compress_t</div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ae082efbff59bf6bb9c82abce377c397d"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ae082efbff59bf6bb9c82abce377c397d">detsim::SimWire::fIndFieldParams</a></div><div class="ttdeci">std::vector&lt; float &gt; fIndFieldParams</div><div class="ttdoc">induction plane field function parameterization </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00103">SimWire_module.cc:103</a></div></div>
<div class="ttc" id="classsim_1_1SimChannel_html"><div class="ttname"><a href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a></div><div class="ttdoc">Energy deposited on a readout channel by simulated tracks. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dde/SimChannel_8h_source.html#l00140">SimChannel.h:140</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a3fab76d1fa246295634b35b5f2a8d365"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a3fab76d1fa246295634b35b5f2a8d365">detsim::SimWire::fElectResponse</a></div><div class="ttdeci">std::vector&lt; double &gt; fElectResponse</div><div class="ttdoc">response function for the electronics </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00108">SimWire_module.cc:108</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ae3b4573d4f86878420aea6e34c62faae"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ae3b4573d4f86878420aea6e34c62faae">detsim::SimWire::fNoiseFluct</a></div><div class="ttdeci">TF1 * fNoiseFluct</div><div class="ttdoc">Poisson dist for fluctuations in magnitude of noise freq components. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00119">SimWire_module.cc:119</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ab7f9c0bf78f5591d91d8014915d66349"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ab7f9c0bf78f5591d91d8014915d66349">detsim::SimWire::fColTimeShape</a></div><div class="ttdeci">TH1D * fColTimeShape</div><div class="ttdoc">convoluted shape for field x electronics @ col plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00116">SimWire_module.cc:116</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a7a653c5f53003d7e71f1f075a681b91b"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a7a653c5f53003d7e71f1f075a681b91b">detsim::SimWire::fDriftEModuleLabel</a></div><div class="ttdeci">std::string fDriftEModuleLabel</div><div class="ttdoc">module making the ionization electrons </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00081">SimWire_module.cc:81</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a45110c0ae4a98389bab0a4ce46c6b3b3"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a45110c0ae4a98389bab0a4ce46c6b3b3">detsim::SimWire::fNoiseNchToSim</a></div><div class="ttdeci">int fNoiseNchToSim</div><div class="ttdoc">number of noise channels to generate </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00096">SimWire_module.cc:96</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a680afe9358f2b618fe1d08d86e13ba0d"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a680afe9358f2b618fe1d08d86e13ba0d">detsim::SimWire::SetElectResponse</a></div><div class="ttdeci">void SetElectResponse()</div><div class="ttdoc">response of electronics </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00531">SimWire_module.cc:531</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a6d43d1ce26cb22cde893bd07007d4c0e"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a6d43d1ce26cb22cde893bd07007d4c0e">detsim::SimWire::fADCPerPCAtLowestASICGain</a></div><div class="ttdeci">double fADCPerPCAtLowestASICGain</div><div class="ttdoc">ADCs/pC at lowest gain setting of 4.7 mV/fC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00094">SimWire_module.cc:94</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aa97ddbb8b637c54741b0068a55e8a222"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aa97ddbb8b637c54741b0068a55e8a222">detsim::SimWire::fNElectResp</a></div><div class="ttdeci">unsigned int fNElectResp</div><div class="ttdoc">number of entries from response to use </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00091">SimWire_module.cc:91</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a8007a4fd69af64a57c94941b45a3116e"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a8007a4fd69af64a57c94941b45a3116e">detsim::SimWire::fNoiseDist</a></div><div class="ttdeci">TH1D * fNoiseDist</div><div class="ttdoc">distribution of noise counts </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00118">SimWire_module.cc:118</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_af0164117ef7b8eac4a5f85dd6d8709e8"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#af0164117ef7b8eac4a5f85dd6d8709e8">detsim::SimWire::fNoiseFluctChoice</a></div><div class="ttdeci">std::string fNoiseFluctChoice</div><div class="ttdoc">choice for noise freq component mag fluctuations </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00098">SimWire_module.cc:98</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="RawDigit_8h_html"><div class="ttname"><a href="../../d9/d5a/RawDigit_8h.html">RawDigit.h</a></div><div class="ttdoc">Definition of basic raw digits. </div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_af354217147307be2d7e66789d07d88c4"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#af354217147307be2d7e66789d07d88c4">detsim::SimWire::fCompression</a></div><div class="ttdeci">raw::Compress_t fCompression</div><div class="ttdoc">compression type to use </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00082">SimWire_module.cc:82</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_addd821657d78177b01d8183749b0dc33"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#addd821657d78177b01d8183749b0dc33">detsim::SimWire::fShapeTimeConst</a></div><div class="ttdeci">double fShapeTimeConst</div><div class="ttdoc">time constants for exponential shaping </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00093">SimWire_module.cc:93</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_af8bcbcc2282db2b83c9ae1977636564e"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#af8bcbcc2282db2b83c9ae1977636564e">detsim::SimWire::fNoise</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; float &gt; &gt; fNoise</div><div class="ttdoc">noise on each channel for each time </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00109">SimWire_module.cc:109</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aab5fea718b5e679a58b050bf939bfeed"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aab5fea718b5e679a58b050bf939bfeed">detsim::SimWire::fInputFieldRespSamplingPeriod</a></div><div class="ttdeci">double fInputFieldRespSamplingPeriod</div><div class="ttdoc">Sampling period in the input field response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00092">SimWire_module.cc:92</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a10eae1fb7996a75ca0c4c7c78e05874a"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a10eae1fb7996a75ca0c4c7c78e05874a">util::quantities::ticks</a></div><div class="ttdeci">tick ticks</div><div class="ttdoc">Alias for common language habits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00078">electronics.h:78</a></div></div>
<div class="ttc" id="namespaceraw_html_a75392ac34cff2e6c998dcc1cb35670c4a76fb4ec9d88a77500a556aab12c35703"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#a75392ac34cff2e6c998dcc1cb35670c4a76fb4ec9d88a77500a556aab12c35703">raw::kNone</a></div><div class="ttdoc">no compression </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00009">RawTypes.h:9</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a93d824fb535f62f8da351b22a1fc506a"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a93d824fb535f62f8da351b22a1fc506a">detsim::SimWire::fColFieldParams</a></div><div class="ttdeci">std::vector&lt; float &gt; fColFieldParams</div><div class="ttdoc">collection plane field function parameterization </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00102">SimWire_module.cc:102</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ae8be51c83e40d2b3de7396df2369a51d"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ae8be51c83e40d2b3de7396df2369a51d">detsim::SimWire::fCalibRespTOffset</a></div><div class="ttdeci">std::vector&lt; int &gt; fCalibRespTOffset</div><div class="ttdoc">calib response time offset in ticks </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00101">SimWire_module.cc:101</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ac8ba44fe1fcb18aec8b2a1e8439cbd62"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ac8ba44fe1fcb18aec8b2a1e8439cbd62">detsim::SimWire::fIndFieldResponse</a></div><div class="ttdeci">std::vector&lt; double &gt; fIndFieldResponse</div><div class="ttdoc">response function for the field @ induction plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00105">SimWire_module.cc:105</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a107946603e4a2f959cbb060ead3ae3d3"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a107946603e4a2f959cbb060ead3ae3d3">detsim::SimWire::GenNoise</a></div><div class="ttdeci">void GenNoise(std::vector&lt; float &gt; &amp;array, CLHEP::HepRandomEngine &amp;engine)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00404">SimWire_module.cc:404</a></div></div>
<div class="ttc" id="find__fhicl_8sh_html_a0e50d715b86162838c8a191974455ae0"><div class="ttname"><a href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">array</a></div><div class="ttdeci">then echo ***************************************echo array</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/find__fhicl_8sh_source.html#l00028">find_fhicl.sh:28</a></div></div>
<div class="ttc" id="namespacegeo_html_a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a3b3c27511a16721236b09f14b66a58beafb721fe41f98f339c81e6bc7611820e8">geo::kInduction</a></div><div class="ttdoc">Signal from induction planes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00145">geo_types.h:145</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a34f2d86cbcd07a632b1e066be393df2d"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a34f2d86cbcd07a632b1e066be393df2d">detsim::SimWire::fColFieldResponse</a></div><div class="ttdeci">std::vector&lt; double &gt; fColFieldResponse</div><div class="ttdoc">response function for the field @ collection plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00104">SimWire_module.cc:104</a></div></div>
<div class="ttc" id="classsim_1_1SimChannel_html_a7f0a222d6c3b11979cac01aab1245a53"><div class="ttname"><a href="../../d0/daf/classsim_1_1SimChannel.html#a7f0a222d6c3b11979cac01aab1245a53">sim::SimChannel::Charge</a></div><div class="ttdeci">double Charge(TDC_t tdc) const </div><div class="ttdoc">Returns the total number of ionization electrons on this channel in the specified TDC...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1c/SimChannel_8cxx_source.html#l00134">SimChannel.cxx:134</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a4c481130e8c894af78afaea0708fa59c"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a4c481130e8c894af78afaea0708fa59c">detsim::SimWire::fIndShape</a></div><div class="ttdeci">std::vector&lt; TComplex &gt; fIndShape</div><div class="ttdoc">response function for the field @ induction plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00107">SimWire_module.cc:107</a></div></div>
<div class="ttc" id="namespacedetsim_html_ae342ea79321ce8ab83dec41dba06434e"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#ae342ea79321ce8ab83dec41dba06434e">detsim::fNSamplesReadout</a></div><div class="ttdeci">fNSamplesReadout</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00157">SimWire_module.cc:157</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a2d7d0e2d3cde4f18544a0fa2f92ea504"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a2d7d0e2d3cde4f18544a0fa2f92ea504">detsim::SimWire::fNoiseFluctPar</a></div><div class="ttdeci">std::vector&lt; double &gt; fNoiseFluctPar</div><div class="ttdoc">Poisson noise fluctuations params. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00111">SimWire_module.cc:111</a></div></div>
<div class="ttc" id="namespacedetsim_html_ac17a92de25bbd84bdd320811fff947c6"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">detsim::MF_LOG_WARNING</a></div><div class="ttdeci">MF_LOG_WARNING(&quot;SimWire&quot;)&lt;&lt; &quot;SimWire is an example module that works for the &quot;&lt;&lt; &quot;MicroBooNE detector. Each experiment should implement &quot;&lt;&lt; &quot;its own version of this module to simulate electronics &quot;&lt;&lt; &quot;response.&quot;</div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ac9f60575d6e33c8e5eff3bf81e25de51"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ac9f60575d6e33c8e5eff3bf81e25de51">detsim::SimWire::produce</a></div><div class="ttdeci">void produce(art::Event &amp;evt) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00226">SimWire_module.cc:226</a></div></div>
<div class="ttc" id="raw_8h_html"><div class="ttname"><a href="../../d6/df4/raw_8h.html">raw.h</a></div><div class="ttdoc">Collect all the RawData header files together. </div></div>
<div class="ttc" id="namespaceevgen_html_ac64ce9233583b081586d153cc2f2056b"><div class="ttname"><a href="../../d4/d4d/namespaceevgen.html#ac64ce9233583b081586d153cc2f2056b">evgen::fEngine</a></div><div class="ttdeci">fEngine(art::ServiceHandle&lt; rndm::NuRandomService &gt;() -&gt;createEngine(*this, pset,&quot;Seed&quot;))</div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a1a08bc762b79d6e1d7816c34d3e36f78"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">util::quantities::tick</a></div><div class="ttdeci">tick_as&lt;&gt; tick</div><div class="ttdoc">Tick number, represented by std::ptrdiff_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00075">electronics.h:75</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a466a648804ededad9d464b67cdf2d8f8"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a466a648804ededad9d464b67cdf2d8f8">detsim::SimWire::ConvoluteResponseFunctions</a></div><div class="ttdeci">void ConvoluteResponseFunctions()</div><div class="ttdoc">convolute electronics and field response </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00335">SimWire_module.cc:335</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a8681181612fc002504b624053a906aa8"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a8681181612fc002504b624053a906aa8">detsim::SimWire::fSampleRate</a></div><div class="ttdeci">double fSampleRate</div><div class="ttdoc">sampling rate in ns </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00085">SimWire_module.cc:85</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_ae7d6d9e899e167bc0da3f2396edc238b"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#ae7d6d9e899e167bc0da3f2396edc238b">detsim::SimWire::SetFieldResponse</a></div><div class="ttdeci">void SetFieldResponse()</div><div class="ttdoc">response of wires to field </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00478">SimWire_module.cc:478</a></div></div>
<div class="ttc" id="namespacedetsim_html_a1694416336c9bd0bab8a3ded1795ccae"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a1694416336c9bd0bab8a3ded1795ccae">detsim::fCompression</a></div><div class="ttdeci">fCompression</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfd/SimWireSBND__module_8cc_source.html#l00123">SimWireSBND_module.cc:123</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a47b2e428d62ac81b4b7a909ddd476073"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a47b2e428d62ac81b4b7a909ddd476073">detsim::SimWire::SimWire</a></div><div class="ttdeci">SimWire(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00129">SimWire_module.cc:129</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aab9999274b48867ab8e27fe8c95324e6"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aab9999274b48867ab8e27fe8c95324e6">detsim::SimWire::fIndFieldResp</a></div><div class="ttdeci">TH1D * fIndFieldResp</div><div class="ttdoc">response function for the field @ induction plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00113">SimWire_module.cc:113</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a18aa79bf9bc71b9d057abab00a518ce4"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a18aa79bf9bc71b9d057abab00a518ce4">detsim::SimWire::fNTicks</a></div><div class="ttdeci">int fNTicks</div><div class="ttdoc">number of ticks of the clock </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00084">SimWire_module.cc:84</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aa0ea9ac3eb629f559ed72f48e0130cd1"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aa0ea9ac3eb629f559ed72f48e0130cd1">detsim::SimWire::fInd3DCorrection</a></div><div class="ttdeci">double fInd3DCorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00089">SimWire_module.cc:89</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_aed063e449bbb1a01ee96e63d4db4355b"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#aed063e449bbb1a01ee96e63d4db4355b">detsim::SimWire::fIndTimeShape</a></div><div class="ttdeci">TH1D * fIndTimeShape</div><div class="ttdoc">convoluted shape for field x electronics @ ind plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00117">SimWire_module.cc:117</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a12b5cf08b01eef202b66b83493cec775"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a12b5cf08b01eef202b66b83493cec775">detsim::SimWire::fFieldRespTOffset</a></div><div class="ttdeci">std::vector&lt; int &gt; fFieldRespTOffset</div><div class="ttdoc">field response time offset in ticks </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00100">SimWire_module.cc:100</a></div></div>
<div class="ttc" id="namespacedetsim_html_a4a36ea620146245a8999b4710108c08c"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a4a36ea620146245a8999b4710108c08c">detsim::fSampleRate</a></div><div class="ttdeci">fSampleRate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00156">SimWire_module.cc:156</a></div></div>
<div class="ttc" id="PlaneGeo_8h_html"><div class="ttname"><a href="../../d8/d80/PlaneGeo_8h.html">PlaneGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="LArFFT_8h_html"><div class="ttname"><a href="../../d4/d33/LArFFT_8h.html">LArFFT.h</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a7e2db4120c20af6641f290ff9b632f49"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a7e2db4120c20af6641f290ff9b632f49">detsim::SimWire::fASICGainInMVPerFC</a></div><div class="ttdeci">double fASICGainInMVPerFC</div><div class="ttdoc">actual gain setting used in mV/fC </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00095">SimWire_module.cc:95</a></div></div>
<div class="ttc" id="SimChannel_8h_html"><div class="ttname"><a href="../../d6/dde/SimChannel_8h.html">SimChannel.h</a></div><div class="ttdoc">object containing MC truth information necessary for making RawDigits and doing back tracking ...</div></div>
<div class="ttc" id="DetectorClocksService_8h_html"><div class="ttname"><a href="../../d3/dba/DetectorClocksService_8h.html">DetectorClocksService.h</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_afdf2bb72bfa4db1949209212c2fb0214"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#afdf2bb72bfa4db1949209212c2fb0214">detsim::SimWire::fElectResp</a></div><div class="ttdeci">TH1D * fElectResp</div><div class="ttdoc">response function for the electronics </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00115">SimWire_module.cc:115</a></div></div>
<div class="ttc" id="namespaceraw_html_a24a5165586cd3126a6ae7e80ee82ae4d"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#a24a5165586cd3126a6ae7e80ee82ae4d">raw::Compress</a></div><div class="ttdeci">void Compress(std::vector&lt; short &gt; &amp;adc, raw::Compress_t compress)</div><div class="ttdoc">Compresses a raw data buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df4/raw_8cxx_source.html#l00019">raw.cxx:19</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00253">NuVertexChargeTree_module.cc:253</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a75a03e732db4a45023fc227bd4c8fd90"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a75a03e732db4a45023fc227bd4c8fd90">detsim::SimWire::fCol3DCorrection</a></div><div class="ttdeci">double fCol3DCorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00087">SimWire_module.cc:87</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00007">DataStructs.cxx:7</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a2bddb33db7d81e76601cd068af0a7dd3"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a2bddb33db7d81e76601cd068af0a7dd3">detsim::SimWire::fEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fEngine</div><div class="ttdoc">Random-number engine owned by art. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00121">SimWire_module.cc:121</a></div></div>
<div class="ttc" id="namespacedetinfo_html_a0c4d3d5b85e37497364174c3513ffcae"><div class="ttname"><a href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">detinfo::sampling_rate</a></div><div class="ttdeci">double sampling_rate(DetectorClocksData const &amp;data)</div><div class="ttdoc">Returns the period of the TPC readout electronics clock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00643">DetectorClocksData.h:643</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a0bd44844ad3bf1ba52c50d0d1d83188f"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a0bd44844ad3bf1ba52c50d0d1d83188f">detsim::SimWire::fColFieldResp</a></div><div class="ttdeci">TH1D * fColFieldResp</div><div class="ttdoc">response function for the field @ collection plane </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00114">SimWire_module.cc:114</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html">detsim::SimWire</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00066">SimWire_module.cc:66</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_af4c76bd39aa69a253a010fa4e36e8fed"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#af4c76bd39aa69a253a010fa4e36e8fed">detsim::SimWire::fNoiseModelPar</a></div><div class="ttdeci">std::vector&lt; double &gt; fNoiseModelPar</div><div class="ttdoc">noise model params </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00110">SimWire_module.cc:110</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classdetsim_1_1SimWire_html_a2cc113144c45c211db2280336c6bbccb"><div class="ttname"><a href="../../d8/de6/classdetsim_1_1SimWire.html#a2cc113144c45c211db2280336c6bbccb">detsim::SimWire::beginJob</a></div><div class="ttdeci">void beginJob() override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00169">SimWire_module.cc:169</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ae5523f84c7884451cef6ac6241de2b91"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ae5523f84c7884451cef6ac6241de2b91">channelDBConverter.element</a></div><div class="ttdeci">list element</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00251">channelDBConverter.py:251</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
