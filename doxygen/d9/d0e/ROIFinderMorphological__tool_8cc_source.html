<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ROIFinderMorphological_tool.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_04d670c4adcb884258431ddc1ce2763c.html">icaruscode</a></li><li class="navelem"><a class="el" href="../../dir_94314c0f385d81f04de3b3bdb34c1673.html">icaruscode</a></li><li class="navelem"><a class="el" href="../../dir_4f081efc6e34d5090b09a872dc566d00.html">TPC</a></li><li class="navelem"><a class="el" href="../../dir_6e4f7ceb401322916cfe296fb41d3314.html">SignalProcessing</a></li><li class="navelem"><a class="el" href="../../dir_0a2a886b18f07260b51481e089739ba2.html">RecoWire</a></li><li class="navelem"><a class="el" href="../../dir_a594c6dc3a22820e5bbc394702e4891a.html">DeconTools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ROIFinderMorphological_tool.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d0e/ROIFinderMorphological__tool_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">/// \file   ROIFinderMorphological.cc</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \author T. Usher</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h.html">icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;art/Utilities/ToolMacros.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;art/Utilities/make_tool.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;art_root_io/TFileService.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;cetlib_except/exception.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;icarus_signal_processing/WaveformTools.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;TH1F.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;TH2F.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;TProfile.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">namespace </span>icarus_tool</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html">   26</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html">ROIFinderMorphological</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html">IROIFinder</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a3a2d66774cca2022906d490a723e4514">ROIFinderMorphological</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe41d2ecd57a4616b82d5bbfeab4d7c3">~ROIFinderMorphological</a>();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">void</span>   <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa15e3d1acc71c11cdcf6418c01a430a7">configure</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)                      <span class="keyword">override</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">void</span>   <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">initializeHistograms</a>(art::TFileDirectory&amp;)                <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a610bc053243595343741943eb2cbd5fb">   35</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a610bc053243595343741943eb2cbd5fb">plane</a>()<span class="keyword">                                                   const override </span>{<span class="keywordflow">return</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a>;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a901764510d8012b56ffed8b9f56b1e7c">FindROIs</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;, <span class="keywordtype">size_t</span>, <span class="keywordtype">size_t</span>, <span class="keywordtype">double</span>, <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// The actual ROI finding algorithm based on the difference vec</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">findROICandidatesDifference</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                     <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                     <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                     <span class="keywordtype">float</span>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                     <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// The actual ROI finding algorithm based on the dilation vec</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">findROICandidatesDilation</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                   <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                   <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                   <span class="keywordtype">float</span>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                   <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// Average the input waveform</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a799fa712ebbd02f108fc3c395ab882a4">smoothInputWaveform</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;, <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;)  <span class="keyword">const</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// Actual histogram initialization...</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047">   62</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047">HistogramType</a> : <span class="keywordtype">int</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">   64</a></span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">ROIHISTOGRAM</a> = <a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa95d176c172abe5939928e864b76ae5ae">icarus_tool::LASTELEMENT</a> + 1,</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65">   65</a></span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65">TRUNCMEANHIST</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289">   66</a></span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289">TRUNCRMSHIST</a>,</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84">   67</a></span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84">WAVEFORMHIST</a></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    };</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../da/d1c/namespaceicarus__tool.html#a83e7e6148aa9b19785b3f944e7ebb15a">icarus_tool::HistogramMap</a> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">initializeHistograms</a>(<span class="keywordtype">size_t</span>, <span class="keywordtype">size_t</span>, <span class="keywordtype">size_t</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Member variables from the fhicl file</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">   73</a></span>&#160;    <span class="keywordtype">size_t</span>                                      <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a>;                      <span class="comment">///&lt; Tool can be plane dependent</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">   74</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span>                                        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>;              <span class="comment">///&lt; If true use differences, else dilation</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39a53503ce31909397545ba41799660a">   75</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">float</span>                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39a53503ce31909397545ba41799660a">fNumSigma</a>;                   <span class="comment">///&lt; &quot;# sigma&quot; rms noise for ROI threshold</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">   76</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span>                                         <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">fNumBinsToAve</a>;               <span class="comment">///&lt; Controls the smoothing</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">   77</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span>                                         <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">fMax2MinDistance</a>;            <span class="comment">///&lt; Minimum allow peak to peak distance</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">   78</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">float</span>                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">fMax2MinHeight</a>;              <span class="comment">///&lt; Minimum peak to peak height (box cut)</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">   79</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span>                                         <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">fMaxLengthCut</a>;               <span class="comment">///&lt; Minimum length of the maximum</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">   80</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span>                                         <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>;         <span class="comment">///&lt; The window size</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa1c0513a119e3b0be2dc1ba81df70fd0">   81</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                              <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa1c0513a119e3b0be2dc1ba81df70fd0">fPreROIPad</a>;                  <span class="comment">///&lt; ROI padding</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeaa297ea4f5bb934454ba09fa01bdacb">   82</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                              <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeaa297ea4f5bb934454ba09fa01bdacb">fPostROIPad</a>;                 <span class="comment">///&lt; ROI padding</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">   83</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                              <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">fMaxPadLen</a>;                  <span class="comment">///&lt; Don&#39;t let padding be larger than this</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">   84</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span>                                        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">fOutputHistograms</a>;           <span class="comment">///&lt; Output histograms?</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">   85</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span>                                        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">fOutputWaveforms</a>;            <span class="comment">///&lt; Output waveforms?</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">   87</a></span>&#160;    std::vector&lt;float&gt;                          <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>;               <span class="comment">///&lt; Weight vector for smoothing</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8ee2dbb4dab29a149c6190aa1afff2c1">   88</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">float</span>                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8ee2dbb4dab29a149c6190aa1afff2c1">fWeightSum</a>;                  <span class="comment">///&lt; sum of weights for smoothing</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">   90</a></span>&#160;    art::TFileDirectory*                        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">fHistDirectory</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Global histograms</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a1b37be19aa94afd321e3dfa463773a9c">   93</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a1b37be19aa94afd321e3dfa463773a9c">fDiffMeanHist</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aaeab603efdd04971f1c9eaadeba1766d">   94</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aaeab603efdd04971f1c9eaadeba1766d">fDiffRmsHist</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#abc4e0b0ea83f991b2b2537c3f902ad83">   95</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#abc4e0b0ea83f991b2b2537c3f902ad83">fDiffFullRmsHist</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ab5b19c0828f5d5c350672380951e06d2">   96</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ab5b19c0828f5d5c350672380951e06d2">fDTruncBinsHist</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0a74eafa9f094871d8a8b093a9cf2153">   97</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0a74eafa9f094871d8a8b093a9cf2153">fDiffMaxHist</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0fd3c5606a9d1cef0b65148689a8c5c5">   98</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0fd3c5606a9d1cef0b65148689a8c5c5">fNumSigmaHist</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a34ec3b7e82e803e8b33a27353bcfd3ac">   99</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a34ec3b7e82e803e8b33a27353bcfd3ac">fThresholdHist</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">  100</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">  101</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">fMaxDiffLength</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">  102</a></span>&#160;    TH1F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">fDeltaTicksHist</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">  103</a></span>&#160;    TH2F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">fDTixVDLenHist</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">  104</a></span>&#160;    TH2F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">fDTixVDiffHist</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">  105</a></span>&#160;    TH2F*                                       <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">fDiffVDilHist</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">  107</a></span>&#160;    icarus_signal_processing::WaveformTools&lt;float&gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Services</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a6c636e2a3d5536799bf0be000a06fe97">  110</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a>*                    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a6c636e2a3d5536799bf0be000a06fe97">fGeometry</a> = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;};</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// Constructor.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a3a2d66774cca2022906d490a723e4514">  115</a></span>&#160;<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a3a2d66774cca2022906d490a723e4514">ROIFinderMorphological::ROIFinderMorphological</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa15e3d1acc71c11cdcf6418c01a430a7">configure</a>(pset);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe41d2ecd57a4616b82d5bbfeab4d7c3">  120</a></span>&#160;<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe41d2ecd57a4616b82d5bbfeab4d7c3">ROIFinderMorphological::~ROIFinderMorphological</a>()</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa15e3d1acc71c11cdcf6418c01a430a7">  124</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa15e3d1acc71c11cdcf6418c01a430a7">ROIFinderMorphological::configure</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Start by recovering the parameters</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    std::vector&lt;unsigned short&gt; zin;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a>                 = pset.get&lt; <span class="keywordtype">size_t</span>                     &gt;(<span class="stringliteral">&quot;Plane&quot;</span>                     );</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>         = pset.get&lt; <span class="keywordtype">bool</span>                       &gt;(<span class="stringliteral">&quot;UseDifference&quot;</span>,        <span class="keyword">true</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39a53503ce31909397545ba41799660a">fNumSigma</a>              = pset.get&lt; <span class="keywordtype">float</span>                      &gt;(<span class="stringliteral">&quot;NumSigma&quot;</span>                  );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">fNumBinsToAve</a>          = pset.get&lt; <span class="keywordtype">int</span>                        &gt;(<span class="stringliteral">&quot;NumBinsToAve&quot;</span>              );</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">fMax2MinDistance</a>       = pset.get&lt; <span class="keywordtype">int</span>                        &gt;(<span class="stringliteral">&quot;Max2MinDistance&quot;</span>           );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">fMax2MinHeight</a>         = pset.get&lt; <span class="keywordtype">int</span>                        &gt;(<span class="stringliteral">&quot;Max2MinHeight&quot;</span>             );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">fMaxLengthCut</a>          = pset.get&lt; <span class="keywordtype">int</span>                        &gt;(<span class="stringliteral">&quot;MaxLengthCut&quot;</span>              );</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>    = pset.get&lt; <span class="keywordtype">int</span>                        &gt;(<span class="stringliteral">&quot;StructuringElement&quot;</span>        );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    zin                    = pset.get&lt; std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;roiLeadTrailPad&quot;</span>           );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">fMaxPadLen</a>             = pset.get&lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>             &gt;(<span class="stringliteral">&quot;MaxPadLen&quot;</span>,             200);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">fOutputHistograms</a>      = pset.get&lt; <span class="keywordtype">bool</span>                       &gt;(<span class="stringliteral">&quot;OutputHistograms&quot;</span>,    <span class="keyword">false</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">fOutputWaveforms</a>       = pset.get&lt; <span class="keywordtype">bool</span>                       &gt;(<span class="stringliteral">&quot;OutputWaveforms&quot;</span>,     <span class="keyword">false</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span>(zin.size() != 2) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">throw</span> art::Exception(art::errors::Configuration)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Plane ROI pad size != 2&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// put the ROI pad sizes into more variables</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa1c0513a119e3b0be2dc1ba81df70fd0">fPreROIPad</a>  = zin[0];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeaa297ea4f5bb934454ba09fa01bdacb">fPostROIPad</a> = zin[1];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// If asked, define the global histograms</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (fOutputHistograms)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// Access ART&#39;s TFileService, which will handle creating and writing</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// histograms and n-tuples for us.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        art::ServiceHandle&lt;art::TFileService&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">fHistDirectory</a> = tfs.get();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// Make a directory for these histograms</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        art::TFileDirectory <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">fHistDirectory</a>-&gt;mkdir(Form(<span class="stringliteral">&quot;ROIPlane_%1zu&quot;</span>,<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a>));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a1b37be19aa94afd321e3dfa463773a9c">fDiffMeanHist</a>    = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DiffMean&quot;</span>,  <span class="stringliteral">&quot;;Diff Mean;&quot;</span>,  100, -20.,   20.);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aaeab603efdd04971f1c9eaadeba1766d">fDiffRmsHist</a>     = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DiffRms&quot;</span>,   <span class="stringliteral">&quot;;Diff RMS;&quot;</span>,   200,   0.,   10.);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#abc4e0b0ea83f991b2b2537c3f902ad83">fDiffFullRmsHist</a> = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DiffFRms&quot;</span>,  <span class="stringliteral">&quot;;Diff RMS;&quot;</span>,   200,   0.,   10.);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ab5b19c0828f5d5c350672380951e06d2">fDTruncBinsHist</a>  = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DTruncBn&quot;</span>,  <span class="stringliteral">&quot;D trunc B&quot;</span>,    500,   0., 1000.);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0a74eafa9f094871d8a8b093a9cf2153">fDiffMaxHist</a>     = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DiffMax&quot;</span>,   <span class="stringliteral">&quot;;Diff Max;&quot;</span>,   200,   0.,  200.);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0fd3c5606a9d1cef0b65148689a8c5c5">fNumSigmaHist</a>    = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;NSigma&quot;</span>,    <span class="stringliteral">&quot;;#sigma;&quot;</span>,     200,   0.,   40.);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a34ec3b7e82e803e8b33a27353bcfd3ac">fThresholdHist</a>   = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;Threshold&quot;</span>, <span class="stringliteral">&quot;;Threshold;&quot;</span>,  200,   0.,   40.);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>  = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;NSigNext&quot;</span>,  <span class="stringliteral">&quot;;#sigma;&quot;</span>,     200,   0.,   50.);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">fMaxDiffLength</a>   = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;MaxLength&quot;</span>, <span class="stringliteral">&quot;;Delta t&quot;</span>,     200,   0.,  200.);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">fDeltaTicksHist</a>  = dir.make&lt;TH1F&gt;(<span class="stringliteral">&quot;DeltaTix&quot;</span>,  <span class="stringliteral">&quot;;Delta t&quot;</span>,     200,   0.,  200.);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">fDTixVDLenHist</a>  = dir.make&lt;TH2F&gt;(<span class="stringliteral">&quot;DTixVDLen&quot;</span>, <span class="stringliteral">&quot;;Delta t;DLength&quot;</span>,       100, 0., 100., 100, 0., 100.);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">fDTixVDiffHist</a>  = dir.make&lt;TH2F&gt;(<span class="stringliteral">&quot;DTixVDiff&quot;</span>, <span class="stringliteral">&quot;;Delta t;Max Diff&quot;</span>,      100, 0., 100., 100, 0., 100.);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">fDiffVDilHist</a>   = dir.make&lt;TH2F&gt;(<span class="stringliteral">&quot;DiffVDil&quot;</span>,  <span class="stringliteral">&quot;;Max Diff;Max Dilation&quot;</span>, 100, 0., 200., 100, 0., 200.);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// precalculate the weight vector to use in the smoothing</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.resize(fNumBinsToAve);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (fNumBinsToAve &gt; 1)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> idx = 0; idx &lt; fNumBinsToAve/2; idx++)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordtype">float</span> weight = idx + 1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.at(idx)                     = weight;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.at(fNumBinsToAve - idx - 1) = weight;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">// Watch for case of fNumBinsToAve being odd</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> (fNumBinsToAve % 2 &gt; 0) <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.at(fNumBinsToAve/2) = fNumBinsToAve/2 + 1;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.at(0) = 1.;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8ee2dbb4dab29a149c6190aa1afff2c1">fWeightSum</a> = std::accumulate(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.begin(),<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.end(), 0.);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a901764510d8012b56ffed8b9f56b1e7c">  202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a901764510d8012b56ffed8b9f56b1e7c">ROIFinderMorphological::FindROIs</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp; waveform, <span class="keywordtype">size_t</span> channel, <span class="keywordtype">size_t</span> cnt, <span class="keywordtype">double</span> rmsNoise, <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp; roiVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// The idea here is to consider the input waveform - if an induction plane then it is already in differential form,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// if a collection plane then we form the differential - then smooth and look for ROIs. The technique for actually</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// finding ROI&#39;s will be to compute the erosion and dilation vectors, get their average/difference and then use these to determine</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// candidate ROI&#39;s</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Smooth the input waveform</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> smoothWaveform;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a799fa712ebbd02f108fc3c395ab882a4">smoothInputWaveform</a>(waveform, smoothWaveform);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// We make lots of vectors... erosion, dilation, average and difference</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> erosionVec;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> dilationVec;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> averageVec;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> differenceVec;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Compute the morphological filter vectors</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>.getErosionDilationAverageDifference(smoothWaveform, <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>, erosionVec, dilationVec, averageVec, differenceVec);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Use the average vector to find ROI&#39;s</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">float</span> fullRMS;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">float</span> truncRMS;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">float</span> truncMean;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">float</span> nSig(2.5);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span>   nTrunc;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">int</span>   range;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>) </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> zeroSuppressed(differenceVec.size());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>.getTruncatedMean(differenceVec, truncMean, nTrunc, range);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(differenceVec.begin(),differenceVec.end(),zeroSuppressed.begin(),[truncMean](<span class="keyword">auto</span>&amp; val){<span class="keywordflow">return</span> val - truncMean;});</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>.getTruncatedRMS(zeroSuppressed, nSig, fullRMS, truncRMS, nTrunc);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">else</span>                </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> zeroSuppressed(dilationVec.size());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>.getTruncatedMean(dilationVec, truncMean, nTrunc, range);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(dilationVec.begin(),dilationVec.end(),zeroSuppressed.begin(),[truncMean](<span class="keyword">auto</span>&amp; val){<span class="keywordflow">return</span> val - truncMean;});</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">fWaveformTool</a>.getTruncatedRMS(zeroSuppressed, nSig, fullRMS, truncRMS, nTrunc);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Calculate a threshold to use based on the truncated mand and rms...</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">float</span> threshold = truncMean + <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39a53503ce31909397545ba41799660a">fNumSigma</a> * <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">float</span>(0.02),truncRMS);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Define the histogram map which will be referenced later</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="../../da/d1c/namespaceicarus__tool.html#a83e7e6148aa9b19785b3f944e7ebb15a">icarus_tool::HistogramMap</a> histogramMap;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">fOutputWaveforms</a>)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// Define histograms for this particular channel?</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        histogramMap = <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">initializeHistograms</a>(channel, cnt, waveform.size());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> curBin = 0; curBin &lt; waveform.size(); curBin++)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            histogramMap.at(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84">WAVEFORMHIST</a>)-&gt;Fill( curBin, waveform[curBin], 1.);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            histogramMap.at(<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6cfa0db481bd5c3c3843c80711da0fce">WAVEFORM</a>)-&gt;Fill(     curBin, smoothWaveform[curBin], 1.);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            histogramMap.at(<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa56f86a4339f07e7f0ebac817f6ff09b3">EROSION</a>)-&gt;Fill(      curBin, erosionVec[curBin], 1.);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            histogramMap.at(<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa0c5e32b6c368a7c4b4651536cbf03f8f">DILATION</a>)-&gt;Fill(     curBin, dilationVec[curBin], 1.);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            histogramMap.at(<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa91cdbe8d970368ba6f45b1e373645a69">AVERAGE</a>)-&gt;Fill(      curBin, averageVec[curBin], 1.);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            histogramMap.at(<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6020ef468ba817871321f4db82267719">DIFFERENCE</a>)-&gt;Fill(   curBin, differenceVec[curBin], 1.);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            histogramMap.at(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65">TRUNCMEANHIST</a>)-&gt;Fill(curBin, truncMean, 1.);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            histogramMap.at(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289">TRUNCRMSHIST</a>)-&gt;Fill( curBin, threshold, 1.);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// If histogramming, do the global hists here</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">fOutputHistograms</a>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        Waveform::iterator maxItr;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>) maxItr = std::max_element(differenceVec.begin(),differenceVec.end());</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">else</span>                maxItr = std::max_element(dilationVec.begin(),dilationVec.end());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordtype">float</span> maxDiff    = *maxItr;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordtype">float</span> nSigma     = (maxDiff - truncMean) / std::max(<span class="keywordtype">float</span>(0.5),truncRMS);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">int</span>   dTruncBins = int(differenceVec.size()) - nTrunc;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a1b37be19aa94afd321e3dfa463773a9c">fDiffMeanHist</a>-&gt;Fill(truncMean, 1.);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aaeab603efdd04971f1c9eaadeba1766d">fDiffRmsHist</a>-&gt;Fill(truncRMS, 1.);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#abc4e0b0ea83f991b2b2537c3f902ad83">fDiffFullRmsHist</a>-&gt;Fill(fullRMS, 1.);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ab5b19c0828f5d5c350672380951e06d2">fDTruncBinsHist</a>-&gt;Fill(std::min(dTruncBins,999), 1.);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0a74eafa9f094871d8a8b093a9cf2153">fDiffMaxHist</a>-&gt;Fill(maxDiff, 1.);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0fd3c5606a9d1cef0b65148689a8c5c5">fNumSigmaHist</a>-&gt;Fill(std::min(nSigma,<span class="keywordtype">float</span>(39.9)), 1.);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a34ec3b7e82e803e8b33a27353bcfd3ac">fThresholdHist</a>-&gt;Fill(std::min(threshold,<span class="keywordtype">float</span>(39.9)), 1.);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (std::distance(differenceVec.begin(),maxItr) &gt; 4 * <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                maxDiff = *std::max_element(differenceVec.begin(),maxItr-4*<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                nSigma  = (maxDiff - truncMean) / std::max(<span class="keywordtype">float</span>(0.5),truncRMS);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>-&gt;Fill(nSigma, 1.);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (std::distance(maxItr, differenceVec.end()) &gt; 4 * <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                maxDiff = *std::max_element(maxItr+4*<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>,differenceVec.end());</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                nSigma  = (maxDiff - truncMean) / std::max(<span class="keywordtype">float</span>(0.5),truncRMS);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>-&gt;Fill(nSigma, 1.);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (std::distance(dilationVec.begin(),maxItr) &gt; 4 * <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                maxDiff = *std::max_element(dilationVec.begin(),maxItr-4*<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                nSigma  = (maxDiff - truncMean) / std::max(<span class="keywordtype">float</span>(0.5),truncRMS);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>-&gt;Fill(nSigma, 1.);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">if</span> (std::distance(maxItr, dilationVec.end()) &gt; 4 * <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                maxDiff = *std::max_element(maxItr+4*<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">fStructuringElement</a>,dilationVec.end());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                nSigma  = (maxDiff - truncMean) / std::max(<span class="keywordtype">float</span>(0.5),truncRMS);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">fNumSigNextHist</a>-&gt;Fill(nSigma, 1.);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">fUseDifference</a>) <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">findROICandidatesDifference</a>(differenceVec, erosionVec, dilationVec, 0, averageVec.size(), threshold, roiVec);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">else</span>                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">findROICandidatesDilation</a>(  differenceVec, erosionVec, dilationVec, 0, averageVec.size(), threshold, roiVec);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (roiVec.empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// pad the ROIs</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; roi : roiVec)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (!histogramMap.empty())</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            histogramMap.at(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">ROIHISTOGRAM</a>)-&gt;Fill(<span class="keywordtype">int</span>(roi.first),  std::max(5.*truncRMS,1.));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            histogramMap.at(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">ROIHISTOGRAM</a>)-&gt;Fill(<span class="keywordtype">int</span>(roi.second), std::max(5.*truncRMS,1.));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">// For longer than normal pulse trains we could use a bit extra padding</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> halfROILen = (roi.second - roi.first) / 2;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> preROIPad  = std::min(std::max(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa1c0513a119e3b0be2dc1ba81df70fd0">fPreROIPad</a>,halfROILen),<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">fMaxPadLen</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> postROIPad = std::min(std::max(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeaa297ea4f5bb934454ba09fa01bdacb">fPostROIPad</a>,halfROILen),<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">fMaxPadLen</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// low ROI end</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        roi.first  = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<span class="keywordtype">int</span>(roi.first - preROIPad),0);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">// high ROI end</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        roi.second = std::min(roi.second + postROIPad, waveform.size() - 1);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// merge overlapping (or touching) ROI&#39;s</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span>(roiVec.size() &gt; 1)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// temporary vector for merged ROIs</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a> tempRoiVec;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// Loop through candidate roi&#39;s</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordtype">size_t</span> startRoi = roiVec.front().first;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">size_t</span> stopRoi  = startRoi;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; roi : roiVec)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="comment">// Should we merge roi&#39;s?</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">if</span> (roi.first &lt;= stopRoi + 50)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            { </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="comment">// Make sure the merge gets the right start/end times</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                startRoi = std::min(startRoi,roi.first);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                stopRoi  = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(stopRoi,roi.second);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                tempRoiVec.push_back(<a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#ad229ce67942c5ed0f0cc0e5cfe85423a">CandidateROI</a>(startRoi,stopRoi));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                startRoi = roi.first;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                stopRoi  = roi.second;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">// Make sure to get the last one</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        tempRoiVec.push_back(<a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#ad229ce67942c5ed0f0cc0e5cfe85423a">CandidateROI</a>(startRoi,stopRoi));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        roiVec = tempRoiVec;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    </div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">  396</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">ROIFinderMorphological::findROICandidatesDifference</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  differenceVec,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                         <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  erosionVec,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                         <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  dilationVec,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                                         <span class="keywordtype">int</span>              startTick,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                                         <span class="keywordtype">int</span>              stopTick,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                                         <span class="keywordtype">float</span>            threshold,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                         <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp; roiCandidateVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">int</span> roiLength = stopTick - startTick;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (roiLength &gt; 0)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// The idea here is to find the difference and use that as the seed for searching the</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">// erosion and dilation vectors for the end points</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        Waveform::const_iterator maxItr = std::max_element(differenceVec.begin()+startTick,differenceVec.begin()+stopTick);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">int</span>   maxTick       = std::distance(differenceVec.begin(),maxItr);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordtype">float</span> maxDifference = *maxItr;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">// Accomodate a special case of slowly rising waveforms where the difference will be under threshold but we </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">// do have a definite region of interest</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordtype">float</span> dilationVal   = dilationVec[maxTick];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// No point continuing if not over threshold</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> (maxDifference &gt; threshold || dilationVal &gt; threshold)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="comment">// move forward to find the length of the top</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">while</span>(*maxItr == maxDifference) maxItr++;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordtype">int</span> deltaTicks = std::distance(differenceVec.begin(),maxItr) - maxTick;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">// Start by finding maximum range of the erosion vector at this extremum</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordtype">int</span>  maxCandRoiTick = maxTick;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment">// The test on the erosion vector takes care of special case of slowly rising pulses which are characteristic of</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="comment">// tracks running into the wire plane</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">while</span>(++maxCandRoiTick &lt; stopTick)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keywordtype">float</span> difference = differenceVec.at(maxCandRoiTick);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordtype">float</span> erosion    = erosionVec.at(maxCandRoiTick);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">if</span> (difference &lt; threshold &amp;&amp; erosion &lt; 0.5 * threshold) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            maxCandRoiTick = std::min(maxCandRoiTick,stopTick);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="comment">// Now do the dilation vector</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordtype">int</span>   minCandRoiTick = maxTick;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">while</span>(--minCandRoiTick &gt;= startTick)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <span class="keywordtype">float</span> difference = differenceVec.at(minCandRoiTick);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordtype">float</span> erosion    = erosionVec.at(minCandRoiTick);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">if</span> (difference &lt; threshold &amp;&amp; erosion &lt; 0.5 * threshold) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="comment">// make sure we have not gone under</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            minCandRoiTick = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(minCandRoiTick, startTick);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordtype">int</span> max2MinDiff = maxCandRoiTick - minCandRoiTick;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">fOutputHistograms</a> &amp;&amp; !(startTick &gt; 0 || stopTick &lt; <span class="keywordtype">int</span>(differenceVec.size())))</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordtype">float</span> maxDilation = *std::max_element(dilationVec.begin() + minCandRoiTick, dilationVec.begin() + maxCandRoiTick);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">fMaxDiffLength</a>-&gt;Fill(std::min(deltaTicks,199), 1.);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">fDeltaTicksHist</a>-&gt;Fill(max2MinDiff, 1.);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">fDTixVDLenHist</a>-&gt;Fill(max2MinDiff, deltaTicks, 1.);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">fDTixVDiffHist</a>-&gt;Fill(max2MinDiff, maxDifference, 1.);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">fDiffVDilHist</a>-&gt;Fill(maxDifference, maxDilation, 1.);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="comment">// Make sure we have a legitimate candidate</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">if</span> ((max2MinDiff &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">fMax2MinDistance</a> || maxDifference &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">fMax2MinHeight</a>) &amp;&amp; deltaTicks &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">fMaxLengthCut</a>)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="comment">// Before saving this ROI, look for candidates preceeding this one</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="comment">// Note that preceeding snippet will reference to the current roiStartTick</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">findROICandidatesDifference</a>(differenceVec, erosionVec, dilationVec, startTick, minCandRoiTick, threshold, roiCandidateVec);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="comment">// Save this ROI</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                roiCandidateVec.push_back(<a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#ad229ce67942c5ed0f0cc0e5cfe85423a">CandidateROI</a>(minCandRoiTick, maxCandRoiTick));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="comment">// Now look for candidate ROI&#39;s downstream of this one</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">findROICandidatesDifference</a>(differenceVec, erosionVec, dilationVec, maxCandRoiTick+1, stopTick, threshold, roiCandidateVec);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    </div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">  489</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">ROIFinderMorphological::findROICandidatesDilation</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  differenceVec,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                       <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  erosionVec,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                       <span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp;  dilationVec,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                       <span class="keywordtype">int</span>              startTick,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                       <span class="keywordtype">int</span>              stopTick,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                       <span class="keywordtype">float</span>            threshold,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                       <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">CandidateROIVec</a>&amp; roiCandidateVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">int</span> roiLength = stopTick - startTick;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (roiLength &gt; 0)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// The idea here is to find the difference and use that as the seed for searching the</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// erosion and dilation vectors for the end points</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">//Waveform::const_iterator maxItr = std::max_element(differenceVec.begin()+startTick,differenceVec.begin()+stopTick,[](const auto&amp; left, const auto&amp; right){return std::fabs(left) &lt; std::fabs(right);});</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        Waveform::const_iterator maxItr = std::max_element(dilationVec.begin()+startTick,dilationVec.begin()+stopTick);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordtype">int</span>   maxTick     = std::distance(dilationVec.begin(),maxItr);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">float</span> maxDilation = *maxItr;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">// move forward to find the length of the top</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">while</span>(*maxItr == maxDilation) maxItr++;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordtype">int</span> deltaTicks = std::distance(dilationVec.begin(),maxItr) - maxTick;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">// No point continuing if not over threshold</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (maxDilation &gt; threshold)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="comment">// Start by finding maximum range of the erosion vector at this extremum</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordtype">int</span>  maxCandRoiTick = std::distance(dilationVec.begin(),maxItr);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="comment">// The test on the erosion vector takes care of special case of slowly rising pulses which are characteristic of</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="comment">// tracks running into the wire plane</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">while</span>(++maxCandRoiTick &lt; stopTick)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordtype">float</span> dilation = dilationVec.at(maxCandRoiTick);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordtype">float</span> erosion  = erosionVec.at(maxCandRoiTick);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">if</span> (dilation &lt; threshold &amp;&amp; erosion &lt; 0.5 * threshold) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            maxCandRoiTick = std::min(maxCandRoiTick,stopTick);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="comment">// Now do the dilation vector</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordtype">int</span>   minCandRoiTick = maxTick;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">while</span>(--minCandRoiTick &gt;= startTick)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="keywordtype">float</span> dilation = dilationVec.at(minCandRoiTick);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordtype">float</span> erosion  = erosionVec.at(minCandRoiTick);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="keywordflow">if</span> (dilation &lt; threshold &amp;&amp; erosion &lt; 0.5 * threshold) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">// make sure we have not gone under</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            minCandRoiTick = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(minCandRoiTick, startTick);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordtype">int</span> max2MinDiff = maxCandRoiTick - minCandRoiTick;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">fOutputHistograms</a> &amp;&amp; !(startTick &gt; 0 || stopTick &lt; <span class="keywordtype">int</span>(dilationVec.size())))</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="keywordtype">float</span> maxDifference = *std::max_element(differenceVec.begin() + minCandRoiTick, differenceVec.begin() + maxCandRoiTick);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">fMaxDiffLength</a>-&gt;Fill(std::min(deltaTicks,199), 1.);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">fDeltaTicksHist</a>-&gt;Fill(max2MinDiff, 1.);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">fDTixVDLenHist</a>-&gt;Fill(max2MinDiff, deltaTicks, 1.);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">fDTixVDiffHist</a>-&gt;Fill(max2MinDiff, maxDilation, 1.);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">fDiffVDilHist</a>-&gt;Fill(maxDifference, maxDilation, 1.);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="comment">// Make sure we have a legitimate candidate</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">if</span> ((max2MinDiff &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">fMax2MinDistance</a> || maxDilation &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">fMax2MinHeight</a>) &amp;&amp; deltaTicks &gt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">fMaxLengthCut</a>)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="comment">// Before saving this ROI, look for candidates preceeding this one</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="comment">// Note that preceeding snippet will reference to the current roiStartTick</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">findROICandidatesDilation</a>(differenceVec, erosionVec, dilationVec, startTick, minCandRoiTick, threshold, roiCandidateVec);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <span class="comment">// Save this ROI</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                roiCandidateVec.push_back(<a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#ad229ce67942c5ed0f0cc0e5cfe85423a">CandidateROI</a>(minCandRoiTick, maxCandRoiTick));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="comment">// Now look for candidate ROI&#39;s downstream of this one</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">findROICandidatesDilation</a>(differenceVec, erosionVec, dilationVec, maxCandRoiTick+1, stopTick, threshold, roiCandidateVec);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a799fa712ebbd02f108fc3c395ab882a4">  578</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a799fa712ebbd02f108fc3c395ab882a4">ROIFinderMorphological::smoothInputWaveform</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp; inputWaveform, <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a>&amp; outputWaveform)<span class="keyword"> const</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// Vector smoothing - take the 10 bin average</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">int</span>   halfBins = <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">fNumBinsToAve</a> / 2;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    outputWaveform.resize(inputWaveform.size());</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Make sure smoothing makes sense</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">if</span> (halfBins &gt; 0)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">// To facilitate handling the bins at the ends of the input waveform we embed in a slightly larger</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// vector which has zeroes on the ends</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">Waveform</a> tempWaveform(inputWaveform.size()+<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">fNumBinsToAve</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// Set the edge bins which can&#39;t be smoothed to zero</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="../../d0/da2/namespacetrkf.html#a70c1b5920b45babb363628ea6e073ea8">std::fill</a>(tempWaveform.begin(),tempWaveform.begin()+halfBins,0.);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="../../d0/da2/namespacetrkf.html#a70c1b5920b45babb363628ea6e073ea8">std::fill</a>(tempWaveform.end()-halfBins,tempWaveform.end(),0.);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment">// Copy in the input waveform</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputWaveform.begin(),inputWaveform.end(),tempWaveform.begin()+halfBins);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">// Now do the smoothing</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; inputWaveform.size(); idx++)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordtype">float</span> weightedSum(0.);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> wIdx = 0; wIdx &lt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">fNumBinsToAve</a>; wIdx++) weightedSum += <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">fAveWeightVec</a>.at(wIdx) * tempWaveform.at(idx + wIdx);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            outputWaveform.at(idx) = weightedSum / <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8ee2dbb4dab29a149c6190aa1afff2c1">fWeightSum</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputWaveform.begin(),inputWaveform.end(),outputWaveform.begin());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">  614</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">ROIFinderMorphological::initializeHistograms</a>(art::TFileDirectory&amp; histDir)<span class="keyword"> const</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// It is assumed that the input TFileDirectory has been set up to group histograms into a common</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// folder at the calling routine&#39;s level. Here we create one more level of indirection to keep</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// histograms made by this tool separate.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    std::string dirName = &quot;ROIFinderPlane_&quot; + std::to_string(fPlane);</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">    art::TFileDirectory dir = histDir.mkdir(dirName.c_str());</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">    auto const* detprop      = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">    double      samplingRate = detprop-&gt;SamplingRate();</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">    double      numBins      = fROIFinderVec.size();</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">    double      maxFreq      = 500. / samplingRate;</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">    std::string histName     = &quot;ROIFinderPlane_&quot; + std::to_string(fPlane);</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">    TH1D*       hist         = dir.make&lt;TH1D&gt;(histName.c_str(), &quot;ROIFinder;Frequency(MHz)&quot;, numBins, 0., maxFreq);</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">    for(int bin = 0; bin &lt; numBins; bin++)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">        double freq = maxFreq * double(bin + 0.5) / double(numBins);</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">        hist-&gt;Fill(freq, fROIFinderVec.at(bin).Re());</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    </div>
<div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a72c315d0081c9a58b372c3054b9004fa">  643</a></span>&#160;<a class="code" href="../../da/d1c/namespaceicarus__tool.html#a83e7e6148aa9b19785b3f944e7ebb15a">icarus_tool::HistogramMap</a> <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">ROIFinderMorphological::initializeHistograms</a>(<span class="keywordtype">size_t</span> channel, <span class="keywordtype">size_t</span> cnt, <span class="keywordtype">size_t</span> waveformSize)<span class="keyword"> const</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="../../da/d1c/namespaceicarus__tool.html#a83e7e6148aa9b19785b3f944e7ebb15a">icarus_tool::HistogramMap</a> histogramMap;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">fOutputWaveforms</a>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">// Try to limit to the wire number (since we are already segregated by plane)</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        std::vector&lt;geo::WireID&gt; wids  = <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a6c636e2a3d5536799bf0be000a06fe97">fGeometry</a>-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">ChannelToWire</a>(channel);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordtype">size_t</span>                   cryo  = wids[0].Cryostat;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordtype">size_t</span>                   tpc   = wids[0].TPC;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">//        size_t                   plane = wids[0].Plane;</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordtype">size_t</span>                   wire  = wids[0].Wire;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// Make a directory for these histograms</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        art::TFileDirectory <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">fHistDirectory</a>-&gt;mkdir(Form(<span class="stringliteral">&quot;Event_%03zu/C%1zuT%1zuP%1zu/Wire_%05zu&quot;</span>,cnt,cryo,tpc,<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a>,wire));</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">// We keep track of four histograms:</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">try</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            histogramMap[<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6cfa0db481bd5c3c3843c80711da0fce">icarus_tool::WAVEFORM</a>] =</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;SmoothWaveform&quot;</span>, <span class="stringliteral">&quot;Waveform&quot;</span>,       waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            histogramMap[<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa56f86a4339f07e7f0ebac817f6ff09b3">icarus_tool::EROSION</a>] =</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;Erosion&quot;</span>,        <span class="stringliteral">&quot;Erosion&quot;</span>,        waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            histogramMap[<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa0c5e32b6c368a7c4b4651536cbf03f8f">icarus_tool::DILATION</a>] =</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;Dilation&quot;</span>,       <span class="stringliteral">&quot;Dilation&quot;</span>,       waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            histogramMap[<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa91cdbe8d970368ba6f45b1e373645a69">icarus_tool::AVERAGE</a>] =</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;Average&quot;</span>,        <span class="stringliteral">&quot;Average&quot;</span>,        waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            histogramMap[<a class="code" href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6020ef468ba817871321f4db82267719">icarus_tool::DIFFERENCE</a>] =</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;Difference&quot;</span>,     <span class="stringliteral">&quot;Difference&quot;</span>,     waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="comment">// This is a kludge so that the ROI histogram ends up in the same diretory as the waveforms</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            histogramMap[<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">ROIHISTOGRAM</a>] =</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;ROI&quot;</span>,            <span class="stringliteral">&quot;ROI&quot;</span>,            waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="comment">// Keep kludging so we can see the truncated mean and threshold that gets applied</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            histogramMap[<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65">TRUNCMEANHIST</a>] =</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;TruncatedMean&quot;</span>,  <span class="stringliteral">&quot;Truncated Mean&quot;</span>, waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            histogramMap[<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289">TRUNCRMSHIST</a>] =</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;TruncatedRMS&quot;</span>,   <span class="stringliteral">&quot;Truncated rms&quot;</span>,  waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="comment">// Also, if smoothing then we would like to keep track of the original waveform too</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            histogramMap[<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84">WAVEFORMHIST</a>] =</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    dir.make&lt;TProfile&gt;(<span class="stringliteral">&quot;InputWaveform&quot;</span>,  <span class="stringliteral">&quot;Waveform&quot;</span>,       waveformSize, 0, waveformSize, -500., 500.);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        } <span class="keywordflow">catch</span>(...)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Caught exception trying to make new hists, tpc,plane,cnt,wire: &quot;</span> &lt;&lt; tpc &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">fPlane</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; wire &lt;&lt; std::endl;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">return</span> histogramMap;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;}</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;DEFINE_ART_CLASS_TOOL(<a class="code" href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html">ROIFinderMorphological</a>)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aeae2c03b5b08ad8d43cd184715b723a9"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeae2c03b5b08ad8d43cd184715b723a9">icarus_tool::ROIFinderMorphological::fOutputHistograms</a></div><div class="ttdeci">bool fOutputHistograms</div><div class="ttdoc">Output histograms? </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00084">ROIFinderMorphological_tool.cc:84</a></div></div>
<div class="ttc" id="namespaceicarus_1_1waveform__operations_1_1details_html_ae295d3f6cb2f9181dccdf0e3492d44e0"><div class="ttname"><a href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">icarus::waveform_operations::details::transform</a></div><div class="ttdeci">static constexpr Sample_t transform(Sample_t sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/WaveformOperations_8h_source.html#l00145">WaveformOperations.h:145</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_ab5b19c0828f5d5c350672380951e06d2"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ab5b19c0828f5d5c350672380951e06d2">icarus_tool::ROIFinderMorphological::fDTruncBinsHist</a></div><div class="ttdeci">TH1F * fDTruncBinsHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00096">ROIFinderMorphological_tool.cc:96</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aa55f5944375c9ee3fd9b0ed44434b1c5"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa55f5944375c9ee3fd9b0ed44434b1c5">icarus_tool::ROIFinderMorphological::fMax2MinHeight</a></div><div class="ttdeci">float fMax2MinHeight</div><div class="ttdoc">Minimum peak to peak height (box cut) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00078">ROIFinderMorphological_tool.cc:78</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a1b37be19aa94afd321e3dfa463773a9c"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a1b37be19aa94afd321e3dfa463773a9c">icarus_tool::ROIFinderMorphological::fDiffMeanHist</a></div><div class="ttdeci">TH1F * fDiffMeanHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00093">ROIFinderMorphological_tool.cc:93</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_ad220f97e47cc60d8601d86ee6c874ff8"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad220f97e47cc60d8601d86ee6c874ff8">icarus_tool::ROIFinderMorphological::fStructuringElement</a></div><div class="ttdeci">int fStructuringElement</div><div class="ttdoc">The window size. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00080">ROIFinderMorphological_tool.cc:80</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a901764510d8012b56ffed8b9f56b1e7c"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a901764510d8012b56ffed8b9f56b1e7c">icarus_tool::ROIFinderMorphological::FindROIs</a></div><div class="ttdeci">void FindROIs(const Waveform &amp;, size_t, size_t, double, CandidateROIVec &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00202">ROIFinderMorphological_tool.cc:202</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a3a2d66774cca2022906d490a723e4514"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a3a2d66774cca2022906d490a723e4514">icarus_tool::ROIFinderMorphological::ROIFinderMorphological</a></div><div class="ttdeci">ROIFinderMorphological(const fhicl::ParameterSet &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00115">ROIFinderMorphological_tool.cc:115</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a44e4cd350d409ce27f60def34c69fa39"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a44e4cd350d409ce27f60def34c69fa39">icarus_tool::ROIFinderMorphological::fNumBinsToAve</a></div><div class="ttdeci">int fNumBinsToAve</div><div class="ttdoc">Controls the smoothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00076">ROIFinderMorphological_tool.cc:76</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a4e0ce605be56f88c1019c6619cbcb316"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a4e0ce605be56f88c1019c6619cbcb316">icarus_tool::ROIFinderMorphological::fDTixVDLenHist</a></div><div class="ttdeci">TH2F * fDTixVDLenHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00103">ROIFinderMorphological_tool.cc:103</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_afe88589464f9d52e2ee01b39d267a4a2"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe88589464f9d52e2ee01b39d267a4a2">icarus_tool::ROIFinderMorphological::fMaxLengthCut</a></div><div class="ttdeci">int fMaxLengthCut</div><div class="ttdoc">Minimum length of the maximum. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00079">ROIFinderMorphological_tool.cc:79</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a0c5d3db5d5490bc3fc8fb3bbdb282f36"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a0c5d3db5d5490bc3fc8fb3bbdb282f36">geo::GeometryCore::ChannelToWire</a></div><div class="ttdeci">std::vector&lt; geo::WireID &gt; ChannelToWire(raw::ChannelID_t const channel) const </div><div class="ttdoc">Returns a list of wires connected to the specified TPC channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01107">GeometryCore.cxx:1107</a></div></div>
<div class="ttc" id="classicarus__tool_1_1IROIFinder_html_a12a32f6e1338c584273217dbc4fb6378"><div class="ttname"><a href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a12a32f6e1338c584273217dbc4fb6378">icarus_tool::IROIFinder::CandidateROIVec</a></div><div class="ttdeci">std::vector&lt; CandidateROI &gt; CandidateROIVec</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00056">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:56</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa56f86a4339f07e7f0ebac817f6ff09b3"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa56f86a4339f07e7f0ebac817f6ff09b3">icarus_tool::EROSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00030">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:30</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa91cdbe8d970368ba6f45b1e373645a69"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa91cdbe8d970368ba6f45b1e373645a69">icarus_tool::AVERAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00032">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:32</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a8ee2dbb4dab29a149c6190aa1afff2c1"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8ee2dbb4dab29a149c6190aa1afff2c1">icarus_tool::ROIFinderMorphological::fWeightSum</a></div><div class="ttdeci">float fWeightSum</div><div class="ttdoc">sum of weights for smoothing </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00088">ROIFinderMorphological_tool.cc:88</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a61859f1bce3d2a8caf6596638d69ff36"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a61859f1bce3d2a8caf6596638d69ff36">icarus_tool::ROIFinderMorphological::initializeHistograms</a></div><div class="ttdeci">void initializeHistograms(art::TFileDirectory &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00614">ROIFinderMorphological_tool.cc:614</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a6c636e2a3d5536799bf0be000a06fe97"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a6c636e2a3d5536799bf0be000a06fe97">icarus_tool::ROIFinderMorphological::fGeometry</a></div><div class="ttdeci">const geo::GeometryCore * fGeometry</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00110">ROIFinderMorphological_tool.cc:110</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_ae13ae5e1830cca98019f8f09ae89bd61"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae13ae5e1830cca98019f8f09ae89bd61">icarus_tool::ROIFinderMorphological::fMaxPadLen</a></div><div class="ttdeci">unsigned short fMaxPadLen</div><div class="ttdoc">Don&amp;#39;t let padding be larger than this. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00083">ROIFinderMorphological_tool.cc:83</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a0d985e4639469fc4b5cd52295ae98cad"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0d985e4639469fc4b5cd52295ae98cad">icarus_tool::ROIFinderMorphological::fOutputWaveforms</a></div><div class="ttdeci">bool fOutputWaveforms</div><div class="ttdoc">Output waveforms? </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00085">ROIFinderMorphological_tool.cc:85</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aaeab603efdd04971f1c9eaadeba1766d"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aaeab603efdd04971f1c9eaadeba1766d">icarus_tool::ROIFinderMorphological::fDiffRmsHist</a></div><div class="ttdeci">TH1F * fDiffRmsHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00094">ROIFinderMorphological_tool.cc:94</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a8e02cad25021ff846a059580a24b48b7"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a8e02cad25021ff846a059580a24b48b7">icarus_tool::ROIFinderMorphological::fWaveformTool</a></div><div class="ttdeci">icarus_signal_processing::WaveformTools&lt; float &gt; fWaveformTool</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00107">ROIFinderMorphological_tool.cc:107</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa0c5e32b6c368a7c4b4651536cbf03f8f"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa0c5e32b6c368a7c4b4651536cbf03f8f">icarus_tool::DILATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00031">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:31</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a34ec3b7e82e803e8b33a27353bcfd3ac"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a34ec3b7e82e803e8b33a27353bcfd3ac">icarus_tool::ROIFinderMorphological::fThresholdHist</a></div><div class="ttdeci">TH1F * fThresholdHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00099">ROIFinderMorphological_tool.cc:99</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_ae3c3fea1c28709101b6e34f76f86453e"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ae3c3fea1c28709101b6e34f76f86453e">icarus_tool::ROIFinderMorphological::fDTixVDiffHist</a></div><div class="ttdeci">TH2F * fDTixVDiffHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00104">ROIFinderMorphological_tool.cc:104</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a244691dc8e40dc7df6402e6b05419289">icarus_tool::ROIFinderMorphological::TRUNCRMSHIST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00066">ROIFinderMorphological_tool.cc:66</a></div></div>
<div class="ttc" id="icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_html"><div class="ttname"><a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h.html">IROIFinder.h</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html">icarus_tool::ROIFinderMorphological</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00026">ROIFinderMorphological_tool.cc:26</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a3b35338e94ee0a5b25d2499308675f65">icarus_tool::ROIFinderMorphological::TRUNCMEANHIST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00065">ROIFinderMorphological_tool.cc:65</a></div></div>
<div class="ttc" id="classicarus__tool_1_1IROIFinder_html_a4b23786331b1347d64f0277c05469d42"><div class="ttname"><a href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#a4b23786331b1347d64f0277c05469d42">icarus_tool::IROIFinder::Waveform</a></div><div class="ttdeci">std::vector&lt; float &gt; Waveform</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00052">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:52</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a610bc053243595343741943eb2cbd5fb"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a610bc053243595343741943eb2cbd5fb">icarus_tool::ROIFinderMorphological::plane</a></div><div class="ttdeci">size_t plane() const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00035">ROIFinderMorphological_tool.cc:35</a></div></div>
<div class="ttc" id="namespacetrkf_html_a70c1b5920b45babb363628ea6e073ea8"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a70c1b5920b45babb363628ea6e073ea8">trkf::fill</a></div><div class="ttdeci">void fill(const art::PtrVector&lt; recob::Hit &gt; &amp;hits, int only_plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d74/KHitContainer_8cxx_source.html#l00018">KHitContainer.cxx:18</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a></div><div class="ttdoc">Description of geometry of one entire detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01468">GeometryCore.h:1468</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a22df09fa5bc41b8f54f7e2d9944df551"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a22df09fa5bc41b8f54f7e2d9944df551">icarus_tool::ROIFinderMorphological::fMax2MinDistance</a></div><div class="ttdeci">int fMax2MinDistance</div><div class="ttdoc">Minimum allow peak to peak distance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00077">ROIFinderMorphological_tool.cc:77</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a33307f922be80c754713a1775d079047"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047">icarus_tool::ROIFinderMorphological::HistogramType</a></div><div class="ttdeci">HistogramType</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00062">ROIFinderMorphological_tool.cc:62</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a0ad3b1724f83e3c4881f4059ebc0ff5c"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0ad3b1724f83e3c4881f4059ebc0ff5c">icarus_tool::ROIFinderMorphological::fDiffVDilHist</a></div><div class="ttdeci">TH2F * fDiffVDilHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00105">ROIFinderMorphological_tool.cc:105</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_afe41d2ecd57a4616b82d5bbfeab4d7c3"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#afe41d2ecd57a4616b82d5bbfeab4d7c3">icarus_tool::ROIFinderMorphological::~ROIFinderMorphological</a></div><div class="ttdeci">~ROIFinderMorphological()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00120">ROIFinderMorphological_tool.cc:120</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classicarus__tool_1_1IROIFinder_html"><div class="ttname"><a href="../../d2/d32/classicarus__tool_1_1IROIFinder.html">icarus_tool::IROIFinder</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00042">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:42</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a39a53503ce31909397545ba41799660a"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39a53503ce31909397545ba41799660a">icarus_tool::ROIFinderMorphological::fNumSigma</a></div><div class="ttdeci">float fNumSigma</div><div class="ttdoc">&amp;quot;# sigma&amp;quot; rms noise for ROI threshold </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00075">ROIFinderMorphological_tool.cc:75</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047a87066d1f67123e864eaf8cce6e5a5e84">icarus_tool::ROIFinderMorphological::WAVEFORMHIST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00067">ROIFinderMorphological_tool.cc:67</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a0fd3c5606a9d1cef0b65148689a8c5c5"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0fd3c5606a9d1cef0b65148689a8c5c5">icarus_tool::ROIFinderMorphological::fNumSigmaHist</a></div><div class="ttdeci">TH1F * fNumSigmaHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00098">ROIFinderMorphological_tool.cc:98</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa6cfa0db481bd5c3c3843c80711da0fce"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6cfa0db481bd5c3c3843c80711da0fce">icarus_tool::WAVEFORM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00028">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:28</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a2c7e15312549ce4df4f805888e8e7178"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a2c7e15312549ce4df4f805888e8e7178">icarus_tool::ROIFinderMorphological::fNumSigNextHist</a></div><div class="ttdeci">TH1F * fNumSigNextHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00100">ROIFinderMorphological_tool.cc:100</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_acb9b83587ab85c2dc95637f16db8db5e"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#acb9b83587ab85c2dc95637f16db8db5e">icarus_tool::ROIFinderMorphological::findROICandidatesDifference</a></div><div class="ttdeci">void findROICandidatesDifference(const Waveform &amp;, const Waveform &amp;, const Waveform &amp;, int, int, float, CandidateROIVec &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00396">ROIFinderMorphological_tool.cc:396</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a061327888f2b2526f2ed04eb07278d8c"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a061327888f2b2526f2ed04eb07278d8c">icarus_tool::ROIFinderMorphological::fDeltaTicksHist</a></div><div class="ttdeci">TH1F * fDeltaTicksHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00102">ROIFinderMorphological_tool.cc:102</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_ad95d5b68e9a33085d3ca4a7eaf3389f1"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#ad95d5b68e9a33085d3ca4a7eaf3389f1">icarus_tool::ROIFinderMorphological::fMaxDiffLength</a></div><div class="ttdeci">TH1F * fMaxDiffLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00101">ROIFinderMorphological_tool.cc:101</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a799fa712ebbd02f108fc3c395ab882a4"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a799fa712ebbd02f108fc3c395ab882a4">icarus_tool::ROIFinderMorphological::smoothInputWaveform</a></div><div class="ttdeci">void smoothInputWaveform(const Waveform &amp;, Waveform &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00578">ROIFinderMorphological_tool.cc:578</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a0a74eafa9f094871d8a8b093a9cf2153"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a0a74eafa9f094871d8a8b093a9cf2153">icarus_tool::ROIFinderMorphological::fDiffMaxHist</a></div><div class="ttdeci">TH1F * fDiffMaxHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00097">ROIFinderMorphological_tool.cc:97</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aa15e3d1acc71c11cdcf6418c01a430a7"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa15e3d1acc71c11cdcf6418c01a430a7">icarus_tool::ROIFinderMorphological::configure</a></div><div class="ttdeci">void configure(const fhicl::ParameterSet &amp;pset) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00124">ROIFinderMorphological_tool.cc:124</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a946dc827dce74621daf8c0dab68bb2bb"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a946dc827dce74621daf8c0dab68bb2bb">icarus_tool::ROIFinderMorphological::findROICandidatesDilation</a></div><div class="ttdeci">void findROICandidatesDilation(const Waveform &amp;, const Waveform &amp;, const Waveform &amp;, int, int, float, CandidateROIVec &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00489">ROIFinderMorphological_tool.cc:489</a></div></div>
<div class="ttc" id="RangeForWrapper__test_8cc_html_a2a47a7f29f0ddd7ff5d68f8aff63125c"><div class="ttname"><a href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">copy</a></div><div class="ttdeci">T copy(T const &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd6/RangeForWrapper__test_8cc_source.html#l00098">RangeForWrapper_test.cc:98</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a5dadafd522b20c06eb41e617bc07bc90"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a5dadafd522b20c06eb41e617bc07bc90">icarus_tool::ROIFinderMorphological::fUseDifference</a></div><div class="ttdeci">bool fUseDifference</div><div class="ttdoc">If true use differences, else dilation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00074">ROIFinderMorphological_tool.cc:74</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aa1c0513a119e3b0be2dc1ba81df70fd0"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aa1c0513a119e3b0be2dc1ba81df70fd0">icarus_tool::ROIFinderMorphological::fPreROIPad</a></div><div class="ttdeci">unsigned short fPreROIPad</div><div class="ttdoc">ROI padding. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00081">ROIFinderMorphological_tool.cc:81</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aafc920cbb570db7242df3289a2666c09"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aafc920cbb570db7242df3289a2666c09">icarus_tool::ROIFinderMorphological::fHistDirectory</a></div><div class="ttdeci">art::TFileDirectory * fHistDirectory</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00090">ROIFinderMorphological_tool.cc:90</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a39e90f95b471ce8622d90683e541b18c"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a39e90f95b471ce8622d90683e541b18c">icarus_tool::ROIFinderMorphological::fAveWeightVec</a></div><div class="ttdeci">std::vector&lt; float &gt; fAveWeightVec</div><div class="ttdoc">Weight vector for smoothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00087">ROIFinderMorphological_tool.cc:87</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00253">NuVertexChargeTree_module.cc:253</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a10f8b8d8613875b2fad100c368a4c8ea"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a10f8b8d8613875b2fad100c368a4c8ea">icarus_tool::ROIFinderMorphological::fPlane</a></div><div class="ttdeci">size_t fPlane</div><div class="ttdoc">Tool can be plane dependent. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00073">ROIFinderMorphological_tool.cc:73</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_a83e7e6148aa9b19785b3f944e7ebb15a"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#a83e7e6148aa9b19785b3f944e7ebb15a">icarus_tool::HistogramMap</a></div><div class="ttdeci">std::map&lt; int, TProfile * &gt; HistogramMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00040">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:40</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_abc4e0b0ea83f991b2b2537c3f902ad83"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#abc4e0b0ea83f991b2b2537c3f902ad83">icarus_tool::ROIFinderMorphological::fDiffFullRmsHist</a></div><div class="ttdeci">TH1F * fDiffFullRmsHist</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00095">ROIFinderMorphological_tool.cc:95</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_aeaa297ea4f5bb934454ba09fa01bdacb"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#aeaa297ea4f5bb934454ba09fa01bdacb">icarus_tool::ROIFinderMorphological::fPostROIPad</a></div><div class="ttdeci">unsigned short fPostROIPad</div><div class="ttdoc">ROI padding. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00082">ROIFinderMorphological_tool.cc:82</a></div></div>
<div class="ttc" id="classicarus__tool_1_1IROIFinder_html_ad229ce67942c5ed0f0cc0e5cfe85423a"><div class="ttname"><a href="../../d2/d32/classicarus__tool_1_1IROIFinder.html#ad229ce67942c5ed0f0cc0e5cfe85423a">icarus_tool::IROIFinder::CandidateROI</a></div><div class="ttdeci">std::pair&lt; size_t, size_t &gt; CandidateROI</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00055">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:55</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa6020ef468ba817871321f4db82267719"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa6020ef468ba817871321f4db82267719">icarus_tool::DIFFERENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00033">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:33</a></div></div>
<div class="ttc" id="namespaceicarus__tool_html_afe7e4716cb5a3347ba8de71a6476b45aa95d176c172abe5939928e864b76ae5ae"><div class="ttname"><a href="../../da/d1c/namespaceicarus__tool.html#afe7e4716cb5a3347ba8de71a6476b45aa95d176c172abe5939928e864b76ae5ae">icarus_tool::LASTELEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8e/icaruscode_2icaruscode_2TPC_2SignalProcessing_2RecoWire_2DeconTools_2IROIFinder_8h_source.html#l00037">icaruscode/icaruscode/TPC/SignalProcessing/RecoWire/DeconTools/IROIFinder.h:37</a></div></div>
<div class="ttc" id="classicarus__tool_1_1ROIFinderMorphological_html_a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8"><div class="ttname"><a href="../../d3/dfe/classicarus__tool_1_1ROIFinderMorphological.html#a33307f922be80c754713a1775d079047abd79d9d6410a3cb2ab7d0e3a8c0db1a8">icarus_tool::ROIFinderMorphological::ROIHISTOGRAM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d0e/ROIFinderMorphological__tool_8cc_source.html#l00064">ROIFinderMorphological_tool.cc:64</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
