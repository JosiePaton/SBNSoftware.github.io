<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>WaveformTools_tool.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_ebc1b529cb5032f145478a845d3c2aab.html">HitFinder</a></li><li class="navelem"><a class="el" href="../../dir_fadedfc9b2cb72fbf6dbc1b75590865c.html">HitFinderTools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">WaveformTools_tool.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d42/WaveformTools__tool_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">/// \file   WaveformTools_tool.cc</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \author T. Usher</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span> <span class="comment">// std::inner_product</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/dd0/IWaveformTool_8h.html">larreco/HitFinder/HitFinderTools/IWaveformTool.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;art/Utilities/ToolMacros.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;TVirtualFFT.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">namespace </span>reco_tool</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html">   16</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html">WaveformTools</a> : <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html">IWaveformTool</a></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a4e27f030d75df7bdbe5be5914361f17c">WaveformTools</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a6c7366341d76dd3deb73c21add773abf">   21</a></span>&#160;    <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a6c7366341d76dd3deb73c21add773abf">~WaveformTools</a>() {}</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aae5338b4eda5de45ed29053a637bd7f5">configure</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)  <span class="keyword">override</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ab17bb7b3ba2f28c6d8f5fd48e1b1a0ca">   25</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a93734d72d6b6f4d454d3b6a2f6f3310b">PeakTuple</a>    = std::tuple&lt;size_t,size_t,size_t&gt;; <span class="comment">// first bin, peak bin, last bin</span></div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a4f86001dcb89a590b420011b7d44be2e">   26</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a> = std::vector&lt;PeakTuple&gt;;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp;,  std::vector&lt;float&gt;&amp;,  <span class="keywordtype">size_t</span> = 0)                           <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, <span class="keywordtype">size_t</span> = 0)                           <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">medianSmooth</a>(  <span class="keyword">const</span> std::vector&lt;float&gt;&amp;,  std::vector&lt;float&gt;&amp;,  <span class="keywordtype">size_t</span> = 3)                           <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">medianSmooth</a>(  <span class="keyword">const</span> std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, <span class="keywordtype">size_t</span> = 3)                           <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp;, <span class="keywordtype">double</span>&amp;, <span class="keywordtype">double</span>&amp;, <span class="keywordtype">double</span>&amp;, <span class="keywordtype">int</span>&amp;)                       <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp;, <span class="keywordtype">float</span>&amp;, <span class="keywordtype">float</span>&amp;, <span class="keywordtype">float</span>&amp;, <span class="keywordtype">int</span>&amp;)                           <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp;,  std::vector&lt;float&gt;&amp;)                                       <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;)                                      <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">findPeaks</a>(std::vector&lt;float&gt;::iterator,  std::vector&lt;float&gt;::iterator,  <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp;, <span class="keywordtype">float</span>, <span class="keywordtype">size_t</span>)  <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">findPeaks</a>(std::vector&lt;double&gt;::iterator, std::vector&lt;double&gt;::iterator, <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp;, <span class="keywordtype">double</span>, <span class="keywordtype">size_t</span>) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">getFFTPower</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec, std::vector&lt;float&gt;&amp; outputPowerVec)                    <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">getFFTPower</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; inputVec, std::vector&lt;double&gt;&amp; outputPowerVec)                  <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                             <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;)         <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                             <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;)         <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                             <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                             <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;)         <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,  <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,  <span class="keywordtype">int</span>, <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;, <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;,  <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;)  <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,  <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,  <span class="keywordtype">int</span>, <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;, <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;,  <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;)  <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;, <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;, <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;, <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp;, std::vector&lt;T&gt;&amp;, <span class="keywordtype">size_t</span> = 0)                                        <span class="keyword">const</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">medianSmooth</a>(  <span class="keyword">const</span> std::vector&lt;T&gt;&amp;, std::vector&lt;T&gt;&amp;, <span class="keywordtype">size_t</span> = 3)                                        <span class="keyword">const</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp;, T&amp;, T&amp;, T&amp;, <span class="keywordtype">int</span>&amp;)                                              <span class="keyword">const</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp;,  std::vector&lt;T&gt;&amp;)                                                  <span class="keyword">const</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">findPeaks</a>(<span class="keyword">typename</span> std::vector&lt;T&gt;::iterator, <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator, <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp;, T, <span class="keywordtype">size_t</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                                                   <span class="keywordtype">int</span>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                                   <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                                   <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                                   <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                                   <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                                   <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,  <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,  <span class="keywordtype">int</span>, <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;, <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;,  <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;)  <span class="keyword">const</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;};</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// Constructor.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a4e27f030d75df7bdbe5be5914361f17c">   87</a></span>&#160;<a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a4e27f030d75df7bdbe5be5914361f17c">WaveformTools::WaveformTools</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aae5338b4eda5de45ed29053a637bd7f5">configure</a>(pset);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aae5338b4eda5de45ed29053a637bd7f5">   92</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aae5338b4eda5de45ed29053a637bd7f5">WaveformTools::configure</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// Start by recovering the parameters</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//    fThisPlane       = pset.get&lt;size_t&gt;(&quot;Plane&quot;);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1686120e96548f191f73df40f2f027cf">  100</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">WaveformTools::triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; inputVec, std::vector&lt;double&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> lowestBin)<span class="keyword"> const</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    triangleSmooth&lt;double&gt;(inputVec, smoothVec, lowestBin);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">  107</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">WaveformTools::triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec, std::vector&lt;float&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> lowestBin)<span class="keyword"> const</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    triangleSmooth&lt;float&gt;(inputVec, smoothVec, lowestBin);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1327ae56cfeebfafaa59dc0391d9aa6b">  114</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">WaveformTools::triangleSmooth</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; inputVec, std::vector&lt;T&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> lowestBin)<span class="keyword"> const</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (inputVec.size() != smoothVec.size()) smoothVec.resize(inputVec.size());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Watch for edge condition</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (inputVec.size() &gt; 4)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputVec.begin(), inputVec.begin() + 2 + lowestBin, smoothVec.begin());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputVec.end() - 2, inputVec.end(), smoothVec.end() - 2);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator       curItr    = smoothVec.begin() + 2 + lowestBin;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">typename</span> std::vector&lt;T&gt;::const_iterator curInItr  = inputVec.begin()  + 1 + lowestBin;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keyword">typename</span> std::vector&lt;T&gt;::const_iterator stopInItr = inputVec.end()    - 3;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">while</span>(curInItr++ != stopInItr)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">// Take the weighted average of five consecutive points centered on current point</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            T newVal = (*(curInItr - 2) + 2. * *(curInItr - 1) + 3. * *curInItr + 2. * *(curInItr + 1) + *(curInItr + 2)) / 9.;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            *curItr++ = newVal;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputVec.begin(), inputVec.end(), smoothVec.begin());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">  141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">WaveformTools::medianSmooth</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp;inputVec, std::vector&lt;float&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> nBins)<span class="keyword"> const</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    medianSmooth&lt;float&gt;(inputVec, smoothVec, nBins);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1c0594c5b6736db4a548caf0bc613310">  148</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">WaveformTools::medianSmooth</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; inputVec, std::vector&lt;double&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> nBins)<span class="keyword"> const</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    medianSmooth&lt;double&gt;(inputVec, smoothVec, nBins);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a8aa758a92d6e950f0a1d5a6d6a429ffb">  155</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">WaveformTools::medianSmooth</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; inputVec, std::vector&lt;T&gt;&amp; smoothVec, <span class="keywordtype">size_t</span> nBins)<span class="keyword"> const</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// For our purposes, nBins must be odd</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (nBins % 2 == 0) nBins++;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// Make sure the input vector is right sized</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (inputVec.size() != smoothVec.size()) smoothVec.resize(inputVec.size());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Basic set up</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">typename</span> std::vector&lt;T&gt; medianVec(nBins);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">typename</span> std::vector&lt;T&gt;::const_iterator startItr = inputVec.begin();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">typename</span> std::vector&lt;T&gt;::const_iterator stopItr  = startItr;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    std::advance(stopItr, inputVec.size() - nBins);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">size_t</span> medianBin = nBins/2;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">size_t</span> smoothBin = medianBin;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// First bins are not smoothed</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(startItr, startItr + medianBin, smoothVec.begin());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">while</span>(std::distance(startItr,stopItr) &gt; 0)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(startItr,startItr+nBins,medianVec.begin());</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        std::sort(medianVec.begin(),medianVec.end());</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        T medianVal = medianVec[medianBin];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        smoothVec[smoothBin++] = medianVal;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        startItr++;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// Last bins are not smoothed</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(startItr + medianBin, inputVec.end(), smoothVec.begin() + smoothBin);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">  194</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">WaveformTools::getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; waveform, <span class="keywordtype">double</span>&amp; <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>, <span class="keywordtype">double</span>&amp; rmsFull, <span class="keywordtype">double</span>&amp; rmsTrunc, <span class="keywordtype">int</span>&amp; nTrunc)<span class="keyword"> const</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    getTruncatedMeanRMS&lt;double&gt;(waveform, <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>, rmsFull, rmsTrunc, nTrunc);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a956aec9a31cab3ea73927c38863d8763">  199</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">WaveformTools::getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; waveform, <span class="keywordtype">float</span>&amp; <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>, <span class="keywordtype">float</span>&amp; rmsFull, <span class="keywordtype">float</span>&amp; rmsTrunc, <span class="keywordtype">int</span>&amp; nTrunc)<span class="keyword"> const</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    getTruncatedMeanRMS&lt;float&gt;(waveform, <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>, rmsFull, rmsTrunc, nTrunc);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#afbbf4e34f0654522a52478c9557a138a">  204</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">WaveformTools::getTruncatedMeanRMS</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; waveform, T&amp; <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>, T&amp; rmsFull, T&amp; rmsTrunc, <span class="keywordtype">int</span>&amp; nTrunc)<span class="keyword"> const</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// We need to get a reliable estimate of the mean and can&#39;t assume the input waveform will be ~zero mean...</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Basic idea is to find the most probable value in the ROI presented to us</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// From that we can develop an average of the true baseline of the ROI.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// To do that we employ a map based scheme</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    std::map&lt;int,int&gt; frequencyMap;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">int</span>               mpCount(0);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">int</span>               mpVal(0);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val : waveform)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">int</span> intVal = std::round(4.*val);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        frequencyMap[intVal]++;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (frequencyMap.at(intVal) &gt; mpCount)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            mpCount = frequencyMap.at(intVal);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            mpVal   = intVal;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// take a weighted average of two neighbor bins</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> meanCnt  = 0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">int</span> meanSum  = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">int</span> binRange = std::min(16, <span class="keywordtype">int</span>(frequencyMap.size()/2 + 1));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> idx = -binRange; idx &lt;= binRange; idx++)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        std::map&lt;int,int&gt;::iterator neighborItr = frequencyMap.find(mpVal+idx);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (neighborItr != frequencyMap.end() &amp;&amp; 5 * neighborItr-&gt;second &gt; mpCount)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            meanSum += neighborItr-&gt;first * neighborItr-&gt;second;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            meanCnt += neighborItr-&gt;second;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    mean = 0.25 * T(meanSum) / T(meanCnt);  <span class="comment">// Note that bins were expanded by a factor of 4 above</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// do rms calculation - the old fashioned way and over all adc values</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">typename</span> std::vector&lt;T&gt; locWaveform = waveform;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(locWaveform.begin(), locWaveform.end(), locWaveform.begin(),std::bind(std::minus&lt;T&gt;(),std::placeholders::_1,mean));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// sort in ascending order so we can truncate the sume</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    std::sort(locWaveform.begin(), locWaveform.end(),[](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>){<span class="keywordflow">return</span> std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>) &lt; std::fabs(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>);});</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// recalculate the rms for truncation</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    rmsFull = std::inner_product(locWaveform.begin(), locWaveform.end(), locWaveform.begin(), 0.);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    rmsFull = std::sqrt(<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(T(0.),rmsFull / T(locWaveform.size())));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// recalculate the rms for truncation</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    rmsTrunc = std::inner_product(locWaveform.begin(), locWaveform.begin() + meanCnt, locWaveform.begin(), 0.);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    rmsTrunc = std::sqrt(<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(T(0.),rmsTrunc / T(meanCnt)));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    nTrunc   = meanCnt;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a8ebe9c5722a7372af26f612b71740728">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">WaveformTools::firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; inputVec, std::vector&lt;double&gt;&amp; derivVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    firstDerivative&lt;double&gt;(inputVec, derivVec);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">  272</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">WaveformTools::firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec, std::vector&lt;float&gt;&amp; derivVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    firstDerivative&lt;float&gt;(inputVec, derivVec);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ae9e201dfcc1896d9d426a39ea4b90683">  279</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">WaveformTools::firstDerivative</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; inputVec, std::vector&lt;T&gt;&amp; derivVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    derivVec.resize(inputVec.size(), 0.);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 1; idx &lt; derivVec.size() - 1; idx++)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        derivVec.at(idx) = 0.5 * (inputVec.at(idx + 1) - inputVec.at(idx - 1));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a3f0fabcc5ab750470dc1e5a65753358e">  289</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">WaveformTools::findPeaks</a>(std::vector&lt;double&gt;::iterator startItr, std::vector&lt;double&gt;::iterator stopItr, <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp; peakTupleVec, <span class="keywordtype">double</span> threshold, <span class="keywordtype">size_t</span> firstTick)<span class="keyword"> const</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    findPeaks&lt;double&gt;(startItr, stopItr, peakTupleVec, threshold, firstTick);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">  296</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">WaveformTools::findPeaks</a>(std::vector&lt;float&gt;::iterator startItr, std::vector&lt;float&gt;::iterator stopItr, <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp; peakTupleVec, <span class="keywordtype">float</span> threshold, <span class="keywordtype">size_t</span> firstTick)<span class="keyword"> const</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    findPeaks&lt;float&gt;(startItr, stopItr, peakTupleVec, threshold, firstTick);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaba6a193f0d20e952cf9c6eb8e796cd8">  303</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">WaveformTools::findPeaks</a>(<span class="keyword">typename</span> std::vector&lt;T&gt;::iterator startItr,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                    <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator stopItr,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                                    <a class="code" href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">PeakTupleVec</a>&amp;                     peakTupleVec,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                    T                                 threshold,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                    <span class="keywordtype">size_t</span>                            firstTick)<span class="keyword"> const</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Need a minimum distance or else nothing to do</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> (std::distance(startItr,stopItr) &gt; 4)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="comment">// This is a divide and conquer algorithm, start by finding the maximum element.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator firstItr = std::max_element(startItr,stopItr,[](<span class="keywordtype">float</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a>, <span class="keywordtype">float</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>){<span class="keywordflow">return</span> std::fabs(left) &lt; std::fabs(right);});</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// Are we over threshold?</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">if</span> (std::fabs(*firstItr) &gt; threshold)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">// What am I thinking?</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">// First task is to find the &quot;other&quot; lobe max point</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="comment">// Set one to the &quot;first&quot;, the other to the &quot;second&quot;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">// Search backward from first to find start point, forward from second to find end point</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">// Set mid point between first and second as &quot;peak&quot;?</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator secondItr = firstItr;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="comment">// Assume if max bin is positive then second lobe is later</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span> (*firstItr &gt; 0)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator tempItr = secondItr;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">while</span>(tempItr != stopItr)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <span class="keywordflow">if</span> (*++tempItr &lt; -threshold)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <span class="keywordflow">if</span> (*tempItr &lt; *secondItr) secondItr = tempItr;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (secondItr != firstItr) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="comment">// Otherwise it goes the other way</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="keyword">typename</span> std::vector&lt;T&gt;::iterator tempItr = secondItr;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">while</span>(tempItr != startItr)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <span class="keywordflow">if</span> (*--tempItr &gt; threshold)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        <span class="keywordflow">if</span> (*tempItr &gt; *secondItr) secondItr = tempItr;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (secondItr != firstItr) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                std::swap(firstItr,secondItr);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">// It might that no real pulse was found</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">if</span> (firstItr != secondItr)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="comment">// Get the &quot;peak&quot; position</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordtype">size_t</span> peakBin = std::distance(startItr,firstItr) + std::distance(firstItr,secondItr) / 2;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="comment">// Advance (forward or backward) the first and second iterators to get back to zero crossing</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">while</span>(firstItr  != startItr) <span class="keywordflow">if</span> (*--firstItr  &lt; 0.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordflow">while</span>(secondItr != stopItr)  <span class="keywordflow">if</span> (*++secondItr &gt; 0.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordtype">size_t</span> firstBin = std::distance(startItr,firstItr);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keywordtype">size_t</span> lastBin  = std::distance(startItr,secondItr);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="comment">// Find leading peaks</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">findPeaks</a>(startItr, firstItr, peakTupleVec, threshold, firstTick);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="comment">// Save this peak</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                peakTupleVec.push_back(<a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ab17bb7b3ba2f28c6d8f5fd48e1b1a0ca">PeakTuple</a>(firstBin+firstTick,peakBin+firstTick,lastBin+firstTick));</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="comment">// Find downstream peaks</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">findPeaks</a>(secondItr, stopItr, peakTupleVec, threshold, firstTick + std::distance(startItr,secondItr));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">  384</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">WaveformTools::getFFTPower</a>(<span class="keyword">const</span> std::vector&lt;float&gt;&amp; inputVec, std::vector&lt;float&gt;&amp; outputPowerVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    std::vector&lt;double&gt; inputDoubleVec(inputVec.size());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    std::vector&lt;double&gt; outputDoubleVec(inputVec.size()/2);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(inputVec.begin(),inputVec.end(),inputDoubleVec.begin());</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">getFFTPower</a>(inputDoubleVec, outputDoubleVec);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (outputDoubleVec.size() != outputPowerVec.size()) outputPowerVec.resize(outputDoubleVec.size());</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">std::copy</a>(outputDoubleVec.begin(),outputDoubleVec.end(),outputPowerVec.begin());</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a260a8ee4a25d0321757ddef9ae8f57ca">  400</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">WaveformTools::getFFTPower</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; inputVec, std::vector&lt;double&gt;&amp; outputPowerVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// Get the FFT of the response</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">int</span> fftDataSize = inputVec.size();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    TVirtualFFT* fftr2c = TVirtualFFT::FFT(1, &amp;fftDataSize, <span class="stringliteral">&quot;R2C&quot;</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    fftr2c-&gt;SetPoints(inputVec.data());</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    fftr2c-&gt;Transform();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// Recover the results so we can compute the power spectrum</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">size_t</span> halfFFTDataSize(fftDataSize/2 + 1);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    std::vector&lt;double&gt; realVals(halfFFTDataSize);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    std::vector&lt;double&gt; imaginaryVals(halfFFTDataSize);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    fftr2c-&gt;GetPointsComplex(realVals.data(), imaginaryVals.data());</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (outputPowerVec.size() != halfFFTDataSize) outputPowerVec.resize(halfFFTDataSize,0.);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">std::transform</a>(realVals.begin(), realVals.begin() + halfFFTDataSize, imaginaryVals.begin(), outputPowerVec.begin(), [](<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; real, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; imaginary){<span class="keywordflow">return</span> std::sqrt(real*real + imaginary*imaginary);});</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">  425</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">WaveformTools::getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp; waveform,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                                        <span class="keywordtype">int</span>                    structuringElement,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;          histogramMap,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       erosionVec,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       dilationVec,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       averageVec,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       differenceVec)<span class="keyword">         const</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    getErosionDilationAverageDifference&lt;short&gt;(waveform, structuringElement, histogramMap, erosionVec, dilationVec, averageVec, differenceVec);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a3b8a20902dd1776e6b321ea787e4b5c4">  438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">WaveformTools::getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp; waveform,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                        <span class="keywordtype">int</span>                    structuringElement,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;          histogramMap,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       erosionVec,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       dilationVec,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       averageVec,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       differenceVec)<span class="keyword">         const</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    getErosionDilationAverageDifference&lt;float&gt;(waveform, structuringElement, histogramMap, erosionVec, dilationVec, averageVec, differenceVec);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#acf4e885907445cfb16e408a64f98c407">  451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">WaveformTools::getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp; waveform,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                        <span class="keywordtype">int</span>                     structuringElement,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;           histogramMap,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       erosionVec,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       dilationVec,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       averageVec,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                                        <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       differenceVec)<span class="keyword">         const</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    getErosionDilationAverageDifference&lt;double&gt;(waveform, structuringElement, histogramMap, erosionVec, dilationVec, averageVec, differenceVec);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a66fad740221bb3220ea4ebc5bc2333a6">  464</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">WaveformTools::getErosionDilationAverageDifference</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp; inputWaveform,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                                                              <span class="keywordtype">int</span>                structuringElement,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                                                              <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;      histogramMap,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                                                              <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       erosionVec,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                                                              <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       dilationVec,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                                              <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       averageVec,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                                                              <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       differenceVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// Set the window size</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">int</span> halfWindowSize(structuringElement/2);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// Initialize min and max elements</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    std::pair&lt;typename Waveform&lt;T&gt;::const_iterator,<span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a>&gt; minMaxItr =</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            std::minmax_element(inputWaveform.begin(),inputWaveform.begin()+halfWindowSize);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> minElementItr = minMaxItr.first;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> maxElementItr = minMaxItr.second;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Initialize the erosion and dilation vectors</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    erosionVec.resize(inputWaveform.size());</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    dilationVec.resize(inputWaveform.size());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    averageVec.resize(inputWaveform.size());</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    differenceVec.resize(inputWaveform.size());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Now loop through remaining elements and complete the vectors</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> minItr = erosionVec.begin();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> maxItr = dilationVec.begin();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> aveItr = averageVec.begin();</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> difItr = differenceVec.begin();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> inputItr = inputWaveform.begin(); inputItr != inputWaveform.end(); inputItr++)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">// There are two conditions to check:</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">// 1) is the current min/max element outside the current window?</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">// 2) is the new element smaller/larger than the current min/max?</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// Make sure we are not running off the end of the vector</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">if</span> (std::distance(inputItr,inputWaveform.end()) &gt; halfWindowSize)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">if</span> (std::distance(minElementItr,inputItr) &gt;= halfWindowSize)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                minElementItr = std::min_element(inputItr - halfWindowSize + 1, inputItr + halfWindowSize + 1);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(inputItr + halfWindowSize) &lt; *minElementItr)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                minElementItr = inputItr + halfWindowSize;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">if</span> (std::distance(maxElementItr,inputItr) &gt;= halfWindowSize)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                maxElementItr = std::max_element(inputItr - halfWindowSize + 1, inputItr + halfWindowSize + 1);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(inputItr + halfWindowSize) &gt; *maxElementItr)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                maxElementItr = inputItr + halfWindowSize;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">// Update the vectors</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        *minItr++ = *minElementItr;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        *maxItr++ = *maxElementItr;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        *aveItr++ = 0.5 * (*maxElementItr + *minElementItr);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        *difItr++ = *maxElementItr - *minElementItr;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">if</span> (!histogramMap.empty())</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordtype">int</span> curBin = std::distance(inputWaveform.begin(),inputItr);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a79adefc3f0a28c6fa5b05711c82fd366">WAVEFORM</a>)-&gt;Fill(   curBin, *inputItr);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af521a5ba08dc8529b5aea8331cf371f9">EROSION</a>)-&gt;Fill(    curBin, *minElementItr);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af077689d851a9d6f7e351d5dd6912e70">DILATION</a>)-&gt;Fill(   curBin, *maxElementItr);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a76c1e3eba784b1fb3715b1dab2ae6080">AVERAGE</a>)-&gt;Fill(    curBin, 0.5*(*maxElementItr + *minElementItr));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af8dafadc03f0cd1c0a665a889a72edbc">DIFFERENCE</a>)-&gt;Fill( curBin,      *maxElementItr - *minElementItr);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;}</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">  536</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">WaveformTools::getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp; erosionVec,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp; dilationVec,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                         <span class="keywordtype">int</span>                    structuringElement,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;          histogramMap,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       openingVec,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;short&gt;</a>&amp;       closingVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    getOpeningAndClosing&lt;short&gt;(erosionVec, dilationVec, structuringElement, histogramMap, openingVec, closingVec);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a3de5c46f34e2cf56b50d1821227ca7f7">  548</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">WaveformTools::getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp; erosionVec,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp; dilationVec,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                         <span class="keywordtype">int</span>                    structuringElement,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;          histogramMap,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       openingVec,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;float&gt;</a>&amp;       closingVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    getOpeningAndClosing&lt;float&gt;(erosionVec, dilationVec, structuringElement, histogramMap, openingVec, closingVec);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af77ea864b9f062a2449d18a7c8fef836">  560</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">WaveformTools::getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp; erosionVec,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp; dilationVec,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                         <span class="keywordtype">int</span>                     structuringElement,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;           histogramMap,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       openingVec,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                         <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;double&gt;</a>&amp;       closingVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    getOpeningAndClosing&lt;double&gt;(erosionVec, dilationVec, structuringElement, histogramMap, openingVec, closingVec);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aab75091e3ead4b6d04bdf37a3bb95e6c">  572</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">WaveformTools::getOpeningAndClosing</a>(<span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp; erosionVec,</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                                               <span class="keyword">const</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp; dilationVec,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                               <span class="keywordtype">int</span>                structuringElement,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                                               <a class="code" href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">HistogramMap</a>&amp;      histogramMap,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                               <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       openingVec,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                               <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;</a>&amp;       closingVec)<span class="keyword">  const</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Set the window size</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">int</span> halfWindowSize(structuringElement/2);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Start with the opening, here we get the max element in the input erosion vector</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> maxElementItr = std::max_element(erosionVec.begin(),erosionVec.begin()+halfWindowSize);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Initialize the opening vector</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    openingVec.resize(erosionVec.size());</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// Now loop through remaining elements and complete the vectors</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> maxItr = openingVec.begin();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> inputItr = erosionVec.begin(); inputItr != erosionVec.end(); inputItr++)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// There are two conditions to check:</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">// 1) is the current min/max element outside the current window?</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment">// 2) is the new element smaller/larger than the current min/max?</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">// Make sure we are not running off the end of the vector</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (std::distance(inputItr,erosionVec.end()) &gt; halfWindowSize)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> (std::distance(maxElementItr,inputItr) &gt;= halfWindowSize)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                maxElementItr = std::max_element(inputItr - halfWindowSize + 1, inputItr + halfWindowSize + 1);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(inputItr + halfWindowSize) &gt; *maxElementItr)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                maxElementItr = inputItr + halfWindowSize;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// Update the vectors</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        *maxItr++ = *maxElementItr;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span> (!histogramMap.empty())</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordtype">int</span> curBin = std::distance(erosionVec.begin(),inputItr);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a33857548c3aa3ed7293d024f9d19a0a7">OPENING</a>)-&gt;Fill(curBin, *maxElementItr);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// Now go with the closling, here we get the min element in the input dilation vector</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> minElementItr = std::min_element(dilationVec.begin(),dilationVec.begin()+halfWindowSize);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// Initialize the opening and closing vectors</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    closingVec.resize(dilationVec.size());</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// Now loop through remaining elements and complete the vectors</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::iterator</a> minItr = closingVec.begin();</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code" href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">Waveform&lt;T&gt;::const_iterator</a> inputItr = dilationVec.begin(); inputItr != dilationVec.end(); inputItr++)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">// There are two conditions to check:</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="comment">// 1) is the current min/max element outside the current window?</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="comment">// 2) is the new element smaller/larger than the current min/max?</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// Make sure we are not running off the end of the vector</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">if</span> (std::distance(inputItr,dilationVec.end()) &gt; halfWindowSize)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span> (std::distance(minElementItr,inputItr) &gt;= halfWindowSize)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                minElementItr = std::min_element(inputItr - halfWindowSize + 1, inputItr + halfWindowSize + 1);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(inputItr + halfWindowSize) &lt; *minElementItr)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                minElementItr = inputItr + halfWindowSize;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment">// Update the vectors</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        *minItr++ = *minElementItr;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> (!histogramMap.empty())</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordtype">int</span> curBin = std::distance(dilationVec.begin(),inputItr);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a2b55797250d3e4676a9067d65f6ae1b4">CLOSING</a>)-&gt;Fill(curBin, *minElementItr);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            histogramMap.at(<a class="code" href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a4d357ad38b944015c0c4283911f58857">DOPENCLOSING</a>)-&gt;Fill(curBin, *minElementItr - openingVec.at(curBin));</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;DEFINE_ART_CLASS_TOOL(<a class="code" href="../../d8/de3/classreco__tool_1_1WaveformTools.html">WaveformTools</a>)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_a4e27f030d75df7bdbe5be5914361f17c"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a4e27f030d75df7bdbe5be5914361f17c">reco_tool::WaveformTools::WaveformTools</a></div><div class="ttdeci">WaveformTools(const fhicl::ParameterSet &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00087">WaveformTools_tool.cc:87</a></div></div>
<div class="ttc" id="classreco__tool_1_1IWaveformTool_html"><div class="ttname"><a href="../../d8/df8/classreco__tool_1_1IWaveformTool.html">reco_tool::IWaveformTool</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00039">IWaveformTool.h:39</a></div></div>
<div class="ttc" id="classreco__tool_1_1IWaveformTool_html_a93734d72d6b6f4d454d3b6a2f6f3310b"><div class="ttname"><a href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a93734d72d6b6f4d454d3b6a2f6f3310b">reco_tool::IWaveformTool::PeakTuple</a></div><div class="ttdeci">std::tuple&lt; size_t, size_t, size_t &gt; PeakTuple</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00046">IWaveformTool.h:46</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_ab17bb7b3ba2f28c6d8f5fd48e1b1a0ca"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ab17bb7b3ba2f28c6d8f5fd48e1b1a0ca">reco_tool::WaveformTools::PeakTuple</a></div><div class="ttdeci">std::tuple&lt; size_t, size_t, size_t &gt; PeakTuple</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00025">WaveformTools_tool.cc:25</a></div></div>
<div class="ttc" id="namespaceicarus_1_1waveform__operations_1_1details_html_ae295d3f6cb2f9181dccdf0e3492d44e0"><div class="ttname"><a href="../../d5/d45/namespaceicarus_1_1waveform__operations_1_1details.html#ae295d3f6cb2f9181dccdf0e3492d44e0">icarus::waveform_operations::details::transform</a></div><div class="ttdeci">static constexpr Sample_t transform(Sample_t sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/WaveformOperations_8h_source.html#l00145">WaveformOperations.h:145</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_aae5338b4eda5de45ed29053a637bd7f5"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aae5338b4eda5de45ed29053a637bd7f5">reco_tool::WaveformTools::configure</a></div><div class="ttdeci">void configure(const fhicl::ParameterSet &amp;pset) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00092">WaveformTools_tool.cc:92</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a9ee908b07542801530686d5f8d96f06b"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a9ee908b07542801530686d5f8d96f06b">reco_tool::Waveform</a></div><div class="ttdeci">std::vector&lt; T &gt; Waveform</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00021">IWaveformTool.h:21</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_a6c7366341d76dd3deb73c21add773abf"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a6c7366341d76dd3deb73c21add773abf">reco_tool::WaveformTools::~WaveformTools</a></div><div class="ttdeci">~WaveformTools()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00021">WaveformTools_tool.cc:21</a></div></div>
<div class="ttc" id="IWaveformTool_8h_html"><div class="ttname"><a href="../../dc/dd0/IWaveformTool_8h.html">IWaveformTool.h</a></div><div class="ttdoc">This is the interface class for tools/algorithms that perform various operations on waveforms...</div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classreco__tool_1_1IWaveformTool_html_a79e5c5db6ba541796f499b1177dc95c6"><div class="ttname"><a href="../../d8/df8/classreco__tool_1_1IWaveformTool.html#a79e5c5db6ba541796f499b1177dc95c6">reco_tool::IWaveformTool::PeakTupleVec</a></div><div class="ttdeci">std::vector&lt; PeakTuple &gt; PeakTupleVec</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00047">IWaveformTool.h:47</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_aa96bbdac4cd31347dad1c7110c514260"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aa96bbdac4cd31347dad1c7110c514260">reco_tool::WaveformTools::triangleSmooth</a></div><div class="ttdeci">void triangleSmooth(const std::vector&lt; float &gt; &amp;, std::vector&lt; float &gt; &amp;, size_t=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00107">WaveformTools_tool.cc:107</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815af521a5ba08dc8529b5aea8331cf371f9"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af521a5ba08dc8529b5aea8331cf371f9">reco_tool::EROSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00027">IWaveformTool.h:27</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_aaad045acb45f2a4a252dbf689efaa159"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#aaad045acb45f2a4a252dbf689efaa159">reco_tool::WaveformTools::getTruncatedMeanRMS</a></div><div class="ttdeci">void getTruncatedMeanRMS(const std::vector&lt; double &gt; &amp;, double &amp;, double &amp;, double &amp;, int &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00194">WaveformTools_tool.cc:194</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_af0b30ee0df41b429d4173c34902e8e72"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#af0b30ee0df41b429d4173c34902e8e72">reco_tool::WaveformTools::medianSmooth</a></div><div class="ttdeci">void medianSmooth(const std::vector&lt; float &gt; &amp;, std::vector&lt; float &gt; &amp;, size_t=3) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00141">WaveformTools_tool.cc:141</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815a2b55797250d3e4676a9067d65f6ae1b4"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a2b55797250d3e4676a9067d65f6ae1b4">reco_tool::CLOSING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00032">IWaveformTool.h:32</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_ad068357ed66954c41bfd2927daa69ca1"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ad068357ed66954c41bfd2927daa69ca1">reco_tool::WaveformTools::firstDerivative</a></div><div class="ttdeci">void firstDerivative(const std::vector&lt; float &gt; &amp;, std::vector&lt; float &gt; &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00272">WaveformTools_tool.cc:272</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html">reco_tool::WaveformTools</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00016">WaveformTools_tool.cc:16</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815a76c1e3eba784b1fb3715b1dab2ae6080"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a76c1e3eba784b1fb3715b1dab2ae6080">reco_tool::AVERAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00029">IWaveformTool.h:29</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815a33857548c3aa3ed7293d024f9d19a0a7"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a33857548c3aa3ed7293d024f9d19a0a7">reco_tool::OPENING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00031">IWaveformTool.h:31</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_a1b5e513c6279d70081a19889283fcac3"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a1b5e513c6279d70081a19889283fcac3">reco_tool::WaveformTools::getOpeningAndClosing</a></div><div class="ttdeci">void getOpeningAndClosing(const Waveform&lt; short &gt; &amp;, const Waveform&lt; short &gt; &amp;, int, HistogramMap &amp;, Waveform&lt; short &gt; &amp;, Waveform&lt; short &gt; &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00536">WaveformTools_tool.cc:536</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815af077689d851a9d6f7e351d5dd6912e70"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af077689d851a9d6f7e351d5dd6912e70">reco_tool::DILATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00028">IWaveformTool.h:28</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815af8dafadc03f0cd1c0a665a889a72edbc"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815af8dafadc03f0cd1c0a665a889a72edbc">reco_tool::DIFFERENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00030">IWaveformTool.h:30</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a1abc6b9e279feba048394f49a85218c9"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a1abc6b9e279feba048394f49a85218c9">left</a></div><div class="ttdeci">walls no left</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8eda416c04cd93adad69a2fe6577453f"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8eda416c04cd93adad69a2fe6577453f">reco_tool::HistogramMap</a></div><div class="ttdeci">std::map&lt; int, TProfile * &gt; HistogramMap</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00037">IWaveformTool.h:37</a></div></div>
<div class="ttc" id="namespacepmtana_html_afea8da0c88fccc3252529b6a49284b4a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">pmtana::mean</a></div><div class="ttdeci">double mean(const std::vector&lt; short &gt; &amp;wf, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00013">UtilFunc.cxx:13</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_a093ca5ef19322526cc40a42a9d43fe36"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a093ca5ef19322526cc40a42a9d43fe36">reco_tool::WaveformTools::findPeaks</a></div><div class="ttdeci">void findPeaks(std::vector&lt; float &gt;::iterator, std::vector&lt; float &gt;::iterator, PeakTupleVec &amp;, float, size_t) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00296">WaveformTools_tool.cc:296</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_a267989c021894144e93e977b7f25e49d"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#a267989c021894144e93e977b7f25e49d">reco_tool::WaveformTools::getFFTPower</a></div><div class="ttdeci">void getFFTPower(const std::vector&lt; float &gt; &amp;inputVec, std::vector&lt; float &gt; &amp;outputPowerVec) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00384">WaveformTools_tool.cc:384</a></div></div>
<div class="ttc" id="RangeForWrapper__test_8cc_html_a2a47a7f29f0ddd7ff5d68f8aff63125c"><div class="ttname"><a href="../../d6/dd6/RangeForWrapper__test_8cc.html#a2a47a7f29f0ddd7ff5d68f8aff63125c">copy</a></div><div class="ttdeci">T copy(T const &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd6/RangeForWrapper__test_8cc_source.html#l00098">RangeForWrapper_test.cc:98</a></div></div>
<div class="ttc" id="classreco__tool_1_1WaveformTools_html_ac7d21b4f5c843a1d5bf0850f6a9d95a9"><div class="ttname"><a href="../../d8/de3/classreco__tool_1_1WaveformTools.html#ac7d21b4f5c843a1d5bf0850f6a9d95a9">reco_tool::WaveformTools::getErosionDilationAverageDifference</a></div><div class="ttdeci">void getErosionDilationAverageDifference(const Waveform&lt; short &gt; &amp;, int, HistogramMap &amp;, Waveform&lt; short &gt; &amp;, Waveform&lt; short &gt; &amp;, Waveform&lt; short &gt; &amp;, Waveform&lt; short &gt; &amp;) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/WaveformTools__tool_8cc_source.html#l00425">WaveformTools_tool.cc:425</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815a4d357ad38b944015c0c4283911f58857"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a4d357ad38b944015c0c4283911f58857">reco_tool::DOPENCLOSING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00033">IWaveformTool.h:33</a></div></div>
<div class="ttc" id="namespacereco__tool_html_a8bea517f468bea2e99443428a7507815a79adefc3f0a28c6fa5b05711c82fd366"><div class="ttname"><a href="../../de/df2/namespacereco__tool.html#a8bea517f468bea2e99443428a7507815a79adefc3f0a28c6fa5b05711c82fd366">reco_tool::WAVEFORM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd0/IWaveformTool_8h_source.html#l00026">IWaveformTool.h:26</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
