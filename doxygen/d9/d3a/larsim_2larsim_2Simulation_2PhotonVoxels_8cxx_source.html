<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>PhotonVoxels.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_c1de2b5dcb01608846a246cb763d5e03.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_64cfb79233dad4b4de390a7389ba145b.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_00f18add2507e30cd366db4ffe26a623.html">Simulation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">larsim/larsim/Simulation/PhotonVoxels.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file  larsim/Simulation/PhotonVoxels.cxx</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief Definitions of voxel data structures: implementation.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @see   larsim/Simulation/PhotonVoxels.h</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// library header</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h.html">larsim/Simulation/PhotonVoxels.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d6c/geo__vectors__utils_8h.html">larcorealg/Geometry/geo_vectors_utils.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// C++ standard libraries</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::min(), std::max()</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span>     <span class="comment">// std::abs(), std::floor()</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span> <span class="comment">// std::runtime_error</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span>sim {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="comment">// PhotonVoxelDef class</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43c147d42b8cde467c54f493d30307ea">   22</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a1a80be9213cf0580e87ae98de01b9606">PhotonVoxelDef::PhotonVoxelDef</a>(<span class="keywordtype">double</span> xMin,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                 <span class="keywordtype">double</span> xMax,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                 <span class="keywordtype">int</span> xN,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                 <span class="keywordtype">double</span> yMin,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                 <span class="keywordtype">double</span> yMax,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                 <span class="keywordtype">int</span> yN,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                 <span class="keywordtype">double</span> zMin,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                 <span class="keywordtype">double</span> zMax,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                 <span class="keywordtype">int</span> zN)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    : fLowerCorner(xMin, yMin, zMin)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    , fUpperCorner(xMax, yMax, zMax)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    , fxSteps(xN)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    , fySteps(yN)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    , fzSteps(zN)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  {}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  std::array&lt;unsigned int, 3U&gt;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">   40</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">PhotonVoxelDef::GetSteps</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">return</span> {{<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>, <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>, <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">fzSteps</a>}};</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a51611178041e76381e05d26917131b96">   49</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a51611178041e76381e05d26917131b96">PhotonVoxelDef::operator==</a>(<span class="keyword">const</span> <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html">PhotonVoxelDef</a>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> ((<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a484d54660dd0b17ad5fa2a672dbe071a">GetRegionUpperCorner</a>() == right.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a484d54660dd0b17ad5fa2a672dbe071a">GetRegionUpperCorner</a>()) &amp;&amp;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac956a07f83ca9dd3d0352cf7e702c279">GetRegionLowerCorner</a>() == right.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac956a07f83ca9dd3d0352cf7e702c279">GetRegionLowerCorner</a>()) &amp;&amp;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">GetSteps</a>() == right.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">GetSteps</a>()));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa36e93d3b1792ad2cf2e565281ec0308">   58</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa36e93d3b1792ad2cf2e565281ec0308">PhotonVoxelDef::GetNVoxels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">fzSteps</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a2155dd810c8150162c4e85cfddfda229">   65</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a121cc7020125be451ea3cd95fe09a3e0">PhotonVoxelDef::GetVoxelID</a>(<span class="keywordtype">double</span> <span class="keyword">const</span>* Position)<span class="keyword"> const</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab9883566d93ef2b027714f418f0b2995">GetVoxelIDImpl</a>(geo::vect::makeFromCoords&lt;geo::Point_t&gt;(Position));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  std::optional&lt;std::array&lt;sim::PhotonVoxelDef::NeiInfo, 8U&gt;&gt;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a80c0e54678de3a0a3ec393233c025d1f">   72</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a80c0e54678de3a0a3ec393233c025d1f">PhotonVoxelDef::GetNeighboringVoxelIDsImpl</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; v)<span class="keyword"> const</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a29119df504959182383984379a81739a">isInside</a>(v)) <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::array&lt;sim::PhotonVoxelDef::NeiInfo, 8U&gt; ret;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Position in voxel coordinates including floating point part</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> rStepD = <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6a71fedbb8bdb5dfe89b65cc8f481edf">GetVoxelStepCoordsUnchecked</a>(v);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// The neighbours are the 8 corners of a cube around this point</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    std::size_t iNeigh = 0U;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dx : {0, 1}) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dy : {0, 1}) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dz : {0, 1}) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <span class="comment">// The full 3D step</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> dr[3] = {dx, dy, dz};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          <span class="comment">// The integer-only position of the current corner</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <span class="keywordtype">int</span> rStepI[3];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; ++d) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="comment">// Round down to get the &quot;lower left&quot; corner</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            rStepI[d] = int(rStepD[d]);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// Ensure we&#39;ll stay in-bounds</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            rStepI[d] = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0, rStepI[d]);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            rStepI[d] = std::min(rStepI[d], <span class="keywordtype">int</span>(<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">GetSteps</a>()[d]) - 2);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">// Adjust to the corner we&#39;re actually considering</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            rStepI[d] += dr[d];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = 1;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; ++d) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="comment">// These expressions will interpolate when between the 8 corners,</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="comment">// and extrapolate in the half-voxel space around the edges.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (dr[d] == 0)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;              w *= 1 + rStepI[d] - rStepD[d];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;              w *= 1 - rStepI[d] + rStepD[d];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = (rStepI[0] + rStepI[1] * (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>) + rStepI[2] * (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          ret[iNeigh++] = {id, w};</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Sanity check the weights sum to 1</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">double</span> wSum = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="../../d9/d3c/structsim_1_1PhotonVoxelDef_1_1NeiInfo.html">NeiInfo</a>&amp; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> : ret)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      wSum += <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>.weight;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(wSum - 1) &gt; 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-3) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      std::string <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#a25a3f236e071521c1ae6d2efe0ebe688">msg</a> = <span class="stringliteral">&quot;PhotonVoxelDef::GetNeighboringVoxelIDs():&quot;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        <span class="stringliteral">&quot; Weights sum to &quot;</span> +</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                        <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(wSum) +</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        <span class="stringliteral">&quot; (should be 1).&quot;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <span class="stringliteral">&quot; Weights are:&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="../../d9/d3c/structsim_1_1PhotonVoxelDef_1_1NeiInfo.html">NeiInfo</a>&amp; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> : ret) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        msg += <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        msg += <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>.weight);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(msg);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> {ret};</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="../../d1/de0/classsim_1_1PhotonVoxel.html">PhotonVoxel</a></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab7efc9d5005459325eb490c1ca34c879">  139</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab7efc9d5005459325eb490c1ca34c879">PhotonVoxelDef::GetPhotonVoxel</a>(<span class="keywordtype">int</span> ID)<span class="keyword"> const</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//    float TempID = (float) ID;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Decompose ID into steps in each direction</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">int</span> xStep = ID % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> yStep = ((ID - xStep) / <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>) % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> zStep = ((ID - xStep - (yStep * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>)) / (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>)) % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">fzSteps</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> VoxelSize = GetVoxelSize&lt;geo::Vector_t&gt;();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> xMin = VoxelSize.X() * (xStep) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.X();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> xMax = VoxelSize.X() * (xStep + 1) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.X();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> yMin = VoxelSize.Y() * (yStep) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.Y();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> yMax = VoxelSize.Y() * (yStep + 1) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.Y();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> zMin = VoxelSize.Z() * (zStep) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.Z();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> zMax = VoxelSize.Z() * (zStep + 1) + <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>.Z();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/de0/classsim_1_1PhotonVoxel.html">PhotonVoxel</a>(xMin, xMax, yMin, yMax, zMin, zMax);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a2e6ba5bfcd49b00744165101bb8f2c29">  162</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a2e6ba5bfcd49b00744165101bb8f2c29">PhotonVoxelDef::IsLegalVoxelID</a>(<span class="keywordtype">int</span> ID)<span class="keyword"> const</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> ((ID &gt;= 0) &amp;&amp; (static_cast&lt;unsigned int&gt;(ID) &lt; <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa36e93d3b1792ad2cf2e565281ec0308">GetNVoxels</a>()));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  std::array&lt;int, 3U&gt;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac1ff499a3bb6f6b47ae3d15b8eeb85d2">  168</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac1ff499a3bb6f6b47ae3d15b8eeb85d2">PhotonVoxelDef::GetVoxelCoords</a>(<span class="keywordtype">int</span> ID)<span class="keyword"> const</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::array&lt;int, 3U&gt; ReturnVector;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    ReturnVector[0] = ID % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    ReturnVector[1] = ((ID - ReturnVector[0]) / <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>) % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ReturnVector[2] =</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      ((ID - ReturnVector[0] - (ReturnVector[1] * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>)) / (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>)) % <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">fzSteps</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> ReturnVector;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  std::array&lt;double, 3U&gt;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6a71fedbb8bdb5dfe89b65cc8f481edf">  180</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6a71fedbb8bdb5dfe89b65cc8f481edf">PhotonVoxelDef::GetVoxelStepCoordsUnchecked</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> span = <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aae27b0cd75a2518c04df07a8dedd905f">fUpperCorner</a> - <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> relPos = p - <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">fLowerCorner</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> {{(relPos.X() / span.X()) * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;             (relPos.Y() / span.Y()) * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;             (relPos.Z() / span.Z()) * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">fzSteps</a>}};</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  } <span class="comment">// PhotonVoxelDef::GetVoxelStepCoordsUnchecked()</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab9883566d93ef2b027714f418f0b2995">  195</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab9883566d93ef2b027714f418f0b2995">PhotonVoxelDef::GetVoxelIDImpl</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; p)<span class="keyword"> const</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a29119df504959182383984379a81739a">isInside</a>(p)) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> stepCoords = <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6a71fedbb8bdb5dfe89b65cc8f481edf">GetVoxelStepCoordsUnchecked</a>(p);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// figure out how many steps this point is in the x,y,z directions;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// `p` is guaranteed to be in the mapped volume by the previous check</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> xStep = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(stepCoords[0]);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> yStep = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(stepCoords[1]);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">int</span> zStep = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(stepCoords[2]);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// if within bounds, generate the voxel ID</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> (xStep + yStep * (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a>) + zStep * (<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">fxSteps</a> * <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">fySteps</a>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a56939f00309de1f15d6fd61c8b23ae0e">  213</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a56939f00309de1f15d6fd61c8b23ae0e">PhotonVoxelDef::isInsideVolume</a>(<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; point,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                 <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; lower,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                 <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; upper)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">isInsideRange</a>(point.X(), lower.X(), upper.X()) &amp;&amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;           <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">isInsideRange</a>(point.Y(), lower.Y(), upper.Y()) &amp;&amp;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;           <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">isInsideRange</a>(point.Z(), lower.Z(), upper.Z());</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">  223</a></span>&#160;  <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">PhotonVoxelDef::isInsideRange</a>(<span class="keywordtype">double</span> <a class="code" href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a>, <span class="keywordtype">double</span> lower, <span class="keywordtype">double</span> upper)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> (value &gt;= lower) &amp;&amp; (value &lt; upper);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  } <span class="comment">// PhotonVoxelDef::isInsideRange()</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  std::ostream&amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="../../d8/d7d/namespacesim.html#a2a8bb0bde9e88a45bbe753bd57abee7a">  233</a></span>&#160;  <a class="code" href="../../d8/d7d/namespacesim.html#a4bd602c7afa5a251fa4efbb498bb160a">operator&lt;&lt;</a>(std::ostream&amp; out, <a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html">sim::PhotonVoxelDef</a> <span class="keyword">const</span>&amp; voxelDef)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; lower = voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac956a07f83ca9dd3d0352cf7e702c279">GetRegionLowerCorner</a>();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; upper = voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a484d54660dd0b17ad5fa2a672dbe071a">GetRegionUpperCorner</a>();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; steps = voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">GetSteps</a>();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; stepSize = voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#add1d4b80785403000a6b8a0e721cb72c">GetVoxelSize</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;Volume &quot;</span> &lt;&lt; voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a1c8b17cf61b953f1181469f94eed84ed">GetVolumeSize</a>() &lt;&lt; <span class="stringliteral">&quot; cm^3 split in &quot;</span> &lt;&lt; voxelDef.<a class="code" href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa36e93d3b1792ad2cf2e565281ec0308">GetNVoxels</a>()</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; voxels:&quot;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n  - x axis: [ &quot;</span> &lt;&lt; lower.X() &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; upper.X() &lt;&lt; <span class="stringliteral">&quot; ] split in &quot;</span> &lt;&lt; steps[0]</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;x &quot;</span> &lt;&lt; stepSize.X() &lt;&lt; <span class="stringliteral">&quot; cm steps&quot;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n  - y axis: [ &quot;</span> &lt;&lt; lower.Y() &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; upper.Y() &lt;&lt; <span class="stringliteral">&quot; ] split in &quot;</span> &lt;&lt; steps[1]</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;x &quot;</span> &lt;&lt; stepSize.Y() &lt;&lt; <span class="stringliteral">&quot; cm steps&quot;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n  - z axis: [ &quot;</span> &lt;&lt; lower.Z() &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; upper.Z() &lt;&lt; <span class="stringliteral">&quot; ] split in &quot;</span> &lt;&lt; steps[2]</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;x &quot;</span> &lt;&lt; stepSize.Z() &lt;&lt; <span class="stringliteral">&quot; cm steps&quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  } <span class="comment">// operator&lt;&lt; (sim::PhotonVoxelDef)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;} <span class="comment">// namespace sim</span></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_add1d4b80785403000a6b8a0e721cb72c"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#add1d4b80785403000a6b8a0e721cb72c">sim::PhotonVoxelDef::GetVoxelSize</a></div><div class="ttdeci">Vector GetVoxelSize() const </div><div class="ttdoc">Returns a vector describing the span of a single voxel in x, y an z [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00224">larsim/larsim/Simulation/PhotonVoxels.h:224</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a8febfbd494dc5720dafd44cdb3d7bd39"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a8febfbd494dc5720dafd44cdb3d7bd39">sim::PhotonVoxelDef::fySteps</a></div><div class="ttdeci">unsigned int fySteps</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00065">larsim/larsim/Simulation/PhotonVoxels.h:65</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a1a80be9213cf0580e87ae98de01b9606"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a1a80be9213cf0580e87ae98de01b9606">sim::PhotonVoxelDef::PhotonVoxelDef</a></div><div class="ttdeci">PhotonVoxelDef()=default</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/sbncode_2sbncode_2OpT0Finder_2flashmatch_2Base_2FMWKTools_2PhotonVoxels_8cxx_source.html#l00080">sbncode/sbncode/OpT0Finder/flashmatch/Base/FMWKTools/PhotonVoxels.cxx:80</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_ab9883566d93ef2b027714f418f0b2995"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab9883566d93ef2b027714f418f0b2995">sim::PhotonVoxelDef::GetVoxelIDImpl</a></div><div class="ttdeci">int GetVoxelIDImpl(geo::Point_t const &amp;p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00195">larsim/larsim/Simulation/PhotonVoxels.cxx:195</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a43e38886c6202b878d88f62bb4233d1a"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a43e38886c6202b878d88f62bb4233d1a">sim::PhotonVoxelDef::GetSteps</a></div><div class="ttdeci">std::array&lt; unsigned int, 3U &gt; GetSteps() const </div><div class="ttdoc">Returns the number of voxels along each of the three dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00040">larsim/larsim/Simulation/PhotonVoxels.cxx:40</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a51611178041e76381e05d26917131b96"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a51611178041e76381e05d26917131b96">sim::PhotonVoxelDef::operator==</a></div><div class="ttdeci">bool operator==(const PhotonVoxelDef &amp;rhs) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00049">larsim/larsim/Simulation/PhotonVoxels.cxx:49</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html">sim::PhotonVoxelDef</a></div><div class="ttdoc">Representation of a region of space diced into voxels. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00058">larsim/larsim/Simulation/PhotonVoxels.h:58</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a6a71fedbb8bdb5dfe89b65cc8f481edf"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6a71fedbb8bdb5dfe89b65cc8f481edf">sim::PhotonVoxelDef::GetVoxelStepCoordsUnchecked</a></div><div class="ttdeci">std::array&lt; double, 3U &gt; GetVoxelStepCoordsUnchecked(geo::Point_t const &amp;p) const </div><div class="ttdoc">Returns the coordinates of the cvoxel containing p in step units. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00180">larsim/larsim/Simulation/PhotonVoxels.cxx:180</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a121cc7020125be451ea3cd95fe09a3e0"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a121cc7020125be451ea3cd95fe09a3e0">sim::PhotonVoxelDef::GetVoxelID</a></div><div class="ttdeci">int GetVoxelID(Point const &amp;p) const </div><div class="ttdoc">Returns the ID of the voxel containing p, or -1 if none. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00234">larsim/larsim/Simulation/PhotonVoxels.h:234</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_aa36e93d3b1792ad2cf2e565281ec0308"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa36e93d3b1792ad2cf2e565281ec0308">sim::PhotonVoxelDef::GetNVoxels</a></div><div class="ttdeci">unsigned int GetNVoxels() const </div><div class="ttdoc">Returns the total number of voxels in the volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00058">larsim/larsim/Simulation/PhotonVoxels.cxx:58</a></div></div>
<div class="ttc" id="namespacesortDataLoggerFiles_html_a25a3f236e071521c1ae6d2efe0ebe688"><div class="ttname"><a href="../../d3/d46/namespacesortDataLoggerFiles.html#a25a3f236e071521c1ae6d2efe0ebe688">sortDataLoggerFiles.msg</a></div><div class="ttdeci">string msg</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc8/sortDataLoggerFiles_8py_source.html#l00436">sortDataLoggerFiles.py:436</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a29119df504959182383984379a81739a"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a29119df504959182383984379a81739a">sim::PhotonVoxelDef::isInside</a></div><div class="ttdeci">bool isInside(geo::Point_t const &amp;p) const </div><div class="ttdoc">Returns whether point p is inside the region (upper border excluded). </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00139">larsim/larsim/Simulation/PhotonVoxels.h:139</a></div></div>
<div class="ttc" id="larsim_2larsim_2Simulation_2PhotonVoxels_8h_html"><div class="ttname"><a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h.html">PhotonVoxels.h</a></div><div class="ttdoc">Definitions of voxel data structures. </div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_ac956a07f83ca9dd3d0352cf7e702c279"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac956a07f83ca9dd3d0352cf7e702c279">sim::PhotonVoxelDef::GetRegionLowerCorner</a></div><div class="ttdeci">decltype(auto) GetRegionLowerCorner() const </div><div class="ttdoc">Returns the volume vertex (type Point) with the lowest coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/sbncode_2sbncode_2OpT0Finder_2flashmatch_2Base_2FMWKTools_2PhotonVoxels_8cxx_source.html#l00085">sbncode/sbncode/OpT0Finder/flashmatch/Base/FMWKTools/PhotonVoxels.cxx:85</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a88bdb4d17617cfa5a95783d36f4c68fd"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a88bdb4d17617cfa5a95783d36f4c68fd">sim::PhotonVoxelDef::isInsideRange</a></div><div class="ttdeci">static bool isInsideRange(double value, double lower, double upper)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00223">larsim/larsim/Simulation/PhotonVoxels.cxx:223</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_aa52f5d9e83f66ffda3972839752b803a"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aa52f5d9e83f66ffda3972839752b803a">sim::PhotonVoxelDef::fzSteps</a></div><div class="ttdeci">unsigned int fzSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00066">larsim/larsim/Simulation/PhotonVoxels.h:66</a></div></div>
<div class="ttc" id="geo__vectors__utils_8h_html"><div class="ttname"><a href="../../d5/d6c/geo__vectors__utils_8h.html">geo_vectors_utils.h</a></div><div class="ttdoc">Utilities to extend the interface of geometry vectors. </div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a484d54660dd0b17ad5fa2a672dbe071a"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a484d54660dd0b17ad5fa2a672dbe071a">sim::PhotonVoxelDef::GetRegionUpperCorner</a></div><div class="ttdeci">decltype(auto) GetRegionUpperCorner() const </div><div class="ttdoc">Returns the volume vertex (type Point) with the highest coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/sbncode_2sbncode_2OpT0Finder_2flashmatch_2Base_2FMWKTools_2PhotonVoxels_8cxx_source.html#l00091">sbncode/sbncode/OpT0Finder/flashmatch/Base/FMWKTools/PhotonVoxels.cxx:91</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a2e6ba5bfcd49b00744165101bb8f2c29"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a2e6ba5bfcd49b00744165101bb8f2c29">sim::PhotonVoxelDef::IsLegalVoxelID</a></div><div class="ttdeci">bool IsLegalVoxelID(int) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00162">larsim/larsim/Simulation/PhotonVoxels.cxx:162</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a6ac3c961c24543088b29049823c7e0ee"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a6ac3c961c24543088b29049823c7e0ee">sim::PhotonVoxelDef::fxSteps</a></div><div class="ttdeci">unsigned int fxSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00064">larsim/larsim/Simulation/PhotonVoxels.h:64</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_ac1ff499a3bb6f6b47ae3d15b8eeb85d2"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ac1ff499a3bb6f6b47ae3d15b8eeb85d2">sim::PhotonVoxelDef::GetVoxelCoords</a></div><div class="ttdeci">std::array&lt; int, 3U &gt; GetVoxelCoords(int ID) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00168">larsim/larsim/Simulation/PhotonVoxels.cxx:168</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_aff84cbedb0fea724797c3ebb2a2a191b"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aff84cbedb0fea724797c3ebb2a2a191b">sim::PhotonVoxelDef::fLowerCorner</a></div><div class="ttdeci">geo::Point_t fLowerCorner</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00062">larsim/larsim/Simulation/PhotonVoxels.h:62</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxel_html"><div class="ttname"><a href="../../d1/de0/classsim_1_1PhotonVoxel.html">sim::PhotonVoxel</a></div><div class="ttdoc">Representation of a single small volume (voxel). </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00020">larsim/larsim/Simulation/PhotonVoxels.h:20</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_aae27b0cd75a2518c04df07a8dedd905f"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#aae27b0cd75a2518c04df07a8dedd905f">sim::PhotonVoxelDef::fUpperCorner</a></div><div class="ttdeci">geo::Point_t fUpperCorner</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00063">larsim/larsim/Simulation/PhotonVoxels.h:63</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00102">WindowPattern.h:102</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a1c8b17cf61b953f1181469f94eed84ed"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a1c8b17cf61b953f1181469f94eed84ed">sim::PhotonVoxelDef::GetVolumeSize</a></div><div class="ttdeci">Vector GetVolumeSize() const </div><div class="ttdoc">Returns a vector describing the full span in x, y an z [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00098">larsim/larsim/Simulation/PhotonVoxels.h:98</a></div></div>
<div class="ttc" id="pmtsimulation__icarus_8fcl_html_a9fc569190f32b40862f18ac3c03a8e49"><div class="ttname"><a href="../../da/d36/pmtsimulation__icarus_8fcl.html#a9fc569190f32b40862f18ac3c03a8e49">value</a></div><div class="ttdeci">temporary value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d36/pmtsimulation__icarus_8fcl_source.html#l00158">pmtsimulation_icarus.fcl:158</a></div></div>
<div class="ttc" id="structsim_1_1PhotonVoxelDef_1_1NeiInfo_html"><div class="ttname"><a href="../../d9/d3c/structsim_1_1PhotonVoxelDef_1_1NeiInfo.html">sim::PhotonVoxelDef::NeiInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d55/larsim_2larsim_2Simulation_2PhotonVoxels_8h_source.html#l00113">larsim/larsim/Simulation/PhotonVoxels.h:113</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="namespacesim_html_a4bd602c7afa5a251fa4efbb498bb160a"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#a4bd602c7afa5a251fa4efbb498bb160a">sim::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;output, const LArVoxelData &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/LArVoxelData_8cxx_source.html#l00077">LArVoxelData.cxx:77</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a56939f00309de1f15d6fd61c8b23ae0e"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a56939f00309de1f15d6fd61c8b23ae0e">sim::PhotonVoxelDef::isInsideVolume</a></div><div class="ttdeci">static bool isInsideVolume(geo::Point_t const &amp;point, geo::Point_t const &amp;lower, geo::Point_t const &amp;upper)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00213">larsim/larsim/Simulation/PhotonVoxels.cxx:213</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_a80c0e54678de3a0a3ec393233c025d1f"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#a80c0e54678de3a0a3ec393233c025d1f">sim::PhotonVoxelDef::GetNeighboringVoxelIDsImpl</a></div><div class="ttdeci">std::optional&lt; std::array&lt; NeiInfo, 8U &gt; &gt; GetNeighboringVoxelIDsImpl(geo::Point_t const &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00072">larsim/larsim/Simulation/PhotonVoxels.cxx:72</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classsim_1_1PhotonVoxelDef_html_ab7efc9d5005459325eb490c1ca34c879"><div class="ttname"><a href="../../da/d6a/classsim_1_1PhotonVoxelDef.html#ab7efc9d5005459325eb490c1ca34c879">sim::PhotonVoxelDef::GetPhotonVoxel</a></div><div class="ttdeci">PhotonVoxel GetPhotonVoxel(int ID) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3a/larsim_2larsim_2Simulation_2PhotonVoxels_8cxx_source.html#l00139">larsim/larsim/Simulation/PhotonVoxels.cxx:139</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
