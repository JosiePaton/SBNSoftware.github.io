<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Processors.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_5f678ef99ea6f964b236b90db12a4ab6.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_9c2e8b3a7cfa1f7937f5a112e04e3409.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_62895189af310a0a52e8d2abd8ea41b0.html">SinglePhotonAnalysis</a></li><li class="navelem"><a class="el" href="../../dir_7596282bfb49b35f03d20a40f2122cf6.html">Libraries</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Processors.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/dd4/Processors_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dca/variables_8h.html">sbncode/SinglePhotonAnalysis/Libraries/variables.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d9c/Processors_8h.html">sbncode/SinglePhotonAnalysis/Libraries/Processors.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/de2/helper__math_8h.html">sbncode/SinglePhotonAnalysis/HelperFunctions/helper_math.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindManyP.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindMany.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindOneP.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindOne.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;TGraph.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;TGraph2D.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;TGraphDelaunay.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//May move this to Libaries</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span>single_photon</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a949dde62e8c07f4e36f2c6284ee04ace">   25</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a949dde62e8c07f4e36f2c6284ee04ace">spacecharge_correction</a>(<span class="keyword">const</span> art::Ptr&lt;simb::MCParticle&gt; &amp; mcparticle, std::vector&lt;double&gt; &amp; corrected, std::vector&lt;double&gt; &amp; input){</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    corrected.resize(3);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">//CHECK        double kx = input[0];</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">double</span> ky = input[1];</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">double</span> kz = input[2];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//CHECK</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//        auto scecorr = SCE-&gt;GetPosOffsets( geo::Point_t(kx,ky,kz));</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// CHECK</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// double g4Ticks =  detClocks-&gt;TPCG4Time2Tick(mcparticle-&gt;T())+theDetector-&gt;GetXTicksOffset(0,0,0)-theDetector-&gt;trigger_offset();</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//CHECK       double xtimeoffset = 0;//CHECK  theDetector-&gt;ConvertTicksToX(g4Ticks,0,0,0);</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//        double xOffset = -scecorr.X() +xtimeoffset+0.6;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> yOffset = 0;<span class="comment">//CHECK scecorr.Y();</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> zOffset = 0;<span class="comment">//CHECK scecorr.Z();</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    corrected[0]=0;<span class="comment">//CHECK kx - scecorr.X() + xtimeoffset + 0.6; //due to sim/wirecell differences  Seev https://cdcvs.fnal.gov/redmine/projects/uboone-physics-analysis/wiki/MCC9_Tutorials </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    corrected[1]=ky+yOffset;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    corrected[2]=kz+zOffset;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a2d996cb866d1c39cab910cbb1c079812">   52</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a949dde62e8c07f4e36f2c6284ee04ace">spacecharge_correction</a>(<span class="keyword">const</span> art::Ptr&lt;simb::MCParticle&gt; &amp; mcparticle, std::vector&lt;double&gt; &amp; corrected){</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    corrected.resize(3);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">double</span> kx = mcparticle-&gt;Vx();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">double</span> ky = mcparticle-&gt;Vy();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">double</span> kz = mcparticle-&gt;Vz();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//CHECK        auto scecorr = SCE-&gt;GetPosOffsets( geo::Point_t(kx,ky,kz));  // to get position offsets to be used in ionization electron drift</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">//CHECK         double g4Ticks =  detClocks-&gt;TPCG4Time2Tick(mcparticle-&gt;T())+theDetector-&gt;GetXTicksOffset(0,0,0)-theDetector-&gt;trigger_offset();</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//CHECK        double xtimeoffset =  theDetector-&gt;ConvertTicksToX(g4Ticks,0,0,0);</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//double xOffset = -scecorr.X() +xtimeoffset+0.6;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">double</span> yOffset = 0;<span class="comment">//CHECK scecorr.Y();</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">double</span> zOffset = 0;<span class="comment">//CHECK scecorr.Z();</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    corrected[0]= kx;<span class="comment">//CHECK- scecorr.X() + xtimeoffset + 0.6; //due to sim/wirecell differences  Seev https://cdcvs.fnal.gov/redmine/projects/uboone-physics-analysis/wiki/MCC9_Tutorials </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    corrected[1]=ky+yOffset;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    corrected[2]=kz+zOffset;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a2b26d1ec61d0eb05889a96a0723bafe3">   79</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a949dde62e8c07f4e36f2c6284ee04ace">spacecharge_correction</a>(<span class="keyword">const</span> simb::MCParticle &amp; mcparticle, std::vector&lt;double&gt; &amp; corrected){</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    corrected.resize(3);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//Space Charge Effect! functionize this soon.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">double</span> kx = mcparticle.Vx();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">double</span> ky = mcparticle.Vy();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> kz = mcparticle.Vz();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//CHECK         auto scecorr = SCE-&gt;GetPosOffsets( geo::Point_t(kx,ky,kz));</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//CHECK        double g4Ticks =  detClocks-&gt;TPCG4Time2Tick(mcparticle.T())+theDetector-&gt;GetXTicksOffset(0,0,0)-theDetector-&gt;trigger_offset();</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//CHECK        double xtimeoffset = 0;//CHECK theDetector-&gt;ConvertTicksToX(g4Ticks,0,0,0);</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    corrected[0]=kx;<span class="comment">//CHECK  - scecorr.X() +xtimeoffset+0.6;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    corrected[1]=ky;<span class="comment">//CHECK  + scecorr.Y();</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    corrected[2]=kz;<span class="comment">//CHECK  + scecorr.Z();</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a4453d8a99e999c86f5f233d096799401">   96</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a4453d8a99e999c86f5f233d096799401">CollectMCParticles</a>(</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keyword">const</span> art::Event &amp;<a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keyword">const</span> std::string &amp;label,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      std::map&lt; art::Ptr&lt;simb::MCTruth&gt;, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;simb::MCParticle&gt;&gt;&gt; &amp;truthToParticles,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      std::map&lt; art::Ptr&lt;simb::MCParticle&gt;, art::Ptr&lt;simb::MCTruth&gt;&gt; &amp;particlesToTruth,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      std::map&lt; <span class="keywordtype">int</span>, art::Ptr&lt;simb::MCParticle&gt; &gt; &amp; MCParticleToTrackIdMap,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          <a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html">var_all</a>&amp; vars){</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">//    if (evt.isRealData())</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">//      throw cet::exception(&quot;LArPandora&quot;) &lt;&lt; &quot; PandoraCollector::CollectMCParticles --- Trying to access MC truth from real data &quot;;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    art::Handle&lt; std::vector&lt; simb::MCParticle&gt;  &gt; theParticles;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    evt.getByLabel(label, theParticles);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (!theParticles.isValid())</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;LArPandora&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Failed to find MC particles... &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;LArPandora&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Found: &quot;</span> &lt;&lt; theParticles-&gt;size() &lt;&lt; <span class="stringliteral">&quot; MC particles &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    art::FindOneP&lt;simb::MCTruth&gt; theTruthAssns(theParticles, evt, label);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0, iEnd = theParticles-&gt;size(); i &lt; iEnd; ++i)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;simb::MCParticle&gt; particle(theParticles, i);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;simb::MCTruth&gt; truth(theTruthAssns.at(i));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      truthToParticles[truth].push_back(particle);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      particlesToTruth[particle] = truth;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      MCParticleToTrackIdMap[particle-&gt;TrackId()] = particle;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">//        std::cout&lt;&lt;&quot;CollectMCParticles() \t||\t the number of MCParticles in the event is &quot;&lt;&lt;theParticles-&gt;size()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a211df4ccc0a8f7db60057a339172cdcd">  134</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a211df4ccc0a8f7db60057a339172cdcd">CollectSimChannels</a>(<span class="keyword">const</span> art::Event &amp;<a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, <span class="keyword">const</span> std::string &amp;label,  <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt; art::Ptr&lt;sim::SimChannel&gt; &gt;  &amp;simChannelVector)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> (evt.isRealData())</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArPandora&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; PandoraCollector::CollectSimChannels --- Trying to access MC truth from real data &quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    art::Handle&lt; std::vector&lt;sim::SimChannel&gt; &gt; theSimChannels;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    evt.getByLabel(label, theSimChannels);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (!theSimChannels.isValid())</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;LArPandora&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Failed to find sim channels... &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;LArPandora&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Found: &quot;</span> &lt;&lt; theSimChannels-&gt;size() &lt;&lt; <span class="stringliteral">&quot; SimChannels &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; theSimChannels-&gt;size(); ++i)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;sim::SimChannel&gt; channel(theSimChannels, i);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      simChannelVector.push_back(channel);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a132aec70fbce70220380b16a363a5e8e">  160</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a132aec70fbce70220380b16a363a5e8e">BuildMCParticleHitMaps</a>(</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keyword">const</span> art::Event &amp;<a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">const</span> std::string &amp;label, </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt; &amp;hitVector,   </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      std::map&lt; art::Ptr&lt;simb::MCParticle&gt;,  <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt; &gt;  &gt;  &amp;particlesToHits,         </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      std::map&lt; art::Ptr&lt;recob::Hit&gt;, art::Ptr&lt;simb::MCParticle&gt; &gt;                  &amp;hitsToParticles, </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d4/d03/classlar__pandora_1_1LArPandoraHelper.html#a1c5c4ef4bb8fae2260fea8577938f623">lar_pandora::LArPandoraHelper::DaughterMode</a> daughterMode, </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      std::map&lt; <span class="keywordtype">int</span>, art::Ptr&lt;simb::MCParticle&gt; &gt; &amp; MCParticleToTrackIdMap,   </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html">var_all</a>&amp; vars){</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    std::vector&lt; art::Ptr&lt;sim::SimChannel&gt; &gt;   simChannelVector;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::map&lt; art::Ptr&lt;simb::MCTruth&gt;,     std::vector&lt;art::Ptr&lt;simb::MCParticle&gt;&gt;  &gt;    truthToParticles;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::map&lt; art::Ptr&lt;simb::MCParticle&gt;,  art::Ptr&lt;simb::MCTruth&gt; &gt; particlesToTruth;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::map&lt; art::Ptr&lt;recob::Hit&gt;,    std::vector&lt; sim::TrackIDE &gt;    &gt;               hitsToTrackIDEs;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../d4/da3/namespacesingle__photon.html#a211df4ccc0a8f7db60057a339172cdcd">CollectSimChannels</a>(evt, label, simChannelVector);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="../../d4/da3/namespacesingle__photon.html#a4453d8a99e999c86f5f233d096799401">CollectMCParticles</a>(evt, label, truthToParticles, particlesToTruth, MCParticleToTrackIdMap, vars);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">//Collect the links from reconstructed hits to their true energy deposits.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="../../d4/d03/classlar__pandora_1_1LArPandoraHelper.html#aa0a8dd4a0308bb192716b0144e6d1381">lar_pandora::LArPandoraHelper::BuildMCParticleHitMaps</a>(evt, hitVector, simChannelVector, hitsToTrackIDEs);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//Build mapping between Hits and MCParticles, starting from Hit/TrackIDE/MCParticle information</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../d4/d03/classlar__pandora_1_1LArPandoraHelper.html#aa0a8dd4a0308bb192716b0144e6d1381">lar_pandora::LArPandoraHelper::BuildMCParticleHitMaps</a>(hitsToTrackIDEs, truthToParticles, particlesToHits, hitsToParticles, daughterMode);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a7f9157e9b9f716a6601de41cc4baf702">  185</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a7f9157e9b9f716a6601de41cc4baf702">Pi0PreselectionFilter</a>(<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html">var_all</a>&amp; vars, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a6a9e73406c1ba1ac21bc45e6dd8e6a73">m_vertex_pos_x</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a893d1d99d96526ce9b26f02e434c0527">s_tpc_active_XMin</a>||  vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a6a9e73406c1ba1ac21bc45e6dd8e6a73">m_vertex_pos_x</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a361feddceef4d703c8fa9f1e8a5bed2e">s_tpc_active_XMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a13820d951a57f769e8e7eeff332df199">m_vertex_pos_y</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a19d1293958fb058cf8009db2ee642956">s_tpc_active_YMin</a> || vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a13820d951a57f769e8e7eeff332df199">m_vertex_pos_y</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a5738aa22dd145e2e7134e1146b488499">s_tpc_active_YMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a36e4eb5bb53df574cc89c33dff0941d1">m_vertex_pos_z</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a67b16614aff4dca7323f91bbdee85fb8">s_tpc_active_ZMin</a>||  vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a36e4eb5bb53df574cc89c33dff0941d1">m_vertex_pos_z</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#aac3aa0b42fe98c682d9c36141aa5ff8b">s_tpc_active_ZMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#af822bffc8963ff042d1c6ef28a8981d4">m_reco_asso_showers</a>!=2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a001a2ce1a24cf35adddd3146b3479a">m_reco_asso_tracks</a>!=1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a8aeaf8892b4e3331685ff4f583f14c2e">m_reco_vertex_size</a>&lt;1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a1bfa5d4634377f1d8a99989179aaf3">m_reco_shower_conversion_distance</a>.size()!=2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a1bfa5d4634377f1d8a99989179aaf3">m_reco_shower_conversion_distance</a>[0]&lt;1. || vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a1bfa5d4634377f1d8a99989179aaf3">m_reco_shower_conversion_distance</a>[1]&lt;1.) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a32e5b88d0f86f5b45d0af2f5527989a9">  203</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a32e5b88d0f86f5b45d0af2f5527989a9">Pi0PreselectionFilter2g0p</a>(<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html">var_all</a>&amp; vars, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a6a9e73406c1ba1ac21bc45e6dd8e6a73">m_vertex_pos_x</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a893d1d99d96526ce9b26f02e434c0527">s_tpc_active_XMin</a>||  vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a6a9e73406c1ba1ac21bc45e6dd8e6a73">m_vertex_pos_x</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a361feddceef4d703c8fa9f1e8a5bed2e">s_tpc_active_XMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a13820d951a57f769e8e7eeff332df199">m_vertex_pos_y</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a19d1293958fb058cf8009db2ee642956">s_tpc_active_YMin</a> || vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a13820d951a57f769e8e7eeff332df199">m_vertex_pos_y</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a5738aa22dd145e2e7134e1146b488499">s_tpc_active_YMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a36e4eb5bb53df574cc89c33dff0941d1">m_vertex_pos_z</a> &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a67b16614aff4dca7323f91bbdee85fb8">s_tpc_active_ZMin</a>||  vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a36e4eb5bb53df574cc89c33dff0941d1">m_vertex_pos_z</a> &gt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#aac3aa0b42fe98c682d9c36141aa5ff8b">s_tpc_active_ZMax</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#af822bffc8963ff042d1c6ef28a8981d4">m_reco_asso_showers</a>!=2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a001a2ce1a24cf35adddd3146b3479a">m_reco_asso_tracks</a>!=0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a8aeaf8892b4e3331685ff4f583f14c2e">m_reco_vertex_size</a>&lt;1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#ae41b4ab331f6016446ee3ab4baafabca">m_reco_shower_energy_max</a>.size()!=2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//if the maximum energy of all showers on all planes is smaller than 30</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#ae41b4ab331f6016446ee3ab4baafabca">m_reco_shower_energy_max</a>[vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#a52acd3881843d7423585f378afb96224">m_reco_shower_ordered_energy_index</a>[0]]&lt;30.) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#ab8906b26b24a73e5418582f50de9997b">  219</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#ab8906b26b24a73e5418582f50de9997b">IsEventInList</a>(<span class="keywordtype">int</span> run, <span class="keywordtype">int</span> subrun, <span class="keywordtype">int</span> event, <a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html">var_all</a>&amp; vars){</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span>(vars.<a class="code" href="../../d7/d83/structsingle__photon_1_1var__all.html#ae3e758251bf70ee0c3fe50e02a956121">m_selected_set</a>.find( {run, subrun, event} ) == vars.m_selected_set.end()){</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span>(vars.m_selected_set.find({run, subrun})  == vars.m_selected_set.end() ){</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span>(vars.m_selected_set.find({run}) == vars.m_selected_set.end())</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//----------- Above are migrated from Singlephoton_module.cc</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">//determines if a point is inside the rectangle by summing the areas of the four triangles made by </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">//if the point is inside, the sum of the triangles should exactly equal the area of the rectangle</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">//also returns true if the point is on the boundary</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a8789f981f007c8a913d06c35ef33ff52">  234</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a8789f981f007c8a913d06c35ef33ff52">isInsidev2</a>(std::vector&lt;double&gt; thishit_pos, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;std::vector&lt;double &gt;&gt; rectangle, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">int</span> n_vertices = (int)rectangle.size();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//bool inside = false;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">int</span> i, j = 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">double</span> areas = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//for each pair of vertices</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (i = 0, j = n_vertices-1; i &lt; n_vertices; j = i++) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">//calculate the area of a triangle with the point and two vertices</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordtype">double</span> this_area = 0.5*<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(rectangle[i][0]*(rectangle[j][1] - thishit_pos[1]) </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          + rectangle[j][0]*(thishit_pos[1] - rectangle[i][1]) </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          + thishit_pos[0]*(rectangle[i][1] - rectangle[j][1]));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      areas += this_area;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }        </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//calc area of the rectangle</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">double</span> area_rectangle = paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a23ea2859f0f99b25fc269ee3f1e8e491">s_width_dqdx_box</a>* paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a0d73750687a3a52840e012830921e178">s_length_dqdx_box</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">//check the sum of areas match</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(areas - area_rectangle) &lt;= 0.001 ){</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">//helpers for calculating calometry</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//  double CalcEShower(const std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; &amp;hits, var_all&amp; vars){</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//    double energy[3] = {0., 0., 0.};</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//    //std::cout&lt;&lt;&quot;AnalyzeShowers() \t||\t Looking at shower with &quot;&lt;&lt;hits.size() &lt;&lt;&quot; hits on all planes&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//    //for each hit in the shower</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">//    for (auto &amp;thishitptr : hits){</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//      //check the plane</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//      int plane= thishitptr-&gt;View();</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//      //skip invalid planes       </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//      if (plane &gt; 2 || plane &lt; 0)  continue;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//      //calc the energy of the hit</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">//      double E = QtoEConversion(GetQHit(thishitptr, plane, vars), vars);</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//      //add the energy to the plane</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//      energy[plane] += E;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//    }//for each hiti</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//    //find the max energy on a single plane</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//    double max = energy[0];</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">//    for (double en: energy){</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//      if( en &gt; max){</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">//        max = en;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">//    // std::cout&lt;&lt;&quot;AnalyzeShowers() \t||\t The energy on each plane for this shower is &quot;&lt;&lt;energy[0]&lt;&lt;&quot;, &quot;&lt;&lt;energy[1]&lt;&lt;&quot;, &quot;&lt;&lt;energy[2]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//    //return the highest energy on any of the planes</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">//    return max;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#aae85baf867fd22ef10631e0188f7fd41">  293</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#aae85baf867fd22ef10631e0188f7fd41">CalcEShowerPlane</a>(<span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; hits, <span class="keywordtype">int</span> this_plane, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">double</span> energy = 0.;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">//for each hit in the shower</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;thishitptr : hits){</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">//check the plane</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordtype">int</span> plane= thishitptr-&gt;View();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">//skip invalid planes       </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">if</span> (plane != this_plane )  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">//calc the energy of the hit</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a> = <a class="code" href="../../d4/da3/namespacesingle__photon.html#a2c575f77825d674392ea9346ca982d33">QtoEConversion</a>(<a class="code" href="../../d4/da3/namespacesingle__photon.html#a5ea2cb52fbd00c8a7ac75205913d066a">GetQHit</a>(thishitptr, plane, paras), paras);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">//add the energy to the plane</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      energy += <a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }<span class="comment">//for each hit</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> energy;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a5ea2cb52fbd00c8a7ac75205913d066a">  317</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a5ea2cb52fbd00c8a7ac75205913d066a">GetQHit</a>(art::Ptr&lt;recob::Hit&gt; thishitptr, <span class="keywordtype">int</span> plane, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">double</span> gain;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//choose gain based on whether data/mc and by plane</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#aba85266f40baec2c902d4c774cac5c16">s_is_data</a> == <span class="keyword">false</span> &amp;&amp;  paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#ad3d51caad6004d80940b81edefa3c155">s_is_overlayed</a> == <span class="keyword">false</span>){</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      gain = paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a5a85e27bc950c6127c30b0535fb04500">s_gain_mc</a>[plane] ;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">//if (g_is_verbose) std::cout&lt;&lt;&quot;the gain for mc on plane &quot;&lt;&lt;plane&lt;&lt;&quot; is &quot;&lt;&lt;gain&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    } <span class="keywordflow">if</span> (paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#aba85266f40baec2c902d4c774cac5c16">s_is_data</a> == <span class="keyword">true</span> ||  paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#ad3d51caad6004d80940b81edefa3c155">s_is_overlayed</a> == <span class="keyword">true</span>){</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      gain = paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a295d5bb93ac2aea01139653ffcbe617c">s_gain_data</a>[plane] ;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">//if (g_is_verbose) std::cout&lt;&lt;&quot;the gain for data on plane &quot;&lt;&lt;plane&lt;&lt;&quot; is &quot;&lt;&lt;gain&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">double</span> Q = thishitptr-&gt;Integral()*gain;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> Q;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a2c575f77825d674392ea9346ca982d33">  334</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a2c575f77825d674392ea9346ca982d33">QtoEConversion</a>(<span class="keywordtype">double</span> Q, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">//return the energy value converted to MeV (the factor of 1e-6)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a> = Q* paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#acae0fb0f54b23ab05d6f421c06dd6cc0">s_work_function</a> *1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-6 /paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#af4318c14ad6600c25d958f2f7506b3d0">s_recombination_factor</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#aac3926c5414ad17ca05ecf8d28e17d6f">  342</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="../../d4/da3/namespacesingle__photon.html#aac3926c5414ad17ca05ecf8d28e17d6f">CalcdEdxFromdQdx</a>(std::vector&lt;double&gt; dqdx, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = dqdx.size();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::vector&lt;double&gt; dedx(n,0.0);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; i++){</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;The dQ/dx is &quot;&lt;&lt;dqdx[i]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      dedx[i] = <a class="code" href="../../d4/da3/namespacesingle__photon.html#a2c575f77825d674392ea9346ca982d33">QtoEConversion</a>(dqdx[i], paras);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;The dE/dx is &quot;&lt;&lt;dedx[i]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> dedx;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#aa78262d4f35d241a78e5f32ca7aee013">  354</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="../../d4/da3/namespacesingle__photon.html#aa78262d4f35d241a78e5f32ca7aee013">CalcdQdxShower</a>(</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;recob::Shower&gt;&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Cluster&gt;&gt; &amp; clusters, </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      std::map&lt;art::Ptr&lt;recob::Cluster&gt;,    <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt; &gt; &amp;  clusterToHitMap ,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordtype">int</span> plane,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordtype">double</span> triggeroffset,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span> &amp; theDetector,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a> &amp; paras){</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">//if(g_is_verbose) std::cout&lt;&lt;&quot;AnalyzeShowers() \t||\t The number of clusters in this shower is &quot;&lt;&lt;clusters.size()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    std::vector&lt;double&gt; dqdx;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">//get the 3D shower direction</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">//note: in previous versions of the code there was a check to fix cases where the shower direction was inverted - this hasn&#39;t been implemented</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    TVector3 shower_dir(shower-&gt;Direction().X(), shower-&gt;Direction().Y(),shower-&gt;Direction().Z());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">//calculate the pitch for this plane</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">//CHECK upgradable, see ./Calibration/TrackCaloSkimmer_module.cc line 746</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">double</span> pitch = <a class="code" href="../../d4/da3/namespacesingle__photon.html#aba4c11adff3f609b92de82c1850f36e4">getPitch</a>(shower_dir, paras)[plane];  </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d4/da3/namespacesingle__photon.html#acad0c7714bc7007be7ce1b2c3f040612">g_is_verbose</a>) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;AnalyzeShowers() \t||\t The pitch between the shower and plane &quot;</span>&lt;&lt;plane&lt;&lt;<span class="stringliteral">&quot; is &quot;</span>&lt;&lt;pitch&lt;&lt;std::endl;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">//for all the clusters in the shower</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> art::Ptr&lt;recob::Cluster&gt; &amp;thiscluster: clusters){</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">//keep only clusters on the plane</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">if</span>(thiscluster-&gt;View() != plane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">//calculate the cluster direction</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      std::vector&lt;double&gt; cluster_axis = {cos(thiscluster-&gt;StartAngle()), sin(thiscluster-&gt;StartAngle())};    </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="comment">//get the cluster start and and in CM</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;for plane/tpc/cryo:&quot;&lt;&lt;plane&lt;&lt;&quot;/&quot;&lt;&lt;paras.s_TPC&lt;&lt;&quot;/&quot;&lt;&lt;paras.s_Cryostat&lt;&lt;&quot;, fXTicksOffset: &quot;&lt;&lt;theDetector-&gt;GetXTicksOffset(plane, paras.s_TPC, paras.s_Cryostat)&lt;&lt;&quot; fXTicksCoefficient: &quot;&lt;&lt;theDetector-&gt;GetXTicksCoefficient(paras.s_TPC, paras.s_Cryostat)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">//convert the cluster start and end positions to time and wire coordinates</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      std::vector&lt;double&gt; cluster_start = {thiscluster-&gt;StartWire() * paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a2c87cf4064bed8ae1a408c8dbf9bd8f4">s_wire_spacing</a>,(thiscluster-&gt;StartTick() - triggeroffset)* paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a7e6ad88632328cfb87509c0b07fd0f1f">_time2cm</a>};</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      std::vector&lt;double&gt; cluster_end = {thiscluster-&gt;EndWire() * paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a2c87cf4064bed8ae1a408c8dbf9bd8f4">s_wire_spacing</a>,(thiscluster-&gt;EndTick() - triggeroffset)* paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a7e6ad88632328cfb87509c0b07fd0f1f">_time2cm</a> };</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">//check that the cluster has non-zero length</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordtype">double</span> length = sqrt(pow(cluster_end[0] - cluster_start[0], 2) + pow(cluster_end[1] - cluster_start[1], 2));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">//if(g_is_verbose) std::cout&lt;&lt;&quot;AnalyzeShowers() \t||\t The cluster length is &quot;&lt;&lt;length&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">if</span> (length &lt;= 0){ </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a>&lt;&lt;<span class="stringliteral">&quot;skipping cluster on plane &quot;</span>&lt;&lt;plane&lt;&lt;<span class="stringliteral">&quot;, length = &quot;</span>&lt;&lt;length&lt;&lt;std::endl;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">//draw a rectangle around the cluster axis </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      std::vector&lt;std::vector&lt;double&gt;&gt; rectangle = <a class="code" href="../../d4/da3/namespacesingle__photon.html#a3a61d72c0d2e386d6ef15df8f5b88c04">buildRectangle</a>(cluster_start, cluster_axis, paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a23ea2859f0f99b25fc269ee3f1e8e491">s_width_dqdx_box</a>, paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a0d73750687a3a52840e012830921e178">s_length_dqdx_box</a>);  </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">//get all the hits for this cluster</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; hits =  clusterToHitMap[thiscluster];</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">//for each hit in the cluster</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">for</span> (art::Ptr&lt;recob::Hit&gt; &amp;thishit: hits){  </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">//get the hit position in cm from the wire and time</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        std::vector&lt;double&gt; thishit_pos ={thishit-&gt;WireID().Wire * paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a2c87cf4064bed8ae1a408c8dbf9bd8f4">s_wire_spacing</a>, (thishit-&gt;PeakTime() - triggeroffset)* paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a7e6ad88632328cfb87509c0b07fd0f1f">_time2cm</a>};</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">//check if inside the box</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">bool</span> v2 = <a class="code" href="../../d4/da3/namespacesingle__photon.html#a8789f981f007c8a913d06c35ef33ff52">isInsidev2</a>(thishit_pos, rectangle, paras);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">if</span> (v2){</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#a7ffae28be1e862c24a9f06074a0b0ba0">q</a> = <a class="code" href="../../d4/da3/namespacesingle__photon.html#a5ea2cb52fbd00c8a7ac75205913d066a">GetQHit</a>(thishit, plane, paras); </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="keywordtype">double</span> this_dqdx = q/pitch; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          dqdx.push_back(this_dqdx);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }<span class="comment">//if hit falls inside the box</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      }<span class="comment">//for each hit inthe cluster</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }<span class="comment">//for each cluster</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> dqdx;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#aba4c11adff3f609b92de82c1850f36e4">  424</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="../../d4/da3/namespacesingle__photon.html#aba4c11adff3f609b92de82c1850f36e4">getPitch</a>(TVector3 shower_dir, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        std::vector&lt;double&gt; pitches;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> <span class="keyword">const</span>&amp; plane: paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#ae0332584c3beb9dd937111850435bcee">s_geom</a>-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ae8ca7d464c8c3e1095ca64a640094367">IteratePlanes</a>()) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">//6 planes in SBND</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">//WireAngleToVertical  : 30 ,150,90,150,30 ,90</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">//ub wire angles    : 30 ,150,90  (respected to beam,z)</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">//Pitch        : 0.3,0.3,0.3,0.3,0.3,0.3</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> angToVert(paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#ae0332584c3beb9dd937111850435bcee">s_geom</a>-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a1c4a60af9e395182d4ecc267a2362d88">WireAngleToVertical</a>(plane.View(), plane.ID())+0.5*M_PI);<span class="comment">//wire angle respected to z + pi/2</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        TVector3 wire_vector;  </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(angToVert) &lt; 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-9 ){</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;          wire_vector = {0,0,1};</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          wire_vector = { 0 , sin(angToVert) ,cos(angToVert) };</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">//    std::cout&lt;&lt;&quot; Angle &quot;&lt;&lt;angToVert&lt;&lt;&quot; Get Vec y=&quot;&lt;&lt;wire_vector[1]&lt;&lt; &quot; z= &quot;&lt;&lt;wire_vector[2]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordtype">double</span> cos = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(wire_vector.Dot(shower_dir))/(wire_vector.Mag()*shower_dir.Mag());</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                pitches.push_back((cos==0)? std::numeric_limits&lt;double&gt;::max() : paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a2c87cf4064bed8ae1a408c8dbf9bd8f4">s_wire_spacing</a>/cos );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span>(pitches.size()==3) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keywordflow">return</span> pitches;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#ab61328a789ebba17713f4150b0957204">  454</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#ab61328a789ebba17713f4150b0957204">getMeanHitWidthPlane</a>(<a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt; hits, <span class="keywordtype">int</span> this_plane){</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">int</span> nhits = 0;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">double</span> widths = 0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">for</span> (art::Ptr&lt;recob::Hit&gt; thishitptr : hits){</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="comment">//check the plane</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordtype">int</span> plane= thishitptr-&gt;View();</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="comment">//skip invalid planes       </span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span> (plane != this_plane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      widths += thishitptr-&gt;RMS(); <span class="comment">// recob::Hit-&gt;RMS() returns RMS of the hit shape in tick units</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      nhits++;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }<span class="comment">//for each hiti</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span>   widths/(double)nhits;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#ab6d14ed2f4334e5ae0b343feb08702d9">  472</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#ab6d14ed2f4334e5ae0b343feb08702d9">getNHitsPlane</a>(<a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt; hits, <span class="keywordtype">int</span> this_plane){</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">int</span> nhits = 0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">for</span> (art::Ptr&lt;recob::Hit&gt; thishitptr : hits){</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="comment">//check the plane</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordtype">int</span> plane= thishitptr-&gt;View();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">//skip invalid planes       </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">if</span> (plane != this_plane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      nhits++;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }<span class="comment">//for each hiti</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">return</span> nhits;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a5abad483fe2290269baaf1328f6b4bed">  488</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a5abad483fe2290269baaf1328f6b4bed">triangle_area</a>(<span class="keywordtype">double</span> <a class="code" href="../../d3/dee/HoughBaseAlg_8cxx.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a>, <span class="keywordtype">double</span> <a class="code" href="../../d3/dee/HoughBaseAlg_8cxx.html#aa3fd046b2956875cf908d73a51a96b42">a2</a>, <span class="keywordtype">double</span> b1, <span class="keywordtype">double</span> b2, <span class="keywordtype">double</span> c1, <span class="keywordtype">double</span> c2){</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">double</span> m1 = 0.3;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">double</span> m2 = 1.0/25.0;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> fabs((a1*m1*(b2*m2-c2*m2)+b1*m1*(c2*m2-a2*m2)+c1*m1*(a2*m2-b2*m2))/2.0);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">  495</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">quick_delaunay_fit</a>(<span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>, <span class="keywordtype">double</span> *<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>, <span class="keywordtype">double</span> *Y, <span class="keywordtype">int</span> *num_triangles, <span class="keywordtype">double</span> * area){</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    std::vector&lt;double&gt; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>(n,0.0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    TGraph2D *<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a> = <span class="keyword">new</span> TGraph2D(n,X,Y,&amp;z[0]);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    TGraphDelaunay delan(g);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    delan.SetMarginBinsContent(0);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    delan.ComputeZ(0,0);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    delan.FindAllTriangles();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    (*num_triangles)=delan.GetNdt(); <span class="comment">// number of Delaunay triangles found</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">//Grab the locations of all the trianges. These will be intergers referencing to position in X,Y arrays</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    Int_t *MT = delan.GetMTried();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    Int_t *NT = delan.GetNTried();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    Int_t *PT = delan.GetPTried();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    (*area)=0.0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;delan.GetNdt(); i++){</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      (*area)+=<a class="code" href="../../d4/da3/namespacesingle__photon.html#a5abad483fe2290269baaf1328f6b4bed">triangle_area</a>(X[MT[i]-1],Y[MT[i]-1],X[NT[i]-1],Y[NT[i]-1],X[PT[i]-1],Y[PT[i]-1]);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="line" href="../../d4/da3/namespacesingle__photon.html#a848585de1351a42e1861e29d73bb3af5">  520</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/da3/namespacesingle__photon.html#a848585de1351a42e1861e29d73bb3af5">delaunay_hit_wrapper</a>(<span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; hits, std::vector&lt;int&gt; &amp; num_hits, std::vector&lt;int&gt;&amp; num_triangles, std::vector&lt;double&gt; &amp; area, <a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html">para_all</a>&amp; paras){</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = hits.size();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    std::vector&lt;double&gt; C0,<a class="code" href="../../db/dd5/gen__protons_8fcl.html#a2ba58fd55d60df6cb1370202e33b642e">T0</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    std::vector&lt;double&gt; C1,T1;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    std::vector&lt;double&gt; C2,T2;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">size_t</span> n_0=0;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">size_t</span> n_1=0;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">size_t</span> n_2=0;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; i++){</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keyword">const</span> art::Ptr&lt;recob::Hit&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = hits[i];</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">switch</span>(hit-&gt;View()){</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          C0.push_back((<span class="keywordtype">double</span>)hit-&gt;WireID().Wire);         </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          T0.push_back(hit-&gt;PeakTime());         </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          n_0++;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          C1.push_back((<span class="keywordtype">double</span>)hit-&gt;WireID().Wire);         </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          T1.push_back(hit-&gt;PeakTime());         </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          n_1++;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          C2.push_back((<span class="keywordtype">double</span>)hit-&gt;WireID().Wire);         </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          T2.push_back(hit-&gt;PeakTime());         </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          n_2++;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>(paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#af0b6207454bcd9ff177bf9571c343e7d">s_use_delaunay</a>){</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">if</span>(n_0&gt;0 &amp;&amp; (<span class="keywordtype">int</span>)n_0 &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a535cacde47c623f65ec6108932fbcbec">s_delaunay_max_hits</a>) <a class="code" href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">quick_delaunay_fit</a>(n_0, &amp;C0[0]  , &amp;T0[0]  , &amp;num_triangles[0], &amp;area[0]);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">if</span>(n_1&gt;0 &amp;&amp; (<span class="keywordtype">int</span>)n_1 &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a535cacde47c623f65ec6108932fbcbec">s_delaunay_max_hits</a>) <a class="code" href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">quick_delaunay_fit</a>(n_1, &amp;C1[0]  , &amp;T1[0]  , &amp;num_triangles[1], &amp;area[1]);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">if</span>(n_2&gt;0 &amp;&amp; (<span class="keywordtype">int</span>)n_2 &lt; paras.<a class="code" href="../../d0/d28/structsingle__photon_1_1para__all.html#a535cacde47c623f65ec6108932fbcbec">s_delaunay_max_hits</a>) <a class="code" href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">quick_delaunay_fit</a>(n_2, &amp;C2[0]  , &amp;T2[0]  , &amp;num_triangles[2], &amp;area[2]);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    num_hits[0] = n_0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    num_hits[1] = n_1;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    num_hits[2] = n_2;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;Plane 0: &quot;&lt;&lt;n_0&lt;&lt;&quot; hits with &quot;&lt;&lt;num_triangles[0]&lt;&lt;&quot; triangles of area: &quot;&lt;&lt; area[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;Plane 1: &quot;&lt;&lt;n_1&lt;&lt;&quot; hits with &quot;&lt;&lt;num_triangles[1]&lt;&lt;&quot; triangles of area: &quot;&lt;&lt; area[1]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;Plane 2: &quot;&lt;&lt;n_2&lt;&lt;&quot; hits with &quot;&lt;&lt;num_triangles[2]&lt;&lt;&quot; triangles of area: &quot;&lt;&lt; area[2]&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div>
<div class="ttc" id="namespacesingle__photon_html_aac3926c5414ad17ca05ecf8d28e17d6f"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#aac3926c5414ad17ca05ecf8d28e17d6f">single_photon::CalcdEdxFromdQdx</a></div><div class="ttdeci">std::vector&lt; double &gt; CalcdEdxFromdQdx(std::vector&lt; double &gt; dqdx, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00342">Processors.cxx:342</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_aba85266f40baec2c902d4c774cac5c16"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#aba85266f40baec2c902d4c774cac5c16">single_photon::para_all::s_is_data</a></div><div class="ttdeci">bool s_is_data</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00057">variables.h:57</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a23ea2859f0f99b25fc269ee3f1e8e491"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a23ea2859f0f99b25fc269ee3f1e8e491">single_photon::para_all::s_width_dqdx_box</a></div><div class="ttdeci">double s_width_dqdx_box</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00151">variables.h:151</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a4453d8a99e999c86f5f233d096799401"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a4453d8a99e999c86f5f233d096799401">single_photon::CollectMCParticles</a></div><div class="ttdeci">void CollectMCParticles(const art::Event &amp;evt, const std::string &amp;label, std::map&lt; art::Ptr&lt; simb::MCTruth &gt;, std::vector&lt; art::Ptr&lt; simb::MCParticle &gt;&gt;&gt; &amp;truthToParticles, std::map&lt; art::Ptr&lt; simb::MCParticle &gt;, art::Ptr&lt; simb::MCTruth &gt;&gt; &amp;particlesToTruth, std::map&lt; int, art::Ptr&lt; simb::MCParticle &gt; &gt; &amp;MCParticleToTrackIdMap, var_all &amp;vars)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00096">Processors.cxx:96</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_ad3d51caad6004d80940b81edefa3c155"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#ad3d51caad6004d80940b81edefa3c155">single_photon::para_all::s_is_overlayed</a></div><div class="ttdeci">bool s_is_overlayed</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00058">variables.h:58</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_ae3e758251bf70ee0c3fe50e02a956121"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#ae3e758251bf70ee0c3fe50e02a956121">single_photon::var_all::m_selected_set</a></div><div class="ttdeci">std::set&lt; std::vector&lt; int &gt; &gt; m_selected_set</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00314">variables.h:314</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_ab6d14ed2f4334e5ae0b343feb08702d9"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#ab6d14ed2f4334e5ae0b343feb08702d9">single_photon::getNHitsPlane</a></div><div class="ttdeci">int getNHitsPlane(std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; hits, int this_plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00472">Processors.cxx:472</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ae8ca7d464c8c3e1095ca64a640094367"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ae8ca7d464c8c3e1095ca64a640094367">geo::GeometryCore::IteratePlanes</a></div><div class="ttdeci">IteratorBox&lt; plane_iterator,&amp;GeometryCore::begin_plane,&amp;GeometryCore::end_plane &gt; IteratePlanes() const </div><div class="ttdoc">Enables ranged-for loops on all planes of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l03212">GeometryCore.h:3212</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_aac3aa0b42fe98c682d9c36141aa5ff8b"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#aac3aa0b42fe98c682d9c36141aa5ff8b">single_photon::para_all::s_tpc_active_ZMax</a></div><div class="ttdeci">double s_tpc_active_ZMax</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00149">variables.h:149</a></div></div>
<div class="ttc" id="variables_8h_html"><div class="ttname"><a href="../../de/dca/variables_8h.html">variables.h</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html">single_photon::para_all</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00048">variables.h:48</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a67b16614aff4dca7323f91bbdee85fb8"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a67b16614aff4dca7323f91bbdee85fb8">single_photon::para_all::s_tpc_active_ZMin</a></div><div class="ttdeci">double s_tpc_active_ZMin</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00146">variables.h:146</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a132aec70fbce70220380b16a363a5e8e"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a132aec70fbce70220380b16a363a5e8e">single_photon::BuildMCParticleHitMaps</a></div><div class="ttdeci">void BuildMCParticleHitMaps(const art::Event &amp;evt, const std::string &amp;label, const std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;hitVector, std::map&lt; art::Ptr&lt; simb::MCParticle &gt;, std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt; &gt; &amp;particlesToHits, std::map&lt; art::Ptr&lt; recob::Hit &gt;, art::Ptr&lt; simb::MCParticle &gt; &gt; &amp;hitsToParticles, const lar_pandora::LArPandoraHelper::DaughterMode daughterMode, std::map&lt; int, art::Ptr&lt; simb::MCParticle &gt; &gt; &amp;MCParticleToTrackIdMap, var_all &amp;vars)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00160">Processors.cxx:160</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a13820d951a57f769e8e7eeff332df199"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a13820d951a57f769e8e7eeff332df199">single_photon::var_all::m_vertex_pos_y</a></div><div class="ttdeci">double m_vertex_pos_y</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00419">variables.h:419</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_acae0fb0f54b23ab05d6f421c06dd6cc0"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#acae0fb0f54b23ab05d6f421c06dd6cc0">single_photon::para_all::s_work_function</a></div><div class="ttdeci">double s_work_function</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00126">variables.h:126</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_a7ffae28be1e862c24a9f06074a0b0ba0"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#a7ffae28be1e862c24a9f06074a0b0ba0">channelDBConverter.q</a></div><div class="ttdeci">string q</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00143">channelDBConverter.py:143</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html">single_photon::var_all</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00167">variables.h:167</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a36e4eb5bb53df574cc89c33dff0941d1"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a36e4eb5bb53df574cc89c33dff0941d1">single_photon::var_all::m_vertex_pos_z</a></div><div class="ttdeci">double m_vertex_pos_z</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00420">variables.h:420</a></div></div>
<div class="ttc" id="rawtorootconvert_8fcl_html_a073d3febd81cab639f2a8aa357dc5ef1"><div class="ttname"><a href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a></div><div class="ttdeci">process_name E</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3a/rawtorootconvert_8fcl_source.html#l00026">rawtorootconvert.fcl:26</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a848585de1351a42e1861e29d73bb3af5"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a848585de1351a42e1861e29d73bb3af5">single_photon::delaunay_hit_wrapper</a></div><div class="ttdeci">int delaunay_hit_wrapper(const std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;hits, std::vector&lt; int &gt; &amp;num_hits, std::vector&lt; int &gt; &amp;num_triangles, std::vector&lt; double &gt; &amp;area, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00520">Processors.cxx:520</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a8aeaf8892b4e3331685ff4f583f14c2e"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a8aeaf8892b4e3331685ff4f583f14c2e">single_photon::var_all::m_reco_vertex_size</a></div><div class="ttdeci">int m_reco_vertex_size</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00417">variables.h:417</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a361feddceef4d703c8fa9f1e8a5bed2e"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a361feddceef4d703c8fa9f1e8a5bed2e">single_photon::para_all::s_tpc_active_XMax</a></div><div class="ttdeci">double s_tpc_active_XMax</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00147">variables.h:147</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a8789f981f007c8a913d06c35ef33ff52"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a8789f981f007c8a913d06c35ef33ff52">single_photon::isInsidev2</a></div><div class="ttdeci">bool isInsidev2(std::vector&lt; double &gt; thishit_pos, std::vector&lt; std::vector&lt; double &gt;&gt; rectangle, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00234">Processors.cxx:234</a></div></div>
<div class="ttc" id="decoderTools__icarus_8fcl_html_a86703f8a44dd6742852257943d5a25c6"><div class="ttname"><a href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a></div><div class="ttdeci">BEGIN_PROLOG g</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d79/decoderTools__icarus_8fcl_source.html#l00007">decoderTools_icarus.fcl:7</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_ad36c739018def8e4e44032f4cf395c9d"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a></div><div class="ttdeci">process_name shower</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_af822bffc8963ff042d1c6ef28a8981d4"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#af822bffc8963ff042d1c6ef28a8981d4">single_photon::var_all::m_reco_asso_showers</a></div><div class="ttdeci">int m_reco_asso_showers</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00431">variables.h:431</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a5738aa22dd145e2e7134e1146b488499"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a5738aa22dd145e2e7134e1146b488499">single_photon::para_all::s_tpc_active_YMax</a></div><div class="ttdeci">double s_tpc_active_YMax</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00148">variables.h:148</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a535cacde47c623f65ec6108932fbcbec"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a535cacde47c623f65ec6108932fbcbec">single_photon::para_all::s_delaunay_max_hits</a></div><div class="ttdeci">int s_delaunay_max_hits</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00055">variables.h:55</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a2a001a2ce1a24cf35adddd3146b3479a"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a001a2ce1a24cf35adddd3146b3479a">single_photon::var_all::m_reco_asso_tracks</a></div><div class="ttdeci">int m_reco_asso_tracks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00572">variables.h:572</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a6a9e73406c1ba1ac21bc45e6dd8e6a73"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a6a9e73406c1ba1ac21bc45e6dd8e6a73">single_photon::var_all::m_vertex_pos_x</a></div><div class="ttdeci">double m_vertex_pos_x</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00418">variables.h:418</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a295d5bb93ac2aea01139653ffcbe617c"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a295d5bb93ac2aea01139653ffcbe617c">single_photon::para_all::s_gain_data</a></div><div class="ttdeci">std::vector&lt; double &gt; s_gain_data</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00130">variables.h:130</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="HoughBaseAlg_8cxx_html_aa3fd046b2956875cf908d73a51a96b42"><div class="ttname"><a href="../../d3/dee/HoughBaseAlg_8cxx.html#aa3fd046b2956875cf908d73a51a96b42">a2</a></div><div class="ttdeci">#define a2</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dee/HoughBaseAlg_8cxx_source.html#l00064">HoughBaseAlg.cxx:64</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a5a85e27bc950c6127c30b0535fb04500"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a5a85e27bc950c6127c30b0535fb04500">single_photon::para_all::s_gain_mc</a></div><div class="ttdeci">std::vector&lt; double &gt; s_gain_mc</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00129">variables.h:129</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a32e5b88d0f86f5b45d0af2f5527989a9"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a32e5b88d0f86f5b45d0af2f5527989a9">single_photon::Pi0PreselectionFilter2g0p</a></div><div class="ttdeci">bool Pi0PreselectionFilter2g0p(var_all &amp;vars, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00203">Processors.cxx:203</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a7f9157e9b9f716a6601de41cc4baf702"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a7f9157e9b9f716a6601de41cc4baf702">single_photon::Pi0PreselectionFilter</a></div><div class="ttdeci">bool Pi0PreselectionFilter(var_all &amp;vars, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00185">Processors.cxx:185</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_ae41b4ab331f6016446ee3ab4baafabca"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#ae41b4ab331f6016446ee3ab4baafabca">single_photon::var_all::m_reco_shower_energy_max</a></div><div class="ttdeci">std::vector&lt; double &gt; m_reco_shower_energy_max</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00988">variables.h:988</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a19d1293958fb058cf8009db2ee642956"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a19d1293958fb058cf8009db2ee642956">single_photon::para_all::s_tpc_active_YMin</a></div><div class="ttdeci">double s_tpc_active_YMin</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a211df4ccc0a8f7db60057a339172cdcd"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a211df4ccc0a8f7db60057a339172cdcd">single_photon::CollectSimChannels</a></div><div class="ttdeci">void CollectSimChannels(const art::Event &amp;evt, const std::string &amp;label, std::vector&lt; art::Ptr&lt; sim::SimChannel &gt; &gt; &amp;simChannelVector)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00134">Processors.cxx:134</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_ab61328a789ebba17713f4150b0957204"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#ab61328a789ebba17713f4150b0957204">single_photon::getMeanHitWidthPlane</a></div><div class="ttdeci">double getMeanHitWidthPlane(std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; hits, int this_plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00454">Processors.cxx:454</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a></div><div class="ttdoc">Geometry information for a single wire plane.The plane is represented in the geometry by a solid whic...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00082">PlaneGeo.h:82</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_af4318c14ad6600c25d958f2f7506b3d0"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#af4318c14ad6600c25d958f2f7506b3d0">single_photon::para_all::s_recombination_factor</a></div><div class="ttdeci">double s_recombination_factor</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00127">variables.h:127</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_af0b6207454bcd9ff177bf9571c343e7d"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#af0b6207454bcd9ff177bf9571c343e7d">single_photon::para_all::s_use_delaunay</a></div><div class="ttdeci">bool s_use_delaunay</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00054">variables.h:54</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a5abad483fe2290269baaf1328f6b4bed"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a5abad483fe2290269baaf1328f6b4bed">single_photon::triangle_area</a></div><div class="ttdeci">double triangle_area(double a1, double a2, double b1, double b2, double c1, double c2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00488">Processors.cxx:488</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_ae0332584c3beb9dd937111850435bcee"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#ae0332584c3beb9dd937111850435bcee">single_photon::para_all::s_geom</a></div><div class="ttdeci">geo::GeometryCore const * s_geom</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00143">variables.h:143</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a3a61d72c0d2e386d6ef15df8f5b88c04"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a3a61d72c0d2e386d6ef15df8f5b88c04">single_photon::buildRectangle</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; buildRectangle(std::vector&lt; double &gt; cluster_start, std::vector&lt; double &gt; cluster_axis, double width, double length)</div><div class="ttdoc">Calculates the four corners of a rectangle of given length and width around a cluster given the start...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/helper__math_8cxx_source.html#l00164">helper_math.cxx:164</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a0d73750687a3a52840e012830921e178"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a0d73750687a3a52840e012830921e178">single_photon::para_all::s_length_dqdx_box</a></div><div class="ttdeci">double s_length_dqdx_box</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00152">variables.h:152</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_aa78262d4f35d241a78e5f32ca7aee013"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#aa78262d4f35d241a78e5f32ca7aee013">single_photon::CalcdQdxShower</a></div><div class="ttdeci">std::vector&lt; double &gt; CalcdQdxShower(const art::Ptr&lt; recob::Shower &gt; &amp;shower, const std::vector&lt; art::Ptr&lt; recob::Cluster &gt;&gt; &amp;clusters, std::map&lt; art::Ptr&lt; recob::Cluster &gt;, std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &gt; &amp;clusterToHitMap, int plane, double triggeroffset, detinfo::DetectorPropertiesData const &amp;theDetector, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00354">Processors.cxx:354</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a949dde62e8c07f4e36f2c6284ee04ace"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a949dde62e8c07f4e36f2c6284ee04ace">single_photon::spacecharge_correction</a></div><div class="ttdeci">int spacecharge_correction(const art::Ptr&lt; simb::MCParticle &gt; &amp;mcparticle, std::vector&lt; double &gt; &amp;corrected, std::vector&lt; double &gt; &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00025">Processors.cxx:25</a></div></div>
<div class="ttc" id="classlar__pandora_1_1LArPandoraHelper_html_a1c5c4ef4bb8fae2260fea8577938f623"><div class="ttname"><a href="../../d4/d03/classlar__pandora_1_1LArPandoraHelper.html#a1c5c4ef4bb8fae2260fea8577938f623">lar_pandora::LArPandoraHelper::DaughterMode</a></div><div class="ttdeci">DaughterMode</div><div class="ttdoc">DaughterMode enumeration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d35/LArPandoraHelper_8h_source.html#l00124">LArPandoraHelper.h:124</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a52acd3881843d7423585f378afb96224"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a52acd3881843d7423585f378afb96224">single_photon::var_all::m_reco_shower_ordered_energy_index</a></div><div class="ttdeci">std::vector&lt; size_t &gt; m_reco_shower_ordered_energy_index</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l01012">variables.h:1012</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_aae85baf867fd22ef10631e0188f7fd41"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#aae85baf867fd22ef10631e0188f7fd41">single_photon::CalcEShowerPlane</a></div><div class="ttdeci">double CalcEShowerPlane(const std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;hits, int this_plane, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00293">Processors.cxx:293</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_aba4c11adff3f609b92de82c1850f36e4"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#aba4c11adff3f609b92de82c1850f36e4">single_photon::getPitch</a></div><div class="ttdeci">std::vector&lt; double &gt; getPitch(TVector3 shower_dir, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00424">Processors.cxx:424</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_acad0c7714bc7007be7ce1b2c3f040612"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#acad0c7714bc7007be7ce1b2c3f040612">single_photon::g_is_verbose</a></div><div class="ttdeci">bool g_is_verbose</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/df8/init__branches_8h_source.html#l00013">init_branches.h:13</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a5ea2cb52fbd00c8a7ac75205913d066a"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a5ea2cb52fbd00c8a7ac75205913d066a">single_photon::GetQHit</a></div><div class="ttdeci">double GetQHit(art::Ptr&lt; recob::Hit &gt; thishitptr, int plane, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00317">Processors.cxx:317</a></div></div>
<div class="ttc" id="helper__math_8h_html"><div class="ttname"><a href="../../d2/de2/helper__math_8h.html">helper_math.h</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a893d1d99d96526ce9b26f02e434c0527"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a893d1d99d96526ce9b26f02e434c0527">single_photon::para_all::s_tpc_active_XMin</a></div><div class="ttdeci">double s_tpc_active_XMin</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00144">variables.h:144</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a2c575f77825d674392ea9346ca982d33"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a2c575f77825d674392ea9346ca982d33">single_photon::QtoEConversion</a></div><div class="ttdeci">double QtoEConversion(double Q, para_all &amp;paras)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00334">Processors.cxx:334</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a2c87cf4064bed8ae1a408c8dbf9bd8f4"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a2c87cf4064bed8ae1a408c8dbf9bd8f4">single_photon::para_all::s_wire_spacing</a></div><div class="ttdeci">double s_wire_spacing</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00131">variables.h:131</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_ab8906b26b24a73e5418582f50de9997b"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#ab8906b26b24a73e5418582f50de9997b">single_photon::IsEventInList</a></div><div class="ttdeci">bool IsEventInList(int run, int subrun, int event, var_all &amp;vars)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00219">Processors.cxx:219</a></div></div>
<div class="ttc" id="namespacesingle__photon_html_a159d852034191ccc2a449c7cbba09dc8"><div class="ttname"><a href="../../d4/da3/namespacesingle__photon.html#a159d852034191ccc2a449c7cbba09dc8">single_photon::quick_delaunay_fit</a></div><div class="ttdeci">int quick_delaunay_fit(int n, double *X, double *Y, int *num_triangles, double *area)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd4/Processors_8cxx_source.html#l00495">Processors.cxx:495</a></div></div>
<div class="ttc" id="Processors_8h_html"><div class="ttname"><a href="../../d3/d9c/Processors_8h.html">Processors.h</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00008">DataStructs.cxx:8</a></div></div>
<div class="ttc" id="classlar__pandora_1_1LArPandoraHelper_html_aa0a8dd4a0308bb192716b0144e6d1381"><div class="ttname"><a href="../../d4/d03/classlar__pandora_1_1LArPandoraHelper.html#aa0a8dd4a0308bb192716b0144e6d1381">lar_pandora::LArPandoraHelper::BuildMCParticleHitMaps</a></div><div class="ttdeci">static void BuildMCParticleHitMaps(const art::Event &amp;evt, const HitVector &amp;hitVector, const SimChannelVector &amp;simChannelVector, HitsToTrackIDEs &amp;hitsToTrackIDEs)</div><div class="ttdoc">Collect the links from reconstructed hits to their true energy deposits. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/LArPandoraHelper_8cxx_source.html#l00917">LArPandoraHelper.cxx:917</a></div></div>
<div class="ttc" id="structsingle__photon_1_1var__all_html_a2a1bfa5d4634377f1d8a99989179aaf3"><div class="ttname"><a href="../../d7/d83/structsingle__photon_1_1var__all.html#a2a1bfa5d4634377f1d8a99989179aaf3">single_photon::var_all::m_reco_shower_conversion_distance</a></div><div class="ttdeci">std::vector&lt; double &gt; m_reco_shower_conversion_distance</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00799">variables.h:799</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a1c4a60af9e395182d4ecc267a2362d88"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a1c4a60af9e395182d4ecc267a2362d88">geo::GeometryCore::WireAngleToVertical</a></div><div class="ttdeci">double WireAngleToVertical(geo::View_t view, geo::TPCID const &amp;tpcid) const </div><div class="ttdoc">Returns the angle of the wires in the specified view from vertical. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00892">GeometryCore.cxx:892</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="structsingle__photon_1_1para__all_html_a7e6ad88632328cfb87509c0b07fd0f1f"><div class="ttname"><a href="../../d0/d28/structsingle__photon_1_1para__all.html#a7e6ad88632328cfb87509c0b07fd0f1f">single_photon::para_all::_time2cm</a></div><div class="ttdeci">double _time2cm</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/variables_8h_source.html#l00051">variables.h:51</a></div></div>
<div class="ttc" id="gen__protons_8fcl_html_a2ba58fd55d60df6cb1370202e33b642e"><div class="ttname"><a href="../../db/dd5/gen__protons_8fcl.html#a2ba58fd55d60df6cb1370202e33b642e">T0</a></div><div class="ttdeci">process_name opdaq physics producers generator physics producers generator physics producers generator physics producers generator physics producers generator physics producers generator physics producers generator physics producers generator T0</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd5/gen__protons_8fcl_source.html#l00045">gen_protons.fcl:45</a></div></div>
<div class="ttc" id="HoughBaseAlg_8cxx_html_ab89a77e63a7226fffaecb2e2c2ab5219"><div class="ttname"><a href="../../d3/dee/HoughBaseAlg_8cxx.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a></div><div class="ttdeci">#define a1</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dee/HoughBaseAlg_8cxx_source.html#l00063">HoughBaseAlg.cxx:63</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
