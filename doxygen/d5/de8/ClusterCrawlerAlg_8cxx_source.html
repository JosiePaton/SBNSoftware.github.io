<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ClusterCrawlerAlg.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_a92975983e87729a773cfa3b8109c8c3.html">RecoAlg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ClusterCrawlerAlg.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/de8/ClusterCrawlerAlg_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// ClusterCrawlerAlg class</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment">/// Bruce Baller, baller@fnal.gov</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="comment">/// Algorithm for crawling along a string of hits to make line clusters</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span><span class="comment">/// Technical note in MicroBooNE docdb #2831</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span><span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// C/C++ standard libraries</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::fill(), std::find(), std::sort()...</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// framework libraries</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;canvas/Utilities/Exception.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// LArSoft libraries</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2e/ServiceUtil_8h.html">larcore/CoreUtils/ServiceUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d16/NumericUtils_8h.html">larcorealg/CoreUtils/NumericUtils.h</a>&quot;</span> <span class="comment">// util::absDiff()</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d13/CryostatGeo_8h.html">larcorealg/Geometry/CryostatGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d7c/Exceptions_8h.html">larcorealg/Geometry/Exceptions.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de7/GeometryCore_8h.html">larcorealg/Geometry/GeometryCore.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/de9/TPCGeo_8h.html">larcorealg/Geometry/TPCGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d38/RawTypes_8h.html">larcoreobj/SimpleTypesAndConstants/RawTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d5b/DetectorClocksData_8h.html">lardataalg/DetectorInfo/DetectorClocksData.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7a/DetectorPropertiesData_8h.html">lardataalg/DetectorInfo/DetectorPropertiesData.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/ded/ChannelStatusProvider_8h.html">larevt/CalibrationDBI/Interface/ChannelStatusProvider.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/da1/ChannelStatusService_8h.html">larevt/CalibrationDBI/Interface/ChannelStatusService.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/df7/ClusterCrawlerAlg_8h.html">larreco/RecoAlg/ClusterCrawlerAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keyword">struct </span>CluLen {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/d4d/structCluLen.html#af2b4b8f0fe8bc09b99b0dbffbdf543d9">index</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/d4d/structCluLen.html#aeb663404d4e43977d0d71780c784426d">length</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  };</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">greaterThan</a>(CluLen c1, CluLen c2)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">return</span> c1.length &gt; c2.length;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d2/d36/cheaterreco_8fcl.html#afac1ac7b61385644c993fbb774a1922f">cluster</a> {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a73a2cc712d32daac007c06b7ec72e99f">   55</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a73a2cc712d32daac007c06b7ec72e99f">ClusterCrawlerAlg::ClusterCrawlerAlg</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> = pset.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;NumPass&quot;</span>, 0);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">fMaxHitsFit</a> = pset.get&lt;std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;MaxHitsFit&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a> = pset.get&lt;std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;MinHits&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a> = pset.get&lt;std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;NHitsAve&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;ChgCut&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;ChiCut&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a> = pset.get&lt;std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;MaxWirSkip&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a> = pset.get&lt;std::vector&lt;unsigned short&gt;&gt;(<span class="stringliteral">&quot;MinWirAfterSkip&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;KinkChiRat&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;KinkAngCut&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1366fdc2b8c67bd345efa80fba6d9372">fDoMerge</a> = pset.get&lt;std::vector&lt;bool&gt;&gt;(<span class="stringliteral">&quot;DoMerge&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;TimeDelta&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">fMergeChgCut</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;MergeChgCut&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6eb30d981381f693ca3a13a0c53aaa43">fFindVertices</a> = pset.get&lt;std::vector&lt;bool&gt;&gt;(<span class="stringliteral">&quot;FindVertices&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af85b0b7218a61e4e8780f91bf9671a6a">fLACrawl</a> = pset.get&lt;std::vector&lt;bool&gt;&gt;(<span class="stringliteral">&quot;LACrawl&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af057de7165e772a5695df4a064cabe3c">fMinAmp</a> = pset.get&lt;std::vector&lt;float&gt;&gt;(<span class="stringliteral">&quot;MinAmp&quot;</span>, {5, 5, 5});</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">fChgNearWindow</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ChgNearWindow&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb1313fc4ff7dcd4fcadc51726995370">fChgNearCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ChgNearCut&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a584d1502c5d50ffd31316434c89e7ed0">fChkClusterDS</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;ChkClusterDS&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7a523546da7313b6b9dbbda9602bf3c">fVtxClusterSplit</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;VtxClusterSplit&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb26863a1a3a9c86dd5673819ad86341">fFindStarVertices</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;FindStarVertices&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (pset.has_key(<span class="stringliteral">&quot;HammerCluster&quot;</span>)) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;fcl setting HammerCluster is replaced by FindHammerClusters. Ignoring...&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9f691b9125975884fc57268dadbf43f0">fFindHammerClusters</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;FindHammerClusters&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a82d67757957951b41909a2e2b0a70848">fKillGarbageClusters</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;KillGarbageClusters&quot;</span>, 0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5b4ccf0120f3097f2aa305a7459f225c">fRefineVertexClusters</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;RefineVertexClusters&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;HitErrFac&quot;</span>, 0.2);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1f19cc2e366ab1fae56fc60994e15c01">fHitMinAmp</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;HitMinAmp&quot;</span>, 0.2);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1dfffb608e5fb454826dd6d0c761cde">fClProjErrFac</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ClProjErrFac&quot;</span>, 4);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5777e2db6b5db18dbc7c37604573d8cc">fMinHitFrac</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;MinHitFrac&quot;</span>, 0.6);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80c993ef6f49211a927f1f1f5392aea0">fLAClusAngleCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;LAClusAngleCut&quot;</span>, 45);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a67d7ff71d4cf0ac3884a4e33edd9d656">fLAClusMaxHitsFit</a> = pset.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;LAClusMaxHitsFit&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8c27ede03b402b47c349b8bb1307ff1a">fMergeAllHits</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;MergeAllHits&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;HitMergeChiCut&quot;</span>, 2.5);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a46ae3e73aa21823d7d5ad051e0cf1398">fMergeOverlapAngCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;MergeOverlapAngCut&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a> = pset.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&gt;(<span class="stringliteral">&quot;AllowNoHitWire&quot;</span>, 0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;Vertex2DCut&quot;</span>, 5);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;Vertex2DWireErrCut&quot;</span>, 5);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a> = pset.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;Vertex3DCut&quot;</span>, 5);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;DebugPlane&quot;</span>, -1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;DebugWire&quot;</span>, -1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;DebugHit&quot;</span>, -1);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// some error checking</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">bool</span> badinput = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fMaxHitsFit.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fMinHits.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fNHitsAve.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fChgCut.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fChiCut.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fMaxWirSkip.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fMinWirAfterSkip.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fKinkChiRat.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fKinkAngCut.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fDoMerge.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fTimeDelta.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fMergeChgCut.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fFindVertices.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; fLACrawl.size()) badinput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (badinput)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">throw</span> art::Exception(art::errors::Configuration)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ClusterCrawlerAlg: Bad input from fcl file&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  } <span class="comment">// reconfigure</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// used for sorting hits on wires</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">  130</a></span>&#160;  <a class="code" href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">SortByLowHit</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> i &gt; j;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa659c4e326fc21a0be8331f5d09ed16b">  136</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa659c4e326fc21a0be8331f5d09ed16b">ClusterCrawlerAlg::SortByMultiplet</a>(<a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a>, <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; b)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// compare the wire IDs first:</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">int</span> cmp_res = a.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a6c4d41481be36036bcdb3ad0b47f8b77">cmp</a>(b.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (cmp_res != 0) <span class="keywordflow">return</span> cmp_res &lt; 0; <span class="comment">// order is decided, unless equal</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// decide by start time</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>() != b.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>()) <span class="keywordflow">return</span> a.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>() &lt; b.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// if still undecided, resolve by local index</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> a.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>() &lt; b.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>(); <span class="comment">// if still unresolved, it&#39;s a bug!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }                                         <span class="comment">// ClusterCrawlerAlg::SortByMultiplet()</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1fdc0953a17a9c5b1633d1b50b450cb5">  149</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1fdc0953a17a9c5b1633d1b50b450cb5">ClusterCrawlerAlg::ClearResults</a>()</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.clear();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.clear();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.clear();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.clear();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.clear();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  } <span class="comment">// ClusterCrawlerAlg::ClearResults()</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9dd41b9884a11ee5ffb1123e66ee2a08">  160</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9dd41b9884a11ee5ffb1123e66ee2a08">ClusterCrawlerAlg::CrawlInit</a>()</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = 0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = 0;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = 0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = 0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = 0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a> = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = 0.;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0.;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.clear();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1fdc0953a17a9c5b1633d1b50b450cb5">ClearResults</a>();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab59e0cef186198df36ecdbf47b723d46">  193</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab59e0cef186198df36ecdbf47b723d46">ClusterCrawlerAlg::ClusterInit</a>()</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.clear();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.clear();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.clear();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = -1.;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> = -1;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = -1.;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a851fffc7bc454064d90485206b407213">  208</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a851fffc7bc454064d90485206b407213">ClusterCrawlerAlg::RunCrawler</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clock_data,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; det_prop,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                std::vector&lt;recob::Hit&gt; <span class="keyword">const</span>&amp; srchits)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Run the ClusterCrawler algorithm - creating seed clusters and crawling upstream.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9dd41b9884a11ee5ffb1123e66ee2a08">CrawlInit</a>();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a> = srchits; <span class="comment">// plain copy of the sources; it&#39;s the base of our hit result</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() &lt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() &gt; UINT_MAX) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Too many hits for ClusterCrawler &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// don&#39;t do anything...</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// sort it as needed;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// that is, sorted by wire ID number,</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// then by start of the region of interest in time, then by the multiplet</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    std::sort(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.begin(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.end(), &amp;<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa659c4e326fc21a0be8331f5d09ed16b">SortByMultiplet</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.resize(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>.resize(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.size(); ++iht) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] = 0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[iht] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid : <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;IterateTPCIDs()) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;TPC(tpcid);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> = 0; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt; TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>(); ++<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.clear();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// define a code to ensure clusters are compared within the same plane</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">EncodeCTP</a>(tpcid.Cryostat, tpcid.TPC, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a> = tpcid.Cryostat;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a> = tpcid.TPC;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// fill the WireHitRange vector with first/last hit on each wire</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// dead wires and wires with no hits are flagged &lt; 0</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d9ae2c8c6032bfe26f87f1a8cdaa35c">GetHitRange</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">// sanity check</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.empty() || (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8168ec7a0de034676a5376c022e4a436">fFirstHit</a>].Channel();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// get the scale factor to convert dTick/dWire to dX/dU. This is used</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">// to make the kink and merging cuts</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordtype">float</span> wirePitch = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;WirePitch(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;View(channel));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordtype">float</span> tickToDist = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>(det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">Efield</a>(), det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">Temperature</a>());</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        tickToDist *= 1.e-3 * <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clock_data); <span class="comment">// 1e-3 is conversion of 1/us to 1/ns</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> = tickToDist / wirePitch;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// convert Large Angle Cluster crawling cut to a slope cut</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80c993ef6f49211a927f1f1f5392aea0">fLAClusAngleCut</a> &gt; 0)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a> = std::tan(3.142 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80c993ef6f49211a927f1f1f5392aea0">fLAClusAngleCut</a> / 180.) / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a60e232284fc5fc90b2a13e9b4b13732e">fMaxTime</a> = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a6b0f622c0a10cb71d47d2bc82f35c58b">NumberTimeSamples</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a19162b3f110b582827d10ba216ced7ab">fNumWires</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;Nwires(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// look for clusters</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> &gt; 0) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3026a548b92f9aae371143afffbb74d3">ClusterLoop</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      } <span class="comment">// plane</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a> &gt; 0) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Match vertices in 3 planes</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cd549e0b5347cab2715028d2d86bad0">VtxMatch</a>(clock_data, det_prop, tpcid);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6397333745b8677560d1d884f0446dd">Vtx3ClusterMatch</a>(clock_data, det_prop, tpcid);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9f691b9125975884fc57268dadbf43f0">fFindHammerClusters</a>) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5671c08bac3d9085b537dd69c3ec2f70">FindHammerClusters</a>(clock_data, det_prop);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// split clusters using 3D vertices</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac17d630dff6f8fe5a70627fa425abdcc">Vtx3ClusterSplit</a>(clock_data, det_prop, tpcid);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &gt;= 0) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Clustering done in TPC &quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">PrintClusters</a>();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    } <span class="comment">// for all tpcs</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// clean up</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.clear();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.clear();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.clear();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.clear();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// remove the hits that have become obsolete</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab0d474ea17eae621f3b58c0c10e1df09">RemoveObsoleteHits</a>();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  } <span class="comment">// RunCrawler</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  ////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3026a548b92f9aae371143afffbb74d3">  296</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3026a548b92f9aae371143afffbb74d3">ClusterCrawlerAlg::ClusterLoop</a>()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// looks for seed clusters in a plane and crawls along a trail of hits</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nHitsUsed = 0, iwire, jwire, kwire;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">bool</span> AllDone = <span class="keyword">false</span>, SigOK = <span class="keyword">false</span>, HitOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit, jhit;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> thispass = 0; thispass &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>; ++thispass) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> = thispass;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// look for a starting cluster that spans a block of wires</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> span = 3;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt; span) span = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">for</span> (iwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>; iwire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> + span; --iwire) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// skip bad wires or no hits on the wire</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[iwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keyword">auto</span> ifirsthit = (<span class="keywordtype">unsigned</span> int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[iwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keyword">auto</span> ilasthit = (<span class="keywordtype">unsigned</span> int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[iwire].<a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">for</span> (ihit = ifirsthit; ihit &lt; ilasthit; ++ihit) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordtype">bool</span> ClusterAdded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit];</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="comment">// skip used hits</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <span class="keywordflow">if</span> (ihit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ClusterLoop bad ihit &quot;</span> &lt;&lt; ihit &lt;&lt; <span class="stringliteral">&quot; fHits size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="comment">// skip used and obsolete hits</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[ihit] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <span class="comment">// skip narrow hits</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].PeakAmplitude() &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1f19cc2e366ab1fae56fc60994e15c01">fHitMinAmp</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="keywordflow">if</span> ((iwire + 1) &lt; span) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          jwire = iwire - span + 1;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Found debug hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(ihit) &lt;&lt; <span class="stringliteral">&quot; on pass&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="comment">// skip if good wire and no hit</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">// Found a dead jwire. Keep looking upstream until we find a good wire</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nmissed = 0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1 &amp;&amp; jwire &gt; 1 &amp;&amp; nmissed &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;              --jwire;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;              ++nmissed;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; new jwire &quot;</span> &lt;&lt; jwire &lt;&lt; <span class="stringliteral">&quot; dead? &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].first;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          } <span class="comment">// dead jwire</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="comment">// Find the hit on wire jwire that best matches a line between</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          <span class="comment">// a nearby vertex and hit ihit. No constraint if useHit &lt; 0</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> useHit = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <span class="keywordtype">bool</span> doConstrain = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab1a1548e9cfa55dfb1b94a56ac7b718b">VtxConstraint</a>(iwire, ihit, jwire, useHit, doConstrain);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jfirsthit = (<span class="keywordtype">unsigned</span> int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jlasthit = (<span class="keywordtype">unsigned</span> int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].<a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          <span class="keywordflow">if</span> (jfirsthit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1 || jfirsthit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">throw</span> art::Exception(art::errors::LogicError)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;ClusterLoop jwire &quot;</span> &lt;&lt; jwire &lt;&lt; <span class="stringliteral">&quot; bad firsthit &quot;</span> &lt;&lt; jfirsthit &lt;&lt; <span class="stringliteral">&quot; lasthit &quot;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              &lt;&lt; jlasthit &lt;&lt; <span class="stringliteral">&quot; fhits size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <span class="keywordflow">for</span> (jhit = jfirsthit; jhit &lt; jlasthit; ++jhit) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span> (jhit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              <span class="keywordflow">throw</span> art::Exception(art::errors::LogicError)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;ClusterLoop bad jhit &quot;</span> &lt;&lt; jhit &lt;&lt; <span class="stringliteral">&quot; firsthit &quot;</span> &lt;&lt; jfirsthit &lt;&lt; <span class="stringliteral">&quot; lasthit &quot;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                &lt;&lt; jlasthit &lt;&lt; <span class="stringliteral">&quot; fhits size&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">// Constraint?</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">if</span> (doConstrain &amp;&amp; jhit != useHit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; other_hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jhit];</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="comment">// skip used and obsolete hits</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jhit] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">// skip narrow hits</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jhit].PeakAmplitude() &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1f19cc2e366ab1fae56fc60994e15c01">fHitMinAmp</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="comment">// start a cluster with these two hits</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab59e0cef186198df36ecdbf47b723d46">ClusterInit</a>();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(ihit);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.push_back(0.);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.push_back(0);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.push_back(0); <span class="comment">// These will be defined if the cluster survives the cuts</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="comment">// enter the jhit</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(jhit);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.push_back(0.);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.push_back(0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.push_back(0);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">clLA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] = other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] = (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>()) / (iwire - jwire);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">// increase slope errors for large angle clusters</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1] = 0.2 * <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jhit].WireID().Wire;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = 0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="comment">// now look for hits to add on the intervening wires</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordtype">bool</span> clok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">for</span> (kwire = jwire + 1; kwire &lt; iwire; ++kwire) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;              <span class="comment">// ensure this cluster doesn&#39;t cross a vertex</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349">CrawlVtxChk</a>(kwire)) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                clok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;              }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aceda5036373484fcba4632e8426b436d">AddHit</a>(kwire, HitOK, SigOK);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; HitOK &quot;</span> &lt;&lt; HitOK &lt;&lt; <span class="stringliteral">&quot; clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                      &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt;&lt; <span class="stringliteral">&quot; ClusterHitsOK &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7e9e16248480f63fb64be2666252620">ClusterHitsOK</a>(-1);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;              <span class="comment">// No hit found</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;              <span class="keywordflow">if</span> (!HitOK) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;              <span class="comment">// This should be a really good chisq</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 2) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;              <span class="comment">// hit widths &amp; overlap not consistent</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7e9e16248480f63fb64be2666252620">ClusterHitsOK</a>(-1)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              clok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="comment">// drop it?</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span> (!clok) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; (<span class="keywordtype">int</span>)iwire == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> &amp;&amp;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                   <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>((<span class="keywordtype">int</span>)hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a>) &lt; 20);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;ADD &gt;&gt;&gt;&gt;&gt; Starting cluster with hits &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[1]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[2]) &lt;&lt; <span class="stringliteral">&quot; on pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">// save the cluster begin info</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = iwire;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="comment">// don&#39;t do a small angle crawl if the cluster slope is too large</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">// and Large Angle crawling is NOT requested on this pass</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af85b0b7218a61e4e8780f91bf9671a6a">fLACrawl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">// See if we are trying to start a cluster between a vertex</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">// and a cluster that is associated to that vertex. If so, skip it</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7036ba126203d462641e8301886e8089">CrawlVtxChk2</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = 0;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="comment">// Calculate the average width</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> = 0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">float</span> chg = 0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kk = 0; kk &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++kk) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[kk]].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[kk]].StartTick();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;              chg += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[kk]].Integral();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment">// decide whether to crawl a large angle cluster. Requirements are:</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">// 1) the user has set the LACluster angle cut &gt; 0, AND</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="comment">// 2) the cluster slope exceeds the cut</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">// Note that if condition 1 is met, normal cluster crawling is done</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">// only if the slope is less than the cut</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af85b0b7218a61e4e8780f91bf9671a6a">fLACrawl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a> &gt; 0) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              <span class="comment">// LA cluster crawling requested</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a>) { <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac186159f106e5376fab22d414df3dee8">LACrawlUS</a>(); }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a77b1ab63cd211ff234ba537e128de1c4">CrawlUS</a>();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;              } <span class="comment">// std::abs(clBeginSlp) &gt; fLAClusAngleCut</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;              <span class="comment">// allow clusters of any angle</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a77b1ab63cd211ff234ba537e128de1c4">CrawlUS</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            } <span class="comment">// fLAClusSlopeCut &gt; 0</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              <span class="comment">// it&#39;s long enough so save it</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]; <span class="comment">// save the slope at the end</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              <span class="comment">// store the cluster</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Failed to store cluster in plane &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;              ClusterAdded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;              nHitsUsed += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;              AllDone = (nHitsUsed == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size());</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;              <span class="comment">// abandon it</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ClusterLoop: dropped the cluster&quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span> (ClusterAdded || AllDone) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          } <span class="comment">// jhit</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <span class="keywordflow">if</span> (AllDone) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="comment">// ihit</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span> (AllDone) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      } <span class="comment">// iwire</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="comment">// try to merge clusters</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1366fdc2b8c67bd345efa80fba6d9372">fDoMerge</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a480b3863f5f2996e2fb56f5f5cd1250e">ChkMerge</a>();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="comment">// form 2D vertices</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6eb30d981381f693ca3a13a0c53aaa43">fFindVertices</a>[pass]) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af170134ded6d03cf31ef1a3b1006100d">FindVertices</a>();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (AllDone) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    } <span class="comment">// pass</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Kill Garbage clusters</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a82d67757957951b41909a2e2b0a70848">fKillGarbageClusters</a> &gt; 0 &amp;&amp; !<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.empty()) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a607df530372f45f854939e884f7be864">KillGarbageClusters</a>();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// Merge overlapping clusters</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a46ae3e73aa21823d7d5ad051e0cf1398">fMergeOverlapAngCut</a> &gt; 0) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaee600565a55502e2b16b2688b56b711">MergeOverlap</a>();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// Check the DS end of clusters</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a584d1502c5d50ffd31316434c89e7ed0">fChkClusterDS</a>) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae35fd8349af71e9cb254e542a815366a">ChkClusterDS</a>();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// split clusters using vertices</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7a523546da7313b6b9dbbda9602bf3c">fVtxClusterSplit</a>) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordtype">bool</span> didSomething = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006">VtxClusterSplit</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">// iterate once to handle the case where a cluster crosses two vertices</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">if</span> (didSomething) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006">VtxClusterSplit</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Look for 2D vertices with star topology - short, back-to-back clusters</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb26863a1a3a9c86dd5673819ad86341">fFindStarVertices</a>) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2c5805d63f1a55dd80165b0548a70e43">FindStarVertices</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Clustering done in plane &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">PrintClusters</a>();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">CheckHitClusterAssociations</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  } <span class="comment">// ClusterLoop()</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a607df530372f45f854939e884f7be864">  508</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a607df530372f45f854939e884f7be864">ClusterCrawlerAlg::KillGarbageClusters</a>()</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// Ghost Clusters:</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, jcl;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// This code preferentially selects icl clusters that were</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// reconstructed on an early pass (unless they were split)</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    std::vector&lt;float&gt; iHits, jHits;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indx;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// find the average hit width on the first pass and construct</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// a hit separation cut</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">float</span> sepcut = 0, iFrac, jFrac;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iLoIndx, jLoIndx, olapSize, iop, ii, jj;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nclose;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">float</span> iChg, jChg;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// vecrtor of clusters that will be killed after all is done</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    std::vector&lt;unsigned short&gt; killMe;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">bool</span> doKill;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1; ++icl) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="comment">// put the hits into a wire ordered vector</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      iHits.clear();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="comment">// initialize to a large positive value</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      iHits.resize(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir + 1, 1000);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      iChg = 0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> iht : <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">if</span> (indx &gt; iHits.size() - 1) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;KillGarbageClusters: icl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; Bad indx &quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                               &lt;&lt; indx &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; iHits.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        iHits[indx] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        iChg += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Integral();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span> (first) sepcut += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].RMS();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      } <span class="comment">// iht</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        sepcut /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size();</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment">// clusters are consider ghost candidates if many hits</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// are within sepcut of each other on the same wire</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        sepcut *= 10;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      } <span class="comment">// first</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">for</span> (jcl = icl + 1; jcl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++jcl) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">// ignore if there is no overlap</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// require similar angle</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginAng) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a82d67757957951b41909a2e2b0a70848">fKillGarbageClusters</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// find the overlap region</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <span class="comment">//  icl E-----------....</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          <span class="comment">//  jcl    E----------....</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <span class="comment">// olap    xxxxxxxxxx...</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          iLoIndx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          jLoIndx = 0;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">//  icl E-----------B</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">//  jcl    E------------B</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">// olap    xxxxxxxxxx</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            olapSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir + 1;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="comment">//  icl E-----------B</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">//  jcl    E-----B</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// olap    xxxxxxx</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            olapSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir + 1;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          } <span class="comment">// iBegin</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }   <span class="comment">// iEnd &lt; jEnd</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="comment">//  icl    E-----------....</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="comment">//  jcl E----------....</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          <span class="comment">// olap    xxxxxxxxxx...</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          iLoIndx = 0;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          jLoIndx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="comment">//  icl    E-----B</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">//  jcl E-----------B</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="comment">// olap    xxxxxxx</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            olapSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir + 1;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="comment">//  icl    E-----------B</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="comment">//  jcl E----------B</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">// olap    xxxxxxxxx</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            olapSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir + 1;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        } <span class="comment">// iEnd &gt; jEnd</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        jHits.clear();</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">// initialize to a large negative value</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        jHits.resize(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir + 1, -1000);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        jChg = 0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> jht : <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="keywordflow">if</span> (indx &gt; jHits.size() - 1) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;KillGarbageClusters: jcl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt;&lt; <span class="stringliteral">&quot; Bad indx &quot;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                 &lt;&lt; indx &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; jHits.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          jHits[indx] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          jChg += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].Integral();</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        } <span class="comment">// jht</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// count the number of close hits</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        nclose = 0;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">for</span> (iop = 0; iop &lt; olapSize; ++iop) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          ii = iLoIndx + iop;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="keywordflow">if</span> (ii &gt; iHits.size() - 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          jj = jLoIndx + iop;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          <span class="keywordflow">if</span> (jj &gt; jHits.size() - 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(iHits[ii] - jHits[jj]) &lt; sepcut) ++nclose;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        } <span class="comment">// iop</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        iFrac = (float)nclose / (<span class="keywordtype">float</span>)iHits.size();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        jFrac = (float)nclose / (<span class="keywordtype">float</span>)jHits.size();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (iFrac &lt; 0.5 &amp;&amp; jFrac &lt; 0.5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        doKill = (iFrac &lt; jFrac &amp;&amp; iChg &gt; jChg);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span> (doKill) killMe.push_back(jcl);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      } <span class="comment">// jcl</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">if</span> (killMe.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> icl : killMe) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// killing time</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode = 666;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    } <span class="comment">// icl</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  } <span class="comment">// KillGarbageClusters</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaee600565a55502e2b16b2688b56b711">  645</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaee600565a55502e2b16b2688b56b711">ClusterCrawlerAlg::MergeOverlap</a>()</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// Tries to merge overlapping clusters schematically shown below. The minimal condition is that both</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// clusters have a length of at least minLen wires with minOvrLap of the minLen wires in the overlap region</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">//      End  Begin</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// icl  ------</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// jcl     ------</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">//         End  Begin</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// This can occur when tracking cosmic rays through delta ray showers.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// If successfull the hits in clusters icl and jcl are merged into one long cluster</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// and a short cluster if there are sufficient remaining hits.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// This routine changes the &quot;pass&quot; variable to define cuts and should NOT be used inside any pass loops</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, jcl;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordtype">bool</span> chkprt = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> == 666);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (chkprt) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Inside MergeOverlap using clCTP &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> minLen = 6;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> minOvrLap = 2;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// use the loosest dTick cut which is probably the last one</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">float</span> maxDTick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>.size() - 1];</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> overlapSize, ii, indx, bWire, eWire;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht, jht;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">float</span> dang, prtime, dTick;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = chkprt &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() &lt; minLen) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keywordflow">for</span> (jcl = 0; jcl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++jcl) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">if</span> (icl == jcl) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits.size() &lt; minLen) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">// icl Begin is not far enough DS from the end of jcl</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir + minOvrLap) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="comment">// and it doesn&#39;t end within the wire boundaries of jcl</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir - minOvrLap) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="comment">// jcl End isn&#39;t far enough US from the end of icl</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir + minOvrLap) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        dang = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndAng);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MergeOverlap icl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; jcl ID &quot;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt;&lt; <span class="stringliteral">&quot; dang &quot;</span> &lt;&lt; dang;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">if</span> (dang &gt; 0.5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        overlapSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir + 1;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        eWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        bWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Candidate icl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir &lt;&lt; <span class="stringliteral">&quot; jcl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndWir &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir &lt;&lt; <span class="stringliteral">&quot; overlapSize &quot;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                &lt;&lt; overlapSize &lt;&lt; <span class="stringliteral">&quot; bWire &quot;</span> &lt;&lt; bWire &lt;&lt; <span class="stringliteral">&quot; eWire &quot;</span> &lt;&lt; eWire;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        iht = 0;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        jht = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt; eWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="comment">// require that the ends be similar in time</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        dTick = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndTim);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">if</span> (dTick &gt; maxDTick) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dTick icl iht time &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(iht) &lt;&lt; <span class="stringliteral">&quot; jcl EndTim &quot;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndTim &lt;&lt; <span class="stringliteral">&quot; dTick &quot;</span> &lt;&lt; dTick;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          jht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits.size() - ii - 1];</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt; bWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        dTick = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">if</span> (dTick &gt; maxDTick) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dTick jcl jht time &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(jht) &lt;&lt; <span class="stringliteral">&quot; icl BeginTim &quot;</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim &lt;&lt; <span class="stringliteral">&quot; dTick &quot;</span> &lt;&lt; dTick;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">// Calculate the line between iht and jht</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime()) /</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                   ((<span class="keywordtype">float</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2]);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="comment">// put the hits in the overlap region into a vector if they are close to the line</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        std::vector&lt;unsigned int&gt; oWireHits(overlapSize, INT_MAX);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        std::vector&lt;float&gt; delta(overlapSize, maxDTick);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt; eWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] * ((float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2]);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          dTick = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() - prtime);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - eWire;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          <span class="keywordflow">if</span> (dTick &gt; delta[indx]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          delta[indx] = dTick;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          oWireHits[indx] = iht;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// enter the second set of hits</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          jht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].tclhits.size() - ii - 1];</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt; bWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] * ((float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2]);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          dTick = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime() - prtime);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].WireID().Wire - eWire;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="keywordflow">if</span> (dTick &gt; delta[indx]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          delta[indx] = dTick;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          oWireHits[indx] = jht;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// stuff them into fcl2hits</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; oWireHits.size(); ++ii) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          <span class="keywordflow">if</span> (oWireHits[ii] == INT_MAX) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          iht = oWireHits[ii];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(iht);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(iht);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 0.5 * overlapSize) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 3) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        std::sort(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.begin(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.end(), <a class="code" href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">SortByLowHit</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Overlap size &quot;</span> &lt;&lt; overlapSize &lt;&lt; <span class="stringliteral">&quot; fit chisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; nhits &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">// save these hits so we can paste them back on fcl2hits when merging</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        std::vector&lt;unsigned int&gt; oHits = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">// prepare to make a new cluster</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">TmpGet</a>(jcl);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">// resize it</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jclNewSize;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">for</span> (jclNewSize = 0; jclNewSize &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++jclNewSize) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[jclNewSize];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt;= bWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        } <span class="comment">// jclNewSize</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;jcl old size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt;&lt; <span class="stringliteral">&quot; newSize &quot;</span> &lt;&lt; jclNewSize;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iiht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[jclNewSize - 1];</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;jcl old last wire &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; After resize last wire &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iiht].WireID().Wire;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.resize(jclNewSize);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="comment">// append the hits in the overlap region</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.insert(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.end(), oHits.begin(), oHits.end());</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// now paste in the icl hits that are US of the overlap region</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &gt;= eWire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.insert(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.end(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.begin() + ii, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.end());</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginSlp;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginSlpErr;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginAng;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginWir;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginTim;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginChg;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginChgNear;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">// End info from icl</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">clEndAng</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndAng;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndChg;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndChgNear;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].StopCode;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode + 500;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(jcl);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;          <span class="comment">// Merged cluster is fubar. Try to recover</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">RestoreObsoleteCluster</a>(icl);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">RestoreObsoleteCluster</a>(jcl);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">CheckHitClusterAssociations</a>();</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">CheckHitClusterAssociations</a>();</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].BeginVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginVtx;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].EndVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="comment">// after this point any failure should result in a jcl loop break</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MergeOverlap new long cluster ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ID</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; in clCTP &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">// icl cluster made obsolete so we must have done something</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      } <span class="comment">// jcl</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  } <span class="comment">// MergeOverlap()</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">  838</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">ClusterCrawlerAlg::MakeClusterObsolete</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">short</span>&amp; ID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (ID &lt;= 0) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Trying to make already-obsolete cluster obsolete ID = &quot;</span> &lt;&lt; ID;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">return</span>; <span class="comment">// already obsolete</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    ID = -ID; <span class="comment">// mark the cluster as obsolete</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// release the hits</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++iht)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[iht]] = 0;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  } <span class="comment">// ClusterCrawlerAlg::MakeClusterObsolete()</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">  855</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">ClusterCrawlerAlg::RestoreObsoleteCluster</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordtype">short</span>&amp; ID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (ID &gt; 0) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Trying to restore non-obsolete cluster ID = &quot;</span> &lt;&lt; ID;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    ID = -ID;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++iht)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[iht]] = ID;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  } <span class="comment">// RestoreObsoleteCluster()</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">  871</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">ClusterCrawlerAlg::FclTrimUS</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTrim)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// Trims nTrim hits off the UpStream end of the fcl2hits, etc vectors.</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">if</span> (nTrim == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span> (nTrim &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) nTrim = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">//    RestoreUnMergedClusterHits((short)nTrim);</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; nTrim; ++ii) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.pop_back();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.pop_back();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.pop_back();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.pop_back();</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  } <span class="comment">// FclTrim</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">  891</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">ClusterCrawlerAlg::CheckHitClusterAssociations</a>()</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// check hit - cluster associations</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.size()) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CHCA: Sizes wrong &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.size();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht, nErr = 0;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordtype">short</span> clID;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// check cluster -&gt; hit association</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      clID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CHCA: Bad tclhits index &quot;</span> &lt;&lt; iht &lt;&lt; <span class="stringliteral">&quot; fHits size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        } <span class="comment">// iht &gt; fHits.size() - 1</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] != clID) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CHCA: Bad cluster -&gt; hit association. clID &quot;</span> &lt;&lt; clID</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot; hit inClus &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] &lt;&lt; <span class="stringliteral">&quot; ProcCode &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot; CTP &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          ++nErr;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          <span class="keywordflow">if</span> (nErr &gt; 10) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// check hit -&gt; cluster association</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size(); ++iht) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      icl = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] - 1;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="comment">// see if the cluster is obsolete</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CHCA: Hit associated with an obsolete cluster. hit W:T &quot;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                           &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime()</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; tcl[icl].ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        ++nErr;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">if</span> (nErr &gt; 10) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="keywordflow">if</span> (std::find(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.begin(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.end(), iht) ==</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.end()) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CHCA: Bad hit -&gt; cluster association. hit index &quot;</span> &lt;&lt; iht &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                           &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime()</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; inClus &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht];</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        ++nErr;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">if</span> (nErr &gt; 10) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    } <span class="comment">// iht</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  } <span class="comment">// CheckHitClusterAssociations()</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00950"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab0d474ea17eae621f3b58c0c10e1df09">  950</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab0d474ea17eae621f3b58c0c10e1df09">ClusterCrawlerAlg::RemoveObsoleteHits</a>()</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> destHit = 0;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.size()) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RemoveObsoleteHits size mis-match &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                         &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.size();</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> srcHit = 0; srcHit &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size(); ++srcHit) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[srcHit] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">if</span> (srcHit != destHit) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[destHit] = std::move(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[srcHit]);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[destHit] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[srcHit];</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[destHit] &gt; 0) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          <span class="comment">// hit is in a cluster. Find it and change the index</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          icl = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[destHit] - 1;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          <span class="keyword">auto</span>&amp; hits = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          <span class="keyword">auto</span> iHitIndex = std::find(hits.begin(), hits.end(), srcHit);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <span class="keywordflow">if</span> (iHitIndex == hits.end()) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RemoveObsoleteHits: Hit #&quot;</span> &lt;&lt; srcHit</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; not found in cluster ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[destHit];</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            *iHitIndex = destHit; <span class="comment">// update the index</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        } <span class="comment">// inClus[destHit] &gt; 0</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      ++destHit;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    } <span class="comment">// srcHit</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.resize(destHit);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>.resize(destHit);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  } <span class="comment">// RemoveObsoleteHits()</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae35fd8349af71e9cb254e542a815366a">  991</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae35fd8349af71e9cb254e542a815366a">ClusterCrawlerAlg::ChkClusterDS</a>()</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// Try to extend clusters DS by a few wires.</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// DS hits may not have been  included in a cluster if they have high</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// multiplicity or high charge.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">// Ref ClusterLoop cuts for starting a seed cluster.</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == 3);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">// use the most generous kink angle cut</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">float</span> dThCut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> - 1];</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterDS clCTP &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> &lt;&lt; <span class="stringliteral">&quot; kink angle cut &quot;</span> &lt;&lt; dThCut;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordtype">bool</span> didMerge, skipit;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, ii, nhm, iv;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// first merge any hits on the DS end of clusters</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; tclsize; ++icl) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="comment">// ignore clusters that have a Begin vertex</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="comment">// and clusters near a vertex</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      skipit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim) &gt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        skipit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">if</span> (skipit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="comment">// check the first few hits</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      nhm = 0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; 3; ++ii) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii];</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Multiplicity() &gt; 1) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(iht, didMerge);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="keywordflow">if</span> (didMerge) ++nhm;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">if</span> (nhm &gt; 0) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="comment">// update the Begin parameters in-place</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(icl, 0, 3);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0];</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginAng = atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginChg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode += 5000;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterDS: Merge hits on cluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      } <span class="comment">// nhm &gt; 0</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordtype">float</span> thhits, prevth, hitrms, rmsrat;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">bool</span> ratOK;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    std::vector&lt;unsigned int&gt; dshits;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; tclsize; ++icl) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">// ignore clusters that have a Begin vertex</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">// and clusters near a vertex</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      skipit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">for</span> (iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir) &gt; 4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim) &gt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        skipit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">if</span> (skipit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="comment">// find the angle using the first 2 hits</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[1];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[0];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span> slp = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].PeakTime()) /</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].WireID().Wire);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      prevth = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * slp);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="comment">// move the &quot;origin&quot; to the first hit</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      ih0 = ih1;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].WireID().Wire;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      hitrms = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].RMS();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <span class="keywordtype">float</span> time0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].PeakTime();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordtype">float</span> prtime;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      dshits.clear();</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="comment">// follow DS a few wires. Stop if any encountered</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="comment">// hit is associated with a cluster</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; 4; ++ii) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        ++wire;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keywordflow">if</span> (wire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        prtime = time0 + slp;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterDS: Try to extend &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; to W:T &quot;</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                &lt;&lt; wire &lt;&lt; <span class="stringliteral">&quot; hitrms &quot;</span> &lt;&lt; hitrms &lt;&lt; <span class="stringliteral">&quot; prevth &quot;</span> &lt;&lt; prevth</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; prtime &quot;</span> &lt;&lt; (int)prtime;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// stop if no hits on this wire</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].first;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].second;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordtype">bool</span> hitAdded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">for</span> (ih1 = firsthit; ih1 &lt; lasthit; ++ih1) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[ih1] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          <span class="keywordflow">if</span> (prtime &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].PeakTimeMinusRMS(5)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <span class="keywordflow">if</span> (prtime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].PeakTimePlusRMS(5)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">float</span> slp = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].PeakTime()) /</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                            (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih0].WireID().Wire);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          thhits = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * slp);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; theta &quot;</span> &lt;&lt; thhits &lt;&lt; <span class="stringliteral">&quot; prevth &quot;</span> &lt;&lt; prevth &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                  &lt;&lt; dThCut;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(thhits - prevth) &gt; dThCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          <span class="comment">// make a hit rms cut for small angle clusters</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          ratOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slp) &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a>) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            rmsrat = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].RMS() / hitrms;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            ratOK = rmsrat &gt; 0.3 &amp;&amp; rmsrat &lt; 3;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="comment">// merge the hits</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordtype">bool</span> didMerge;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(ih1, didMerge);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; rmsrat &quot;</span> &lt;&lt; rmsrat &lt;&lt; <span class="stringliteral">&quot; OK? &quot;</span> &lt;&lt; ratOK;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;          <span class="comment">// require small angle and not wildly different width compared</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          <span class="comment">// to the first hit in the cluster</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <span class="comment">// TODO handle hit multiplets here</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <span class="keywordflow">if</span> (ratOK) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            dshits.push_back(ih1);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            hitAdded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            prevth = thhits;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            ih0 = ih1;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Add hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                    &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ih1].PeakTime() &lt;&lt; <span class="stringliteral">&quot; rmsrat &quot;</span> &lt;&lt; rmsrat;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        } <span class="comment">// ih1</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">// stop looking if no hit was added on this wire</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span> (!hitAdded) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="comment">// Found hits not associated with a different cluster</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">if</span> (dshits.size() &gt; 0) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="comment">// put the tcl cluster into the working vectors</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">TmpGet</a>(icl);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="comment">// clobber the hits</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="comment">// sort the DS hits</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">if</span> (dshits.size() &gt; 1) std::sort(dshits.begin(), dshits.end(), <a class="code" href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">SortByLowHit</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="comment">// stuff them into fcl2hits</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a> = dshits;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">// Append the existing hits</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          <span class="comment">// un-assign the hits so that TmpStore will re-assign them</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] = 0;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(iht);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> += 5000;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> - 1;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="comment">// declare the old one obsolete</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// add the new one</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterDS TmpStore failed while extending cluster ID &quot;</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                             &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> newcl = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) { mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Store &quot;</span> &lt;&lt; newcl; }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[newcl].BeginVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[newcl].EndVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      } <span class="comment">// dshits.size() &gt; 0</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }     <span class="comment">// ChkClusterDS</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7036ba126203d462641e8301886e8089"> 1174</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7036ba126203d462641e8301886e8089">ClusterCrawlerAlg::CrawlVtxChk2</a>()</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// returns true if the (presumably short) cluster under construction</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// resides between a vertex and another cluster that is associated with</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// that vertex</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordtype">float</span> wire0 = (0.5 + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[iht]].WireID().Wire);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordtype">float</span> dt;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordtype">float</span> thclus = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">if</span> (wire0 &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">if</span> (wire0 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire + 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      dt = clpar[0] + (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - wire0) * clpar[1] - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dt) &gt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="comment">// cluster points to an US vertex. See if the angle is similar to</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="comment">// cluster associated with this vertex</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx != iv) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndAng - thclus) &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  } <span class="comment">// CrawlVtxChk2()</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349"> 1210</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349">ClusterCrawlerAlg::CrawlVtxChk</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kwire)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// returns true if the cluster is near a vertex on wire kwire</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordtype">float</span> wire0 = (0.5 + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[iht]].WireID().Wire);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordtype">float</span> prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + (kwire - wire0) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(0.5 + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire) != kwire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(prtime - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time) &lt; 10) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  } <span class="comment">// CrawlVtxChk()</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab1a1548e9cfa55dfb1b94a56ac7b718b"> 1228</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab1a1548e9cfa55dfb1b94a56ac7b718b">ClusterCrawlerAlg::VtxConstraint</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iwire,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jwire,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; useHit,</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                   <span class="keywordtype">bool</span>&amp; doConstrain)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">// checks hits on wire jwire to see if one is on a line between a US vertex</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">// and the hit ihit on wire iwire. If one is found, doConstrain is set true</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// and the hit index is returned.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    doConstrain = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// no vertices made yet on the first pass</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// skip if vertices were not requested to be made on the previous pass</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6eb30d981381f693ca3a13a0c53aaa43">fFindVertices</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> - 1]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (jwire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.size() - 1) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxConstraint fed bad jwire &quot;</span> &lt;&lt; jwire &lt;&lt; <span class="stringliteral">&quot; WireHitRange size &quot;</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                         &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.size();</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jfirsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].first;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jlasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[jwire].second;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">// vertex must be US of the cluster</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &gt; jwire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="comment">// but not too far US</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &lt; jwire - 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit];</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time - hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>()) / (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - iwire);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2] = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordtype">float</span> prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] * (jwire - iwire);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jhit = jfirsthit; jhit &lt; jlasthit; ++jhit) {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jhit] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d8/d23/CookedFrameSource_8cxx.html#a7c7963b26e5294dacb6d0a28006b069c">tdiff</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jhit].TimeDistanceAsRMS(prtime));</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">if</span> (tdiff &lt; 2.5) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          useHit = jhit;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          doConstrain = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      } <span class="comment">// jhit</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }   <span class="comment">// iv</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  }     <span class="comment">// VtxConstraint()</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3612f55c9fa44a650af049b7e96a647a"> 1278</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3612f55c9fa44a650af049b7e96a647a">ClusterCrawlerAlg::RefineVertexClusters</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv)</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">// Try to attach or remove hits on the ends of vertex clusters</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    std::vector&lt;unsigned short&gt; begClusters;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    std::vector&lt;short&gt; begdW;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    std::vector&lt;unsigned short&gt; endClusters;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    std::vector&lt;short&gt; enddW;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vWire = (<span class="keywordtype">unsigned</span> int)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire + 0.5);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vWireErr = (<span class="keywordtype">unsigned</span> int)(2 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vWireLo = vWire - vWireErr;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vWireHi = vWire + vWireErr;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, ii;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordtype">short</span> dW;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordtype">bool</span> needsWork = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordtype">short</span> maxdW = -100;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordtype">short</span> mindW = 100;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == iv) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        dW = vWire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">if</span> (dW &gt; maxdW) maxdW = dW;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span> (dW &lt; mindW) mindW = dW;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dW) &gt; 1) needsWork = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="comment">// TODO: Check dTime also?</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        begClusters.push_back(icl);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        begdW.push_back(dW);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == iv) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        dW = vWire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">if</span> (dW &gt; maxdW) maxdW = dW;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> (dW &lt; mindW) mindW = dW;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dW) &gt; 1) needsWork = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        endClusters.push_back(icl);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        enddW.push_back(dW);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    } <span class="comment">// icl</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RefineVertexClusters: vertex &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; needsWork &quot;</span> &lt;&lt; needsWork</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; mindW &quot;</span> &lt;&lt; mindW &lt;&lt; <span class="stringliteral">&quot; maxdW &quot;</span> &lt;&lt; maxdW &lt;&lt; <span class="stringliteral">&quot; vWireErr &quot;</span> &lt;&lt; vWireErr;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">if</span> (!needsWork) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// See if we can move the vertex within errors to reconcile the differences</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">// without altering the clusters</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(mindW) &lt; vWireErr) &amp;&amp; ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(maxdW) &lt; vWireErr) &amp;&amp;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(maxdW - mindW) &lt; 2) {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Move vtx wire &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire -= (float)(maxdW + mindW) / 2;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="comment">// TODO: Fix the vertex time here if necessary</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Fixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="comment">// try to attach other clusters</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0db0ab91b47900a8b8d9d9378523451c">VertexCluster</a>(iv);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="comment">// Check the vertex End clusters</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> newSize;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; endClusters.size(); ++ii) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      icl = endClusters[ii];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; endCluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; dW &quot;</span> &lt;&lt; enddW[ii] &lt;&lt; <span class="stringliteral">&quot; vWire &quot;</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                              &lt;&lt; vWire;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir &lt; vWire) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="comment">// vertex is DS of the cluster end -&gt; remove hits</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">TmpGet</a>(icl);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        newSize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> hiter = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.rbegin(); hiter &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.rend(); ++hiter) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[*hiter].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt; vWire) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          --newSize;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <span class="comment">// release the hits</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> hiter = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.begin(); hiter &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.end(); ++hiter)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[*hiter] = 0;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="comment">// shorten the cluster</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.resize(newSize);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="comment">// fit</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> += 700;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="comment">// store it</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>();</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].EndVtx = iv;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="comment">// update the vertex association</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; modified cluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ID;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      } <span class="comment">// tcl[icl].EndWir &lt; vWire</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir &gt; vWire) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RefineVertexClusters: Write some EndVtx code&quot;</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      } <span class="comment">//</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    }   <span class="comment">// ii endClusters</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">if</span> (begClusters.size() &gt; 0)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RefineVertexClusters: Write some BeginVtx code&quot;</span>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">if</span> (mindW &lt; 0 &amp;&amp; maxdW &gt; 0) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="comment">// vertex wire is in between the ends of the clusters</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="comment">// inspect the hits on both clusters near the vertex. The vertex should probably be on the hit</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="comment">// with the highest charge</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordtype">int</span> vtxHit = -1;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> clsBigChg = 0;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordtype">float</span> bigChg = 0;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// check the begClusters</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; begClusters.size(); ++ii) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        icl = begClusters[ii];</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++iht) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          ihit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[iht];</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral() &gt; bigChg) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            bigChg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral();</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            vtxHit = ihit;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            clsBigChg = icl;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt; vWireLo) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        } <span class="comment">// iht</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      }   <span class="comment">// ii</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="comment">// now check the endClusters</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; endClusters.size(); ++ii) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        icl = endClusters[ii];</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++iht) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          ihit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() - 1 - iht];</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral() &gt; bigChg) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            bigChg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            vtxHit = ihit;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            clsBigChg = icl;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt; vWireHi) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        } <span class="comment">// iht</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      }   <span class="comment">// ii</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">if</span> (vtxHit &gt; 0) {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; moving vertex location to hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[vtxHit].WireID().Wire</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[vtxHit].PeakTime() &lt;&lt; <span class="stringliteral">&quot; on cluster &quot;</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[clsBigChg].ID;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[vtxHit].WireID().Wire;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[vtxHit].PeakTime();</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Fixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      } <span class="comment">// vtxHit &gt; 0</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    }   <span class="comment">// mindW &lt; 0 &amp;&amp; maxdW &gt; 0</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  } <span class="comment">// RefineVertexClusters</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006"> 1432</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006">ClusterCrawlerAlg::VtxClusterSplit</a>()</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// split clusters that cross vertices</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &gt;= 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> == 5555);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxClusterSplit &quot;</span>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> (tclsize &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordtype">bool</span> didit;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordtype">bool</span> didSomething = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; tclsize; ++icl) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="comment">// ignore short clusters</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() &lt; 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <span class="comment">// check vertices</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      didit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="comment">// abandoned vertex?</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="comment">// already assigned to this vertex?</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == ivx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == ivx) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="comment">// vertex wire in-between the cluster ends?</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="comment">// vertex time in-between the cluster ends?</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordtype">float</span> hiTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim &gt; hiTime) hiTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time &gt; hiTime + 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordtype">float</span> loTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim &lt; loTime) loTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time &lt; loTime - 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="comment">// find the hit on the cluster that is closest to the vertex on the</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">// DS side</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Chk cluster ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; with vertex &quot;</span> &lt;&lt; ivx;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordtype">short</span> ihvx = -99;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="comment">// nSplit is the index of the hit in the cluster where we will</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="comment">// split it if all requirements are met</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSplit = 0;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nLop = 0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() - 1; ii &gt; 0; --ii) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          ++nLop;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            nSplit = ii;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Split cluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; at wire &quot;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                                    &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot; nSplit &quot;</span> &lt;&lt; nSplit;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            ihvx = iht;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="comment">// found the wire. Now make a rough time cut</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <span class="keywordflow">if</span> (ihvx &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihvx].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time) &gt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="comment">// check the angle between the crossing cluster icl and the</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="comment">// clusters that comprise the vertex.</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="comment">// First decide which end of cluster icl to use to define the angle</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keywordtype">float</span> iclAng = 0.;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">if</span> (nSplit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() / 2) { iclAng = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndAng; }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;          iclAng = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginAng;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; iclAng &quot;</span> &lt;&lt; iclAng;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="comment">// check angle wrt the the vertex clusters</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <span class="keywordtype">bool</span> angOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jcl = 0; jcl &lt; tclsize; ++jcl) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginVtx == ivx) {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].BeginAng - iclAng) &gt; 0.4) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;              <span class="comment">// large angle difference. Set the flag</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;              angOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;          } <span class="comment">// tcl[jcl].BeginVtx == ivx</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndVtx == ivx) {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndAng - iclAng) &gt; 0.4) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;              <span class="comment">// large angle difference. Set the flag</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;              angOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;          } <span class="comment">// tcl[jcl].EndVtx == ivx</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        }   <span class="comment">// jcl</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// time to split or chop</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">if</span> (angOK) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Split/Chop at pos &quot;</span> &lt;&lt; nLop;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          <span class="keywordflow">if</span> (nLop &lt; 3) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="comment">// lop off hits at the US end</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <span class="comment">// Put the cluster in the local arrays</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">TmpGet</a>(icl);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; nLop; ++ii) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] = 0;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.pop_back();</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="comment">// store it</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> += 1000;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="comment">// declare this cluster obsolete</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="comment">// store the new one</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> newcl = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[newcl].BeginVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[newcl].EndVtx = ivx;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="comment">// split the cluster into two</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="comment">// correct the split position</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            ++nSplit;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(icl, nSplit, ivx)) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ProcCode += 1000;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 2].ProcCode += 1000;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;          }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;          didit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;          didSomething = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        } <span class="comment">// angOK</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">if</span> (didit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      } <span class="comment">// ivx</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }   <span class="comment">// icl</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">return</span> didSomething;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  } <span class="comment">// VtxClusterSplit()</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15"> 1570</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">ClusterCrawlerAlg::MergeHits</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> theHit, <span class="keywordtype">bool</span>&amp; didMerge)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// Merge all unused separate hits in the multiplet of which</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// theHit is a member into one hit (= theHit).</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="comment">// Mark the merged hits other than theHit obsolete.</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="comment">// Hits in the multiplet that are associated with an existing cluster are</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// not affected.</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// Hit multiplicity is reworked (including all the hits in the multiplet).</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// Used hits have the multiplicity and index corrected too; the local</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// index reflects the peak time.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// Note that theHit may or may not be marked free (usually, it is not)</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    didMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">if</span> (theHit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[theHit];</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">// don&#39;t bother trying to merge an already merged hit</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[theHit].GoodnessOfFit() == 6666) {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MergeHits Trying to merge already merged hit &quot;</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                              &lt;&lt; hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>().<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                              &lt;&lt; (int)hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() &lt;&lt; <span class="stringliteral">&quot; Multiplicity &quot;</span> &lt;&lt; hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>()</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; theHit &quot;</span> &lt;&lt; theHit;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// don&#39;t merge if it isn&#39;t available</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[theHit]) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// number of hits in this hit multiplet</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    std::pair&lt;size_t, size_t&gt; MultipletRange = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc">FindHitMultiplet</a>(theHit);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">// ensure that this is a high multiplicity hit:</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">if</span> (MultipletRange.second &lt;= MultipletRange.first) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// do a quick check to see how many hits are available to be merged</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nAvailable = 0;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInClus = 0;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jht = MultipletRange.first; jht &lt; MultipletRange.second; ++jht) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">if</span> (jht == theHit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].GoodnessOfFit() == 6666) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] != 0) {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        ++nInClus;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      ++nAvailable;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    } <span class="comment">// jht</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">if</span> (nAvailable == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// don&#39;t merge if any hit is used</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span> (nInClus &gt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">// calculate the Charge normalization factor using the hit information</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// instead of passing CCHitFinder ChgNorms all the way down here</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordtype">float</span> chgNorm = 2.507 * hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5a6d25fb947ac7eed319c06b5cb19327">PeakAmplitude</a>() * hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>() / hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>();</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">short</span> loTime = 9999;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordtype">short</span> hiTime = 0;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nGaus = 1;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordtype">float</span> hitSep;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// number of hits that are close to theHit</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nclose = 0;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// find the time range for the hit multiplet</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jht = MultipletRange.first; jht &lt; MultipletRange.second; ++jht) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; other_hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht];</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="comment">// error checking</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordflow">if</span> ((other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>() != hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>()) || (other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>() != hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>())) {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="keywordflow">if</span> (other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>() != hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>()) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="comment">// hit is not used by another cluster</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="keywordtype">short</span> arg = (short)(other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a14e714d1c89866d097b3e62425f4ec16">PeakTimeMinusRMS</a>(3));</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="keywordflow">if</span> (arg &lt; loTime) loTime = arg;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      arg = (short)(other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a69b6837d4637da51e31fd75798b8a1d4">PeakTimePlusRMS</a>(3));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">if</span> (arg &gt; hiTime) hiTime = arg;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">if</span> (jht != theHit) ++nGaus;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      hitSep = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>()) / other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>();</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">if</span> (jht != theHit &amp;&amp; hitSep &lt; 3) ++nclose;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    } <span class="comment">// jht</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">// all hits in the multiplet other than this one used?</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (nGaus &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">// the hits in this multiplet will have this multiplicity from now on</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> NewMultiplicity = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>() + 1 - nGaus;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (loTime &lt; 0) loTime = 0;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    ++hiTime;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">// define a signal shape, fill it with zeros</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    std::vector&lt;double&gt; signal(hiTime - loTime, 0.);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">// now add the Gaussians for each hit</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordtype">double</span> chgsum = 0.;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jht = MultipletRange.first; jht &lt; MultipletRange.second; ++jht) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; other_hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht];</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordflow">if</span> (jht != theHit) {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">// hit used in another cluster</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="comment">// declare this hit obsolete</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] = -1;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      } <span class="comment">// jht != theHit</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="comment">// add up the charge</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      chgsum += other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>();</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> time = loTime; time &lt; hiTime; ++time) {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = time - loTime;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="keywordtype">double</span> arg = (other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - (double)time) / other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>();</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        signal[indx] += other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5a6d25fb947ac7eed319c06b5cb19327">PeakAmplitude</a>() * <a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5 * arg * arg);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      } <span class="comment">// time</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    }   <span class="comment">// jj</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">// find the average weighted time</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">double</span> sigsum = 0.;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordtype">double</span> sigsumt = 0.;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> time = loTime; time &lt; hiTime; ++time) {</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      sigsum += signal[time - loTime];</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      sigsumt += signal[time - loTime] * time;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">if</span> (sigsum == 0.) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="comment">//      mf::LogError(&quot;CC&quot;)&lt;&lt;&quot;MergeHits: bad sum&quot;;</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordtype">double</span> aveTime = sigsumt / sigsum;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// find the RMS</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    sigsumt = 0.;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> time = loTime; time &lt; hiTime; ++time) {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordtype">double</span> dtime = time - aveTime;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      sigsumt += signal[time - loTime] * dtime * dtime;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> RMS = std::sqrt(sigsumt / sigsum);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="comment">// find the amplitude from the integrated charge and the RMS</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> amplitude = chgsum * chgNorm / (2.507 * RMS);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// modify the hit &quot;in place&quot; (actually completely overwrite it...)</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">// TODO a lot of these quantities need revamp!!</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[theHit] = <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5722fa298fffc3ac441e8a07d9a6048b">Channel</a>(),</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>(),</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5f21b9b8e520187343b515134e058fdb">EndTick</a>(),</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                               aveTime, <span class="comment">// peak_time</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">SigmaPeakTime</a>(),</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                               RMS,       <span class="comment">// rms</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                               amplitude, <span class="comment">// peak_amplitude</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab6cb532b93758fa2366c4b1218a94f73">SigmaPeakAmplitude</a>(),</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a92803e026e5b6eb6cdd1edfb384c54d5">SummedADC</a>(),</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                               chgsum, <span class="comment">// hit_integral</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a6dcd1e087338846c0fe7600afe6d031c">SigmaIntegral</a>(),</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                               NewMultiplicity, <span class="comment">// multiplicity</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                               0,               <span class="comment">// local index</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                               6666,            <span class="comment">// GoodnessOfFit (flag for merged hit)</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ae09e4534734533595663f0dc6901f30b">DegreesOfFreedom</a>(),</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>(),</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a19a017039c62b9be286cd55944686ec4">SignalType</a>(),</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a04d966c0d44b4209bea5d3da76446a5e">FixMultipletLocalIndices</a>(MultipletRange.first, MultipletRange.second);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    didMerge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  } <span class="comment">// MergeHits()</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a04d966c0d44b4209bea5d3da76446a5e"> 1730</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a04d966c0d44b4209bea5d3da76446a5e">ClusterCrawlerAlg::FixMultipletLocalIndices</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>,</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                              <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>,</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                              <span class="keywordtype">short</span> <span class="keywordtype">int</span> multiplicity <span class="comment">/* = -1 */</span>)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// Resets multiplicity and local index of the hits in the range.</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="comment">// All hits are assumed to be in the same multiplet.</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">// All hits that are not obsolete are given a multiplicity equal to the</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">// number of non-obsolete hits in the multiplet, and the local index is</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// assigned as an increasing number starting from 0 with the first</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">// non-obsolete hit on.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// first pass: determine the actual number of hits in the multiplet</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span> (multiplicity &lt; 0) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      multiplicity = 0;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iHit = begin; iHit &lt; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>; ++iHit) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iHit] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        ++multiplicity;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      } <span class="comment">// for</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }   <span class="comment">// if no valid multiplicity is given</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// second pass: assign the correct multiplicity</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordtype">short</span> <span class="keywordtype">int</span> local_index = 0;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iHit = begin; iHit &lt; <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>; ++iHit) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iHit] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="comment">// copy everything but overwrite the local index and multiplicity</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="comment">// TODO use a write wrapper!</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iHit];</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iHit] = <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5722fa298fffc3ac441e8a07d9a6048b">Channel</a>(),</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>(),</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5f21b9b8e520187343b515134e058fdb">EndTick</a>(),</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>(),</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">SigmaPeakTime</a>(),</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>(),</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a5a6d25fb947ac7eed319c06b5cb19327">PeakAmplitude</a>(),</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab6cb532b93758fa2366c4b1218a94f73">SigmaPeakAmplitude</a>(),</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a92803e026e5b6eb6cdd1edfb384c54d5">SummedADC</a>(),</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>(),</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a6dcd1e087338846c0fe7600afe6d031c">SigmaIntegral</a>(),</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                               multiplicity, <span class="comment">// multiplicity</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                               local_index,  <span class="comment">// local index</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#aa5ed1389f3ba40946c6f78a53a1a3c4e">GoodnessOfFit</a>(),</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ae09e4534734533595663f0dc6901f30b">DegreesOfFreedom</a>(),</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">View</a>(),</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a19a017039c62b9be286cd55944686ec4">SignalType</a>(),</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                               hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      ++local_index;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  } <span class="comment">// FixMultipletLocalIndices()</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2c5805d63f1a55dd80165b0548a70e43"> 1786</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2c5805d63f1a55dd80165b0548a70e43">ClusterCrawlerAlg::FindStarVertices</a>()</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// Make 2D vertices with a star topology with short back-to-back</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// clusters. Vertices must reside on the US end of the longest</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// cluster, so vertex finding uses the End information only.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// This routine is called after all passes are completed</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// in the current CTP</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">// This code has some issues...</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> &lt; 0);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FindStarVertices&quot;</span>;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">PrintClusters</a>();</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> vtxSizeIn = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordtype">float</span> fvw = 0.;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordtype">float</span> fvt = 0.;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordtype">float</span> dsl = 0, dth = 0;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keywordtype">float</span> es1 = 0, es2 = 0;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordtype">float</span> eth1 = 0, eth2 = 0;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordtype">float</span> bt1 = 0, bt2 = 0;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordtype">float</span> et1 = 0, et2 = 0;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordtype">float</span> bw1 = 0, bw2 = 0;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordtype">float</span> ew1 = 0, ew2 = 0;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordtype">float</span> lotime = 0, hitime = 0, nwirecut = 0;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1 = 0; it1 &lt; tclsize - 1; ++it1) {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <span class="comment">// ignore obsolete clusters</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="comment">// long dead-straight cluster?</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &gt; 100) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        dth = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndAng;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dth) &lt; 0.1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      es1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndSlp;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      eth1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndAng;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      ew1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      et1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      bw1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      bt1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it2 = it1 + 1; it2 &lt; tclsize; ++it2) {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="comment">// long dead-straight cluster?</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &gt; 100) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;          dth = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndAng;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dth) &lt; 0.05) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        es2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndSlp;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        eth2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndAng;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        ew2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        et2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        bw2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        bt2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="comment">// require angle difference</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(eth1 - eth2);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keywordflow">if</span> (dth &lt; 0.3) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        dsl = es2 - es1;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        fvw = (et1 - ew1 * es1 - et2 + ew2 * es2) / dsl;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="comment">// intersection within the wire boundaries</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordflow">if</span> (fvw &lt; ew1 || fvw &gt; bw1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">if</span> (fvw &lt; ew2 || fvw &gt; bw2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Chk clusters &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; topo5 vtx wire &quot;</span> &lt;&lt; fvw;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="comment">// ensure that the intersection is close to the US end of the longer</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <span class="comment">// cluster if it is more than 20 hits long</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size()) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &gt; 20) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            nwirecut = 0.5 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size();</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordflow">if</span> ((fvw - ew1) &gt; nwirecut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;          }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &gt; 20) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            nwirecut = 0.5 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size();</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="keywordflow">if</span> ((fvw - ew2) &gt; nwirecut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;          }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        fvt = et1 + (fvw - ew1) * es1;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="comment">// and time boundaries</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        lotime = 9999;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordflow">if</span> (et1 &lt; lotime) lotime = et1;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">if</span> (bt1 &lt; lotime) lotime = bt1;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">if</span> (et2 &lt; lotime) lotime = et2;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordflow">if</span> (bt2 &lt; lotime) lotime = bt2;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        hitime = 0;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keywordflow">if</span> (et1 &gt; hitime) hitime = et1;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <span class="keywordflow">if</span> (bt1 &gt; hitime) hitime = bt1;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span> (et2 &gt; hitime) hitime = et2;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">if</span> (bt2 &gt; hitime) hitime = bt2;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        <span class="keywordflow">if</span> (fvt &lt; lotime || fvt &gt; hitime) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; vertex time &quot;</span> &lt;&lt; fvt &lt;&lt; <span class="stringliteral">&quot; lotime &quot;</span> &lt;&lt; lotime &lt;&lt; <span class="stringliteral">&quot; hitime &quot;</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                &lt;&lt; hitime;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vw = (0.5 + fvw);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="comment">// ensure that the vertex is near a hit on both clusters</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos1 = 0;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits[ii]].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt;= vw) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<span class="keywordtype">int</span>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits[ii]].PeakTime() - fvt)) &lt; 10) pos1 = ii;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;          }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        <span class="comment">// vertex is not near a hit on cluster 1</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">if</span> (pos1 == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pos2 = 0;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits[ii]].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt;= vw) {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<span class="keywordtype">int</span>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits[ii]].PeakTime() - fvt)) &lt; 10) pos2 = ii;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;          }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="comment">// vertex is not near a hit on cluster 2</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordflow">if</span> (pos2 == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="comment">// ensure we aren&#39;t near an existing vertex</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(fvw - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire) &lt; 2 &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(fvt - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time) &lt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        }</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="comment">// make a new vertex</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">VtxStore</a> newvx;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = fvw;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#abd3aec0c3e72090d5ec11d217593aac8">WireErr</a> = 1;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = fvt;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a71337b437c20a1f4c51f972a10774e68">TimeErr</a> = 1;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = 5;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">Fixed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(newvx);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; new vertex &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; cluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; split pos &quot;</span> &lt;&lt; pos1;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(it1, pos1, ivx)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ProcCode += 1000;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 2].ProcCode += 1000;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; new vertex &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; cluster &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; split pos &quot;</span> &lt;&lt; pos2;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(it2, pos2, ivx)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ProcCode += 1000;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 2].ProcCode += 1000;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(ivx);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      } <span class="comment">// it2</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    }   <span class="comment">// it1</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() &gt; vtxSizeIn) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="comment">// try to split other clusters</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006">VtxClusterSplit</a>();</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <span class="comment">// try to attach other clusters to it</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0db0ab91b47900a8b8d9d9378523451c">VertexCluster</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a72dd32faa77190429a9256e9d19528ff">FitAllVtx</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    } <span class="comment">// new vertex</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Vertices &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size();</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;vtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; wire &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &lt;&lt; <span class="stringliteral">&quot; time &quot;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                              &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time &lt;&lt; <span class="stringliteral">&quot; NClusters &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> &lt;&lt; <span class="stringliteral">&quot; topo &quot;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Topo;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">PrintClusters</a>();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  } <span class="comment">// FindStarVertices()</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0db0ab91b47900a8b8d9d9378523451c"> 1962</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0db0ab91b47900a8b8d9d9378523451c">ClusterCrawlerAlg::VertexCluster</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// try to attach clusters to the specified vertex</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordtype">short</span> dwb, dwe, dtb, dte;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordtype">bool</span> sigOK;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      dwb = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      dtb = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      dwe = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      dte = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="keywordtype">float</span> drb = dwb * dwb + dtb * dtb;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordtype">float</span> dre = dwe * dwe + dte * dte;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordtype">bool</span> bCloser = (drb &lt; dre);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="comment">// ignore clusters in showers</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="keywordflow">if</span> (bCloser) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginChgNear &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb1313fc4ff7dcd4fcadc51726995370">fChgNearCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndChgNear &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb1313fc4ff7dcd4fcadc51726995370">fChgNearCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      }</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VertexCluster: Try icl ID &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt;&lt; <span class="stringliteral">&quot; w vtx &quot;</span> &lt;&lt; iv</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; dwb &quot;</span> &lt;&lt; dwb &lt;&lt; <span class="stringliteral">&quot; dwe &quot;</span> &lt;&lt; dwe &lt;&lt; <span class="stringliteral">&quot; drb &quot;</span> &lt;&lt; drb &lt;&lt; <span class="stringliteral">&quot; dre &quot;</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                              &lt;&lt; dre &lt;&lt; <span class="stringliteral">&quot; Begin closer? &quot;</span> &lt;&lt; bCloser;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &lt; 0 &amp;&amp; bCloser &amp;&amp; dwb &gt; -3 &amp;&amp; dwb &lt; 3 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx != iv) {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        sigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Attach cluster Begin to vtx? &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; sigOK &quot;</span> &lt;&lt; sigOK;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordflow">if</span> (sigOK) {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; check ClusterVertexChi &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 0, iv);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 0, iv) &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a>) {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="comment">// do a fit and check the vertex error</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = iv;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a>) {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = -99;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;          } <span class="comment">// good DoCA</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        }   <span class="comment">// sigOK</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      }     <span class="comment">// check BEGIN</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx &lt; 0 &amp;&amp; !bCloser &amp;&amp; dwe &gt; -3 &amp;&amp; dwe &lt; 3 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx != iv) {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        sigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Attach cluster End to vtx? &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; sigOK &quot;</span> &lt;&lt; sigOK;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">if</span> (sigOK) {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; check ClusterVertexChi &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 1, iv);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 1, iv) &lt; 3) {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            <span class="comment">// do a fit and check the vertex error</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = iv;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a>) {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = -99;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;          } <span class="comment">// good DoCA</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        }   <span class="comment">// sigOK</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      }     <span class="comment">// check END</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    }       <span class="comment">// icl</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  }         <span class="comment">// VertexCluster</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a72dd32faa77190429a9256e9d19528ff"> 2039</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a72dd32faa77190429a9256e9d19528ff">ClusterCrawlerAlg::FitAllVtx</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8f5750cc57138e6d09d7d746d7452e05">CTP_t</a> inCTP)</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != inCTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  } <span class="comment">// FitAllVtx</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af170134ded6d03cf31ef1a3b1006100d"> 2051</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af170134ded6d03cf31ef1a3b1006100d">ClusterCrawlerAlg::FindVertices</a>()</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  {</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="comment">// try to make 2D vertices</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// sort clusters starting with the longest</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    std::vector&lt;CluLen&gt; clulens;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    CluLen clulen;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &gt;= 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      clulen.index = icl;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      clulen.length = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size();</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      clulens.push_back(clulen);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>(clulens)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    std::sort(clulens.begin(), clulens.end(), <a class="code" href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">greaterThan</a>);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <span class="keywordtype">float</span> nwires = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a19162b3f110b582827d10ba216ced7ab">fNumWires</a>;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordtype">float</span> maxtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a60e232284fc5fc90b2a13e9b4b13732e">fMaxTime</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> vtxSizeIn = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size();</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (short)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> &lt; 0);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FindVertices plane &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt;&lt; <span class="stringliteral">&quot; pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">PrintClusters</a>();</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    }</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordtype">float</span> es1 = 0, eth1 = 0, ew1 = 0, et1 = 0;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="keywordtype">float</span> bs1 = 0, bth1 = 0, bw1 = 0, bt1 = 0;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordtype">float</span> es2 = 0, eth2 = 0, ew2 = 0, et2 = 0;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordtype">float</span> bs2 = 0, bth2 = 0, bw2 = 0, bt2 = 0;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="keywordtype">float</span> dth = 0, dsl = 0, fvw = 0, fvt = 0;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordtype">float</span> angcut = 0;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vw = 0, pass1, pass2, ii1, it1, ii2, it2;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordtype">bool</span> SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">for</span> (ii1 = 0; ii1 &lt; clulens.size() - 1; ++ii1) {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      it1 = clulens[ii1].index;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      es1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndSlp;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      eth1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndAng;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      ew1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      et1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      bs1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginSlp;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      bth1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginAng;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      bw1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      bt1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      pass1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode / 10);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="keywordflow">for</span> (ii2 = ii1 + 1; ii2 &lt; clulens.size(); ++ii2) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        it2 = clulens[ii2].index;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <span class="comment">// try to attach cluster to existing vertices at either end</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf5328a94c57ece07426a7de1b9ce06b">ClusterVertex</a>(it2);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="comment">// ignore if both clusters are short</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &lt; 5 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &lt; 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        es2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndSlp;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        eth2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndAng;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        ew2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        et2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        bs2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginSlp;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        bth2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginAng;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        bw2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        bt2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        pass2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode / 10);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        <span class="keywordflow">if</span> (pass1 &lt; pass2) { angcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass2]; }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;          angcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass1];</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="comment">// topo 1: check for vtx US of the ends of both clusters</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        dth = fabs(eth1 - eth2);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx &lt; 0 &amp;&amp; dth &gt; 0.1) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;          dsl = es2 - es1;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;          <span class="comment">// find vertex wire and vertex time in float precision (fvw, fvt)</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;          fvw = (et1 - ew1 * es1 - et2 + ew2 * es2) / dsl;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;          <span class="comment">// vertex wire in the detector?</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;          <span class="keywordflow">if</span> (fvw &gt; 0. &amp;&amp; fvw &lt; nwires) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="comment">// require vtx in the range of wires with hits AND</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            vw = (0.5 + fvw);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            <span class="comment">// vtx US of both clusters AND</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            <span class="comment">// vtx not too far US of both clusters</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="keywordflow">if</span> (vw &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> - 1 &amp;&amp; fvw &lt;= ew1 + 3 &amp;&amp; fvw &lt;= ew2 + 3 &amp;&amp; fvw &gt; (ew1 - 10) &amp;&amp;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                fvw &gt; (ew2 - 10)) {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;              fvt = et1 + (fvw - ew1) * es1;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Chk clusters topo1 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot;  vtx wire &quot;</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                  &lt;&lt; vw &lt;&lt; <span class="stringliteral">&quot; time &quot;</span> &lt;&lt; (int)fvt &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;              <span class="keywordflow">if</span> (fvt &gt; 0 &amp;&amp; fvt &lt; maxtime) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                <span class="comment">// Vertex wire US of cluster ends and time in the detector.</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                <span class="comment">// Check for signal at the vertex position and adjust the vertex by 1 wire</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                <span class="comment">// if necessary</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, vw, fvt);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <span class="keywordflow">if</span> (!SigOK) {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                  fvw += 1.;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                  vw = (0.5 + fvw);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                  SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, vw, fvt);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                }</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                <span class="comment">// Check this against existing vertices and update</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                <span class="keywordflow">if</span> (SigOK) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">ChkVertex</a>(fvw, fvt, it1, it2, 1);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;              } <span class="comment">// fvt in detector</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            }   <span class="comment">// vw topo 1 check</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;          }     <span class="comment">// fvw in detector</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        }       <span class="comment">// topo 1</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                <span class="comment">// topo 2: check for vtx US of it1 and DS of it2</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(eth1 - bth2);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx &lt; 0 &amp;&amp; dth &gt; angcut) {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;          dsl = bs2 - es1;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;          <span class="keywordflow">if</span> (fabs(ew1 - bw2) &lt; 3 &amp;&amp; fabs(et1 - bt2) &lt; 500) { fvw = 0.5 * (ew1 + bw2); }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            fvw = (et1 - ew1 * es1 - bt2 + bw2 * bs2) / dsl;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;          }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;          <span class="keywordflow">if</span> (fvw &gt; 0 &amp;&amp; fvw &lt; nwires) {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <span class="comment">// vertex wire in the detector</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            vw = (0.5 + fvw);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            <span class="comment">// require vtx US of cluster 1 End AND</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <span class="comment">//         vtx DS of cluster 2 Begin</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">if</span> (fvw &lt;= ew1 + 2 &amp;&amp; fvw &gt;= bw2 - 2) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;              fvt = et1 + (vw - ew1) * es1;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;              fvt += bt2 + (vw - bw2) * bs2;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;              fvt /= 2;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Chk clusters topo2 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot; vtx wire &quot;</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                  &lt;&lt; vw &lt;&lt; <span class="stringliteral">&quot; time &quot;</span> &lt;&lt; (int)fvt &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;              <span class="keywordflow">if</span> (fvt &gt; 0. &amp;&amp; fvt &lt; maxtime) {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">ChkVertex</a>(fvw, fvt, it1, it2, 2);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;              } <span class="comment">// fvt in detector</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;            }   <span class="comment">// vw topo 2 check</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;          }     <span class="comment">// fvw in detector</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        }       <span class="comment">// topo 2</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                <span class="comment">// topo 3: check for vtx DS of it1 and US of it2</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bth1 - eth2);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx &lt; 0 &amp;&amp; dth &gt; angcut) {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;          dsl = bs1 - es2;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;          <span class="keywordflow">if</span> (fabs(bw1 - ew2) &lt; 3 &amp;&amp; fabs(bt1 - et2) &lt; 500) { fvw = 0.5 * (bw1 + ew2); }</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            fvw = (et2 - ew2 * es2 - bt1 + bw1 * bs1) / dsl;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;          }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;          <span class="keywordflow">if</span> (fvw &gt; 0 &amp;&amp; fvw &lt; nwires) {</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            vw = (0.5 + fvw);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="comment">// require vtx US of cluster 2 Begin AND</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="comment">//         vtx DS of cluster 1 End</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="keywordflow">if</span> (fvw &lt;= ew2 + 2 &amp;&amp; fvw &gt;= bw1 - 2) {</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;              fvt = et2 + (fvw - ew2) * es2;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;              fvt += bt1 + (fvw - bw1) * es1;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;              fvt /= 2;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Chk clusters topo3 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot; vtx wire &quot;</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                  &lt;&lt; vw &lt;&lt; <span class="stringliteral">&quot; time &quot;</span> &lt;&lt; (int)fvt &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;              <span class="keywordflow">if</span> (fvt &gt; 0. &amp;&amp; fvt &lt; maxtime) {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">ChkVertex</a>(fvw, fvt, it1, it2, 3);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;              } <span class="comment">// fvt in detector</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            }   <span class="comment">// vw topo 3 check</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;          }     <span class="comment">// fvw in detector</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        }       <span class="comment">// topo 3</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                <span class="comment">// topo 4: check for vtx DS of it1 and DS of it2</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bth1 - bth2);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx &lt; 0 &amp;&amp; dth &gt; 0.1) {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;          dsl = bs2 - bs1;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;          <span class="comment">// find vertex wire and vertex time in float precision (fvw, fvt)</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;          <span class="comment">// convert to integer if within the detector (vw, vt)</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;          fvw = (bt1 - bw1 * bs1 - bt2 + bw2 * bs2) / dsl;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Chk clusters topo4 &quot;</span> &lt;&lt; bw1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)bt1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; bw2</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)bt2 &lt;&lt; <span class="stringliteral">&quot; fvw &quot;</span> &lt;&lt; fvw &lt;&lt; <span class="stringliteral">&quot; nwires &quot;</span> &lt;&lt; nwires;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;          <span class="keywordflow">if</span> (fvw &gt; 0 &amp;&amp; fvw &lt; nwires) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <span class="comment">// vertex wire in the detector</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            vw = (0.5 + fvw);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            <span class="comment">// require vtx in the range of wires with hits AND vtx DS of both clusters AND</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            <span class="comment">// vtx not too far DS of both clusters</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <span class="keywordtype">float</span> dwcut = 10;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &lt; 2 * dwcut) dwcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() / 2;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &lt; 2 * dwcut) dwcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() / 2;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            <span class="keywordflow">if</span> (fvw &lt;= fLastWire + 1 &amp;&amp; fvw &gt;= bw1 - dwcut &amp;&amp; fvw &lt;= bw1 + dwcut &amp;&amp;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                fvw &gt;= bw2 - dwcut &amp;&amp; fvw &lt;= bw1 + dwcut) {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;              fvt = bt1 + (fvw - bw1) * bs1;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; vtx wire &quot;</span> &lt;&lt; vw &lt;&lt; <span class="stringliteral">&quot; time &quot;</span> &lt;&lt; fvt &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; dwcut &quot;</span> &lt;&lt; dwcut;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;              <span class="keywordflow">if</span> (fvt &gt; 0. &amp;&amp; fvt &lt; maxtime) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                <span class="comment">// vertex wire US of cluster ends and time in the detector</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                <span class="comment">// Check for signal at the vertex position and adjust the vertex by 1 wire</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                <span class="comment">// if necessary</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, vw, fvt);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                <span class="keywordflow">if</span> (!SigOK) {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                  fvw -= 1.;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                  vw = (0.5 + fvw);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                  SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, vw, fvt);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                <span class="comment">// Check this against existing vertices and update</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                <span class="keywordflow">if</span> (SigOK) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">ChkVertex</a>(fvw, fvt, it1, it2, 4);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;              } <span class="comment">// fvt in detector</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            }   <span class="comment">// vw topo 4 check</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;          }     <span class="comment">// fvw in detector</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        }       <span class="comment">// topo4</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      }         <span class="comment">// it2</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    }           <span class="comment">// it1</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="comment">// Fix vertices where both ends of a cluster are assigned to the</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="comment">// same vertex. This can happen with short clusters</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it = 0; it &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++it) {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx &gt; -1 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        <span class="keywordtype">float</span> dwir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        <span class="keywordtype">float</span> dtim = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginTim - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordtype">float</span> rbeg = dwir * dwir + dtim * dtim;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        dwir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        dtim = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndTim - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <span class="keywordtype">float</span> rend = dwir * dwir + dtim * dtim;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordflow">if</span> (rend &lt; rbeg) { <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx = -99; }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx = -99;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      } <span class="comment">// tcl[it].BeginVtx == tcl[it].EndVtx</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    }   <span class="comment">// it</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() &gt; vtxSizeIn) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a72dd32faa77190429a9256e9d19528ff">FitAllVtx</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="comment">// &quot;delete&quot; any vertices that have only one cluster</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 1) {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].NClusters = 0;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == ivx) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = -99;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;          }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == ivx) {</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = -99;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;          }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        } <span class="comment">// icl</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      }   <span class="comment">// vtx[ivx].NClusters == 1</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    }     <span class="comment">// ivx</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  } <span class="comment">// FindVertices()</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf5328a94c57ece07426a7de1b9ce06b"> 2296</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf5328a94c57ece07426a7de1b9ce06b">ClusterCrawlerAlg::ClusterVertex</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it)</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="comment">// try to attach cluster it to an existing vertex</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv, jv;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordtype">short</span> dwib, dwjb, dwie, dwje;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordtype">bool</span> matchEnd, matchBegin;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordflow">for</span> (iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="comment">// ignore vertices in the wrong cryostat/TPC/Plane</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="comment">// ignore deleted vertices</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="comment">// determine which end to match - begin or end. Handle short tracks</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      matchEnd = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      matchBegin = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].tclhits.size() &lt; 6) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <span class="comment">// See which end is closer to this vertex vs other vertices</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        dwib = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="keywordflow">if</span> (dwib &gt; 2) dwib = 2;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        dwie = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="keywordflow">if</span> (dwie &gt; 2) dwie = 2;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        dwjb = 999;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        dwje = 999;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">for</span> (jv = 0; jv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++jv) {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          <span class="keywordflow">if</span> (iv == jv) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginTim) &lt; 50) {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir) &lt; dwjb)</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;              dwjb = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;          } <span class="comment">// std::abs(vtx[jv].Time - tcl[it].BeginTim) &lt; 50</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Time - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndTim) &lt; 50) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir) &lt; dwje)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;              dwje = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jv].Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          } <span class="comment">// std::abs(vtx[jv].Time - tcl[it].EndTim) &lt; 50</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        }   <span class="comment">// jv</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        matchEnd = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx != iv &amp;&amp; dwie &lt; 3 &amp;&amp; dwie &lt; dwje &amp;&amp; dwie &lt; dwib;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        matchBegin = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx != iv &amp;&amp; dwib &lt; 3 &amp;&amp; dwib &lt; dwjb &amp;&amp; dwib &lt; dwie;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        matchEnd = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &lt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir + 2;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        matchBegin = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx &lt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir - 2;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="keywordflow">if</span> (matchEnd) {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Match End chi &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(it, 1, iv) &lt;&lt; <span class="stringliteral">&quot; to vtx &quot;</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                                &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; signalOK &quot;</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                                     <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndTim);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(it, 1, iv) &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> &amp;&amp;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndTim)) {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;          <span class="comment">// good match</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx = iv;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;          <span class="comment">// re-fit it</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Add End &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].ID &lt;&lt; <span class="stringliteral">&quot; to vtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; NClusters &quot;</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].NClusters;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Bad fit. ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt;&lt; <span class="stringliteral">&quot; Undo it&quot;</span>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndVtx = -99;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        } <span class="comment">// tChi &lt; 3</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      }   <span class="comment">// matchEnd</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <span class="keywordflow">if</span> (matchBegin) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Match Begin chi &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(it, 0, iv) &lt;&lt; <span class="stringliteral">&quot; to vtx &quot;</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                                &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; signalOK &quot;</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire,</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                             <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time,</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                             <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir,</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                                             <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginTim);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(it, 0, iv) &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> &amp;&amp;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginTim)) {</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;          <span class="comment">// good match</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx = iv;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;          <span class="comment">// re-fit it</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Add Begin &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].ID &lt;&lt; <span class="stringliteral">&quot; to vtx &quot;</span> &lt;&lt; iv</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; NClusters &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].NClusters;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">fVertex2DCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Bad fit. ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt;&lt; <span class="stringliteral">&quot; Undo it&quot;</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginVtx = -99;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        } <span class="comment">// tChi &lt; 3</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      }   <span class="comment">// matchBegin</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    }     <span class="comment">// iv</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  }       <span class="comment">// ClusterVertex()</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c"> 2394</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">ClusterCrawlerAlg::ChkVertex</a>(<span class="keywordtype">float</span> fvw,</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                               <span class="keywordtype">float</span> fvt,</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                               <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1,</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                               <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it2,</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                               <span class="keywordtype">short</span> topo)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="comment">// Checks the vertex (vw, fvt) against the existing set of vertices.</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="comment">// If there a match, clusters it1 and/or it2 are associated with it</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">// if there is signal between the existing vertex and the start of</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="comment">// the cluster. The topo flag indicates the type of vertex that was</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">// found: 1 = US of it1 &amp;&amp; US of it2, 2 = US of it1 &amp;&amp; DS of it2,</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">// 3 = DS of it1 &amp;&amp; US of it2, 4 = DS of it1 and DS of it2.</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="comment">// didit is set true if a cluster is attached to a (new or old) vertex</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; ChkVertex &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim &lt;&lt; <span class="stringliteral">&quot; - &quot;</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                            &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim &lt;&lt; <span class="stringliteral">&quot; topo &quot;</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                            &lt;&lt; topo &lt;&lt; <span class="stringliteral">&quot; fvw &quot;</span> &lt;&lt; fvw &lt;&lt; <span class="stringliteral">&quot; fvt &quot;</span> &lt;&lt; fvt;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vw = (<span class="keywordtype">unsigned</span> int)(0.5 + fvw);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">// don&#39;t make vertices using short tracks that are close to</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">// long straight clusters. These are most likely due to numerous</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="comment">// short delta ray clusters</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size() &lt; 10 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &lt; 10) {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it = 0; it &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++it) {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        <span class="keywordflow">if</span> (it == it1 || it == it2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].tclhits.size() &lt; 100) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndAng) &gt; 0.1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <span class="comment">// don&#39;t reject because it is near the end of a long cluster</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        <span class="keywordflow">if</span> (vw &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].EndWir + 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        <span class="keywordflow">if</span> (vw &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].BeginWir - 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it].tclhits[ii];</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt;= vw) {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() - fvt) &lt; 60) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;          } <span class="comment">// fHits[iht].WireID().Wire &lt;= vWire</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        }   <span class="comment">// ii</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      }     <span class="comment">// it</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    }</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="comment">// check vertex and clusters for proximity to existing vertices</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFitOK = 0;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="comment">// make this a really loose cut since the errors on the prospective vertex aren&#39;t known yet</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad8a34f66ba1eb44620e288dc1ca2e3fe">PointVertexChi</a>(fvw, fvt, iv) &gt; 300) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; vtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; PointVertexChi &quot;</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad8a34f66ba1eb44620e288dc1ca2e3fe">PointVertexChi</a>(fvw, fvt, iv);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <span class="comment">// got a match. Check the appropriate cluster end and attach</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="keywordflow">if</span> ((topo == 1 || topo == 2) &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx &lt; 0) {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim)) {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;          <span class="comment">// try to fit</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx = iv;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; FitVtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; 5) { ++nFitOK; }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx = -99;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;          } <span class="comment">// check fit</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        }   <span class="comment">// ChkSignal</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((topo == 3 || topo == 4) &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx &lt; 0) {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim)) {</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx = iv;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; FitVtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; 5) { ++nFitOK; }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx = -99;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;          } <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        }   <span class="comment">// ChkSignal</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      }     <span class="comment">// cluster it2</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="keywordflow">if</span> ((topo == 1 || topo == 3) &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx &lt; 0) {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim)) {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx = iv;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; FitVtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; 5) { ++nFitOK; }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx = -99;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;          } <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        }   <span class="comment">// ChkSignal</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      }</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((topo == 2 || topo == 4) &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx &lt; 0) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim)) {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx = iv;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; FitVtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; 5) { ++nFitOK; }</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx = -99;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;          } <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        }   <span class="comment">// ChkSignal</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      }     <span class="comment">// cluster it2</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordflow">if</span> (nFitOK &gt; 0) {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Attached &quot;</span> &lt;&lt; nFitOK &lt;&lt; <span class="stringliteral">&quot; clusters to vertex &quot;</span> &lt;&lt; iv;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      }</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    } <span class="comment">// iv</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="comment">// no match to existing vertices. Ensure that there is a wire signal between</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="comment">// the vertex and the appropriate ends of the clusters</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordtype">bool</span> SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">if</span> (topo == 1 || topo == 2) { SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim); }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">if</span> (!SigOK) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="keywordflow">if</span> (topo == 1 || topo == 3) { SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim); }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(vw, fvt, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    }</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keywordflow">if</span> (!SigOK) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">VtxStore</a> newvx;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = vw;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = fvt;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = topo;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    newvx.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">Fixed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(newvx);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="keywordflow">if</span> (topo == 1 || topo == 2) {</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx &gt;= 0) {</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx = iv;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx &gt;= 0) {</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      }</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx = iv;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    }</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    <span class="keywordflow">if</span> (topo == 1 || topo == 3) {</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx &gt;= 0) {</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx = iv;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    }</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx &gt;= 0) {</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx = iv;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    }</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="comment">// fit it</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(iv);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// reject it if the fit is bad</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt; 5 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr &lt; 20) {</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; New vtx &quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; in plane &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt;&lt; <span class="stringliteral">&quot; topo &quot;</span> &lt;&lt; topo</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; cls &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span> &lt;&lt; (int)vw</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)fvt &lt;&lt; <span class="stringliteral">&quot; NClusters &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].NClusters;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      <span class="comment">// Try to refine the cluster hits and vertex position</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5b4ccf0120f3097f2aa305a7459f225c">fRefineVertexClusters</a>) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3612f55c9fa44a650af049b7e96a647a">RefineVertexClusters</a>(iv);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    }</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Bad vtx fit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF &lt;&lt; <span class="stringliteral">&quot; wire err &quot;</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt;&lt; <span class="stringliteral">&quot; TimeErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="comment">// clobber the vertex and references to it</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx == iv) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx = -99;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx == iv) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx = -99;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx == iv) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx = -99;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx == iv) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx = -99;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    } <span class="comment">// bad fit</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  } <span class="comment">// ChkVertex()</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd"> 2595</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ClusterCrawlerAlg::ChkSignal</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jht)</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">if</span> (jht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="keywordtype">float</span> time1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime();</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].WireID().Wire;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordtype">float</span> time2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime();</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(wire1, time1, wire2, time2);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  } <span class="comment">// ChkSignal</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4c44e3e6f6af9286728d63f5dfc4344d"> 2608</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ClusterCrawlerAlg::ChkSignal</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire1, <span class="keywordtype">float</span> time1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire2, <span class="keywordtype">float</span> time2)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="comment">// returns  true if there is a signal on the line between</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="comment">// (wire1, time1) and (wire2, time2).</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="comment">// Be sure to set time1 &lt; time2 if you are checking for signals on a single wire</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">// Gaussian amplitude in bins of size 0.15</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> gausAmp[20] = {1,    0.99, 0.96, 0.90, 0.84, 0.75, 0.67, 0.58, 0.49, 0.40,</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                               0.32, 0.26, 0.20, 0.15, 0.11, 0.08, 0.06, 0.04, 0.03, 0.02};</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="comment">// return true if fMinAmp is set ignore wire signal checking in this plane</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af057de7165e772a5695df4a064cabe3c">fMinAmp</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>] &lt;= 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="comment">// get the begin and end right</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wireb = wire1;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keywordtype">float</span> timeb = time1;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wiree = wire2;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordtype">float</span> timee = time2;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="comment">// swap them?</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">if</span> (wiree &gt; wireb) {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      wireb = wire2;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      timeb = time2;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      wiree = wire1;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      timee = time1;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="keywordflow">if</span> (wiree &lt; fFirstWire || wiree &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="keywordflow">if</span> (wireb &lt; fFirstWire || wireb &gt; fLastWire) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordtype">int</span> wire0 = wiree;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <span class="comment">// checking a single wire?</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    <span class="keywordtype">float</span> slope = 0;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="keywordtype">bool</span> oneWire = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordtype">float</span> prTime, prTimeLo = 0, prTimeHi = 0;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">if</span> (wireb == wiree) {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      oneWire = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="keywordflow">if</span> (time1 &lt; time2) {</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        prTimeLo = time1;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        prTimeHi = time2;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        prTimeLo = time2;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        prTimeHi = time1;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      }</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    }</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      slope = (timeb - timee) / (wireb - wiree);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    }</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">bin</a>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nmissed = 0;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire = wiree; wire &lt; wireb + 1; ++wire) {</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="keywordflow">if</span> (oneWire) { prTime = (prTimeLo + prTimeHi) / 2; }</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        prTime = timee + (wire - wire0) * slope;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <span class="comment">// skip dead wires</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="comment">// no hits on this wire</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2) ++nmissed;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].first;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].second;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <span class="keywordtype">float</span> amp = 0;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> khit = firsthit; khit &lt; lasthit; ++khit) {</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordflow">if</span> (oneWire) {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;          <span class="comment">// TODO: This sometimes doesn&#39;t work with overlapping hits</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;          <span class="comment">// A not totally satisfactory solution</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;          <span class="keywordflow">if</span> (prTime &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;          <span class="keywordflow">if</span> (prTime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        }</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;          <span class="comment">// skip checking if we are far away from prTime on the positive side</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() - prTime &gt; 500) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;          bin = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() - prTime) / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].RMS();</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;          bin /= 0.15;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;          <span class="keywordflow">if</span> (bin &gt; 19) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;          <span class="keywordflow">if</span> (bin &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;          <span class="comment">// add amplitude from all hits</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;          amp += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakAmplitude() * gausAmp[<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">bin</a>];</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        }</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      } <span class="comment">// khit</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="keywordflow">if</span> (amp &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af057de7165e772a5695df4a064cabe3c">fMinAmp</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>]) ++nmissed;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    } <span class="comment">// wire</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="keywordflow">if</span> (nmissed &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  } <span class="comment">// ChkSignal()</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398"> 2698</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">ClusterCrawlerAlg::SplitCluster</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx)</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  {</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="comment">// split cluster icl into two clusters</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="comment">// declare icl obsolete</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(icl);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, iclnew;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">if</span> (pos &gt; 2) {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="comment">// Have enough hits to make a cluster at the Begin end</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="comment">// Create the first cluster (DS) using the Begin info</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginAng;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginChg;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 5;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.clear();</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.clear();</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.clear();</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; pos; ++ii) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(iht);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="comment">// determine the pass in which this cluster was created</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode / 10);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> - 1) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> - 1;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <span class="comment">// fit the end hits</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">clEndAng</a> = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a>);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="comment">// find the charge at the end</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) {</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">RestoreObsoleteCluster</a>(icl);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      }</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="comment">// associate the End with the supplied vertex</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      iclnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[iclnew].EndVtx = ivx;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[iclnew].BeginVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;SplitCluster made cluster &quot;</span> &lt;&lt; iclnew &lt;&lt; <span class="stringliteral">&quot; attached to Begin vtx &quot;</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                              &lt;&lt; ivx;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    } <span class="comment">// pos &gt; 2</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">if</span> (pos &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() - 3) {</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      <span class="comment">// have enough hits to make a cluster at the End</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <span class="comment">// now create the second cluster (US)</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">clEndAng</a> = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a>);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndChg;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 5;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.clear();</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.clear();</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.clear();</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <span class="keywordtype">bool</span> didFit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      <span class="keywordflow">for</span> (ii = pos; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[ii];</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[iht] != 0) {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">RestoreObsoleteCluster</a>(icl);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(iht);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <span class="comment">// define the Begin parameters</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">fMaxHitsFit</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;          didFit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] + 1) {</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;          didFit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <span class="comment">// do a fit using all hits if one wasn&#39;t done</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="keywordflow">if</span> (!didFit) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      }</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="comment">// clobber the previously stored cluster</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1);</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">RestoreObsoleteCluster</a>(icl);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <span class="comment">// associate the End with the supplied vertex</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      iclnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[iclnew].BeginVtx = ivx;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[iclnew].EndVtx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;SplitCluster made cluster &quot;</span> &lt;&lt; iclnew &lt;&lt; <span class="stringliteral">&quot; attached to End vtx &quot;</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                              &lt;&lt; ivx;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    }</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  } <span class="comment">// SplitCluster()</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a480b3863f5f2996e2fb56f5f5cd1250e"> 2816</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a480b3863f5f2996e2fb56f5f5cd1250e">ClusterCrawlerAlg::ChkMerge</a>()</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  {</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="comment">// Try to merge clusters. Clusters that have been subsumed in other</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="comment">// clusters, i.e. no longer valid, have ID &lt; 0</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="comment">// The size of the ClusterStore vector will increase while merging</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="comment">// is on-going so the upper limit on it1 is fixed tcl.size() - 1</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <span class="comment">// before merging starts</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (short)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> &lt; 0);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkMerge on pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1, it2, nh1, pass1, pass2;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordtype">float</span> bs1, bth1, bt1, bc1, es1, eth1, et1, ec1;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordtype">float</span> bs2, bth2, bt2, bc2, es2, eth2, et2, ec2;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="keywordtype">int</span> bw1, ew1, bw2, ew2, ndead;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordtype">float</span> dth, dw, angcut, chgrat, chgcut, dtim, timecut, bigslp;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <span class="keywordtype">bool</span> bothLong, NoVtx;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordtype">int</span> skipcut, tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    <span class="keywordtype">int</span> maxOverlap = 3;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keywordflow">for</span> (it1 = 0; it1 &lt; tclsize - 1; ++it1) {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="comment">// ignore already merged clusters</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      bs1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginSlp;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      <span class="comment">// convert slope to angle</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      bth1 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * bs1);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <span class="comment">// more compact notation for begin/end, wire/time/chg/slp/theta, 1/2</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      bw1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      bt1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      bc1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginChg;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      es1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndSlp;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      eth1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndAng;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      ew1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      et1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      ec1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndChg;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      nh1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size();</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      pass1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode / 10);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <span class="keywordflow">if</span> (pass1 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>) pass1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      <span class="keywordflow">for</span> (it2 = it1 + 1; it2 &lt; tclsize; ++it2) {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <span class="comment">// ignore already merged clusters</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        <span class="comment">// only merge if they are in the right cryostat/TPC/plane</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <span class="comment">// Don&#39;t bother if these clusters, if merged, would fail the</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <span class="comment">// cluster hit fraction cut</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a295421507d307d627b03ec9156673e">ChkMergedClusterHitFrac</a>(it1, it2)) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        bs2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginSlp;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        bth2 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * bs2);</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        bw2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        bt2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        bc2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginChg;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        es2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndSlp;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        eth2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndAng;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        ew2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        et2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        ec2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndChg;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        pass2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode / 10);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordflow">if</span> (pass2 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>) pass2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="comment">// use the more promiscuous pass for cuts</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        angcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass1];</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass2] &gt; angcut) angcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass2];</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        skipcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[pass1];</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[pass2] &gt; skipcut) skipcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[pass2];</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        chgcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">fMergeChgCut</a>[pass1];</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">fMergeChgCut</a>[pass2] &gt; chgcut) chgcut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">fMergeChgCut</a>[pass2];</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <span class="comment">// tweak the cuts for long straight tracks</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        bothLong = (nh1 &gt; 100 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size() &gt; 100);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="comment">// look for US and DS broken clusters w similar angle.</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        <span class="comment">// US cluster 2 merge with DS cluster 1?</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <span class="comment">// This is the most likely occurrence given the order in which</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="comment">// clusters are created so put it first.</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bth2 - eth1);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        ndead = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">DeadWireCount</a>(bw2, ew1);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        dw = ew1 - bw2 - ndead;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <span class="comment">// require no vertex between</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        NoVtx = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndVtx &lt; 0) &amp;&amp; (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginVtx &lt; 0);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> &amp;&amp; bw2 &lt; (ew1 + maxOverlap))</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Chk1 ID1-2 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ew1</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)et1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; bw2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)bt2 &lt;&lt; <span class="stringliteral">&quot; dw &quot;</span> &lt;&lt; dw</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; ndead &quot;</span> &lt;&lt; ndead &lt;&lt; <span class="stringliteral">&quot; skipcut &quot;</span> &lt;&lt; skipcut &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; angcut &quot;</span> &lt;&lt; angcut;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        <span class="keywordflow">if</span> (NoVtx &amp;&amp; bw2 &lt; (ew1 + maxOverlap) &amp;&amp; dw &lt; skipcut &amp;&amp; dth &lt; angcut) {</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;          chgrat = 2 * fabs(bc2 - ec1) / (bc2 + ec1);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;          <span class="comment">// ignore the charge cut for long tracks with small dth</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;          <span class="keywordflow">if</span> (bothLong &amp;&amp; dth &lt; 0.05) chgrat = 0.;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;          <span class="comment">// project bw2,bt2 to ew1</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;          dtim = fabs(bt2 + (ew1 - bw2) * bs2 - et1);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;          bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bs2);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1) &gt; bigslp) bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;          timecut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[pass2] * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(bigslp);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dtim &quot;</span> &lt;&lt; dtim &lt;&lt; <span class="stringliteral">&quot; timecut &quot;</span> &lt;&lt; (int)timecut &lt;&lt; <span class="stringliteral">&quot; ec1 &quot;</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                                  &lt;&lt; ec1 &lt;&lt; <span class="stringliteral">&quot; bc2 &quot;</span> &lt;&lt; bc2 &lt;&lt; <span class="stringliteral">&quot; chgrat &quot;</span> &lt;&lt; chgrat &lt;&lt; <span class="stringliteral">&quot; chgcut &quot;</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                                  &lt;&lt; chgcut &lt;&lt; <span class="stringliteral">&quot; es1 &quot;</span> &lt;&lt; es1 &lt;&lt; <span class="stringliteral">&quot; ChkSignal &quot;</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(ew1, et1, bw2, bt2);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;          <span class="keywordflow">if</span> (chgrat &lt; chgcut &amp;&amp; dtim &lt; timecut) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;            <span class="comment">// ensure there is a signal between cluster ends</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(ew1, et1, bw2, bt2)) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3">DoMerge</a>(it2, it1, 10);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;              tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;            }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          } <span class="comment">// chgrat &lt; chgcut ...</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        }   <span class="comment">// US cluster 2 merge with DS cluster 1?</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="comment">// look for US and DS broken clusters w similar angle</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <span class="comment">// US cluster 1 merge with DS cluster 2?</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        dth = fabs(bth1 - eth2);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        ndead = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">DeadWireCount</a>(bw1, ew2);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        dw = ew2 - bw1 - ndead;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> &amp;&amp; bw1 &lt; (ew2 + maxOverlap) &amp;&amp; dw &lt; skipcut)</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Chk2 ID1-2 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; bw1</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)bt1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; bw2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)et2 &lt;&lt; <span class="stringliteral">&quot; dw &quot;</span> &lt;&lt; dw</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; ndead &quot;</span> &lt;&lt; ndead &lt;&lt; <span class="stringliteral">&quot; skipcut &quot;</span> &lt;&lt; skipcut &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; angcut &quot;</span> &lt;&lt; angcut;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <span class="comment">// require no vertex between</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        NoVtx = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndVtx &lt; 0) &amp;&amp; (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginVtx &lt; 0);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="keywordflow">if</span> (NoVtx &amp;&amp; bw1 &lt; (ew2 + maxOverlap) &amp;&amp; dw &lt; skipcut &amp;&amp; dth &lt; angcut) {</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;          chgrat = 2 * fabs((bc1 - ec2) / (bc1 + ec2));</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;          <span class="comment">// ignore the charge cut for long tracks with small dth</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;          <span class="keywordflow">if</span> (bothLong &amp;&amp; dth &lt; 0.05) chgrat = 0.;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;          <span class="comment">// project sw1,st1 to ew2</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          dtim = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bt1 + (ew2 - bw1) * bs1 - et2);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;          bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bs1);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bs2) &gt; bigslp) bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bs2);</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          timecut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[pass2] * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(bigslp);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; dtim &quot;</span> &lt;&lt; dtim &lt;&lt; <span class="stringliteral">&quot; err &quot;</span> &lt;&lt; dtim &lt;&lt; <span class="stringliteral">&quot; timecut &quot;</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                                  &lt;&lt; (int)timecut &lt;&lt; <span class="stringliteral">&quot; chgrat &quot;</span> &lt;&lt; chgrat &lt;&lt; <span class="stringliteral">&quot; chgcut &quot;</span> &lt;&lt; chgcut</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; ChkSignal &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(bw1, bt1, ew2, et2);</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="comment">// TODO: we should be checking for a signal here like we did above</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          <span class="keywordflow">if</span> (chgrat &lt; chgcut &amp;&amp; dtim &lt; timecut) {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(bw1, bt1, ew2, et2)) {</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3">DoMerge</a>(it1, it2, 10);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;              tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;            }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;          } <span class="comment">// chgrat &lt; chgcut ...</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        }   <span class="comment">// US cluster 1 merge with DS cluster 2</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="keywordflow">if</span> (bw2 &lt; bw1 &amp;&amp; ew2 &gt; ew1) {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;          <span class="comment">// look for small cl2 within the wire boundary of cl1</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          <span class="comment">// with similar times and slopes for both clusters</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          dth = fabs(eth2 - eth1);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          dtim = fabs(et1 + (ew2 - ew1 - 1) * es1 - et2);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1) &gt; bigslp) bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;          timecut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[pass2] * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(bigslp);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;          <span class="comment">// count the number of wires with no hits on cluster 1</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;          <span class="keywordtype">short</span> nmiss1 = bw1 - ew1 + 1 - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size();</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;          <span class="comment">// compare with the number of hits in cluster 2</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;          <span class="keywordtype">short</span> nin2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size();</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;cl2: &quot;</span> &lt;&lt; ew2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)et2 &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; bw2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                                  &lt;&lt; (<span class="keywordtype">int</span>)bt2 &lt;&lt; <span class="stringliteral">&quot; within cl1 &quot;</span> &lt;&lt; ew1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)et1 &lt;&lt; <span class="stringliteral">&quot; - &quot;</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                                  &lt;&lt; bw1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)bt1 &lt;&lt; <span class="stringliteral">&quot; ? dth &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; dtim &quot;</span> &lt;&lt; dtim</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; nmissed &quot;</span> &lt;&lt; nmiss1 &lt;&lt; <span class="stringliteral">&quot; timecut &quot;</span> &lt;&lt; timecut</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; FIX THIS CODE&quot;</span>;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;          <span class="comment">// make rough cuts before calling ChkMerge12</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;          <span class="comment">// this may not work well for long wandering clusters</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;          <span class="comment">// TODO fix this code</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;          <span class="keywordtype">bool</span> didit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;          <span class="keywordflow">if</span> (dth &lt; 1 &amp;&amp; dtim &lt; timecut &amp;&amp; nmiss1 &gt;= nin2) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a70cfcd7f7070bcb9a2d57345e56e9763">ChkMerge12</a>(it1, it2, didit);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;          <span class="keywordflow">if</span> (didit) {</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;            tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;          } <span class="comment">//didit</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        }   <span class="comment">// small cl2 within the wire boundary of cl1</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="keywordflow">if</span> (bw1 &lt; bw2 &amp;&amp; ew1 &gt; ew2) {</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;          <span class="comment">// look for small cl1 within the wire boundary of cl2</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;          <span class="comment">// with similar times and slopes for both clusters</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(eth2 - eth1);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;          dtim = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(et2 + (ew1 - ew2 - 1) * es2 - et1);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;          bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1) &gt; bigslp) bigslp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(es1);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;          timecut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[pass2] * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(bigslp);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;          <span class="comment">// count the number of wires with no hits on cluster 2</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;          <span class="keywordtype">short</span> nmiss2 = bw2 - ew2 + 1 - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size();</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          <span class="comment">// compare with the number of hits in cluster 1</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;          <span class="keywordtype">short</span> nin1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size();</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;cl1: &quot;</span> &lt;&lt; ew1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)et1 &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; bw1 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                                  &lt;&lt; (<span class="keywordtype">int</span>)bt1 &lt;&lt; <span class="stringliteral">&quot; within cl2 &quot;</span> &lt;&lt; ew2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)et2 &lt;&lt; <span class="stringliteral">&quot; - &quot;</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                                  &lt;&lt; bw2 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)bt2 &lt;&lt; <span class="stringliteral">&quot; ? dth &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; dtim &quot;</span> &lt;&lt; dtim</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; nmissed &quot;</span> &lt;&lt; nmiss2 &lt;&lt; <span class="stringliteral">&quot; timecut &quot;</span> &lt;&lt; timecut</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; FIX THIS CODE&quot;</span>;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;          <span class="comment">// make rough cuts before calling ChkMerge12</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;          <span class="comment">// this may not work well for long wandering clusters</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;          <span class="keywordtype">bool</span> didit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;          <span class="keywordflow">if</span> (dth &lt; 1 &amp;&amp; dtim &lt; timecut &amp;&amp; nmiss2 &gt;= nin1) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a70cfcd7f7070bcb9a2d57345e56e9763">ChkMerge12</a>(it2, it1, didit);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;          <span class="keywordflow">if</span> (didit) {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            tclsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size();</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;          } <span class="comment">// didit</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        }   <span class="comment">// small cl1 within the wire boundary of cl2</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      } <span class="comment">// cluster 2</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    } <span class="comment">// cluster 1</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  }</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a70cfcd7f7070bcb9a2d57345e56e9763"> 3027</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a70cfcd7f7070bcb9a2d57345e56e9763">ClusterCrawlerAlg::ChkMerge12</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it2, <span class="keywordtype">bool</span>&amp; didit)</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  {</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="comment">// Calling routine has done a rough check that cluster it2 is a candidate</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="comment">// for merging with cluster it1. The wire range spanned by it2 lies</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="comment">// within the wire range of it1 and the clusters are reasonably close</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="comment">// together in time.</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="comment">// assume that no merging was done</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    didit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkMerge12 &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ID;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html">ClusterStore</a>&amp; cl1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1];</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">// fill a vector spanning the length of cluster 1 and filled with the hit</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="comment">// time</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <span class="keywordtype">int</span> ew1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <span class="keywordtype">int</span> bw1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht, <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keywordtype">int</span> wire;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    std::vector&lt;unsigned int&gt; cl1hits(bw1 + 1 - ew1);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="comment">// put in the hit IDs</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="keywordflow">for</span> (iht = 0; iht &lt; cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size(); ++iht) {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      hit = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>[iht];</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;      wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].WireID().Wire;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      <span class="keywordflow">if</span> (wire - ew1 &lt; 0 || wire - ew1 &gt; (<span class="keywordtype">int</span>)cl1hits.size()) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      cl1hits[wire - ew1] = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ew2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir;</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordtype">float</span> et2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndTim;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="comment">// look for the closest wire with a hit on cluster 1</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wiron1 = 0;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="comment">// count the number of missing hits</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordtype">short</span> nmiss = 0;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="keywordflow">for</span> (wire = ew2 - 1; wire &gt; ew1; --wire) {</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      <span class="keywordflow">if</span> (cl1hits[wire - ew1] &gt; 0) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        wiron1 = wire;</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      }</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;      ++nmiss;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    } <span class="comment">// wire</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;chk next US wire &quot;</span> &lt;&lt; wiron1 &lt;&lt; <span class="stringliteral">&quot; missed &quot;</span> &lt;&lt; nmiss;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">if</span> (wiron1 == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keywordflow">if</span> (nmiss &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="comment">// compare the wires with hits on cluster 2 with the gap in cluster 1</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="comment">// the number of hit wires that fit in the gap</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hiton2;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="keywordtype">int</span> wiron2;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nfit = 0;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size(); ++iht) {</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      hiton2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits[iht];</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      wiron2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hiton2].WireID().Wire;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="keywordflow">if</span> (wiron2 &lt; ew1 || wiron2 &gt; bw1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <span class="keywordflow">if</span> (cl1hits[wiron2 - ew1] == 0) ++nfit;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    }</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="comment">// require complete filling of the gap</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keywordflow">if</span> (nfit &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="comment">// decode the pass for both clusters and select the matching cuts</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pass1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode / 10);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pass2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode - 10 * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].ProcCode / 10);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> cpass = pass1;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="comment">// use the tighter cuts</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="keywordflow">if</span> (pass2 &lt; pass1) cpass = pass2;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="comment">// ***** Check End of Cluster 2 matching with middle of cluster 1</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)wiron1 - ew1 &lt; 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hiton1 = cl1hits[wiron1 - ew1];</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="keywordflow">if</span> (hiton1 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="comment">// check the time difference</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordtype">float</span> timon1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hiton1].PeakTime();</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="keywordtype">float</span> dtim = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(et2 + (wiron1 - ew2) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndSlp - timon1);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="keywordflow">if</span> (dtim &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[cpass]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="comment">// check the slope difference. First do a local fit on cluster 1 near</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">// the matching point</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(it1, hiton1, 3);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 20.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="comment">// fit parameters are now in clpar.</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    <span class="comment">// check for angle consistency</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordtype">float</span> dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]) - std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndSlp));</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;US dtheta &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[cpass];</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="keywordflow">if</span> (dth &gt; fKinkAngCut[cpass]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="comment">// make a charge ratio cut. fAveChg was calculated in FitClusterMid</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keywordtype">float</span> chgrat = 2 * <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndChg) / (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndChg);</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;US chgrat &quot;</span> &lt;&lt; chgrat &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">fMergeChgCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="comment">// ensure that there is a signal on any missing wires at the US end of 1</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keywordtype">bool</span> SigOK;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(wiron1, timon1, ew2, et2);</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;US SigOK? &quot;</span> &lt;&lt; SigOK;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <span class="keywordflow">if</span> (!SigOK) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="comment">// ***** Check Begin of Cluster 2 matching with middle of cluster 1</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bw2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir;</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="keywordtype">float</span> bt2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginTim;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    nmiss = 0;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    wiron1 = 0;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keywordflow">for</span> (wire = bw2 + 1; wire &lt; bw1; ++wire) {</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">if</span> (cl1hits[wire - ew1] &gt; 0) {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        wiron1 = wire;</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      ++nmiss;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <span class="keywordflow">if</span> (wiron1 == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    <span class="keywordflow">if</span> (nmiss &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">fMaxWirSkip</a>[pass]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <span class="comment">// fit this section of cluster 1 with 4 hits starting at the hit on the</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    <span class="comment">// closest wire and moving DS</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    hiton1 = cl1hits[wiron1 - ew1];</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="keywordflow">if</span> (hiton1 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    timon1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hiton1].PeakTime();</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    dtim = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(bt2 - (wiron1 - bw2) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginSlp - timon1);</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="keywordflow">if</span> (dtim &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">fTimeDelta</a>[cpass]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(it1, hiton1, -3);</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 20.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="comment">// check for angle consistency</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * clpar[1]) - std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginSlp));</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;DS dtheta &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; fKinkAngCut[cpass];</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keywordflow">if</span> (dth &gt; fKinkAngCut[cpass]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="comment">// make a charge ratio cut</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    chgrat = 2 * <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginChg) / (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginChg);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;DS chgrat &quot;</span> &lt;&lt; chgrat &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; fMergeChgCut[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="comment">// ensure that there is a signal on any missing wires at the US end of 1</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    SigOK = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(wiron1, timon1, bw2, bt2);</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;DS SigOK? &quot;</span> &lt;&lt; SigOK;</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordflow">if</span> (!SigOK) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Merge em&quot;</span>;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    <span class="comment">// success. Merge them</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3">DoMerge</a>(it1, it2, 100);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    didit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  } <span class="comment">// ChkMerge12()</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3"> 3161</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3">ClusterCrawlerAlg::DoMerge</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it2, <span class="keywordtype">short</span> inProcCode)</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="comment">// Merge clusters.</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html">ClusterStore</a>&amp; cl1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1];</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html">ClusterStore</a>&amp; cl2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2];</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    <span class="keywordflow">if</span> (cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size() &lt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <span class="keywordflow">if</span> (cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size() &lt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lowire, hiwire, whsize, ii, iht, indx;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="comment">// do a fit across the boundary between cl1 and cl2 to</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="comment">// ensure that they truly should be merged</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fithit;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    <span class="comment">// Find the low and high wire for both clusters.</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="comment">// Assume that cluster 1 is DS</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="keywordtype">bool</span> cl1DS = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    hiwire = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a>;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    fithit = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>[cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size() - 2];</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <span class="keywordflow">if</span> (cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a> &gt; hiwire) {</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      hiwire = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a>;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;      fithit = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>[cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size() - 2];</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      cl1DS = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    }</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    lowire = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a>;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="keywordflow">if</span> (cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a> &lt; lowire) lowire = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a>;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="comment">// make a vector of wire hits</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    whsize = hiwire + 2 - lowire;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    std::vector&lt;int&gt; wirehit(whsize, -1);</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="comment">// put in the hit IDs for cluster 2</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size(); ++ii) {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      iht = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>[ii];</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - lowire;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      wirehit[indx] = iht;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    } <span class="comment">// iht</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="comment">// now cluster 1</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>.size(); ++ii) {</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      iht = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a>[ii];</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - lowire;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      wirehit[indx] = iht;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    } <span class="comment">// iht</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="comment">// make the new cluster</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;int&gt;::reverse_iterator rit = wirehit.rbegin(); rit != wirehit.rend(); ++rit) {</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordflow">if</span> (*rit &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(*rit);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    } <span class="comment">// rit</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <span class="comment">// fit the 6 hits that are near the merging point</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordtype">short</span> nhitfit = 6;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>, fithit, nhitfit);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 5) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="comment">// mark cl1 and cl2 obsolete</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(it1);</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">MakeClusterObsolete</a>(it2);</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="keywordtype">short</span> endVtx = 0;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="keywordtype">short</span> begVtx = 0;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordtype">short</span> del1Vtx = -99;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordtype">short</span> del2Vtx = -99;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <span class="keywordflow">if</span> (cl1DS) {</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      <span class="comment">// use cluster 1 Begin info</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8676add2af93850a5b6e50e0e58b35dd">BeginSlp</a>;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#aa132b5987e4e68c5cc3287d3da2c0e38">BeginSlpErr</a>;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a74993d25361b7f0aab80e204de0a8670">BeginAng</a>;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a>;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a55a0a9027b02fdf94a183b6a2a4a0ba5">BeginTim</a>;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8e96256bdd6b3d31eb10fd1077751cd7">BeginChg</a>;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a72d410696008e296f92577c96c415e2d">BeginChgNear</a>;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      begVtx = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">BeginVtx</a>;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      del1Vtx = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">EndVtx</a>;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="comment">// and cluster 2 End info</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab6024e5af06408e94099db102e7d54a9">EndSlp</a>;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a9e54c620da947807c84e514f59a284e7">EndSlpErr</a>;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">clEndAng</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a83303f6d29ca57193e6cff12dad2bd69">EndAng</a>;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a>;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#acdc68ea59936cecf0387be783dff3305">EndTim</a>;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a1fafe1ed78e116cabb4aeec226db6e18">EndChg</a>;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ade2aac44dcda72660adf80bd11cf459a">EndChgNear</a>;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      endVtx = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">EndVtx</a>;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      del2Vtx = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">BeginVtx</a>;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a5adbaedc9f9546e02d9d64e719008fbf">StopCode</a>;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    }</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      <span class="comment">// use cluster 2 Begin info</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8676add2af93850a5b6e50e0e58b35dd">BeginSlp</a>;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#aa132b5987e4e68c5cc3287d3da2c0e38">BeginSlpErr</a>;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a74993d25361b7f0aab80e204de0a8670">BeginAng</a>;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a>;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a55a0a9027b02fdf94a183b6a2a4a0ba5">BeginTim</a>;</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8e96256bdd6b3d31eb10fd1077751cd7">BeginChg</a>;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a72d410696008e296f92577c96c415e2d">BeginChgNear</a>;</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;      begVtx = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">BeginVtx</a>;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      del2Vtx = cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">EndVtx</a>;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      <span class="comment">// and cluster 1 End info</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab6024e5af06408e94099db102e7d54a9">EndSlp</a>;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a9e54c620da947807c84e514f59a284e7">EndSlpErr</a>;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a>;</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#acdc68ea59936cecf0387be783dff3305">EndTim</a>;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a1fafe1ed78e116cabb4aeec226db6e18">EndChg</a>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ade2aac44dcda72660adf80bd11cf459a">EndChgNear</a>;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;      endVtx = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">EndVtx</a>;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      del1Vtx = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">BeginVtx</a>;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a5adbaedc9f9546e02d9d64e719008fbf">StopCode</a>;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="comment">// append it to the tcl vector</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab214d0857bd69bbc55ed0e9ca8d5f3f2">CTP</a>;</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">TmpStore</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> itnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1;</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;DoMerge &quot;</span> &lt;&lt; cl1.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a56d1f73abc060c2612250d473ef59387">ID</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; cl2.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a56d1f73abc060c2612250d473ef59387">ID</a> &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[itnew].ID;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="comment">// stuff the processor code with the current pass</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[itnew].ProcCode = inProcCode + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="comment">// transfer the vertex info</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="comment">// delete a vertex between these two?</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="keywordflow">if</span> (del1Vtx &gt;= 0 &amp;&amp; del1Vtx == del2Vtx) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[del1Vtx].NClusters = 0;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="comment">// preserve the vertex assignments</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[itnew].BeginVtx = begVtx;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[itnew].EndVtx = endVtx;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  } <span class="comment">// DoMerge</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad98ef6dddaf9ae60489d20aab79318bd"> 3287</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad98ef6dddaf9ae60489d20aab79318bd">ClusterCrawlerAlg::PrintVertices</a>()</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  {</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    mf::LogVerbatim myprt(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size() &gt; 0) {</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="comment">// print out 3D vertices</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      myprt</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;****** 3D vertices ******************************************__2DVtx_Indx__*******\n&quot;</span>;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      myprt</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Vtx  Cstat  TPC Proc     X       Y       Z    XEr  YEr  ZEr  pln0 pln1 pln2  Wire\n&quot;</span>;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size(); ++iv) {</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; std::fixed &lt;&lt; iv &lt;&lt; std::setprecision(1);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].CStat;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].TPC;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].ProcCode;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].X;</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Y;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Z;</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].XErr;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].YErr;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].ZErr;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Ptr2D[0];</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Ptr2D[1];</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Ptr2D[2];</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Wire;</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv].Wire &lt; 0) { myprt &lt;&lt; <span class="stringliteral">&quot;    Matched in all planes&quot;</span>; }</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot;    Incomplete&quot;</span>;</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        }</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      }</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    } <span class="comment">// vtx3.size</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() &gt; 0) {</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="comment">// print out 2D vertices</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;************ 2D vertices ************\n&quot;</span>;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;Vtx   CTP    wire     error   tick     error  ChiDOF  NCl  topo  cluster IDs\n&quot;</span>;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv = 0; iv &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++iv) {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &lt; 3 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> != (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; std::fixed &lt;&lt; iv &lt;&lt; std::setprecision(1);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span>;</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr;</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span>;</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(8) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].NClusters;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Topo;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <span class="comment">// display the cluster IDs</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++ii) {</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &lt; 3 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> != (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginVtx == (<span class="keywordtype">short</span>)iv) myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].ID;</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndVtx == (<span class="keywordtype">short</span>)iv) myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].ID;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        }</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      } <span class="comment">// iv</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    }   <span class="comment">// vtx.size</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  } <span class="comment">// PrintVertices</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63"> 3352</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">ClusterCrawlerAlg::PrintClusters</a>()</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  {</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="comment">// prints clusters to the screen for code development</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    mf::LogVerbatim myprt(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad98ef6dddaf9ae60489d20aab79318bd">PrintVertices</a>();</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    <span class="keywordtype">float</span> aveRMS, aveRes;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;*************************************** Clusters &quot;</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;             <span class="stringliteral">&quot;*********************************************************************\n&quot;</span>;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    myprt &lt;&lt; <span class="stringliteral">&quot;  ID CTP nht Stop  Proc  beg_W:T    bAng  bSlp  Err  bChg end_W:T      eAng  eSlp  &quot;</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;             <span class="stringliteral">&quot;Err  eChg  bVx  eVx aveRMS Qual cnt\n&quot;</span>;</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++ii) {</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      <span class="comment">// print clusters in all planes (fDebugPlane = 3) or in a selected plane</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &lt; 3 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> != (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].ID;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(3) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].CTP;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits.size();</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].StopCode;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].ProcCode;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginTim;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iTime;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      <span class="keywordflow">if</span> (iTime &lt; 10) { myprt &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>; }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 100) {</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;      }</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 1000)</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginAng;</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginSlp) &lt; 100) {</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginSlp;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;      }</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginSlp;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      }</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginSlpErr;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginChg;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      iTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndTim;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; iTime;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      <span class="keywordflow">if</span> (iTime &lt; 10) { myprt &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>; }</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 100) {</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;      }</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iTime &lt; 1000)</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(7) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndAng;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndSlp) &lt; 100) {</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndSlp;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndSlp;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::fixed &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndSlpErr;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndChg;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].BeginVtx;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].EndVtx;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      aveRMS = 0;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = 0;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = 0; jj &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits.size(); ++jj) {</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits[jj];</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        aveRMS += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].RMS();</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      }</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      aveRMS /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits.size();</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; aveRMS;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      aveRes = 0;</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      <span class="comment">// find cluster tracking resolution</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit0, hit1, hit2, cnt = 0;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;      <span class="keywordtype">float</span> arg;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iht = 1; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits.size() - 1; ++iht) {</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;        hit1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits[iht];</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits[iht - 1];</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;        hit2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ii].tclhits[iht + 1];</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        <span class="comment">// require hits on adjacent wires</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit1].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire + 1 != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Wire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire + 1 != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit1].WireID().Wire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;        arg = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].PeakTime() + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].PeakTime()) / 2 - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit1].PeakTime();</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;        aveRes += arg * arg;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        ++cnt;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="keywordflow">if</span> (cnt &gt; 1) {</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;        aveRes /= (float)cnt;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        aveRes = sqrt(aveRes);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        <span class="comment">// convert to a quality factor</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;        aveRes /= (aveRMS * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a>);</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(6) &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; aveRes;</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; std::fixed &lt;&lt; cnt;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      }</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        myprt &lt;&lt; <span class="stringliteral">&quot;    NA&quot;</span>;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;        myprt &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">std::right</a> &lt;&lt; std::setw(5) &lt;&lt; std::fixed &lt;&lt; cnt;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      }</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  } <span class="comment">// PrintClusters()</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92"> 3454</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">ClusterCrawlerAlg::TmpGet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1)</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  {</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    <span class="comment">// copies temp cluster it1 into the fcl2hits vector, etc. This is</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <span class="comment">// effectively the inverse of cl2TmpStore</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keywordflow">if</span> (it1 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginSlp;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginSlpErr;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">clBeginAng</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginAng;</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginTim;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginChg;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginChgNear;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndSlp;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndSlpErr;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">clEndAng</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndAng;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">clEndTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndTim;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndChg;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndChgNear;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].StopCode;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].ProcCode;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].CTP;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;  }</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6"> 3483</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">ClusterCrawlerAlg::TmpStore</a>()</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == SHRT_MAX) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    ++<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0];</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tCST = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Cryostat;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tTPC = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().TPC;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tPlane = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Plane;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastWire = 0;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it = 0; it &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++it) {</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[it];</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[hit] != 0) {</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        --<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      }</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="comment">// check for WireID() consistency</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat != tCST || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].WireID().TPC != tTPC ||</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].WireID().Plane != tPlane) {</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        --<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      }</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;      <span class="comment">// check for decreasing wire number</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      <span class="keywordflow">if</span> (clProcCode &lt; 900 &amp;&amp; it &gt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &gt;= lastWire) {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;        --<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      }</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      lastWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].WireID().Wire;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    }</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <span class="comment">// ensure that the cluster begin/end info is correct</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <span class="comment">// define the begin/end charge if it wasn&#39;t done already</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> &lt;= 0) {</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="comment">// use the next to the last two hits. The End hit may have low charge</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 2;</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0];</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Integral();</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;      hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0 - 1];</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Integral();</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a> / 2.;</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    }</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> &lt;= 0) {</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <span class="comment">// use the 2nd and third hit. The Begin hit may have low charge</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[1];</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Integral();</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[2];</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Integral();</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> / 2.;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0];</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="comment">// store the cluster in the temporary ClusterStore struct</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    <a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html">ClusterStore</a> clstr;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a56d1f73abc060c2612250d473ef59387">ID</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a>;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8676add2af93850a5b6e50e0e58b35dd">BeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#aa132b5987e4e68c5cc3287d3da2c0e38">BeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a>;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a74993d25361b7f0aab80e204de0a8670">BeginAng</a> = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>);</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">BeginWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Wire;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a55a0a9027b02fdf94a183b6a2a4a0ba5">BeginTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].PeakTime();</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8e96256bdd6b3d31eb10fd1077751cd7">BeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a>;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a72d410696008e296f92577c96c415e2d">BeginChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a>;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab6024e5af06408e94099db102e7d54a9">EndSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a>;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a9e54c620da947807c84e514f59a284e7">EndSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">clEndSlpErr</a>;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a83303f6d29ca57193e6cff12dad2bd69">EndAng</a> = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">clEndSlp</a>);</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">EndWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].WireID().Wire;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#acdc68ea59936cecf0387be783dff3305">EndTim</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].PeakTime();</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a1fafe1ed78e116cabb4aeec226db6e18">EndChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">clEndChg</a>;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ade2aac44dcda72660adf80bd11cf459a">EndChgNear</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a>;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a5adbaedc9f9546e02d9d64e719008fbf">StopCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a>;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a491cbf624d52163dcc3bf701e562ff32">ProcCode</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a>;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">BeginVtx</a> = -99;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">EndVtx</a> = -99;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab214d0857bd69bbc55ed0e9ca8d5f3f2">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">EncodeCTP</a>(tCST, tTPC, tPlane);</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    clstr.<a class="code" href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">tclhits</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.push_back(clstr);</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;  } <span class="comment">// TmpStore()</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac186159f106e5376fab22d414df3dee8"> 3576</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac186159f106e5376fab22d414df3dee8">ClusterCrawlerAlg::LACrawlUS</a>()</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  {</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <span class="comment">// Crawl a large angle cluster upstream. Similar to CrawlUS but require</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    <span class="comment">// that a hit be added on each wire</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dhit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0];</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordtype">short</span> dwir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[dhit].WireID().Wire;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">clLA</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (<span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; dwir == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> &gt; 0)</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[dhit].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a>) &lt; 40;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;******************* LACrawlUS PASS &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &lt;&lt; <span class="stringliteral">&quot; Hits &quot;</span>;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++ii) {</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii];</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        myprt &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;      }</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    }</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="keywordtype">bool</span> SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keywordtype">bool</span> HitOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    <span class="keywordtype">short</span> nmissed = 0;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">// count the number of kinks encountered. Hits US of the kink are removed</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="comment">// and crawling continues unless another kink is encountered</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kinkOnWire = 0;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[it];</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lasthit].WireID().Wire;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prevHit, prevWire;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="keywordtype">bool</span> ChkCharge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nextwire = lastwire - 1; nextwire &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a>; --nextwire) {</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;LACrawlUS: next wire &quot;</span> &lt;&lt; nextwire &lt;&lt; <span class="stringliteral">&quot; HitRange &quot;</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[nextwire].first;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      <span class="comment">// stop crawling if there is a nearby vertex</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349">CrawlVtxChk</a>(nextwire)) {</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;LACrawlUS: stop at vertex&quot;</span>;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 6;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      }</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="comment">// AddLAHit will merge the hit on nextwire if necessary</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d8b5b5bd07dd6eae241251eb585b174">AddLAHit</a>(nextwire, ChkCharge, HitOK, SigOK);</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;LACrawlUS: HitOK &quot;</span> &lt;&lt; HitOK &lt;&lt; <span class="stringliteral">&quot; SigOK &quot;</span> &lt;&lt; SigOK</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; nmissed SigOK &quot;</span> &lt;&lt; nmissed &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a>;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      <span class="keywordflow">if</span> (SigOK) nmissed = 0;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <span class="keywordflow">if</span> (!SigOK) {</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;        ++nmissed;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;        <span class="keywordflow">if</span> (nmissed &gt; fAllowNoHitWire) {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 1;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        }</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      }</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      <span class="comment">// If a hit was added after a gap, check to see if there is indeed</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <span class="comment">// a wire signal in the gap</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <span class="keywordflow">if</span> (HitOK) {</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        prevHit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 2];</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        prevWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[prevHit].WireID().Wire;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <span class="keywordflow">if</span> (prevWire &gt; nextwire + 2) {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">ChkSignal</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1], <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 2])) {</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            <span class="comment">// no hit so trim the last hit and quit</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;          } <span class="comment">// no signal</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        }   <span class="comment">// prevWire &gt; nextwire + 2</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      }     <span class="comment">// HitOK</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <span class="comment">// Merge all of the hit multiplets in the fcl2hits array into single</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      <span class="comment">// hits when enough hits have been found to call this a credible large</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <span class="comment">// angle cluster. The last hit was already merged in AddHit</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 4) {</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <span class="keywordtype">bool</span> didMerge;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kk = 0; kk &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1; ++kk) {</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[kk];</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[hit]) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(hit, didMerge);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;        }</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        <span class="comment">// update the fit</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        <span class="comment">// start checking the charge ratio when adding new hits</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;        ChkCharge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      } <span class="comment">// fcl2hits.size() == 4</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> chsiz = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 1;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      <span class="comment">// chsiz is fcl2hits.size() - 1...</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      <span class="keywordflow">if</span> (chsiz &lt; 6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) {</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;LACrawlUS: chifits size error &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                           &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      }</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Kink chk &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 3];</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordflow">if</span> (chifits[chsiz - 1] &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] * chifits[chsiz - 2] &amp;&amp;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;          chifits[chsiz] &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] * chifits[chsiz - 1]) {</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;        <span class="comment">// find the kink angle (crudely) from the 0th and 2nd hit</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0];</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih2 = ih0 - 2;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih2];</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;        <span class="keywordtype">float</span> dt02 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].PeakTime();</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;        <span class="keywordtype">float</span> dw02 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Wire;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;        <span class="keywordtype">float</span> th02 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * dt02 / dw02);</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;        <span class="comment">// and the 3rd and 5th hit</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih3 = ih2 - 1;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit3 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih3];</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih5 = ih3 - 2;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit5 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih5];</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;        <span class="keywordtype">float</span> dt35 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit5].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit3].PeakTime();</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;        <span class="keywordtype">float</span> dw35 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit5].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit3].WireID().Wire;</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;        <span class="keywordtype">float</span> th35 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * dt35 / dw35);</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;        <span class="keywordtype">float</span> dth = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(th02 - th35);</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Kink angle &quot;</span> &lt;&lt; std::setprecision(3) &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        <span class="keywordflow">if</span> (dth &gt; fKinkAngCut[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;          <span class="comment">// hit a kink. Lop of the first 3 hits, refit and keep crawling?</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(3);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;          <span class="comment">// See if this is a second kink and it is close to the first</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;          <span class="comment">// kink (which had hits removed).</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;          <span class="keywordflow">if</span> (kinkOnWire &gt; 0) {</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;            <span class="keywordflow">if</span> (kinkOnWire - nextwire &lt; 4) {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Hit a second kink. kinkOnWire = &quot;</span> &lt;&lt; kinkOnWire &lt;&lt; <span class="stringliteral">&quot; Stopping&quot;</span>;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;              <span class="comment">// set the kink stop code</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 3;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;            }</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;          }</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;          kinkOnWire = nextwire;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Removed kink hits&quot;</span>;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        } <span class="comment">// kinkang check</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      }   <span class="comment">// chifits test</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    }     <span class="comment">// nextwire</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac69af5b1750a4cd40084afe879aeb271">CheckClusterHitFrac</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>);</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">clProcCode</a> += 300;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;LACrawlUS done. Nhits = &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  } <span class="comment">// LACrawlUS</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a77b1ab63cd211ff234ba537e128de1c4"> 3726</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a77b1ab63cd211ff234ba537e128de1c4">ClusterCrawlerAlg::CrawlUS</a>()</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  {</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="comment">// Crawl along a trail of hits moving upstream</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dhit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0];</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    <span class="keywordtype">int</span> dwir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[dhit].WireID().Wire;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">clLA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> == (<span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &amp;&amp; dwir == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">fDebugWire</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> &gt; 0)</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[dhit].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a>) &lt; 20;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;******************* Start CrawlUS on pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &lt;&lt; <span class="stringliteral">&quot; Hits: &quot;</span>;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++ii) {</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii];</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        myprt &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;      }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    }</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <span class="comment">// SigOK = true if there is a ADC signal near the projected cluster position</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <span class="keywordtype">bool</span> SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="keywordtype">bool</span> HitOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="comment">// count the number of missed hits on adjacent wires</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordtype">short</span> nmissed = 0;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    <span class="comment">// count the number of added hits after skipping</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    <span class="keywordtype">short</span> nHitAfterSkip = 0;</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    <span class="keywordtype">bool</span> DidaSkip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="keywordtype">bool</span> PostSkip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[it];</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <span class="keywordflow">if</span> (lasthit &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS bad lasthit &quot;</span> &lt;&lt; lasthit;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    }</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lasthit].WireID().Wire;</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS: last wire &quot;</span> &lt;&lt; lastwire &lt;&lt; <span class="stringliteral">&quot; hit &quot;</span> &lt;&lt; lasthit;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastWireWithSignal = lastwire;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDroppedHit = 0;</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nextwire = lastwire - 1; nextwire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a>; --nextwire) {</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS: next wire &quot;</span> &lt;&lt; nextwire &lt;&lt; <span class="stringliteral">&quot; HitRange &quot;</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[nextwire].first;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      <span class="comment">// stop crawling if there is a nearby vertex</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349">CrawlVtxChk</a>(nextwire)) {</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS: stop at vertex&quot;</span>;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 6;</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      }</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      <span class="comment">// Switch to large angle crawling?</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">fLAClusSlopeCut</a>) {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt;&gt;&gt; CrawlUS: Switching to LACrawlUS&quot;</span>;</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac186159f106e5376fab22d414df3dee8">LACrawlUS</a>();</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="comment">// add hits and check for PH and width consistency</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aceda5036373484fcba4632e8426b436d">AddHit</a>(nextwire, HitOK, SigOK);</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS: HitOK &quot;</span> &lt;&lt; HitOK &lt;&lt; <span class="stringliteral">&quot; SigOK &quot;</span> &lt;&lt; SigOK &lt;&lt; <span class="stringliteral">&quot; nmissed &quot;</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                              &lt;&lt; nmissed;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      <span class="keywordflow">if</span> (SigOK) lastWireWithSignal = nextwire;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <span class="keywordflow">if</span> (!HitOK) {</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        <span class="comment">// no hit on this wire. Was there a signal or dead wire?</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        <span class="keywordflow">if</span> (SigOK) {</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;          <span class="comment">// no hit on the wire but there is a signal</span></div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;          ++nmissed;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;          <span class="comment">// see if we are in the PostSkip phase and missed more than 1 wire</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;          <span class="keywordflow">if</span> (PostSkip &amp;&amp; nmissed &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;            <span class="comment">// cluster is really short</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - nHitAfterSkip) &lt; 4) {</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;              <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            }</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; PostSkip &amp;&amp; nmissed = &quot;</span> &lt;&lt; nmissed;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 2;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(nHitAfterSkip);</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; 90.) {</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;              <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;            }</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;          } <span class="comment">// PostSkip &amp;&amp; nmissed &gt;</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;          <span class="keywordflow">if</span> (nmissed &gt; 1) {</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;            DidaSkip = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;            PostSkip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;          }</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        } <span class="comment">// SigOK</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;          <span class="comment">// SigOK is false</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 0;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;          lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;          <span class="keywordflow">if</span> ((lastWireWithSignal - nextwire) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a>) {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;No hit or signal on wire &quot;</span> &lt;&lt; nextwire &lt;&lt; <span class="stringliteral">&quot; last wire with signal &quot;</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                &lt;&lt; lastWireWithSignal &lt;&lt; <span class="stringliteral">&quot; exceeding fAllowNoHitWire &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; Break!&quot;</span>;</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          }</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;        } <span class="comment">// else SigOK false</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      }   <span class="comment">// !HitOK</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; CrawlUS check clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; fChiCut[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 3) {</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;          }</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;          <span class="comment">// a fit error occurred. Lop off the leading hit and refit</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ADD- Bad clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; dropping hit&quot;</span>;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;          ++nDroppedHit;</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;          <span class="keywordflow">if</span> (nDroppedHit &gt; 4) {</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; Too many dropped hits: &quot;</span> &lt;&lt; nDroppedHit &lt;&lt; <span class="stringliteral">&quot; Stop crawling&quot;</span>;</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;          } <span class="comment">// too many dropped hits</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; fChiCut[pass]) {</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; Bad clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; after dropping hit. Stop crawling&quot;</span>;</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;          }</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        } <span class="comment">// clChisq &gt; fChiCut[0]</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        <span class="comment">// monitor the onset of a kink. Look for a progressive increase</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        <span class="comment">// in chisq for the previous 0 - 2 hits.</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() &gt; 5 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &gt; 0) {</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) {</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;            mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CrawlUS: chifits size error &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                               &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;          }</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> chsiz = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 1;</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Kink chk &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 1]</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[chsiz - 3];</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;          <span class="keywordflow">if</span> (chifits[chsiz - 1] &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[pass] * chifits[chsiz - 2] &amp;&amp;</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;              chifits[chsiz] &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[pass] * chifits[chsiz - 1]) {</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() != chifits.size()) {</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;              mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;bad kink check size &quot;</span> &lt;&lt; chifits.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                                 &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt;&lt; <span class="stringliteral">&quot; plane &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt;&lt; <span class="stringliteral">&quot; cluster &quot;</span> &lt;&lt; dwir</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dhit;</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;            }</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">EndKinkAngle</a>() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[pass]) {</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;******************* Stopped tracking - kink angle &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">EndKinkAngle</a>() &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt;&lt; <span class="stringliteral">&quot; Removing 3 hits&quot;</span>;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;              <span class="comment">// kill the last 3 hits and refit</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(3);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;            } <span class="comment">// kinkang check</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;          }   <span class="comment">// chifits check</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        }     <span class="comment">// chifits.size() &gt; 5</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;        <span class="comment">// done with kink check</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        <span class="comment">// update the cluster Begin information?</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">fMaxHitsFit</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;        }</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;        <span class="comment">// define the begin cluster charge if it&#39;s not defined yet</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        <span class="keywordflow">if</span> (clBeginChg &lt;= 0 &amp;&amp; fAveChg &gt; 0) {</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Set clBeginChg &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a>;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        }</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        <span class="comment">// reset nmissed</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        nmissed = 0;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        <span class="comment">// start counting hits added after skipping</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <span class="keywordflow">if</span> (DidaSkip) {</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;          <span class="comment">// start PostSkip phase</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;          PostSkip = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          DidaSkip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;          nHitAfterSkip = 0;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        } <span class="comment">// DidaSkip</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        <span class="comment">// check for PostSkip phase</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;        <span class="keywordflow">if</span> (PostSkip) {</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;          <span class="comment">// end the PostSkip phase if there are enough hits</span></div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          ++nHitAfterSkip;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;          <span class="keywordflow">if</span> (nHitAfterSkip == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a>[pass]) PostSkip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        }</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        <span class="comment">// check for bad chisq</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; fChiCut[pass]) {</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&lt;&lt;ADD- Bad chisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a>;</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;          <span class="comment">// remove the last few hits if there is a systematic increase in chisq and re-fit</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;          <span class="keywordtype">float</span> chirat;</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lopped = 0;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nlop = 0; nlop &lt; 4; ++nlop) {</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> cfsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 1;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;            chirat = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[cfsize] / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[cfsize - 1];</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;chirat &quot;</span> &lt;&lt; chirat &lt;&lt; <span class="stringliteral">&quot; last hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;            <span class="keywordflow">if</span> (chirat &lt; 1.2) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&lt;&lt;ADD- Bad chisq. Bad chirat &quot;</span> &lt;&lt; chirat;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;            ++lopped;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;            <span class="keywordflow">if</span> (fcl2hits.size() &lt; 6) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() &lt; 6) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;          } <span class="comment">// nlop</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 6) {</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">clStopCode</a> = 4;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad fit chisq - short cluster. Break&quot;</span>;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;          }</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;          <span class="keywordflow">if</span> (lopped == 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 5) {</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&lt;&lt;ADD- Bad chisq. remove 1 hit&quot;</span>;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;            ++lopped;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;          }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad fit chisq - removed &quot;</span> &lt;&lt; lopped &lt;&lt; <span class="stringliteral">&quot; hits. Continue&quot;</span>;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        } <span class="comment">// clChisq &gt; fChiCut[pass]</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      }   <span class="comment">// !HitOK check</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    }     <span class="comment">// nextwire</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;******************* CrawlUS normal stop. size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <span class="keywordtype">bool</span> reFit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    <span class="comment">// end kink angle check</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 5) {</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <span class="comment">// check for a kink at the US end</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;EndKinkAngle check &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">EndKinkAngle</a>() &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">EndKinkAngle</a>() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">fKinkAngCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;EndKinkAngle removes 3 hits &quot;</span>;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(3);</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;        reFit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;      }</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    } <span class="comment">// fcl2hits.size() &gt; 5</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    <span class="comment">// count the number of hits on adjacent wires at the leading edge and</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;    <span class="comment">// ensure that the count is consistent with fMinWirAfterSkip</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] + 3) {</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0];</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uswir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Wire;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nxtwir;</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nAdjHit = 0;</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = ih0 - 1; ii &gt; 0; --ii) {</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        nxtwir = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].WireID().Wire;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        ++nAdjHit;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;        <span class="keywordflow">if</span> (nxtwir != uswir + 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        <span class="comment">// break if there are enough hits</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        <span class="keywordflow">if</span> (nAdjHit == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;        uswir = nxtwir;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;      <span class="comment">// lop off hits?</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <span class="keywordflow">if</span> (nAdjHit &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">fMinWirAfterSkip</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;fMinWirAfterSkip removes &quot;</span> &lt;&lt; nAdjHit &lt;&lt; <span class="stringliteral">&quot; hits &quot;</span>;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(nAdjHit);</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;        reFit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;      }</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    } <span class="comment">// fcl2hits.size() &gt; fMinWirAfterSkip[pass] + 3</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    <span class="comment">// check for a bad hit on the end</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="keywordflow">if</span> (!reFit &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 3) {</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      <span class="keywordtype">float</span> chirat = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 1] / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 2];</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Last hit chirat &quot;</span> &lt;&lt; chirat &lt;&lt; <span class="stringliteral">&quot; cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">fKinkChiRat</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Check &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.size() - 2];</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      <span class="keywordflow">if</span> (chirat &gt; fKinkChiRat[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&lt;&lt;ADD- at end&quot;</span>;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        reFit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;      }</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    } <span class="comment">// !reFit</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="keywordflow">if</span> (reFit) {</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    }</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac69af5b1750a4cd40084afe879aeb271">CheckClusterHitFrac</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;******************* CrawlUS done. Size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; min length for this pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">fMinHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  } <span class="comment">// CrawlUS()</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04"> 4027</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">ClusterCrawlerAlg::EndKinkAngle</a>()</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;  {</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    <span class="comment">// find the kink angle (crudely) from the 0th and 2nd hit on the cluster under construction</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0];</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih2 = ih0 - 2;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih2];</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <span class="keywordtype">float</span> dt02 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].PeakTime();</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    <span class="keywordtype">float</span> dw02 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit2].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit0].WireID().Wire;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    <span class="keywordtype">float</span> th02 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * dt02 / dw02);</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;    <span class="comment">// and the 3rd and 5th hit</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih3 = ih2 - 1;</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit3 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih3];</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih5 = ih3 - 2;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hit5 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih5];</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="keywordtype">float</span> dt35 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit5].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit3].PeakTime();</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    <span class="keywordtype">float</span> dw35 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit5].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[hit3].WireID().Wire;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <span class="keywordtype">float</span> th35 = std::atan(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">fScaleF</a> * dt35 / dw35);</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(th02 - th35);</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  }</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a295421507d307d627b03ec9156673e"> 4051</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a295421507d307d627b03ec9156673e">ClusterCrawlerAlg::ChkMergedClusterHitFrac</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it2)</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  {</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <span class="comment">// This routine is called before two tcl clusters, it1 and it2, are slated to be</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    <span class="comment">// merged to see if they will satisfy the minimum hit fraction criterion</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    <span class="keywordflow">if</span> (it1 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    <span class="keywordflow">if</span> (it2 &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eWire = 99999;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bWire = 0, wire;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir &gt; bWire) bWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].BeginWir;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir &gt; bWire) bWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].BeginWir;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir &lt; eWire) eWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].EndWir;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir &lt; eWire) eWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].EndWir;</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mergedClusterLength = bWire - eWire + 1;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <span class="comment">// define a vector of size = length of the wire range</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    std::vector&lt;bool&gt; cHits(mergedClusterLength, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <span class="comment">// set the elements true if there is a hit</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii, iht, indx;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;      iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits[ii];</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkMergedClusterHitFrac bad iht &quot;</span>;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      }</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - eWire;</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;      cHits[indx] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;      iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it2].tclhits[ii];</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkMergedClusterHitFrac bad iht &quot;</span>;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      }</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - eWire;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      cHits[indx] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <span class="comment">// set cHits true if the wire is dead</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; cHits.size(); ++ii) {</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      wire = eWire + ii;</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) cHits[ii] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    }</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    <span class="comment">// count the number of wires with hits</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;    <span class="keywordtype">float</span> nhits = <a class="code" href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">std::count</a>(cHits.begin(), cHits.end(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    <span class="keywordtype">float</span> hitFrac = nhits / (float)cHits.size();</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    <span class="keywordflow">return</span> (hitFrac &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5777e2db6b5db18dbc7c37604573d8cc">fMinHitFrac</a>);</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;  } <span class="comment">// ChkMergedClusterHitFrac</span></div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac69af5b1750a4cd40084afe879aeb271"> 4099</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac69af5b1750a4cd40084afe879aeb271">ClusterCrawlerAlg::CheckClusterHitFrac</a>(<span class="keywordtype">bool</span> prt)</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  {</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    <span class="comment">// Find the fraction of the wires on the cluster that have</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="comment">// hits.</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0]].WireID().Wire;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    <span class="keywordtype">float</span> hitFrac = (float)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">DeadWireCount</a>()) / (<span class="keywordtype">float</span>)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a> + 1);</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <span class="keywordflow">if</span> (hitFrac &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5777e2db6b5db18dbc7c37604573d8cc">fMinHitFrac</a>) {</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;      <span class="keywordflow">if</span> (prt)</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CheckClusterHitFrac: Poor hit fraction &quot;</span> &lt;&lt; hitFrac</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; clBeginWir &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a> &lt;&lt; <span class="stringliteral">&quot; clEndWir &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">clEndWir</a></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt;&lt; <span class="stringliteral">&quot; DeadWireCount &quot;</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">DeadWireCount</a>();</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    } <span class="comment">// hitFrac</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    <span class="comment">/* TODO: Does this make sense?</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">    // lop off the last hit if it is part of a hit multiplet</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">    if(fHits[iht].Multiplicity() &gt; 1) {</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">      fcl2hits.resize(fcl2hits.size() - 1);</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    <span class="comment">// check for short track ghosts</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 5) {</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nsing = 0;</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++iht)</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[iht]].Multiplicity() == 1) ++nsing;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      hitFrac = (float)nsing / (<span class="keywordtype">float</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      <span class="keywordflow">if</span> (hitFrac &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5777e2db6b5db18dbc7c37604573d8cc">fMinHitFrac</a>) {</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.clear();</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;        <span class="keywordflow">if</span> (prt)</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;CheckClusterHitFrac: Poor short track hit fraction &quot;</span> &lt;&lt; hitFrac;</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      } <span class="comment">// hitFrac</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;    }   <span class="comment">// short ghost track check</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    <span class="comment">// analyze the pattern of nearby charge</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    <span class="comment">// will need the cluster charge so calculate it here if it isn&#39;t defined yet</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> &lt;= 0) {</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht, nht = 0;</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++ii) {</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii];</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Integral();</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        ++nht;</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        <span class="keywordflow">if</span> (nht == 8) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;      }</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">clBeginChg</a> /= (float)nht;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    } <span class="comment">// clBeginChg == 0</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <span class="comment">// handle short vs long clusters</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> cnt = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.size() / 2;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="comment">// get the average charge from &lt;= 30 hits at each end</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.size() &gt; 60) cnt = 30;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> = 0;</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> = 0;</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ids = 0; ids &lt; cnt; ++ids) {</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>[ids];</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.size() - 1 - ids];</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    }</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">clBeginChgNear</a> /= (float)cnt;</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">clEndChgNear</a> /= (float)cnt;</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  } <span class="comment">// CheckClusterHitFrac()</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd"> 4168</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">ClusterCrawlerAlg::FitClusterMid</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihtin, <span class="keywordtype">short</span> nhit)</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  {</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[it1].tclhits, ihtin, nhit);</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  } <span class="comment">// FitClusterMid</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2703f6c2704c6449cf426cd5e4aa9d40"> 4175</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">ClusterCrawlerAlg::FitClusterMid</a>(std::vector&lt;unsigned int&gt;&amp; hitVec,</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihtin,</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                                   <span class="keywordtype">short</span> nhit)</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  {</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    <span class="comment">// Fits hits on temp cluster it1 to a line starting at hit ihtin and including</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <span class="comment">// nhit hits incrementing towards the hit vector End when nhit &gt; 0 and</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    <span class="comment">// decrementing towards the hit vector Begin when nhit &lt; 0.</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="comment">// The fit params are stashed in the clpar and clparerr arrays.</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <span class="comment">// fAveChg is re-calculated as well.</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="comment">// set chisq bad in case something doesn&#39;t work out</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = 99.;</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    <span class="keywordflow">if</span> (hitVec.size() &lt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    std::vector&lt;float&gt; xwir;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    std::vector&lt;float&gt; ytim;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    std::vector&lt;float&gt; ytimerr2;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, hitcnt = 0, nht = 0, usnhit;</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="keywordtype">float</span> wire0 = 0;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    <span class="keywordtype">bool</span> UseEm = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = 0.;</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0.;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">if</span> (nhit &gt; 0) {</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      usnhit = nhit;</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      <span class="comment">// find the first desired hit and move towards the End</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; hitVec.size(); ++ii) {</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        iht = hitVec[ii];</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FitClusterMid bad iht &quot;</span> &lt;&lt; iht;</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;        }</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <span class="comment">// look for the desired first hit. Use this as the origin wire</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        <span class="keywordflow">if</span> (iht == ihtin) {</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;          UseEm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;          wire0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;        }</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        <span class="comment">// use hits after finding the first desired hit</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        <span class="keywordflow">if</span> (UseEm) {</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;          xwir.push_back((<span class="keywordtype">float</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - wire0);</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;          ytim.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime());</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;          <span class="comment">// pass the error^2 to the fitter</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;          <span class="keywordtype">float</span> terr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].RMS();</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;          ytimerr2.push_back(terr * terr);</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Integral();</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;          ++hitcnt;</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;          <span class="keywordflow">if</span> (hitcnt == usnhit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;        }</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      }</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      nht = hitcnt;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;      usnhit = -nhit;</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      <span class="comment">// find the first desired hit and move towards the Begin</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii = hitVec.crbegin(); ii != hitVec.crend(); ++ii) {</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        iht = *ii;</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;        <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) {</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FitClusterMid bad iht &quot;</span> &lt;&lt; iht;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;        <span class="comment">// look for the desired first hit. Use this as the origin wire</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        <span class="keywordflow">if</span> (iht == ihtin) {</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;          UseEm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;          wire0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        }</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        <span class="comment">// use hits after finding the first desired hit</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        <span class="keywordflow">if</span> (UseEm) {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;          xwir.push_back((<span class="keywordtype">float</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire - wire0);</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;          ytim.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime());</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;          <span class="keywordtype">float</span> terr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].RMS();</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;          ytimerr2.push_back(terr * terr);</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Integral();</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;          ++hitcnt;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;          <span class="keywordflow">if</span> (hitcnt == usnhit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        }</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;      }</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;      nht = hitcnt;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    }</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <span class="keywordflow">if</span> (nht &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> / (float)nht;</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0.;</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="keywordtype">float</span> intcpt = 0.;</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    <span class="keywordtype">float</span> slope = 0.;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    <span class="keywordtype">float</span> intcpterr = 0.;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    <span class="keywordtype">float</span> slopeerr = 0.;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    <span class="keywordtype">float</span> chidof = 0.;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad77499d15ed8cec5c6fc0fd327c0c96e">fLinFitAlg</a>.<a class="code" href="../../dc/d6a/classtrkf_1_1LinFitAlg.html#a113ec78487fa649f3dc86f711b99a1ca">LinFit</a>(xwir, ytim, ytimerr2, intcpt, slope, intcpterr, slopeerr, chidof);</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = chidof;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a>[0]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] = intcpt;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] = slope;</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2] = wire0;</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[0] = intcpterr;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1] = slopeerr;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;  }</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140"> 4278</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">ClusterCrawlerAlg::FitCluster</a>()</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;  {</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    <span class="comment">// Fits the hits on the US end of a cluster. This routine assumes that</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    <span class="comment">// wires are numbered from lower (upstream) to higher (downstream) and</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    <span class="comment">// that the hits in the fclhits vector are sorted so that upstream hits</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    <span class="comment">// are at the end of the vector</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = 999.;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a> - 1) {</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FitCluster called on invalid pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    }</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, nht = 0;</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    <span class="comment">// fit all hits or truncate?</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    nht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">clLA</a>) {</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      <span class="comment">// Fit large angle cluster</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      <span class="keywordflow">if</span> (nht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a67d7ff71d4cf0ac3884a4e33edd9d656">fLAClusMaxHitsFit</a>) nht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a67d7ff71d4cf0ac3884a4e33edd9d656">fLAClusMaxHitsFit</a>;</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    }</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;      <span class="keywordflow">if</span> (nht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">fMaxHitsFit</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) nht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">fMaxHitsFit</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    <span class="keywordflow">if</span> (nht &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    std::vector&lt;float&gt; xwir;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    std::vector&lt;float&gt; ytim;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    std::vector&lt;float&gt; ytimerr2;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <span class="comment">// apply an angle dependent scale factor.</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordtype">float</span> angfactor = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]);</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire;</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1]].WireID().Wire;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit;</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    <span class="keywordtype">float</span> terr, qave = 0, qwt;</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; nht; ++ii) {</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      ihit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii];</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;      qave += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral();</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;    qave /= (float)nht;</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; nht; ++ii) {</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      ihit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii];</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;      wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].WireID().Wire;</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      xwir.push_back(wire - wire0);</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;      ytim.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].PeakTime());</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;      <span class="comment">// Scale error by hit multiplicity to account for bias in hit</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <span class="comment">// multiplet fitting</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;      terr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].RMS() * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Multiplicity();</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &gt; 0) {</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;        <span class="comment">// increase the error for large charge hits</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        qwt = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].Integral() / qave) - 1;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        <span class="keywordflow">if</span> (qwt &lt; 1) qwt = 1;</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;        terr *= qwt;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      }</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      <span class="keywordflow">if</span> (terr &lt; 0.01) terr = 0.01;</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;      ytimerr2.push_back(angfactor * terr * terr);</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2df3120f005ae20a8b307aada42e7c0d">CalculateAveHitWidth</a>();</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      mf::LogVerbatim myprt(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      myprt &lt;&lt; <span class="stringliteral">&quot;FitCluster W:T &quot;</span>;</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> cnt = 0;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;unsigned int&gt;::reverse_iterator it = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.rbegin();</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;           it != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.rend();</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;           ++it) {</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit = *it;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].WireID().Wire;</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        myprt &lt;&lt; wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (short)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ihit].PeakTime() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        ++cnt;</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        <span class="keywordflow">if</span> (cnt == 8) {</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;          myprt &lt;&lt; <span class="stringliteral">&quot; .... &quot;</span>;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        }</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      }</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    } <span class="comment">// prt</span></div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <span class="keywordflow">if</span> (xwir.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    <span class="keywordtype">float</span> intcpt = 0.;</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="keywordtype">float</span> slope = 0.;</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    <span class="keywordtype">float</span> intcpterr = 0.;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <span class="keywordtype">float</span> slopeerr = 0.;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    <span class="keywordtype">float</span> chidof = 0.;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad77499d15ed8cec5c6fc0fd327c0c96e">fLinFitAlg</a>.<a class="code" href="../../dc/d6a/classtrkf_1_1LinFitAlg.html#a113ec78487fa649f3dc86f711b99a1ca">LinFit</a>(xwir, ytim, ytimerr2, intcpt, slope, intcpterr, slopeerr, chidof);</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> = chidof;</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordflow">if</span> (chidof &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a>[0]) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] = intcpt;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] = slope;</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2] = wire0;</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[0] = intcpterr;</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1] = slopeerr;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;nht &quot;</span> &lt;&lt; nht &lt;&lt; <span class="stringliteral">&quot; fitpar &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] &lt;&lt; <span class="stringliteral">&quot;+/-&quot;</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                            &lt;&lt; (<span class="keywordtype">int</span>)intcpterr &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1] &lt;&lt; <span class="stringliteral">&quot;+/-&quot;</span> &lt;&lt; slopeerr &lt;&lt; <span class="stringliteral">&quot; clChisq &quot;</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                            &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a>;</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38"> 4378</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">ClusterCrawlerAlg::AngleFactor</a>(<span class="keywordtype">float</span> slope)</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  {</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    <span class="comment">// returns an angle dependent cluster projection error factor for fitting</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    <span class="comment">// and hit finding</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="keywordtype">float</span> slp = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope);</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    <span class="keywordflow">if</span> (slp &gt; 15) slp = 15;</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="comment">// return a value between 1 and 4</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <span class="keywordtype">float</span> angfac = 1 + 0.03 * slp * slp;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    <span class="keywordflow">return</span> angfac;</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;  }</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04392"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2df3120f005ae20a8b307aada42e7c0d"> 4392</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2df3120f005ae20a8b307aada42e7c0d">ClusterCrawlerAlg::CalculateAveHitWidth</a>()</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;  {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> = 0;</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size(); ++ii)</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].StartTick();</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  } <span class="comment">// CalculateAveHitWidth</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73"> 4402</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">ClusterCrawlerAlg::FitClusterChg</a>()</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  {</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="comment">// Fits the charge of hits on the fcl2hits vector to a line, or simply</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <span class="comment">// uses the average of 1 or 2 hits as determined by NHitsAve</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ih0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &gt;= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">fNumPass</a>) {</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FitClusterChg bad pass &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    }</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    <span class="comment">// Handle Large Angle clusters</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">clLA</a>) {</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      <span class="comment">// simple average of the charge (and the hit width</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="comment">// while we are here)</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nhave = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a67d7ff71d4cf0ac3884a4e33edd9d656">fLAClusMaxHitsFit</a>;</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="keywordflow">if</span> (nhave &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) nhave = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = 0;</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0;</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> = 0;</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; nhave; ++ii) {</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;        iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii];</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Integral();</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> += (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].StartTick());</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> /= (float)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    } <span class="comment">// clLA</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;    <span class="comment">// number of hits at the leading edge that we will fit</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> fitLen = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    <span class="comment">// start fitting charge when there are at least 6 hits if we are tracking</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <span class="comment">// long clusters</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    <span class="keywordflow">if</span> (fitLen &gt; 5 &amp;&amp;             <span class="comment">// Fit 6 hits when tracking long clusters AND</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 5 &amp;&amp;    <span class="comment">// there are at least 6 hits AND</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; fitLen) <span class="comment">// there are less than fNHitsAve[pass]</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;      fitLen = 5;</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <span class="comment">// don&#39;t find the average charge --&gt; no charge cut is made</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] == 1) {</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      <span class="comment">// simply use the charge and width the last hit</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0]].Integral();</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0.;</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    }</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">fNHitsAve</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] == 2) {</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      <span class="comment">// average the last two points if requested</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0]].Integral() + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ih0 - 1]].Integral()) / 2.;</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = 0.;</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    }</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; fitLen) {</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="comment">// do a real fit</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      std::vector&lt;float&gt; xwir;</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      std::vector&lt;float&gt; ychg;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      std::vector&lt;float&gt; ychgerr2;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      <span class="comment">// origin of the fit</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1]].WireID().Wire;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <span class="comment">// find the mean and rms of the charge</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> npt = 0;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> imlast = 0;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;      <span class="keywordtype">float</span> ave = 0.;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      <span class="keywordtype">float</span> rms = 0.;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      <span class="comment">// this loop intentionally ignores the Begin hit</span></div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1; ii &gt; 0; --ii) {</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;        ++npt;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;        <span class="keywordtype">float</span> chg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].Integral();</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;        ave += chg;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;        rms += chg * chg;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;        <span class="keywordflow">if</span> (npt == fitLen) {</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;          imlast = ii;</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;        }</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;      <span class="keywordtype">float</span> fnpt = npt;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      ave /= fnpt;</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;      rms = std::sqrt((rms - fnpt * ave * ave) / (fnpt - 1));</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;      <span class="keywordtype">float</span> chgcut = ave + rms;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      <span class="keywordtype">float</span> chg;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1; ii &gt; imlast; --ii) {</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;        wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].WireID().Wire;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;        chg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[ii]].Integral();</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;        <span class="keywordflow">if</span> (chg &gt; chgcut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        xwir.push_back((<span class="keywordtype">float</span>)(wire - wire0));</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        ychg.push_back(chg);</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;        ychgerr2.push_back(chg);</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      }</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;      <span class="keywordflow">if</span> (ychg.size() &lt; 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;      <span class="keywordtype">float</span> intcpt;</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      <span class="keywordtype">float</span> slope;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;      <span class="keywordtype">float</span> intcpterr;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;      <span class="keywordtype">float</span> slopeerr;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <span class="keywordtype">float</span> chidof;</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad77499d15ed8cec5c6fc0fd327c0c96e">fLinFitAlg</a>.<a class="code" href="../../dc/d6a/classtrkf_1_1LinFitAlg.html#a113ec78487fa649f3dc86f711b99a1ca">LinFit</a>(xwir, ychg, ychgerr2, intcpt, slope, intcpterr, slopeerr, chidof);</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;FitClusterChg wire &quot;</span> &lt;&lt; wire0 &lt;&lt; <span class="stringliteral">&quot; chidof &quot;</span> &lt;&lt; (int)chidof</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; npt &quot;</span> &lt;&lt; xwir.size() &lt;&lt; <span class="stringliteral">&quot; charge = &quot;</span> &lt;&lt; (int)intcpt</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; slope = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)slope &lt;&lt; <span class="stringliteral">&quot; first ave &quot;</span> &lt;&lt; (int)ave &lt;&lt; <span class="stringliteral">&quot; rms &quot;</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                              &lt;&lt; (<span class="keywordtype">int</span>)rms;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      <span class="keywordflow">if</span> (chidof &gt; 100.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="comment">// fit must have gone wrong if the fStepCrawlChgRatCut average is greater than</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;      <span class="comment">// the average using all points</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="keywordflow">if</span> (intcpt &gt; ave) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      <span class="comment">// ensure that change does not exceed 30%</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &gt; 0) {</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        ave = intcpt / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        <span class="keywordflow">if</span> (ave &gt; 1.3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;        <span class="keywordflow">if</span> (ave &lt; 0.77) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      }</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = intcpt;</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">fChgSlp</a> = slope;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    }</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  } <span class="comment">// fitchg</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d8b5b5bd07dd6eae241251eb585b174"> 4523</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d8b5b5bd07dd6eae241251eb585b174">ClusterCrawlerAlg::AddLAHit</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kwire, <span class="keywordtype">bool</span>&amp; ChkCharge, <span class="keywordtype">bool</span>&amp; HitOK, <span class="keywordtype">bool</span>&amp; SigOK)</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;  {</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    <span class="comment">// A variant of AddHit for large angle clusters</span></div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    HitOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    <span class="comment">// not in the range of wires with hits</span></div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    <span class="keywordflow">if</span> (kwire &lt; fFirstWire || kwire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    <span class="comment">// skip bad wire and assume the track was there</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) {</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;      SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    }</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    <span class="comment">// return SigOK false if no hit on a good wire</span></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].first;</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].second;</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;    <span class="comment">// max allowable time difference between projected cluster and a hit</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    <span class="keywordtype">float</span> timeDiff = 40 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]);</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <span class="keywordtype">float</span> dtime;</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    <span class="comment">// the last hit added to the cluster</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastClHit = UINT_MAX;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 0) {</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;      lastClHit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;      <span class="keywordflow">if</span> (lastClHit == 0) {</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].Integral();</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].StartTick();</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;      }</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;    } <span class="comment">// fcl2hits.size() &gt; 0</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;    <span class="comment">// the projected time of the cluster on this wire</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    <span class="keywordtype">float</span> prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + ((float)kwire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2]) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;    <span class="keywordtype">float</span> chgWinLo = prtime - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">fChgNearWindow</a>;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="keywordtype">float</span> chgWinHi = prtime + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">fChgNearWindow</a>;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    <span class="keywordtype">float</span> chgrat, hitWidth;</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    <span class="keywordtype">float</span> hitWidthCut = 0.5 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a>;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;    <span class="keywordtype">float</span> cnear = 0;</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;    <span class="comment">//    float fom;</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;AddLAHit: wire &quot;</span> &lt;&lt; kwire &lt;&lt; <span class="stringliteral">&quot; prtime &quot;</span> &lt;&lt; prtime</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; max timeDiff &quot;</span> &lt;&lt; timeDiff &lt;&lt; <span class="stringliteral">&quot; fAveChg &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> imbest = 0;</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> khit;</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    <span class="keywordflow">for</span> (khit = firsthit; khit &lt; lasthit; ++khit) {</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      <span class="comment">// obsolete hit?</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;      dtime = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() - prtime);</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      hitWidth = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].StartTick();</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      chgrat = 1;</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;      <span class="keywordflow">if</span> (ChkCharge &amp;&amp; fAveChg &gt; 0) { chgrat = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral() / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>; }</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Chk W:T &quot;</span> &lt;&lt; kwire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (short)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime()</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; dT &quot;</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; dtime &lt;&lt; <span class="stringliteral">&quot; InClus &quot;</span></div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &lt;&lt; <span class="stringliteral">&quot; mult &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Multiplicity() &lt;&lt; <span class="stringliteral">&quot; width &quot;</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                              &lt;&lt; (int)hitWidth &lt;&lt; <span class="stringliteral">&quot; MergeAvail &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[khit] &lt;&lt; <span class="stringliteral">&quot; Chi2 &quot;</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                              &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].GoodnessOfFit()</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; Charge &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral() &lt;&lt; <span class="stringliteral">&quot; chgrat &quot;</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                              &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; chgrat &lt;&lt; <span class="stringliteral">&quot; index &quot;</span> &lt;&lt; khit;</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;      <span class="comment">// count charge in the window</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() &gt; chgWinLo &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() &lt; chgWinHi)</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;        cnear += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral();</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      <span class="comment">// projected time outside the Signal time window?</span></div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      <span class="keywordflow">if</span> (prtime &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>() - timeDiff) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;      <span class="keywordflow">if</span> (prtime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick() + timeDiff) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      <span class="comment">// hit used?</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      <span class="comment">// ignore narrow width hits</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      <span class="keywordflow">if</span> (hitWidth &lt; hitWidthCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      <span class="comment">// ignore very low charge hits</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      <span class="keywordflow">if</span> (chgrat &lt; 0.1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="keywordflow">if</span> (dtime &lt; timeDiff) {</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;        HitOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        imbest = khit;</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;        timeDiff = dtime;</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      }</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    } <span class="comment">// khit</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> &amp;&amp; !HitOK) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; no hit found &quot;</span>;</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    <span class="keywordflow">if</span> (!HitOK) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Pick hit time &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].PeakTime() &lt;&lt; <span class="stringliteral">&quot; hit index &quot;</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;                            &lt;&lt; imbest;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;    <span class="comment">// merge hits in a multiplet?</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;    <span class="keywordtype">short</span> hnear = 0;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;    <span class="keywordflow">if</span> (lastClHit != UINT_MAX &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Multiplicity() &gt; 1) {</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      <span class="keywordtype">bool</span> doMerge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      <span class="comment">// Standard code</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;      <span class="comment">// don&#39;t merge if we are close to a vertex</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; close vtx chk W:T &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                                &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time;</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(kwire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire) &lt; 5 &amp;&amp;</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;            <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<span class="keywordtype">int</span>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time)) &lt; 20) {</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Close to a vertex. Don&#39;t merge hits&quot;</span>;</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;          doMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;        }</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      } <span class="comment">// ivx</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      <span class="comment">// Decide which hits in the multiplet to merge. Hits that are well</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;      <span class="comment">// separated from each other should not be merged</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <span class="keywordflow">if</span> (doMerge) {</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nused = 0;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;        <span class="comment">// the total charge of the hit multiplet</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;        <span class="keywordtype">float</span> multipletChg = 0.;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;        <span class="keywordtype">float</span> chicut = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1]) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].RMS();</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;        <span class="comment">// look for a big separation between adjacent hits</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;        std::pair&lt;size_t, size_t&gt; MultipletRange = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc">FindHitMultiplet</a>(imbest);</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jht = MultipletRange.first; jht &lt; MultipletRange.second; ++jht) {</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[jht] == 0)</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;            multipletChg += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].Integral();</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;            ++nused;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;          <span class="comment">// check the neighbor hit separation</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;          <span class="keywordflow">if</span> (jht &gt; MultipletRange.first) {</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            <span class="comment">// pick the larger RMS of the two hits</span></div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;            <span class="keywordtype">float</span> hitRMS = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].RMS();</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht - 1].RMS() &gt; hitRMS) hitRMS = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht - 1].RMS();</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d8/d23/CookedFrameSource_8cxx.html#a7c7963b26e5294dacb6d0a28006b069c">tdiff</a> =</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;              <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht - 1].PeakTime()) / hitRMS;</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Hit RMS chisq &quot;</span> &lt;&lt; tdiff &lt;&lt; <span class="stringliteral">&quot; chicut &quot;</span> &lt;&lt; chicut;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            <span class="keywordflow">if</span> (tdiff &gt; chicut) doMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;          } <span class="comment">// jht &gt; 0</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;        }   <span class="comment">// jht</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;          <span class="keywordflow">if</span> (!doMerge) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Hits are well separated. Don&#39;t merge them &quot;</span>;</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;        }</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;        <span class="keywordflow">if</span> (doMerge &amp;&amp; nused == 0) {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;          <span class="comment">// compare the charge with the last hit added?</span></div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;          <span class="keywordflow">if</span> (ChkCharge) {</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;            <span class="comment">// there is a nearby hit</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;            hnear = 1;</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;            <span class="keywordtype">float</span> chgrat = multipletChg / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].Integral();</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; merge hits charge check &quot;</span> &lt;&lt; (int)multipletChg</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot; Previous hit charge &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].Integral();</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;            <span class="keywordflow">if</span> (chgrat &gt; 2) doMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;          }</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;        } <span class="comment">// doMerge &amp;&amp; nused == 0</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;      }   <span class="comment">// doMerge true</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <span class="keywordflow">if</span> (doMerge) {</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        <span class="comment">// there is a nearby hit and it will be merged</span></div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;        hnear = -1;</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;        <span class="keywordtype">bool</span> didMerge;</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(imbest, didMerge);</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;      } <span class="comment">// doMerge</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    }   <span class="comment">// Hits[imbest].Multiplicity() &gt; 1</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;    <span class="comment">// attach to the cluster and fit</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(imbest);</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a>);</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.push_back(hnear);</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;    <span class="comment">// remove the charge of the just added hit</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    cnear -= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral();</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="keywordflow">if</span> (cnear &lt; 0) cnear = 0;</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    <span class="comment">// divide by the just added hit charge</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;    cnear /= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral();</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.push_back(cnear);</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;      hitWidth = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].EndTick() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].StartTick();</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; &gt;&gt;LADD&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(imbest) &lt;&lt; <span class="stringliteral">&quot; dT &quot;</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;                            &lt;&lt; timeDiff &lt;&lt; <span class="stringliteral">&quot; clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; Chg &quot;</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;                            &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral() &lt;&lt; <span class="stringliteral">&quot; AveChg &quot;</span> &lt;&lt; (int)fAveChg</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; width &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)hitWidth &lt;&lt; <span class="stringliteral">&quot; AveWidth &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; fcl2hits size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;    } <span class="comment">// prt</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;    <span class="comment">// decide what to do with a bad fit</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">fChiCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">FclTrimUS</a>(1);</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      HitOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;   LADD- Removed bad hit. Stopped tracking&quot;</span>;</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;    }</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;  } <span class="comment">// AddLAHit()</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l04715"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7e9e16248480f63fb64be2666252620"> 4715</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7e9e16248480f63fb64be2666252620">ClusterCrawlerAlg::ClusterHitsOK</a>(<span class="keywordtype">short</span> nHitChk)</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;  {</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    <span class="comment">// Check StartTick and EndTick of hits on adjacent wires overlap as illustrated below.</span></div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;    <span class="comment">// &gt;&gt;&gt;&gt;&gt;&gt; This is OK</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;    <span class="comment">// Wire StartTick    EndTick</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;    <span class="comment">// n    |--------------|</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;    <span class="comment">// n+1              |--------------|</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;    <span class="comment">// n+2                        |--------------|</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    <span class="comment">// &gt;&gt;&gt;&gt;&gt;&gt; This is NOT OK</span></div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    <span class="comment">// n    |------|</span></div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    <span class="comment">// n+1              |-----|</span></div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;    <span class="comment">// n+2                        |------|</span></div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nHitToChk = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="keywordflow">if</span> (nHitChk &gt; 0) nHitToChk = nHitChk + 1;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, indx;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <span class="comment">// require that they overlap</span></div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    <span class="comment">// add a tolerance to the StartTick - EndTick overlap</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    <a class="code" href="../../d9/d63/namespaceraw.html#abcbf8ba50ca9efdbeb1a6955b040b4fe">raw::TDCtick_t</a> <a class="code" href="../../da/da0/SurfXYZTest_8cc.html#a352dc2abeda5f913ed16b48bbdcde948">tol</a> = 30;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;    <span class="comment">// expand the tolerance for induction planes</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    <span class="keywordflow">if</span> (plane &lt; geom-&gt;Cryostat(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>).<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>).Nplanes() - 1) tol = 40;</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;    <span class="keywordtype">bool</span> posSlope =</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0]].PeakTime() &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1]].PeakTime());</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; nHitToChk; ++ii) {</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;        indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii;</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ClusterHitsOK chk &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].WireID().Wire</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; start &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].StartTick() &lt;&lt; <span class="stringliteral">&quot; peak &quot;</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].PeakTime() &lt;&lt; <span class="stringliteral">&quot; end &quot;</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].EndTick() &lt;&lt; <span class="stringliteral">&quot; posSlope &quot;</span> &lt;&lt; posSlope;</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      }</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;    }</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;    <a class="code" href="../../d9/d63/namespaceraw.html#abcbf8ba50ca9efdbeb1a6955b040b4fe">raw::TDCtick_t</a> hiStartTick, loEndTick;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; nHitToChk - 1; ++ii) {</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      <span class="comment">// ignore if not on adjacent wires</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d72/namespaceutil.html#aaae39c2a7066e6a24ff172e5471939ae">util::absDiff</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire,</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx - 1]].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire) &gt; 1)</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;      hiStartTick =</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;        <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx - 1]].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>());</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      loEndTick = std::min(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx]].EndTick(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx - 1]].EndTick());</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;      <span class="keywordflow">if</span> (posSlope) {</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;        <span class="keywordflow">if</span> (loEndTick + tol &lt; hiStartTick) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;      }</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;        <span class="keywordflow">if</span> (loEndTick + tol &lt; hiStartTick) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;      }</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;  } <span class="comment">// ClusterHitsOK</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aceda5036373484fcba4632e8426b436d"> 4775</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aceda5036373484fcba4632e8426b436d">ClusterCrawlerAlg::AddHit</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kwire, <span class="keywordtype">bool</span>&amp; HitOK, <span class="keywordtype">bool</span>&amp; SigOK)</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;  {</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;    <span class="comment">// Add a hit to the cluster if it meets several criteria:</span></div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;    <span class="comment">// similar pulse height to the cluster (if fAveChg is defined)</span></div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    <span class="comment">// closest hit to the project cluster position.</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    <span class="comment">// Return SigOK if there is a nearby hit that was missed due to the cuts</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    HitOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="comment">// not in the range of wires with hits</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    <span class="keywordflow">if</span> (kwire &lt; fFirstWire || kwire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastClHit = UINT_MAX;</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &gt; 0) lastClHit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;    <span class="comment">// the last hit added to the cluster</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire0 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2];</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;    <span class="comment">// return if no signal and no hit</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a> == 0) {</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;    }</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      <span class="comment">// allow a number of wires with no hits</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -2 &amp;&amp; (wire0 - kwire) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a>) {</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;        SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;      }</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;    }</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;    <span class="comment">// skip bad wire, but assume the track was there</span></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) {</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;      SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;    }</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].first;</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[kwire].second;</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;    <span class="comment">// the projected time of the cluster on this wire</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    <span class="keywordtype">float</span> dw = (float)kwire - (<span class="keywordtype">float</span>)wire0;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;    <span class="keywordtype">float</span> prtime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0] + dw * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    <span class="keywordflow">if</span> (prtime &lt; 0 || (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)prtime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a60e232284fc5fc90b2a13e9b4b13732e">fMaxTime</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;    <span class="comment">// Find the projected time error including the projection error and the</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;    <span class="comment">// error from the last hit added</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;    <span class="keywordtype">float</span> prtimerr2 = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dw) * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1] * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    <span class="comment">// apply an angle dependent scale factor to the hit error. Default is very large error</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;    <span class="keywordtype">float</span> hiterr = 10;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;    <span class="keywordflow">if</span> (lastClHit != UINT_MAX) hiterr = 3 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].RMS();</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a> = std::sqrt(prtimerr2 + hiterr * hiterr);</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    <span class="comment">// Time window for accepting a hit.</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;    <span class="keywordtype">float</span> hitWin = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1dfffb608e5fb454826dd6d0c761cde">fClProjErrFac</a> * <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a>;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;    <span class="keywordtype">float</span> prtimeLo = prtime - hitWin;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    <span class="keywordtype">float</span> prtimeHi = prtime + hitWin;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;    <span class="keywordtype">float</span> chgWinLo = prtime - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">fChgNearWindow</a>;</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    <span class="keywordtype">float</span> chgWinHi = prtime + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">fChgNearWindow</a>;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) {</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;AddHit: wire &quot;</span> &lt;&lt; kwire &lt;&lt; <span class="stringliteral">&quot; prtime Lo &quot;</span> &lt;&lt; (int)prtimeLo</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; prtime &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)prtime &lt;&lt; <span class="stringliteral">&quot; Hi &quot;</span> &lt;&lt; (int)prtimeHi &lt;&lt; <span class="stringliteral">&quot; prtimerr &quot;</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;                            &lt;&lt; sqrt(prtimerr2) &lt;&lt; <span class="stringliteral">&quot; hiterr &quot;</span> &lt;&lt; hiterr &lt;&lt; <span class="stringliteral">&quot; fAveChg &quot;</span></div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;                            &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &lt;&lt; <span class="stringliteral">&quot; fAveHitWidth &quot;</span> &lt;&lt; std::setprecision(3)</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                            &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a>;</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    }</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    <span class="comment">// loop through the hits</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> imbest = INT_MAX;</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    <span class="keywordtype">float</span> best = 9999., dtime;</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="keywordtype">float</span> cnear = 0;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;    <span class="keywordtype">float</span> hitTime, hitChg, hitStartTick, hitEndTick;</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> khit = firsthit; khit &lt; lasthit; ++khit) {</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      <span class="comment">// obsolete hit?</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      hitTime = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime();</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      dtime = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hitTime - prtime);</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <span class="keywordflow">if</span> (dtime &gt; 1000) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      hitStartTick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].StartTick();</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      hitEndTick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick();</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      <span class="comment">// weight by the charge difference</span></div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &gt; 0) dtime *= <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>) / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dtime) &lt; 100) {</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Chk W:T &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(khit) &lt;&lt; <span class="stringliteral">&quot; dT &quot;</span> &lt;&lt; std::fixed</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                              &lt;&lt; std::setprecision(1) &lt;&lt; (hitTime - prtime) &lt;&lt; <span class="stringliteral">&quot; InClus &quot;</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &lt;&lt; <span class="stringliteral">&quot; mult &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Multiplicity() &lt;&lt; <span class="stringliteral">&quot; RMS &quot;</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;                              &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].RMS() &lt;&lt; <span class="stringliteral">&quot; Chi2 &quot;</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                              &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].GoodnessOfFit()</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; Charge &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral() &lt;&lt; <span class="stringliteral">&quot; Peak &quot;</span> &lt;&lt; std::fixed</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                              &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakAmplitude() &lt;&lt; <span class="stringliteral">&quot; LoT &quot;</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                              &lt;&lt; (int)hitStartTick &lt;&lt; <span class="stringliteral">&quot; HiT &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)hitEndTick &lt;&lt; <span class="stringliteral">&quot; index &quot;</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                              &lt;&lt; khit;</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;      }</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      <span class="comment">// count charge in the window</span></div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>() &gt; chgWinLo &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick() &lt; chgWinHi)</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;        cnear += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].Integral();</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;      <span class="comment">// check for signal</span></div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;      <span class="keywordflow">if</span> (prtimeHi &lt; hitStartTick) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;      <span class="keywordflow">if</span> (prtimeLo &gt; hitEndTick) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;      SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;      <span class="comment">// check for good hit</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      <span class="keywordflow">if</span> (hitTime &lt; prtimeLo) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="keywordflow">if</span> (hitTime &gt; prtimeHi) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="comment">// hit used?</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      <span class="keywordflow">if</span> (dtime &lt; best) {</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;        best = dtime;</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        imbest = khit;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      }</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;    } <span class="comment">// khit</span></div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;    <span class="keywordflow">if</span> (!SigOK) {</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; wire0 &quot;</span> &lt;&lt; wire0 &lt;&lt; <span class="stringliteral">&quot; kwire &quot;</span> &lt;&lt; kwire &lt;&lt; <span class="stringliteral">&quot; max &quot;</span></div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a> &lt;&lt; <span class="stringliteral">&quot; imbest &quot;</span> &lt;&lt; imbest;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;      <span class="keywordflow">if</span> ((wire0 - kwire) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">fAllowNoHitWire</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      SigOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    }</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    <span class="keywordflow">if</span> (imbest == INT_MAX) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest];</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;    hitChg = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>();</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Best hit time &quot;</span> &lt;&lt; (int)hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;    <span class="keywordtype">short</span> hnear = 0;</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;    <span class="comment">// merge hits in a doublet?</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;    <span class="keywordtype">bool</span> didMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    <span class="keywordflow">if</span> (lastClHit != UINT_MAX &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">fAveHitWidth</a> &gt; 0 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a> &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>() == 2) {</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="keywordtype">bool</span> doMerge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(kwire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire) &lt; 10 &amp;&amp;</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;            <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<span class="keywordtype">int</span>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time)) &lt; 20) {</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;          doMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;        }</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;      } <span class="comment">// ivx</span></div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;      <span class="comment">// quit if localindex does not make sense.</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>() != 0 &amp;&amp; imbest == 0) doMerge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;      <span class="keywordflow">if</span> (doMerge) {</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;        <span class="comment">// find the neighbor hit</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> oht;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;        <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>() == 0) { oht = imbest + 1; }</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;          oht = imbest - 1;</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;        } <span class="comment">// hit.LocalIndex() == 0</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;        <span class="comment">// check the hit time separation</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;        <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; other_hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[oht];</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;        <span class="keywordtype">float</span> hitSep = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>());</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;        hitSep /= hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>();</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;        <span class="comment">// check the the charge similarity</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;        <span class="keywordtype">float</span> totChg = hitChg + other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>();</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;        <span class="keywordtype">float</span> lastHitChg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;        <span class="keywordflow">if</span> (lastHitChg &lt; 0) lastHitChg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].Integral();</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        hnear = 1;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Chk hit merge hitsep &quot;</span> &lt;&lt; hitSep &lt;&lt; <span class="stringliteral">&quot; dChg &quot;</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(totChg - lastHitChg) &lt;&lt; <span class="stringliteral">&quot; Cut &quot;</span></div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">Integral</a>() - lastHitChg);</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[oht] == 0 &amp;&amp; hitSep &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a>) {</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Merging hit doublet &quot;</span> &lt;&lt; imbest;</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(imbest, didMerge);</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a> &amp;&amp; !didMerge) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Hit merge failed &quot;</span>;</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;        } <span class="comment">// not in a cluster, hitSep OK, total charge OK</span></div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;      }   <span class="comment">// doMerge</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;    }     <span class="comment">// fHitMergeChiCut &gt; 0 &amp;&amp; hit.Multiplicity() == 2</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;    <span class="comment">// Make a charge similarity cut if the average charge is defined</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;    <span class="keywordtype">bool</span> fitChg = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &gt; 0.) {</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      <span class="keywordtype">float</span> chgrat = (hitChg - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>) / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Chgrat &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; chgrat;</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      <span class="comment">// charge is way too high?</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <span class="keywordflow">if</span> (chgrat &gt; 3 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]) {</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; fails 3 x high charge cut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>] &lt;&lt; <span class="stringliteral">&quot; on pass &quot;</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                                &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>;</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;      }</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <span class="comment">// Determine if the last hit added was a large (low) charge hit</span></div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      <span class="comment">// This will be used to prevent adding large (low) charge hits on two</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      <span class="comment">// consecutive fits. This cut is only applied to hits on adjacent wires</span></div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <span class="keywordtype">float</span> bigchgcut = 1.5 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>];</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;      <span class="keywordtype">bool</span> lasthitbig = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;      <span class="keywordtype">bool</span> lasthitlow = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;      <span class="keywordflow">if</span> (lastClHit != UINT_MAX &amp;&amp; <a class="code" href="../../d6/d72/namespaceutil.html#aaae39c2a7066e6a24ff172e5471939ae">util::absDiff</a>(wire0, kwire) == 1) {</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        <span class="keywordtype">float</span> lastchgrat = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[lastClHit].Integral() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>) / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        lasthitbig = (lastchgrat &gt; bigchgcut);</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;        lasthitlow = (lastchgrat &lt; -<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a>]);</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      }</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      <span class="comment">// the last hit added was low charge and this one is as well</span></div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;      <span class="keywordflow">if</span> (lasthitlow &amp;&amp; chgrat &lt; -<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[pass]) {</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; fails low charge cut. Stop crawling.&quot;</span>;</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;        SigOK = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      } <span class="comment">// lasthitlow</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;      <span class="comment">// the last hit was high charge and this one is also</span></div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      <span class="keywordflow">if</span> (lasthitbig &amp;&amp; chgrat &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[pass]) {</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; fails 2nd hit high charge cut. Last hit was high also. &quot;</span>;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      } <span class="comment">// lasthitbig</span></div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <span class="comment">// require that large charge hits have a very good projection error</span></div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      <span class="keywordflow">if</span> (chgrat &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[pass]) {</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;        <span class="keywordflow">if</span> (best &gt; 2 * err) {</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; high charge &amp;&amp; bad dT= &quot;</span> &lt;&lt; best &lt;&lt; <span class="stringliteral">&quot; err= &quot;</span> &lt;&lt; <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a>;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;        }</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      } <span class="comment">// chgrat &gt; fChgCut[pass]</span></div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="comment">// decide whether to fit the charge</span></div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      fitChg = (chgrat &lt; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">fChgCut</a>[pass]));</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    } <span class="comment">// fAveChg &gt; 0</span></div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;    <span class="comment">// we now have a hit that meets all the criteria. Fit it</span></div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.push_back(imbest);</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    <span class="comment">// This is strictly only necessary when calling AddHit for seed clusters</span></div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 3) std::sort(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.begin(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.end(), <a class="code" href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">SortByLowHit</a>);</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">chifits</a>.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a>);</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.push_back(hnear);</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;    <span class="comment">// remove the charge of the just added hit</span></div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;    cnear -= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral();</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;    <span class="keywordflow">if</span> (cnear &lt; 0) cnear = 0;</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;    <span class="comment">// divide by the just added hit charge</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    cnear /= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral();</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.push_back(cnear);</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;    <span class="comment">// nearby hit check</span></div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;    <span class="comment">//    ChkClusterNearbyHits(prt);</span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    HitOK = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">chgNear</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) {</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;AddHit: Bad length&quot;</span>;</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;    }</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>)</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; &gt;&gt;ADD&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">pass</a> &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">PrintHit</a>(imbest) &lt;&lt; <span class="stringliteral">&quot; dT &quot;</span> &lt;&lt; best</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; clChisq &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">clChisq</a> &lt;&lt; <span class="stringliteral">&quot; Chg &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[imbest].Integral()</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; AveChg &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a> &lt;&lt; <span class="stringliteral">&quot; fcl2hits size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size();</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;    <span class="keywordflow">if</span> (!fitChg) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">prt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; Fit charge &quot;</span>;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;  } <span class="comment">// AddHit()</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05030"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a864bf658e09ffad9486e03e50fcc7f12"> 5030</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a864bf658e09ffad9486e03e50fcc7f12">ClusterCrawlerAlg::ChkClusterNearbyHits</a>(<span class="keywordtype">bool</span> prt)</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;  {</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    <span class="comment">// analyze the hitnear vector</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="comment">//  0 = no nearby hit exists</span></div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    <span class="comment">//  1 = a nearby hit exists but was not merged</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;    <span class="comment">// -1 = a nearby hit was merged</span></div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a> &lt;= 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.size() != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size()) {</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Coding error: hitNear size != fcl2hits&quot;</span>;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;    }</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;    <span class="comment">// Analyze the last 6 hits added but don&#39;t consider the first few hits</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.size() &lt; 12) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="comment">// TODO move into loops</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, indx;</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> merged = 0;</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> notmerged = 0;</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; 6; ++ii) {</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>.size() - 1 - ii;</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>[indx] &gt; 0) ++notmerged;</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>[indx] &lt; 0) ++merged;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;    }</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;    <span class="keywordflow">if</span> (prt)</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterNearbyHits: nearby hits merged &quot;</span> &lt;&lt; merged</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; not merged &quot;</span> &lt;&lt; notmerged;</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    <span class="keywordflow">if</span> (notmerged &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;    <span class="comment">// a number of nearby hits were not merged while crawling, so the</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;    <span class="comment">// average charge is probably wrong. Look at the last 6 hits added</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;    <span class="comment">// and merge them if they are close</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;    <span class="keywordtype">bool</span> didMerge;</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; 6; ++ii) {</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1 - ii;</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[indx];</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht];</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">Multiplicity</a>() == 2) {</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        <span class="comment">// quit if localindex does not make sense.</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;        <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>() != 0 &amp;&amp; iht == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;        <span class="comment">// hit doublet. Get the index of the other hit</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> oht;</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        <span class="keywordflow">if</span> (hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">LocalIndex</a>() == 0) { oht = iht + 1; }</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;          oht = iht - 1;</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;        } <span class="comment">// hit.LocalIndex() == 0</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;        <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; other_hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[oht];</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;        <span class="comment">// TODO use Hit::TimeDistanceAsRMS()</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <span class="keywordtype">float</span> hitSep = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>() - other_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>());</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;        hitSep /= hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">RMS</a>();</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;        <span class="keywordflow">if</span> (hitSep &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a> &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[oht] == 0) {</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;          <span class="keywordflow">if</span> (prt)</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Merging hit doublet &quot;</span> &lt;&lt; iht &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime();</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(iht, didMerge);</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;          <span class="keywordflow">if</span> (didMerge) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">hitNear</a>[indx] = -1;</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        } <span class="comment">// hitSep OK and not in a cluster</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      }   <span class="comment">// hit doublet</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    }     <span class="comment">// ii</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    <span class="comment">// now re-fit</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">FitCluster</a>();</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">FitClusterChg</a>();</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    <span class="keywordflow">if</span> (prt) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ChkClusterNearbyHits refit cluster. fAveChg= &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">fAveChg</a>;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;  } <span class="comment">// ChkClusterHitNear()</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60"> 5104</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">ClusterCrawlerAlg::FitVtx</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv)</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;  {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    std::vector&lt;float&gt; <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    std::vector&lt;float&gt; ey2;</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;    <span class="keywordtype">float</span> arg;</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;    <span class="comment">// don&#39;t fit fixed vertices</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Fixed) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    <span class="comment">// Set this large in case something bad happens</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF = 99;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;    <span class="comment">// make a list of clusters</span></div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl;</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;    std::vector&lt;unsigned short&gt; vcl;</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    <span class="keywordflow">for</span> (icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == iv) vcl.push_back(icl);</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == iv) vcl.push_back(icl);</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;    }</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].NClusters = vcl.size();</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;    <span class="keywordflow">if</span> (vcl.size() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    <span class="comment">// don&#39;t let the time error be less than the expected</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;    <span class="comment">// time error of hits on a cluster. This is crude by</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;    <span class="comment">// probably good enough</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;    icl = vcl[0];</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() - 1;</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[indx];</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    <span class="keywordtype">float</span> minTimeErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].RMS() * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Multiplicity();</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    <span class="keywordflow">if</span> (vcl.size() == 1) {</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      icl = vcl[0];</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;      <span class="comment">// Put the vertex at the appropriate end of the cluster</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == iv) {</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr = 1;</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;        <span class="comment">// set the vertex time error to the hit error used for fitting</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;        indx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size() - 1;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;        hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[indx];</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].RMS() * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Multiplicity();</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF = 0;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      }</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == iv) {</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr = 1;</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        <span class="comment">// set the vertex time error to the hit error used for fitting</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;        hit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[0];</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">fHitErrFac</a> * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].RMS() * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>].Multiplicity();</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF = 0;</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;      }</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    } <span class="comment">// size 1</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    std::vector&lt;double&gt; slps;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    std::vector&lt;double&gt; slperrs;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; vcl.size(); ++ii) {</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;      icl = vcl[ii];</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == iv) {</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;        x.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp);</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;        slps.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp);</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;        slperrs.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr);</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;        arg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;        y.push_back(arg);</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr &gt; 0.) { arg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir; }</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;          arg = .1 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;        }</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        ey2.push_back(arg * arg);</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      }</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == iv) {</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;        x.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp);</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;        slps.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp);</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;        slperrs.push_back(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr);</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;        arg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;        y.push_back(arg);</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr &gt; 0.) { arg = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir; }</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;          arg = .1 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;        }</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        ey2.push_back(arg * arg);</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      }</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    } <span class="comment">// ii</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    <span class="keywordflow">if</span> (x.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    <span class="comment">// calculate error</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <span class="keywordtype">double</span> sumerr = 0, cnt = 0;</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; slps.size() - 1; ++ii) {</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = ii + 1; jj &lt; slps.size(); ++jj) {</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;        arg = std::min(slperrs[ii], slperrs[jj]);</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;        arg /= (slps[ii] - slps[jj]);</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;        sumerr += arg * arg;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;        ++cnt;</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      } <span class="comment">// jj</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;    }   <span class="comment">// ii</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;    sumerr /= cnt;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;    <span class="keywordtype">float</span> vTime = 0.;</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    <span class="keywordtype">float</span> vTimeErr = 0.;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    <span class="keywordtype">float</span> vWire = 0.;</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    <span class="keywordtype">float</span> vWireErr = 0.;</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="keywordtype">float</span> chiDOF;</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad77499d15ed8cec5c6fc0fd327c0c96e">fLinFitAlg</a>.<a class="code" href="../../dc/d6a/classtrkf_1_1LinFitAlg.html#a113ec78487fa649f3dc86f711b99a1ca">LinFit</a>(x, y, ey2, vTime, vWire, vTimeErr, vWireErr, chiDOF);</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <span class="keywordflow">if</span> (chiDOF &gt; 900) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    vTime = -vTime;</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;    <span class="comment">// a crazy time from the fit?</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    <span class="keywordflow">if</span> (vTime &lt; 0 || vTime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a60e232284fc5fc90b2a13e9b4b13732e">fMaxTime</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;    <span class="comment">// a crazy wire from the fit?</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> iplID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a66a8ca741d5d163713ed6e6548b9716b">DecodeCTP</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].CTP);</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    <span class="keywordflow">if</span> (vWire &lt; 0 || vWire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;Nwires(iplID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, iplID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, iplID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].ChiDOF = chiDOF;</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Wire = vWire;</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].Time = vTime;</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr = vWire * sqrt(sumerr);</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr = vTime * fabs(sumerr);</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    <span class="comment">// set minimum wire error</span></div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr &lt; 1) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].WireErr = 2;</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="comment">// set minimum time error</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr &lt; minTimeErr) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[iv].TimeErr = minTimeErr;</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;  } <span class="comment">// FitVtx</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6397333745b8677560d1d884f0446dd"> 5234</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6397333745b8677560d1d884f0446dd">ClusterCrawlerAlg::Vtx3ClusterMatch</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clock_data,</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;                                      <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; det_prop,</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                                      <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;  {</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;    <span class="comment">// Look for clusters that end/begin near the expected wire/time</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;    <span class="comment">// for incomplete 3D vertices</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a> = tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a> = tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> thePlane, theWire;</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;    <span class="keywordtype">float</span> theTime;</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;    <span class="keywordtype">int</span> dwb, dwe;</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size(); ++ivx) {</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      <span class="comment">// A complete 3D vertex with matching 2D vertices in all planes?</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].CStat != cstat || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> != tpc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;      <span class="comment">// Find the plane that is missing a 2D vertex</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      thePlane = 3;</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;      theWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> = 0; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt; 3; ++<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>) {</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        thePlane = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>;</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;      } <span class="comment">// plane</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;      <span class="keywordflow">if</span> (thePlane &gt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      theTime = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>, thePlane, tpc, cstat);</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">EncodeCTP</a>(cstat, tpc, thePlane);</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;      <span class="comment">// Create a new 2D vertex and see how many clusters we can attach to it</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      <a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">VtxStore</a> vnew;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = theWire;</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = theTime;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = 7;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">Fixed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(vnew);</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      std::vector&lt;short&gt; vclIndex;</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = 0; icl &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++icl) {</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;        dwb = <a class="code" href="../../d6/d72/namespaceutil.html#aaae39c2a7066e6a24ff172e5471939ae">util::absDiff</a>(theWire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir);</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;        dwe = <a class="code" href="../../d6/d72/namespaceutil.html#aaae39c2a7066e6a24ff172e5471939ae">util::absDiff</a>(theWire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir);</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        <span class="comment">// rough cut to start</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;        <span class="keywordflow">if</span> (dwb &gt; 10 &amp;&amp; dwe &gt; 10) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        <span class="keywordflow">if</span> (dwb &lt; dwe &amp;&amp; dwb &lt; 10 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx &lt; 0) {</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;          <span class="comment">// cluster begin is closer</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;          <span class="keywordflow">if</span> (theWire &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir + 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 0, ivnew) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = ivnew;</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;          vclIndex.push_back(icl);</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        }</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dwe &lt; 10 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx &lt; 0) {</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;          <span class="comment">// cluster end is closer</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;          <span class="keywordflow">if</span> (theWire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir - 5) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterVertexChi</a>(icl, 1, ivnew) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = ivnew;</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;          vclIndex.push_back(icl);</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        } <span class="comment">// dwb/dwe check</span></div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;      }   <span class="comment">// icl</span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;      <span class="keywordtype">bool</span> goodVtx = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <span class="keywordflow">if</span> (vclIndex.size() &gt; 0) {</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(ivnew);</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;        goodVtx = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivnew].ChiDOF &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>);</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[thePlane] = ivnew;</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      }</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;      <span class="keywordflow">if</span> (goodVtx) {</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[thePlane] = ivnew;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire = -1;</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      }</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;        <span class="comment">// clobber the vertex</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; vclIndex.size(); ++ii) {</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl = vclIndex[ii];</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx == ivnew) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = -99;</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx == ivnew) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = -99;</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;        } <span class="comment">// ii</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;      }</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;  }   <span class="comment">// Vtx3ClusterMatch</span></div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac17d630dff6f8fe5a70627fa425abdcc"> 5320</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac17d630dff6f8fe5a70627fa425abdcc">ClusterCrawlerAlg::Vtx3ClusterSplit</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clock_data,</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;                                      <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; det_prop,</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                                      <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;  {</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="comment">// Try to split clusters in a view in which there is no 2D vertex</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    <span class="comment">// assigned to a 3D vertex</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a> = tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a> = tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &gt;= 0) &amp;&amp; (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> == 6666);</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lastplane = 5, kcl, kclID;</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;    <span class="keywordtype">float</span> dth, theTime;</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> thePlane, theWire, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>;</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loWire, hiWire;</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size(); ++ivx) {</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].CStat != cstat || <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> != tpc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      <span class="comment">// Complete 3D vertex with matching 2D vertices in all planes?</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Vtx3ClusterSplit ivx &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; Ptr2D &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[0]</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[2] &lt;&lt; <span class="stringliteral">&quot; wire &quot;</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire;</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;      <span class="comment">// find the plane that needs to be studied</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;      thePlane = 3;</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      theWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire;</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;      <span class="keywordflow">for</span> (plane = 0; plane &lt; 3; ++<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>) {</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[plane] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;        thePlane = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>;</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;      } <span class="comment">// plane</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;      <span class="keywordflow">if</span> (thePlane &gt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;      theTime = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;        (<span class="keywordtype">double</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>, (<span class="keywordtype">int</span>)thePlane, (<span class="keywordtype">int</span>)tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, (<span class="keywordtype">int</span>)tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;      <span class="comment">// get the hit range if necessary</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;      <span class="keywordflow">if</span> (thePlane != lastplane) {</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">EncodeCTP</a>(tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>, tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, thePlane);</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d9ae2c8c6032bfe26f87f1a8cdaa35c">GetHitRange</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>);</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;        lastplane = thePlane;</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;      }</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;      <span class="comment">// make a list of clusters that have hits near this point on nearby wires</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      std::vector&lt;short&gt; clIDs;</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;      <span class="keywordflow">if</span> (theWire &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> + 5) { loWire = theWire - 5; }</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;        loWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a>;</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;      }</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;      <span class="keywordflow">if</span> (theWire &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a> - 5) { hiWire = theWire + 5; }</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;        hiWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a>;</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;      }</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;3DVtx &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; look for cluster hits near P:W:T &quot;</span> &lt;&lt; thePlane</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; theWire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)theTime &lt;&lt; <span class="stringliteral">&quot; Wire range &quot;</span> &lt;&lt; loWire</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; hiWire;</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire = loWire; wire &lt; hiWire; ++wire) {</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;        <span class="comment">// ignore dead wires or wires with no hits</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firsthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].first;</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lasthit = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].second;</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> khit = firsthit; khit &lt; lasthit; ++khit) {</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;          <span class="comment">// ignore obsolete and un-assigned hits</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;          <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit] &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() + 1) {</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Invalid hit InClus. &quot;</span> &lt;&lt; khit &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit];</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;          }</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;          <span class="comment">// check an expanded time range</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;          <span class="keywordflow">if</span> (theTime &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>() - 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;          <span class="keywordflow">if</span> (theTime &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].EndTick() + 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;          kclID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit];</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;          kcl = kclID - 1;</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;          <span class="comment">// ignore obsolete clusters</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;          <span class="comment">// ignore short clusters</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].tclhits.size() &lt; 6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;          <span class="comment">// ignore long straight clusters</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].tclhits.size() &gt; 100 &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].BeginAng - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].EndAng) &lt; 0.1)</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;          <span class="comment">// put the cluster in the list if it&#39;s not there already</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;            mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bingo &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; plane &quot;</span> &lt;&lt; thePlane &lt;&lt; <span class="stringliteral">&quot; wire &quot;</span> &lt;&lt; wire</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; hit &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].WireID().Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;                                  &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[khit].PeakTime() &lt;&lt; <span class="stringliteral">&quot; inClus &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">inClus</a>[khit]</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; P:W:T &quot;</span> &lt;&lt; thePlane &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].BeginWir &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;                                  &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[kcl].BeginTim;</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;          <span class="keywordflow">if</span> (std::find(clIDs.begin(), clIDs.end(), kclID) == clIDs.end()) {</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;            clIDs.push_back(kclID);</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;          } <span class="comment">// std::find</span></div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;        }   <span class="comment">// khit</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;      }     <span class="comment">// wire</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;      <span class="keywordflow">if</span> (clIDs.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; clIDs.size(); ++ii)</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; clIDs &quot;</span> &lt;&lt; clIDs[ii];</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, icl, jj;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;      <span class="keywordtype">short</span> nhitfit;</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      <span class="keywordtype">bool</span> didit;</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      <span class="comment">// find a reasonable time error using the 2D vertices that comprise this</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;      <span class="comment">// incomplete 3D vertex</span></div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;      <span class="keywordtype">float</span> tErr = 1;</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i2Dvx = 0;</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; 3; ++ii) {</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;        <span class="keywordflow">if</span> (ii == thePlane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;        i2Dvx = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[ii];</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;        <span class="keywordflow">if</span> (i2Dvx &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1) {</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Vtx3ClusterSplit: Coding error&quot;</span>;</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;        }</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[i2Dvx].TimeErr &gt; tErr) tErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[i2Dvx].TimeErr;</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      } <span class="comment">// ii -&gt; plane</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;      <span class="comment">// do a local fit near the crossing point and make a tighter cut</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; clIDs.size(); ++ii) {</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;        icl = clIDs[ii] - 1;</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;        didit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;        <span class="keywordflow">for</span> (jj = 0; jj &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++jj) {</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[jj];</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt; theWire) {</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;            nhitfit = 3;</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            <span class="keywordflow">if</span> (jj &gt; 3) nhitfit = -3;</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">FitClusterMid</a>(icl, iht, nhitfit);</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;            <span class="keywordtype">float</span> doca = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad9d2b8dd2a0bb08beb186344017c899f">DoCA</a>(-1, 1, theWire, theTime);</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; cls &quot;</span> &lt;&lt; icl &lt;&lt; <span class="stringliteral">&quot; dth &quot;</span> &lt;&lt; dth &lt;&lt; <span class="stringliteral">&quot; DoCA &quot;</span> &lt;&lt; doca &lt;&lt; <span class="stringliteral">&quot; tErr &quot;</span> &lt;&lt; tErr;</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;            <span class="keywordflow">if</span> ((doca / tErr) &gt; 2) clIDs[ii] = -1;</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;            didit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;          } <span class="comment">// fHits[iht].WireID().Wire &lt; theWire</span></div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;          <span class="keywordflow">if</span> (didit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;        } <span class="comment">// jj</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;        <span class="keywordflow">if</span> (didit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;clIDs after fit &quot;</span> &lt;&lt; clIDs.size();</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; clIDs.size(); ++ii)</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; clIDs &quot;</span> &lt;&lt; clIDs[ii];</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;      }</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;      <span class="comment">// see if any candidates remain</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nok = 0;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; clIDs.size(); ++ii)</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;        <span class="keywordflow">if</span> (clIDs[ii] &gt;= 0) ++nok;</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      <span class="keywordflow">if</span> (nok == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;      <span class="comment">// make a new 2D vertex</span></div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;      <a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">VtxStore</a> vnew;</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = theWire;</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#abd3aec0c3e72090d5ec11d217593aac8">WireErr</a> = 1;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = theTime;</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a71337b437c20a1f4c51f972a10774e68">TimeErr</a> = 1;</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = 8;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>;</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;      vnew.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">Fixed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(vnew);</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;      <span class="comment">// update the 2D -&gt; 3D vertex pointer</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Make new 2D vtx &quot;</span> &lt;&lt; ivnew &lt;&lt; <span class="stringliteral">&quot; in plane &quot;</span> &lt;&lt; thePlane</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; from 3D vtx &quot;</span> &lt;&lt; ivx;</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[thePlane] = ivnew;</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;      <span class="comment">// either split or attach clusters to this vertex</span></div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; clIDs.size(); ++ii) {</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;        <span class="keywordflow">if</span> (clIDs[ii] &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;        icl = clIDs[ii] - 1;</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;        <span class="comment">// find the split position</span></div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;        <span class="comment">// split the cluster. Find the split position</span></div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pos = 0;</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = 0; jj &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size(); ++jj) {</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;          iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits[jj];</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire &lt; theWire) {</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;            pos = jj;</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;          }</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;        } <span class="comment">// jj</span></div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;        <span class="keywordflow">if</span> (pos == 0) {</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;          <span class="comment">// vertex is DS of the cluster Begin</span></div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginVtx = ivnew;</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Attach to Begin &quot;</span> &lt;&lt; icl;</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;        }</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pos &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].tclhits.size()) {</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;          <span class="comment">// vertex is US of the cluster Eend</span></div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = ivnew;</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Attach to End &quot;</span> &lt;&lt; icl;</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;        }</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;          <span class="comment">// vertex is in the middle of the cluster</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Split cluster &quot;</span> &lt;&lt; clIDs[ii] &lt;&lt; <span class="stringliteral">&quot; at pos &quot;</span> &lt;&lt; pos;</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(icl, pos, ivnew)) {</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;SplitCluster failed&quot;</span>;</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;          }</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].ProcCode += 10000;</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() - 1].ProcCode += 10000;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;        } <span class="comment">// pos check</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;      }   <span class="comment">// ii</span></div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;      <span class="comment">// Fit the vertex position</span></div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(ivnew);</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivnew].ChiDOF &lt; 5 &amp;&amp; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivnew].WireErr &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">fVertex2DWireErrCut</a>) {</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;        <span class="comment">// mark the 3D vertex as complete</span></div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Wire = -1;</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;      }</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;          mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad vtx fit &quot;</span> &lt;&lt; ivnew &lt;&lt; <span class="stringliteral">&quot; ChiDOF &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivnew].ChiDOF</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot; WireErr &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivnew].WireErr;</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;        <span class="comment">// Recover (partially) from a bad fit. Leave the ProcCode as-is to trace this problem</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.pop_back();</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[ivx].Ptr2D[thePlane] = -1;</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;        <span class="comment">// find the cluster - vertex associations</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;        <span class="keywordflow">for</span> (jj = 0; jj &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++jj) {</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jj].BeginVtx == ivnew) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jj].BeginVtx = -99;</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jj].EndVtx == ivnew) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jj].EndVtx = -99;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;        } <span class="comment">// jj</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;      }</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  } <span class="comment">// Vtx3ClusterSplit()</span></div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05546"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5671c08bac3d9085b537dd69c3ec2f70"> 5546</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5671c08bac3d9085b537dd69c3ec2f70">ClusterCrawlerAlg::FindHammerClusters</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clock_data,</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;                                        <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; det_prop)</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;  {</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;    <span class="comment">// look for a long cluster that stops at a short cluster in two views. This can occur in a CCmu</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    <span class="comment">// interaction where two protons are emitted back-to-back and are therefore reconstructed as one cluster</span></div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;    <span class="comment">// This routine looks for this signature, and if found, splits the short clusters and creates a new 3D vertex.</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;    <span class="comment">// This routine only considers the case where the long cluster intersects the short cluster at the US (End) end.</span></div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nPln = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;Cryostat(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>).TPC(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>).Nplanes();</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;    <span class="keywordflow">if</span> (nPln != 3) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;    <span class="keywordtype">float</span> ew1, ew2, bw2, fvw;</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;    <span class="keyword">struct </span>Hammer {</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;      <span class="keywordtype">bool</span> Used;</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wire; <span class="comment">// intersection point of the long cluster and the short cluster</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;      <span class="keywordtype">float</span> Tick;        <span class="comment">// intersection point of the long cluster and the short cluster</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      <span class="keywordtype">float</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>;</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> longClIndex;</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> shortClIndex;</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> splitPos;</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;    };</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;    std::array&lt;std::vector&lt;Hammer&gt;, 3&gt; hamrVec;</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipl;</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;    <span class="keywordtype">bool</span> useit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">EncodeCTP</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, ipl);</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ic1 = 0; ic1 &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++ic1) {</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;        <span class="comment">// require a long cluster</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].tclhits.size() &lt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;        <span class="comment">// ignore long clusters with an End vertex assignment</span></div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].EndVtx &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;        ew1 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].EndWir;</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ic2 = 0; ic2 &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size(); ++ic2) {</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].ID &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;          <span class="comment">// require a short cluster</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].tclhits.size() &gt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;          <span class="comment">// but not too short cluster</span></div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].tclhits.size() &lt; 6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].CTP != <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">clCTP</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;          ew2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].EndWir;</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;          bw2 = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].BeginWir;</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;          <span class="comment">// check the US end. The End of the long cluster must lie between the Begin and End wire of the</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;          <span class="comment">// short cluster</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;          <span class="keywordflow">if</span> (ew1 &lt; ew2 || ew1 &gt; bw2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;          <span class="comment">// look for intersection of the two clusters</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;          <span class="keywordtype">float</span> best = 10;</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;          <span class="keywordtype">short</span> ibst = -1;</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> spos = 0;</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].tclhits.size(); ++ii) {</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic2].tclhits[ii];</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;            <span class="keywordtype">float</span> dw = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].EndWir;</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;            <span class="keywordtype">float</span> dt = fabs(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].EndTim - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[ic1].EndSlp * dw);</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;            <span class="keywordflow">if</span> (dt &lt; best) {</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;              best = dt;</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;              ibst = iht;</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;              spos = ii;</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;            }</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;          } <span class="comment">// ii</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;          <span class="keywordflow">if</span> (ibst &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;          fvw = 0.5 + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ibst].WireID().Wire;</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;          Hammer aHam;</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;          aHam.Used = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;          aHam.Wire = (0.5 + fvw);</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;          aHam.Tick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[ibst].PeakTime();</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;          aHam.X = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>((<span class="keywordtype">double</span>)aHam.Tick, (<span class="keywordtype">int</span>)ipl, (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>);</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;          aHam.longClIndex = ic1;</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;          aHam.shortClIndex = ic2;</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;          aHam.splitPos = spos;</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx = hamrVec[ipl].size();</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;          hamrVec[ipl].resize(indx + 1);</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;          hamrVec[ipl][indx] = aHam;</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;          useit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;        } <span class="comment">// ic2</span></div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;        <span class="keywordflow">if</span> (useit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;      } <span class="comment">// ic1</span></div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;    }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> noham = 0;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl)</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      <span class="keywordflow">if</span> (hamrVec[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 0) ++noham;</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;    <span class="keywordflow">if</span> (noham &gt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;    <span class="comment">// Y,Z limits of the detector</span></div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;    <span class="keywordtype">double</span> world[3] = {0., 0., 0.};</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; thetpc = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;TPC(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>);</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;    thetpc.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(local, world);</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;    <span class="keywordtype">float</span> YLo = world[1] - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetHalfHeight(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>) + 1;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;    <span class="keywordtype">float</span> YHi = world[1] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetHalfHeight(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>) - 1;</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;    <span class="keywordtype">float</span> ZLo = world[2] - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetLength(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>) / 2 + 1;</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    <span class="keywordtype">float</span> ZHi = world[2] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetLength(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>) / 2 - 1;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;    <span class="comment">// Match in 3D</span></div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    <span class="keywordtype">float</span> dX;</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> icl, jpl, jcl, kpl, splitPos;</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;      <span class="keywordflow">if</span> (hamrVec[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      jpl = (ipl + 1) % nPln;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;      kpl = (jpl + 1) % nPln;</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; hamrVec[ipl].size(); ++ii) {</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;        <span class="keywordflow">if</span> (hamrVec[ipl][ii].Used) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = 0; jj &lt; hamrVec[jpl].size(); ++jj) {</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;          <span class="keywordflow">if</span> (hamrVec[jpl][jj].Used) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;          dX = hamrVec[ipl][ii].X - hamrVec[jpl][jj].X;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;          <span class="keywordflow">if</span> (fabs(dX) &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;IntersectionPoint(</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;            hamrVec[ipl][ii].Wire, hamrVec[jpl][jj].Wire, ipl, jpl, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, y, z);</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;          <span class="keywordflow">if</span> (y &lt; YLo || y &gt; YHi || z &lt; ZLo || z &gt; ZHi) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;          <span class="comment">// mark them used</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;          hamrVec[ipl][ii].Used = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;          hamrVec[jpl][jj].Used = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;          <span class="comment">// make a new 3D vertex</span></div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;          <a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html">Vtx3Store</a> newVtx3;</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#aae6378abd601aba3b9476f235787ccad">ProcCode</a> = 7;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a22c1f51a60dbbd5bfd92c48c68e6d3f0">X</a> = 0.5 * (hamrVec[ipl][ii].X + hamrVec[jpl][jj].X);</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;          <span class="comment">// TODO: do this correctly;</span></div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a6d03436d29fa7a018272ab3c92da6459">XErr</a> = fabs(hamrVec[ipl][ii].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a> - hamrVec[jpl][jj].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>);</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3d17b4ed2ab0987a3f5f523a8ea0e1a4">Y</a> = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#af28ffb40ffce2b7046111cbfd9ee827c">YErr</a> = 1; <span class="comment">// TODO</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a36f3929f1257a40d42f27e607db54f62">Z</a> = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a412cc93583fe4feec9e8445de6de28be">ZErr</a> = 1; <span class="comment">// TODO</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a5532385c3180a1db6515133834b27399">CStat</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>;</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3e0d167db363157bbca3d62a8e144014">TPC</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;          <span class="comment">// make 2D vertex in ipl</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;          <a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">VtxStore</a> newVtx2;</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = hamrVec[ipl][ii].Wire;</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#abd3aec0c3e72090d5ec11d217593aac8">WireErr</a> = 2;</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = hamrVec[ipl][ii].Tick;</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a71337b437c20a1f4c51f972a10774e68">TimeErr</a> = 5;</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = 6;</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">Fixed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;          icl = hamrVec[ipl][ii].longClIndex;</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].CTP;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(newVtx2);</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;          <span class="comment">// associate the new vertex with the long cluster</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndVtx = ivnew;</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(ivnew);</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;          <span class="comment">// stash the index in newVtx3</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">Ptr2D</a>[ipl] = (short)ivnew;</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;          <span class="comment">// split the short cluster and associate the new clusters with the new vtx</span></div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;          icl = hamrVec[ipl][ii].shortClIndex;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;          splitPos = hamrVec[ipl][ii].splitPos;</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(icl, splitPos, ivnew)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;          <span class="comment">// make 2D vertex in jpl</span></div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">Wire</a> = hamrVec[jpl][jj].Wire;</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">Time</a> = hamrVec[jpl][jj].Tick;</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">Topo</a> = 6;</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;          jcl = hamrVec[jpl][jj].longClIndex;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;          newVtx2.<a class="code" href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">CTP</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].CTP;</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.push_back(newVtx2);</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;          ivnew = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1;</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;          <span class="comment">// associate the new vertex with the long cluster</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[jcl].EndVtx = ivnew;</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;          <span class="comment">// stash the index in newVtx3</span></div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">Ptr2D</a>[jpl] = (short)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1);</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;          <span class="comment">// split the short cluster and associate the new clusters with the new</span></div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;          <span class="comment">// vtx</span></div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;          jcl = hamrVec[jpl][jj].shortClIndex;</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;          splitPos = hamrVec[jpl][jj].splitPos;</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">SplitCluster</a>(jcl, splitPos, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">FitVtx</a>(ivnew);</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;          <span class="comment">// set the kpl 2D vertex index &lt; 0. Let follow-on code find the 3rd</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;          <span class="comment">// plane vertex</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;          newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">Ptr2D</a>[kpl] = -1;</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;          <span class="keywordtype">double</span> WPos[3] = {0, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>, z};</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;          <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;            newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a076f3f79f8b58ce6e496254d2fea9da8">Wire</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;NearestWire(WPos, kpl, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>, <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>);</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;          }</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;          <span class="keywordflow">catch</span> (<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html">geo::InvalidWireError</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;            newVtx3.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a076f3f79f8b58ce6e496254d2fea9da8">Wire</a> = e.<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html#a174c7f48dc6c32f680e033c960fbc9eb">suggestedWireID</a>().<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>; <span class="comment">// pick the closest valid wire</span></div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;          }</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;          <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.push_back(newVtx3);</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;        } <span class="comment">// jj</span></div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;      }   <span class="comment">// ii</span></div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    }</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;  } <span class="comment">// FindHammerClusters</span></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;<span class="comment">  //////////////////////////////////////</span></div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cd549e0b5347cab2715028d2d86bad0"> 5735</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cd549e0b5347cab2715028d2d86bad0">ClusterCrawlerAlg::VtxMatch</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clock_data,</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;                              <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; det_prop,</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;                              <a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tpcid)</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;  {</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    <span class="comment">// Create 3D vertices from 2D vertices. 3D vertices that are matched</span></div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    <span class="comment">// in all three planes have Ptr2D &gt;= 0 for all planes</span></div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;TPC(tpcid);</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a> = tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a> = tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;    <span class="comment">// Y,Z limits of the detector</span></div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;    <span class="keywordtype">double</span> world[3] = {0., 0., 0.};</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; thetpc = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;TPC(tpc, cstat);</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;    thetpc.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(local, world);</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;    <span class="comment">// reduce the active area of the TPC by 1 cm to prevent wire boundary issues</span></div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;    <span class="keywordtype">float</span> YLo = world[1] - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetHalfHeight(tpc, cstat) + 1;</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;    <span class="keywordtype">float</span> YHi = world[1] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetHalfHeight(tpc, cstat) - 1;</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    <span class="keywordtype">float</span> ZLo = world[2] - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetLength(tpc, cstat) / 2 + 1;</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;    <span class="keywordtype">float</span> ZHi = world[2] + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;DetLength(tpc, cstat) / 2 - 1;</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a> = (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">fDebugPlane</a> &gt;= 0) &amp;&amp; (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">fDebugHit</a> == 6666);</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;      mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Inside VtxMatch&quot;</span>;</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad98ef6dddaf9ae60489d20aab79318bd">PrintVertices</a>();</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;    }</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    <span class="comment">// wire spacing in cm</span></div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;    <span class="keywordtype">float</span> wirePitch = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;WirePitch(0, tpcid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, tpcid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    <span class="comment">// fill temp vectors of 2D vertex X and X errors</span></div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    std::vector&lt;float&gt; vX(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size());</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    std::vector&lt;float&gt; vXsigma(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size());</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    <span class="keywordtype">float</span> vXp;</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> iplID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a66a8ca741d5d163713ed6e6548b9716b">DecodeCTP</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].CTP);</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;      <span class="keywordflow">if</span> (iplID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> != tpc || iplID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> != cstat) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;      <span class="comment">// Convert 2D vertex time error to X error</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;      vX[ivx] =</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;        det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>((<span class="keywordtype">double</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time, (<span class="keywordtype">int</span>)iplID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, (<span class="keywordtype">int</span>)tpc, (<span class="keywordtype">int</span>)cstat);</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;      vXp = det_prop.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;        (<span class="keywordtype">double</span>)(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].TimeErr), (<span class="keywordtype">int</span>)iplID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, (<span class="keywordtype">int</span>)tpc, (<span class="keywordtype">int</span>)cstat);</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;      vXsigma[ivx] = fabs(vXp - vX[ivx]);</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;    } <span class="comment">// ivx</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;    <span class="comment">// create a array/vector of 2D vertex indices in each plane</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    std::array&lt;std::vector&lt;unsigned short&gt;, 3&gt; vIndex;</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indx, ipl;</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx = 0; ivx &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ivx) {</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">NClusters</a> == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;      <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> iplID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a66a8ca741d5d163713ed6e6548b9716b">DecodeCTP</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].CTP);</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      <span class="keywordflow">if</span> (iplID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a> != tpc || iplID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a> != cstat) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;      ipl = iplID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>;</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;      <span class="keywordflow">if</span> (ipl &gt; 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;      indx = vIndex[ipl].size();</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;      vIndex[ipl].resize(indx + 1);</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;      vIndex[ipl][indx] = ivx;</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;    }</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;    <span class="comment">// vector of 2D vertices -&gt; 3D vertices.</span></div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;    std::vector&lt;short&gt; vPtr;</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = 0; ii &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size(); ++ii)</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;      vPtr.push_back(-1);</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;    <span class="comment">// temp vector of all 2D vertex matches</span></div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;    std::vector&lt;Vtx3Store&gt; v3temp;</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a> = 0, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a> = 0;</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;    TVector3 WPos = {0, 0, 0};</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;    <span class="comment">// i, j, k indicates 3 different wire planes</span></div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii, jpl, jj, kpl, kk, ivx, jvx, kvx;</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iWire, jWire;</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> v3dBest = 0;</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;    <span class="keywordtype">float</span> xbest = 0, ybest = 0, zbest = 0;</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>, <a class="code" href="../../da/d2d/namespaceevd.html#ae132a6902afa384d1ed56b6e77b17e79">kWire</a>;</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;    <span class="comment">// compare vertices in each view</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;    <span class="keywordtype">bool</span> gotit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;    <span class="keywordflow">for</span> (ipl = 0; ipl &lt; 2; ++ipl) {</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;      <span class="keywordflow">for</span> (ii = 0; ii &lt; vIndex[ipl].size(); ++ii) {</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        ivx = vIndex[ipl][ii];</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;        <span class="keywordflow">if</span> (ivx &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1) {</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;          mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxMatch: bad ivx &quot;</span> &lt;&lt; ivx;</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;        }</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;        <span class="comment">// vertex has been matched already</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;        <span class="keywordflow">if</span> (vPtr[ivx] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;        iWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire;</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;        <span class="keywordtype">float</span> best = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>;</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;        <span class="comment">// temp array of 2D vertex indices in each plane</span></div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;        <span class="comment">// BUG the double brace syntax is required to work around clang bug 21629</span></div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;        <span class="comment">// (https://bugs.llvm.org/show_bug.cgi?id=21629)</span></div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;        std::array&lt;short, 3&gt; t2dIndex = {{-1, -1, -1}};</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;        std::array&lt;short, 3&gt; tmpIndex = {{-1, -1, -1}};</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;        <span class="keywordflow">for</span> (jpl = ipl + 1; jpl &lt; 3; ++jpl) {</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;          <span class="keywordflow">for</span> (jj = 0; jj &lt; vIndex[jpl].size(); ++jj) {</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;            jvx = vIndex[jpl][jj];</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;            <span class="keywordflow">if</span> (jvx &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size() - 1) {</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;              mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxMatch: bad jvx &quot;</span> &lt;&lt; jvx;</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;              <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;            }</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;            <span class="comment">// vertex has been matched already</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;            <span class="keywordflow">if</span> (vPtr[jvx] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;            jWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].Wire;</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;            <span class="comment">// new stuff</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;            <span class="keywordtype">float</span> dX = fabs(vX[ivx] - vX[jvx]);</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;            <span class="keywordtype">float</span> dXSigma = sqrt(vXsigma[ivx] * vXsigma[ivx] + vXsigma[jvx] * vXsigma[jvx]);</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;            <span class="keywordtype">float</span> dXChi = dX / dXSigma;</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;VtxMatch: ipl &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot; ivx &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; ivX &quot;</span> &lt;&lt; vX[ivx] &lt;&lt; <span class="stringliteral">&quot; jpl &quot;</span> &lt;&lt; jpl</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; jvx &quot;</span> &lt;&lt; jvx &lt;&lt; <span class="stringliteral">&quot; jvX &quot;</span> &lt;&lt; vX[jvx] &lt;&lt; <span class="stringliteral">&quot; W:T &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;                &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].Time &lt;&lt; <span class="stringliteral">&quot; dXChi &quot;</span> &lt;&lt; dXChi &lt;&lt; <span class="stringliteral">&quot; fVertex3DCut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>;</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;            <span class="keywordflow">if</span> (dXChi &gt; fVertex3DCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;            <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;IntersectionPoint(iWire, jWire, ipl, jpl, cstat, tpc, y, <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>);</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;            <span class="keywordflow">if</span> (y &lt; YLo || y &gt; YHi || z &lt; ZLo || z &gt; ZHi) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;            WPos[1] = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;            WPos[2] = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;            kpl = 3 - ipl - jpl;</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;            kX = 0.5 * (vX[ivx] + vX[jvx]);</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;            kWire = -1;</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            <span class="keywordflow">if</span> (TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() &gt; 2) {</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;              <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;                kWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;NearestWire(WPos, kpl, tpc, cstat);</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;              }</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;              <span class="keywordflow">catch</span> (<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html">geo::InvalidWireError</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;                kWire = e.<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html#a174c7f48dc6c32f680e033c960fbc9eb">suggestedWireID</a>().<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>; <span class="comment">// pick the closest valid wire</span></div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;              }</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;            }</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;            kpl = 3 - ipl - jpl;</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;            <span class="comment">// save this incomplete 3D vertex</span></div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;            <a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html">Vtx3Store</a> v3d;</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#aae6378abd601aba3b9476f235787ccad">ProcCode</a> = 1;</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;            tmpIndex[ipl] = ivx;</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;            tmpIndex[jpl] = jvx;</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;            tmpIndex[kpl] = -1;</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">Ptr2D</a> = tmpIndex;</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a22c1f51a60dbbd5bfd92c48c68e6d3f0">X</a> = <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>;</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a6d03436d29fa7a018272ab3c92da6459">XErr</a> = dXSigma;</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3d17b4ed2ab0987a3f5f523a8ea0e1a4">Y</a> = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;            <span class="keywordtype">float</span> yzSigma = wirePitch * sqrt(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].WireErr * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].WireErr +</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;                                             <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].WireErr * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].WireErr);</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#af28ffb40ffce2b7046111cbfd9ee827c">YErr</a> = yzSigma;</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a36f3929f1257a40d42f27e607db54f62">Z</a> = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a412cc93583fe4feec9e8445de6de28be">ZErr</a> = yzSigma;</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a076f3f79f8b58ce6e496254d2fea9da8">Wire</a> = <a class="code" href="../../da/d2d/namespaceevd.html#ae132a6902afa384d1ed56b6e77b17e79">kWire</a>;</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a5532385c3180a1db6515133834b27399">CStat</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cstat</a>;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;            v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3e0d167db363157bbca3d62a8e144014">TPC</a> = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">tpc</a>;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;            v3temp.push_back(v3d);</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;VtxMatch: 2 Plane match ivx &quot;</span> &lt;&lt; ivx &lt;&lt; <span class="stringliteral">&quot; P:W:T &quot;</span> &lt;&lt; ipl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;                &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time &lt;&lt; <span class="stringliteral">&quot; jvx &quot;</span> &lt;&lt; jvx &lt;&lt; <span class="stringliteral">&quot; P:W:T &quot;</span></div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;                &lt;&lt; jpl &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].Wire &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[jvx].Time &lt;&lt; <span class="stringliteral">&quot; dXChi &quot;</span></div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                &lt;&lt; dXChi &lt;&lt; <span class="stringliteral">&quot; yzSigma &quot;</span> &lt;&lt; yzSigma;</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;            <span class="keywordflow">if</span> (TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() == 2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;            <span class="comment">// look for a 3 plane match</span></div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;            best = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>;</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;            <span class="keywordflow">for</span> (kk = 0; kk &lt; vIndex[kpl].size(); ++kk) {</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;              kvx = vIndex[kpl][kk];</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;              <span class="keywordflow">if</span> (vPtr[kvx] &gt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;              <span class="comment">// Wire difference error</span></div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;              <span class="keywordtype">float</span> dW = wirePitch * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[kvx].Wire - <a class="code" href="../../da/d2d/namespaceevd.html#ae132a6902afa384d1ed56b6e77b17e79">kWire</a>) / yzSigma;</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;              <span class="comment">// X difference error</span></div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;              <span class="keywordtype">float</span> dX = (vX[kvx] - <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>) / dXSigma;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;              <span class="keywordtype">float</span> kChi = 0.5 * sqrt(dW * dW + dX * dX);</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;              <span class="keywordflow">if</span> (kChi &lt; best) {</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;                best = kChi;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;                xbest = (vX[kvx] + 2 * <a class="code" href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">kX</a>) / 3;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;                ybest = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;                zbest = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a>;</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;                t2dIndex[ipl] = ivx;</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;                t2dIndex[jpl] = jvx;</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;                t2dIndex[kpl] = kvx;</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;                v3dBest = v3temp.size() - 1;</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;              }</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; kvx &quot;</span> &lt;&lt; kvx &lt;&lt; <span class="stringliteral">&quot; kpl &quot;</span> &lt;&lt; kpl &lt;&lt; <span class="stringliteral">&quot; wire &quot;</span> &lt;&lt; (int)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[kvx].Wire &lt;&lt; <span class="stringliteral">&quot; kTime &quot;</span></div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;                  &lt;&lt; (<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[kvx].Time &lt;&lt; <span class="stringliteral">&quot; kChi &quot;</span> &lt;&lt; kChi &lt;&lt; <span class="stringliteral">&quot; best &quot;</span> &lt;&lt; best &lt;&lt; <span class="stringliteral">&quot; dW &quot;</span></div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;                  &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[kvx].Wire - <a class="code" href="../../da/d2d/namespaceevd.html#ae132a6902afa384d1ed56b6e77b17e79">kWire</a>;</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;            } <span class="comment">// kk</span></div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;              mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; done best = &quot;</span> &lt;&lt; best &lt;&lt; <span class="stringliteral">&quot; fVertex3DCut &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;            <span class="keywordflow">if</span> (TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() &gt; 2 &amp;&amp; best &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">fVertex3DCut</a>) {</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;              <span class="comment">// create a real 3D vertex using the previously entered incomplete 3D vertex as a template</span></div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;              <span class="keywordflow">if</span> (v3dBest &gt; v3temp.size() - 1) {</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;                mf::LogError(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;VtxMatch: bad v3dBest &quot;</span> &lt;&lt; v3dBest;</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;              }</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;              <a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html">Vtx3Store</a> v3d = v3temp[v3dBest];</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;              v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">Ptr2D</a> = t2dIndex;</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;              v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a076f3f79f8b58ce6e496254d2fea9da8">Wire</a> = -1;</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;              <span class="comment">// TODO need to average ybest and zbest here with error weighting</span></div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;              v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a22c1f51a60dbbd5bfd92c48c68e6d3f0">X</a> = xbest;</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;              v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3d17b4ed2ab0987a3f5f523a8ea0e1a4">Y</a> = ybest;</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;              v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a36f3929f1257a40d42f27e607db54f62">Z</a> = zbest;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.push_back(v3d);</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;              gotit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;              <span class="comment">// mark the 2D vertices as used</span></div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jj = 0; jj &lt; 3; ++jj)</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;                <span class="keywordflow">if</span> (t2dIndex[jj] &gt;= 0) vPtr[t2dIndex[jj]] = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size() - 1;</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>)</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;                mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>)</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;New 3D vtx &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size() &lt;&lt; <span class="stringliteral">&quot; X &quot;</span> &lt;&lt; v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a22c1f51a60dbbd5bfd92c48c68e6d3f0">X</a> &lt;&lt; <span class="stringliteral">&quot; Y &quot;</span> &lt;&lt; v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3d17b4ed2ab0987a3f5f523a8ea0e1a4">Y</a> &lt;&lt; <span class="stringliteral">&quot; Z &quot;</span></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;                  &lt;&lt; v3d.<a class="code" href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a36f3929f1257a40d42f27e607db54f62">Z</a> &lt;&lt; <span class="stringliteral">&quot; t2dIndex &quot;</span> &lt;&lt; t2dIndex[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t2dIndex[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;                  &lt;&lt; t2dIndex[2] &lt;&lt; <span class="stringliteral">&quot; best Chi &quot;</span> &lt;&lt; best;</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;            } <span class="comment">// best &lt; dRCut</span></div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;            <span class="keywordflow">if</span> (gotit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;          } <span class="comment">// jj</span></div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;          <span class="keywordflow">if</span> (gotit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;        } <span class="comment">// jpl</span></div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;        <span class="keywordflow">if</span> (gotit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;      } <span class="comment">// ii</span></div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;    }   <span class="comment">// ipl</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;    <span class="comment">// Store incomplete 3D vertices but ignore those that are part of a complete 3D vertex</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> vsize = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size();</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it = 0; it &lt; v3temp.size(); ++it) {</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;      <span class="keywordtype">bool</span> keepit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i3d = 0; i3d &lt; vsize; ++i3d) {</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> = 0; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a> &lt; 3; ++<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>) {</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;          <span class="keywordflow">if</span> (v3temp[it].Ptr2D[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>] == <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[i3d].Ptr2D[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">plane</a>]) {</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;            keepit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;          }</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;        } <span class="comment">// plane</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;        <span class="keywordflow">if</span> (!keepit) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;      } <span class="comment">// i3d</span></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;      <span class="keywordflow">if</span> (keepit) <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.push_back(v3temp[it]);</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;    } <span class="comment">// it</span></div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;    <span class="comment">// Modify Ptr2D for 2-plane detector</span></div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;    <span class="keywordflow">if</span> (TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() == 2) {</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iv3 = 0; iv3 &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size(); ++iv3) {</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[iv3].Ptr2D[2] = 666;</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;      } <span class="comment">//iv3</span></div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;    }   <span class="comment">// 2 planes</span></div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">vtxprt</a>) {</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> it = 0; it &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>.size(); ++it) {</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;        mf::LogVerbatim(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;vtx3 &quot;</span> &lt;&lt; it &lt;&lt; <span class="stringliteral">&quot; Ptr2D &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[it].Ptr2D[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[it].Ptr2D[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[it].Ptr2D[2] &lt;&lt; <span class="stringliteral">&quot; wire &quot;</span></div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;                              &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">vtx3</a>[it].Wire;</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;      }</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;    }</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;  } <span class="comment">// VtxMatch</span></div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;<span class="comment">  //////////////////////////////////</span></div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l05999"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d9ae2c8c6032bfe26f87f1a8cdaa35c"> 5999</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d9ae2c8c6032bfe26f87f1a8cdaa35c">ClusterCrawlerAlg::GetHitRange</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8f5750cc57138e6d09d7d746d7452e05">CTP_t</a> CTP)</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;  {</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;    <span class="comment">// fills the WireHitRange vector for the supplied Cryostat/TPC/Plane code</span></div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;    <span class="comment">// Hits must have been sorted by increasing wire number</span></div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8168ec7a0de034676a5376c022e4a436">fFirstHit</a> = 0;</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeID = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a66a8ca741d5d163713ed6e6548b9716b">DecodeCTP</a>(CTP);</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nwires = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;Nwires(planeID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, planeID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, planeID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>.resize(nwires + 1);</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;    <span class="comment">// These will be re-defined later</span></div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> = 0;</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;    <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a> = 0;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire, iht;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nHitInPlane;</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;    std::pair&lt;int, int&gt; <a class="code" href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a>;</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;    <span class="comment">// Define the &quot;no hits on wire&quot; condition</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;    flag.first = -2;</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;    flag.second = -2;</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; apair : <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>)</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;      apair = <a class="code" href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a>;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;    nHitInPlane = 0;</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;    std::vector&lt;bool&gt; firsthit;</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;    firsthit.resize(nwires + 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;    <span class="keywordtype">bool</span> firstwire = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;    <span class="keywordflow">for</span> (iht = 0; iht &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size(); ++iht) {</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().TPC != planeID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat != planeID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Plane != planeID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;      wire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;      <span class="comment">// define the first hit start index in this TPC, Plane</span></div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;      <span class="keywordflow">if</span> (firsthit[wire]) {</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;        WireHitRange[wire].first = iht;</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;        firsthit[wire] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;      }</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;      <span class="keywordflow">if</span> (firstwire) {</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">fFirstWire</a> = wire;</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;        firstwire = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;      }</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      WireHitRange[wire].second = iht + 1;</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;      <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">fLastWire</a> = wire + 1;</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;      ++nHitInPlane;</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;    }</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;    <span class="comment">// overwrite with the &quot;dead wires&quot; condition</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;    <a class="code" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a> <span class="keyword">const</span>&amp; channelStatus =</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;      art::ServiceHandle&lt;lariov::ChannelStatusService const&gt;()-&gt;GetProvider();</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;    flag.first = -1;</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;    flag.second = -1;</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nbad = 0;</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;    <span class="keywordflow">for</span> (wire = 0; wire &lt; nwires; ++wire) {</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;      <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> chan = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">geom</a>-&gt;PlaneWireToChannel(</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;        (<span class="keywordtype">int</span>)planeID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>, (<span class="keywordtype">int</span>)wire, (<span class="keywordtype">int</span>)planeID.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>, (<span class="keywordtype">int</span>)planeID.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>);</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;      <span class="keywordflow">if</span> (!channelStatus.<a class="code" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html#a17471560041631ee3f09c578987141f5">IsGood</a>(chan)) {</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;        WireHitRange[wire] = <a class="code" href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a>;</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;        ++nbad;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;      }</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;    } <span class="comment">// wire</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;    <span class="comment">// define the MergeAvailable vector and check for errors</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>.size() &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size())</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;      <span class="keywordflow">throw</span> art::Exception(art::errors::LogicError)</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;GetHitRange: Invalid mergeAvailable vector size &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>.size()</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;        &lt;&lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size();</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstHit, lastHit;</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cnt;</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;    cnt = 0;</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;    <span class="keywordtype">float</span> maxRMS, chiSep, peakCut;</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;    <span class="keywordflow">for</span> (wire = 0; wire &lt; nwires; ++wire) {</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;      <span class="comment">// ignore dead wires and wires with no hits</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;      <span class="keywordflow">if</span> (WireHitRange[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;      firstHit = WireHitRange[wire].first;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;      lastHit = WireHitRange[wire].second;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;      <span class="keywordflow">for</span> (iht = firstHit; iht &lt; lastHit; ++iht) {</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire != wire)</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;          <span class="keywordflow">throw</span> art::Exception(art::errors::LogicError)</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Bad WireHitRange on wire &quot;</span> &lt;&lt; wire &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;        ++cnt;</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].Multiplicity() &gt; 1) {</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;          peakCut = 0.6 * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakAmplitude();</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;          std::pair&lt;size_t, size_t&gt; MultipletRange = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc">FindHitMultiplet</a>(iht);</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jht = MultipletRange.first; jht &lt; MultipletRange.second; ++jht) {</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;            <span class="keywordflow">if</span> (jht == iht) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;            <span class="comment">// require that the j hit be similar in magnitude to the i hit</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakAmplitude() &lt; peakCut) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;            maxRMS = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].RMS(), <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].RMS());</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;            chiSep = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime() - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[jht].PeakTime()) / maxRMS;</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;            <span class="keywordflow">if</span> (chiSep &lt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">fHitMergeChiCut</a>) {</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;              <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[iht] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;            }</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;          } <span class="comment">// jht</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;        }   <span class="comment">// fHits[iht].Multiplicity() &gt; 1</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;      }     <span class="comment">// iht</span></div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;    }       <span class="comment">// wire</span></div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;    <span class="keywordflow">if</span> (cnt != nHitInPlane)</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CC&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Bad WireHitRange count &quot;</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nHitInPlane &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8c27ede03b402b47c349b8bb1307ff1a">fMergeAllHits</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;    <span class="comment">// Merge all of the hits</span></div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;    <span class="keywordtype">bool</span> didMerge;</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;    <span class="keywordflow">for</span> (wire = 0; wire &lt; nwires; ++wire) {</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;      <span class="keywordflow">if</span> (WireHitRange[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;      firstHit = WireHitRange[wire].first;</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;      lastHit = WireHitRange[wire].second;</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;      <span class="keywordflow">for</span> (iht = firstHit; iht &lt; lastHit; ++iht) {</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[iht]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;        <span class="comment">// already merged?</span></div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].GoodnessOfFit() == 6666) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">MergeHits</a>(iht, didMerge);</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;        <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">mergeAvailable</a>[iht] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;      } <span class="comment">// iht</span></div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;    }   <span class="comment">// wire</span></div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;  } <span class="comment">// GetHitRange()</span></div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l06120"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a949552e2f307f62400e27993ed8cf331"> 6120</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">ClusterCrawlerAlg::DeadWireCount</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inWire1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inWire2)</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;  {</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;    <span class="keywordflow">if</span> (inWire1 &gt; inWire2) {</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;      <span class="comment">// put in increasing order</span></div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp = inWire1;</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;      inWire1 = inWire2;</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;      inWire2 = tmp;</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;    } <span class="comment">// inWire1 &gt; inWire2</span></div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    ++inWire2;</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire, ndead = 0;</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;    <span class="keywordflow">for</span> (wire = inWire1; wire &lt; inWire2; ++wire)</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) ++ndead;</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;    <span class="keywordflow">return</span> ndead;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;  } <span class="comment">// DeadWireCount</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l06137"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192"> 6137</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">ClusterCrawlerAlg::DeadWireCount</a>()</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;  {</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;    <span class="comment">// Counts the number of dead wires in the range spanned by fcl2hits</span></div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() &lt; 2) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire, ndead = 0;</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() - 1];</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire;</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;    iht = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>[0];</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bWire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].WireID().Wire + 1;</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;    <span class="keywordflow">for</span> (wire = eWire; wire &lt; bWire; ++wire)</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">WireHitRange</a>[wire].<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> == -1) ++ndead;</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;    <span class="keywordflow">return</span> ndead;</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;  } <span class="comment">// DeadWireCount</span></div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8454cb40ab6f0e89d1a42d7adaaf96d5"> 6153</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8454cb40ab6f0e89d1a42d7adaaf96d5">ClusterCrawlerAlg::areInSameMultiplet</a>(<a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; first_hit, <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a> <span class="keyword">const</span>&amp; second_hit)</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;  {</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;    <span class="keywordflow">return</span> (first_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>() == second_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">StartTick</a>()) &amp;&amp;</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;           (first_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>() == second_hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>());</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;  } <span class="comment">// ClusterCrawlerAlg::areInSameMultiplet()</span></div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;<span class="comment"></span>  std::pair&lt;size_t, size_t&gt;</div>
<div class="line"><a name="l06161"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc"> 6161</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc">ClusterCrawlerAlg::FindHitMultiplet</a>(<span class="keywordtype">size_t</span> iHit)<span class="keyword"> const</span></div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;    std::pair&lt;size_t, size_t&gt; range{iHit, iHit};</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;    range.first = iHit - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iHit].LocalIndex();</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;    range.second = range.first + <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iHit].Multiplicity();</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;    <span class="keywordflow">return</span> range;</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;  } <span class="comment">// ClusterCrawlerAlg::FindHitMultiplet()</span></div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;<span class="comment">  //////////////////////////////////////////</span></div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l06173"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0b30c422ce2d96d441314a4bde07e13f"> 6173</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0b30c422ce2d96d441314a4bde07e13f">ClusterCrawlerAlg::CheckHitDuplicates</a>(std::string location, std::string marker <span class="comment">/* = &quot;&quot; */</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;    <span class="comment">// currently unused, only for debug</span></div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#a372f3a4986e0eb3afba9eac64b63a4f3">nDuplicates</a> = 0;</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;    std::set&lt;unsigned int&gt; hits;</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>) {</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;      <span class="keywordflow">if</span> (hits.count(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>)) {</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;        ++<a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#a372f3a4986e0eb3afba9eac64b63a4f3">nDuplicates</a>;</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;        mf::LogProblem log(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;Hit #&quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; being included twice in the future cluster (ID=&quot;</span> &lt;&lt; (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size() + 1)</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;?) at location: &quot;</span> &lt;&lt; location;</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;        <span class="keywordflow">if</span> (!marker.empty()) log &lt;&lt; <span class="stringliteral">&quot; (marker: &#39;&quot;</span> &lt;&lt; marker &lt;&lt; <span class="stringliteral">&quot;&#39;)&quot;</span>;</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;      }</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;      hits.insert(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>);</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;    <span class="keywordflow">return</span> nDuplicates &gt; 0;</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;  } <span class="comment">// ClusterCrawlerAlg::CheckHitDuplicates()</span></div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad9d2b8dd2a0bb08beb186344017c899f"> 6194</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad9d2b8dd2a0bb08beb186344017c899f">ClusterCrawlerAlg::DoCA</a>(<span class="keywordtype">short</span> icl, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, <span class="keywordtype">float</span> vwire, <span class="keywordtype">float</span> vtick)</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;  {</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;    <span class="comment">// Find the Distance of Closest Approach betweeen a cluster and a point (vwire, vtick). The</span></div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;    <span class="comment">// DoCA is returned in Tick units.</span></div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;    <span class="keywordflow">if</span> (icl &gt; (<span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size()) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;    <span class="keywordtype">float</span> cwire, cslp, ctick;</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;    <span class="comment">// figure out which cluster to use</span></div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;    <span class="keywordflow">if</span> (icl &lt; 0) {</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;      <span class="comment">// cluster under construction</span></div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;      <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a>;</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>;</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a>;</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;      }</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2];</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0];</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;      } <span class="comment">// end</span></div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;    }</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;      <span class="comment">// tcl cluster</span></div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;      <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp;</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;      }</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp;</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;      } <span class="comment">// end</span></div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;    }</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;    <span class="comment">// Closest approach wire</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;    <span class="keywordtype">float</span> docaW = (vwire + cslp * (vtick - ctick) + cwire * cslp * cslp) / (1 + cslp * cslp);</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;    <span class="keywordtype">float</span> dW = docaW - vwire;</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;    <span class="keywordtype">float</span> dT = ctick + (vwire - cwire) * cslp - vtick;</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;    <span class="keywordflow">return</span> sqrt(dW * dW + dT * dT);</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;  } <span class="comment">// DoCA</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9"> 6241</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">ClusterCrawlerAlg::ClusterVertexChi</a>(<span class="keywordtype">short</span> icl, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx)</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;  {</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;    <span class="comment">// Returns the chisq/DOF between a cluster and a vertex</span></div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;    <span class="keywordflow">if</span> (icl &gt; (<span class="keywordtype">short</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>.size()) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;    <span class="keywordflow">if</span> (ivx &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size()) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;    <span class="keywordtype">float</span> cwire, cslp, cslpErr, ctick;</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;    <span class="comment">// figure out which cluster to use</span></div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;    <span class="keywordflow">if</span> (icl &lt; 0) {</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">fcl2hits</a>.size() == 0) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;      <span class="comment">// cluster under construction</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;      <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">clBeginWir</a>;</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">clBeginSlp</a>;</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;        cslpErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">clBeginSlpErr</a>;</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">clBeginTim</a>;</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;      }</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[2];</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[1];</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;        cslpErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">clparerr</a>[1];</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">clpar</a>[0];</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;      } <span class="comment">// end</span></div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;    }</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;      <span class="comment">// tcl cluster</span></div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;      <span class="keywordflow">if</span> (end == 0) {</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginWir;</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlp;</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;        cslpErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginSlpErr;</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].BeginTim;</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;      }</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;        cwire = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndWir;</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;        cslp = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlp;</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;        cslpErr = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndSlpErr;</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;        ctick = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">tcl</a>[icl].EndTim;</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;      } <span class="comment">// end</span></div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;    }</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    <span class="comment">// Closest approach wire</span></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;    <span class="keywordtype">float</span> docaW =</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;      (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire + cslp * (<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time - ctick) + cwire * cslp * cslp) / (1 + cslp * cslp);</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;    <span class="keywordtype">float</span> dW = docaW - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;    <span class="keywordtype">float</span> chi = dW / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].WireErr;</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;    <span class="keywordtype">float</span> totChi = chi * chi;</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;    dW = <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire - cwire;</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;    <span class="keywordtype">float</span> dT = ctick + dW * cslp - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time;</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;    <span class="keywordflow">if</span> (cslpErr &lt; 1<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-3) cslpErr = 1<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-3;</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;    <span class="comment">// increase slope error for large angle clusters</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;    cslpErr *= <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">AngleFactor</a>(cslp);</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;    <span class="comment">// cluster slope projection error</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;    <span class="keywordtype">float</span> dTErr = dW * cslpErr;</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;    <span class="comment">// squared</span></div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;    dTErr *= dTErr;</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;    <span class="comment">// add the vertex time error^2 to the cluster projection error^2</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;    dTErr += <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].TimeErr * <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].TimeErr;</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;    <span class="keywordflow">if</span> (dTErr &lt; 1<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-3) dTErr = 1<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-3;</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;    totChi += dT * dT / dTErr;</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;    totChi /= 2;</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;    <span class="keywordflow">return</span> totChi;</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;  } <span class="comment">// ClusterVertexChi</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad8a34f66ba1eb44620e288dc1ca2e3fe"> 6309</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad8a34f66ba1eb44620e288dc1ca2e3fe">ClusterCrawlerAlg::PointVertexChi</a>(<span class="keywordtype">float</span> wire, <span class="keywordtype">float</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ivx)</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;  {</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;    <span class="comment">// Returns the Chisq/DOF between a (Wire, Tick) point and a vertex</span></div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;    <span class="keywordflow">if</span> (ivx &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>.size()) <span class="keywordflow">return</span> 9999;</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;    <span class="keywordtype">float</span> dW = wire - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Wire;</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;    <span class="keywordtype">float</span> chi = dW / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].WireErr;</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;    <span class="keywordtype">float</span> totChi = chi * chi;</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;    <span class="keywordtype">float</span> dT = tick - <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].Time;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;    chi = dT / <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">vtx</a>[ivx].TimeErr;</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;    totChi += chi * chi;</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;    <span class="keywordflow">return</span> totChi;</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;  } <span class="comment">// PointVertexChi</span></div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="comment">  /////////////////////////////////////////</span></div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="comment"></span>  std::string</div>
<div class="line"><a name="l06328"></a><span class="lineno"><a class="line" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6"> 6328</a></span>&#160;  <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">ClusterCrawlerAlg::PrintHit</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iht)</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;  {</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;    <span class="keywordflow">if</span> (iht &gt; <a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>.size() - 1) <span class="keywordflow">return</span> <span class="stringliteral">&quot;Bad Hit&quot;</span>;</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a>) + <span class="stringliteral">&quot;:&quot;</span> +</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;           <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire) + <span class="stringliteral">&quot;:&quot;</span> +</div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;           <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>((<span class="keywordtype">int</span>)<a class="code" href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">fHits</a>[iht].PeakTime());</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;  } <span class="comment">// PrintHit</span></div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;} <span class="comment">// namespace cluster</span></div>
<div class="ttc" id="classrecob_1_1Hit_html_ab8e5a8dca815249db143cc517e4ed6b9"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ab8e5a8dca815249db143cc517e4ed6b9">recob::Hit::LocalIndex</a></div><div class="ttdeci">short int LocalIndex() const </div><div class="ttdoc">How well do we believe we know this hit? </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00227">Hit.h:227</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_afb4fdde7a4a480dd302b5a155ecb0bf0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb4fdde7a4a480dd302b5a155ecb0bf0">cluster::ClusterCrawlerAlg::fScaleF</a></div><div class="ttdeci">float fScaleF</div><div class="ttdoc">scale factor from Tick/Wire to dx/du </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00303">ClusterCrawlerAlg.h:303</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6f1bcc1234d5bf9a035b2f18b06e2fbc"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6f1bcc1234d5bf9a035b2f18b06e2fbc">cluster::ClusterCrawlerAlg::hitNear</a></div><div class="ttdeci">std::vector&lt; short &gt; hitNear</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00314">ClusterCrawlerAlg.h:314</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a1fafe1ed78e116cabb4aeec226db6e18"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a1fafe1ed78e116cabb4aeec226db6e18">cluster::ClusterCrawlerAlg::ClusterStore::EndChg</a></div><div class="ttdeci">float EndChg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00079">ClusterCrawlerAlg.h:79</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab7e9e16248480f63fb64be2666252620"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7e9e16248480f63fb64be2666252620">cluster::ClusterCrawlerAlg::ClusterHitsOK</a></div><div class="ttdeci">bool ClusterHitsOK(short nHitChk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04715">ClusterCrawlerAlg.cxx:4715</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae6ac3477ed51e08e5112e3fa6d64fdd0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae6ac3477ed51e08e5112e3fa6d64fdd0">cluster::ClusterCrawlerAlg::fAveChg</a></div><div class="ttdeci">float fAveChg</div><div class="ttdoc">average charge at leading edge of cluster </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00236">ClusterCrawlerAlg.h:236</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1e1f4d466d9ce7f36054b8f449850cf5"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1e1f4d466d9ce7f36054b8f449850cf5">cluster::ClusterCrawlerAlg::tcl</a></div><div class="ttdeci">std::vector&lt; ClusterStore &gt; tcl</div><div class="ttdoc">the clusters we are creating </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00250">ClusterCrawlerAlg.h:250</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a83303f6d29ca57193e6cff12dad2bd69"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a83303f6d29ca57193e6cff12dad2bd69">cluster::ClusterCrawlerAlg::ClusterStore::EndAng</a></div><div class="ttdeci">float EndAng</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00075">ClusterCrawlerAlg.h:75</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab32a8068015def21bec49c5a4d6c0781"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab32a8068015def21bec49c5a4d6c0781">cluster::ClusterCrawlerAlg::WireHitRange</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; WireHitRange</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00310">ClusterCrawlerAlg.h:310</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3026a548b92f9aae371143afffbb74d3"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3026a548b92f9aae371143afffbb74d3">cluster::ClusterCrawlerAlg::ClusterLoop</a></div><div class="ttdeci">void ClusterLoop()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00296">ClusterCrawlerAlg.cxx:296</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_abc6d83bf8cfcf2e932489d6a0c9d77a8"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abc6d83bf8cfcf2e932489d6a0c9d77a8">cluster::ClusterCrawlerAlg::fLAClusSlopeCut</a></div><div class="ttdeci">float fLAClusSlopeCut</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00214">ClusterCrawlerAlg.h:214</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aabf2ac44bedaf4148f10097603dabd60"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aabf2ac44bedaf4148f10097603dabd60">cluster::ClusterCrawlerAlg::FitVtx</a></div><div class="ttdeci">void FitVtx(unsigned short iv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05104">ClusterCrawlerAlg.cxx:5104</a></div></div>
<div class="ttc" id="NumericUtils_8h_html"><div class="ttname"><a href="../../da/d16/NumericUtils_8h.html">NumericUtils.h</a></div><div class="ttdoc">Functions to help with numbers. </div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a19a017039c62b9be286cd55944686ec4"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a19a017039c62b9be286cd55944686ec4">recob::Hit::SignalType</a></div><div class="ttdeci">geo::SigType_t SignalType() const </div><div class="ttdoc">Signal type for the plane of the hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00231">Hit.h:231</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab0d474ea17eae621f3b58c0c10e1df09"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab0d474ea17eae621f3b58c0c10e1df09">cluster::ClusterCrawlerAlg::RemoveObsoleteHits</a></div><div class="ttdeci">void RemoveObsoleteHits()</div><div class="ttdoc">Removes obsolete hits from hits, updating the indices. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00950">ClusterCrawlerAlg.cxx:950</a></div></div>
<div class="ttc" id="detectorproperties__icarus_8fcl_html_acfd440223f806c44323dbd1053b99123"><div class="ttname"><a href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a></div><div class="ttdeci">second</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d33/detectorproperties__icarus_8fcl_source.html#l00008">detectorproperties_icarus.fcl:8</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a584d1502c5d50ffd31316434c89e7ed0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a584d1502c5d50ffd31316434c89e7ed0">cluster::ClusterCrawlerAlg::fChkClusterDS</a></div><div class="ttdeci">bool fChkClusterDS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00202">ClusterCrawlerAlg.h:202</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_abe9afb00b26431485ad277e4e89f9bcd"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abe9afb00b26431485ad277e4e89f9bcd">cluster::ClusterCrawlerAlg::FitClusterMid</a></div><div class="ttdeci">void FitClusterMid(unsigned short it1, unsigned int iht, short nhit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04168">ClusterCrawlerAlg.cxx:4168</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5467a5d3ce2e3af3d9099c6055876acd"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5467a5d3ce2e3af3d9099c6055876acd">cluster::ClusterCrawlerAlg::ChkSignal</a></div><div class="ttdeci">bool ChkSignal(unsigned int iht, unsigned int jht)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02595">ClusterCrawlerAlg.cxx:2595</a></div></div>
<div class="ttc" id="ServiceUtil_8h_html"><div class="ttname"><a href="../../d4/d2e/ServiceUtil_8h.html">ServiceUtil.h</a></div><div class="ttdoc">Utilities related to art service access. </div></div>
<div class="ttc" id="rawdigitfilter__icarus_8fcl_html_aa2b9cfdf9a8f294302be0cdf6affea22"><div class="ttname"><a href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a></div><div class="ttdeci">BEGIN_PROLOG true icarus_rawdigitfilter FilterTools FilterPlane1 Plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5e/rawdigitfilter__icarus_8fcl_source.html#l00008">rawdigitfilter_icarus.fcl:8</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ace43a974a319784065a2049ef1c1ad9f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ace43a974a319784065a2049ef1c1ad9f">cluster::ClusterCrawlerAlg::fTimeDelta</a></div><div class="ttdeci">std::vector&lt; float &gt; fTimeDelta</div><div class="ttdoc">max time difference for matching </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00191">ClusterCrawlerAlg.h:191</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_af28ffb40ffce2b7046111cbfd9ee827c"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#af28ffb40ffce2b7046111cbfd9ee827c">cluster::ClusterCrawlerAlg::Vtx3Store::YErr</a></div><div class="ttdeci">float YErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00105">ClusterCrawlerAlg.h:105</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a412cc93583fe4feec9e8445de6de28be"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a412cc93583fe4feec9e8445de6de28be">cluster::ClusterCrawlerAlg::Vtx3Store::ZErr</a></div><div class="ttdeci">float ZErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00107">ClusterCrawlerAlg.h:107</a></div></div>
<div class="ttc" id="namespaceevd_html_ae132a6902afa384d1ed56b6e77b17e79"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#ae132a6902afa384d1ed56b6e77b17e79">evd::kWire</a></div><div class="ttdeci">static unsigned int kWire</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9c/TWQMultiTPCProjection_8cxx_source.html#l00045">TWQMultiTPCProjection.cxx:45</a></div></div>
<div class="ttc" id="CryostatGeo_8h_html"><div class="ttname"><a href="../../df/d13/CryostatGeo_8h.html">CryostatGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single cyostat. </div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3b6a36dde2fc291645fc104d200a0d0c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b6a36dde2fc291645fc104d200a0d0c">cluster::ClusterCrawlerAlg::clEndSlpErr</a></div><div class="ttdeci">float clEndSlpErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00265">ClusterCrawlerAlg.h:265</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_a71337b437c20a1f4c51f972a10774e68"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a71337b437c20a1f4c51f972a10774e68">cluster::ClusterCrawlerAlg::VtxStore::TimeErr</a></div><div class="ttdeci">float TimeErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00090">ClusterCrawlerAlg.h:90</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a7c298b89eb27bac036b05568a5de598e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c298b89eb27bac036b05568a5de598e">cluster::ClusterCrawlerAlg::tpc</a></div><div class="ttdeci">unsigned int tpc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00299">ClusterCrawlerAlg.h:299</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_acf2110c3225a786039ae148b4d966f63"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf2110c3225a786039ae148b4d966f63">cluster::ClusterCrawlerAlg::PrintClusters</a></div><div class="ttdeci">void PrintClusters()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03352">ClusterCrawlerAlg.cxx:3352</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad98ef6dddaf9ae60489d20aab79318bd"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad98ef6dddaf9ae60489d20aab79318bd">cluster::ClusterCrawlerAlg::PrintVertices</a></div><div class="ttdeci">void PrintVertices()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03287">ClusterCrawlerAlg.cxx:3287</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_afac1ac7b61385644c993fbb774a1922f"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#afac1ac7b61385644c993fbb774a1922f">cluster</a></div><div class="ttdeci">process_name cluster</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html">cluster::ClusterCrawlerAlg::VtxStore</a></div><div class="ttdoc">struct of temporary 2D vertices (end points) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00086">ClusterCrawlerAlg.h:86</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1b56996dcb7a282ba65169fae258b250"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1b56996dcb7a282ba65169fae258b250">cluster::ClusterCrawlerAlg::clparerr</a></div><div class="ttdeci">float clparerr[2]</div><div class="ttdoc">cluster parameter errors </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00234">ClusterCrawlerAlg.h:234</a></div></div>
<div class="ttc" id="ClusterCrawlerAlg_8h_html"><div class="ttname"><a href="../../dc/df7/ClusterCrawlerAlg_8h.html">ClusterCrawlerAlg.h</a></div></div>
<div class="ttc" id="build-dunepdsprce_8sh_html_a7540356e7646404cc3d25929740df7e6"><div class="ttname"><a href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a></div><div class="ttdeci">then echo unknown compiler flag</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2d/build-dunepdsprce_8sh_source.html#l00066">build-dunepdsprce.sh:66</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3b7a992e4f5e132cdc778f75f55d8d73"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3b7a992e4f5e132cdc778f75f55d8d73">cluster::ClusterCrawlerAlg::FitClusterChg</a></div><div class="ttdeci">void FitClusterChg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04402">ClusterCrawlerAlg.cxx:4402</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a491cbf624d52163dcc3bf701e562ff32"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a491cbf624d52163dcc3bf701e562ff32">cluster::ClusterCrawlerAlg::ClusterStore::ProcCode</a></div><div class="ttdeci">short ProcCode</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00063">ClusterCrawlerAlg.h:63</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af9c56ae5495f4e9e622ecbe61fc9932f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af9c56ae5495f4e9e622ecbe61fc9932f">cluster::ClusterCrawlerAlg::plane</a></div><div class="ttdeci">unsigned int plane</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00300">ClusterCrawlerAlg.h:300</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8454cb40ab6f0e89d1a42d7adaaf96d5"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8454cb40ab6f0e89d1a42d7adaaf96d5">cluster::ClusterCrawlerAlg::areInSameMultiplet</a></div><div class="ttdeci">static bool areInSameMultiplet(recob::Hit const &amp;first_hit, recob::Hit const &amp;second_hit)</div><div class="ttdoc">Returns whether the two hits belong to the same multiplet. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06153">ClusterCrawlerAlg.cxx:6153</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af86d1524e15073ecf40dd6986bcc4c04"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af86d1524e15073ecf40dd6986bcc4c04">cluster::ClusterCrawlerAlg::EndKinkAngle</a></div><div class="ttdeci">float EndKinkAngle()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04027">ClusterCrawlerAlg.cxx:4027</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8ba3084aba959875b0c95ea3b09c800d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8ba3084aba959875b0c95ea3b09c800d">cluster::ClusterCrawlerAlg::fChgCut</a></div><div class="ttdeci">std::vector&lt; float &gt; fChgCut</div><div class="ttdoc">charge difference cut for adding a hit to a cluster </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00185">ClusterCrawlerAlg.h:185</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_abb1ee7eebd67eb8d985254dac021c53d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abb1ee7eebd67eb8d985254dac021c53d">cluster::ClusterCrawlerAlg::vtx3</a></div><div class="ttdeci">std::vector&lt; Vtx3Store &gt; vtx3</div><div class="ttdoc">the 3D vertices we are reconstructing </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00252">ClusterCrawlerAlg.h:252</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a825b8477583d532bd08990bc8e2b63af"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a825b8477583d532bd08990bc8e2b63af">cluster::ClusterCrawlerAlg::clBeginChg</a></div><div class="ttdeci">float clBeginChg</div><div class="ttdoc">begin average charge </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00261">ClusterCrawlerAlg.h:261</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a09d24598fc5c0995b11d2d8228da771a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a09d24598fc5c0995b11d2d8228da771a">cluster::ClusterCrawlerAlg::fMinWirAfterSkip</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; fMinWirAfterSkip</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00188">ClusterCrawlerAlg.h:188</a></div></div>
<div class="ttc" id="SurfXYZTest_8cc_html_a352dc2abeda5f913ed16b48bbdcde948"><div class="ttname"><a href="../../da/da0/SurfXYZTest_8cc.html#a352dc2abeda5f913ed16b48bbdcde948">tol</a></div><div class="ttdeci">auto const tol</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da0/SurfXYZTest_8cc_source.html#l00016">SurfXYZTest.cc:16</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ab3391de99203f6a60eeeef152d3adb35"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">geo::TPCGeo::Nplanes</a></div><div class="ttdeci">unsigned int Nplanes() const </div><div class="ttdoc">Number of planes in this tpc. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00165">TPCGeo.h:165</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a42419566c0e9da6d42cfdf67803c0899"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a42419566c0e9da6d42cfdf67803c0899">recob::Hit::RMS</a></div><div class="ttdeci">float RMS() const </div><div class="ttdoc">RMS of the hit shape, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00220">Hit.h:220</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae1628eba1ffff28fbbc34f0443b10279"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae1628eba1ffff28fbbc34f0443b10279">cluster::ClusterCrawlerAlg::clEndTim</a></div><div class="ttdeci">float clEndTim</div><div class="ttdoc">begin time </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00267">ClusterCrawlerAlg.h:267</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a2bdbe2707f8c0bd064ec9597d3ec1969"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a2bdbe2707f8c0bd064ec9597d3ec1969">cluster::ClusterCrawlerAlg::ClusterStore::BeginWir</a></div><div class="ttdeci">unsigned int BeginWir</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00069">ClusterCrawlerAlg.h:69</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a7745dda99ad5b5f1639d763858da2796"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7745dda99ad5b5f1639d763858da2796">cluster::ClusterCrawlerAlg::clpar</a></div><div class="ttdeci">float clpar[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00232">ClusterCrawlerAlg.h:232</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a60e232284fc5fc90b2a13e9b4b13732e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a60e232284fc5fc90b2a13e9b4b13732e">cluster::ClusterCrawlerAlg::fMaxTime</a></div><div class="ttdeci">unsigned int fMaxTime</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00302">ClusterCrawlerAlg.h:302</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a30650db252abe7e94f61094395ea2d5c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a30650db252abe7e94f61094395ea2d5c">cluster::ClusterCrawlerAlg::fDebugWire</a></div><div class="ttdeci">int fDebugWire</div><div class="ttdoc">set to the Begin Wire and Hit of a cluster to print </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00225">ClusterCrawlerAlg.h:225</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_a96e0e287a1ba1c4d360cefa28ddc289d"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a96e0e287a1ba1c4d360cefa28ddc289d">cluster::ClusterCrawlerAlg::VtxStore::Topo</a></div><div class="ttdeci">short Topo</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00093">ClusterCrawlerAlg.h:93</a></div></div>
<div class="ttc" id="namespaceevd_html_a911fe581afad27a720ee200bd61362a6"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">evd::err</a></div><div class="ttdeci">EResult err(const char *call)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2a/WebEVDServer_8cxx_source.html#l00138">WebEVDServer.cxx:138</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a9453748558088ae22499027391c13aaf"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a9453748558088ae22499027391c13aaf">right</a></div><div class="ttdeci">walls no right</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a55a0a9027b02fdf94a183b6a2a4a0ba5"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a55a0a9027b02fdf94a183b6a2a4a0ba5">cluster::ClusterCrawlerAlg::ClusterStore::BeginTim</a></div><div class="ttdeci">float BeginTim</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00070">ClusterCrawlerAlg.h:70</a></div></div>
<div class="ttc" id="namespacegeo_html_aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#aca2efd2e6b858cf0a9c12384c3b2f486a207f188eac7c200d49bbf9abdb547015">geo::kX</a></div><div class="ttdoc">Planes which measure X direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00134">geo_types.h:134</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a></div><div class="ttdoc">The data type to uniquely identify a Plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00472">geo_types.h:472</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac69af5b1750a4cd40084afe879aeb271"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac69af5b1750a4cd40084afe879aeb271">cluster::ClusterCrawlerAlg::CheckClusterHitFrac</a></div><div class="ttdeci">void CheckClusterHitFrac(bool prt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04099">ClusterCrawlerAlg.cxx:4099</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="RawTypes_8h_html"><div class="ttname"><a href="../../d9/d38/RawTypes_8h.html">RawTypes.h</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a726fd2493300deadcdf94ca80bbbc9a0"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">detinfo::DetectorPropertiesData::Temperature</a></div><div class="ttdeci">double Temperature() const </div><div class="ttdoc">In kelvin. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00081">DetectorPropertiesData.cc:81</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ab6cb532b93758fa2366c4b1218a94f73"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ab6cb532b93758fa2366c4b1218a94f73">recob::Hit::SigmaPeakAmplitude</a></div><div class="ttdeci">float SigmaPeakAmplitude() const </div><div class="ttdoc">Uncertainty on estimated amplitude of the hit at its peak, in ADC units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00222">Hit.h:222</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a6dcd1e087338846c0fe7600afe6d031c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a6dcd1e087338846c0fe7600afe6d031c">recob::Hit::SigmaIntegral</a></div><div class="ttdeci">float SigmaIntegral() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00225">Hit.h:225</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a7bfb977448289e8e1dd838b92598e854"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7bfb977448289e8e1dd838b92598e854">cluster::ClusterCrawlerAlg::clEndSlp</a></div><div class="ttdeci">float clEndSlp</div><div class="ttdoc">slope at the end (= US end = low wire number) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00263">ClusterCrawlerAlg.h:263</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_ab6024e5af06408e94099db102e7d54a9"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab6024e5af06408e94099db102e7d54a9">cluster::ClusterCrawlerAlg::ClusterStore::EndSlp</a></div><div class="ttdeci">float EndSlp</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00074">ClusterCrawlerAlg.h:74</a></div></div>
<div class="ttc" id="decoderTools__icarus_8fcl_html_a354f38d9de96bb61d859209df29980d8"><div class="ttname"><a href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a></div><div class="ttdeci">BEGIN_PROLOG StartTick</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d79/decoderTools__icarus_8fcl_source.html#l00007">decoderTools_icarus.fcl:7</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa659c4e326fc21a0be8331f5d09ed16b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa659c4e326fc21a0be8331f5d09ed16b">cluster::ClusterCrawlerAlg::SortByMultiplet</a></div><div class="ttdeci">static bool SortByMultiplet(recob::Hit const &amp;a, recob::Hit const &amp;b)</div><div class="ttdoc">Comparison for sorting hits by wire and hit multiplet. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00136">ClusterCrawlerAlg.cxx:136</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5777e2db6b5db18dbc7c37604573d8cc"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5777e2db6b5db18dbc7c37604573d8cc">cluster::ClusterCrawlerAlg::fMinHitFrac</a></div><div class="ttdeci">float fMinHitFrac</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00211">ClusterCrawlerAlg.h:211</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a527588716fca18a0ce4a2c8598970a9c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a527588716fca18a0ce4a2c8598970a9c">cluster::ClusterCrawlerAlg::fMaxWirSkip</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; fMaxWirSkip</div><div class="ttdoc">max number of wires that can be skipped while crawling </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00187">ClusterCrawlerAlg.h:187</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae35fd8349af71e9cb254e542a815366a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae35fd8349af71e9cb254e542a815366a">cluster::ClusterCrawlerAlg::ChkClusterDS</a></div><div class="ttdeci">void ChkClusterDS()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00991">ClusterCrawlerAlg.cxx:991</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5b4ccf0120f3097f2aa305a7459f225c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5b4ccf0120f3097f2aa305a7459f225c">cluster::ClusterCrawlerAlg::fRefineVertexClusters</a></div><div class="ttdeci">bool fRefineVertexClusters</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00197">ClusterCrawlerAlg.h:197</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ae09e4534734533595663f0dc6901f30b"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ae09e4534734533595663f0dc6901f30b">recob::Hit::DegreesOfFreedom</a></div><div class="ttdeci">int DegreesOfFreedom() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00229">Hit.h:229</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a3e0d167db363157bbca3d62a8e144014"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3e0d167db363157bbca3d62a8e144014">cluster::ClusterCrawlerAlg::Vtx3Store::TPC</a></div><div class="ttdeci">unsigned short TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00110">ClusterCrawlerAlg.h:110</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a8676add2af93850a5b6e50e0e58b35dd"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8676add2af93850a5b6e50e0e58b35dd">cluster::ClusterCrawlerAlg::ClusterStore::BeginSlp</a></div><div class="ttdeci">float BeginSlp</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00066">ClusterCrawlerAlg.h:66</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5929c3e8608a879b04720f7d74e01c15"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5929c3e8608a879b04720f7d74e01c15">cluster::ClusterCrawlerAlg::MergeHits</a></div><div class="ttdeci">void MergeHits(const unsigned int theHit, bool &amp;didMerge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01570">ClusterCrawlerAlg.cxx:1570</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a56d1f73abc060c2612250d473ef59387"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a56d1f73abc060c2612250d473ef59387">cluster::ClusterCrawlerAlg::ClusterStore::ID</a></div><div class="ttdeci">short ID</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00062">ClusterCrawlerAlg.h:62</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a98fe3ce584899b6f824260d8b4153bd8"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a98fe3ce584899b6f824260d8b4153bd8">recob::Hit::Integral</a></div><div class="ttdeci">float Integral() const </div><div class="ttdoc">Integral under the calibrated signal waveform of the hit, in tick x ADC units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00224">Hit.h:224</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html">cluster::ClusterCrawlerAlg::ClusterStore</a></div><div class="ttdoc">struct of temporary clusters </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00061">ClusterCrawlerAlg.h:61</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a025b7a27fcb52523170cf0e0b2ab5c03"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a025b7a27fcb52523170cf0e0b2ab5c03">recob::Hit::View</a></div><div class="ttdeci">geo::View_t View() const </div><div class="ttdoc">View for the plane of the hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00232">Hit.h:232</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ac303d2971eb9697f3a65821bb92bb934"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">geo::WireID::Wire</a></div><div class="ttdeci">WireID_t Wire</div><div class="ttdoc">Index of the wire within its plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00580">geo_types.h:580</a></div></div>
<div class="ttc" id="rawtorootconvert_8fcl_html_a073d3febd81cab639f2a8aa357dc5ef1"><div class="ttname"><a href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a></div><div class="ttdeci">process_name E</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3a/rawtorootconvert_8fcl_source.html#l00026">rawtorootconvert.fcl:26</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a04d966c0d44b4209bea5d3da76446a5e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a04d966c0d44b4209bea5d3da76446a5e">cluster::ClusterCrawlerAlg::FixMultipletLocalIndices</a></div><div class="ttdeci">void FixMultipletLocalIndices(size_t begin, size_t end, short int multiplicity=-1)</div><div class="ttdoc">Resets the local index and multiplicity of all the hits in [begin;end[. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01730">ClusterCrawlerAlg.cxx:1730</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af057de7165e772a5695df4a064cabe3c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af057de7165e772a5695df4a064cabe3c">cluster::ClusterCrawlerAlg::fMinAmp</a></div><div class="ttdeci">std::vector&lt; float &gt; fMinAmp</div><div class="ttdoc">expected minimum signal in each wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00199">ClusterCrawlerAlg.h:199</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad073b5da0ef5114b44a1f5eeb06a0006"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad073b5da0ef5114b44a1f5eeb06a0006">cluster::ClusterCrawlerAlg::VtxClusterSplit</a></div><div class="ttdeci">bool VtxClusterSplit()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01432">ClusterCrawlerAlg.cxx:1432</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa9d495b3c3ae3f79d54c8485b8fdf21c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa9d495b3c3ae3f79d54c8485b8fdf21c">cluster::ClusterCrawlerAlg::clCTP</a></div><div class="ttdeci">CTP_t clCTP</div><div class="ttdoc">Cryostat/TPC/Plane code. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00292">ClusterCrawlerAlg.h:292</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6e1c4254b5dac21b1f0186a1ea60f105"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e1c4254b5dac21b1f0186a1ea60f105">cluster::ClusterCrawlerAlg::fMergeChgCut</a></div><div class="ttdeci">std::vector&lt; float &gt; fMergeChgCut</div><div class="ttdoc">max charge ratio for matching </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00192">ClusterCrawlerAlg.h:192</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad9d2b8dd2a0bb08beb186344017c899f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad9d2b8dd2a0bb08beb186344017c899f">cluster::ClusterCrawlerAlg::DoCA</a></div><div class="ttdeci">float DoCA(short icl, unsigned short end, float vwire, float vtick)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06194">ClusterCrawlerAlg.cxx:6194</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aea1a48886fba2a2f50aca28e04288dd6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aea1a48886fba2a2f50aca28e04288dd6">cluster::ClusterCrawlerAlg::fHitErrFac</a></div><div class="ttdeci">float fHitErrFac</div><div class="ttdoc">hit time error = fHitErrFac * hit RMS used for cluster fit </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00208">ClusterCrawlerAlg.h:208</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_aa5ed1389f3ba40946c6f78a53a1a3c4e"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#aa5ed1389f3ba40946c6f78a53a1a3c4e">recob::Hit::GoodnessOfFit</a></div><div class="ttdeci">float GoodnessOfFit() const </div><div class="ttdoc">Degrees of freedom in the determination of the hit signal shape (-1 by default) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00228">Hit.h:228</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6d9ae2c8c6032bfe26f87f1a8cdaa35c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d9ae2c8c6032bfe26f87f1a8cdaa35c">cluster::ClusterCrawlerAlg::GetHitRange</a></div><div class="ttdeci">void GetHitRange(CTP_t CTP)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05999">ClusterCrawlerAlg.cxx:5999</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5d467b21f13ff1ed18c216b6f77ffb38"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d467b21f13ff1ed18c216b6f77ffb38">cluster::ClusterCrawlerAlg::AngleFactor</a></div><div class="ttdeci">float AngleFactor(float slope)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04378">ClusterCrawlerAlg.cxx:4378</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a80a16f0754f476255f20465678563ada"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a80a16f0754f476255f20465678563ada">recob::Hit::Multiplicity</a></div><div class="ttdeci">short int Multiplicity() const </div><div class="ttdoc">How many hits could this one be shared with. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00226">Hit.h:226</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a2cc520b1d1bf8b97a23a7701409e5132"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cc520b1d1bf8b97a23a7701409e5132">cluster::ClusterCrawlerAlg::geom</a></div><div class="ttdeci">art::ServiceHandle&lt; geo::Geometry const  &gt; geom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00245">ClusterCrawlerAlg.h:245</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5d8b5b5bd07dd6eae241251eb585b174"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5d8b5b5bd07dd6eae241251eb585b174">cluster::ClusterCrawlerAlg::AddLAHit</a></div><div class="ttdeci">void AddLAHit(unsigned int kwire, bool &amp;ChkCharge, bool &amp;HitOK, bool &amp;SigOK)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04523">ClusterCrawlerAlg.cxx:4523</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a6d03436d29fa7a018272ab3c92da6459"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a6d03436d29fa7a018272ab3c92da6459">cluster::ClusterCrawlerAlg::Vtx3Store::XErr</a></div><div class="ttdeci">float XErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00103">ClusterCrawlerAlg.h:103</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a82d67757957951b41909a2e2b0a70848"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a82d67757957951b41909a2e2b0a70848">cluster::ClusterCrawlerAlg::fKillGarbageClusters</a></div><div class="ttdeci">float fKillGarbageClusters</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00201">ClusterCrawlerAlg.h:201</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html">cluster::ClusterCrawlerAlg::Vtx3Store</a></div><div class="ttdoc">struct of temporary 3D vertices </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00100">ClusterCrawlerAlg.h:100</a></div></div>
<div class="ttc" id="sbnd__flashalgo_8fcl_html_a648c7afac4085c93cd1ba4a75dfe8818"><div class="ttname"><a href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a></div><div class="ttdeci">BEGIN_PROLOG TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d22/sbnd__flashalgo_8fcl_source.html#l00014">sbnd_flashalgo.fcl:14</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae16df020c6e7bc7000d3ea81df25ffbb"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae16df020c6e7bc7000d3ea81df25ffbb">cluster::ClusterCrawlerAlg::fAveHitWidth</a></div><div class="ttdeci">float fAveHitWidth</div><div class="ttdoc">average width (EndTick - StartTick) of hits </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00239">ClusterCrawlerAlg.h:239</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a19162b3f110b582827d10ba216ced7ab"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a19162b3f110b582827d10ba216ced7ab">cluster::ClusterCrawlerAlg::fNumWires</a></div><div class="ttdeci">unsigned int fNumWires</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00301">ClusterCrawlerAlg.h:301</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3e95dc0b1cda1a1ee80dae316333d76d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3e95dc0b1cda1a1ee80dae316333d76d">cluster::ClusterCrawlerAlg::FclTrimUS</a></div><div class="ttdeci">void FclTrimUS(unsigned short nTrim)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00871">ClusterCrawlerAlg.cxx:871</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3a4f8ceff8265eae806631f909f54349"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a4f8ceff8265eae806631f909f54349">cluster::ClusterCrawlerAlg::CrawlVtxChk</a></div><div class="ttdeci">bool CrawlVtxChk(unsigned int kwire)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01210">ClusterCrawlerAlg.cxx:1210</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a66a8ca741d5d163713ed6e6548b9716b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a66a8ca741d5d163713ed6e6548b9716b">cluster::ClusterCrawlerAlg::DecodeCTP</a></div><div class="ttdeci">static geo::PlaneID DecodeCTP(CTP_t CTP)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00052">ClusterCrawlerAlg.h:52</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a74993d25361b7f0aab80e204de0a8670"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a74993d25361b7f0aab80e204de0a8670">cluster::ClusterCrawlerAlg::ClusterStore::BeginAng</a></div><div class="ttdeci">float BeginAng</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00068">ClusterCrawlerAlg.h:68</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a5a6d25fb947ac7eed319c06b5cb19327"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a5a6d25fb947ac7eed319c06b5cb19327">recob::Hit::PeakAmplitude</a></div><div class="ttdeci">float PeakAmplitude() const </div><div class="ttdoc">The estimated amplitude of the hit at its peak, in ADC units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00221">Hit.h:221</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a512aa20fb28b8c00f3d290ba176b40e1"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a512aa20fb28b8c00f3d290ba176b40e1">icarus::ns::util::bin</a></div><div class="ttdeci">constexpr details::BinObj&lt; T &gt; bin(T value)</div><div class="ttdoc">Returns a wrapper to print the specified data in binary format. </div></div>
<div class="ttc" id="structgeo_1_1WireID_html_a6c4d41481be36036bcdb3ad0b47f8b77"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#a6c4d41481be36036bcdb3ad0b47f8b77">geo::WireID::cmp</a></div><div class="ttdeci">constexpr int cmp(WireID const &amp;other) const </div><div class="ttdoc">Returns &amp;lt; 0 if this is smaller than tpcid, 0 if equal, &amp;gt; 0 if larger. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00627">geo_types.h:627</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a87dfb4de332731a6219f2393ac5d11d5"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">detinfo::DetectorPropertiesData::Efield</a></div><div class="ttdeci">double Efield(unsigned int planegap=0) const </div><div class="ttdoc">kV/cm </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00017">DetectorPropertiesData.cc:17</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac744e450bd24049bf0c1e0c1627955a3"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac744e450bd24049bf0c1e0c1627955a3">cluster::ClusterCrawlerAlg::DoMerge</a></div><div class="ttdeci">void DoMerge(unsigned short it1, unsigned short it2, short ProcCode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03161">ClusterCrawlerAlg.cxx:3161</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1f19cc2e366ab1fae56fc60994e15c01"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1f19cc2e366ab1fae56fc60994e15c01">cluster::ClusterCrawlerAlg::fHitMinAmp</a></div><div class="ttdeci">float fHitMinAmp</div><div class="ttdoc">&amp;lt; ignore hits with Amp &amp;lt; this value </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00209">ClusterCrawlerAlg.h:209</a></div></div>
<div class="ttc" id="namespaceraw_html_abcbf8ba50ca9efdbeb1a6955b040b4fe"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abcbf8ba50ca9efdbeb1a6955b040b4fe">raw::TDCtick_t</a></div><div class="ttdeci">int TDCtick_t</div><div class="ttdoc">Type representing a TDC tick. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00025">RawTypes.h:25</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aab730d0560cb8c50f0c32f1f5e4dc85a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aab730d0560cb8c50f0c32f1f5e4dc85a">cluster::ClusterCrawlerAlg::fDebugHit</a></div><div class="ttdeci">int fDebugHit</div><div class="ttdoc">out detailed information while crawling </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00226">ClusterCrawlerAlg.h:226</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af85b0b7218a61e4e8780f91bf9671a6a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af85b0b7218a61e4e8780f91bf9671a6a">cluster::ClusterCrawlerAlg::fLACrawl</a></div><div class="ttdeci">std::vector&lt; bool &gt; fLACrawl</div><div class="ttdoc">Crawl Large Angle clusters on pass? </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00194">ClusterCrawlerAlg.h:194</a></div></div>
<div class="ttc" id="decode__signalprocess__icarus_8fcl_html_a2a105cb669129f9c63eb7a4c15bf2d9b"><div class="ttname"><a href="../../d0/d8f/decode__signalprocess__icarus_8fcl.html#a2a105cb669129f9c63eb7a4c15bf2d9b">a</a></div><div class="ttdeci">process_name gaushit a</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8f/decode__signalprocess__icarus_8fcl_source.html#l00037">decode_signalprocess_icarus.fcl:37</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a0d8b579ec4dc76f22863cb0301b98ea9"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0d8b579ec4dc76f22863cb0301b98ea9">cluster::ClusterCrawlerAlg::inClus</a></div><div class="ttdeci">std::vector&lt; short &gt; inClus</div><div class="ttdoc">Hit used in cluster (-1 = obsolete, 0 = free) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00248">ClusterCrawlerAlg.h:248</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a0ab5c8c5ac41a363131d7e56c0a87ee6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0ab5c8c5ac41a363131d7e56c0a87ee6">cluster::ClusterCrawlerAlg::fLastWire</a></div><div class="ttdeci">unsigned int fLastWire</div><div class="ttdoc">the last wire with a hit </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00297">ClusterCrawlerAlg.h:297</a></div></div>
<div class="ttc" id="make__xml__premcc1_80_8sh_html_a6a381711e6b60dd64d5ecdb1d135c1b8"><div class="ttname"><a href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a></div><div class="ttdeci">then local</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d61/make__xml__premcc1_80_8sh_source.html#l00085">make_xml_premcc1.0.sh:85</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a2cd549e0b5347cab2715028d2d86bad0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2cd549e0b5347cab2715028d2d86bad0">cluster::ClusterCrawlerAlg::VtxMatch</a></div><div class="ttdeci">void VtxMatch(detinfo::DetectorClocksData const &amp;clock_data, detinfo::DetectorPropertiesData const &amp;det_prop, geo::TPCID const &amp;tpcid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05735">ClusterCrawlerAlg.cxx:5735</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a12970d85437e0625b1fb9cf08b53019c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a12970d85437e0625b1fb9cf08b53019c">cluster::ClusterCrawlerAlg::fChiCut</a></div><div class="ttdeci">std::vector&lt; float &gt; fChiCut</div><div class="ttdoc">stop adding hits to clusters if chisq too high </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00181">ClusterCrawlerAlg.h:181</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_afb874cc2087d2a1ab9153db1aca085a9"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afb874cc2087d2a1ab9153db1aca085a9">cluster::ClusterCrawlerAlg::ClusterVertexChi</a></div><div class="ttdeci">float ClusterVertexChi(short icl, unsigned short end, unsigned short ivx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06241">ClusterCrawlerAlg.cxx:6241</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_aae6378abd601aba3b9476f235787ccad"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#aae6378abd601aba3b9476f235787ccad">cluster::ClusterCrawlerAlg::Vtx3Store::ProcCode</a></div><div class="ttdeci">unsigned short ProcCode</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00111">ClusterCrawlerAlg.h:111</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_acdeca27c6e883db004b8f559339e229f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acdeca27c6e883db004b8f559339e229f">cluster::ClusterCrawlerAlg::fChgNearWindow</a></div><div class="ttdeci">float fChgNearWindow</div><div class="ttdoc">window (ticks) for finding nearby charge </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00318">ClusterCrawlerAlg.h:318</a></div></div>
<div class="ttc" id="GeometryCore_8h_html"><div class="ttname"><a href="../../db/de7/GeometryCore_8h.html">GeometryCore.h</a></div><div class="ttdoc">Access the description of detector geometry. </div></div>
<div class="ttc" id="classtrkf_1_1LinFitAlg_html_a113ec78487fa649f3dc86f711b99a1ca"><div class="ttname"><a href="../../dc/d6a/classtrkf_1_1LinFitAlg.html#a113ec78487fa649f3dc86f711b99a1ca">trkf::LinFitAlg::LinFit</a></div><div class="ttdeci">void LinFit(std::vector&lt; float &gt; &amp;x, std::vector&lt; float &gt; &amp;y, std::vector&lt; float &gt; &amp;ey2, float &amp;Intercept, float &amp;Slope, float &amp;InterceptError, float &amp;SlopeError, float &amp;ChiDOF) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d88/LinFitAlg_8cxx_source.html#l00017">LinFitAlg.cxx:17</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8033e4474bb097fb594055338162662e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8033e4474bb097fb594055338162662e">cluster::ClusterCrawlerAlg::fNumPass</a></div><div class="ttdeci">unsigned short fNumPass</div><div class="ttdoc">number of passes over the hit collection </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00176">ClusterCrawlerAlg.h:176</a></div></div>
<div class="ttc" id="Exceptions_8h_html"><div class="ttname"><a href="../../df/d7c/Exceptions_8h.html">Exceptions.h</a></div><div class="ttdoc">Collection of exceptions for Geometry system. </div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a46ae3e73aa21823d7d5ad051e0cf1398"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a46ae3e73aa21823d7d5ad051e0cf1398">cluster::ClusterCrawlerAlg::fMergeOverlapAngCut</a></div><div class="ttdeci">float fMergeOverlapAngCut</div><div class="ttdoc">angle cut for merging overlapping clusters </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00218">ClusterCrawlerAlg.h:218</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad6dc0793db18ac66a511a59d8caef68f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6dc0793db18ac66a511a59d8caef68f">cluster::ClusterCrawlerAlg::fDebugPlane</a></div><div class="ttdeci">int fDebugPlane</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00224">ClusterCrawlerAlg.h:224</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a1e5aaaf25e8609a835e8c7c6fda71456"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div><div class="ttdeci">process_name opflash particleana ie ie y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00091">run_opflash_electron.fcl:91</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_a48509e22b6681725c899fc354de43ae2"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">geo::fhicl::WireID</a></div><div class="ttdeci">IDparameter&lt; geo::WireID &gt; WireID</div><div class="ttdoc">Member type of validated geo::WireID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00407">geo_types_fhicl.h:407</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aaad45fb3b0b2528e982d272be1991367"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaad45fb3b0b2528e982d272be1991367">cluster::ClusterCrawlerAlg::fFirstWire</a></div><div class="ttdeci">unsigned int fFirstWire</div><div class="ttdoc">the first wire with a hit </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00295">ClusterCrawlerAlg.h:295</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6e2556bd8ebea2e76b849c6862bffcd6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6e2556bd8ebea2e76b849c6862bffcd6">cluster::ClusterCrawlerAlg::TmpStore</a></div><div class="ttdeci">bool TmpStore()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03483">ClusterCrawlerAlg.cxx:3483</a></div></div>
<div class="ttc" id="DetectorPropertiesData_8h_html"><div class="ttname"><a href="../../d5/d7a/DetectorPropertiesData_8h.html">DetectorPropertiesData.h</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a22c1f51a60dbbd5bfd92c48c68e6d3f0"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a22c1f51a60dbbd5bfd92c48c68e6d3f0">cluster::ClusterCrawlerAlg::Vtx3Store::X</a></div><div class="ttdeci">float X</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00102">ClusterCrawlerAlg.h:102</a></div></div>
<div class="ttc" id="structCluLen_html_aeb663404d4e43977d0d71780c784426d"><div class="ttname"><a href="../../d2/d4d/structCluLen.html#aeb663404d4e43977d0d71780c784426d">CluLen::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00045">CCTrackMaker_module.cc:45</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad5f959d410ea2355682de90a4bc3480e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad5f959d410ea2355682de90a4bc3480e">cluster::ClusterCrawlerAlg::clEndWir</a></div><div class="ttdeci">unsigned int clEndWir</div><div class="ttdoc">begin wire </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00266">ClusterCrawlerAlg.h:266</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa52252a6114f7129b06aa5daa9e2bc15"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa52252a6114f7129b06aa5daa9e2bc15">cluster::ClusterCrawlerAlg::fVertex2DCut</a></div><div class="ttdeci">float fVertex2DCut</div><div class="ttdoc">2D vtx -&amp;gt; cluster matching cut (chisq/dof) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00220">ClusterCrawlerAlg.h:220</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad7c049849e1f020c2c4f350959286c8b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7c049849e1f020c2c4f350959286c8b">cluster::ClusterCrawlerAlg::pass</a></div><div class="ttdeci">unsigned short pass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00305">ClusterCrawlerAlg.h:305</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5671c08bac3d9085b537dd69c3ec2f70"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5671c08bac3d9085b537dd69c3ec2f70">cluster::ClusterCrawlerAlg::FindHammerClusters</a></div><div class="ttdeci">void FindHammerClusters(detinfo::DetectorClocksData const &amp;clock_data, detinfo::DetectorPropertiesData const &amp;det_prop)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05546">ClusterCrawlerAlg.cxx:5546</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aeb26863a1a3a9c86dd5673819ad86341"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb26863a1a3a9c86dd5673819ad86341">cluster::ClusterCrawlerAlg::fFindStarVertices</a></div><div class="ttdeci">bool fFindStarVertices</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00204">ClusterCrawlerAlg.h:204</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a9b84611cc9f69175b0f7ed339a3f337d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9b84611cc9f69175b0f7ed339a3f337d">cluster::ClusterCrawlerAlg::clBeginAng</a></div><div class="ttdeci">float clBeginAng</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00257">ClusterCrawlerAlg.h:257</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a61472a6eb18587b340e8b9393988f860"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a61472a6eb18587b340e8b9393988f860">cluster::ClusterCrawlerAlg::fKinkAngCut</a></div><div class="ttdeci">std::vector&lt; float &gt; fKinkAngCut</div><div class="ttdoc">kink angle cut made after fKinkChiRat </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00184">ClusterCrawlerAlg.h:184</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aaee600565a55502e2b16b2688b56b711"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aaee600565a55502e2b16b2688b56b711">cluster::ClusterCrawlerAlg::MergeOverlap</a></div><div class="ttdeci">void MergeOverlap()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00645">ClusterCrawlerAlg.cxx:645</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1a6412b96d8eb267030404acaa65fdf5"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1a6412b96d8eb267030404acaa65fdf5">cluster::ClusterCrawlerAlg::fAllowNoHitWire</a></div><div class="ttdeci">unsigned short fAllowNoHitWire</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00219">ClusterCrawlerAlg.h:219</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5303b6fbc6c046ca98e44226664eb14f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5303b6fbc6c046ca98e44226664eb14f">cluster::ClusterCrawlerAlg::fVertex3DCut</a></div><div class="ttdeci">float fVertex3DCut</div><div class="ttdoc">2D vtx -&amp;gt; 3D vtx matching cut (chisq/dof) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00222">ClusterCrawlerAlg.h:222</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac186159f106e5376fab22d414df3dee8"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac186159f106e5376fab22d414df3dee8">cluster::ClusterCrawlerAlg::LACrawlUS</a></div><div class="ttdeci">void LACrawlUS()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03576">ClusterCrawlerAlg.cxx:3576</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab1a1548e9cfa55dfb1b94a56ac7b718b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab1a1548e9cfa55dfb1b94a56ac7b718b">cluster::ClusterCrawlerAlg::VtxConstraint</a></div><div class="ttdeci">void VtxConstraint(unsigned int iwire, unsigned int ihit, unsigned int jwire, unsigned int &amp;useHit, bool &amp;doConstrain)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01228">ClusterCrawlerAlg.cxx:1228</a></div></div>
<div class="ttc" id="namespacesortDataLoggerFiles_html_a372f3a4986e0eb3afba9eac64b63a4f3"><div class="ttname"><a href="../../d3/d46/namespacesortDataLoggerFiles.html#a372f3a4986e0eb3afba9eac64b63a4f3">sortDataLoggerFiles.nDuplicates</a></div><div class="ttdeci">int nDuplicates</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc8/sortDataLoggerFiles_8py_source.html#l00423">sortDataLoggerFiles.py:423</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a9e54c620da947807c84e514f59a284e7"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a9e54c620da947807c84e514f59a284e7">cluster::ClusterCrawlerAlg::ClusterStore::EndSlpErr</a></div><div class="ttdeci">float EndSlpErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00076">ClusterCrawlerAlg.h:76</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a1a08bc762b79d6e1d7816c34d3e36f78"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">util::quantities::tick</a></div><div class="ttdeci">tick_as&lt;&gt; tick</div><div class="ttdoc">Tick number, represented by std::ptrdiff_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00075">electronics.h:75</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a359d6255bb14f321d76e6085204ea52a"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">detinfo::DetectorPropertiesData::ConvertXToTicks</a></div><div class="ttdeci">double ConvertXToTicks(double X, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00099">DetectorPropertiesData.cc:99</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a8e96256bdd6b3d31eb10fd1077751cd7"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a8e96256bdd6b3d31eb10fd1077751cd7">cluster::ClusterCrawlerAlg::ClusterStore::BeginChg</a></div><div class="ttdeci">float BeginChg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00071">ClusterCrawlerAlg.h:71</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a2df3120f005ae20a8b307aada42e7c0d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2df3120f005ae20a8b307aada42e7c0d">cluster::ClusterCrawlerAlg::CalculateAveHitWidth</a></div><div class="ttdeci">void CalculateAveHitWidth()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04392">ClusterCrawlerAlg.cxx:4392</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a6b0f622c0a10cb71d47d2bc82f35c58b"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a6b0f622c0a10cb71d47d2bc82f35c58b">detinfo::DetectorPropertiesData::NumberTimeSamples</a></div><div class="ttdeci">unsigned int NumberTimeSamples() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00057">DetectorPropertiesData.cc:57</a></div></div>
<div class="ttc" id="classlariov_1_1ChannelStatusProvider_html_a17471560041631ee3f09c578987141f5"><div class="ttname"><a href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html#a17471560041631ee3f09c578987141f5">lariov::ChannelStatusProvider::IsGood</a></div><div class="ttdeci">virtual bool IsGood(raw::ChannelID_t channel) const </div><div class="ttdoc">Returns whether the specified channel is physical and good. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/ChannelStatusProvider_8h_source.html#l00084">ChannelStatusProvider.h:84</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a67d7ff71d4cf0ac3884a4e33edd9d656"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a67d7ff71d4cf0ac3884a4e33edd9d656">cluster::ClusterCrawlerAlg::fLAClusMaxHitsFit</a></div><div class="ttdeci">unsigned short fLAClusMaxHitsFit</div><div class="ttdoc">max hits fitted on a Large Angle cluster </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00213">ClusterCrawlerAlg.h:213</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af170134ded6d03cf31ef1a3b1006100d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af170134ded6d03cf31ef1a3b1006100d">cluster::ClusterCrawlerAlg::FindVertices</a></div><div class="ttdeci">void FindVertices()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02051">ClusterCrawlerAlg.cxx:2051</a></div></div>
<div class="ttc" id="namespacecluster_html_a36f9a5cf912f4a4e1c011b3621345c7b"><div class="ttname"><a href="../../de/d1b/namespacecluster.html#a36f9a5cf912f4a4e1c011b3621345c7b">cluster::SortByLowHit</a></div><div class="ttdeci">bool SortByLowHit(unsigned int i, unsigned int j)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00130">ClusterCrawlerAlg.cxx:130</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac72a32ad6f91532360cf52fae527c3d9"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac72a32ad6f91532360cf52fae527c3d9">cluster::ClusterCrawlerAlg::MakeClusterObsolete</a></div><div class="ttdeci">void MakeClusterObsolete(unsigned short icl)</div><div class="ttdoc">Marks the cluster as obsolete and frees hits still associated with it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00838">ClusterCrawlerAlg.cxx:838</a></div></div>
<div class="ttc" id="classlariov_1_1ChannelStatusProvider_html"><div class="ttname"><a href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a></div><div class="ttdoc">Class providing information about the quality of channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/ChannelStatusProvider_8h_source.html#l00049">ChannelStatusProvider.h:49</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a624d46525fee10d65ad19454cd202ca8"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a624d46525fee10d65ad19454cd202ca8">cluster::ClusterCrawlerAlg::fKinkChiRat</a></div><div class="ttdeci">std::vector&lt; float &gt; fKinkChiRat</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00182">ClusterCrawlerAlg.h:182</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a708f2fb1311c59628cdd42a2d7ece9af"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a708f2fb1311c59628cdd42a2d7ece9af">cluster::ClusterCrawlerAlg::RestoreObsoleteCluster</a></div><div class="ttdeci">void RestoreObsoleteCluster(unsigned short icl)</div><div class="ttdoc">Restores an obsolete cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00855">ClusterCrawlerAlg.cxx:855</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a196638f61b283ba58bb480ee9a8fed92"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a196638f61b283ba58bb480ee9a8fed92">cluster::ClusterCrawlerAlg::TmpGet</a></div><div class="ttdeci">void TmpGet(unsigned short it1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03454">ClusterCrawlerAlg.cxx:3454</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a5667a83a4014a59ccd6c2a0d0fbb58c1"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">detinfo::DetectorPropertiesData::DriftVelocity</a></div><div class="ttdeci">double DriftVelocity(double efield=0., double temperature=0.) const </div><div class="ttdoc">cm/us </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00023">DetectorPropertiesData.cc:23</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6eb30d981381f693ca3a13a0c53aaa43"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6eb30d981381f693ca3a13a0c53aaa43">cluster::ClusterCrawlerAlg::fFindVertices</a></div><div class="ttdeci">std::vector&lt; bool &gt; fFindVertices</div><div class="ttdoc">run vertexing code after clustering? </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00193">ClusterCrawlerAlg.h:193</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a></div><div class="ttdoc">The data type to uniquely identify a TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00386">geo_types.h:386</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a4a36846e9c06367673aa840657302a84"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4a36846e9c06367673aa840657302a84">cluster::ClusterCrawlerAlg::ClusterStore::BeginVtx</a></div><div class="ttdeci">short BeginVtx</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00073">ClusterCrawlerAlg.h:73</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a9b13b337eb09f2e3eeafdb6d1d0344ad"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a9b13b337eb09f2e3eeafdb6d1d0344ad">recob::Hit::StartTick</a></div><div class="ttdeci">raw::TDCtick_t StartTick() const </div><div class="ttdoc">Initial tdc tick for hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00216">Hit.h:216</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8de23ef65f2692105196fba4bc9fe5d1"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8de23ef65f2692105196fba4bc9fe5d1">cluster::ClusterCrawlerAlg::clBeginSlp</a></div><div class="ttdeci">float clBeginSlp</div><div class="ttdoc">begin slope (= DS end = high wire number) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00256">ClusterCrawlerAlg.h:256</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a37100ea309374ccc4dcb57e256c7cbcc"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a37100ea309374ccc4dcb57e256c7cbcc">cluster::ClusterCrawlerAlg::FindHitMultiplet</a></div><div class="ttdeci">std::pair&lt; size_t, size_t &gt; FindHitMultiplet(size_t iHit) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06161">ClusterCrawlerAlg.cxx:6161</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6373baa62e9675c237544549d0706131"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6373baa62e9675c237544549d0706131">cluster::ClusterCrawlerAlg::clEndAng</a></div><div class="ttdeci">float clEndAng</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00264">ClusterCrawlerAlg.h:264</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aee01270a20c9e7a83c0ff2919a532e57"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aee01270a20c9e7a83c0ff2919a532e57">cluster::ClusterCrawlerAlg::fMaxHitsFit</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; fMaxHitsFit</div><div class="ttdoc">Max number of hits fitted. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00177">ClusterCrawlerAlg.h:177</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a14e714d1c89866d097b3e62425f4ec16"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a14e714d1c89866d097b3e62425f4ec16">recob::Hit::PeakTimeMinusRMS</a></div><div class="ttdeci">float PeakTimeMinusRMS(float sigmas=+1.) const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00239">Hit.h:239</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad7a523546da7313b6b9dbbda9602bf3c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad7a523546da7313b6b9dbbda9602bf3c">cluster::ClusterCrawlerAlg::fVtxClusterSplit</a></div><div class="ttdeci">bool fVtxClusterSplit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00203">ClusterCrawlerAlg.h:203</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_acf98ed85481afbf7edb230a7e372a375"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#acf98ed85481afbf7edb230a7e372a375">cluster::ClusterCrawlerAlg::Vtx3Store::Ptr2D</a></div><div class="ttdeci">std::array&lt; short, 3 &gt; Ptr2D</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00101">ClusterCrawlerAlg.h:101</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8a434cc4266597b18bcefeb453d38df6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a434cc4266597b18bcefeb453d38df6">cluster::ClusterCrawlerAlg::PrintHit</a></div><div class="ttdeci">std::string PrintHit(unsigned int iht)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06328">ClusterCrawlerAlg.cxx:6328</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab59e0cef186198df36ecdbf47b723d46"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab59e0cef186198df36ecdbf47b723d46">cluster::ClusterCrawlerAlg::ClusterInit</a></div><div class="ttdeci">void ClusterInit()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00193">ClusterCrawlerAlg.cxx:193</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a9dd41b9884a11ee5ffb1123e66ee2a08"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9dd41b9884a11ee5ffb1123e66ee2a08">cluster::ClusterCrawlerAlg::CrawlInit</a></div><div class="ttdeci">void CrawlInit()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00160">ClusterCrawlerAlg.cxx:160</a></div></div>
<div class="ttc" id="namespaceutil_html_aaae39c2a7066e6a24ff172e5471939ae"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#aaae39c2a7066e6a24ff172e5471939ae">util::absDiff</a></div><div class="ttdeci">constexpr auto absDiff(A const &amp;a, B const &amp;b)</div><div class="ttdoc">Returns the absolute value of the difference between two values. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d16/NumericUtils_8h_source.html#l00043">NumericUtils.h:43</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_ade2aac44dcda72660adf80bd11cf459a"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ade2aac44dcda72660adf80bd11cf459a">cluster::ClusterCrawlerAlg::ClusterStore::EndChgNear</a></div><div class="ttdeci">float EndChgNear</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00080">ClusterCrawlerAlg.h:80</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6d028e6a1225141ebf08f14874d804d1"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6d028e6a1225141ebf08f14874d804d1">cluster::ClusterCrawlerAlg::clStopCode</a></div><div class="ttdeci">short clStopCode</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00270">ClusterCrawlerAlg.h:270</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af090c5893915f49fb66f03c6c2afd7c6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af090c5893915f49fb66f03c6c2afd7c6">cluster::ClusterCrawlerAlg::EncodeCTP</a></div><div class="ttdeci">static CTP_t EncodeCTP(unsigned int cryo, unsigned int tpc, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00042">ClusterCrawlerAlg.h:42</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a85d092ccf44a4e6817a0b8c4c44c4d29"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a85d092ccf44a4e6817a0b8c4c44c4d29">cluster::ClusterCrawlerAlg::clChisq</a></div><div class="ttdeci">float clChisq</div><div class="ttdoc">chisq of the current fit </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00235">ClusterCrawlerAlg.h:235</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8e4b4b8d755ffded5a9f956ae7c9c1ec"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">detinfo::DetectorPropertiesData::ConvertTicksToX</a></div><div class="ttdeci">double ConvertTicksToX(double ticks, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00115">DetectorPropertiesData.cc:115</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a5f21b9b8e520187343b515134e058fdb"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a5f21b9b8e520187343b515134e058fdb">recob::Hit::EndTick</a></div><div class="ttdeci">raw::TDCtick_t EndTick() const </div><div class="ttdoc">Final tdc tick for hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00217">Hit.h:217</a></div></div>
<div class="ttc" id="structCluLen_html_af2b4b8f0fe8bc09b99b0dbffbdf543d9"><div class="ttname"><a href="../../d2/d4d/structCluLen.html#af2b4b8f0fe8bc09b99b0dbffbdf543d9">CluLen::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00044">CCTrackMaker_module.cc:44</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="CCTrackMaker__module_8cc_html_a60fd6c12d997bc64d7d3ac6835841fe0"><div class="ttname"><a href="../../d1/db9/CCTrackMaker__module_8cc.html#a60fd6c12d997bc64d7d3ac6835841fe0">greaterThan</a></div><div class="ttdeci">bool greaterThan(CluLen c1, CluLen c2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db9/CCTrackMaker__module_8cc_source.html#l00049">CCTrackMaker_module.cc:49</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a7036ba126203d462641e8301886e8089"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7036ba126203d462641e8301886e8089">cluster::ClusterCrawlerAlg::CrawlVtxChk2</a></div><div class="ttdeci">bool CrawlVtxChk2()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01174">ClusterCrawlerAlg.cxx:1174</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a05e3e714fb93ebb939a74852b1a61090"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05e3e714fb93ebb939a74852b1a61090">cluster::ClusterCrawlerAlg::CheckHitClusterAssociations</a></div><div class="ttdeci">void CheckHitClusterAssociations()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00891">ClusterCrawlerAlg.cxx:891</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa5b2407d1d2fcd79cd00bc06b61de952"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa5b2407d1d2fcd79cd00bc06b61de952">cluster::ClusterCrawlerAlg::NClusters</a></div><div class="ttdeci">unsigned short NClusters</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00243">ClusterCrawlerAlg.h:243</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a15f2d1927f94988c3b6a0fbb6b7b22c4"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a15f2d1927f94988c3b6a0fbb6b7b22c4">cluster::ClusterCrawlerAlg::ClusterStore::EndVtx</a></div><div class="ttdeci">short EndVtx</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00081">ClusterCrawlerAlg.h:81</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a607df530372f45f854939e884f7be864"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a607df530372f45f854939e884f7be864">cluster::ClusterCrawlerAlg::KillGarbageClusters</a></div><div class="ttdeci">void KillGarbageClusters()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00508">ClusterCrawlerAlg.cxx:508</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a5adbaedc9f9546e02d9d64e719008fbf"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a5adbaedc9f9546e02d9d64e719008fbf">cluster::ClusterCrawlerAlg::ClusterStore::StopCode</a></div><div class="ttdeci">short StopCode</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00064">ClusterCrawlerAlg.h:64</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a80b4080f43f142fa640927ae42144351"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80b4080f43f142fa640927ae42144351">cluster::ClusterCrawlerAlg::clLA</a></div><div class="ttdeci">bool clLA</div><div class="ttdoc">using Large Angle crawling code </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00293">ClusterCrawlerAlg.h:293</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae22c9c9c2ddc0e17bbd8dcd54307f2c3"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae22c9c9c2ddc0e17bbd8dcd54307f2c3">cluster::ClusterCrawlerAlg::fHits</a></div><div class="ttdeci">std::vector&lt; recob::Hit &gt; fHits</div><div class="ttdoc">our version of the hits </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00247">ClusterCrawlerAlg.h:247</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a6ee5408e80d6b9213e500d10502dd7fb"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a6ee5408e80d6b9213e500d10502dd7fb">cluster::ClusterCrawlerAlg::fMinHits</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; fMinHits</div><div class="ttdoc">Min number of hits to make a cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00178">ClusterCrawlerAlg.h:178</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_acdc68ea59936cecf0387be783dff3305"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#acdc68ea59936cecf0387be783dff3305">cluster::ClusterCrawlerAlg::ClusterStore::EndTim</a></div><div class="ttdeci">float EndTim</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00078">ClusterCrawlerAlg.h:78</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_a260b6cb16549f915461f4f58e03e7640"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a260b6cb16549f915461f4f58e03e7640">cluster::ClusterCrawlerAlg::VtxStore::Time</a></div><div class="ttdeci">float Time</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00089">ClusterCrawlerAlg.h:89</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_acbb44f1a8557eb5f0ae08804ef4dd539"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#acbb44f1a8557eb5f0ae08804ef4dd539">cluster::ClusterCrawlerAlg::VtxStore::CTP</a></div><div class="ttdeci">CTP_t CTP</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00095">ClusterCrawlerAlg.h:95</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ae41e650eecb0a4b3a162217e5bcd8d15"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ae41e650eecb0a4b3a162217e5bcd8d15">cluster::ClusterCrawlerAlg::clEndChg</a></div><div class="ttdeci">float clEndChg</div><div class="ttdoc">end average charge </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00268">ClusterCrawlerAlg.h:268</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ab7f5a537d51d9303c52b99c41b677750"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ab7f5a537d51d9303c52b99c41b677750">cluster::ClusterCrawlerAlg::chifits</a></div><div class="ttdeci">std::vector&lt; float &gt; chifits</div><div class="ttdoc">fit chisq for monitoring kinks, etc </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00313">ClusterCrawlerAlg.h:313</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_acefce1d7b466091ee4ca09f1d1c25140"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acefce1d7b466091ee4ca09f1d1c25140">cluster::ClusterCrawlerAlg::FitCluster</a></div><div class="ttdeci">void FitCluster()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04278">ClusterCrawlerAlg.cxx:4278</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aebcf931a8bbac804a790bdd403624e2e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aebcf931a8bbac804a790bdd403624e2e">cluster::ClusterCrawlerAlg::cstat</a></div><div class="ttdeci">unsigned int cstat</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00298">ClusterCrawlerAlg.h:298</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a434c10cf9f0b913248fc9138bcf0fa90"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a434c10cf9f0b913248fc9138bcf0fa90">cluster::ClusterCrawlerAlg::clBeginWir</a></div><div class="ttdeci">unsigned int clBeginWir</div><div class="ttdoc">begin wire </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00259">ClusterCrawlerAlg.h:259</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_abf2b9ef4e564db0fbc6241c25c0e27c1"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#abf2b9ef4e564db0fbc6241c25c0e27c1">cluster::ClusterCrawlerAlg::clProcCode</a></div><div class="ttdeci">short clProcCode</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00280">ClusterCrawlerAlg.h:280</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_acf5328a94c57ece07426a7de1b9ce06b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#acf5328a94c57ece07426a7de1b9ce06b">cluster::ClusterCrawlerAlg::ClusterVertex</a></div><div class="ttdeci">void ClusterVertex(unsigned short it2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02296">ClusterCrawlerAlg.cxx:2296</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_ac0c2bbb6d8063494aae93d6216ded183"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ac0c2bbb6d8063494aae93d6216ded183">cluster::ClusterCrawlerAlg::ClusterStore::tclhits</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; tclhits</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00082">ClusterCrawlerAlg.h:82</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_abd3aec0c3e72090d5ec11d217593aac8"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#abd3aec0c3e72090d5ec11d217593aac8">cluster::ClusterCrawlerAlg::VtxStore::WireErr</a></div><div class="ttdeci">float WireErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00088">ClusterCrawlerAlg.h:88</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00102">WindowPattern.h:102</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a80c993ef6f49211a927f1f1f5392aea0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a80c993ef6f49211a927f1f1f5392aea0">cluster::ClusterCrawlerAlg::fLAClusAngleCut</a></div><div class="ttdeci">float fLAClusAngleCut</div><div class="ttdoc">call Large Angle Clustering code if &amp;gt; 0 </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00212">ClusterCrawlerAlg.h:212</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a2c5805d63f1a55dd80165b0548a70e43"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a2c5805d63f1a55dd80165b0548a70e43">cluster::ClusterCrawlerAlg::FindStarVertices</a></div><div class="ttdeci">void FindStarVertices()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01786">ClusterCrawlerAlg.cxx:1786</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3a2df1ad63698b6f00f5a3d24fa307f7"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3a2df1ad63698b6f00f5a3d24fa307f7">cluster::ClusterCrawlerAlg::mergeAvailable</a></div><div class="ttdeci">std::vector&lt; bool &gt; mergeAvailable</div><div class="ttdoc">set true if hit is with HitMergeChiCut of a neighbor hit </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00249">ClusterCrawlerAlg.h:249</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ada8c0b14f759eba132d42c242d20a398"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ada8c0b14f759eba132d42c242d20a398">cluster::ClusterCrawlerAlg::SplitCluster</a></div><div class="ttdeci">bool SplitCluster(unsigned short icl, unsigned short pos, unsigned short ivx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02698">ClusterCrawlerAlg.cxx:2698</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a851fffc7bc454064d90485206b407213"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a851fffc7bc454064d90485206b407213">cluster::ClusterCrawlerAlg::RunCrawler</a></div><div class="ttdeci">void RunCrawler(detinfo::DetectorClocksData const &amp;clock_data, detinfo::DetectorPropertiesData const &amp;det_prop, std::vector&lt; recob::Hit &gt; const &amp;srchits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00208">ClusterCrawlerAlg.cxx:208</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af1dfffb608e5fb454826dd6d0c761cde"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1dfffb608e5fb454826dd6d0c761cde">cluster::ClusterCrawlerAlg::fClProjErrFac</a></div><div class="ttdeci">float fClProjErrFac</div><div class="ttdoc">cluster projection error factor </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00210">ClusterCrawlerAlg.h:210</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa03275492ccc9ebb4850930f48772bee"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa03275492ccc9ebb4850930f48772bee">cluster::ClusterCrawlerAlg::clBeginTim</a></div><div class="ttdeci">float clBeginTim</div><div class="ttdoc">begin time </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00260">ClusterCrawlerAlg.h:260</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_af1c4c4611d90f4a278822a21a84e6533"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#af1c4c4611d90f4a278822a21a84e6533">cluster::ClusterCrawlerAlg::fVertex2DWireErrCut</a></div><div class="ttdeci">float fVertex2DWireErrCut</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00221">ClusterCrawlerAlg.h:221</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_aa132b5987e4e68c5cc3287d3da2c0e38"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#aa132b5987e4e68c5cc3287d3da2c0e38">cluster::ClusterCrawlerAlg::ClusterStore::BeginSlpErr</a></div><div class="ttdeci">float BeginSlpErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00067">ClusterCrawlerAlg.h:67</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac17d630dff6f8fe5a70627fa425abdcc"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac17d630dff6f8fe5a70627fa425abdcc">cluster::ClusterCrawlerAlg::Vtx3ClusterSplit</a></div><div class="ttdeci">void Vtx3ClusterSplit(detinfo::DetectorClocksData const &amp;clock_data, detinfo::DetectorPropertiesData const &amp;det_prop, geo::TPCID const &amp;tpcid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05320">ClusterCrawlerAlg.cxx:5320</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8c27ede03b402b47c349b8bb1307ff1a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8c27ede03b402b47c349b8bb1307ff1a">cluster::ClusterCrawlerAlg::fMergeAllHits</a></div><div class="ttdeci">bool fMergeAllHits</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00215">ClusterCrawlerAlg.h:215</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aceda5036373484fcba4632e8426b436d"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aceda5036373484fcba4632e8426b436d">cluster::ClusterCrawlerAlg::AddHit</a></div><div class="ttdeci">void AddHit(unsigned int kwire, bool &amp;HitOK, bool &amp;SigOK)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04775">ClusterCrawlerAlg.cxx:4775</a></div></div>
<div class="ttc" id="ChannelStatusProvider_8h_html"><div class="ttname"><a href="../../d7/ded/ChannelStatusProvider_8h.html">ChannelStatusProvider.h</a></div><div class="ttdoc">Interface for experiment-specific channel quality info provider. </div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8168ec7a0de034676a5376c022e4a436"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8168ec7a0de034676a5376c022e4a436">cluster::ClusterCrawlerAlg::fFirstHit</a></div><div class="ttdeci">unsigned int fFirstHit</div><div class="ttdoc">first hit used </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00296">ClusterCrawlerAlg.h:296</a></div></div>
<div class="ttc" id="CookedFrameSource_8cxx_html_a7c7963b26e5294dacb6d0a28006b069c"><div class="ttname"><a href="../../d8/d23/CookedFrameSource_8cxx.html#a7c7963b26e5294dacb6d0a28006b069c">tdiff</a></div><div class="ttdeci">static double tdiff(const art::Timestamp &amp;ts1, const art::Timestamp &amp;ts2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d23/CookedFrameSource_8cxx_source.html#l00056">CookedFrameSource.cxx:56</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ac0f9021cae0e433b97e9571082c747b6"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ac0f9021cae0e433b97e9571082c747b6">cluster::ClusterCrawlerAlg::clBeginChgNear</a></div><div class="ttdeci">float clBeginChgNear</div><div class="ttdoc">nearby charge </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00262">ClusterCrawlerAlg.h:262</a></div></div>
<div class="ttc" id="classgeo_1_1InvalidWireError_html"><div class="ttname"><a href="../../d6/d6c/classgeo_1_1InvalidWireError.html">geo::InvalidWireError</a></div><div class="ttdoc">Exception thrown on invalid wire number. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7c/Exceptions_8h_source.html#l00042">Exceptions.h:42</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a70cfcd7f7070bcb9a2d57345e56e9763"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a70cfcd7f7070bcb9a2d57345e56e9763">cluster::ClusterCrawlerAlg::ChkMerge12</a></div><div class="ttdeci">void ChkMerge12(unsigned short it1, unsigned short it2, bool &amp;didit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03027">ClusterCrawlerAlg.cxx:3027</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a92803e026e5b6eb6cdd1edfb384c54d5"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a92803e026e5b6eb6cdd1edfb384c54d5">recob::Hit::SummedADC</a></div><div class="ttdeci">float SummedADC() const </div><div class="ttdoc">The sum of calibrated ADC counts of the hit (0. by default) </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00223">Hit.h:223</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a92a7724a4d1601b933002843d7db869a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a92a7724a4d1601b933002843d7db869a">cluster::ClusterCrawlerAlg::fHitMergeChiCut</a></div><div class="ttdeci">float fHitMergeChiCut</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00216">ClusterCrawlerAlg.h:216</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad0d8994ee96e9bfa8e55ad3e4436dfda"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad0d8994ee96e9bfa8e55ad3e4436dfda">cluster::ClusterCrawlerAlg::chgNear</a></div><div class="ttdeci">std::vector&lt; float &gt; chgNear</div><div class="ttdoc">charge near a cluster on each wire </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00317">ClusterCrawlerAlg.h:317</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a36f3929f1257a40d42f27e607db54f62"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a36f3929f1257a40d42f27e607db54f62">cluster::ClusterCrawlerAlg::Vtx3Store::Z</a></div><div class="ttdeci">float Z</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00106">ClusterCrawlerAlg.h:106</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a5843cfdd1c937bcc0409e2875cc12d27"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a5843cfdd1c937bcc0409e2875cc12d27">cluster::ClusterCrawlerAlg::vtx</a></div><div class="ttdeci">std::vector&lt; VtxStore &gt; vtx</div><div class="ttdoc">the endpoints we are reconstructing </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00251">ClusterCrawlerAlg.h:251</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8f5750cc57138e6d09d7d746d7452e05"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8f5750cc57138e6d09d7d746d7452e05">cluster::ClusterCrawlerAlg::CTP_t</a></div><div class="ttdeci">unsigned int CTP_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00038">ClusterCrawlerAlg.h:38</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a9f691b9125975884fc57268dadbf43f0"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a9f691b9125975884fc57268dadbf43f0">cluster::ClusterCrawlerAlg::fFindHammerClusters</a></div><div class="ttdeci">bool fFindHammerClusters</div><div class="ttdoc">look for hammer type clusters </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00195">ClusterCrawlerAlg.h:195</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a72dd32faa77190429a9256e9d19528ff"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a72dd32faa77190429a9256e9d19528ff">cluster::ClusterCrawlerAlg::FitAllVtx</a></div><div class="ttdeci">void FitAllVtx(CTP_t inCTP)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02039">ClusterCrawlerAlg.cxx:2039</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a1952360bd63d45e0c14fd07764076ef2"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a1952360bd63d45e0c14fd07764076ef2">recob::Hit::SigmaPeakTime</a></div><div class="ttdeci">float SigmaPeakTime() const </div><div class="ttdoc">Uncertainty for the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00219">Hit.h:219</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a4179fe7e7e202a6eb75374335ab7e67a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4179fe7e7e202a6eb75374335ab7e67a">cluster::ClusterCrawlerAlg::vtxprt</a></div><div class="ttdeci">bool vtxprt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00242">ClusterCrawlerAlg.h:242</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a72d410696008e296f92577c96c415e2d"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a72d410696008e296f92577c96c415e2d">cluster::ClusterCrawlerAlg::ClusterStore::BeginChgNear</a></div><div class="ttdeci">float BeginChgNear</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00072">ClusterCrawlerAlg.h:72</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aeb1313fc4ff7dcd4fcadc51726995370"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aeb1313fc4ff7dcd4fcadc51726995370">cluster::ClusterCrawlerAlg::fChgNearCut</a></div><div class="ttdeci">float fChgNearCut</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00319">ClusterCrawlerAlg.h:319</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_a4142bf04bdac092cbfa6084ed7142e13"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#a4142bf04bdac092cbfa6084ed7142e13">cluster::ClusterCrawlerAlg::VtxStore::Wire</a></div><div class="ttdeci">float Wire</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00087">ClusterCrawlerAlg.h:87</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a8a295421507d307d627b03ec9156673e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a8a295421507d307d627b03ec9156673e">cluster::ClusterCrawlerAlg::ChkMergedClusterHitFrac</a></div><div class="ttdeci">bool ChkMergedClusterHitFrac(unsigned short it1, unsigned short it2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l04051">ClusterCrawlerAlg.cxx:4051</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad77499d15ed8cec5c6fc0fd327c0c96e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad77499d15ed8cec5c6fc0fd327c0c96e">cluster::ClusterCrawlerAlg::fLinFitAlg</a></div><div class="ttdeci">trkf::LinFitAlg fLinFitAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00254">ClusterCrawlerAlg.h:254</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a69b6837d4637da51e31fd75798b8a1d4"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a69b6837d4637da51e31fd75798b8a1d4">recob::Hit::PeakTimePlusRMS</a></div><div class="ttdeci">float PeakTimePlusRMS(float sigmas=+1.) const </div><div class="ttdoc">Returns a time sigmas RMS away from the peak time. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00236">Hit.h:236</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a77b1ab63cd211ff234ba537e128de1c4"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a77b1ab63cd211ff234ba537e128de1c4">cluster::ClusterCrawlerAlg::CrawlUS</a></div><div class="ttdeci">void CrawlUS()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l03726">ClusterCrawlerAlg.cxx:3726</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a7c3900be874139197fc006f65efe362b"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a7c3900be874139197fc006f65efe362b">cluster::ClusterCrawlerAlg::clEndChgNear</a></div><div class="ttdeci">float clEndChgNear</div><div class="ttdoc">nearby charge </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00269">ClusterCrawlerAlg.h:269</a></div></div>
<div class="ttc" id="IntegerRanges__test_8cc_html_abbc7e5f346bfa932ca51b4b07ccef76d"><div class="ttname"><a href="../../db/df5/IntegerRanges__test_8cc.html#abbc7e5f346bfa932ca51b4b07ccef76d">count</a></div><div class="ttdeci">std::size_t count(Cont const &amp;cont)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df5/IntegerRanges__test_8cc_source.html#l00029">IntegerRanges_test.cc:29</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a57b123556f375f41611bc301820e1f1e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a57b123556f375f41611bc301820e1f1e">cluster::ClusterCrawlerAlg::prt</a></div><div class="ttdeci">bool prt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00241">ClusterCrawlerAlg.h:241</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="ChannelStatusService_8h_html"><div class="ttname"><a href="../../d8/da1/ChannelStatusService_8h.html">ChannelStatusService.h</a></div><div class="ttdoc">Interface for experiment-specific service for channel quality info. </div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a0db0ab91b47900a8b8d9d9378523451c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0db0ab91b47900a8b8d9d9378523451c">cluster::ClusterCrawlerAlg::VertexCluster</a></div><div class="ttdeci">void VertexCluster(unsigned short ivx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01962">ClusterCrawlerAlg.cxx:1962</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_aa1ab1cef7f418084f8e4a6f29f6f3cf3"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#aa1ab1cef7f418084f8e4a6f29f6f3cf3">cluster::ClusterCrawlerAlg::fcl2hits</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; fcl2hits</div><div class="ttdoc">vector of hits used in the cluster </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00312">ClusterCrawlerAlg.h:312</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a594bd1092544e123ca804840e5f1a2eb"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a594bd1092544e123ca804840e5f1a2eb">cluster::ClusterCrawlerAlg::fChgSlp</a></div><div class="ttdeci">float fChgSlp</div><div class="ttdoc">slope of the charge vs wire </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00238">ClusterCrawlerAlg.h:238</a></div></div>
<div class="ttc" id="classgeo_1_1InvalidWireError_html_a174c7f48dc6c32f680e033c960fbc9eb"><div class="ttname"><a href="../../d6/d6c/classgeo_1_1InvalidWireError.html#a174c7f48dc6c32f680e033c960fbc9eb">geo::InvalidWireError::suggestedWireID</a></div><div class="ttdeci">geo::WireID suggestedWireID() const </div><div class="ttdoc">Returns a better wire ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7c/Exceptions_8h_source.html#l00120">Exceptions.h:120</a></div></div>
<div class="ttc" id="namespacedetinfo_html_a0c4d3d5b85e37497364174c3513ffcae"><div class="ttname"><a href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">detinfo::sampling_rate</a></div><div class="ttdeci">double sampling_rate(DetectorClocksData const &amp;data)</div><div class="ttdoc">Returns the period of the TPC readout electronics clock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00643">DetectorClocksData.h:643</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_a4705f7ca509938aaa4926e43498e0327"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#a4705f7ca509938aaa4926e43498e0327">cluster::ClusterCrawlerAlg::ClusterStore::EndWir</a></div><div class="ttdeci">unsigned int EndWir</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00077">ClusterCrawlerAlg.h:77</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a3612f55c9fa44a650af049b7e96a647a"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a3612f55c9fa44a650af049b7e96a647a">cluster::ClusterCrawlerAlg::RefineVertexClusters</a></div><div class="ttdeci">void RefineVertexClusters(unsigned short ivx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l01278">ClusterCrawlerAlg.cxx:1278</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_afc6c3b19077981c4eab4583916949be7"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#afc6c3b19077981c4eab4583916949be7">cluster::ClusterCrawlerAlg::clBeginSlpErr</a></div><div class="ttdeci">float clBeginSlpErr</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00258">ClusterCrawlerAlg.h:258</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a74da18d4f0023feee71c1352a99b3910"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">icarus::ns::util::empty</a></div><div class="ttdeci">bool empty(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00555">FixedBins.h:555</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a5722fa298fffc3ac441e8a07d9a6048b"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a5722fa298fffc3ac441e8a07d9a6048b">recob::Hit::Channel</a></div><div class="ttdeci">raw::ChannelID_t Channel() const </div><div class="ttdoc">ID of the readout channel the hit was extracted from. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00230">Hit.h:230</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1VtxStore_html_ab06972a1ee0b53213371ed41c67fe04d"><div class="ttname"><a href="../../d9/d5e/structcluster_1_1ClusterCrawlerAlg_1_1VtxStore.html#ab06972a1ee0b53213371ed41c67fe04d">cluster::ClusterCrawlerAlg::VtxStore::Fixed</a></div><div class="ttdeci">bool Fixed</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00096">ClusterCrawlerAlg.h:96</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad6415e86d6fd56afaab39c9c6864da4c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6415e86d6fd56afaab39c9c6864da4c">cluster::ClusterCrawlerAlg::ChkVertex</a></div><div class="ttdeci">void ChkVertex(float fvw, float fvt, unsigned short it1, unsigned short it2, short topo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02394">ClusterCrawlerAlg.cxx:2394</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad8a34f66ba1eb44620e288dc1ca2e3fe"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad8a34f66ba1eb44620e288dc1ca2e3fe">cluster::ClusterCrawlerAlg::PointVertexChi</a></div><div class="ttdeci">float PointVertexChi(float wire, float tick, unsigned short ivx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06309">ClusterCrawlerAlg.cxx:6309</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3f663d96f6fe0ad88a84fa7dd0c9fc77"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">geo::TPCGeo::LocalToWorld</a></div><div class="ttdeci">void LocalToWorld(const double *tpc, double *world) const </div><div class="ttdoc">Transform point from local TPC frame to world frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00563">TPCGeo.h:563</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a076f3f79f8b58ce6e496254d2fea9da8"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a076f3f79f8b58ce6e496254d2fea9da8">cluster::ClusterCrawlerAlg::Vtx3Store::Wire</a></div><div class="ttdeci">short Wire</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00108">ClusterCrawlerAlg.h:108</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a4b4ce6bbe71db65ff48e9e3d65ca2192"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a4b4ce6bbe71db65ff48e9e3d65ca2192">cluster::ClusterCrawlerAlg::DeadWireCount</a></div><div class="ttdeci">unsigned int DeadWireCount()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06137">ClusterCrawlerAlg.cxx:6137</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore_html_ab214d0857bd69bbc55ed0e9ca8d5f3f2"><div class="ttname"><a href="../../d4/d64/structcluster_1_1ClusterCrawlerAlg_1_1ClusterStore.html#ab214d0857bd69bbc55ed0e9ca8d5f3f2">cluster::ClusterCrawlerAlg::ClusterStore::CTP</a></div><div class="ttdeci">CTP_t CTP</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00065">ClusterCrawlerAlg.h:65</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a5532385c3180a1db6515133834b27399"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a5532385c3180a1db6515133834b27399">cluster::ClusterCrawlerAlg::Vtx3Store::CStat</a></div><div class="ttdeci">unsigned short CStat</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00109">ClusterCrawlerAlg.h:109</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a480b3863f5f2996e2fb56f5f5cd1250e"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a480b3863f5f2996e2fb56f5f5cd1250e">cluster::ClusterCrawlerAlg::ChkMerge</a></div><div class="ttdeci">void ChkMerge()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l02816">ClusterCrawlerAlg.cxx:2816</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a864bf658e09ffad9486e03e50fcc7f12"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a864bf658e09ffad9486e03e50fcc7f12">cluster::ClusterCrawlerAlg::ChkClusterNearbyHits</a></div><div class="ttdeci">void ChkClusterNearbyHits(bool prt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05030">ClusterCrawlerAlg.cxx:5030</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a05c1784f2d714a6f33aa9ccc5a6d941c"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a05c1784f2d714a6f33aa9ccc5a6d941c">cluster::ClusterCrawlerAlg::fNHitsAve</a></div><div class="ttdeci">std::vector&lt; unsigned short &gt; fNHitsAve</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00179">ClusterCrawlerAlg.h:179</a></div></div>
<div class="ttc" id="TPCGeo_8h_html"><div class="ttname"><a href="../../df/de9/TPCGeo_8h.html">TPCGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="DetectorClocksData_8h_html"><div class="ttname"><a href="../../d0/d5b/DetectorClocksData_8h.html">DetectorClocksData.h</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1366fdc2b8c67bd345efa80fba6d9372"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1366fdc2b8c67bd345efa80fba6d9372">cluster::ClusterCrawlerAlg::fDoMerge</a></div><div class="ttdeci">std::vector&lt; bool &gt; fDoMerge</div><div class="ttdoc">try to merge clusters? </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00190">ClusterCrawlerAlg.h:190</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_ad6397333745b8677560d1d884f0446dd"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#ad6397333745b8677560d1d884f0446dd">cluster::ClusterCrawlerAlg::Vtx3ClusterMatch</a></div><div class="ttdeci">void Vtx3ClusterMatch(detinfo::DetectorClocksData const &amp;clock_data, detinfo::DetectorPropertiesData const &amp;det_prop, geo::TPCID const &amp;tpcid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l05234">ClusterCrawlerAlg.cxx:5234</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a0b30c422ce2d96d441314a4bde07e13f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a0b30c422ce2d96d441314a4bde07e13f">cluster::ClusterCrawlerAlg::CheckHitDuplicates</a></div><div class="ttdeci">bool CheckHitDuplicates(std::string location, std::string marker=&quot;&quot;) const </div><div class="ttdoc">Returns true if there are no duplicates in the hit list for next cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l06173">ClusterCrawlerAlg.cxx:6173</a></div></div>
<div class="ttc" id="structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store_html_a3d17b4ed2ab0987a3f5f523a8ea0e1a4"><div class="ttname"><a href="../../d2/d71/structcluster_1_1ClusterCrawlerAlg_1_1Vtx3Store.html#a3d17b4ed2ab0987a3f5f523a8ea0e1a4">cluster::ClusterCrawlerAlg::Vtx3Store::Y</a></div><div class="ttdeci">float Y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df7/ClusterCrawlerAlg_8h_source.html#l00104">ClusterCrawlerAlg.h:104</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a1fdc0953a17a9c5b1633d1b50b450cb5"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a1fdc0953a17a9c5b1633d1b50b450cb5">cluster::ClusterCrawlerAlg::ClearResults</a></div><div class="ttdeci">void ClearResults()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00149">ClusterCrawlerAlg.cxx:149</a></div></div>
<div class="ttc" id="classcluster_1_1ClusterCrawlerAlg_html_a73a2cc712d32daac007c06b7ec72e99f"><div class="ttname"><a href="../../dd/d8e/classcluster_1_1ClusterCrawlerAlg.html#a73a2cc712d32daac007c06b7ec72e99f">cluster::ClusterCrawlerAlg::ClusterCrawlerAlg</a></div><div class="ttdeci">ClusterCrawlerAlg(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de8/ClusterCrawlerAlg_8cxx_source.html#l00055">ClusterCrawlerAlg.cxx:55</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
