<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>genf::GFSpacepointHitPolicy Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/dc1/namespacegenf.html">genf</a></li><li class="navelem"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html">GFSpacepointHitPolicy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="../../dc/d76/classgenf_1_1GFSpacepointHitPolicy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">genf::GFSpacepointHitPolicy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for genf::GFSpacepointHitPolicy:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.png" usemap="#genf::GFSpacepointHitPolicy_map" alt=""/>
  <map id="genf::GFSpacepointHitPolicy_map" name="genf::GFSpacepointHitPolicy_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afb463c061aa24b07e90864e7abfe996a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#afb463c061aa24b07e90864e7abfe996a">GFSpacepointHitPolicy</a> ()</td></tr>
<tr class="separator:afb463c061aa24b07e90864e7abfe996a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217fa7f20376c44af6883e8b0caaff73"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a217fa7f20376c44af6883e8b0caaff73">detPlane</a> (<a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *, <a class="el" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html">GFAbsTrackRep</a> *)</td></tr>
<tr class="memdesc:a217fa7f20376c44af6883e8b0caaff73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get detector plane perpendicular to track.  <a href="#a217fa7f20376c44af6883e8b0caaff73">More...</a><br/></td></tr>
<tr class="separator:a217fa7f20376c44af6883e8b0caaff73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a3551355aa4701a1b4ae2b53b155248"><td class="memItemLeft" align="right" valign="top">TMatrixT&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a0a3551355aa4701a1b4ae2b53b155248">hitCoord</a> (<a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;)</td></tr>
<tr class="memdesc:a0a3551355aa4701a1b4ae2b53b155248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hit coordinates in detector plane.  <a href="#a0a3551355aa4701a1b4ae2b53b155248">More...</a><br/></td></tr>
<tr class="separator:a0a3551355aa4701a1b4ae2b53b155248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3995b808ec1c0fa126afed1db7a31b65"><td class="memItemLeft" align="right" valign="top">TMatrixT&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a3995b808ec1c0fa126afed1db7a31b65">hitCoord</a> (<a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;)</td></tr>
<tr class="separator:a3995b808ec1c0fa126afed1db7a31b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade9ff7f049c617ed6c033a9561c7b90d"><td class="memItemLeft" align="right" valign="top">TMatrixT&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#ade9ff7f049c617ed6c033a9561c7b90d">hitCov</a> (<a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;)</td></tr>
<tr class="memdesc:ade9ff7f049c617ed6c033a9561c7b90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hit covariances in detector plane.  <a href="#ade9ff7f049c617ed6c033a9561c7b90d">More...</a><br/></td></tr>
<tr class="separator:ade9ff7f049c617ed6c033a9561c7b90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917fd15b0d14a4c2618d681b09477fd6"><td class="memItemLeft" align="right" valign="top">TMatrixT&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a917fd15b0d14a4c2618d681b09477fd6">hitCov</a> (<a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *<a class="el" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;plane, const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;planePrev, const TMatrixT&lt; Double_t &gt; &amp;state, const Double_t &amp;mass)</td></tr>
<tr class="separator:a917fd15b0d14a4c2618d681b09477fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ea4e999beff92bb3c9816e09f4397d7"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a2ea4e999beff92bb3c9816e09f4397d7">~GFSpacepointHitPolicy</a> ()</td></tr>
<tr class="separator:a2ea4e999beff92bb3c9816e09f4397d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e0ba1b6ce257026984406503ac29a8"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a90e0ba1b6ce257026984406503ac29a8">getName</a> ()</td></tr>
<tr class="separator:a90e0ba1b6ce257026984406503ac29a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a45d0bfd162c57717a70a8dc8338b042f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a45d0bfd162c57717a70a8dc8338b042f">fPlane</a></td></tr>
<tr class="separator:a45d0bfd162c57717a70a8dc8338b042f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a6f12eed31e32737aac15eab8016f71c4"><td class="memItemLeft" align="right" valign="top">static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a6f12eed31e32737aac15eab8016f71c4">fPolicyName</a> = &quot;GFSpacepointHitPolicy&quot;</td></tr>
<tr class="separator:a6f12eed31e32737aac15eab8016f71c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00055">55</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afb463c061aa24b07e90864e7abfe996a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">genf::GFSpacepointHitPolicy::GFSpacepointHitPolicy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00059">59</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ea4e999beff92bb3c9816e09f4397d7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual genf::GFSpacepointHitPolicy::~GFSpacepointHitPolicy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00079">79</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a217fa7f20376c44af6883e8b0caaff73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">genf::GFDetPlane</a> &amp; genf::GFSpacepointHitPolicy::detPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *&#160;</td>
          <td class="paramname"><em>hit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/ddb/classgenf_1_1GFAbsTrackRep.html">GFAbsTrackRep</a> *&#160;</td>
          <td class="paramname"><em>rep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get detector plane perpendicular to track. </p>
<p>The detector plane is contructed from the position of the hit and the track representation. For this the track is extrapolated to the point of closest approach to the hit. </p>

<p>Definition at line <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html#l00383">383</a> of file <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  TMatrixT&lt;Double_t&gt; rawcoord = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;getRawHitCoord();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  TVector3 point(rawcoord[0][0],rawcoord[1][0],rawcoord[2][0]);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  TVector3 poca,dirInPoca;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  rep-&gt;extrapolateToPoint(point,poca,dirInPoca);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a45d0bfd162c57717a70a8dc8338b042f">fPlane</a>.<a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html#a47693a9d2850fa14dbec85048f4f5912">setO</a>(point);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a45d0bfd162c57717a70a8dc8338b042f">fPlane</a>.<a class="code" href="../../d3/db4/classgenf_1_1GFDetPlane.html#ab96c490b167b0be99ecd48d43119c4c6">setNormal</a>(dirInPoca);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a45d0bfd162c57717a70a8dc8338b042f">fPlane</a>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="ttc" id="classgenf_1_1GFDetPlane_html_a47693a9d2850fa14dbec85048f4f5912"><div class="ttname"><a href="../../d3/db4/classgenf_1_1GFDetPlane.html#a47693a9d2850fa14dbec85048f4f5912">genf::GFDetPlane::setO</a></div><div class="ttdeci">void setO(const TVector3 &amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d42/GFDetPlane_8cxx_source.html#l00099">GFDetPlane.cxx:99</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classgenf_1_1GFSpacepointHitPolicy_html_a45d0bfd162c57717a70a8dc8338b042f"><div class="ttname"><a href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a45d0bfd162c57717a70a8dc8338b042f">genf::GFSpacepointHitPolicy::fPlane</a></div><div class="ttdeci">GFDetPlane fPlane</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00087">GFSpacepointHitPolicy.h:87</a></div></div>
<div class="ttc" id="classgenf_1_1GFDetPlane_html_ab96c490b167b0be99ecd48d43119c4c6"><div class="ttname"><a href="../../d3/db4/classgenf_1_1GFDetPlane.html#ab96c490b167b0be99ecd48d43119c4c6">genf::GFDetPlane::setNormal</a></div><div class="ttdeci">void setNormal(TVector3 n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d42/GFDetPlane_8cxx_source.html#l00163">GFDetPlane.cxx:163</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a90e0ba1b6ce257026984406503ac29a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string&amp; genf::GFSpacepointHitPolicy::getName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00081">81</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a6f12eed31e32737aac15eab8016f71c4">fPolicyName</a>;}</div>
<div class="ttc" id="classgenf_1_1GFSpacepointHitPolicy_html_a6f12eed31e32737aac15eab8016f71c4"><div class="ttname"><a href="../../d7/d60/classgenf_1_1GFSpacepointHitPolicy.html#a6f12eed31e32737aac15eab8016f71c4">genf::GFSpacepointHitPolicy::fPolicyName</a></div><div class="ttdeci">static const std::string fPolicyName</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00084">GFSpacepointHitPolicy.h:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0a3551355aa4701a1b4ae2b53b155248"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixT&lt; Double_t &gt; genf::GFSpacepointHitPolicy::hitCoord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *&#160;</td>
          <td class="paramname"><em>hit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hit coordinates in detector plane. </p>

<p>Definition at line <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html#l00030">30</a> of file <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  TMatrixT&lt;Double_t&gt; returnMat(2,1);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  TMatrixT&lt;Double_t&gt; _D(3,1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  TVector3 _U;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  TVector3 _V;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  _D[0][0] = (plane.getO())[0];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  _D[1][0] = (plane.getO())[1];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  _D[2][0] = (plane.getO())[2];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  _D *= -1.;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  _D += <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;getRawHitCoord();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">//now the vector _D points from the origin of the plane to the hit point</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  _U = plane.getU();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  _V = plane.getV();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  returnMat[0][0] = _D[0][0] * _U[0] + _D[1][0] * _U[1] + _D[2][0] * _U[2];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  returnMat[1][0] = _D[0][0] * _V[0] + _D[1][0] * _V[1] + _D[2][0] * _V[2];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;hitCoord=&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">//returnMat.Print();</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">return</span> returnMat;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3995b808ec1c0fa126afed1db7a31b65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixT&lt; Double_t &gt; genf::GFSpacepointHitPolicy::hitCoord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *&#160;</td>
          <td class="paramname"><em>hit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html#l00060">60</a> of file <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  TMatrixT&lt;Double_t&gt; returnMat(5,1); <span class="comment">// Just return last 2 elements. Will calculate the rest in GFKalman.cxx.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  TMatrixT&lt;Double_t&gt; _D(3,1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  TVector3 _U;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  TVector3 _V;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  _D[0][0] = (plane.getO())[0];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  _D[1][0] = (plane.getO())[1];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  _D[2][0] = (plane.getO())[2];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  _D *= -1.;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  _D += <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;getRawHitCoord();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//now the vector _D points from the origin of the plane to the hit point</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  _U = plane.getU();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  _V = plane.getV();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  returnMat[0][0] = _D[0][0] * _U[0] + _D[1][0] * _U[1] + _D[2][0] * _U[2];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  returnMat[1][0] = _D[0][0] * _V[0] + _D[1][0] * _V[1] + _D[2][0] * _V[2];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;hitCoord=&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//returnMat.Print();</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">return</span> returnMat;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade9ff7f049c617ed6c033a9561c7b90d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixT&lt; Double_t &gt; genf::GFSpacepointHitPolicy::hitCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *&#160;</td>
          <td class="paramname"><em>hit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hit covariances in detector plane. </p>

<p>Definition at line <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html#l00090">90</a> of file <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  TVector3 _U;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  TVector3 _V;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  _U = plane.getU();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  _V = plane.getV();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  TMatrixT&lt;Double_t&gt; rawCov = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;getRawHitCov();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//rawCov[0][0] = 12.e12; // Force this. EC, 3-Apr-2012.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  TMatrixT&lt;Double_t&gt; jac(3,2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// jac = dF_i/dx_j = s_unitvec * t_untivec, with s=u,v and t=x,y,z</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  jac[0][0] = _U[0];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  jac[1][0] = _U[1];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  jac[2][0] = _U[2];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  jac[0][1] = _V[0];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  jac[1][1] = _V[1];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  jac[2][1] = _V[2];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  TMatrixT&lt;Double_t&gt; jac_t = jac.T();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  TMatrixT&lt;Double_t&gt; jac_orig = jac;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  TMatrixT&lt;Double_t&gt; result=jac_t * (rawCov * jac_orig);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;hitCov=&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//result.Print();</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span>  result;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a917fd15b0d14a4c2618d681b09477fd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixT&lt; Double_t &gt; genf::GFSpacepointHitPolicy::hitCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d3a/classgenf_1_1GFAbsRecoHit.html">GFAbsRecoHit</a> *&#160;</td>
          <td class="paramname"><em>hit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>planePrev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Double_t &amp;&#160;</td>
          <td class="paramname"><em>mass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html#l00121">121</a> of file <a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  TVector3 _U;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  TVector3 _V;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  _U = plane.getU();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  _V = plane.getV();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//  Double_t eps(1.0e-6);</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  TMatrixT&lt;Double_t&gt; rawCov = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;getRawHitCov();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">//rawCov[0][0] = 12.e12; // Force this. EC, 3-Apr-2012.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  std::vector &lt;double&gt; tmpRawCov;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  tmpRawCov.push_back(rawCov[0][0]);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  tmpRawCov.push_back(rawCov[1][1]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  tmpRawCov.push_back(rawCov[2][2]);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  tmpRawCov.push_back(rawCov[2][1]); <span class="comment">// y-z correlated cov element.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keyword">static</span> std::vector &lt;double&gt; oldRawCov(tmpRawCov);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">static</span> std::vector &lt;double&gt; oldOldRawCov(tmpRawCov);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">static</span> GFDetPlane planePrevPrev(planePrev);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  rawCov.ResizeTo(7,7); <span class="comment">// this becomes used now for something else entirely:</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// the 7x7 raw errors on x,y,z,px,py,pz,th, which sandwiched between 5x7</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// Jacobian converts it to the cov matrix for the 5x5 state space.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  rawCov[0][0] = tmpRawCov[0]; <span class="comment">// x</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  rawCov[1][1] = tmpRawCov[1]; <span class="comment">// y</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  rawCov[2][2] = tmpRawCov[2]; <span class="comment">// z</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  rawCov[1][2] = tmpRawCov[3]; <span class="comment">// yz</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  rawCov[2][1] = tmpRawCov[3]; <span class="comment">// yz</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// This Jacobian concerns the transfrom from planar to detector coords.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//   TMatrixT&lt;Double_t&gt; jac(3,2);</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  TMatrixT&lt;Double_t&gt; jac(7,5); <span class="comment">// X,Y,Z,UX,UY,UZ,Theta in detector coords</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// jac = dF_i/dx_j = s_unitvec * t_unitvec, with s=|q|/p,du/dw, dv/dw, u,v and t=th, x,y,z</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// More correctly :</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  Double_t <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>(0.3); <span class="comment">// place holder!!</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  Double_t C;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//Double_t p (2.5); // place holder!!!</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">//p = abs(1/state[0][0]);</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  Double_t mom = fabs(1.0/<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>[0][0]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  Double_t beta = mom/sqrt(<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>*<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">mass</a>+mom*mom);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a> = (plane.getO()-planePrev.getO()).Mag();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  C = 0.0136/beta*sqrt(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>/14.0)*(1+0.038*log(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>/14.0));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  TVector3 _D (plane.getNormal());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// px^ = (x1-x2)/d;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// (sigpx)^2 = (sig_x1^2+sig_x2^2)*[(y1-y2)^2 + (z1-z2)^2]/d^4 +</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">//                (x1-x2)^2*(y1-y2)^2*sigma_y1^2/d^6 + ...</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">//                (x1-x2)^2*(z1-z2)^2*sigma_z2^2/d^6 +</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  rawCov[3][3] = (oldRawCov[0]+tmpRawCov[0])/pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,4.) *</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    (</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     pow((plane.getO()-planePrev.getO()).Y(),2.) +</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     pow((plane.getO()-planePrev.getO()).Z(),2.)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    )</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    +</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     pow((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(),2.) *</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    (</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     pow((plane.getO()-planePrev.getO()).Y(),2.) * (oldRawCov[1]+tmpRawCov[1]) +</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     pow((plane.getO()-planePrev.getO()).Z(),2.) * (oldRawCov[2]+tmpRawCov[2])</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     ) / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,6.)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// y-z cross-term</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    +</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    3.0* (plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() * (plane.getO()-planePrev.getO()).Y() * (plane.getO()-planePrev.getO()).Z() / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,5.)  * (tmpRawCov[3] + oldRawCov[3])</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    ;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  rawCov[4][4] = (oldRawCov[1]+tmpRawCov[1])/pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,4.) *</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    (</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     pow((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(),2.) +</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     pow((plane.getO()-planePrev.getO()).Z(),2.)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    )</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    +</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     pow((plane.getO()-planePrev.getO()).Y(),2.) *</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    (</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;     pow((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(),2.) * (oldRawCov[0]+tmpRawCov[0]) +</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     pow((plane.getO()-planePrev.getO()).Z(),2.) * (oldRawCov[2]+tmpRawCov[2])</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     ) / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,6.)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// y-z cross-term</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    +</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    3.0* ( (plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() * (plane.getO()-planePrev.getO()).Y() * (plane.getO()-planePrev.getO()).Z() / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,5.) + (plane.getO()-planePrev.getO()).Z() / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,3.) ) * ( tmpRawCov[3] + oldRawCov[3] )</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    ;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  rawCov[5][5] = (oldRawCov[2]+tmpRawCov[2])/pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,4.) *</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    (</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     pow((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(),2.) +</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;     pow((plane.getO()-planePrev.getO()).Y(),2.)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    )</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    +</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     pow((plane.getO()-planePrev.getO()).Z(),2.) *</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    (</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     pow((plane.getO()-planePrev.getO()).Y(),2.) * (oldRawCov[0]+tmpRawCov[0])+</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     pow((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(),2.) * (oldRawCov[1]+tmpRawCov[1])</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     ) / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,6.)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    +</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// y-z cross-term</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    3.0* ( (plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() * (plane.getO()-planePrev.getO()).Y() * (plane.getO()-planePrev.getO()).Z() / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,5.)  + (plane.getO()-planePrev.getO()).Y() / pow(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>,3.) ) * ( tmpRawCov[3] + oldRawCov[3] )</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    ;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  Double_t num = (plane.getO()-planePrev.getO())*(planePrev.getO()-planePrevPrev.getO());</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  Double_t d1 = (plane.getO()-planePrev.getO()).Mag(); <span class="comment">// same as dist above</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  Double_t d2 = (planePrev.getO()-planePrevPrev.getO()).Mag();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// This is the error on cosTh^2. There are 9 terms for diagonal errors, one for each</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// x,y,z coordinate at 3 points. Below the first 3 terms are at pt 1.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Second 3 are at 3. Third 3 are at 2, which is slightly more complicated.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// There are three more terms for non-diagonal erros.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">double</span> dcosTh =</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    pow(((planePrev.getO()-planePrevPrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>()*d1*d2 -</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                      num * (plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() *d2/d1) /</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                     pow(d1,2.0)/pow(d2,2.0),2.0) * tmpRawCov[0] +</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    pow(((planePrev.getO()-planePrevPrev.getO()).Y()*d1*d2 +</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         num * (plane.getO()-planePrev.getO()).Y() *d2/d1) /</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        pow(d1,2.0)/pow(d2,2.0),2.0) * tmpRawCov[1] +</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    pow(((planePrev.getO()-planePrevPrev.getO()).Z()*d1*d2 +</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         num * (plane.getO()-planePrev.getO()).Z() *d2/d1) /</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        pow(d1,2.0)/pow(d2,2.0),2.0) * tmpRawCov[2] +</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    pow(((plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>()*d1*d2 -</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                      num * (planePrev.getO()-planePrevPrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() *d1/d2) /</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                     pow(d1,2.0)/pow(d2,2.0),2.0) * oldOldRawCov[0] +</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    pow(((plane.getO()-planePrev.getO()).Y()*d1*d2 -</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         num * (planePrev.getO()-planePrevPrev.getO()).Y() *d1/d2) /</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        pow(d1,2.0)/pow(d2,2.0),2.0) * oldOldRawCov[1] +</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    pow(((plane.getO()-planePrev.getO()).Z()*d1*d2 -</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         num * (planePrev.getO()-planePrevPrev.getO()).Z() *d1/d2) /</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        pow(d1,2.0)/pow(d2,2.0),2.0) * oldOldRawCov[2] +</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    pow(((plane.getO()-planePrevPrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>()*d1*d2 -</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                      num * (plane.getO()-planePrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() *d2/d1 +</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                      num * (planePrev.getO()-planePrevPrev.getO()).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>() *d1/d2</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;         ) /</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                     pow(d1,2.0)/pow(d2,2.0),2.0) * oldRawCov[0] +</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    pow(((plane.getO()-planePrevPrev.getO()).Y()*d1*d2 -</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                      num * (plane.getO()-planePrev.getO()).Y() *d2/d1 +</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                      num * (planePrev.getO()-planePrevPrev.getO()).Y() *d1/d2</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         ) /</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                     pow(d1,2.0)/pow(d2,2.0),2.0) * oldRawCov[1] +</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    pow(((plane.getO()-planePrevPrev.getO()).Z()*d1*d2 -</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                      num * (plane.getO()-planePrev.getO()).Z() *d2/d1 +</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                      num * (planePrev.getO()-planePrevPrev.getO()).Z() *d1/d2</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         ) /</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                     pow(d1,2.0)/pow(d2,2.0),2.0) * oldRawCov[2]</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// And now the off-diagonal terms. This is a mess unto itself.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// First, d^2(costh)/d(z1)d(y1)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    +</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    (</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     (plane.getO()-planePrev.getO()).Z() * (planePrev.getO()-planePrevPrev.getO()).Y() / pow(d1,3.)/d2</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     -</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     (plane.getO()-planePrev.getO()).Y() * (planePrev.getO()-planePrevPrev.getO()).Z() / pow(d1,3.)/d2</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     +</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     3.*(plane.getO()-planePrev.getO()).Y() * (plane.getO()-planePrev.getO()).Z() * num / pow(d1,5.)/d2</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     ) * tmpRawCov[3]</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Next, d^2(costh)/d(z3)d(y3). Above w z1&lt;-&gt;z3, y1&lt;-&gt;y3</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    +</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    (</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    (planePrevPrev.getO()-planePrev.getO()).Z() * (planePrev.getO()-plane.getO()).Y() / pow(d1,3.)/d2</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    -</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    (planePrevPrev.getO()-planePrev.getO()).Y() * (planePrev.getO()-plane.getO()).Z() / pow(d1,3.)/d2</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    +</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    3.*(planePrevPrev.getO()-planePrev.getO()).Y() * (planePrevPrev.getO()-planePrev.getO()).Z() * num / pow(d1,5.)/d2</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    ) * oldOldRawCov[3]</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Last, d^2(costh)/d(z2)d(y2). This is an even bigger mess.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    +</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    (</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     ( (plane.getO()-planePrev.getO()).Y() - (planePrev.getO()-planePrevPrev.getO()).Y() ) *</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;     (-(plane.getO()-planePrev.getO()).Z()/pow(d1,3.)/d2 +</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       (planePrev.getO()-planePrevPrev.getO()).Z()/pow(d2,3.)/d1</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      )</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     + (plane.getO()-planePrev.getO()).Y() *</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     (</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      (-(planePrev.getO()-planePrevPrev.getO()).Z() +</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;       (plane.getO()-planePrev.getO()).Z()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;       ) / pow(d1,3.)/d2</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      - num*</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      ( -3.* (plane.getO()-planePrev.getO()).Z()*d1*d2 +</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        (planePrev.getO()-planePrevPrev.getO()).Z()*pow(d1,3.)/d2</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;       )</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      ) / pow(d1,6.) / pow(d2,2.)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     -</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;     (planePrev.getO()-planePrevPrev.getO()).Y()*</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;     (</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      (-(planePrev.getO()-planePrevPrev.getO()).Z() +</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;       (plane.getO()-planePrev.getO()).Z()</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;       ) / pow(d2,3.)/d1</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      - num*</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      ( 3.* (planePrev.getO()-planePrevPrev.getO()).Z()*d1*d2 -</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        (plane.getO()-planePrev.getO()).Z()*pow(d2,3.)/d1</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;       )</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      ) / pow(d1,2.) / pow(d2,6.)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     ) * oldRawCov[3]</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    ;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// That was delta(cos(theta))^2. I want delta(theta)^2. dTh^2 = d(cosTh)^2/sinTh^2</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  Double_t theta(TMath::ACos((plane.getO()-planePrev.getO()).Unit() * (planePrev.getO()-planePrevPrev.getO()).Unit()));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  rawCov[6][6] = TMath::Min(pow(dcosTh,2.)/pow(TMath::Sin(theta),2.),pow(TMath::Pi()/2.0,2.));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// This means I&#39;m too close to the endpoints to have histories that allow</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// proper calculation of above rawCovs. Use below defaults instead.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (d1 == 0 || d2 == 0)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      rawCov[3][3] = pow(0.2,2.0); <span class="comment">// Unit Px</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      rawCov[4][4] = pow(0.2,2.0); <span class="comment">// Unit Py</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      rawCov[5][5] = pow(0.2,2.0); <span class="comment">// Unit Pz</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      rawCov[6][6] = pow(0.1,2.0); <span class="comment">// theta. 0.3/3mm, say.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a> = 0.3;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      C = 0.0136/beta*sqrt(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>/14.0)*(1+0.038*log(<a class="code" href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">dist</a>/14.0));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// This forces a huge/tiny theta error, which effectively freezes/makes-us-sensitive theta, as is.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">//rawCov[6][6] = /*9.99e9*/ 0.1;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  TVector3 u=plane.getU();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  TVector3 v=plane.getV();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  TVector3 <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>=u.Cross(v);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Below line has been done, with code change in GFKalman that has updated</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// the plane orientation by now.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">//  TVector3 pTilde = 1.0 * (w + state[1][0] * u + state[2][0] * v);</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  TVector3 pTilde = <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">double</span> pTildeMag = pTilde.Mag();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  jac.Zero();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  jac[6][0] = 1./C; <span class="comment">// Should be 1/C?; Had 1 until ... 12-Feb-2013</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  jac[0][3] = _U[0];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  jac[1][3] = _U[1];</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  jac[2][3] = _U[2];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  jac[0][4] = _V[0];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  jac[1][4] = _V[1];</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  jac[2][4] = _V[2];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// cnp&#39;d from RKTrackRep.cxx, line ~496</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// da{x,y,z}/du&#39;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  jac[3][1] = 1.0/pTildeMag*(u.X()-pTilde.X()/(pTildeMag*pTildeMag)*u*pTilde);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  jac[4][1] = 1.0/pTildeMag*(u.Y()-pTilde.Y()/(pTildeMag*pTildeMag)*u*pTilde);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  jac[5][1] = 1.0/pTildeMag*(u.Z()-pTilde.Z()/(pTildeMag*pTildeMag)*u*pTilde);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// da{x,y,z}/dv&#39;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  jac[3][2] = 1.0/pTildeMag*(v.X()-pTilde.X()/(pTildeMag*pTildeMag)*v*pTilde);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  jac[4][2] = 1.0/pTildeMag*(v.Y()-pTilde.Y()/(pTildeMag*pTildeMag)*v*pTilde);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  jac[5][2] = 1.0/pTildeMag*(v.Z()-pTilde.Z()/(pTildeMag*pTildeMag)*v*pTilde);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  TMatrixT&lt;Double_t&gt; jac_orig = jac;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  TMatrixT&lt;Double_t&gt; jac_t = jac.T();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  TMatrixT&lt;Double_t&gt; result=jac_t * (rawCov * jac_orig);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;hitCov=&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">//result.Print();</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  oldOldRawCov = oldRawCov;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  oldRawCov = tmpRawCov;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  planePrevPrev = planePrev;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">return</span>  result;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="namespacerun__simTestPulse_html_a4cef4374034bd70ad18185ff49d1dc64"><div class="ttname"><a href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">run_simTestPulse.state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/run__simTestPulse_8py_source.html#l00023">run_simTestPulse.py:23</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="namespacelarg4_html_a3b23adbb58bc71f7c54806914226f1f8"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a3b23adbb58bc71f7c54806914226f1f8">larg4::dist</a></div><div class="ttdeci">constexpr double dist(const TReal *x, const TReal *y, const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8a/OpFastScintillation_8hh_source.html#l00563">OpFastScintillation.hh:563</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_af9508f78ba8143119daa95dbd8220f91"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#af9508f78ba8143119daa95dbd8220f91">lib.dedx.mass</a></div><div class="ttdeci">float mass</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00047">dedx.py:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a45d0bfd162c57717a70a8dc8338b042f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/db4/classgenf_1_1GFDetPlane.html">GFDetPlane</a> genf::GFSpacepointHitPolicy::fPlane</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00087">87</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6f12eed31e32737aac15eab8016f71c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string genf::GFSpacepointHitPolicy::fPolicyName = &quot;GFSpacepointHitPolicy&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html#l00084">84</a> of file <a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../de/d6f/GFSpacepointHitPolicy_8h_source.html">GFSpacepointHitPolicy.h</a></li>
<li><a class="el" href="../../d0/d5b/GFSpacepointHitPolicy_8cxx_source.html">GFSpacepointHitPolicy.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
