<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>evgen::MarleyTimeGen Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d4/d4d/namespaceevgen.html">evgen</a></li><li class="navelem"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html">MarleyTimeGen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../dd/d8c/classevgen_1_1MarleyTimeGen-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">evgen::MarleyTimeGen Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for evgen::MarleyTimeGen:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/dfe/classevgen_1_1MarleyTimeGen.png" usemap="#evgen::MarleyTimeGen_map" alt=""/>
  <map id="evgen::MarleyTimeGen_map" name="evgen::MarleyTimeGen_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d37/structevgen_1_1MarleyTimeGen_1_1Config.html">Config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection of configuration parameters for the module.  <a href="../../d2/d37/structevgen_1_1MarleyTimeGen_1_1Config.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d4e/classevgen_1_1MarleyTimeGen_1_1FitParameters.html">FitParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores parsed fit parameters from a single time bin and neutrino type in a "fit"-format spectrum file.  <a href="../../de/d4e/classevgen_1_1MarleyTimeGen_1_1FitParameters.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9a/structevgen_1_1MarleyTimeGen_1_1KeysToIgnore.html">KeysToIgnore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html">TimeFit</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores fitting parameters for all neutrino types from a single time bin in a "fit"-format spectrum file.  <a href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a96f540c7d4ac68e861d8f99846789606"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a96f540c7d4ac68e861d8f99846789606">Name</a> = fhicl::Name</td></tr>
<tr class="separator:a96f540c7d4ac68e861d8f99846789606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a684b74fcc7f60f736cc91f8d5dbe1dce"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a684b74fcc7f60f736cc91f8d5dbe1dce">Comment</a> = fhicl::Comment</td></tr>
<tr class="separator:a684b74fcc7f60f736cc91f8d5dbe1dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c2c9467a5cde700b053b78f78547ee"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">Parameters</a> = art::EDProducer::Table&lt; <a class="el" href="../../d2/d37/structevgen_1_1MarleyTimeGen_1_1Config.html">Config</a>, <a class="el" href="../../d8/d9a/structevgen_1_1MarleyTimeGen_1_1KeysToIgnore.html">KeysToIgnore</a> &gt;</td></tr>
<tr class="separator:a48c2c9467a5cde700b053b78f78547ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab6e4cdc7f70fb7e9a02603bce15d9c74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ab6e4cdc7f70fb7e9a02603bce15d9c74">MarleyTimeGen</a> (const <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">Parameters</a> &amp;<a class="el" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</td></tr>
<tr class="separator:ab6e4cdc7f70fb7e9a02603bce15d9c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5124da26a3bbdbf7800abd2d82dc6b13"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a5124da26a3bbdbf7800abd2d82dc6b13">produce</a> (art::Event &amp;<a class="el" href="../../d9/dd2/selectors_8fcl.html#ad3fec9b8b789cdb7b6899bd350d3a726">e</a>) override</td></tr>
<tr class="separator:a5124da26a3bbdbf7800abd2d82dc6b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4704af8675f4809256baf92fc5ab963d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4704af8675f4809256baf92fc5ab963d">beginRun</a> (art::Run &amp;run) override</td></tr>
<tr class="separator:a4704af8675f4809256baf92fc5ab963d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb6fc0fde53859e692cb7e5024d7a168"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aeb6fc0fde53859e692cb7e5024d7a168">reconfigure</a> (const <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">Parameters</a> &amp;<a class="el" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</td></tr>
<tr class="separator:aeb6fc0fde53859e692cb7e5024d7a168"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:adead6ce87293435e9b7aa926ca7a2b4f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4f">TimeGenSamplingMode</a> { <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a>, 
<a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>, 
<a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">TimeGenSamplingMode::UNIFORM_ENERGY</a>
 }</td></tr>
<tr class="memdesc:adead6ce87293435e9b7aa926ca7a2b4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type that defines the allowed ways that a neutrino's energy and arrival time may be sampled.  <a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4f">More...</a><br/></td></tr>
<tr class="separator:adead6ce87293435e9b7aa926ca7a2b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db03c6adf87a05bb8792c5eaabacc00"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00">PinchParamType</a> { <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87">PinchParamType::ALPHA</a>, 
<a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146">PinchParamType::BETA</a>
 }</td></tr>
<tr class="memdesc:a1db03c6adf87a05bb8792c5eaabacc00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type that defines the pinching parameter conventions that are understood by this module.  <a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00">More...</a><br/></td></tr>
<tr class="separator:a1db03c6adf87a05bb8792c5eaabacc00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b72d1d700f090cabef7700e49ed423"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423">SpectrumFileFormat</a> { <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">SpectrumFileFormat::RootTH2D</a>, 
<a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">SpectrumFileFormat::FIT</a>
 }</td></tr>
<tr class="memdesc:a80b72d1d700f090cabef7700e49ed423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type that defines the allowed neutrino spectrum input file formats.  <a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423">More...</a><br/></td></tr>
<tr class="separator:a80b72d1d700f090cabef7700e49ed423"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae98cda6e6240ce8a7f1b3274b49e49df"><td class="memItemLeft" align="right" valign="top">simb::MCTruth&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae98cda6e6240ce8a7f1b3274b49e49df">make_uniform_energy_mctruth</a> (double E_min, double E_max, double &amp;E_nu, const TLorentzVector &amp;vertex_pos)</td></tr>
<tr class="memdesc:ae98cda6e6240ce8a7f1b3274b49e49df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a simb::MCTruth object using a uniformly-sampled neutrino energy.  <a href="#ae98cda6e6240ce8a7f1b3274b49e49df">More...</a><br/></td></tr>
<tr class="separator:ae98cda6e6240ce8a7f1b3274b49e49df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da84af409447f211e9a302379d33ffb"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; marley::NeutrinoSource &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7da84af409447f211e9a302379d33ffb">source_from_time_fit</a> (const <a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html">TimeFit</a> &amp;fit)</td></tr>
<tr class="memdesc:a7da84af409447f211e9a302379d33ffb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a MARLEY neutrino source object using a set of fit parameters for a particular time bin.  <a href="#a7da84af409447f211e9a302379d33ffb">More...</a><br/></td></tr>
<tr class="separator:a7da84af409447f211e9a302379d33ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0e0889dd602fd7b138010ef6c46816"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#abd0e0889dd602fd7b138010ef6c46816">create_truths_th2d</a> (simb::MCTruth &amp;mc_truth, <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> &amp;sn_truth, const TLorentzVector &amp;vertex_pos)</td></tr>
<tr class="memdesc:abd0e0889dd602fd7b138010ef6c46816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create simb::MCTruth and <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> objects using spectrum information from a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> TH2D.  <a href="#abd0e0889dd602fd7b138010ef6c46816">More...</a><br/></td></tr>
<tr class="separator:abd0e0889dd602fd7b138010ef6c46816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2fa933bfd65f2a7a1d35be693ae300b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ad2fa933bfd65f2a7a1d35be693ae300b">create_truths_time_fit</a> (simb::MCTruth &amp;mc_truth, <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> &amp;sn_truth, const TLorentzVector &amp;vertex_pos)</td></tr>
<tr class="memdesc:ad2fa933bfd65f2a7a1d35be693ae300b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create simb::MCTruth and <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> objects using a neutrino spectrum described by a previously-parsed "fit"-format file.  <a href="#ad2fa933bfd65f2a7a1d35be693ae300b">More...</a><br/></td></tr>
<tr class="separator:ad2fa933bfd65f2a7a1d35be693ae300b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70145de7b1080b21e17828a9380784e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a70145de7b1080b21e17828a9380784e5">make_final_timefit</a> (double time)</td></tr>
<tr class="memdesc:a70145de7b1080b21e17828a9380784e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that makes a final dummy <a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html" title="Stores fitting parameters for all neutrino types from a single time bin in a &quot;fit&quot;-format spectrum fi...">TimeFit</a> object so that the final real time bin can have a right edge.  <a href="#a70145de7b1080b21e17828a9380784e5">More...</a><br/></td></tr>
<tr class="separator:a70145de7b1080b21e17828a9380784e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e36d0a9304425b1e346cfa6d85c7d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a28e36d0a9304425b1e346cfa6d85c7d6">make_nu_emission_histograms</a> () const </td></tr>
<tr class="memdesc:a28e36d0a9304425b1e346cfa6d85c7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> histograms showing the emitted neutrinos in each time bin when using a "fit"-format spectrum file.  <a href="#a28e36d0a9304425b1e346cfa6d85c7d6">More...</a><br/></td></tr>
<tr class="separator:a28e36d0a9304425b1e346cfa6d85c7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1a8c5d1e923981cfd479999a862303b1"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d1/d5e/classevgen_1_1MARLEYHelper.html">evgen::MARLEYHelper</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a></td></tr>
<tr class="memdesc:a1a8c5d1e923981cfd479999a862303b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object that provides an interface to the MARLEY event generator.  <a href="#a1a8c5d1e923981cfd479999a862303b1">More...</a><br/></td></tr>
<tr class="separator:a1a8c5d1e923981cfd479999a862303b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a1396e3bf7707f04765f81c0bd9e2e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../da/d99/classevgen_1_1ActiveVolumeVertexSampler.html">evgen::ActiveVolumeVertexSampler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae5a1396e3bf7707f04765f81c0bd9e2e">fVertexSampler</a></td></tr>
<tr class="memdesc:ae5a1396e3bf7707f04765f81c0bd9e2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Algorithm that allows us to sample vertex locations within the active volume(s) of the detector.  <a href="#ae5a1396e3bf7707f04765f81c0bd9e2e">More...</a><br/></td></tr>
<tr class="separator:ae5a1396e3bf7707f04765f81c0bd9e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4502d8a9cc5cb683927138c428c328b8"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; marley::Event &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a></td></tr>
<tr class="memdesc:a4502d8a9cc5cb683927138c428c328b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">unique_ptr to the current event created by MARLEY  <a href="#a4502d8a9cc5cb683927138c428c328b8">More...</a><br/></td></tr>
<tr class="separator:a4502d8a9cc5cb683927138c428c328b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1351676768966b8a3333a4227ba041"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a></td></tr>
<tr class="memdesc:afd1351676768966b8a3333a4227ba041"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> TH2D that contains the time-dependent spectrum to use when sampling neutrino times and energies.  <a href="#afd1351676768966b8a3333a4227ba041">More...</a><br/></td></tr>
<tr class="separator:afd1351676768966b8a3333a4227ba041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63525125e491d18cf8103021d32fa6b9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html">TimeFit</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a></td></tr>
<tr class="memdesc:a63525125e491d18cf8103021d32fa6b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector that contains the fit parameter information for each time bin when using a "fit"-format spectrum file.  <a href="#a63525125e491d18cf8103021d32fa6b9">More...</a><br/></td></tr>
<tr class="separator:a63525125e491d18cf8103021d32fa6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2173fb07895a37e40e6d000fced230e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4f">TimeGenSamplingMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a></td></tr>
<tr class="memdesc:a2173fb07895a37e40e6d000fced230e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the sampling mode to use when selecting neutrino times and energies.  <a href="#a2173fb07895a37e40e6d000fced230e4">More...</a><br/></td></tr>
<tr class="separator:a2173fb07895a37e40e6d000fced230e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dddaf6133a2f03cc696b17235120e83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00">PinchParamType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">fPinchType</a></td></tr>
<tr class="memdesc:a7dddaf6133a2f03cc696b17235120e83"><td class="mdescLeft">&#160;</td><td class="mdescRight">The pinching parameter convention to use when interpreting the time-dependent fits.  <a href="#a7dddaf6133a2f03cc696b17235120e83">More...</a><br/></td></tr>
<tr class="separator:a7dddaf6133a2f03cc696b17235120e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a888b9e781a56947fe244398eb976a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423">SpectrumFileFormat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a></td></tr>
<tr class="memdesc:a1a888b9e781a56947fe244398eb976a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format to assume for the neutrino spectrum input file.  <a href="#a1a888b9e781a56947fe244398eb976a5">More...</a><br/></td></tr>
<tr class="separator:a1a888b9e781a56947fe244398eb976a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd246b9891edf0914107d97995369b60"><td class="memItemLeft" align="right" valign="top">TTree *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a></td></tr>
<tr class="memdesc:acd246b9891edf0914107d97995369b60"><td class="mdescLeft">&#160;</td><td class="mdescRight">The event TTree created by MARLEY.  <a href="#acd246b9891edf0914107d97995369b60">More...</a><br/></td></tr>
<tr class="separator:acd246b9891edf0914107d97995369b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650be5c607fca9533b9b42887bec3609"><td class="memItemLeft" align="right" valign="top">uint_fast32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">fRunNumber</a></td></tr>
<tr class="memdesc:a650be5c607fca9533b9b42887bec3609"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run number from the art::Event being processed.  <a href="#a650be5c607fca9533b9b42887bec3609">More...</a><br/></td></tr>
<tr class="separator:a650be5c607fca9533b9b42887bec3609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe20c9143bce219243d9feaa68fae510"><td class="memItemLeft" align="right" valign="top">uint_fast32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">fSubRunNumber</a></td></tr>
<tr class="memdesc:afe20c9143bce219243d9feaa68fae510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subrun number from the art::Event being processed.  <a href="#afe20c9143bce219243d9feaa68fae510">More...</a><br/></td></tr>
<tr class="separator:afe20c9143bce219243d9feaa68fae510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c2e3a0f0202ce74625b772889b442c4"><td class="memItemLeft" align="right" valign="top">uint_fast32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">fEventNumber</a></td></tr>
<tr class="memdesc:a2c2e3a0f0202ce74625b772889b442c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event number from the art::Event being processed.  <a href="#a2c2e3a0f0202ce74625b772889b442c4">More...</a><br/></td></tr>
<tr class="separator:a2c2e3a0f0202ce74625b772889b442c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8db80241701c7a5b00bfe97525c2d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a></td></tr>
<tr class="memdesc:a0c8db80241701c7a5b00bfe97525c2d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time since the supernova core bounce for the current MARLEY neutrino vertex.  <a href="#a0c8db80241701c7a5b00bfe97525c2d5">More...</a><br/></td></tr>
<tr class="separator:a0c8db80241701c7a5b00bfe97525c2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eff919368595dd6285ce8eb316831c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a></td></tr>
<tr class="memdesc:a6eff919368595dd6285ce8eb316831c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistical weight for the current MARLEY neutrino vertex.  <a href="#a6eff919368595dd6285ce8eb316831c8">More...</a><br/></td></tr>
<tr class="separator:a6eff919368595dd6285ce8eb316831c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2f533bd98acf5306e4ea317b4c61ca"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a></td></tr>
<tr class="memdesc:a7a2f533bd98acf5306e4ea317b4c61ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flux-averaged total cross section (fm<sup>2</sup>, average is taken over all energies and times for all defined reactions) used by MARLEY to generate neutrino vertices.  <a href="#a7a2f533bd98acf5306e4ea317b4c61ca">More...</a><br/></td></tr>
<tr class="separator:a7a2f533bd98acf5306e4ea317b4c61ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53364dd2358b650f5e1677384f1afaa"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aa53364dd2358b650f5e1677384f1afaa">fNeutrinosPerEvent</a></td></tr>
<tr class="memdesc:aa53364dd2358b650f5e1677384f1afaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of MARLEY neutrino vertices to generate in each art::Event.  <a href="#aa53364dd2358b650f5e1677384f1afaa">More...</a><br/></td></tr>
<tr class="separator:aa53364dd2358b650f5e1677384f1afaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b99c5d08f649361e9996613832b8fc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a></td></tr>
<tr class="memdesc:a42b99c5d08f649361e9996613832b8fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum neutrino energy to consider when using a "fit"-format spectrum file.  <a href="#a42b99c5d08f649361e9996613832b8fc">More...</a><br/></td></tr>
<tr class="separator:a42b99c5d08f649361e9996613832b8fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b58a68d2316012159566b4612385f5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a></td></tr>
<tr class="memdesc:ae3b58a68d2316012159566b4612385f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum neutrino energy to consider when using a "fit"-format spectrum file.  <a href="#ae3b58a68d2316012159566b4612385f5">More...</a><br/></td></tr>
<tr class="separator:ae3b58a68d2316012159566b4612385f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00111">111</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a684b74fcc7f60f736cc91f8d5dbe1dce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a684b74fcc7f60f736cc91f8d5dbe1dce">evgen::MarleyTimeGen::Comment</a> =  fhicl::Comment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00116">116</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a96f540c7d4ac68e861d8f99846789606"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a96f540c7d4ac68e861d8f99846789606">evgen::MarleyTimeGen::Name</a> =  fhicl::Name</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00115">115</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a48c2c9467a5cde700b053b78f78547ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">evgen::MarleyTimeGen::Parameters</a> =  art::EDProducer::Table&lt;<a class="el" href="../../d2/d37/structevgen_1_1MarleyTimeGen_1_1Config.html">Config</a>, <a class="el" href="../../d8/d9a/structevgen_1_1MarleyTimeGen_1_1KeysToIgnore.html">KeysToIgnore</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00226">226</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a1db03c6adf87a05bb8792c5eaabacc00"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00">evgen::MarleyTimeGen::PinchParamType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enumerated type that defines the pinching parameter conventions that are understood by this module. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87"></a>ALPHA</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146"></a>BETA</em>&nbsp;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00463">463</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{ ALPHA, BETA };</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80b72d1d700f090cabef7700e49ed423"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423">evgen::MarleyTimeGen::SpectrumFileFormat</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enumerated type that defines the allowed neutrino spectrum input file formats. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78"></a>RootTH2D</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954"></a>FIT</em>&nbsp;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00484">484</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{ RootTH2D, FIT };</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adead6ce87293435e9b7aa926ca7a2b4f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4f">evgen::MarleyTimeGen::TimeGenSamplingMode</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enumerated type that defines the allowed ways that a neutrino's energy and arrival time may be sampled. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8"></a>HISTOGRAM</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459"></a>UNIFORM_TIME</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb"></a>UNIFORM_ENERGY</em>&nbsp;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00432">432</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{ HISTOGRAM, UNIFORM_TIME, UNIFORM_ENERGY };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab6e4cdc7f70fb7e9a02603bce15d9c74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">evgen::MarleyTimeGen::MarleyTimeGen </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00528">528</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  : EDProducer{ <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get_PSet() }, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>(<span class="keyword">new</span> marley::Event), <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">fRunNumber</a>(0),</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">fSubRunNumber</a>(0), <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">fEventNumber</a>(0), <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>(0.), <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>(0.)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;{</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// Configure the module (including MARLEY itself) using the FHiCL parameters</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  this-&gt;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aeb6fc0fde53859e692cb7e5024d7a168">reconfigure</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// Create a ROOT TTree using the TFileService that will store the MARLEY</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// event objects (useful for debugging purposes)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a> = tfs-&gt;make&lt;TTree&gt;(<span class="stringliteral">&quot;MARLEY_event_tree&quot;</span>,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="stringliteral">&quot;Neutrino events generated by MARLEY&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;event&quot;</span>, <span class="stringliteral">&quot;marley::Event&quot;</span>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>.get());</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// Add branches that give the art::Event run, subrun, and event numbers for</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// easy match-ups between the MARLEY and art TTrees. All three are recorded</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// as 32-bit unsigned integers.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;run_number&quot;</span>, &amp;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">fRunNumber</a>, <span class="stringliteral">&quot;run_number/i&quot;</span>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;subrun_number&quot;</span>, &amp;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">fSubRunNumber</a>, <span class="stringliteral">&quot;subrun_number/i&quot;</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;event_number&quot;</span>, &amp;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">fEventNumber</a>, <span class="stringliteral">&quot;event_number/i&quot;</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;tSN&quot;</span>, &amp;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <span class="stringliteral">&quot;tSN/D&quot;</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Branch(<span class="stringliteral">&quot;weight&quot;</span>, &amp;<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <span class="stringliteral">&quot;weight/D&quot;</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  produces&lt; std::vector&lt;simb::MCTruth&gt; &gt;();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  produces&lt; std::vector&lt;sim::SupernovaTruth&gt; &gt;();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  produces&lt; art::Assns&lt;simb::MCTruth, sim::SupernovaTruth&gt; &gt;();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="../../d4/d4d/namespaceevgen.html#a31fbf4ad9d853a87fefed5bf11c59aa6">produces&lt; sumdata::RunData, art::InRun &gt;</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a2c2e3a0f0202ce74625b772889b442c4"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">evgen::MarleyTimeGen::fEventNumber</a></div><div class="ttdeci">uint_fast32_t fEventNumber</div><div class="ttdoc">Event number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00500">MARLEYTimeGen_module.cc:500</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_aeb6fc0fde53859e692cb7e5024d7a168"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aeb6fc0fde53859e692cb7e5024d7a168">evgen::MarleyTimeGen::reconfigure</a></div><div class="ttdeci">virtual void reconfigure(const Parameters &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00772">MARLEYTimeGen_module.cc:772</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="namespaceevgen_html_a31fbf4ad9d853a87fefed5bf11c59aa6"><div class="ttname"><a href="../../d4/d4d/namespaceevgen.html#a31fbf4ad9d853a87fefed5bf11c59aa6">evgen::produces&lt; sumdata::RunData, art::InRun &gt;</a></div><div class="ttdeci">produces&lt; sumdata::RunData, art::InRun &gt;()</div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7a2f533bd98acf5306e4ea317b4c61ca"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">evgen::MarleyTimeGen::fFluxAveragedCrossSection</a></div><div class="ttdeci">double fFluxAveragedCrossSection</div><div class="ttdoc">Flux-averaged total cross section (fm2, average is taken over all energies and times for all defined ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00512">MARLEYTimeGen_module.cc:512</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a6eff919368595dd6285ce8eb316831c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">evgen::MarleyTimeGen::fWeight</a></div><div class="ttdeci">double fWeight</div><div class="ttdoc">Statistical weight for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00507">MARLEYTimeGen_module.cc:507</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_acd246b9891edf0914107d97995369b60"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">evgen::MarleyTimeGen::fEventTree</a></div><div class="ttdeci">TTree * fEventTree</div><div class="ttdoc">The event TTree created by MARLEY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00493">MARLEYTimeGen_module.cc:493</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_afe20c9143bce219243d9feaa68fae510"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">evgen::MarleyTimeGen::fSubRunNumber</a></div><div class="ttdeci">uint_fast32_t fSubRunNumber</div><div class="ttdoc">Subrun number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00498">MARLEYTimeGen_module.cc:498</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a650be5c607fca9533b9b42887bec3609"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">evgen::MarleyTimeGen::fRunNumber</a></div><div class="ttdeci">uint_fast32_t fRunNumber</div><div class="ttdoc">Run number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00496">MARLEYTimeGen_module.cc:496</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a0c8db80241701c7a5b00bfe97525c2d5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">evgen::MarleyTimeGen::fTNu</a></div><div class="ttdeci">double fTNu</div><div class="ttdoc">Time since the supernova core bounce for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00504">MARLEYTimeGen_module.cc:504</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a4502d8a9cc5cb683927138c428c328b8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">evgen::MarleyTimeGen::fEvent</a></div><div class="ttdeci">std::unique_ptr&lt; marley::Event &gt; fEvent</div><div class="ttdoc">unique_ptr to the current event created by MARLEY </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00403">MARLEYTimeGen_module.cc:403</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00253">NuVertexChargeTree_module.cc:253</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4704af8675f4809256baf92fc5ab963d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::beginRun </td>
          <td>(</td>
          <td class="paramtype">art::Run &amp;&#160;</td>
          <td class="paramname"><em>run</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00558">558</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                             {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  run.put(std::make_unique&lt;sumdata::RunData&gt;(geo-&gt;DetectorName()));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd0e0889dd602fd7b138010ef6c46816"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::create_truths_th2d </td>
          <td>(</td>
          <td class="paramtype">simb::MCTruth &amp;&#160;</td>
          <td class="paramname"><em>mc_truth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> &amp;&#160;</td>
          <td class="paramname"><em>sn_truth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TLorentzVector &amp;&#160;</td>
          <td class="paramname"><em>vertex_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create simb::MCTruth and <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> objects using spectrum information from a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> TH2D. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00564">564</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// Get a reference to the generator object created by MARLEY (we&#39;ll need</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// to do a few fancy things with it other than just creating events)</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">marley::Generator</a>&amp; gen = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;get_generator();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a>)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// Generate a MARLEY event using the time-integrated spectrum</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// (the generator was already configured to use it by reconfigure())</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;create_MCTruth(vertex_pos,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>.get());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// Find the time distribution corresponding to the selected energy bin</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">double</span> E_nu = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>-&gt;projectile().total_energy();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">int</span> E_bin_index = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;GetYaxis()-&gt;FindBin(E_nu);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    TH1D* t_hist = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;ProjectionX(<span class="stringliteral">&quot;dummy_time_hist&quot;</span>, E_bin_index,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      E_bin_index);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">double</span>* time_bin_weights = t_hist-&gt;GetArray();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Sample a time bin from the distribution</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    std::discrete_distribution&lt;int&gt; time_dist;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    std::discrete_distribution&lt;int&gt;::param_type time_params(time_bin_weights,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      &amp;(time_bin_weights[t_hist-&gt;GetNbinsX() + 1]));</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">int</span> time_bin_index = gen.sample_from_distribution(time_dist, time_params);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// Sample a time uniformly from within the selected time bin</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">double</span> t_min = t_hist-&gt;GetBinLowEdge(time_bin_index);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">double</span> t_max = t_min + t_hist-&gt;GetBinWidth(time_bin_index);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// sample a time on [ t_min, t_max )</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a> = gen.uniform_random_double(t_min, t_max, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Unbiased sampling was used, so assign this neutrino vertex a</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// unit statistical weight</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = ONE;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5">sim::kUnbiased</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// Generate a MARLEY event using the time-integrated spectrum</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// (the generator was already configured to use it by reconfigure())</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;create_MCTruth(vertex_pos,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>.get());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">// Sample a time uniformly</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    TAxis* time_axis = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;GetXaxis();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// underflow bin has index zero</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">double</span> t_min = time_axis-&gt;GetBinLowEdge(1);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordtype">double</span> t_max = time_axis-&gt;GetBinLowEdge(time_axis-&gt;GetNbins() + 1);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// sample a time on [ t_min, t_max )</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a> = gen.uniform_random_double(t_min, t_max, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">// Get the value of the true dependent probability density (probability</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// of the sampled time given the sampled energy) to use as a biasing</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// correction in the neutrino vertex weight.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordtype">double</span> E_nu = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>-&gt;projectile().total_energy();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">int</span> E_bin_index = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;GetYaxis()-&gt;FindBin(E_nu);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    TH1D* t_hist = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;ProjectionX(<span class="stringliteral">&quot;dummy_time_hist&quot;</span>, E_bin_index,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      E_bin_index);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">int</span> t_bin_index = t_hist-&gt;FindBin(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">double</span> weight_bias = t_hist-&gt;GetBinContent(t_bin_index) * (t_max - t_min)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      / ( t_hist-&gt;Integral() * t_hist-&gt;GetBinWidth(t_bin_index) );</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = weight_bias;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3">sim::kUniformTime</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">TimeGenSamplingMode::UNIFORM_ENERGY</a>)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// Select a time bin using the energy-integrated spectrum</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    TH1D* t_hist = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;ProjectionX(<span class="stringliteral">&quot;dummy_time_hist&quot;</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordtype">double</span>* time_bin_weights = t_hist-&gt;GetArray();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// Sample a time bin from the distribution</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    std::discrete_distribution&lt;int&gt; time_dist;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    std::discrete_distribution&lt;int&gt;::param_type time_params(time_bin_weights,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      &amp;(time_bin_weights[t_hist-&gt;GetNbinsX() + 1]));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">int</span> time_bin_index = gen.sample_from_distribution(time_dist, time_params);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// Sample a time uniformly from within the selected time bin</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">double</span> t_min = t_hist-&gt;GetBinLowEdge(time_bin_index);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordtype">double</span> t_max = t_min + t_hist-&gt;GetBinWidth(time_bin_index);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// sample a time on [ t_min, t_max )</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a> = gen.uniform_random_double(t_min, t_max, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// Sample an energy uniformly over the entire allowed range</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// underflow bin has index zero</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    TAxis* energy_axis = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;GetYaxis();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordtype">double</span> E_min = energy_axis-&gt;GetBinLowEdge(1);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">double</span> E_max = energy_axis-&gt;GetBinLowEdge(energy_axis-&gt;GetNbins() + 1);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordtype">double</span> E_nu = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// Generate a MARLEY event using a uniformly sampled energy</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae98cda6e6240ce8a7f1b3274b49e49df">make_uniform_energy_mctruth</a>(E_min, E_max, E_nu, vertex_pos);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// Get the value of the true dependent probability density (probability</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// of the sampled energy given the sampled time) to use as a biasing</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// correction in the neutrino vertex weight.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// Get a 1D projection of the energy spectrum for the sampled time bin</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    TH1D* energy_spect = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;ProjectionY(<span class="stringliteral">&quot;energy_spect&quot;</span>,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      time_bin_index, time_bin_index);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// Create a new MARLEY neutrino source object using this projection (this</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// will create a normalized probability density that we can use) and load</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// it into the generator.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keyword">auto</span> nu_source = marley_root::make_root_neutrino_source(</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      marley_utils::ELECTRON_NEUTRINO, energy_spect);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">double</span> new_source_E_min = nu_source-&gt;get_Emin();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordtype">double</span> new_source_E_max = nu_source-&gt;get_Emax();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    gen.set_source(std::move(nu_source));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// NOTE: The marley::Generator object normalizes the E_pdf to unity</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">// automatically, but just in case, we redo it here.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">double</span> E_pdf_integ = integrate([&amp;gen](<span class="keywordtype">double</span> E_nu)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      -&gt; <span class="keywordtype">double</span> { <span class="keywordflow">return</span> gen.E_pdf(E_nu); }, new_source_E_min,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      new_source_E_max);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Compute the likelihood ratio that we need to bias the neutrino vertex</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// weight</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">double</span> weight_bias = (gen.E_pdf(E_nu) / E_pdf_integ) * (E_max - E_min);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = weight_bias;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a">sim::kUniformEnergy</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Unrecognized sampling mode&quot;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; encountered in evgen::MarleyTimeGen::produce()&quot;</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a8c5d1e923981cfd479999a862303b1"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">evgen::MarleyTimeGen::fMarleyHelper</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::MARLEYHelper &gt; fMarleyHelper</div><div class="ttdoc">Object that provides an interface to the MARLEY event generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00396">MARLEYTimeGen_module.cc:396</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7a2f533bd98acf5306e4ea317b4c61ca"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">evgen::MarleyTimeGen::fFluxAveragedCrossSection</a></div><div class="ttdeci">double fFluxAveragedCrossSection</div><div class="ttdoc">Flux-averaged total cross section (fm2, average is taken over all energies and times for all defined ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00512">MARLEYTimeGen_module.cc:512</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a6eff919368595dd6285ce8eb316831c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">evgen::MarleyTimeGen::fWeight</a></div><div class="ttdeci">double fWeight</div><div class="ttdoc">Statistical weight for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00507">MARLEYTimeGen_module.cc:507</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3">sim::kUniformTime</a></div><div class="ttdoc">Arrival times were sampled uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00017">SupernovaTruth.h:17</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_TIME</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a0c8db80241701c7a5b00bfe97525c2d5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">evgen::MarleyTimeGen::fTNu</a></div><div class="ttdeci">double fTNu</div><div class="ttdoc">Time since the supernova core bounce for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00504">MARLEYTimeGen_module.cc:504</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a27ab58a0860bfd7644fdc17dea65e663"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">evgen::ldm::Generator</a></div><div class="ttdeci">Generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da4/MeVPrtlTruth_8h_source.html#l00012">MeVPrtlTruth.h:12</a></div></div>
<div class="ttc" id="classsim_1_1SupernovaTruth_html"><div class="ttname"><a href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00022">SupernovaTruth.h:22</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae98cda6e6240ce8a7f1b3274b49e49df"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae98cda6e6240ce8a7f1b3274b49e49df">evgen::MarleyTimeGen::make_uniform_energy_mctruth</a></div><div class="ttdeci">simb::MCTruth make_uniform_energy_mctruth(double E_min, double E_max, double &amp;E_nu, const TLorentzVector &amp;vertex_pos)</div><div class="ttdoc">Creates a simb::MCTruth object using a uniformly-sampled neutrino energy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01212">MARLEYTimeGen_module.cc:1212</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_afd1351676768966b8a3333a4227ba041"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">evgen::MarleyTimeGen::fSpectrumHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; fSpectrumHist</div><div class="ttdoc">ROOT TH2D that contains the time-dependent spectrum to use when sampling neutrino times and energies...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00409">MARLEYTimeGen_module.cc:409</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a4502d8a9cc5cb683927138c428c328b8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">evgen::MarleyTimeGen::fEvent</a></div><div class="ttdeci">std::unique_ptr&lt; marley::Event &gt; fEvent</div><div class="ttdoc">unique_ptr to the current event created by MARLEY </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00403">MARLEYTimeGen_module.cc:403</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_ENERGY</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5">sim::kUnbiased</a></div><div class="ttdoc">Sample directly from cross-section weighted spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00016">SupernovaTruth.h:16</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a2173fb07895a37e40e6d000fced230e4"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">evgen::MarleyTimeGen::fSamplingMode</a></div><div class="ttdeci">TimeGenSamplingMode fSamplingMode</div><div class="ttdoc">Represents the sampling mode to use when selecting neutrino times and energies. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00436">MARLEYTimeGen_module.cc:436</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">evgen::MarleyTimeGen::TimeGenSamplingMode::HISTOGRAM</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a">sim::kUniformEnergy</a></div><div class="ttdoc">Neutrino energies were sampled uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00018">SupernovaTruth.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2fa933bfd65f2a7a1d35be693ae300b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::create_truths_time_fit </td>
          <td>(</td>
          <td class="paramtype">simb::MCTruth &amp;&#160;</td>
          <td class="paramname"><em>mc_truth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> &amp;&#160;</td>
          <td class="paramname"><em>sn_truth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TLorentzVector &amp;&#160;</td>
          <td class="paramname"><em>vertex_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create simb::MCTruth and <a class="el" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> objects using a neutrino spectrum described by a previously-parsed "fit"-format file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01044">1044</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;{</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// Get a reference to the generator object created by MARLEY (we&#39;ll need</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// to do a few fancy things with it other than just creating events)</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">marley::Generator</a>&amp; gen = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;get_generator();</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="comment">// Initialize the time bin index to something absurdly large. This will help</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// us detect strange bugs that arise when it is sampled incorrectly.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordtype">size_t</span> time_bin_index = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::numeric_limits&lt;size_t&gt;::max</a>();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">// Create an object to represent the discrete time distribution given in</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">// the spectrum file. Use the luminosity for each bin as its sampling weight.</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">// This distribution will actually be used to sample a neutrino arrival time</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// unless we&#39;re using the uniform time sampling mode, in which case it will</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">// be used to help calculate the neutrino vertex weight.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordtype">int</span> source_pdg_code = gen.get_source().get_pid();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> fit_params_begin = <a class="code" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html#ae5b0b9c278a8a2ea2a4c333c543f6e51">TimeFit::make_FitParameters_iterator</a>(</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    source_pdg_code, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.begin() );</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> fit_params_end = <a class="code" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html#ae5b0b9c278a8a2ea2a4c333c543f6e51">TimeFit::make_FitParameters_iterator</a>(</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    source_pdg_code, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.end() );</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> lum_begin = <a class="code" href="../../de/d4e/classevgen_1_1MarleyTimeGen_1_1FitParameters.html#ae0f3abee1f001aa4925d3cfc06a1ec1a">FitParameters::make_luminosity_iterator</a>(</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    fit_params_begin);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> lum_end = <a class="code" href="../../de/d4e/classevgen_1_1MarleyTimeGen_1_1FitParameters.html#ae0f3abee1f001aa4925d3cfc06a1ec1a">FitParameters::make_luminosity_iterator</a>(</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    fit_params_end);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  std::discrete_distribution&lt;size_t&gt; time_dist(lum_begin, lum_end);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    || <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">TimeGenSamplingMode::UNIFORM_ENERGY</a>)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    time_bin_index = gen.sample_from_distribution(time_dist);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">int</span> last_time_index = 0;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.size() &gt; 0) last_time_index = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.size() - 1;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    std::uniform_int_distribution&lt;size_t&gt; uid(0, last_time_index);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">// for c2: time_bin_index has already been declared</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    time_bin_index = gen.sample_from_distribution(uid);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Unrecognized sampling mode&quot;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; encountered in evgen::MarleyTimeGen::produce()&quot;</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// Sample a time uniformly from within the selected time bin. Note that</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">// the entries in fTimeFits use the time_ member to store the bin left</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// edges. The module creates fTimeFits in such a way that its last element</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// will always have luminosity_ == 0. (zero sampling weight), so we may</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// always add one to the sampled bin index without worrying about going</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// off the edge.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordtype">double</span> t_min = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.at(time_bin_index).Time();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordtype">double</span> t_max = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.at(time_bin_index + 1).Time();</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// sample a time on [ t_min, t_max )</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a> = gen.uniform_random_double(t_min, t_max, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">// Create a &quot;beta-fit&quot; neutrino source using the correct parameters for the</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="comment">// sampled time bin. This will be used to sample a neutrino energy unless</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="comment">// we&#39;re using the uniform time sampling mode. For uniform time sampling,</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// it will be used to determine the neutrino event weight.</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; fit = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.at(time_bin_index);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  std::unique_ptr&lt;marley::NeutrinoSource&gt; nu_source = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7da84af409447f211e9a302379d33ffb">source_from_time_fit</a>(fit);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    || <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">// Replace the generator&#39;s old source with the new one for the current</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// time bin</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    gen.set_source(std::move(nu_source));</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// Generate a MARLEY event using the updated source</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;create_MCTruth(vertex_pos, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>.get());</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a>) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="comment">// Unbiased sampling creates neutrino vertices with unit weight</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = ONE;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5">sim::kUnbiased</a>);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="comment">// fSamplingMode == TimeGenSamplingMode::UNIFORM_TIME</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="comment">// Multiply by the likelihood ratio in order to correct for uniform</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">// time sampling if we&#39;re using that biasing method</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordtype">double</span> weight_bias = time_dist.probabilities().at(time_bin_index)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        / (t_max - t_min) * ( <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.back().Time()</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        - <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.front().Time() );</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = weight_bias;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3">sim::kUniformTime</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">TimeGenSamplingMode::UNIFORM_ENERGY</a>)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordtype">double</span> E_nu = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae98cda6e6240ce8a7f1b3274b49e49df">make_uniform_energy_mctruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a>, E_nu,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      vertex_pos);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// Get the value of the true dependent probability density (probability</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// of the sampled energy given the sampled time) to use as a biasing</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// correction in the neutrino vertex weight.</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// Load the generator with the neutrino source that represents the</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">// true (i.e., unbiased) energy probability distribution. This will</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// create a normalized probability density that we can use to determine</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// the neutrino vertex weight.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordtype">double</span> nu_source_E_min = nu_source-&gt;get_Emin();</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordtype">double</span> nu_source_E_max = nu_source-&gt;get_Emax();</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    gen.set_source(std::move(nu_source));</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// NOTE: The marley::Generator object normalizes the E_pdf to unity</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">// automatically, but just in case, we redo it here.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordtype">double</span> E_pdf_integ = integrate([&amp;gen](<span class="keywordtype">double</span> E_nu)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      -&gt; <span class="keywordtype">double</span> { <span class="keywordflow">return</span> gen.E_pdf(E_nu); }, nu_source_E_min,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      nu_source_E_max);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">// Compute the likelihood ratio that we need to bias the neutrino vertex</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">// weight</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordtype">double</span> weight_bias = (gen.E_pdf(E_nu) / E_pdf_integ)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      * (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a> - <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a> = weight_bias;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    sn_truth = <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a>(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">fWeight</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a>,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <a class="code" href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a">sim::kUniformEnergy</a>);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Unrecognized sampling mode&quot;</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; encountered in evgen::MarleyTimeGen::produce()&quot;</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;}</div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a8c5d1e923981cfd479999a862303b1"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">evgen::MarleyTimeGen::fMarleyHelper</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::MARLEYHelper &gt; fMarleyHelper</div><div class="ttdoc">Object that provides an interface to the MARLEY event generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00396">MARLEYTimeGen_module.cc:396</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7a2f533bd98acf5306e4ea317b4c61ca"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">evgen::MarleyTimeGen::fFluxAveragedCrossSection</a></div><div class="ttdeci">double fFluxAveragedCrossSection</div><div class="ttdoc">Flux-averaged total cross section (fm2, average is taken over all energies and times for all defined ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00512">MARLEYTimeGen_module.cc:512</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a6eff919368595dd6285ce8eb316831c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a6eff919368595dd6285ce8eb316831c8">evgen::MarleyTimeGen::fWeight</a></div><div class="ttdeci">double fWeight</div><div class="ttdoc">Statistical weight for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00507">MARLEYTimeGen_module.cc:507</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aaba0b7a740c1959e3a53fd0e83a66e5d3">sim::kUniformTime</a></div><div class="ttdoc">Arrival times were sampled uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00017">SupernovaTruth.h:17</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7da84af409447f211e9a302379d33ffb"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7da84af409447f211e9a302379d33ffb">evgen::MarleyTimeGen::source_from_time_fit</a></div><div class="ttdeci">std::unique_ptr&lt; marley::NeutrinoSource &gt; source_from_time_fit(const TimeFit &amp;fit)</div><div class="ttdoc">Create a MARLEY neutrino source object using a set of fit parameters for a particular time bin...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01185">MARLEYTimeGen_module.cc:1185</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_1_1FitParameters_html_ae0f3abee1f001aa4925d3cfc06a1ec1a"><div class="ttname"><a href="../../de/d4e/classevgen_1_1MarleyTimeGen_1_1FitParameters.html#ae0f3abee1f001aa4925d3cfc06a1ec1a">evgen::MarleyTimeGen::FitParameters::make_luminosity_iterator</a></div><div class="ttdeci">static marley::IteratorToMember&lt; It, double &gt; make_luminosity_iterator(It it)</div><div class="ttdoc">Converts an iterator that points to a FitParameters object into an iterator that points to that objec...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00267">MARLEYTimeGen_module.cc:267</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_TIME</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a0c8db80241701c7a5b00bfe97525c2d5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">evgen::MarleyTimeGen::fTNu</a></div><div class="ttdeci">double fTNu</div><div class="ttdoc">Time since the supernova core bounce for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00504">MARLEYTimeGen_module.cc:504</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a27ab58a0860bfd7644fdc17dea65e663"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">evgen::ldm::Generator</a></div><div class="ttdeci">Generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da4/MeVPrtlTruth_8h_source.html#l00012">MeVPrtlTruth.h:12</a></div></div>
<div class="ttc" id="classsim_1_1SupernovaTruth_html"><div class="ttname"><a href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00022">SupernovaTruth.h:22</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae98cda6e6240ce8a7f1b3274b49e49df"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae98cda6e6240ce8a7f1b3274b49e49df">evgen::MarleyTimeGen::make_uniform_energy_mctruth</a></div><div class="ttdeci">simb::MCTruth make_uniform_energy_mctruth(double E_min, double E_max, double &amp;E_nu, const TLorentzVector &amp;vertex_pos)</div><div class="ttdoc">Creates a simb::MCTruth object using a uniformly-sampled neutrino energy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01212">MARLEYTimeGen_module.cc:1212</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae3b58a68d2316012159566b4612385f5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">evgen::MarleyTimeGen::fFitEmax</a></div><div class="ttdeci">double fFitEmax</div><div class="ttdoc">Maximum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00524">MARLEYTimeGen_module.cc:524</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_1_1TimeFit_html_ae5b0b9c278a8a2ea2a4c333c543f6e51"><div class="ttname"><a href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html#ae5b0b9c278a8a2ea2a4c333c543f6e51">evgen::MarleyTimeGen::TimeFit::make_FitParameters_iterator</a></div><div class="ttdeci">static marley::IteratorToMember&lt; It, FitParameters &gt; make_FitParameters_iterator(int pdg_code, It iterator)</div><div class="ttdoc">Converts an iterator that points to a TimeFit object into an iterator that points to the appropriate ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00341">MARLEYTimeGen_module.cc:341</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a4502d8a9cc5cb683927138c428c328b8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">evgen::MarleyTimeGen::fEvent</a></div><div class="ttdeci">std::unique_ptr&lt; marley::Event &gt; fEvent</div><div class="ttdoc">unique_ptr to the current event created by MARLEY </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00403">MARLEYTimeGen_module.cc:403</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_ENERGY</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aae8fc771047a10eafd77443bffa687be5">sim::kUnbiased</a></div><div class="ttdoc">Sample directly from cross-section weighted spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00016">SupernovaTruth.h:16</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a2173fb07895a37e40e6d000fced230e4"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">evgen::MarleyTimeGen::fSamplingMode</a></div><div class="ttdeci">TimeGenSamplingMode fSamplingMode</div><div class="ttdoc">Represents the sampling mode to use when selecting neutrino times and energies. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00436">MARLEYTimeGen_module.cc:436</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a42b99c5d08f649361e9996613832b8fc"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">evgen::MarleyTimeGen::fFitEmin</a></div><div class="ttdeci">double fFitEmin</div><div class="ttdoc">Minimum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00520">MARLEYTimeGen_module.cc:520</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a63525125e491d18cf8103021d32fa6b9"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">evgen::MarleyTimeGen::fTimeFits</a></div><div class="ttdeci">std::vector&lt; TimeFit &gt; fTimeFits</div><div class="ttdoc">Vector that contains the fit parameter information for each time bin when using a &amp;quot;fit&amp;quot;-format spectr...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00415">MARLEYTimeGen_module.cc:415</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">evgen::MarleyTimeGen::TimeGenSamplingMode::HISTOGRAM</a></div></div>
<div class="ttc" id="namespacesim_html_aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a"><div class="ttname"><a href="../../d8/d7d/namespacesim.html#aa99a60e829999302849665f29beaf80aa687acba42139694050716361a71bae3a">sim::kUniformEnergy</a></div><div class="ttdoc">Neutrino energies were sampled uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00018">SupernovaTruth.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a70145de7b1080b21e17828a9380784e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::make_final_timefit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that makes a final dummy <a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html" title="Stores fitting parameters for all neutrino types from a single time bin in a &quot;fit&quot;-format spectrum fi...">TimeFit</a> object so that the final real time bin can have a right edge. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01259">1259</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;{</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">// The final time bin has zero luminosity, and therefore zero sampling</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// weight. We need it to be present so that the last nonzero weight bin</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// has a right edge.</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.emplace_back(time, 0., 0., 0., 0., 0., 0., 0., 0., 0.);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a63525125e491d18cf8103021d32fa6b9"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">evgen::MarleyTimeGen::fTimeFits</a></div><div class="ttdeci">std::vector&lt; TimeFit &gt; fTimeFits</div><div class="ttdoc">Vector that contains the fit parameter information for each time bin when using a &amp;quot;fit&amp;quot;-format spectr...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00415">MARLEYTimeGen_module.cc:415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28e36d0a9304425b1e346cfa6d85c7d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::make_nu_emission_histograms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Makes <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> histograms showing the emitted neutrinos in each time bin when using a "fit"-format spectrum file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01268">1268</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;{</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// To make a histogram with variable size bins, ROOT needs the bin</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// low edges to be contiguous in memory. This is not true of the</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// stored times in fTimeFits, so we&#39;ll need to make a temporary copy</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="comment">// of them.</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  std::vector&lt;double&gt; temp_times;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; fit : <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>) temp_times.push_back(fit.Time());</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="comment">// If, for some reason, there are fewer than two time bins, just return</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// without making the histograms.</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="comment">// TODO: consider throwing an exception here</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> (temp_times.size() &lt; 2) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">// Get the number of time bins</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordtype">int</span> num_bins = temp_times.size() - 1;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">// Create some ROOT TH1D objects using the TFileService. These will store</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">// the number of emitted neutrinos of each type in each time bin</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  art::ServiceHandle&lt;art::TFileService const&gt; <a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a>;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  TH1D* nue_hist = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;NueEmission&quot;</span>,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="stringliteral">&quot;Number of emitted #nu_{e}; time (s); number of neutrinos in time bin&quot;</span>,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    num_bins, temp_times.data());</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  TH1D* nuebar_hist = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;NuebarEmission&quot;</span>,</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="stringliteral">&quot;Number of emitted #bar{#nu}_{e}; time (s); number of neutrinos in&quot;</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="stringliteral">&quot; time bin&quot;</span>, num_bins, temp_times.data());</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  TH1D* nux_hist = tfs-&gt;make&lt;TH1D&gt;(<span class="stringliteral">&quot;NuxEmission&quot;</span>,</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="stringliteral">&quot;Number of emitted #nu_{x}; time (s); number of neutrinos in time bin&quot;</span>,</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    num_bins, temp_times.data());</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">// Load the histograms with the emitted neutrino counts</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> b = 1; b &lt; temp_times.size(); ++b) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keyword">const</span> TimeFit&amp; current_fit = fTimeFits.at(b - 1);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">const</span> TimeFit&amp; next_fit = fTimeFits.at(b);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordtype">double</span> bin_deltaT = next_fit.Time() - current_fit.Time();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; nue_params = current_fit.GetFitParameters(</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      marley_utils::ELECTRON_NEUTRINO);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; nuebar_params = current_fit.GetFitParameters(</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      marley_utils::ELECTRON_ANTINEUTRINO);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; nux_params = current_fit.GetFitParameters(</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      marley_utils::MUON_NEUTRINO);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// Convert from bin luminosity to number of neutrinos by</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">// multiplying by the bin time interval and dividing by the</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">// mean neutrino energy</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordtype">double</span> num_nue = 0.;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordtype">double</span> num_nuebar = 0.;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordtype">double</span> num_nux = 0.;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">if</span> (nue_params.Emean() != 0.) num_nue = nue_params.Luminosity()</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      * bin_deltaT / (nue_params.Emean() * MeV_to_erg);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">if</span> (nuebar_params.Emean() != 0.) num_nuebar = nuebar_params.Luminosity()</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      * bin_deltaT / (nuebar_params.Emean() * MeV_to_erg);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">if</span> (nux_params.Emean() != 0.) num_nux = nux_params.Luminosity()</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      * bin_deltaT / (nux_params.Emean() * MeV_to_erg);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    nue_hist-&gt;SetBinContent(b, num_nue);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    nuebar_hist-&gt;SetBinContent(b, num_nuebar);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    nux_hist-&gt;SetBinContent(b, num_nux);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a63525125e491d18cf8103021d32fa6b9"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">evgen::MarleyTimeGen::fTimeFits</a></div><div class="ttdeci">std::vector&lt; TimeFit &gt; fTimeFits</div><div class="ttdoc">Vector that contains the fit parameter information for each time bin when using a &amp;quot;fit&amp;quot;-format spectr...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00415">MARLEYTimeGen_module.cc:415</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_aa8ae0901ab0cec47d6c9bf9c22af764f"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#aa8ae0901ab0cec47d6c9bf9c22af764f">tfs</a></div><div class="ttdeci">art::ServiceHandle&lt; art::TFileService &gt; tfs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00253">NuVertexChargeTree_module.cc:253</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae98cda6e6240ce8a7f1b3274b49e49df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simb::MCTruth evgen::MarleyTimeGen::make_uniform_energy_mctruth </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>E_nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TLorentzVector &amp;&#160;</td>
          <td class="paramname"><em>vertex_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a simb::MCTruth object using a uniformly-sampled neutrino energy. </p>
<p>This function samples a reacting neutrino energy uniformly from the full range of energies allowed by the incident spectrum and the currently defined reactions. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01212">1212</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">marley::Generator</a>&amp; gen = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;get_generator();</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">// Sample an energy uniformly over the entire allowed range</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordtype">double</span> total_xs;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">// We have to check that the cross section is nonzero for the sampled</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">// energy (otherwise we&#39;ll generate an unphysical event). However, if the</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">// user has given us a histogram that is below threshold, the</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">// program could get stuck here endlessly, sampling rejected energy</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// after rejected energy. Just in case, we cap the total number of tries</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// and quit if things don&#39;t work out.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (j &gt;= MAX_UNIFORM_ENERGY_ITERATIONS) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Exceeded the maximum of &quot;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        &lt;&lt; MAX_UNIFORM_ENERGY_ITERATIONS &lt;&lt; <span class="stringliteral">&quot; while attempting to sample&quot;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; a neutrino energy uniformly.&quot;</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">// Sample an energy uniformly on [ E_min, E_max )</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    E_nu = gen.uniform_random_double(E_min, E_max, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    total_xs = 0.;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">// Check that at least one defined reaction has a non-zero total</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// cross section at the sampled energy. If this is not the case, try</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// again.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; react : gen.get_reactions()) {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      total_xs += react-&gt;total_xs(marley_utils::ELECTRON_NEUTRINO, E_nu);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    ++j;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  } <span class="keywordflow">while</span> (total_xs &lt;= 0.);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// Replace the existing neutrino source with a monoenergetic one at the</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// neutrino energy that was just sampled above</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  std::unique_ptr&lt;marley::NeutrinoSource&gt; nu_source</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    = std::make_unique&lt;marley::MonoNeutrinoSource&gt;(</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    marley_utils::ELECTRON_NEUTRINO, E_nu);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  gen.set_source(std::move(nu_source));</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">// Generate a MARLEY event using the new monoenergetic source</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keyword">auto</span> mc_truth = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a>-&gt;create_MCTruth(vertex_pos, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">fEvent</a>.get());</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordflow">return</span> mc_truth;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a8c5d1e923981cfd479999a862303b1"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">evgen::MarleyTimeGen::fMarleyHelper</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::MARLEYHelper &gt; fMarleyHelper</div><div class="ttdoc">Object that provides an interface to the MARLEY event generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00396">MARLEYTimeGen_module.cc:396</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a27ab58a0860bfd7644fdc17dea65e663"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">evgen::ldm::Generator</a></div><div class="ttdeci">Generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da4/MeVPrtlTruth_8h_source.html#l00012">MeVPrtlTruth.h:12</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a4502d8a9cc5cb683927138c428c328b8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a4502d8a9cc5cb683927138c428c328b8">evgen::MarleyTimeGen::fEvent</a></div><div class="ttdeci">std::unique_ptr&lt; marley::Event &gt; fEvent</div><div class="ttdoc">unique_ptr to the current event created by MARLEY </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00403">MARLEYTimeGen_module.cc:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5124da26a3bbdbf7800abd2d82dc6b13"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::produce </td>
          <td>(</td>
          <td class="paramtype">art::Event &amp;&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00705">705</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// Get the run, subrun, and event numbers from the current art::Event</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">fRunNumber</a> = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.run();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">fSubRunNumber</a> = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.subRun();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">fEventNumber</a> = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.event();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Prepare associations and vectors of truth objects that will be produced</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// and loaded into the current art::Event</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  std::unique_ptr&lt; std::vector&lt;simb::MCTruth&gt; &gt;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    truthcol(<span class="keyword">new</span> std::vector&lt;simb::MCTruth&gt;);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  std::unique_ptr&lt; std::vector&lt;sim::SupernovaTruth&gt; &gt;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    sn_truthcol(<span class="keyword">new</span> std::vector&lt;sim::SupernovaTruth&gt;);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  std::unique_ptr&lt; art::Assns&lt;simb::MCTruth, sim::SupernovaTruth&gt; &gt;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    truth_assns(<span class="keyword">new</span> art::Assns&lt;simb::MCTruth, sim::SupernovaTruth&gt;);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// Create temporary truth objects that we will use to load the event</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  simb::MCTruth truth;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a> sn_truth;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> &lt; <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aa53364dd2358b650f5e1677384f1afaa">fNeutrinosPerEvent</a>; ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// Sample a primary vertex location for this event</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    TLorentzVector vertex_pos = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae5a1396e3bf7707f04765f81c0bd9e2e">fVertexSampler</a>-&gt;sample_vertex_pos(*geo);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// Reset the neutrino&#39;s time-since-supernova to a bogus value (for now)</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">fTNu</a> = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">SpectrumFileFormat::RootTH2D</a>) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#abd0e0889dd602fd7b138010ef6c46816">create_truths_th2d</a>(truth, sn_truth, vertex_pos);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">SpectrumFileFormat::FIT</a>) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ad2fa933bfd65f2a7a1d35be693ae300b">create_truths_time_fit</a>(truth, sn_truth, vertex_pos);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Invalid spectrum file&quot;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; format encountered in evgen::MarleyTimeGen::produce()&quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// Write the marley::Event object to the event tree</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">fEventTree</a>-&gt;Fill();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Add the truth objects to the appropriate vectors</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    truthcol-&gt;push_back(truth);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    sn_truthcol-&gt;push_back(sn_truth);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// Associate the last entries in each of the truth object vectors (the</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// truth objects that were just created for the current neutrino vertex)</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// with each other</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    truth_assns-&gt;addSingle(art::PtrMaker&lt;simb::MCTruth&gt;{<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>}(truthcol-&gt;size() - 1),</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                           art::PtrMaker&lt;sim::SupernovaTruth&gt;{<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>}(sn_truthcol-&gt;size() - 1));</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// Load the completed truth object vectors and associations into the event</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.put(std::move(truthcol));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.put(std::move(sn_truthcol));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.put(std::move(truth_assns));</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a888b9e781a56947fe244398eb976a5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">evgen::MarleyTimeGen::fSpectrumFileFormat</a></div><div class="ttdeci">SpectrumFileFormat fSpectrumFileFormat</div><div class="ttdoc">Format to assume for the neutrino spectrum input file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00487">MARLEYTimeGen_module.cc:487</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a2c2e3a0f0202ce74625b772889b442c4"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2c2e3a0f0202ce74625b772889b442c4">evgen::MarleyTimeGen::fEventNumber</a></div><div class="ttdeci">uint_fast32_t fEventNumber</div><div class="ttdoc">Event number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00500">MARLEYTimeGen_module.cc:500</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ad2fa933bfd65f2a7a1d35be693ae300b"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ad2fa933bfd65f2a7a1d35be693ae300b">evgen::MarleyTimeGen::create_truths_time_fit</a></div><div class="ttdeci">void create_truths_time_fit(simb::MCTruth &amp;mc_truth, sim::SupernovaTruth &amp;sn_truth, const TLorentzVector &amp;vertex_pos)</div><div class="ttdoc">Create simb::MCTruth and sim::SupernovaTruth objects using a neutrino spectrum described by a previou...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01044">MARLEYTimeGen_module.cc:1044</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae5a1396e3bf7707f04765f81c0bd9e2e"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae5a1396e3bf7707f04765f81c0bd9e2e">evgen::MarleyTimeGen::fVertexSampler</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::ActiveVolumeVertexSampler &gt; fVertexSampler</div><div class="ttdoc">Algorithm that allows us to sample vertex locations within the active volume(s) of the detector...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00400">MARLEYTimeGen_module.cc:400</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_acd246b9891edf0914107d97995369b60"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#acd246b9891edf0914107d97995369b60">evgen::MarleyTimeGen::fEventTree</a></div><div class="ttdeci">TTree * fEventTree</div><div class="ttdoc">The event TTree created by MARLEY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00493">MARLEYTimeGen_module.cc:493</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">evgen::MarleyTimeGen::SpectrumFileFormat::FIT</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_afe20c9143bce219243d9feaa68fae510"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afe20c9143bce219243d9feaa68fae510">evgen::MarleyTimeGen::fSubRunNumber</a></div><div class="ttdeci">uint_fast32_t fSubRunNumber</div><div class="ttdoc">Subrun number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00498">MARLEYTimeGen_module.cc:498</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a650be5c607fca9533b9b42887bec3609"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a650be5c607fca9533b9b42887bec3609">evgen::MarleyTimeGen::fRunNumber</a></div><div class="ttdeci">uint_fast32_t fRunNumber</div><div class="ttdoc">Run number from the art::Event being processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00496">MARLEYTimeGen_module.cc:496</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_abd0e0889dd602fd7b138010ef6c46816"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#abd0e0889dd602fd7b138010ef6c46816">evgen::MarleyTimeGen::create_truths_th2d</a></div><div class="ttdeci">void create_truths_th2d(simb::MCTruth &amp;mc_truth, sim::SupernovaTruth &amp;sn_truth, const TLorentzVector &amp;vertex_pos)</div><div class="ttdoc">Create simb::MCTruth and sim::SupernovaTruth objects using spectrum information from a ROOT TH2D...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00564">MARLEYTimeGen_module.cc:564</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a0c8db80241701c7a5b00bfe97525c2d5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a0c8db80241701c7a5b00bfe97525c2d5">evgen::MarleyTimeGen::fTNu</a></div><div class="ttdeci">double fTNu</div><div class="ttdoc">Time since the supernova core bounce for the current MARLEY neutrino vertex. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00504">MARLEYTimeGen_module.cc:504</a></div></div>
<div class="ttc" id="classsim_1_1SupernovaTruth_html"><div class="ttname"><a href="../../d1/ded/classsim_1_1SupernovaTruth.html">sim::SupernovaTruth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5b/SupernovaTruth_8h_source.html#l00022">SupernovaTruth.h:22</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_aa53364dd2358b650f5e1677384f1afaa"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aa53364dd2358b650f5e1677384f1afaa">evgen::MarleyTimeGen::fNeutrinosPerEvent</a></div><div class="ttdeci">unsigned int fNeutrinosPerEvent</div><div class="ttdoc">The number of MARLEY neutrino vertices to generate in each art::Event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00516">MARLEYTimeGen_module.cc:516</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">evgen::MarleyTimeGen::SpectrumFileFormat::RootTH2D</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb6fc0fde53859e692cb7e5024d7a168"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::MarleyTimeGen::reconfigure </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a48c2c9467a5cde700b053b78f78547ee">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00772">772</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; seed_service = art::ServiceHandle&lt;rndm::NuRandomService&gt;();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; geom_service = art::ServiceHandle&lt;geo::Geometry const&gt;();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// Create a new evgen::ActiveVolumeVertexSampler object based on the current</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">// configuration</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae5a1396e3bf7707f04765f81c0bd9e2e">fVertexSampler</a> = std::make_unique&lt;evgen::ActiveVolumeVertexSampler&gt;(</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().vertex_, *seed_service, *geom_service, <span class="stringliteral">&quot;MARLEY_Vertex_Sampler&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// Create a new marley::Generator object based on the current configuration</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keyword">const</span> fhicl::ParameterSet marley_pset = <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get_PSet()</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    .get&lt; fhicl::ParameterSet &gt;( <span class="stringliteral">&quot;marley_parameters&quot;</span> );</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">fMarleyHelper</a> = std::make_unique&lt;MARLEYHelper&gt;( marley_pset,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    *seed_service, <span class="stringliteral">&quot;MARLEY&quot;</span> );</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">// Get the number of neutrino vertices per event from the FHiCL parameters</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aa53364dd2358b650f5e1677384f1afaa">fNeutrinosPerEvent</a> = <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().nu_per_event_();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// Determine the current sampling mode from the FHiCL parameters</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keyword">const</span> std::string&amp; samp_mode_str = <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().sampling_mode_();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (samp_mode_str == <span class="stringliteral">&quot;histogram&quot;</span>)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (samp_mode_str == <span class="stringliteral">&quot;uniform time&quot;</span>)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (samp_mode_str == <span class="stringliteral">&quot;uniform energy&quot;</span>)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">TimeGenSamplingMode::UNIFORM_ENERGY</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid sampling mode \&quot;&quot;</span> &lt;&lt; samp_mode_str &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; specified for the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  MF_LOG_INFO(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; fNeutrinosPerEvent &lt;&lt; <span class="stringliteral">&quot; neutrino vertices&quot;</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; will be generated for each art::Event using the \&quot;&quot;</span> &lt;&lt; samp_mode_str</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\&quot; sampling mode.&quot;</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// Retrieve the time-dependent neutrino spectrum from the spectrum file.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// Use different methods depending on the file&#39;s format.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  std::string spectrum_file_format = marley_utils::to_lowercase(</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().spectrum_file_format_());</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (spectrum_file_format == <span class="stringliteral">&quot;th2d&quot;</span>)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">SpectrumFileFormat::RootTH2D</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spectrum_file_format == <span class="stringliteral">&quot;fit&quot;</span>) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">SpectrumFileFormat::FIT</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    std::string pinch_type;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().pinching_parameter_type_(pinch_type) ) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Missing pinching parameter&quot;</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; type for a \&quot;fit\&quot; format spectrum file&quot;</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    marley_utils::to_lowercase_inplace(pinch_type);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (pinch_type == <span class="stringliteral">&quot;alpha&quot;</span>) <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">fPinchType</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87">PinchParamType::ALPHA</a>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pinch_type == <span class="stringliteral">&quot;beta&quot;</span>) <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">fPinchType</a> = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146">PinchParamType::BETA</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid pinching parameter type \&quot;&quot;</span> &lt;&lt; pinch_type</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\&quot; specified for the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().fit_Emin_(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>) ) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Missing minimum energy for a \&quot;fit\&quot; format spectrum&quot;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; used by the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().fit_Emax_(<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a>) ) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Missing maximum energy for a \&quot;fit\&quot; format spectrum&quot;</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; used by the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a> &lt; <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Maximum energy is less than the minimum energy for&quot;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; a \&quot;fit\&quot; format spectrum used by the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid spectrum file format \&quot;&quot;</span> &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().spectrum_file_format_()</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\&quot; specified for the MARLEYTimeGen module.&quot;</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">// Determine the full file name (including path) of the spectrum file</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  std::string full_spectrum_file_name</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    = fMarleyHelper-&gt;find_file(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().spectrum_file_(), <span class="stringliteral">&quot;spectrum&quot;</span>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">marley::Generator</a>&amp; gen = fMarleyHelper-&gt;get_generator();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">SpectrumFileFormat::RootTH2D</a>) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">// Retrieve the time-dependent neutrino flux from a ROOT file</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    std::unique_ptr&lt;TFile&gt; spectrum_file</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      = std::make_unique&lt;TFile&gt;(full_spectrum_file_name.c_str(), <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    TH2D* temp_h2 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    std::string namecycle;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().namecycle_(namecycle) ) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Missing namecycle for&quot;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; a TH2D spectrum file&quot;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    spectrum_file-&gt;GetObject(namecycle.c_str(), temp_h2);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>.reset(temp_h2);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// Disassociate the TH2D from its parent TFile. If we fail to do this,</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// then ROOT will auto-delete the TH2D when the TFile goes out of scope.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// Compute the flux-averaged total cross section using MARLEY. This will be</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// used to compute neutrino vertex weights for the sim::SupernovaTruth</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">// objects.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// Get a 1D projection of the energy spectrum (integrated over time)</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    TH1D* energy_spect = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">fSpectrumHist</a>-&gt;ProjectionY(<span class="stringliteral">&quot;energy_spect&quot;</span>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// Create a new MARLEY neutrino source object using this projection</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// TODO: replace the hard-coded electron neutrino PDG code here (and in</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">// several other places in this source file) when you&#39;re ready to use</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// MARLEY with multiple neutrino flavors</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    std::unique_ptr&lt;marley::NeutrinoSource&gt; nu_source</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      = marley_root::make_root_neutrino_source(marley_utils::ELECTRON_NEUTRINO,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      energy_spect);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">// Factor of hbar_c^2 converts from MeV^(-2) to fm^2</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a> = marley_utils::hbar_c2</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      * flux_averaged_total_xs(*nu_source, gen);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// For speed, sample energies first whenever possible (and then sample from</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// an energy-dependent timing distribution). This avoids unnecessary calls</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// to MARLEY to change the energy spectrum.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">TimeGenSamplingMode::HISTOGRAM</a> ||</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">fSamplingMode</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">TimeGenSamplingMode::UNIFORM_TIME</a>)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      gen.set_source(std::move(nu_source));</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  } <span class="comment">// spectrum_file_format == &quot;th2d&quot;</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">fSpectrumFileFormat</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">SpectrumFileFormat::FIT</a>) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// Clear out the old parameterized spectrum, if one exists</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.clear();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    std::ifstream fit_file(full_spectrum_file_name);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    std::string line;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">bool</span> found_end = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// current line number</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordtype">int</span> line_num = 0;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// number of lines checked in last call to marley_utils::get_next_line()</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordtype">int</span> lines_checked = 0;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordtype">double</span> old_time = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">while</span> ( line = marley_utils::get_next_line(fit_file, rx_comment_or_empty,</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keyword">false</span>, lines_checked), line_num += lines_checked, !line.empty() )</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">if</span> (found_end) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">MF_LOG_WARNING</a>(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Trailing content after last time&quot;</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bin found on line &quot;</span> &lt;&lt; line_num &lt;&lt; <span class="stringliteral">&quot; of the spectrum file &quot;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          &lt;&lt; full_spectrum_file_name;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordtype">double</span> time;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordtype">double</span> Emean_nue, alpha_nue, luminosity_nue;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordtype">double</span> Emean_nuebar, alpha_nuebar, luminosity_nuebar;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordtype">double</span> Emean_nux, alpha_nux, luminosity_nux;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      std::istringstream iss(line);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keywordtype">bool</span> ok_first = <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>( iss &gt;&gt; time );</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keywordflow">if</span> (time &lt;= old_time) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Time bin left edges given in the spectrum file must be&quot;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; strictly increasing. Invalid time bin value found on line &quot;</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        &lt;&lt; line_num &lt;&lt; <span class="stringliteral">&quot; of the spectrum file &quot;</span> &lt;&lt; full_spectrum_file_name;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">else</span> old_time = time;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordtype">bool</span> ok_rest = <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>( iss &gt;&gt; Emean_nue &gt;&gt; alpha_nue</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        &gt;&gt; luminosity_nue &gt;&gt; Emean_nuebar &gt;&gt; alpha_nuebar &gt;&gt; luminosity_nuebar</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        &gt;&gt; Emean_nux &gt;&gt; alpha_nux &gt;&gt; luminosity_nux</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      );</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordflow">if</span> (ok_first) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">// We haven&#39;t reached the final bin, so add another time bin</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// in the typical way.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">if</span> (ok_rest) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.emplace_back(time, Emean_nue, alpha_nue, luminosity_nue,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            Emean_nuebar, alpha_nuebar, luminosity_nuebar, Emean_nux,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            alpha_nux, luminosity_nux);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a70145de7b1080b21e17828a9380784e5">make_final_timefit</a>(time);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          found_end = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Parse error on line &quot;</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          &lt;&lt; line_num &lt;&lt; <span class="stringliteral">&quot; of the spectrum file &quot;</span> &lt;&lt; full_spectrum_file_name;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (!found_end) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordtype">size_t</span> num_time_bins = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.size();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">if</span> (num_time_bins &lt; 2) <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Missing right edge for the final time bin in the spectrum file &quot;</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        &lt;&lt; full_spectrum_file_name &lt;&lt; <span class="stringliteral">&quot;. Unable to guess a bin width for the &quot;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; final bin.&quot;</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="comment">// Guess that the width of the penultimate time bin and the width of</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">// the final time bin are the same</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordtype">double</span> delta_t_bin = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.back().Time()</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        - <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.at(num_time_bins - 2).Time();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordtype">double</span> last_bin_right_edge = <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>.back().Time() + delta_t_bin;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a70145de7b1080b21e17828a9380784e5">make_final_timefit</a>(last_bin_right_edge);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <a class="code" href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">MF_LOG_WARNING</a>(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Missing right&quot;</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; edge for the final time bin in the spectrum file &quot;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      &lt;&lt; full_spectrum_file_name &lt;&lt; <span class="stringliteral">&quot;. Assuming a width of &quot;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      &lt;&lt; delta_t_bin &lt;&lt; <span class="stringliteral">&quot; s for the final bin.&quot;</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// Compute the flux-averaged total cross section for the fitted spectrum.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// We will need this to compute neutrino vertex weights.</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    std::vector&lt; std::unique_ptr&lt; marley::NeutrinoSource &gt; &gt; fit_sources;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; fit : <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">fTimeFits</a>) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      fit_sources.emplace_back( <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7da84af409447f211e9a302379d33ffb">source_from_time_fit</a>(fit) );</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// TODO: add handling for non-nu_e neutrino types when suitable data become</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// available in MARLEY</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keyword">auto</span> temp_source = std::make_unique&lt;marley::FunctionNeutrinoSource&gt;(</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      marley_utils::ELECTRON_NEUTRINO, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a>,</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      [&amp;fit_sources, <span class="keyword">this</span>](<span class="keywordtype">double</span> E_nu) -&gt; <span class="keywordtype">double</span> {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordtype">double</span> flux = 0.;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; fit_sources.size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <span class="keyword">const</span> TimeFit&amp; current_fit = this-&gt;fTimeFits.at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; current_source = fit_sources.at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          <span class="keyword">const</span> FitParameters&amp; params = current_fit.GetFitParameters(</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            current_source-&gt;get_pid() );</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <span class="keywordtype">double</span> lum = params.Luminosity();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="comment">// Skip entries with zero luminosity, since they won&#39;t contribute</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <span class="comment">// anything to the overall integral. Skip negative luminosity ones as</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          <span class="comment">// well, just in case.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="keywordflow">if</span> (lum &lt;= 0.) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          flux += lum * current_source-&gt;pdf(E_nu);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">return</span> flux;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    );</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">double</span> flux_integ = 0.;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordtype">double</span> tot_xs_integ = 0.;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    flux_averaged_total_xs(*temp_source, gen, flux_integ, tot_xs_integ);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// Factor of hbar_c^2 converts from MeV^(-2) to fm^2</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a> =  marley_utils::hbar_c2</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      * tot_xs_integ / flux_integ;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a28e36d0a9304425b1e346cfa6d85c7d6">make_nu_emission_histograms</a>();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  } <span class="comment">// spectrum_file_format == &quot;fit&quot;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Unrecognized neutrino spectrum&quot;</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; file format \&quot;&quot;</span> &lt;&lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>().spectrum_file_format_() &lt;&lt; <span class="stringliteral">&quot;\&quot; encountered&quot;</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; in evgen::MarleyTimeGen::reconfigure()&quot;</span>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  MF_LOG_INFO(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;The flux-averaged total cross section&quot;</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; predicted by MARLEY for the current supernova spectrum is &quot;</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    &lt;&lt; <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">fFluxAveragedCrossSection</a> &lt;&lt; <span class="stringliteral">&quot; fm^2&quot;</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a888b9e781a56947fe244398eb976a5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a888b9e781a56947fe244398eb976a5">evgen::MarleyTimeGen::fSpectrumFileFormat</a></div><div class="ttdeci">SpectrumFileFormat fSpectrumFileFormat</div><div class="ttdoc">Format to assume for the neutrino spectrum input file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00487">MARLEYTimeGen_module.cc:487</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7dddaf6133a2f03cc696b17235120e83"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">evgen::MarleyTimeGen::fPinchType</a></div><div class="ttdeci">PinchParamType fPinchType</div><div class="ttdoc">The pinching parameter convention to use when interpreting the time-dependent fits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00467">MARLEYTimeGen_module.cc:467</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae5a1396e3bf7707f04765f81c0bd9e2e"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae5a1396e3bf7707f04765f81c0bd9e2e">evgen::MarleyTimeGen::fVertexSampler</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::ActiveVolumeVertexSampler &gt; fVertexSampler</div><div class="ttdoc">Algorithm that allows us to sample vertex locations within the active volume(s) of the detector...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00400">MARLEYTimeGen_module.cc:400</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146">evgen::MarleyTimeGen::PinchParamType::BETA</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1a8c5d1e923981cfd479999a862303b1"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1a8c5d1e923981cfd479999a862303b1">evgen::MarleyTimeGen::fMarleyHelper</a></div><div class="ttdeci">std::unique_ptr&lt; evgen::MARLEYHelper &gt; fMarleyHelper</div><div class="ttdoc">Object that provides an interface to the MARLEY event generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00396">MARLEYTimeGen_module.cc:396</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7a2f533bd98acf5306e4ea317b4c61ca"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7a2f533bd98acf5306e4ea317b4c61ca">evgen::MarleyTimeGen::fFluxAveragedCrossSection</a></div><div class="ttdeci">double fFluxAveragedCrossSection</div><div class="ttdoc">Flux-averaged total cross section (fm2, average is taken over all energies and times for all defined ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00512">MARLEYTimeGen_module.cc:512</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423a12197f0373bd373681e99d73fd509954">evgen::MarleyTimeGen::SpectrumFileFormat::FIT</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7da84af409447f211e9a302379d33ffb"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7da84af409447f211e9a302379d33ffb">evgen::MarleyTimeGen::source_from_time_fit</a></div><div class="ttdeci">std::unique_ptr&lt; marley::NeutrinoSource &gt; source_from_time_fit(const TimeFit &amp;fit)</div><div class="ttdoc">Create a MARLEY neutrino source object using a set of fit parameters for a particular time bin...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01185">MARLEYTimeGen_module.cc:1185</a></div></div>
<div class="ttc" id="namespacedetsim_html_ac17a92de25bbd84bdd320811fff947c6"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#ac17a92de25bbd84bdd320811fff947c6">detsim::MF_LOG_WARNING</a></div><div class="ttdeci">MF_LOG_WARNING(&quot;SimWire&quot;)&lt;&lt; &quot;SimWire is an example module that works for the &quot;&lt;&lt; &quot;MicroBooNE detector. Each experiment should implement &quot;&lt;&lt; &quot;its own version of this module to simulate electronics &quot;&lt;&lt; &quot;response.&quot;</div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa00ea006a32e9525c9b6b2edb4959c459">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_TIME</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a27ab58a0860bfd7644fdc17dea65e663"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a27ab58a0860bfd7644fdc17dea65e663">evgen::ldm::Generator</a></div><div class="ttdeci">Generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da4/MeVPrtlTruth_8h_source.html#l00012">MeVPrtlTruth.h:12</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae3b58a68d2316012159566b4612385f5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">evgen::MarleyTimeGen::fFitEmax</a></div><div class="ttdeci">double fFitEmax</div><div class="ttdoc">Maximum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00524">MARLEYTimeGen_module.cc:524</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_afd1351676768966b8a3333a4227ba041"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#afd1351676768966b8a3333a4227ba041">evgen::MarleyTimeGen::fSpectrumHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; fSpectrumHist</div><div class="ttdoc">ROOT TH2D that contains the time-dependent spectrum to use when sampling neutrino times and energies...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00409">MARLEYTimeGen_module.cc:409</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_aa53364dd2358b650f5e1677384f1afaa"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#aa53364dd2358b650f5e1677384f1afaa">evgen::MarleyTimeGen::fNeutrinosPerEvent</a></div><div class="ttdeci">unsigned int fNeutrinosPerEvent</div><div class="ttdoc">The number of MARLEY neutrino vertices to generate in each art::Event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00516">MARLEYTimeGen_module.cc:516</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423afe732b22923d9e6bb747aea617d05f78">evgen::MarleyTimeGen::SpectrumFileFormat::RootTH2D</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa9c23c27b34980b1bd9939a1cfe47b4eb">evgen::MarleyTimeGen::TimeGenSamplingMode::UNIFORM_ENERGY</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a2173fb07895a37e40e6d000fced230e4"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a2173fb07895a37e40e6d000fced230e4">evgen::MarleyTimeGen::fSamplingMode</a></div><div class="ttdeci">TimeGenSamplingMode fSamplingMode</div><div class="ttdoc">Represents the sampling mode to use when selecting neutrino times and energies. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00436">MARLEYTimeGen_module.cc:436</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a42b99c5d08f649361e9996613832b8fc"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">evgen::MarleyTimeGen::fFitEmin</a></div><div class="ttdeci">double fFitEmin</div><div class="ttdoc">Minimum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00520">MARLEYTimeGen_module.cc:520</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a70145de7b1080b21e17828a9380784e5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a70145de7b1080b21e17828a9380784e5">evgen::MarleyTimeGen::make_final_timefit</a></div><div class="ttdeci">void make_final_timefit(double time)</div><div class="ttdoc">Helper function that makes a final dummy TimeFit object so that the final real time bin can have a ri...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01259">MARLEYTimeGen_module.cc:1259</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a63525125e491d18cf8103021d32fa6b9"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a63525125e491d18cf8103021d32fa6b9">evgen::MarleyTimeGen::fTimeFits</a></div><div class="ttdeci">std::vector&lt; TimeFit &gt; fTimeFits</div><div class="ttdoc">Vector that contains the fit parameter information for each time bin when using a &amp;quot;fit&amp;quot;-format spectr...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00415">MARLEYTimeGen_module.cc:415</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a28e36d0a9304425b1e346cfa6d85c7d6"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a28e36d0a9304425b1e346cfa6d85c7d6">evgen::MarleyTimeGen::make_nu_emission_histograms</a></div><div class="ttdeci">void make_nu_emission_histograms() const </div><div class="ttdoc">Makes ROOT histograms showing the emitted neutrinos in each time bin when using a &amp;quot;fit&amp;quot;-format spectr...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01268">MARLEYTimeGen_module.cc:1268</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4fa7f33aef6b28f7abec2f5d804ab1343c8">evgen::MarleyTimeGen::TimeGenSamplingMode::HISTOGRAM</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87">evgen::MarleyTimeGen::PinchParamType::ALPHA</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7da84af409447f211e9a302379d33ffb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; marley::NeutrinoSource &gt; evgen::MarleyTimeGen::source_from_time_fit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html">TimeFit</a> &amp;&#160;</td>
          <td class="paramname"><em>fit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a MARLEY neutrino source object using a set of fit parameters for a particular time bin. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l01185">1185</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;{</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// Create a &quot;beta-fit&quot; neutrino source using the given fit parameters.</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// The two common fitting schemes (alpha and beta) differ in their</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="comment">// definitions by \beta = \alpha + 1.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="comment">// TODO: add handling for non-nu_e neutrino types</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keyword">const</span> FitParameters&amp; nue_parameters</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    = fit.GetFitParameters(marley_utils::ELECTRON_NEUTRINO);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordtype">double</span> beta = nue_parameters.Alpha();</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">fPinchType</a> == <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87">PinchParamType::ALPHA</a>) beta += 1.;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">fPinchType</a> != <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146">PinchParamType::BETA</a>) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;MARLEYTimeGen&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Unreognized pinching parameter&quot;</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; type encountered in evgen::MarleyTimeGen::source_from_time_fit()&quot;</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// Create the new source</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  std::unique_ptr&lt;marley::NeutrinoSource&gt; nu_source</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    = std::make_unique&lt;marley::BetaFitNeutrinoSource&gt;(</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    marley_utils::ELECTRON_NEUTRINO, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">fFitEmin</a>, <a class="code" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">fFitEmax</a>,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    nue_parameters.Emean(), beta);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">return</span> nu_source;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a7dddaf6133a2f03cc696b17235120e83"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a7dddaf6133a2f03cc696b17235120e83">evgen::MarleyTimeGen::fPinchType</a></div><div class="ttdeci">PinchParamType fPinchType</div><div class="ttdoc">The pinching parameter convention to use when interpreting the time-dependent fits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00467">MARLEYTimeGen_module.cc:467</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a36b84f8e3fba5bf993e3ba352d62d146">evgen::MarleyTimeGen::PinchParamType::BETA</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_ae3b58a68d2316012159566b4612385f5"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#ae3b58a68d2316012159566b4612385f5">evgen::MarleyTimeGen::fFitEmax</a></div><div class="ttdeci">double fFitEmax</div><div class="ttdoc">Maximum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00524">MARLEYTimeGen_module.cc:524</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a42b99c5d08f649361e9996613832b8fc"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a42b99c5d08f649361e9996613832b8fc">evgen::MarleyTimeGen::fFitEmin</a></div><div class="ttdeci">double fFitEmin</div><div class="ttdoc">Minimum neutrino energy to consider when using a &amp;quot;fit&amp;quot;-format spectrum file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00520">MARLEYTimeGen_module.cc:520</a></div></div>
<div class="ttc" id="classevgen_1_1MarleyTimeGen_html_a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87"><div class="ttname"><a href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00a002101f8725e5c78d9f30d87f3fa4c87">evgen::MarleyTimeGen::PinchParamType::ALPHA</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4502d8a9cc5cb683927138c428c328b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;marley::Event&gt; evgen::MarleyTimeGen::fEvent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unique_ptr to the current event created by MARLEY </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00403">403</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a2c2e3a0f0202ce74625b772889b442c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint_fast32_t evgen::MarleyTimeGen::fEventNumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Event number from the art::Event being processed. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00500">500</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="acd246b9891edf0914107d97995369b60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TTree* evgen::MarleyTimeGen::fEventTree</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The event TTree created by MARLEY. </p>
<p>This tree will be saved to the "hist" output file for validation purposes. The tree contains the same information as the generated simb::MCTruth objects, but in MARLEY's internal format </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00493">493</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae3b58a68d2316012159566b4612385f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::MarleyTimeGen::fFitEmax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum neutrino energy to consider when using a "fit"-format spectrum file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00524">524</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a42b99c5d08f649361e9996613832b8fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::MarleyTimeGen::fFitEmin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Minimum neutrino energy to consider when using a "fit"-format spectrum file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00520">520</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a7a2f533bd98acf5306e4ea317b4c61ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::MarleyTimeGen::fFluxAveragedCrossSection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flux-averaged total cross section (fm<sup>2</sup>, average is taken over all energies and times for all defined reactions) used by MARLEY to generate neutrino vertices. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00512">512</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1a8c5d1e923981cfd479999a862303b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d1/d5e/classevgen_1_1MARLEYHelper.html">evgen::MARLEYHelper</a>&gt; evgen::MarleyTimeGen::fMarleyHelper</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Object that provides an interface to the MARLEY event generator. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00396">396</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa53364dd2358b650f5e1677384f1afaa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int evgen::MarleyTimeGen::fNeutrinosPerEvent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of MARLEY neutrino vertices to generate in each art::Event. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00516">516</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a7dddaf6133a2f03cc696b17235120e83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a1db03c6adf87a05bb8792c5eaabacc00">PinchParamType</a> evgen::MarleyTimeGen::fPinchType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The pinching parameter convention to use when interpreting the time-dependent fits. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00467">467</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a650be5c607fca9533b9b42887bec3609"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint_fast32_t evgen::MarleyTimeGen::fRunNumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run number from the art::Event being processed. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00496">496</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a2173fb07895a37e40e6d000fced230e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#adead6ce87293435e9b7aa926ca7a2b4f">TimeGenSamplingMode</a> evgen::MarleyTimeGen::fSamplingMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Represents the sampling mode to use when selecting neutrino times and energies. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00436">436</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1a888b9e781a56947fe244398eb976a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dfe/classevgen_1_1MarleyTimeGen.html#a80b72d1d700f090cabef7700e49ed423">SpectrumFileFormat</a> evgen::MarleyTimeGen::fSpectrumFileFormat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format to assume for the neutrino spectrum input file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00487">487</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="afd1351676768966b8a3333a4227ba041"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; evgen::MarleyTimeGen::fSpectrumHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> TH2D that contains the time-dependent spectrum to use when sampling neutrino times and energies. </p>
<p>This member is only used when reading the spectrum from a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00409">409</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="afe20c9143bce219243d9feaa68fae510"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint_fast32_t evgen::MarleyTimeGen::fSubRunNumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Subrun number from the art::Event being processed. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00498">498</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a63525125e491d18cf8103021d32fa6b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../dc/da9/classevgen_1_1MarleyTimeGen_1_1TimeFit.html">TimeFit</a>&gt; evgen::MarleyTimeGen::fTimeFits</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector that contains the fit parameter information for each time bin when using a "fit"-format spectrum file. </p>
<p>This member is unused when the spectrum is read from a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> file. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00415">415</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a0c8db80241701c7a5b00bfe97525c2d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::MarleyTimeGen::fTNu</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Time since the supernova core bounce for the current MARLEY neutrino vertex. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00504">504</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae5a1396e3bf7707f04765f81c0bd9e2e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../da/d99/classevgen_1_1ActiveVolumeVertexSampler.html">evgen::ActiveVolumeVertexSampler</a>&gt; evgen::MarleyTimeGen::fVertexSampler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Algorithm that allows us to sample vertex locations within the active volume(s) of the detector. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00400">400</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a6eff919368595dd6285ce8eb316831c8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::MarleyTimeGen::fWeight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Statistical weight for the current MARLEY neutrino vertex. </p>

<p>Definition at line <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html#l00507">507</a> of file <a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../d9/d06/MARLEYTimeGen__module_8cc_source.html">MARLEYTimeGen_module.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
