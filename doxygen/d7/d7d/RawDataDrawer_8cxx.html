<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>RawDataDrawer.cxx File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_3e98d60ecc45d349696182ad202b32c7.html">lareventdisplay</a></li><li class="navelem"><a class="el" href="../../dir_5781bf99d53ed0be66321de9d8e4ff75.html">lareventdisplay</a></li><li class="navelem"><a class="el" href="../../dir_b4e3caa843c9962df70d14f97638a02d.html">EventDisplay</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">RawDataDrawer.cxx File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to aid in the rendering of RawData objects.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br/>
<code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;cstddef&gt;</code><br/>
<code>#include &lt;limits&gt;</code><br/>
<code>#include &lt;memory&gt;</code><br/>
<code>#include &lt;tuple&gt;</code><br/>
<code>#include &lt;type_traits&gt;</code><br/>
<code>#include &lt;typeinfo&gt;</code><br/>
<code>#include &lt;utility&gt;</code><br/>
<code>#include &quot;TBox.h&quot;</code><br/>
<code>#include &quot;TFrame.h&quot;</code><br/>
<code>#include &quot;TH1F.h&quot;</code><br/>
<code>#include &quot;TVirtualPad.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d3/d8b/Geometry_8h_source.html">larcore/Geometry/Geometry.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../de/df8/DetectorPropertiesService_8h_source.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../df/d87/StatCollector_8h_source.html">lardataalg/Utilities/StatCollector.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d9/d5a/RawDigit_8h_source.html">lardataobj/RawData/RawDigit.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d6/df4/raw_8h_source.html">lardataobj/RawData/raw.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d4/d0f/ChangeTrackers_8h_source.html">lareventdisplay/EventDisplay/ChangeTrackers.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d8/da2/ColorDrawingOptions_8h_source.html">lareventdisplay/EventDisplay/ColorDrawingOptions.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d7/d01/RawDataDrawer_8h_source.html">lareventdisplay/EventDisplay/RawDataDrawer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d83/RawDrawingOptions_8h_source.html">lareventdisplay/EventDisplay/RawDrawingOptions.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d7/ded/ChannelStatusProvider_8h_source.html">larevt/CalibrationDBI/Interface/ChannelStatusProvider.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d8/da1/ChannelStatusService_8h_source.html">larevt/CalibrationDBI/Interface/ChannelStatusService.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../de/deb/DetPedestalProvider_8h_source.html">larevt/CalibrationDBI/Interface/DetPedestalProvider.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../de/d04/DetPedestalService_8h_source.html">larevt/CalibrationDBI/Interface/DetPedestalService.h</a>&quot;</code><br/>
<code>#include &quot;nuevdb/EventDisplayBase/View2D.h&quot;</code><br/>
<code>#include &quot;art/Framework/Principal/Event.h&quot;</code><br/>
<code>#include &quot;art/Framework/Principal/Handle.h&quot;</code><br/>
<code>#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</code><br/>
<code>#include &quot;canvas/Persistency/Common/Ptr.h&quot;</code><br/>
<code>#include &quot;canvas/Utilities/Exception.h&quot;</code><br/>
<code>#include &quot;canvas/Utilities/InputTag.h&quot;</code><br/>
<code>#include &quot;cetlib_except/demangle.h&quot;</code><br/>
<code>#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</code><br/>
</div>
<p><a href="../../d7/d7d/RawDataDrawer_8cxx_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d24/classdetails_1_1PointerToData__t.html">details::PointerToData_t&lt; T &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d43/classevd_1_1details_1_1RawDigitInfo__t.html">evd::details::RawDigitInfo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about a RawDigit; may contain uncompressed duplicate of data.  <a href="../../de/d43/classevd_1_1details_1_1RawDigitInfo__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d82/structevd_1_1details_1_1RawDigitInfo__t_1_1SampleInfo__t.html">evd::details::RawDigitInfo_t::SampleInfo_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d91/classevd_1_1details_1_1RawDigitCacheDataClass.html">evd::details::RawDigitCacheDataClass</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cached set of <a class="el" href="../../de/d43/classevd_1_1details_1_1RawDigitInfo__t.html" title="Information about a RawDigit; may contain uncompressed duplicate of data. ">RawDigitInfo_t</a>.  <a href="../../df/d91/classevd_1_1details_1_1RawDigitCacheDataClass.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/structevd_1_1details_1_1RawDigitCacheDataClass_1_1BoolWithUpToDateMetadata.html">evd::details::RawDigitCacheDataClass::BoolWithUpToDateMetadata</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d20/classevd_1_1details_1_1GridAxisClass.html">evd::details::GridAxisClass</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages a cell-like division of a coordinate.  <a href="../../d2/d20/classevd_1_1details_1_1GridAxisClass.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d41/classevd_1_1details_1_1CellGridClass.html">evd::details::CellGridClass</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages a grid-like division of 2D space.  <a href="../../d5/d41/classevd_1_1details_1_1CellGridClass.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d42/classevd_1_1details_1_1ADCCorrectorClass.html">evd::details::ADCCorrectorClass</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Birks correction.  <a href="../../db/d42/classevd_1_1details_1_1ADCCorrectorClass.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8b/classevd_1_1RawDataDrawer_1_1OperationBaseClass.html">evd::RawDataDrawer::OperationBaseClass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d65/classevd_1_1RawDataDrawer_1_1ManyOperations.html">evd::RawDataDrawer::ManyOperations</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de8/classevd_1_1RawDataDrawer_1_1BoxDrawer.html">evd::RawDataDrawer::BoxDrawer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d26/classevd_1_1RawDataDrawer_1_1RoIextractorClass.html">evd::RawDataDrawer::RoIextractorClass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:db/d1b/namespacedetails"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d1b/namespacedetails.html">details</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/d2d/namespaceevd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d2d/namespaceevd.html">evd</a></td></tr>
<tr class="memdesc:da/d2d/namespaceevd"><td class="mdescLeft">&#160;</td><td class="mdescRight">LArSoft includes. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/d6c/namespaceevd_1_1details"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d6c/namespaceevd_1_1details.html">evd::details</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa8a85ed4bce0b82591f238c42093da8"><td class="memItemLeft" align="right" valign="top">std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../de/d43/classevd_1_1details_1_1RawDigitInfo__t.html">evd::details::RawDigitInfo_t</a> &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d6c/namespaceevd_1_1details.html#afa8a85ed4bce0b82591f238c42093da8">evd::details::begin</a> (RawDigitCacheDataClass const &amp;cache)</td></tr>
<tr class="separator:afa8a85ed4bce0b82591f238c42093da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac26cdd51830644b1e03646aecaac2a0c"><td class="memItemLeft" align="right" valign="top">std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../de/d43/classevd_1_1details_1_1RawDigitInfo__t.html">evd::details::RawDigitInfo_t</a> &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d6c/namespaceevd_1_1details.html#ac26cdd51830644b1e03646aecaac2a0c">evd::details::end</a> (RawDigitCacheDataClass const &amp;cache)</td></tr>
<tr class="separator:ac26cdd51830644b1e03646aecaac2a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to aid in the rendering of RawData objects. </p>
<dl class="section author"><dt>Author</dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'mes'+'si'+'er@'+'in'+'dia'+'na'+'.ed'+'u'; return false;">messi<span style="display: none;">.nosp@m.</span>er@i<span style="display: none;">.nosp@m.</span>ndian<span style="display: none;">.nosp@m.</span>a.ed<span style="display: none;">.nosp@m.</span>u</a></dd></dl>
<p>This class prepares the rendering of the raw digits content for the 2D view of the display. In particular, it fills the 2D view of detected charge vs. time and wire number for a single TPC. The code is not ready to support an arbitrary TPC from the detector; it can be fixed to support that, but a good deal of the calling code also has to change.</p>
<h2>Notes from Gianluca Petrillo (<a href="#" onclick="location.href='mai'+'lto:'+'pet'+'ri'+'llo'+'@f'+'nal'+'.g'+'ov'; return false;">petri<span style="display: none;">.nosp@m.</span>llo@<span style="display: none;">.nosp@m.</span>fnal.<span style="display: none;">.nosp@m.</span>gov</a>) on August 19, 2015 </h2>
<p>As of August 2015, this class performs some preprocessing for the data to be displayed. The main argument here is that the display assigns to each plane a space of 600x250 pixels, while the amound of data is typically 500x5000 elements. These numbers vary wildly: while the first number is close to the current default size for a new window, that window can be resized and windows many times larger can be obtained; for the data content, a MicroBooNE plane contains 2400x9600 elements (that's roughly 25 millions, and there is three of them), each of the two LArIAT planes contains 240x3200 (less than 1 million), and a single TPC of <a class="el" href="../../dd/d47/namespaceDUNE.html">DUNE</a>'s 35t prototype about 350x4800 (but it is larger when extended readout window modes are used). The code produces TBox'es to be rendered by the nuevdb event display infrastructure. The code before August 2015 would produce one box for each of the aggregated charge; charge could be aggregated in time by FHiCL configuration to merge TDC ticks. This typically bloats rendering time, since rendering of all boxes is attempted. The new code performs dynamic aggregation after discovering the actual size of the graphical viewport, and it submits at most one TBox per pixel. Additional improvement is caching of the uncompressed raw data, so that following zooming is faster, and especially a way to bypass the decompression when the original data is not compressed in the first place, that saves a bit of time and quite some memory.</p>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000080">Todo:</a></b></dt><dd>There are probably a number of glitches and shortcuts in the current preprocessing implementation. If they become a problem, they can probably be fixed on demand. Examples include:<ul>
<li>no alignment of the boxes with the wire and tick numbers</li>
<li>possible border effects</li>
<li>the fact that only the maximum charge is displayed on each box , and no dynamic charge range detection is in place</li>
<li>the first drawing is performed with a grid that is not the final one (because for some reason the frame starts larger than it should and is resized later)</li>
<li>the drawing honours the zoom region the user selected, even if the viewport ends up being larger (that is, if upstream decides that the zoom region is too small and a larger area will be drawn, the additional area will be blank) </li>
</ul>
</dd></dl>

<p>Definition in file <a class="el" href="../../d7/d7d/RawDataDrawer_8cxx_source.html">RawDataDrawer.cxx</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
