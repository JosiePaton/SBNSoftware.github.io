<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>RecoBaseDrawer.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_3e98d60ecc45d349696182ad202b32c7.html">lareventdisplay</a></li><li class="navelem"><a class="el" href="../../dir_5781bf99d53ed0be66321de9d8e4ff75.html">lareventdisplay</a></li><li class="navelem"><a class="el" href="../../dir_b4e3caa843c9962df70d14f97638a02d.html">EventDisplay</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RecoBaseDrawer.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/d53/RecoBaseDrawer_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/// \file    RecoBaseDrawer.cxx</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">/// \brief   Class to aid in the rendering of RecoBase objects</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \author  brebel@fnal.gov</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;TBox.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;TH1.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;TLine.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;TMarker.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;TPolyLine.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;TPolyLine3D.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;TPolyMarker.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;TPolyMarker3D.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;TRotation.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;TText.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;TVector3.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d13/CryostatGeo_8h.html">larcorealg/Geometry/CryostatGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d7c/Exceptions_8h.html">larcorealg/Geometry/Exceptions.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d80/PlaneGeo_8h.html">larcorealg/Geometry/PlaneGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/de9/TPCGeo_8h.html">larcorealg/Geometry/TPCGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/de5/WireGeo_8h.html">larcorealg/Geometry/WireGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d1b/MVAReader_8h.html">lardata/ArtDataHelper/MVAReader.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dba/DetectorClocksService_8h.html">lardata/DetectorInfoServices/DetectorClocksService.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dfd/lardata_2RecoBaseProxy_2Track_8h.html">lardata/RecoBaseProxy/Track.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d86/CosmicTag_8h.html">lardataobj/AnalysisBase/CosmicTag.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d77/Cluster_8h.html">lardataobj/RecoBase/Cluster.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/de0/Edge_8h.html">lardataobj/RecoBase/Edge.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d62/EndPoint2D_8h.html">lardataobj/RecoBase/EndPoint2D.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d8d/Event_8h.html">lardataobj/RecoBase/Event.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d34/OpFlash_8h.html">lardataobj/RecoBase/OpFlash.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d06/PCAxis_8h.html">lardataobj/RecoBase/PCAxis.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5c/PFParticle_8h.html">lardataobj/RecoBase/PFParticle.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d34/Seed_8h.html">lardataobj/RecoBase/Seed.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d69/Shower_8h.html">lardataobj/RecoBase/Shower.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d12/SpacePoint_8h.html">lardataobj/RecoBase/SpacePoint.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">lardataobj/RecoBase/Track.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d2d/Vertex_8h.html">lardataobj/RecoBase/Vertex.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d9f/Wire_8h.html">lardataobj/RecoBase/Wire.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d55/ISpacePoints3D_8h.html">lareventdisplay/EventDisplay/3DDrawers/ISpacePoints3D.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/da2/ColorDrawingOptions_8h.html">lareventdisplay/EventDisplay/ColorDrawingOptions.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d83/RawDrawingOptions_8h.html">lareventdisplay/EventDisplay/RawDrawingOptions.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d96/RecoBaseDrawer_8h.html">lareventdisplay/EventDisplay/RecoBaseDrawer.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/da8/RecoDrawingOptions_8h.html">lareventdisplay/EventDisplay/RecoDrawingOptions.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db5/eventdisplay_8h.html">lareventdisplay/EventDisplay/eventdisplay.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/ded/ChannelStatusProvider_8h.html">larevt/CalibrationDBI/Interface/ChannelStatusProvider.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/da1/ChannelStatusService_8h.html">larevt/CalibrationDBI/Interface/ChannelStatusService.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;nuevdb/EventDisplayBase/EventHolder.h&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;nuevdb/EventDisplayBase/View2D.h&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;nuevdb/EventDisplayBase/View3D.h&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;art/Utilities/make_tool.h&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/FindMany.h&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/Ptr.h&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/PtrVector.h&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;cetlib_except/exception.h&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// Utility function to make uniform error messages.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  writeErrMsg(<span class="keyword">const</span> <span class="keywordtype">char</span>* fcn, cet::exception <span class="keyword">const</span>&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    mf::LogWarning(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;RecoBaseDrawer::&quot;</span> &lt;&lt; fcn &lt;&lt; <span class="stringliteral">&quot; failed with message:\n&quot;</span> &lt;&lt; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">namespace </span>evd {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a000e5163d4ea999d9e3f6006609c5be8">   81</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a000e5163d4ea999d9e3f6006609c5be8">RecoBaseDrawer::RecoBaseDrawer</a>()</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOptions;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOptions;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>.resize(0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">fWireMax</a>.resize(0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">fTimeMin</a>.resize(0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">fTimeMax</a>.resize(0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">fRawCharge</a>.resize(0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">fConvertedCharge</a>.resize(0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// set the list of channels in this detector</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; geo-&gt;NTPC(); ++t) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nplanes = geo-&gt;Nplanes(t);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>.resize(nplanes, -1);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">fWireMax</a>.resize(nplanes, -1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">fTimeMin</a>.resize(nplanes, -1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">fTimeMax</a>.resize(nplanes, -1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">fRawCharge</a>.resize(nplanes, 0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">fConvertedCharge</a>.resize(nplanes, 0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; geo-&gt;Nplanes(t); ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>] = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">fWireMax</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>] = geo-&gt;TPC(t).Plane(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>).Nwires();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">fTimeMin</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>] = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">fTimeMax</a>[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>] = rawOptions-&gt;fTicks;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      } <span class="comment">// end loop over planes</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }   <span class="comment">// end loop over TPCs</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a82a23a008fc0616b5f8b3c6d685d4558">fAllSpacePointDrawer</a> =</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      art::make_tool&lt;evdb_tool::ISpacePoints3D&gt;(recoOptions-&gt;fAllSpacePointDrawerParams);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">fSpacePointDrawer</a> =</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      art::make_tool&lt;evdb_tool::ISpacePoints3D&gt;(recoOptions-&gt;fSpacePointDrawerParams);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7ebbe05d1c84aa780ee9bf26950ffab4">  118</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7ebbe05d1c84aa780ee9bf26950ffab4">RecoBaseDrawer::~RecoBaseDrawer</a>() {}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#affc20d2127c406b93c85ce849bcc2960">  122</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#affc20d2127c406b93c85ce849bcc2960">RecoBaseDrawer::Wire2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View2D* view, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    art::ServiceHandle&lt;evd::ColorDrawingOptions const&gt; cst;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a> <span class="keyword">const</span>&amp; channelStatus =</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      art::ServiceHandle&lt;lariov::ChannelStatusService const&gt;()-&gt;GetProvider();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> ticksPerPoint = rawOpt-&gt;fTicksPerPoint;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// to make det independent later:</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">double</span> mint = 5000;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">double</span> maxt = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">double</span> minw = 5000;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">double</span> maxw = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> pid(rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, plane);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fWireLabels.size(); ++imod) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fWireLabels[imod];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      art::PtrVector&lt;recob::Wire&gt; wires;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">GetWires</a>(evt, which, wires);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (wires.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; wires.size(); ++i) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        uint32_t channel = wires[i]-&gt;Channel();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (!rawOpt-&gt;fSeeBadChannels &amp;&amp; channelStatus.<a class="code" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html#abda9787c4790d2e8a5cfbd5d3a806fb1">IsBad</a>(channel)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        std::vector&lt;geo::WireID&gt; wireids = geo-&gt;ChannelToWire(channel);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a> sigType = geo-&gt;SignalType(channel);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; wid : wireids) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">if</span> (wid.planeID() != pid) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="keywordtype">double</span> wire = 1. * wid.Wire;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <span class="comment">// get the unpacked ROIs</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          std::vector&lt;float&gt; wirSig = wires[i]-&gt;Signal();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="keywordflow">if</span> (wirSig.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="comment">// get an iterator over the adc values</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          std::vector&lt;float&gt;::const_iterator itr = wirSig.begin();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="keywordflow">while</span> (itr != wirSig.end()) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordtype">int</span> ticksUsed = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordtype">double</span> tdcsum = 0.;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordtype">double</span> adcsum = 0.;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">while</span> (ticksUsed &lt; ticksPerPoint &amp;&amp; itr != wirSig.end()) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              tdcsum += <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              adcsum += (1. * (*itr));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              ++ticksUsed;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              tick += 1.;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              itr++; <span class="comment">// this advance of the iterator is sufficient for the external loop too</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">double</span> adc = adcsum / ticksPerPoint;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordtype">double</span> tdc = tdcsum / ticksPerPoint;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">if</span> (TMath::Abs(adc) &lt; rawOpt-&gt;fMinSignal) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">if</span> (tdc &gt; rawOpt-&gt;fTicks) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordtype">int</span> co = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordtype">double</span> sf = 1.;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordtype">double</span> q0 = 1000.0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            co = cst-&gt;CalQ(sigType).GetColor(adc);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span> (rawOpt-&gt;fScaleDigitsByCharge) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;              sf = sqrt(adc / q0);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;              <span class="keywordflow">if</span> (sf &gt; 1.0) sf = 1.0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">if</span> (wire &lt; minw) minw = wire;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> (wire &gt; maxw) maxw = wire;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> (tdc &lt; mint) mint = tdc;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> (tdc &gt; maxt) maxt = tdc;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &lt; 1) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              TBox&amp; b1 = view-&gt;AddBox(wire - sf * 0.5,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                      tdc - sf * 0.5 * ticksPerPoint,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                      wire + sf * 0.5,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                      tdc + sf * 0.5 * ticksPerPoint);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;              b1.SetFillStyle(1001);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              b1.SetFillColor(co);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;              b1.SetBit(kCannotPick);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              TBox&amp; b1 = view-&gt;AddBox(tdc - sf * 0.5 * ticksPerPoint,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                      wire - sf * 0.5,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                      tdc + sf * 0.5 * ticksPerPoint,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                      wire + sf * 0.5);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              b1.SetFillStyle(1001);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              b1.SetFillColor(co);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;              b1.SetBit(kCannotPick);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          } <span class="comment">// end loop over samples</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }   <span class="comment">//end loop over wire segments</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }     <span class="comment">//end loop over wires</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }       <span class="comment">// end loop over wire module labels</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>[plane] = minw;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">fWireMax</a>[plane] = maxw;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">fTimeMin</a>[plane] = mint;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">fTimeMax</a>[plane] = maxt;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Add a loop to draw dead wires in 2D display</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">double</span> startTick(50.);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">double</span> endTick((rawOpt-&gt;fTicks - 50.) * ticksPerPoint);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> wireNo = 0; wireNo &lt; geo-&gt;Nwires(pid); wireNo++) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel =</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        geo-&gt;PlaneWireToChannel(<a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a>(rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, plane, wireNo));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">if</span> (!rawOpt-&gt;fSeeBadChannels &amp;&amp; channelStatus.<a class="code" href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html#abda9787c4790d2e8a5cfbd5d3a806fb1">IsBad</a>(channel)) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordtype">double</span> wire = 1. * wireNo;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        TLine&amp; line = view-&gt;AddLine(wire, startTick, wire, endTick);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        line.SetLineColor(kGray);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        line.SetLineWidth(1.0);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        line.SetBit(kCannotPick);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">//......................................................................</span><span class="comment"></span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  /// Render Hit objects on a 2D viewing canvas</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// @param evt    : Event handle to get data objects from</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  /// @param view   : Pointer to view to draw on</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  /// @param plane  : plane number of view</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">  259</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">RecoBaseDrawer::Hit2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        evdb::View2D* view,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">int</span> nHitsDrawn(0);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawHits == 0) <span class="keywordflow">return</span> nHitsDrawn;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span> nHitsDrawn;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">fRawCharge</a>[plane] = 0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">fConvertedCharge</a>[plane] = 0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fHitLabels.size(); ++imod) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fHitLabels[imod];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      std::vector&lt;const recob::Hit*&gt; hits;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6a602cd2b200227e5d3bb462601fb57a">GetHits</a>(evt, which, hits, plane);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">// Display all hits on the two 2D views provided</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr : hits) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (itr-&gt;WireID().TPC != rawOpt-&gt;fTPC || itr-&gt;WireID().Cryostat != rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// Try to get the &quot;best&quot; charge measurement, ie. the one last in</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// the calibration chain</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">fRawCharge</a>[itr-&gt;WireID().Plane] += itr-&gt;PeakAmplitude();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">double</span> dQdX = itr-&gt;PeakAmplitude() / geo-&gt;WirePitch() / detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#ad6560a8ce8546dfa7ffa69ad009cb13a">ElectronsToADC</a>();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">fConvertedCharge</a>[itr-&gt;WireID().Plane] += detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8b47b2cbaecee116c0043583918ef5c9">BirksCorrection</a>(dQdX);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      } <span class="comment">// loop on hits</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      nHitsDrawn = this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, kBlack, view, recoOpt-&gt;fDrawAllWireIDs);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    } <span class="comment">// loop on imod folders</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> nHitsDrawn;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">//......................................................................</span><span class="comment"></span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">  /// Render Hit objects on a 2D viewing canvas</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">  /// @param hits   : vector of hits for the veiw</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  /// @param color  : color of associated cluster/prong</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">  /// @param view   : Pointer to view to draw on</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  /// assumes the hits are all from the correct plane for the given view</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab1c95d5465475e4f4fe87c652f0669c5">  312</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">RecoBaseDrawer::Hit2D</a>(std::vector&lt;const recob::Hit*&gt; hits,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        evdb::View2D* view,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        <span class="keywordtype">bool</span> allWireIDs,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        <span class="keywordtype">bool</span> drawConnectingLines,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        <span class="keywordtype">int</span> lineWidth)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = 0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wold = 0;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">float</span> timeold = 0.;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (color == -1) color = recoOpt-&gt;fSelectedHitColor;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">int</span> nHitsDrawn(0);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : hits) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">// Note that the WireID in the hit object is useless for those detectors where a channel can correspond to</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">// more than one plane/wire. So our plan is to recover the list of wire IDs from the channel number and</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// loop over those (if there are any)</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="comment">// However, we need to preserve the option for drawing hits only associated to the wireID it contains</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      std::vector&lt;geo::WireID&gt; wireIDs;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">if</span> (allWireIDs)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        wireIDs = geo-&gt;ChannelToWire(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;Channel());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        wireIDs.push_back(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">// Loop to find match</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; wireID : wireIDs) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span> (wireID.TPC != rawOpt-&gt;fTPC || wireID.Cryostat != rawOpt-&gt;fCryostat) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (std::isnan(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;PeakTime()) || std::isnan(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;Integral())) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;====&gt;&gt; Found hit with a NAN, channel: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;Channel()</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;, start/end: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;StartTick() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;EndTick()</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;, chisquare: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;GoodnessOfFit() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;PeakTime() &gt; rawOpt-&gt;fTicks) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        w = wireID.Wire;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">// Try to get the &quot;best&quot; charge measurement, ie. the one last in</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">// the calibration chain</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordtype">float</span> time = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;PeakTime();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">float</span> rms = 0.5 * <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;RMS();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &lt; 1) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          TBox&amp; b1 = view-&gt;AddBox(w - 0.5, time - rms, w + 0.5, time + rms);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keywordflow">if</span> (drawConnectingLines &amp;&amp; nHitsDrawn &gt; 0) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            TLine&amp; l = view-&gt;AddLine(w, time, wold, timeold);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            l.SetLineColor(color);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            l.SetBit(kCannotPick);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          b1.SetFillStyle(0);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          b1.SetBit(kCannotPick);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          b1.SetLineColor(color);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          b1.SetLineWidth(lineWidth);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          TBox&amp; b1 = view-&gt;AddBox(time - rms, w - 0.5, time + rms, w + 0.5);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="keywordflow">if</span> (drawConnectingLines &amp;&amp; nHitsDrawn &gt; 0) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            TLine&amp; l = view-&gt;AddLine(time, w, timeold, wold);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            l.SetLineColor(color);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            l.SetBit(kCannotPick);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          b1.SetFillStyle(0);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          b1.SetBit(kCannotPick);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          b1.SetLineColor(color);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          b1.SetLineWidth(lineWidth);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        wold = <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        timeold = time;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        nHitsDrawn++;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    } <span class="comment">// loop on hits</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> nHitsDrawn;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">//........................................................................</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7c030bea45a33c3be1270d75a44735f8">  397</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">RecoBaseDrawer::Hit2D</a>(std::vector&lt;const recob::Hit*&gt; hits, evdb::View2D* view, <span class="keywordtype">float</span> cosmicscore)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>(0);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wold(0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">float</span> timeold(0.);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">int</span> nHitsDrawn(0);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : hits) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">// check that we are in the correct TPC</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="comment">// the view should tell use we are in the correct plane</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().TPC != rawOpt-&gt;fTPC || <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Cryostat != rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      w = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Wire;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="comment">// Try to get the &quot;best&quot; charge measurement, ie. the one last in</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="comment">// the calibration chain</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordtype">float</span> time = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;PeakTime();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &lt; 1) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">if</span> (nHitsDrawn &gt; 0) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          TLine&amp; l = view-&gt;AddLine(w, time + 100, wold, timeold + 100);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;          l.SetLineWidth(3);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          l.SetLineColor(1);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <span class="keywordflow">if</span> (cosmicscore &gt; 0.5) l.SetLineColor(kMagenta);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          l.SetBit(kCannotPick);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (nHitsDrawn &gt; 0) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          TLine&amp; l = view-&gt;AddLine(time + 20, w, timeold + 20, wold);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          l.SetLineColor(1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="keywordflow">if</span> (cosmicscore &gt; 0.5) l.SetLineStyle(2);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          l.SetBit(kCannotPick);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      wold = <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      timeold = time;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      nHitsDrawn++;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    } <span class="comment">// loop on hits</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> nHitsDrawn;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">//........................................................................</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a42bb65d8393a6a2579f36441b53a3d59">  448</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a42bb65d8393a6a2579f36441b53a3d59">RecoBaseDrawer::GetRegionOfInterest</a>(<span class="keywordtype">int</span> plane, <span class="keywordtype">int</span>&amp; minw, <span class="keywordtype">int</span>&amp; maxw, <span class="keywordtype">int</span>&amp; mint, <span class="keywordtype">int</span>&amp; maxt)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)plane &gt; <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>.size()) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; Requested plane &quot;</span> &lt;&lt; plane &lt;&lt; <span class="stringliteral">&quot; is larger than those available &quot;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    minw = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">fWireMin</a>[plane];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    maxw = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">fWireMax</a>[plane];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    mint = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">fTimeMin</a>[plane];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    maxt = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">fTimeMax</a>[plane];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">//make values a bit larger, but make sure they don&#39;t go out of bounds</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    minw = (minw - 30 &lt; 0) ? 0 : minw - 30;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    mint = (mint - 10 &lt; 0) ? 0 : mint - 10;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">int</span> fTicks = rawOpt-&gt;fTicks;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    maxw = (maxw + 10 &gt; (int)geo-&gt;Nwires(plane)) ? geo-&gt;Nwires(plane) : maxw + 10;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    maxt = (maxt + 10 &gt; fTicks) ? fTicks : maxt + 10;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2a10bd9fa8de0950d18b8ff52ffd18ca">  478</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2a10bd9fa8de0950d18b8ff52ffd18ca">RecoBaseDrawer::GetChargeSum</a>(<span class="keywordtype">int</span> plane, <span class="keywordtype">double</span>&amp; charge, <span class="keywordtype">double</span>&amp; convcharge)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    charge = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">fRawCharge</a>[plane];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    convcharge = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">fConvertedCharge</a>[plane];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af9022c4d08737109415cd31ff6fd283f">  488</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af9022c4d08737109415cd31ff6fd283f">RecoBaseDrawer::EndPoint2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View2D* view, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDraw2DEndPoints == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> gview = geo-&gt;TPC(rawOpt-&gt;fTPC).Plane(plane).View();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fEndPoint2DLabels.size(); ++imod) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fEndPoint2DLabels[imod];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      art::PtrVector&lt;recob::EndPoint2D&gt; ep2d;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7aefd268b12e72bb9b50f772434e2e46">GetEndPoint2D</a>(evt, which, ep2d);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iep = 0; iep &lt; ep2d.size(); ++iep) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">// only worry about end points with the correct view</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span> (ep2d[iep]-&gt;View() != gview) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">        ///\todo - have to verify that we are in the right TPC, but to do that we</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span>        <span class="comment">// need to be sure that all EndPoint2D objects have filled the required information</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// draw cluster with unique marker</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// Place this cluster&#39;s unique marker at the hit&#39;s location</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[ep2d[iep]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = ep2d[iep]-&gt;WireID().Wire;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a> = ep2d[iep]-&gt;DriftTime();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          x = ep2d[iep]-&gt;DriftTime();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          y = ep2d[iep]-&gt;WireID().Wire;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(x, y, color, 30, 2.0);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// BB: draw the ID</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span> (recoOpt-&gt;fDraw2DEndPoints &gt; 1) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <span class="stringliteral">&quot;2V&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(ep2d[iep]-&gt;ID());</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          TText&amp; vtxID = view-&gt;AddText(x, y + 20, txt);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          vtxID.SetTextColor(color);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          vtxID.SetTextSize(0.05);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      } <span class="comment">// loop on iep end points</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }   <span class="comment">// loop on imod folders</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a49743948284a3b91b98c43475f6537e3">  543</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a49743948284a3b91b98c43475f6537e3">RecoBaseDrawer::OpFlash2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                            <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                            <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                            evdb::View2D* view,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawOpFlashes == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> pid(rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, plane);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fOpFlashLabels.size(); ++imod) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keyword">const</span> art::InputTag which = recoOpt-&gt;fOpFlashLabels[imod];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      art::PtrVector&lt;recob::OpFlash&gt; opflashes;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab023442ffe9c0c0b6129119af1cb2a88">GetOpFlashes</a>(evt, which, opflashes);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">if</span> (opflashes.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordtype">int</span> NFlashes = opflashes.size();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="comment">//double TopCoord = 1000;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      MF_LOG_VERBATIM(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Total &quot;</span> &lt;&lt; NFlashes &lt;&lt; <span class="stringliteral">&quot; flashes.&quot;</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="comment">// project each seed into this view</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iof = 0; iof &lt; opflashes.size(); ++iof) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;TotalPE() &lt; recoOpt-&gt;fFlashMinPE) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;Time() &lt; recoOpt-&gt;fFlashTMin) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;Time() &gt; recoOpt-&gt;fFlashTMax) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordtype">int</span> Color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[(iof) % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        MF_LOG_VERBATIM(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Flash t: &quot;</span> &lt;&lt; opflashes[iof]-&gt;Time() &lt;&lt; <span class="stringliteral">&quot;\t y,z : &quot;</span> &lt;&lt; opflashes[iof]-&gt;YCenter()</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; opflashes[iof]-&gt;ZCenter() &lt;&lt; <span class="stringliteral">&quot; \t PE :&quot;</span> &lt;&lt; opflashes[iof]-&gt;TotalPE();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordtype">float</span> flashtick =</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          opflashes[iof]-&gt;Time() / <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1e3 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">GetXTicksOffset</a>(pid);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordtype">float</span> wire0 = FLT_MAX;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordtype">float</span> wire1 = FLT_MIN;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">//Find the 4 corners and convert them to wire numbers</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        std::vector&lt;TVector3&gt; points;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        points.push_back(TVector3(0,</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                  opflashes[iof]-&gt;YCenter() - opflashes[iof]-&gt;YWidth(),</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                  opflashes[iof]-&gt;ZCenter() - opflashes[iof]-&gt;ZWidth()));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        points.push_back(TVector3(0,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                  opflashes[iof]-&gt;YCenter() - opflashes[iof]-&gt;YWidth(),</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                  opflashes[iof]-&gt;ZCenter() + opflashes[iof]-&gt;ZWidth()));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        points.push_back(TVector3(0,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                  opflashes[iof]-&gt;YCenter() + opflashes[iof]-&gt;YWidth(),</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                  opflashes[iof]-&gt;ZCenter() - opflashes[iof]-&gt;ZWidth()));</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        points.push_back(TVector3(0,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                  opflashes[iof]-&gt;YCenter() + opflashes[iof]-&gt;YWidth(),</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                  opflashes[iof]-&gt;ZCenter() + opflashes[iof]-&gt;ZWidth()));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; points.size(); ++i) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> wireID;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            wireID = geo-&gt;NearestWireID(points[i], pid);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordflow">catch</span> (<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html">geo::InvalidWireError</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            wireID = e.<a class="code" href="../../d6/d6c/classgeo_1_1InvalidWireError.html#a174c7f48dc6c32f680e033c960fbc9eb">suggestedWireID</a>(); <span class="comment">// pick the closest valid wire</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          <span class="keywordflow">if</span> (wireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a> &lt; wire0) wire0 = wireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="keywordflow">if</span> (wireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a> &gt; wire1) wire1 = wireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          TLine&amp; line = view-&gt;AddLine(flashtick, wire0, flashtick, wire1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          line.SetLineWidth(2);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          line.SetLineStyle(2);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          line.SetLineColor(Color);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          TLine&amp; line = view-&gt;AddLine(wire0, flashtick, wire1, flashtick);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          line.SetLineWidth(2);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          line.SetLineStyle(2);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          line.SetLineColor(Color);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      } <span class="comment">// loop on opflashes</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }   <span class="comment">// loop on imod folders</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a98da87c62b4fa46729695eef731877db">  632</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a98da87c62b4fa46729695eef731877db">RecoBaseDrawer::Seed2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                         <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                         evdb::View2D* view,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSeeds == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSeedLabels.size(); ++imod) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fSeedLabels[imod];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      art::PtrVector&lt;recob::Seed&gt; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0">GetSeeds</a>(evt, which, seeds);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">if</span> (seeds.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="comment">// project each seed into this view</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> isd = 0; isd &lt; seeds.size(); ++isd) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordtype">double</span> SeedPoint[3];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordtype">double</span> SeedDir[3];</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordtype">double</span> SeedPointErr[3];</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordtype">double</span> SeedDirErr[3];</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordtype">double</span> SeedEnd1[3];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordtype">double</span> SeedEnd2[3];</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        seeds[isd]-&gt;GetPoint(SeedPoint, SeedPointErr);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        seeds[isd]-&gt;GetDirection(SeedDir, SeedDirErr);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        SeedEnd1[0] = SeedPoint[0] + SeedDir[0];</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        SeedEnd1[1] = SeedPoint[1] + SeedDir[1];</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        SeedEnd1[2] = SeedPoint[2] + SeedDir[2];</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        SeedEnd2[0] = SeedPoint[0] - SeedDir[0];</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        SeedEnd2[1] = SeedPoint[1] - SeedDir[1];</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        SeedEnd2[2] = SeedPoint[2] - SeedDir[2];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">// Draw seed on evd</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">// int color  = kColor[seeds[isd]-&gt;ID()%kNCOLS];</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[0];</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wirepoint = 0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wireend1 = 0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wireend2 = 0;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          wirepoint = geo-&gt;NearestWire(SeedPoint, plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          wirepoint = atoi(e.explain_self().substr(e.explain_self().find(<span class="stringliteral">&quot;#&quot;</span>) + 1, 5).c_str());</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          wireend1 = geo-&gt;NearestWire(SeedEnd1, plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">catch</span> (cet::exception&amp; e) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          wireend1 = atoi(e.explain_self().substr(e.explain_self().find(<span class="stringliteral">&quot;#&quot;</span>) + 1, 5).c_str());</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          wireend2 = geo-&gt;NearestWire(SeedEnd2, plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">catch</span> (cet::exception&amp; e) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          wireend2 = atoi(e.explain_self().substr(e.explain_self().find(<span class="stringliteral">&quot;#&quot;</span>) + 1, 5).c_str());</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = wirepoint;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedPoint[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordtype">double</span> x1 = wireend1;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordtype">double</span> y1 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedEnd1[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordtype">double</span> x2 = wireend2;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordtype">double</span> y2 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedEnd2[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          x = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedPoint[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          y = wirepoint;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          x1 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedEnd1[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          y1 = wireend1;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          x2 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(SeedEnd2[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          y2 = wireend2;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(x, y, color, 4, 1.5);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        TLine&amp; line = view-&gt;AddLine(x1, y1, x2, y2);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        line.SetLineColor(color);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        line.SetLineWidth(2.0);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      } <span class="comment">// loop on seeds</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    }   <span class="comment">// loop on imod folders</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#afdc8cc789422cc2ebc34e38af10b0d61">  726</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#afdc8cc789422cc2ebc34e38af10b0d61">RecoBaseDrawer::Slice2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                          <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                          evdb::View2D* view,</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// Color code hits associated with Slices</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSlices == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;******** DrawSlices: 0 = none, 1 = color coded, 2 = color coded + ID at slice center\n&quot;</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;  3 = open circle at slice center with size proportional to the AspectRatio. &quot;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                   <span class="stringliteral">&quot;Closed circles&quot;</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;      at the slice ends with connecting dotted lines\n&quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = rawOpt-&gt;fCryostat;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t = rawOpt-&gt;fTPC;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeID(c, t, plane);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSliceLabels.size(); ++imod) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fSliceLabels[imod];</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      art::PtrVector&lt;recob::Slice&gt; <a class="code" href="../../de/d0f/namespacetca.html#a0898183aa6813a6ab2cbaede7d31e4d1">slices</a>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a93222627e36c5913a7aed3ade5c68f3d">GetSlices</a>(evt, which, slices);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (slices.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      art::FindMany&lt;recob::Hit&gt; fmh(slices, evt, which);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> isl = 0; isl &lt; slices.size(); ++isl) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordtype">int</span> slcID(<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slices[isl]-&gt;ID()));</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">int</span> color(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[slcID % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>]);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSlices &lt; 3) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          <span class="comment">// draw color-coded hits</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          std::vector&lt;const recob::Hit*&gt; hits = fmh.at(isl);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          std::vector&lt;const recob::Hit*&gt; hits_on_plane;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : hits) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Plane == plane) { hits_on_plane.push_back(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>); }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits_on_plane, color, view, <span class="keyword">false</span>, <span class="keyword">false</span>) &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSlices == 2) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> slicePos(</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;              slices[isl]-&gt;Center().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), slices[isl]-&gt;Center().Y(), slices[isl]-&gt;Center().Z());</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(slices[isl]-&gt;Center().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), planeID);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(slicePos, planeID);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(slcID);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            TText&amp; slcID = view-&gt;AddText(wire, tick, txt);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            slcID.SetTextSize(0.05);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            slcID.SetTextColor(color);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          } <span class="comment">// draw ID</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="comment">// draw the center, end points and direction vector</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> slicePos(</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            slices[isl]-&gt;Center().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), slices[isl]-&gt;Center().Y(), slices[isl]-&gt;Center().Z());</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(slices[isl]-&gt;Center().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), planeID);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(slicePos, planeID);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="keywordtype">float</span> markerSize = 1;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="keywordflow">if</span> (slices[isl]-&gt;AspectRatio() &gt; 0) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            markerSize = 1 / slices[isl]-&gt;AspectRatio();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">if</span> (markerSize &gt; 3) markerSize = 3;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          TMarker&amp; ctr = view-&gt;AddMarker(wire, tick, color, 24, markerSize);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          ctr.SetMarkerColor(color);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="comment">// npts, color, width, style</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          TPolyLine&amp; pline = view-&gt;AddPolyLine(2, color, 2, 3);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> slicePos0(</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            slices[isl]-&gt;End0Pos().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), slices[isl]-&gt;End0Pos().Y(), slices[isl]-&gt;End0Pos().Z());</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          tick = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(slices[isl]-&gt;End0Pos().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), planeID);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          wire = geo-&gt;WireCoordinate(slicePos0, planeID);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          TMarker&amp; end0 = view-&gt;AddMarker(wire, tick, color, 20, 1.0);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;          end0.SetMarkerColor(color);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          pline.SetPoint(0, wire, tick);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> slicePos1(</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            slices[isl]-&gt;End1Pos().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), slices[isl]-&gt;End1Pos().Y(), slices[isl]-&gt;End1Pos().Z());</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          tick = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(slices[isl]-&gt;End1Pos().<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), plane, t, c);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          wire = geo-&gt;WireCoordinate(slicePos1, planeID);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;          TMarker&amp; end1 = view-&gt;AddMarker(wire, tick, color, 20, 1.0);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;          end1.SetMarkerColor(color);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;          pline.SetPoint(1, wire, tick);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      } <span class="comment">// isl</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    } <span class="comment">// imod</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  } <span class="comment">// Slice2D</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a32be06137aa5a6386e54ff2858e04f64">  818</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a32be06137aa5a6386e54ff2858e04f64">RecoBaseDrawer::Cluster2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                            <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                            <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                            evdb::View2D* view,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawClusters == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> gview = geo-&gt;TPC(rawOpt-&gt;fTPC).Plane(plane).View();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// if user sets &quot;DrawClusters&quot; to 2, draw the clusters differently:</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">//    bool drawAsMarkers = (recoOpt-&gt;fDrawClusters == 1 ||</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">//                          recoOpt-&gt;fDrawClusters == 3);</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordtype">bool</span> drawAsMarkers = recoOpt-&gt;fDrawClusters != 2;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// draw connecting lines between cluster hits?</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">bool</span> drawConnectingLines = (recoOpt-&gt;fDrawClusters &gt;= 3);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;******** DrawClusters: 0 = none, 1 = cluster hits, 2 = unique marker, 3 = &quot;</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                   <span class="stringliteral">&quot;cluster hits with connecting lines.\n&quot;</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; 4 = with T&lt;cluster or trajectory ID&gt; P&lt;PFParticle ID&gt; color-matched. &quot;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                   <span class="stringliteral">&quot;Unmatched cluster IDs shown in black.\n&quot;</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; Color scheme: By cluster ID in each plane or by PFParticle ID (Self) if a &quot;</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                   <span class="stringliteral">&quot;PFParticle - Cluster association exists.\n&quot;</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fClusterLabels.size(); ++imod) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fClusterLabels[imod];</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      art::PtrVector&lt;recob::Cluster&gt; clust;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ace0bb80462a10ee526f5aaefb70b8415">GetClusters</a>(evt, which, clust);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">if</span> (clust.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">// We want to draw the hits that are associated to &quot;free&quot; space points (non clustered)</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// This is done here, before drawing the hits on clusters so they will be &quot;under&quot; the cluster</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="comment">// hits (since spacepoints could be made from a used 2D hit but then not used themselves)</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="comment">// Get the space points created by the PFParticle producer</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spacePointVec;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, which, spacePointVec);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="comment">// No space points no continue</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">if</span> (spacePointVec.size() &gt; 0) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// Add the relations to recover associations cluster hits</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        art::FindManyP&lt;recob::Hit&gt; spHitAssnVec(spacePointVec, evt, which);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (spHitAssnVec.isValid()) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <span class="comment">// Create a local hit vector...</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          std::vector&lt;const recob::Hit*&gt; freeHitVec;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="comment">// loop through space points looking for those that are free</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spacePointPtr : spacePointVec) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">if</span> (spacePointPtr-&gt;Chisq() &lt; -99.) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;              <span class="comment">// Recover associated hits</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              <span class="keyword">const</span> std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; hitVec =</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                spHitAssnVec.at(spacePointPtr.key());</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; hitPtr : hitVec) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <span class="keywordflow">if</span> (hitPtr.get()-&gt;WireID().Plane != plane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                freeHitVec.push_back(hitPtr.get());</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;              }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;          <span class="comment">// Draw the free hits in gray</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(freeHitVec, kGray, view, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="comment">// Ok, now proceed with our normal processing of hits on clusters</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      art::FindMany&lt;recob::Hit&gt; fmh(clust, evt, which);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      art::FindManyP&lt;recob::PFParticle&gt; fmc(clust, evt, which);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ic = 0; ic &lt; clust.size(); ++ic) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// only worry about clusters with the correct view</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">//            if(clust[ic]-&gt;View() != gview) continue;</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">if</span> (clust[ic]-&gt;<a class="code" href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a>().Plane != plane) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// see if we can set the color index in a sensible fashion</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordtype">int</span> clusterIdx(<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(clust[ic]-&gt;ID()));</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordtype">int</span> colorIdx(clusterIdx % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordtype">bool</span> pfpAssociation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordtype">int</span> pfpIndex = INT_MAX;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordtype">float</span> cosmicscore = FLT_MIN;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">if</span> (fmc.isValid()) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          std::vector&lt;art::Ptr&lt;recob::PFParticle&gt;&gt; pfplist = fmc.at(ic);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="comment">// Use the first one</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          <span class="keywordflow">if</span> (!pfplist.empty()) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            clusterIdx = pfplist[0]-&gt;Self();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            colorIdx = clusterIdx % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            pfpAssociation = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            pfpIndex = pfplist[0]-&gt;Self();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="comment">//Get cosmic score</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">if</span> (recoOpt-&gt;fDrawCosmicTags) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;              art::FindManyP&lt;anab::CosmicTag&gt; fmct(pfplist, evt, which);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;              <span class="keywordflow">if</span> (fmct.isValid()) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                std::vector&lt;art::Ptr&lt;anab::CosmicTag&gt;&gt; ctlist = fmct.at(0);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordflow">if</span> (!ctlist.empty()) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                  <span class="comment">//std::cout&lt;&lt;&quot;cosmic tag &quot;&lt;&lt;ctlist[0]-&gt;CosmicScore()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                  cosmicscore = ctlist[0]-&gt;CosmicScore();</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;              }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          } <span class="comment">// pfplist is not empty</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        std::vector&lt;const recob::Hit*&gt; hits = fmh.at(ic);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">if</span> (drawAsMarkers) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          <span class="comment">// draw cluster with unique marker</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">// Place this cluster&#39;s unique marker at the hit&#39;s location</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[colorIdx];</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="comment">// If there are no hits in this cryostat/TPC then we skip the rest</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          <span class="comment">// That no hits were drawn is the sign for this</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, color, view, <span class="keyword">false</span>, drawConnectingLines) &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fDrawCosmicTags &amp;&amp; cosmicscore != FLT_MIN)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, view, cosmicscore);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fDrawClusters &gt; 3) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="comment">// BB: draw the cluster ID</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="comment">//std::string s = std::to_string(clusterIdx);</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="comment">// TY: change to draw cluster id instead of index</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="comment">//                std::string s = std::to_string(clusterIdx) + &quot;,&quot; + std::to_string(clust[ic]-&gt;ID());</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="comment">// BB: Put a T in front to denote a trajectory ID</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <span class="stringliteral">&quot;T&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(clust[ic]-&gt;ID());</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="comment">// append the PFP index + 1 (sort of the ID)</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keywordflow">if</span> (pfpIndex != INT_MAX) s = s + <span class="stringliteral">&quot; P&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(pfpIndex + 1);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordtype">double</span> wire = 0.5 * (clust[ic]-&gt;StartWire() + clust[ic]-&gt;EndWire());</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = 20 + 0.5 * (clust[ic]-&gt;StartTick() + clust[ic]-&gt;EndTick());</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            TText&amp; clID = view-&gt;AddText(wire, tick, txt);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            clID.SetTextSize(0.05);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="keywordflow">if</span> (pfpAssociation) { clID.SetTextColor(color); }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;              clID.SetTextColor(kBlack);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;          } <span class="comment">// recoOpt-&gt;fDrawClusters &gt; 3</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          <span class="comment">// default &quot;outline&quot; method:</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          std::vector&lt;double&gt; tpts, wpts;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aff2e3940c9e158fb7ee9c70aa3457848">GetClusterOutlines</a>(hits, tpts, wpts, plane);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          <span class="keywordtype">int</span> lcolor = 9; <span class="comment">// line color</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          <span class="keywordtype">int</span> fcolor = 9; <span class="comment">// fill color</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;          <span class="keywordtype">int</span> width = 2;  <span class="comment">// line width</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          <span class="keywordtype">int</span> <a class="code" href="../../d6/d72/namespaceutil.html#a3bf4876cc648f293505a82b303ad1ad0">style</a> = 1;  <span class="comment">// 1=solid line style</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;          <span class="keywordflow">if</span> (view != 0) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            TPolyLine&amp; <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a> = view-&gt;AddPolyLine(wpts.size(), lcolor, width, <a class="code" href="../../d6/d72/namespaceutil.html#a3bf4876cc648f293505a82b303ad1ad0">style</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            TPolyLine&amp; p2 = view-&gt;AddPolyLine(wpts.size(), lcolor, width, <a class="code" href="../../d6/d72/namespaceutil.html#a3bf4876cc648f293505a82b303ad1ad0">style</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            p1.SetOption(<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            p1.SetFillStyle(3003);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            p1.SetFillColor(fcolor);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; wpts.size(); ++i) {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;              <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &lt; 1) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                p1.SetPoint(i, wpts[i], tpts[i]);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                p2.SetPoint(i, wpts[i], tpts[i]);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;              }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                p1.SetPoint(i, tpts[i], wpts[i]);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                p2.SetPoint(i, tpts[i], wpts[i]);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            } <span class="comment">// loop on i points in ZX view</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          }   <span class="comment">// if we have a cluster in the ZX view</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }     <span class="comment">// end if outline mode</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// draw the direction cosine of the cluster as well as it&#39;s starting point</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// (average of the start and end angle -- by default they are the same value)</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">// thetawire is the angle measured CW from +z axis to wire</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">//double thetawire = geo-&gt;TPC(t).Plane(plane).Wire(0).ThetaZ();</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordtype">double</span> wirePitch = geo-&gt;WirePitch(gview);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordtype">double</span> driftvelocity = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>();    <span class="comment">// cm/us</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordtype">double</span> timetick = <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-3; <span class="comment">// time sample in us</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">// rotate coord system CCW around x-axis by pi-thetawire</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">//   new yprime direction is perpendicular to the wire direction</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">//   in the same plane as the wires and in the direction of</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">//   increasing wire number</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="comment">//use yprime-component of dir cos in rotated coord sys to get</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">//   dTdW (number of time ticks per unit of wire pitch)</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="comment">//double rotang = 3.1416-thetawire;</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">Draw2DSlopeEndPoints</a>(</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          clust[ic]-&gt;StartWire(),</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          clust[ic]-&gt;<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>(),</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          clust[ic]-&gt;EndWire(),</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          clust[ic]-&gt;EndTick(),</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          std::tan((clust[ic]-&gt;StartAngle() + clust[ic]-&gt;EndAngle()) / 2.) * wirePitch /</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            driftvelocity / timetick,</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[colorIdx],</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          view);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      } <span class="comment">// loop on ic clusters</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    }   <span class="comment">// loop on imod folders</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170"> 1030</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">RecoBaseDrawer::Draw2DSlopeEndPoints</a>(<span class="keywordtype">double</span> xStart,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                       <span class="keywordtype">double</span> yStart,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                       <span class="keywordtype">double</span> xEnd,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                       <span class="keywordtype">double</span> yEnd,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                       <span class="keywordtype">double</span> slope,</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                       <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                       evdb::View2D* view)</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDraw2DSlopeEndPoints &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordtype">double</span> x1 = xStart;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordtype">double</span> y1 = yStart;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordtype">double</span> x2 = xEnd;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordtype">double</span> slope1 = slope;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      x1 = yStart;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      y1 = xStart;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      x2 = yEnd;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope) &gt; 0.)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        slope1 = 1. / slope;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        slope1 = 1.e6;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordtype">double</span> deltaX = 0.5 * (x2 - x1);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordtype">double</span> xm = x1 + deltaX;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordtype">double</span> ym = y1 + deltaX * slope;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    TMarker&amp; strt = view-&gt;AddMarker(xm, ym, color, kFullCircle, 1.0);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    strt.SetMarkerColor(color); <span class="comment">// stupid line to shut up compiler warning</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//    double stublen = 50.0 ;</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordtype">double</span> stublen = 2. * deltaX;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    TLine&amp; l = view-&gt;AddLine(x1, y1, x1 + stublen, y1 + slope1 * stublen);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    l.SetLineColor(color);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    l.SetLineWidth(1); <span class="comment">//2);</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad9076664e56deeda59cb4965ff8bb63f"> 1077</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">RecoBaseDrawer::Draw2DSlopeEndPoints</a>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                       <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                       <span class="keywordtype">double</span> slope,</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                       <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                       evdb::View2D* view)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDraw2DSlopeEndPoints &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordtype">double</span> x1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordtype">double</span> y1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordtype">double</span> slope1 = slope;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      x1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      y1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slope) &gt; 0.)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        slope1 = 1. / slope;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        slope1 = 1.e6;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    TMarker&amp; strt = view-&gt;AddMarker(x1, y1, color, kFullStar, 2.0);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    strt.SetMarkerColor(color); <span class="comment">// stupid line to shut up compiler warning</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">//    double stublen = 50.0 ;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordtype">double</span> stublen = 300.0;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    TLine&amp; l = view-&gt;AddLine(x1, y1, x1 + stublen, y1 + slope1 * stublen);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    l.SetLineColor(color);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    l.SetLineWidth(2);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    l.SetLineStyle(2);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a70bb6fa56f745d269079d6db5b188f2c"> 1117</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">RecoBaseDrawer::Draw2DSlopeEndPoints</a>(<span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                       <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>,</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                       <span class="keywordtype">double</span> cosx,</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                       <span class="keywordtype">double</span> cosy,</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                       <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                       evdb::View2D* view)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDraw2DSlopeEndPoints &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordtype">double</span> x1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordtype">double</span> y1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">double</span> cosx1 = cosx;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordtype">double</span> cosy1 = cosy;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fAxisOrientation &gt; 0) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      x1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      y1 = <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      cosx1 = cosy;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      cosy1 = cosx;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    TMarker&amp; strt = view-&gt;AddMarker(x1, y1, color, kFullStar, 2.0);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    strt.SetMarkerColor(color); <span class="comment">// stupid line to shut up compiler warning</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">//    double stublen = 50.0 ;</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordtype">double</span> stublen = 300.0;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    TLine&amp; l = view-&gt;AddLine(x1, y1, x1 + stublen * cosx1, y1 + stublen * cosy1);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    l.SetLineColor(color);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    l.SetLineWidth(2);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    l.SetLineStyle(2);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">//......................................................................</span><span class="comment"></span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">  /// Make a set of points which outline a cluster</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">  /// @param c      : Reco base cluster to outline</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">  /// @param wpts   : wire values of the outlines</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">  /// @param tpts   : tdc values of the outlines</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">  /// @param plane  : plane number</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aff2e3940c9e158fb7ee9c70aa3457848"> 1165</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aff2e3940c9e158fb7ee9c70aa3457848">RecoBaseDrawer::GetClusterOutlines</a>(std::vector&lt;const recob::Hit*&gt;&amp; hits,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                     std::vector&lt;double&gt;&amp; wpts,</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                     std::vector&lt;double&gt;&amp; tpts,</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">// Map wire numbers to highest and lowest in the plane</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    std::map&lt;unsigned int, double&gt; wlo, whi;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="comment">// On first pass, initialize</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; hits.size(); ++j) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">// check that we are on the correct plane and TPC</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">if</span> (hits[j]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Plane != plane || hits[j]-&gt;WireID().TPC != rawOpt-&gt;fTPC ||</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;          hits[j]-&gt;WireID().Cryostat != rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      wlo[hits[j]-&gt;WireID().Wire] = hits[j]-&gt;PeakTime();</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      whi[hits[j]-&gt;WireID().Wire] = hits[j]-&gt;PeakTime();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordtype">double</span> t = 0.;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">// Finalize on second pass</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; hits.size(); ++j) {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      t = hits[j]-&gt;PeakTime();</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">if</span> (t &lt; wlo[hits[j]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire]) wlo[hits[j]-&gt;WireID().Wire] = t;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">if</span> (t &gt; whi[hits[j]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire]) whi[hits[j]-&gt;WireID().Wire] = t;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">// Loop over wires and low times to make lines along bottom</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">// edge. Work from upstream edge to downstream edge</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    std::map&lt;unsigned int, double&gt;::iterator itr(wlo.begin());</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    std::map&lt;unsigned int, double&gt;::iterator itrEnd(wlo.end());</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">for</span> (; itr != itrEnd; ++itr) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = itr-&gt;first;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      t = itr-&gt;second;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      wpts.push_back(1. * w - 0.1);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      tpts.push_back(t - 0.1);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      wpts.push_back(1. * w + 0.1);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      tpts.push_back(t - 0.1);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// Loop over planes and high cells to make lines along top</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// edge. Work from downstream edge toward upstream edge</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    std::map&lt;unsigned int, double&gt;::reverse_iterator ritr(whi.rbegin());</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    std::map&lt;unsigned int, double&gt;::reverse_iterator ritrEnd(whi.rend());</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">for</span> (; ritr != ritrEnd; ++ritr) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = ritr-&gt;first;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      t = ritr-&gt;second;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      wpts.push_back(1. * w + 0.1);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      tpts.push_back(t + 0.1);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      wpts.push_back(1. * w - 0.1);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      tpts.push_back(t + 0.1);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">// Add link to starting point to close the box</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    wpts.push_back(wpts[0]);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    tpts.push_back(tpts[0]);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5a02fec244ed9b665033a5a1173915ee"> 1232</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5a02fec244ed9b665033a5a1173915ee">RecoBaseDrawer::DrawProng2D</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                              std::vector&lt;const recob::Hit*&gt;&amp; hits,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                              evdb::View2D* view,</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane,</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                              TVector3 <span class="keyword">const</span>&amp; startPos,</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                              TVector3 <span class="keyword">const</span>&amp; startDir,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                              <span class="keywordtype">int</span> <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                              <span class="keywordtype">float</span> cscore)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = rawOpt-&gt;fCryostat;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t = rawOpt-&gt;fTPC;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeID(c, t, plane);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localPos(startPos.X(), startPos.Y(), startPos.Z());</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">int</span> color(<a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[<span class="keywordtype">id</span> % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>]);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">int</span> lineWidth(1);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (cscore &gt; 0.1 &amp;&amp; recoOpt-&gt;fDrawCosmicTags) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      color = kRed;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (cscore &lt; 0.6) color = kMagenta;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      lineWidth = 3;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cscore &lt; -10000) { <span class="comment">//shower hits</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      lineWidth = 3;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">// first draw the hits</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">if</span> (cscore &lt; -1000) { <span class="comment">//shower</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, color, view, <span class="keyword">false</span>, <span class="keyword">false</span>, lineWidth);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">if</span> (recoOpt-&gt;fDrawShowers &gt;= 1) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="comment">//draw the shower ID at the beginning of shower</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = 30 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(startPos.X(), planeID);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(localPos, planeID);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        TText&amp; shwID = view-&gt;AddText(wire, tick, txt);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        shwID.SetTextColor(<a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[<span class="keywordtype">id</span> % evd::kNCOLS]);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        shwID.SetTextSize(0.1);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, color, view, <span class="keyword">false</span>, <span class="keyword">false</span>, lineWidth);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">double</span> tick0 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(startPos.X(), planeID);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordtype">double</span> wire0 = geo-&gt;WireCoordinate(localPos, planeID);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    localPos = <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>(startPos + startDir); <span class="comment">// Huh? what is this?</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordtype">double</span> tick1 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>((startPos + startDir).<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), planeID);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordtype">double</span> wire1 = geo-&gt;WireCoordinate(localPos, planeID);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordtype">double</span> cost = 0;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordtype">double</span> cosw = 0;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/d69/namespacelariov_1_1DataSource.html#a9877bcd384b60abd8cbe121d11f43b5b">ds</a> = sqrt(pow(tick0 - tick1, 2) + pow(wire0 - wire1, 2));</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (ds) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      cost = (tick1 - tick0) / ds;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      cosw = (wire1 - wire0) / ds;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">Draw2DSlopeEndPoints</a>(wire0, tick0, cosw, cost, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[<span class="keywordtype">id</span> % evd::kNCOLS], view);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adcc02edd92e7e037bbe545c81e9ac8db"> 1302</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adcc02edd92e7e037bbe545c81e9ac8db">RecoBaseDrawer::DrawTrack2D</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                              <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                              std::vector&lt;const recob::Hit*&gt;&amp; hits,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                              evdb::View2D* view,</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane,</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                              <span class="keyword">const</span> <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>* <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                              <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                              <span class="keywordtype">int</span> lineWidth)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = rawOpt-&gt;fCryostat;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t = rawOpt-&gt;fTPC;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// first draw the hits</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, color, view, <span class="keyword">false</span>, <span class="keyword">true</span>, lineWidth);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; startPos = track-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#af3d605dc3abfa9dfc98923bb584beb08">Vertex</a>();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; startDir = track-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#aa8edf54b2357ba4e9f19ff23a4880156">VertexDirection</a>();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// prepare to draw prongs</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0.};</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">double</span> world[3] = {0.};</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    geo-&gt;Cryostat(c).TPC(t).Plane(plane).LocalToWorld(local, world);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    world[1] = startPos.Y();</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    world[2] = startPos.Z();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// convert the starting position and direction from 3D to 2D coordinates</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(startPos.X(), plane, t, c);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordtype">double</span> wire = 0.;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      wire = 1. * geo-&gt;NearestWire(world, plane, t, c);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      wire = 1. * atoi(e.explain_self().substr(e.explain_self().find(<span class="stringliteral">&quot;#&quot;</span>) + 1, 5).c_str());</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="comment">// thetawire is the angle measured CW from +z axis to wire</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordtype">double</span> thetawire = geo-&gt;TPC(t).Plane(plane).Wire(0).ThetaZ();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordtype">double</span> wirePitch = geo-&gt;WirePitch(hits[0]-&gt;View());</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordtype">double</span> driftvelocity = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>();    <span class="comment">// cm/us</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordtype">double</span> timetick = <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1e-3; <span class="comment">// time sample in us</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">// rotate coord system CCW around x-axis by pi-thetawire</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">//   new yprime direction is perpendicular to the wire direction</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">//   in the same plane as the wires and in the direction of</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="comment">//   increasing wire number</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">//use yprime-component of dir cos in rotated coord sys to get</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">//   dTdW (number of time ticks per unit of wire pitch)</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordtype">double</span> rotang = 3.1416 - thetawire;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordtype">double</span> yprime = std::cos(rotang) * startDir.Y() + std::sin(rotang) * startDir.Z();</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordtype">double</span> dTdW = startDir.X() * wirePitch / driftvelocity / timetick / yprime;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">Draw2DSlopeEndPoints</a>(wire, tick, dTdW, color, view);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">// Draw a line to the hit positions, starting from the vertex</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">size_t</span> nTrackHits = track-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a9128436d1a2465fc9f5393898b6fa236">NumberTrajectoryPoints</a>();</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">//TPolyLine&amp; pl         = view-&gt;AddPolyLine(track-&gt;CountValidPoints(),1,1,0); //kColor[id%evd::kNCOLS],1,0);</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    TPolyLine&amp; pl = view-&gt;AddPolyLine(0, 1, 1, 0); <span class="comment">//kColor[id%evd::kNCOLS],1,0);</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordtype">size_t</span> vidx = 0;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; nTrackHits; idx++) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">if</span> (track-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">HasValidPoint</a>(idx) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; hitPos = track-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(idx);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="comment">// Use &quot;world&quot; from above</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      world[1] = hitPos.Y();</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      world[2] = hitPos.Z();</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="comment">// convert the starting position and direction from 3D to 2D coordinates</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordtype">double</span> tickHit = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(hitPos.X(), plane, t, c);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordtype">double</span> wireHit = 0.;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        wireHit = 1. * geo-&gt;NearestWire(world, plane, t, c);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">catch</span> (cet::exception&amp; e) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        wireHit = 1. * atoi(e.explain_self().substr(e.explain_self().find(<span class="stringliteral">&quot;#&quot;</span>) + 1, 5).c_str());</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> tpc = geo-&gt;FindTPCAtPosition(hitPos).TPC;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> cryo = geo-&gt;FindCryostatAtPosition(hitPos);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">if</span> (tpc == t &amp;&amp; cryo == c) { pl.SetPoint(vidx++, wireHit, tickHit); }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">//pl.SetPolyLine(vidx);</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a500d95aebfe430b6826e14b6a5733e1f"> 1391</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a500d95aebfe430b6826e14b6a5733e1f">RecoBaseDrawer::Prong2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                          <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                          <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                          evdb::View2D* view,</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> gview = geo-&gt;TPC(rawOpt-&gt;fTPC).Plane(plane).View();</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">// annoying for now, but have to have multiple copies of basically the</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// same code to draw prongs, showers and tracks so that we can use</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// the art::Assns to get the hits and clusters.</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = rawOpt-&gt;fCryostat;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = rawOpt-&gt;fTPC;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeID(cstat, tpc, plane);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordtype">int</span> tid = 0;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTracks != 0) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fTrackLabels.size(); ++imod) {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fTrackLabels[imod];</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        art::View&lt;recob::Track&gt; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">GetTracks</a>(evt, which, track);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">if</span> (track.vals().size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        art::FindMany&lt;recob::Hit&gt; fmh(track, evt, which);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        art::InputTag <span class="keyword">const</span> whichTag(</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          recoOpt-&gt;fCosmicTagLabels.size() &gt; imod ? recoOpt-&gt;fCosmicTagLabels[imod] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        art::FindManyP&lt;anab::CosmicTag&gt; cosmicTrackTags(track, evt, whichTag);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keyword">auto</span> tracksProxy = proxy::getCollection&lt;proxy::Tracks&gt;(<a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, which);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="comment">// loop over the prongs and get the clusters and hits associated with</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="comment">// them.  only keep those that are in this view</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; track.vals().size(); ++t) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="comment">// Check for possible issue</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;          <span class="keywordflow">if</span> (track.vals().at(t)-&gt;NumberTrajectoryPoints() == 0) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;***** Track with no trajectory points ********&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;          }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTracks &gt; 1) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="comment">// BB: draw the track ID at the end of the track</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> trackPos(track.vals().at(t)-&gt;End().X(),</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                  track.vals().at(t)-&gt;End().Y(),</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                  track.vals().at(t)-&gt;End().Z());</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = 30 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(trackPos.X(), plane, tpc, cstat);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(trackPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a>(cstat, tpc, plane));</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            tid =</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;              track.vals().at(t)-&gt;ID() &amp;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;              65535; <span class="comment">//this is a hack for PMA track id which uses the 16th bit to identify shower-like track.;</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(tid);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            TText&amp; trkID = view-&gt;AddText(wire, tick, txt);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            trkID.SetTextColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[tid % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>]);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            trkID.SetTextSize(0.1);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          <span class="keywordtype">float</span> Score = -999;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          <span class="keywordflow">if</span> (cosmicTrackTags.isValid()) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="keywordflow">if</span> (cosmicTrackTags.at(t).size() &gt; 0) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;              art::Ptr&lt;anab::CosmicTag&gt; currentTag = cosmicTrackTags.at(t).at(0);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;              Score = currentTag-&gt;CosmicScore();</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;          std::vector&lt;const recob::Hit*&gt; hits;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;          <span class="keywordflow">if</span> (track.vals().at(t)-&gt;NumberTrajectoryPoints() == fmh.at(t).size()) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <span class="keyword">auto</span> tp = tracksProxy[t];</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> point : tp.points()) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;              <span class="keywordflow">if</span> (!point.isPointValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;              hits.push_back(point.hit());</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            hits = fmh.at(t);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="comment">// only get the hits for the current view</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          std::vector&lt;const recob::Hit*&gt;::iterator itr = hits.begin();</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          <span class="keywordflow">while</span> (itr &lt; hits.end()) {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordflow">if</span> ((*itr)-&gt;View() != gview)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;              hits.erase(itr);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;              itr++;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>* aTrack(track.vals().at(t));</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <span class="keywordtype">int</span> color(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[(aTrack-&gt;ID() &amp; 65535) % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>]);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keywordtype">int</span> lineWidth(1);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          <span class="keywordflow">if</span> (Score &gt; 0.1 &amp;&amp; recoOpt-&gt;fDrawCosmicTags) {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            color = kRed;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="keywordflow">if</span> (Score &lt; 0.6) color = kMagenta;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            lineWidth = 3;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Score &lt; -10000) { <span class="comment">//shower hits</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            lineWidth = 3;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;          }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adcc02edd92e7e037bbe545c81e9ac8db">DrawTrack2D</a>(clockData, detProp, hits, view, plane, aTrack, color, lineWidth);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        } <span class="comment">// end loop over prongs</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      }   <span class="comment">// end loop over labels</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }     <span class="comment">// end draw tracks</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawShowers != 0) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;DrawShower options: \n&quot;</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; 1 = Hits in shower color-coded by the shower ID\n&quot;</span>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot; 2 = Same as 1 + shower axis and circle representing the shower cone\n&quot;</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;     Black cone = shower start dE/dx &lt; 1 MeV/cm (&lt; 1/2 MIP)\n&quot;</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;     Blue cone = shower start dE/dx &lt; 3 MeV/cm (~1 MIP)\n&quot;</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;     Green cone = shower start 3 MeV/cm &lt; dE/dx &lt; 5 MeV/cm (~2 MIP)\n&quot;</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;     Red cone = shower start 5 MeV/cm &lt; dE/dx (&gt;2 MIP)\n&quot;</span>;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fShowerLabels.size(); ++imod) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fShowerLabels[imod];</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        art::View&lt;recob::Shower&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4">GetShowers</a>(evt, which, shower);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keywordflow">if</span> (shower.vals().size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        art::FindMany&lt;recob::Hit&gt; fmh(shower, evt, which);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">// loop over the prongs and get the clusters and hits associated with</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// them.  only keep those that are in this view</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; shower.vals().size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          std::vector&lt;const recob::Hit*&gt; hits = fmh.at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          <span class="comment">// only get the hits for the current view</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          std::vector&lt;const recob::Hit*&gt;::iterator itr = hits.begin();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          <span class="keywordflow">while</span> (itr &lt; hits.end()) {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">if</span> ((*itr)-&gt;View() != gview)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;              hits.erase(itr);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;              itr++;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fDrawShowers &gt; 1) {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="comment">// BB draw a line between the start and end points and a &quot;circle&quot; that represents</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="comment">// the shower cone angle at the end point</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="keywordflow">if</span> (!shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;has_length()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="keywordflow">if</span> (!shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;has_open_angle()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            TVector3 startPos = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;ShowerStart();</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;Direction();</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="keywordtype">double</span> length = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;Length();</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="keywordtype">double</span> openAngle = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;OpenAngle();</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="comment">// Find the center of the cone base</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            TVector3 endPos = startPos + length * <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localStart(startPos);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localEnd(endPos);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keywordtype">double</span> swire = geo-&gt;WireCoordinate(localStart, planeID);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <span class="keywordtype">double</span> stick = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(startPos.X(), planeID);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            <span class="keywordtype">double</span> ewire = geo-&gt;WireCoordinate(localEnd, planeID);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordtype">double</span> etick = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(endPos.X(), planeID);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            TLine&amp; coneLine = view-&gt;AddLine(swire, stick, ewire, etick);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="comment">// color coding by dE/dx</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            std::vector&lt;double&gt; dedxVec = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;dEdx();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <span class="comment">//                      float dEdx = shower.vals().at(s)-&gt;dEdx()[plane];</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            <span class="comment">// use black for too-low dE/dx</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            <span class="keywordtype">int</span> color = kBlack;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="keywordflow">if</span> (plane &lt; dedxVec.size()) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;              <span class="keywordflow">if</span> (dedxVec[plane] &gt; 1 &amp;&amp; dedxVec[plane] &lt; 3) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                <span class="comment">// use blue for ~1 MIP</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                color = kBlue;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;              }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dedxVec[plane] &lt; 5) {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                <span class="comment">// use green for ~2 MIP</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                color = kGreen;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;              }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                <span class="comment">// use red for &gt;~ 2 MIP</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                color = kRed;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;              }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            coneLine.SetLineColor(color);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            <span class="comment">// Now find the 3D circle that represents the base of the cone</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            <span class="keywordtype">double</span> radius = length * openAngle;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <span class="keyword">auto</span> coneRim = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad570ecf8ccef879c571c16c54a429fa4">Circle3D</a>(endPos, dir, radius);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            TPolyLine&amp; pline = view-&gt;AddPolyLine(coneRim.size(), color, 2, 0);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <span class="comment">// project these points into the plane</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipt = 0; ipt &lt; coneRim.size(); ++ipt) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;              <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localPos(coneRim[ipt][0], coneRim[ipt][1], coneRim[ipt][2]);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;              <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(localPos, planeID);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(coneRim[ipt][0], planeID);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;              pline.SetPoint(ipt, wire, tick);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            } <span class="comment">// ipt</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;          this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5a02fec244ed9b665033a5a1173915ee">DrawProng2D</a>(detProp,</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                            hits,</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                            view,</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                            plane,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                            shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;ShowerStart(),</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                            shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)-&gt;Direction(),</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                            <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>,</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                            -10001); <span class="comment">//use -10001 to increase shower hit size</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        } <span class="comment">// end loop over prongs</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      }   <span class="comment">// end loop over labels</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }     <span class="comment">// end draw showers</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a69c8ed84c3f7b0f98a004c55891a3be5"> 1612</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a69c8ed84c3f7b0f98a004c55891a3be5">RecoBaseDrawer::DrawTrackVertexAssns2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                         <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                         <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                         evdb::View2D* view,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">if</span> (!recoOpt-&gt;fDrawTrackVertexAssns) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> gview = geo-&gt;TPC(rawOpt-&gt;fTPC).Plane(plane).View();</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// annoying for now, but have to have multiple copies of basically the</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// same code to draw prongs, showers and tracks so that we can use</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">// the art::Assns to get the hits and clusters.</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = rawOpt-&gt;fCryostat;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = rawOpt-&gt;fTPC;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> planeID(cstat, tpc, plane);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordtype">int</span> tid = 0;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fTrkVtxTrackLabels.size(); ++imod) {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fTrkVtxTrackLabels[imod];</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      art::View&lt;recob::Track&gt; trackCol;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">GetTracks</a>(evt, which, trackCol);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordflow">if</span> (trackCol.vals().size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="comment">// Recover associations output from the filter</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      std::unique_ptr&lt;art::Assns&lt;recob::Vertex, recob::Track&gt;&gt; vertexTrackAssociations(</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keyword">new</span> art::Assns&lt;recob::Vertex, recob::Track&gt;);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="comment">// Recover a handle to the collection of associations between vertices and tracks</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="comment">// This is a bit non-standard way to do this but trying to avoid complications</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      art::Handle&lt;art::Assns&lt;recob::Vertex, recob::Track&gt;&gt; vertexTrackAssnsHandle;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      evt.getByLabel(recoOpt-&gt;fTrkVtxFilterLabels[imod], vertexTrackAssnsHandle);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keywordflow">if</span> (vertexTrackAssnsHandle-&gt;size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="comment">// Get the rest of the associations in the standard way</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      art::FindMany&lt;recob::Hit&gt; fmh(trackCol, evt, which);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      art::FindManyP&lt;anab::CosmicTag&gt; cosmicTrackTags(</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        trackCol, evt, recoOpt-&gt;fTrkVtxCosmicLabels[imod]);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keyword">auto</span> tracksProxy = proxy::getCollection&lt;proxy::Tracks&gt;(<a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, which);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="comment">// Need to keep track of vertices unfortunately</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keywordtype">int</span> lastVtxIdx(-1);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keywordtype">int</span> color(kRed);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;==&gt; Neutrino Candidate drawing for tagger &quot;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                &lt;&lt; recoOpt-&gt;fTrkVtxFilterLabels[imod] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="comment">// Now we can iterate over the vertex/track associations and do some drawing</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; vertexTrackAssn : *vertexTrackAssnsHandle) {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <span class="comment">// Start by drawing the vertex</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        art::Ptr&lt;recob::Vertex&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a> = vertexTrackAssn.first;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordflow">if</span> (vertex-&gt;ID() != lastVtxIdx) {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;          <span class="comment">// BB: draw polymarker at the vertex position in this plane</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;          <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;          vertex-&gt;XYZ(xyz);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;          <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localXYZ(xyz[0], xyz[1], xyz[2]);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(localXYZ, planeID);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          <span class="keywordtype">double</span> time = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(xyz[0], planeID);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          TMarker&amp; strt = view-&gt;AddMarker(wire, time, color, 24, 3.0);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;          strt.SetMarkerColor(color);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;    --&gt; Drawing vertex id: &quot;</span> &lt;&lt; vertex-&gt;ID() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        lastVtxIdx = vertex-&gt;ID();</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keyword">const</span> art::Ptr&lt;recob::Track&gt;&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a> = vertexTrackAssn.second;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="comment">// BB: draw the track ID at the end of the track</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = track-&gt;End().X();</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> trackEnd(track-&gt;End());</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = 30 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(x, planeID);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordtype">double</span> wire = geo-&gt;WireCoordinate(trackEnd, planeID);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        tid = track-&gt;ID() &amp; 65535;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;        --&gt; Drawing Track id: &quot;</span> &lt;&lt; tid &lt;&lt; std::endl;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(tid);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        TText&amp; trkID = view-&gt;AddText(wire, tick, txt);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        trkID.SetTextColor(color);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        trkID.SetTextSize(0.1);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordtype">float</span> cosmicScore = -999;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keywordflow">if</span> (cosmicTrackTags.isValid()) {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          <span class="keywordflow">if</span> (cosmicTrackTags.at(track.key()).<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; 0) {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            art::Ptr&lt;anab::CosmicTag&gt; currentTag = cosmicTrackTags.at(track.key()).at(0);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            cosmicScore = currentTag-&gt;CosmicScore();</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;          }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        std::vector&lt;const recob::Hit*&gt; hits;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">if</span> (track-&gt;NumberTrajectoryPoints() == fmh.at(track.key()).<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;          <span class="keyword">auto</span> tp = tracksProxy[track.key()];</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> point : tp.points()) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <span class="keywordflow">if</span> (!point.isPointValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            hits.push_back(point.hit());</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;          }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;          hits = fmh.at(track.key());</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="comment">// only get the hits for the current view</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        std::vector&lt;const recob::Hit*&gt;::iterator itr = hits.begin();</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="keywordflow">while</span> (itr &lt; hits.end()) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          <span class="keywordflow">if</span> ((*itr)-&gt;View() != gview)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            hits.erase(itr);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            itr++;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordtype">int</span> lineWidth(1);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <span class="keywordflow">if</span> (cosmicScore &gt; 0.1) {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;          color = kRed;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          <span class="keywordflow">if</span> (cosmicScore &lt; 0.6) color = kMagenta;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          lineWidth = 3;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cosmicScore &lt; -10000) { <span class="comment">//shower hits</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          lineWidth = 3;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adcc02edd92e7e037bbe545c81e9ac8db">DrawTrack2D</a>(clockData, detProp, hits, view, plane, track.get(), color, lineWidth);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      } <span class="comment">// end loop over vertex/track associations</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    } <span class="comment">// end loop over labels</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8509b4e0dd59d79aedd6cd4ec88c7552"> 1761</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8509b4e0dd59d79aedd6cd4ec88c7552">RecoBaseDrawer::Vertex2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                           <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                           evdb::View2D* view,</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawVertices == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;******** DrawVertices: Open circles color coded across all planes. Set &quot;</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                   <span class="stringliteral">&quot;DrawVertices &gt; 1 to display the vertex ID\n&quot;</span>;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fVertexLabels.size(); ++imod) {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fVertexLabels[imod];</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      art::PtrVector&lt;recob::Vertex&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e">GetVertices</a>(evt, which, vertex);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="keywordflow">if</span> (vertex.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordtype">double</span> world[3] = {0., 0., 0.};</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; tpc = geo-&gt;TPC(rawOpt-&gt;fTPC);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      tpc.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(local, world);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keywordtype">double</span> minxyz[3], maxxyz[3];</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      minxyz[0] = world[0] - geo-&gt;DetHalfWidth(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      maxxyz[0] = world[0] + geo-&gt;DetHalfWidth(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      minxyz[1] = world[1] - geo-&gt;DetHalfWidth(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      maxxyz[1] = world[1] + geo-&gt;DetHalfWidth(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      minxyz[2] = world[2] - geo-&gt;DetLength(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat) / 2;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      maxxyz[2] = world[2] + geo-&gt;DetLength(rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat) / 2;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> v = 0; v &lt; vertex.size(); ++v) {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <span class="comment">// ensure the vertex is inside the current tpc</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        vertex[v]-&gt;XYZ(xyz);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="keywordflow">if</span> (xyz[0] &lt; minxyz[0] || xyz[0] &gt; maxxyz[0]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">if</span> (xyz[1] &lt; minxyz[1] || xyz[1] &gt; maxxyz[1]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">if</span> (xyz[2] &lt; minxyz[2] || xyz[2] &gt; maxxyz[2]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> localPos(xyz[0], xyz[1], xyz[2]);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="comment">// BB: draw polymarker at the vertex position in this plane</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="keywordtype">double</span> wire =</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;          geo-&gt;WireCoordinate(localPos, <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a>(rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, plane));</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="keywordtype">double</span> time = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(xyz[0], plane, rawOpt-&gt;fTPC, rawOpt-&gt;fCryostat);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[vertex[v]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(wire, time, color, 24, 1.0);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="comment">// BB: draw the vertex ID</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordflow">if</span> (recoOpt-&gt;fDrawVertices &gt; 1) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <span class="stringliteral">&quot;3V&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(vertex[v]-&gt;ID());</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;          TText&amp; vtxID = view-&gt;AddText(wire, time + 30, txt);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;          vtxID.SetTextColor(color);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;          vtxID.SetTextSize(0.05);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      } <span class="comment">// end loop over vertices to draw from this label</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }   <span class="comment">// end loop over vertex module lables</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a618cb12da47a4ef4371a8c5f4a8a9407"> 1835</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a618cb12da47a4ef4371a8c5f4a8a9407">RecoBaseDrawer::Event2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View2D* view, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawEvents != 0) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a> gview = geo-&gt;TPC(rawOpt-&gt;fTPC).Plane(plane).View();</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> imod = 0; imod &lt; recoOpt-&gt;fEventLabels.size(); ++imod) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fEventLabels[imod];</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        art::PtrVector&lt;recob::Event&gt; event;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab80f3650b8b09d1583b9f79f052e5f3f">GetEvents</a>(evt, which, event);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordflow">if</span> (event.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        art::FindMany&lt;recob::Hit&gt; fmh(event, evt, which);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a> = 0; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a> &lt; <span class="keyword">event</span>.size(); ++<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;          std::vector&lt;const recob::Hit*&gt; hits;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;          hits = fmh.at(<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;          <span class="comment">// only get the hits for the current view</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;          std::vector&lt;const recob::Hit*&gt;::iterator itr = hits.begin();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;          <span class="keywordflow">while</span> (itr &lt; hits.end()) {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            <span class="keywordflow">if</span> ((*itr)-&gt;View() != gview)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;              hits.erase(itr);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;              itr++;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;          }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;          this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">Hit2D</a>(hits, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[event[<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>], view, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        } <span class="comment">// end loop over events</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      }   <span class="comment">// end loop over event module lables</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    }     <span class="comment">// end if we are drawing events</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a33ba464fcae581883d1bd08e1c6e66ca"> 1880</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a33ba464fcae581883d1bd08e1c6e66ca">RecoBaseDrawer::Seed3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    std::vector&lt;art::InputTag&gt; <a class="code" href="../../d9/d76/build-larbase-py2_8sh.html#af6b3895e39ae33d4633d338ed2ddf9e3">labels</a>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSeeds != 0)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSeedLabels.size(); ++imod)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        labels.push_back(recoOpt-&gt;fSeedLabels[imod]);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; labels.size(); ++imod) {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      art::InputTag <span class="keyword">const</span> which = labels[imod];</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      art::PtrVector&lt;recob::Seed&gt; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0">GetSeeds</a>(evt, which, seeds);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordtype">int</span> color = 0;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordflow">if</span> (seeds.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      TPolyMarker3D&amp; pmrk = view-&gt;AddPolyMarker3D(seeds.size(), color, 4, 1);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iseed = 0; iseed != seeds.size(); ++iseed) {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordtype">double</span> pt[3], pterr[3], <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>[3], direrr[3];</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        seeds.at(iseed)-&gt;GetPoint(pt, pterr);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        seeds.at(iseed)-&gt;GetDirection(dir, direrr);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordtype">double</span> end1[3], end2[3];</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 3; ++i) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          end1[i] = pt[i] + dir[i];</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;          end2[i] = pt[i] - dir[i];</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        TPolyLine3D&amp; pline = view-&gt;AddPolyLine3D(2, color, 2, 0);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        pmrk.SetPoint(iseed, pt[0], pt[1], pt[2]);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        pline.SetPoint(0, end1[0], end1[1], end1[2]);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        pline.SetPoint(1, end2[0], end2[1], end2[2]);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      } <span class="comment">// end loop over seeds</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    }   <span class="comment">// end loop over module labels</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab323b58143fff95be3e1572324e182c2"> 1926</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab323b58143fff95be3e1572324e182c2">RecoBaseDrawer::SeedOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj, evdb::View2D* view)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    std::vector&lt;art::InputTag&gt; <a class="code" href="../../d9/d76/build-larbase-py2_8sh.html#af6b3895e39ae33d4633d338ed2ddf9e3">labels</a>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSeeds != 0)</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSeedLabels.size(); ++imod)</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        labels.push_back(recoOpt-&gt;fSeedLabels[imod]);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; labels.size(); ++imod) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      art::InputTag <span class="keyword">const</span> which = labels[imod];</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      art::PtrVector&lt;recob::Seed&gt; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0">GetSeeds</a>(evt, which, seeds);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <span class="keywordtype">int</span> color = 0;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iseed = 0; iseed != seeds.size(); ++iseed) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="keywordtype">double</span> pt[3], pterr[3], <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>[3], direrr[3];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        seeds.at(iseed)-&gt;GetPoint(pt, pterr);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        seeds.at(iseed)-&gt;GetDirection(dir, direrr);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="keywordtype">double</span> end1[3], end2[3];</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 3; ++i) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;          end1[i] = pt[i] + dir[i];</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;          end2[i] = pt[i] - dir[i];</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;          TMarker&amp; strt = view-&gt;AddMarker(pt[1], pt[0], color, 4, 1.5);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          TLine&amp; line = view-&gt;AddLine(end1[1], end1[0], end2[1], end2[0]);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;          strt.SetMarkerColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;          line.SetLineColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;          line.SetLineWidth(2.0);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        }</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;          TMarker&amp; strt = view-&gt;AddMarker(pt[2], pt[0], color, 4, 1.5);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          TLine&amp; line = view-&gt;AddLine(end1[2], end1[0], end2[2], end2[0]);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          strt.SetMarkerColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          line.SetLineColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;          line.SetLineWidth(2.0);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;          <span class="keywordflow">if</span> (proj != <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;RecoBaseDrawer:SeedOrtho&quot;</span>)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;projection is not YZ as expected\n&quot;</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;          TMarker&amp; strt = view-&gt;AddMarker(pt[2], pt[1], color, 4, 1.5);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;          TLine&amp; line = view-&gt;AddLine(end1[2], end1[1], end2[2], end2[1]);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          strt.SetMarkerColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;          line.SetLineColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color]);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;          line.SetLineWidth(2.0);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a39914e49813de128adf2932d191a6712"> 1986</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a39914e49813de128adf2932d191a6712">RecoBaseDrawer::SpacePoint3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    std::vector&lt;art::InputTag&gt; <a class="code" href="../../d9/d76/build-larbase-py2_8sh.html#af6b3895e39ae33d4633d338ed2ddf9e3">labels</a>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSpacePoints != 0) {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSpacePointLabels.size(); ++imod)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        labels.push_back(recoOpt-&gt;fSpacePointLabels[imod]);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; labels.size(); ++imod) {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      art::InputTag <span class="keyword">const</span> which = labels[imod];</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, which, spts);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keywordtype">int</span> color = 10 * imod + 11;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      color = 0;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="comment">//        std::vector&lt;const recob::SpacePoint*&gt; sptsVec;</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="comment">//        sptsVec.resize(spts.size());</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <span class="comment">//        for(const auto&amp; spt : spts){</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <span class="comment">//          std::cout&lt;&lt;spt&lt;&lt;&quot; &quot;&lt;&lt;*spt&lt;&lt;&quot; &quot;&lt;&lt;&amp;*spt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="comment">//          sptsVec.push_back(&amp;*spt);</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="comment">//          std::cout&lt;&lt;sptsVec.back()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="comment">//        }</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a82a23a008fc0616b5f8b3c6d685d4558">fAllSpacePointDrawer</a>-&gt;Draw(spts, view, color, kFullDotMedium, 1);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adc22b92b0c39376fe4e9a9afe412d189"> 2024</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adc22b92b0c39376fe4e9a9afe412d189">RecoBaseDrawer::PFParticle3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawPFParticles &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// The plan is to loop over the list of possible particles</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fPFParticleLabels.size(); ++imod) {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fPFParticleLabels[imod];</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      art::InputTag <span class="keyword">const</span> assns = recoOpt-&gt;fSpacePointLabels[imod];</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="comment">// Start off by recovering our 3D Clusters for this label</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      art::PtrVector&lt;recob::PFParticle&gt; pfParticleVec;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa33c29aecd1e81defa8d5c729d4da9c5">GetPFParticles</a>(evt, which, pfParticleVec);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;RecoBaseDrawer: number PFParticles to draw: &quot;</span> &lt;&lt; pfParticleVec.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="comment">// Make sure we have some clusters</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">if</span> (pfParticleVec.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="comment">// Get the space points created by the PFParticle producer</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spacePointVec;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, assns, spacePointVec);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="comment">// Recover the edges</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      std::vector&lt;art::Ptr&lt;recob::Edge&gt;&gt; edgeVec;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="keywordflow">if</span> (recoOpt-&gt;fDrawEdges) this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acd4bc8ec002beecf2f843077df96b70f">GetEdges</a>(evt, assns, edgeVec);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="comment">// No space points no continue</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="keywordflow">if</span> (spacePointVec.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="comment">// Add the relations to recover associations cluster hits</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      art::FindManyP&lt;recob::SpacePoint&gt; edgeSpacePointAssnsVec(edgeVec, evt, assns);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      art::FindManyP&lt;recob::SpacePoint&gt; spacePointAssnVec(pfParticleVec, evt, assns);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      art::FindManyP&lt;recob::Hit&gt; spHitAssnVec(spacePointVec, evt, assns);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      art::FindManyP&lt;recob::Edge&gt; edgeAssnsVec(pfParticleVec, evt, assns);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="comment">// If no valid space point associations then nothing to do</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordflow">if</span> (!spacePointAssnVec.isValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="comment">// Need the PCA info as well</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      art::FindMany&lt;recob::PCAxis&gt; pcAxisAssnVec(pfParticleVec, evt, which);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="comment">// Want CR tagging info</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="comment">// Note the cosmic tags come from a different producer - we assume that the producers are</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="comment">// matched in the fcl label vectors!</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      art::InputTag cosmicTagLabel =</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        imod &lt; recoOpt-&gt;fCosmicTagLabels.size() ? recoOpt-&gt;fCosmicTagLabels[imod] : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      art::FindMany&lt;anab::CosmicTag&gt; pfCosmicAssns(pfParticleVec, evt, cosmicTagLabel);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <span class="comment">// We also want to drive display of tracks but have the same issue with production... so follow the</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      <span class="comment">// same prescription.</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      art::InputTag trackTagLabel =</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        imod &lt; recoOpt-&gt;fTrackLabels.size() ? recoOpt-&gt;fTrackLabels[imod] : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      art::FindMany&lt;recob::Track&gt; pfTrackAssns(pfParticleVec, evt, trackTagLabel);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="comment">// Commence looping over possible clusters</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; pfParticleVec.size(); idx++) {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="comment">// Recover cluster</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt; pfParticle(pfParticleVec.at(idx));</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="comment">// Drawing will be done recursively down the chain of hieirarchy... so we want to begin</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="comment">// with only &quot;primary&quot; particles, if we find one that isn&#39;t then we skip</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="keywordflow">if</span> (!pfParticle-&gt;IsPrimary()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <span class="comment">// Call the recursive drawing routine</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2003879d584c11e1ef8d5189caba068">DrawPFParticle3D</a>(pfParticle,</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                         pfParticleVec,</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                         spacePointVec,</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                         edgeAssnsVec,</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                         spacePointAssnVec,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                         edgeSpacePointAssnsVec,</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                         spHitAssnVec,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                         pfTrackAssns,</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                         pcAxisAssnVec,</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                         pfCosmicAssns,</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                         0,</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                         view);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    }</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="keywordtype">float</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8d3d943de6e7a164ef2606026e1e7d56"> 2112</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8d3d943de6e7a164ef2606026e1e7d56">RecoBaseDrawer::SpacePointChiSq</a>(<span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; hitVec)<span class="keyword"> const</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordtype">float</span> hitChiSq(0.);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordtype">bool</span> usePlane[] = {<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>};</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordtype">float</span> peakTimeVec[] = {0., 0., 0.};</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="keywordtype">float</span> peakSigmaVec[] = {0., 0., 0.};</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordtype">float</span> aveSum(0.);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordtype">float</span> weightSum(0.);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="comment">// Temp ad hoc correction to investigate...</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    std::map&lt;size_t, double&gt; planeOffsetMap;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    planeOffsetMap[0] = 0.;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    planeOffsetMap[1] = 4.;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    planeOffsetMap[2] = 8.;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : hitVec) {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <span class="keywordtype">float</span> peakTime = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;PeakTime() - planeOffsetMap[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Plane];</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="keywordtype">float</span> peakRMS = <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;RMS();</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      aveSum += peakTime / (peakRMS * peakRMS);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      weightSum += 1. / (peakRMS * peakRMS);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      peakTimeVec[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Plane] = peakTime;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      peakSigmaVec[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Plane] = peakRMS;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      usePlane[<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;WireID().Plane] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    }</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    aveSum /= weightSum;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; 3; idx++) {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      <span class="keywordflow">if</span> (usePlane[idx]) {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="keywordtype">float</span> deltaTime = peakTimeVec[idx] - aveSum;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        <span class="keywordtype">float</span> sigmaPeakTimeSq = peakSigmaVec[idx] * peakSigmaVec[idx];</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        hitChiSq += deltaTime * deltaTime / sigmaPeakTimeSq;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">return</span> hitChiSq;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2003879d584c11e1ef8d5189caba068"> 2158</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2003879d584c11e1ef8d5189caba068">RecoBaseDrawer::DrawPFParticle3D</a>(<span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt;&amp; pfPart,</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                   <span class="keyword">const</span> art::PtrVector&lt;recob::PFParticle&gt;&amp; pfParticleVec,</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; spacePointVec,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                   <span class="keyword">const</span> art::FindManyP&lt;recob::Edge&gt;&amp; edgeAssnsVec,</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                                   <span class="keyword">const</span> art::FindManyP&lt;recob::SpacePoint&gt;&amp; spacePointAssnVec,</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                                   <span class="keyword">const</span> art::FindManyP&lt;recob::SpacePoint&gt;&amp; edgeSPAssnVec,</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                                   <span class="keyword">const</span> art::FindManyP&lt;recob::Hit&gt;&amp; spHitAssnVec,</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                   <span class="keyword">const</span> art::FindMany&lt;recob::Track&gt;&amp; trackAssnVec,</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                                   <span class="keyword">const</span> art::FindMany&lt;recob::PCAxis&gt;&amp; pcAxisAssnVec,</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                                   <span class="keyword">const</span> art::FindMany&lt;anab::CosmicTag&gt;&amp; cosmicTagAssnVec,</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                                   <span class="keywordtype">int</span> depth,</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                   evdb::View3D* view)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    art::ServiceHandle&lt;evd::ColorDrawingOptions const&gt; cst;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">// First let&#39;s draw the hits associated to this cluster</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keyword">const</span> std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; hitsVec(spacePointAssnVec.at(pfPart.key()));</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// Use the particle ID to determine the color to draw the points</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">// Ok, this is what we would like to do eventually but currently all particles are the same...</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordtype">bool</span> isCosmic(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordtype">int</span> colorIdx(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[pfPart-&gt;Self() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>]);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// Recover cosmic tag info if any</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="keywordflow">if</span> (cosmicTagAssnVec.isValid() &amp;&amp; recoOpt-&gt;fDrawPFParticles &gt; 3) {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      std::vector&lt;const anab::CosmicTag*&gt; pfCosmicTagVec = cosmicTagAssnVec.at(pfPart.key());</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <span class="keywordflow">if</span> (!pfCosmicTagVec.empty()) {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d1/d0e/classanab_1_1CosmicTag.html">anab::CosmicTag</a>* cosmicTag = pfCosmicTagVec.front();</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">if</span> (cosmicTag-&gt;<a class="code" href="../../d1/d0e/classanab_1_1CosmicTag.html#a2093a8d7c5b81f6c92ae72bcbeb209e3">CosmicScore</a>() &gt; 0.6) isCosmic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      }</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">// Reset color index if a cosmic</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">if</span> (isCosmic) colorIdx = 12;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">if</span> (!hitsVec.empty() &amp;&amp; recoOpt-&gt;fDraw3DSpacePoints)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">fSpacePointDrawer</a>-&gt;Draw(hitsVec, view, 1, kFullDotLarge, 0.25, &amp;spHitAssnVec);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">        using HitPosition = std::array&lt;double,6&gt;;</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">        std::map&lt;int,std::vector&lt;HitPosition&gt;&gt; colorToHitMap;</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">        float minHitChiSquare(0.);</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">        float maxHitChiSquare(2.);</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">        float hitChiSqScale((cst-&gt;fRecoQHigh[geo::kCollection] - cst-&gt;fRecoQLow[geo::kCollection]) / (maxHitChiSquare - minHitChiSquare));</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">        for(const auto&amp; spacePoint : hitsVec)</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">            const double* pos = spacePoint-&gt;XYZ();</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">            const double* err = spacePoint-&gt;ErrXYZ();</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">            bool  storeHit(false);</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">            int   chargeColorIdx(0);</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">            float spacePointChiSq(spacePoint-&gt;Chisq());</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">            if (recoOpt-&gt;fDraw3DSpacePointHeatMap)</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="comment">                storeHit = true;</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">                float hitChiSq = std::max(minHitChiSquare, std::min(maxHitChiSquare, spacePointChiSq));</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">                float chgFactor = cst-&gt;fRecoQHigh[geo::kCollection] - hitChiSqScale * hitChiSq;</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">                //float chgFactor = delTScaleFctr * hitChiSq + cst-&gt;fRecoQLow[geo::kCollection];</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">                chargeColorIdx = cst-&gt;CalQ(geo::kCollection).GetColor(chgFactor);</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment">            else</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">                if (spacePointChiSq &gt; 0. &amp;&amp; !recoOpt-&gt;fSkeletonOnly)         // All cluster hits which are unmarked</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">                    storeHit = true;</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">                else if (spacePointChiSq &gt; -2.)                              // Skeleton hits</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">                    chargeColorIdx = 5;</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">                    storeHit = true;</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">                else if (spacePointChiSq &gt; -3.)                              // Pure edge hits</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">                    if (chargeColorIdx &lt; 0) chargeColorIdx = !isCosmic ? 3 : colorIdx + 3;</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">                    storeHit = true;</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">                else if (spacePointChiSq &gt; -4.)                              // Skeleton hits which are also edge hits</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">                    if (chargeColorIdx &lt; 0) chargeColorIdx = !isCosmic ? 0 : colorIdx + 3;</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">                    storeHit = true;</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">                else if (spacePoint-&gt;Chisq() &gt; -5.)                             // Hits which form seeds for tracks</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">                    if (chargeColorIdx &lt; 0) chargeColorIdx = !isCosmic ? 5 : colorIdx + 3;</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">                    storeHit = true;</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">                else if (!recoOpt-&gt;fSkeletonOnly)                                // hits made from pairs</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">                    chargeColorIdx = 15;</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">                    storeHit       = true;</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">                if (chargeColorIdx &lt; 0) chargeColorIdx = 0;</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">            if (storeHit) colorToHitMap[chargeColorIdx].push_back(HitPosition()={{pos[0],pos[1],pos[2],err[3],err[3],err[5]}});</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">        size_t nHitsDrawn(0);</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">        for(auto&amp; hitPair : colorToHitMap)</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">            //TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(hitPair.second.size(), hitPair.first, kFullDotMedium, 3);</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">            TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(hitPair.second.size(), hitPair.first, kFullDotLarge, 0.25); //kFullDotLarge, 0.3);</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">            for (const auto&amp; hit : hitPair.second) pm.SetNextPoint(hit[0],hit[1],hit[2]);</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">            nHitsDrawn += hitPair.second.size();</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="comment">// Now try to draw any associated edges</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">if</span> (edgeAssnsVec.isValid() &amp;&amp; recoOpt-&gt;fDraw3DEdges) {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keyword">const</span> std::vector&lt;art::Ptr&lt;recob::Edge&gt;&gt;&amp; edgeVec(edgeAssnsVec.at(pfPart.key()));</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      <span class="keywordflow">if</span> (!edgeVec.empty()) {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;          2 * edgeVec.size(), colorIdx, kFullDotMedium, 1.25); <span class="comment">//kFullDotLarge, 0.5);</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; edge : edgeVec) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;          <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keyword">const</span> std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; spacePointVec(</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;              edgeSPAssnVec.at(edge.key()));</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            <span class="keywordflow">if</span> (spacePointVec.size() != 2) {</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Space Point vector associated to edge is not of size 2: &quot;</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                        &lt;&lt; spacePointVec.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            }</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>* firstSP = spacePointVec[0].get();</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>* secondSP = spacePointVec[1].get();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            TVector3 startPoint(firstSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[0], firstSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[1], firstSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[2]);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            TVector3 endPoint(secondSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[0], secondSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[1], secondSP-&gt;<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>()[2]);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            TVector3 lineVec(endPoint - startPoint);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            pm.SetNextPoint(startPoint[0], startPoint[1], startPoint[2]);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            pm.SetNextPoint(endPoint[0], endPoint[1], endPoint[2]);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            <span class="keywordtype">double</span> length = lineVec.Mag();</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="keywordflow">if</span> (length == 0.) {</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Edge length is zero, index 1: &quot;</span> &lt;&lt; edge-&gt;FirstPointID()</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, index 2: &quot;</span> &lt;&lt; edge-&gt;SecondPointID() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordtype">double</span> minLen = std::max(2.01, length);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="keywordflow">if</span> (minLen &gt; length) {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;              lineVec.SetMag(1.);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;              startPoint += -0.5 * (minLen - length) * lineVec;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;              endPoint += 0.5 * (minLen - length) * lineVec;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            <span class="comment">// Get a polyline object to draw from the first to the second space point</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(2, colorIdx, 4, 1);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            pl.SetPoint(0, startPoint[0], startPoint[1], startPoint[2]);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            pl.SetPoint(1, endPoint[0], endPoint[1], endPoint[2]);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;          }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;          <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;          }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="comment">// Draw associated tracks</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordflow">if</span> (trackAssnVec.isValid()) {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      std::vector&lt;const recob::Track*&gt; trackVec(trackAssnVec.at(pfPart.key()));</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="keywordflow">if</span> (!trackVec.empty()) {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a> : trackVec)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;          <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">DrawTrack3D</a>(*<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>, view, colorIdx, kFullDotLarge, 0.5);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="comment">// Look up the PCA info</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordflow">if</span> (pcAxisAssnVec.isValid() &amp;&amp; recoOpt-&gt;fDraw3DPCAAxes) {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      std::vector&lt;const recob::PCAxis*&gt; pcaVec(pcAxisAssnVec.at(pfPart.key()));</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">if</span> (!pcaVec.empty()) {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="comment">// For each axis we are going to draw a solid line between two points</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordtype">int</span> numPoints(2);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <span class="comment">//int lineWidth[2] = {       3,  1};</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keywordtype">int</span> lineWidth[2] = {2, 1};</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="keywordtype">int</span> lineStyle[2] = {1, 13};</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        <span class="keywordtype">int</span> lineColor[2] = {colorIdx, 18};</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <span class="comment">//int markStyle[2] = {       4,  4};</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="keywordtype">int</span> markStyle[2] = {kFullDotLarge, kFullDotLarge};</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="keywordtype">double</span> markSize[2] = {0.5, 0.2};</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <span class="keywordtype">int</span> pcaIdx(0);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keywordflow">if</span> (!isCosmic) lineColor[1] = colorIdx;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="comment">// The order of axes in the returned association vector is arbitrary... the &quot;first&quot; axis is</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        <span class="comment">// better and we can divine that by looking at the axis id&#39;s (the best will have been made first)</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        <span class="keywordflow">if</span> (pcaVec.size() &gt; 1 &amp;&amp; pcaVec.front()-&gt;getID() &gt; pcaVec.back()-&gt;getID())</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;          std::reverse(pcaVec.begin(), pcaVec.end());</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pca : pcaVec) {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;          <span class="comment">// We need the mean position</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>* avePosition = pca-&gt;getAvePosition();</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;          <span class="comment">// Let&#39;s draw a marker at the interesting points</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;          <span class="keywordtype">int</span> pmrkIdx(0);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;          TPolyMarker3D&amp; pmrk =</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            view-&gt;AddPolyMarker3D(7, lineColor[pcaIdx], markStyle[pcaIdx], markSize[pcaIdx]);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;          pmrk.SetPoint(pmrkIdx++, avePosition[0], avePosition[1], avePosition[2]);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;          <span class="comment">// Loop over pca dimensions</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dimIdx = 0; dimIdx &lt; 3; dimIdx++) {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            <span class="comment">// Oh please oh please give me an instance of a poly line...</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;              numPoints, lineColor[pcaIdx], lineWidth[pcaIdx], lineStyle[pcaIdx]);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;            <span class="comment">// We will use the eigen value to give the length of the line we&#39;re going to plot</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;            <span class="keywordtype">double</span> eigenValue = pca-&gt;getEigenValues()[dimIdx];</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            <span class="comment">// Make sure a valid eigenvalue</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            <span class="keywordflow">if</span> (eigenValue &gt; 0) {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;              <span class="comment">// Really want the root of the eigen value</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;              eigenValue = 3. * sqrt(eigenValue);</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;              <span class="comment">// Recover the eigenvector</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;              <span class="keyword">const</span> std::vector&lt;double&gt;&amp; eigenVector = pca-&gt;getEigenVectors()[dimIdx];</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;              <span class="comment">// Set the first point</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;              <span class="keywordtype">double</span> xl = avePosition[0] - 0.5 * eigenValue * eigenVector[0];</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;              <span class="keywordtype">double</span> yl = avePosition[1] - 0.5 * eigenValue * eigenVector[1];</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;              <span class="keywordtype">double</span> zl = avePosition[2] - 0.5 * eigenValue * eigenVector[2];</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;              pl.SetPoint(0, xl, yl, zl);</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;              pmrk.SetPoint(pmrkIdx++, xl, yl, zl);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;              <span class="comment">// Set the second point</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;              <span class="keywordtype">double</span> xu = avePosition[0] + 0.5 * eigenValue * eigenVector[0];</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;              <span class="keywordtype">double</span> yu = avePosition[1] + 0.5 * eigenValue * eigenVector[1];</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;              <span class="keywordtype">double</span> zu = avePosition[2] + 0.5 * eigenValue * eigenVector[2];</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;              pl.SetPoint(1, xu, yu, zu);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;              pmrk.SetPoint(pmrkIdx++, xu, yu, zu);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;          }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;          <span class="comment">// By convention we will have drawn the &quot;best&quot; axis first</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fBestPCAAxisOnly) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;          pcaIdx++;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      }</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// Now let&#39;s loop over daughters and call drawing routine for them</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">if</span> (pfPart-&gt;NumDaughters() &gt; 0) {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      depth++;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="comment">//        std::string indent(depth, &#39; &#39;);</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="comment">//        std::cout &lt;&lt; indent &lt;&lt; &quot;-drawPFParticle3D--&gt; pfPart idx: &quot; &lt;&lt; pfPart-&gt;Self() &lt;&lt; &quot;, daughter list size: &quot; &lt;&lt; pfPart-&gt;Daughters().size() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; daughterIdx : pfPart-&gt;Daughters()) {</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2003879d584c11e1ef8d5189caba068">DrawPFParticle3D</a>(pfParticleVec.at(daughterIdx),</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                         pfParticleVec,</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                         spacePointVec,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                         edgeAssnsVec,</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                         spacePointAssnVec,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                         edgeSPAssnVec,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                         spHitAssnVec,</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                         trackAssnVec,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                         pcAxisAssnVec,</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                         cosmicTagAssnVec,</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                         depth,</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                         view);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    }</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  }</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a97403b94ef044c188c9ac5bd640a7386"> 2453</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a97403b94ef044c188c9ac5bd640a7386">RecoBaseDrawer::Edge3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  {</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawEdges &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="comment">// The plan is to loop over the list of possible particles</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fEdgeLabels.size(); ++imod) {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fEdgeLabels[imod];</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="comment">// Start off by recovering our 3D Clusters for this label</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      std::vector&lt;art::Ptr&lt;recob::Edge&gt;&gt; edgeVec;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acd4bc8ec002beecf2f843077df96b70f">GetEdges</a>(evt, which, edgeVec);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;RecoBaseDrawer: number Edges to draw: &quot;</span> &lt;&lt; edgeVec.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <span class="keywordflow">if</span> (!edgeVec.empty()) {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="comment">// Get the space points created by the PFParticle producer</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spacePointVec;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, which, spacePointVec);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        <span class="comment">// First draw the space points (all of them), then circle back on the edges...</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <span class="keywordtype">int</span> colorIdx(41); <span class="comment">//2);</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;          spacePointVec.size(), colorIdx, kFullDotMedium, 0.5); <span class="comment">//kFullDotLarge, 0.5);</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spacePoint : spacePointVec) {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;          TVector3 spPosition(spacePoint-&gt;XYZ()[0], spacePoint-&gt;XYZ()[1], spacePoint-&gt;XYZ()[2]);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;          pm.SetNextPoint(spPosition[0], spPosition[1], spPosition[2]);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        <span class="comment">// Now draw the edges</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; edge : edgeVec) {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;          art::Ptr&lt;recob::SpacePoint&gt; firstSP = spacePointVec.at(edge-&gt;FirstPointID());</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;          art::Ptr&lt;recob::SpacePoint&gt; secondSP = spacePointVec.at(edge-&gt;SecondPointID());</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;          <span class="keywordflow">if</span> (firstSP-&gt;ID() != edge-&gt;FirstPointID() || secondSP-&gt;ID() != edge-&gt;SecondPointID()) {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            mf::LogDebug(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Edge: Space point index mismatch, first: &quot;</span> &lt;&lt; firstSP-&gt;ID() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;              &lt;&lt; edge-&gt;FirstPointID() &lt;&lt; <span class="stringliteral">&quot;, second: &quot;</span> &lt;&lt; secondSP-&gt;ID() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;              &lt;&lt; edge-&gt;SecondPointID() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;          }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;          TVector3 startPoint(firstSP-&gt;XYZ()[0], firstSP-&gt;XYZ()[1], firstSP-&gt;XYZ()[2]);</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;          TVector3 endPoint(secondSP-&gt;XYZ()[0], secondSP-&gt;XYZ()[1], secondSP-&gt;XYZ()[2]);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;          TVector3 lineVec(endPoint - startPoint);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;          <span class="keywordtype">double</span> length = lineVec.Mag();</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;          <span class="keywordflow">if</span> (length == 0.) {</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            <span class="comment">//                    std::cout &lt;&lt; &quot;Edge length is zero, index 1: &quot; &lt;&lt; edge-&gt;FirstPointID() &lt;&lt; &quot;, index 2: &quot; &lt;&lt; edge-&gt;SecondPointID() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;          }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;          <span class="comment">// Get a polyline object to draw from the first to the second space point</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;          <span class="comment">//                TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(2, colorIdx, 1, 1); //4, 1);</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;          <span class="comment">//                pl.SetPoint(0, startPoint[0], startPoint[1], startPoint[2]);</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;          <span class="comment">//                pl.SetPoint(1, endPoint[0],   endPoint[1],   endPoint[2]);</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;          TPolyMarker3D&amp; fakeLine = view-&gt;AddPolyMarker3D(10, 5, kFullDotMedium, 1.0);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;          lineVec.SetMag(1.);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 1; idx &lt;= 10; idx++) {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            TVector3 plotPoint = startPoint + 0.1 * double(idx) * length * lineVec;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;            fakeLine.SetNextPoint(plotPoint[0], plotPoint[1], plotPoint[2]);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;          }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        }</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    }</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="comment">// Draw any associated Extreme Points</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fExtremePointLabels.size(); ++imod) {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fExtremePointLabels[imod];</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="comment">// Start off by recovering our 3D Clusters for this label</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spacePointVec;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, which, spacePointVec);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      mf::LogDebug(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;RecoBaseDrawer: number Extreme points to draw: &quot;</span> &lt;&lt; spacePointVec.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      <span class="keywordflow">if</span> (!spacePointVec.empty()) {</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="comment">// First draw the space points (all of them), then circle back on the edges...</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keywordtype">int</span> colorIdx(kYellow);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;          spacePointVec.size(), colorIdx, kFullDotLarge, 1.0); <span class="comment">//kFullDotLarge, 0.5);</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spacePoint : spacePointVec) {</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;          TVector3 spPosition(spacePoint-&gt;XYZ()[0], spacePoint-&gt;XYZ()[1], spacePoint-&gt;XYZ()[2]);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;          pm.SetNextPoint(spPosition[0], spPosition[1], spPosition[2]);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        }</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      }</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    }</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  }</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adbd5182f0115106ccdaa84b12a4108e0"> 2560</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adbd5182f0115106ccdaa84b12a4108e0">RecoBaseDrawer::Prong3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="comment">// annoying for now, but have to have multiple copies of basically the</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="comment">// same code to draw prongs, showers and tracks so that we can use</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="comment">// the art::Assns to get the hits and clusters.</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="comment">// Tracks.</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTracks &gt; 2) {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fTrackLabels.size(); ++imod) {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        art::InputTag which = recoOpt-&gt;fTrackLabels[imod];</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        art::View&lt;recob::Track&gt; trackView;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">GetTracks</a>(evt, which, trackView);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="keywordflow">if</span> (!trackView.isValid())</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">//Prevent potential segmentation fault if no tracks found. aoliv23@lsu.edu</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        art::PtrVector&lt;recob::Track&gt; trackVec;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        trackView.fill(trackVec);</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        art::InputTag <span class="keyword">const</span> cosmicTagLabel(</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;          recoOpt-&gt;fCosmicTagLabels.size() &gt; imod ? recoOpt-&gt;fCosmicTagLabels[imod] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        art::FindMany&lt;anab::CosmicTag&gt; cosmicTagAssnVec(trackVec, evt, cosmicTagLabel);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a> : trackVec) {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;          <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>.key() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;          <span class="keywordtype">int</span> marker = kFullDotLarge;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;          <span class="keywordtype">float</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = 2.0;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;          <span class="comment">// Check if a CosmicTag object is available</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;          <span class="comment">// Recover cosmic tag info if any</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;          <span class="keywordflow">if</span> (cosmicTagAssnVec.isValid()) {</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            std::vector&lt;const anab::CosmicTag*&gt; tkCosmicTagVec = cosmicTagAssnVec.at(<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>.key());</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <span class="keywordflow">if</span> (!tkCosmicTagVec.empty()) {</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;              <span class="keyword">const</span> <a class="code" href="../../d1/d0e/classanab_1_1CosmicTag.html">anab::CosmicTag</a>* cosmicTag = tkCosmicTagVec.front();</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;              <span class="comment">// If tagged as Cosmic then neutralize the color</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;              <span class="keywordflow">if</span> (cosmicTag-&gt;<a class="code" href="../../d1/d0e/classanab_1_1CosmicTag.html#a2093a8d7c5b81f6c92ae72bcbeb209e3">CosmicScore</a>() &gt; 0.6) {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                color = 14;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                size = 0.5;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;              }</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            }</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;          }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;          <span class="comment">// Draw track using only embedded information.</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;          <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">DrawTrack3D</a>(*<a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>, view, color, marker, size);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      }</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    }</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="comment">// Showers.</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawShowers != 0) {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fShowerLabels.size(); ++imod) {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        art::InputTag which = recoOpt-&gt;fShowerLabels[imod];</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        art::View&lt;recob::Shower&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4">GetShowers</a>(evt, which, shower);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; shower.vals().size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>) {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d4/d14/classrecob_1_1Shower.html">recob::Shower</a>* pshower = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;          <span class="keywordtype">int</span> color = pshower-&gt;<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#abfea12b63bb7f09a5f6f2d0e65e321d2">ID</a>();</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;          <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378">DrawShower3D</a>(*pshower, color, view);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  }</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700"> 2639</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">RecoBaseDrawer::DrawTrack3D</a>(<span class="keyword">const</span> <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>,</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                              evdb::View3D* view,</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                              <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                              <span class="keywordtype">int</span> marker,</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                              <span class="keywordtype">float</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">// Get options.</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTrackSpacePoints) {</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="comment">// Use brute force to find the module label and index of this</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="comment">// track, so that we can find associated space points and draw</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="comment">// them.</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keyword">const</span> art::Event* <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a> = evdb::EventHolder::Instance()-&gt;GetEvent();</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="comment">//std::vector&lt;art::Handle&lt;std::vector&lt;recob::Track&gt;&gt;&gt; handles;</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="comment">//evt-&gt;getManyByType(handles);</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <span class="keyword">auto</span> handles = evt-&gt;getMany&lt;std::vector&lt;recob::Track&gt;&gt;();</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ih : handles) {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keyword">const</span> art::Handle&lt;std::vector&lt;recob::Track&gt;&gt; handle = ih;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">if</span> (handle.isValid()) {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;          <span class="keyword">const</span> std::string&amp; which = handle.provenance()-&gt;moduleLabel();</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;          art::FindManyP&lt;recob::SpacePoint&gt; fmsp(handle, *evt, which);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;          <span class="keywordflow">if</span> (fmsp.isValid() &amp;&amp; fmsp.size() &gt; 0) {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = handle-&gt;size();</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="keywordtype">float</span> spSize = 0.5 * <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;              art::Ptr&lt;recob::Track&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>(handle, i);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;              <span class="keywordflow">if</span> (&amp;*p == &amp;track) {</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts = fmsp.at(i);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">fSpacePointDrawer</a>-&gt;Draw(spts, view, color, marker, spSize);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;              }</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;          }</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        }</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      }</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTrackTrajectoryPoints) {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      <span class="comment">// Draw trajectory points.</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keywordtype">int</span> np = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a9128436d1a2465fc9f5393898b6fa236">NumberTrajectoryPoints</a>();</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="keywordtype">int</span> lineSize = <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="keywordflow">if</span> (lineSize &lt; 1) lineSize = 1;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <span class="comment">// Make and fill a special polymarker for the head of the track</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="comment">//TPolyMarker3D&amp; pmStart = view-&gt;AddPolyMarker3D(1, color, 4, 3);</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      TPolyMarker3D&amp; pmStart = view-&gt;AddPolyMarker3D(1, 0, marker, 2. * size);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; firstPos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(0);</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      pmStart.SetPoint(0, firstPos.X(), firstPos.Y(), firstPos.Z());</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="comment">// Make and fill a polymarker.</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      TPolyMarker3D&amp; pm = view-&gt;AddPolyMarker3D(track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0baed39cc12dfe2586761840d31fc225">CountValidPoints</a>(), color, 1, 3);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; np; ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="keywordflow">if</span> (!track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">HasValidPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        pm.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.X(), pos.Y(), pos.Z());</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      }</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <span class="comment">// As we are a track, should we not be drawing a line here?</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0baed39cc12dfe2586761840d31fc225">CountValidPoints</a>(), color, lineSize, 7);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; np; ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="keywordflow">if</span> (!track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">HasValidPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> pos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        pl.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.X(), pos.Y(), pos.Z());</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      }</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTrackTrajectoryPoints &gt; 4) {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="comment">// Can we add the track direction at each point?</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="comment">// This won&#39;t work for the last point... but let&#39;s try</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keyword">auto</span> startPos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(0);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        <span class="keyword">auto</span> startDir = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a931081e58a8c41b2d0e1473d2fb6bdb2">DirectionAtPoint</a>(0);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 1; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; np; ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;          <span class="keywordflow">if</span> (!track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">HasValidPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;          TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(2, (color + 1) % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>, size, 7); <span class="comment">//1, 3);</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;          <span class="keyword">auto</span> nextPos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;          <span class="keyword">auto</span> deltaPos = nextPos - startPos;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;          <span class="keywordtype">double</span> arcLen = deltaPos.Dot(</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            startDir); <span class="comment">// arc len to plane containing next point perpendicular to current point dir</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;          <span class="keywordflow">if</span> (arcLen &lt; 0.) arcLen = 3.;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;          <span class="keyword">auto</span> endPoint = startPos + arcLen * startDir;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;          pl.SetPoint(0, startPos.X(), startPos.Y(), startPos.Z());</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;          pl.SetPoint(1, endPoint.X(), endPoint.Y(), endPoint.Z());</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;          startPos = nextPos;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;          startDir = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a931081e58a8c41b2d0e1473d2fb6bdb2">DirectionAtPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      }</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    }</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;  }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378"> 2750</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378">RecoBaseDrawer::DrawShower3D</a>(<span class="keyword">const</span> <a class="code" href="../../d4/d14/classrecob_1_1Shower.html">recob::Shower</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>, <span class="keywordtype">int</span> color, evdb::View3D* view)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="comment">// Use brute force to find the module label and index of this</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="comment">// shower, so that we can find associated space points and draw</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="comment">// them.</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="comment">// B. Baller: Catch an exception if there are no space points and draw a cone instead.</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keyword">const</span> art::Event* <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a> = evdb::EventHolder::Instance()-&gt;GetEvent();</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="comment">//std::vector&lt;art::Handle&lt;std::vector&lt;recob::Shower&gt;&gt;&gt; handles;</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="comment">//evt-&gt;getManyByType(handles);</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keyword">auto</span> handles = evt-&gt;getMany&lt;std::vector&lt;recob::Shower&gt;&gt;();</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="keywordtype">bool</span> noSpts = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> ih : handles) {</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <span class="keyword">const</span> art::Handle&lt;std::vector&lt;recob::Shower&gt;&gt; handle = ih;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      <span class="keywordflow">if</span> (handle.isValid()) {</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <span class="keyword">const</span> std::string&amp; which = handle.provenance()-&gt;moduleLabel();</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        art::FindManyP&lt;recob::SpacePoint&gt; fmsp(handle, *evt, which);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = handle-&gt;size();</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;          art::Ptr&lt;recob::Shower&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>(handle, i);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;          <span class="keywordflow">if</span> (&amp;*p == &amp;shower) {</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            <span class="comment">// BB catch if no space points</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;              spts = fmsp.at(i);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;              <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">fSpacePointDrawer</a>-&gt;Draw(spts, view, color);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            }</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;              noSpts = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            } <span class="comment">// catch</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;          }   <span class="comment">// shower</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        }     <span class="comment">// i</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      }       <span class="comment">// ih</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordflow">if</span> (noSpts &amp;&amp; shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a35e5c47d5dd67e3d1226f060e610ff65">has_length</a>() &amp;&amp; shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a55f7e431fda14081ca764a38a264506c">has_open_angle</a>()) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;No space points associated with the shower. Drawing a cone instead\n&quot;</span>;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      color = kRed;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keyword">auto</span>&amp; dedx = shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a9723da439d0c12ccbe2e4dc669c4cc99">dEdx</a>();</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="keywordflow">if</span> (!dedx.empty()) {</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        <span class="keywordtype">double</span> dedxAve = 0;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dedxInPln : dedx)</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;          dedxAve += dedxInPln;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        dedxAve /= (double)dedx.size();</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="comment">// Use blue for ~1 MIP</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        color = kBlue;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <span class="comment">// use green for ~2 MIP</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">if</span> (dedxAve &gt; 3 &amp;&amp; dedxAve &lt; 5) color = kGreen;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      }</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      <span class="keywordtype">double</span> radius = shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a12283404f48c3daf15ca201ffbc7bbe6">Length</a>() * shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a0adafeec7c6f10509c7b6315906d677e">OpenAngle</a>();</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      TVector3 startPos = shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#aae9b151ad4c88ba45d45071be198637b">ShowerStart</a>();</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      TVector3 endPos = startPos + shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#a12283404f48c3daf15ca201ffbc7bbe6">Length</a>() * shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#ae4d84452d662dac7ddb3337803d02fcd">Direction</a>();</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      <span class="keyword">auto</span> coneRim = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad570ecf8ccef879c571c16c54a429fa4">Circle3D</a>(endPos, shower.<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#ae4d84452d662dac7ddb3337803d02fcd">Direction</a>(), radius);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      TPolyLine3D&amp; pl = view-&gt;AddPolyLine3D(coneRim.size(), color, 2, 0);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipt = 0; ipt &lt; coneRim.size(); ++ipt) {</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <span class="keyword">auto</span>&amp; pt = coneRim[ipt];</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        pl.SetPoint(ipt, pt[0], pt[1], pt[2]);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      }</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="comment">// Draw a line from the start position to each point on the rim</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ipt = 0; ipt &lt; coneRim.size(); ++ipt) {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        TPolyLine3D&amp; panel = view-&gt;AddPolyLine3D(2, color, 2, 0);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        panel.SetPoint(0, startPos.X(), startPos.Y(), startPos.Z());</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        panel.SetPoint(1, coneRim[ipt][0], coneRim[ipt][1], coneRim[ipt][2]);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      } <span class="comment">//  ipt</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    } <span class="comment">// no space points</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  }</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  std::vector&lt;std::array&lt;double, 3&gt;&gt;</div>
<div class="line"><a name="l02828"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad570ecf8ccef879c571c16c54a429fa4"> 2828</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad570ecf8ccef879c571c16c54a429fa4">RecoBaseDrawer::Circle3D</a>(<span class="keyword">const</span> TVector3&amp; centerPos, <span class="keyword">const</span> TVector3&amp; axisDir, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; radius)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="comment">// B. Baller Create a polyline circle in 3D</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="comment">// Make the rotation matrix to transform into the circle coordinate system</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    TRotation <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    r.RotateX(axisDir.X());</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    r.RotateY(axisDir.Y());</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    r.RotateZ(axisDir.Z());</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRimPts = 16;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    std::vector&lt;std::array&lt;double, 3&gt;&gt; rimPts(nRimPts + 1);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iang = 0; iang &lt; nRimPts; ++iang) {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordtype">double</span> rimAngle = iang * 2 * M_PI / (float)nRimPts;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      TVector3 rim = {0, 0, 1};</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      rim.SetX(radius * cos(rimAngle));</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      rim.SetY(radius * sin(rimAngle));</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      rim.SetZ(0);</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      rim.Transform(r);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      rim += centerPos;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ixyz = 0; ixyz &lt; 3; ++ixyz)</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        rimPts[iang][ixyz] = rim[ixyz];</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    } <span class="comment">// iang</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="comment">// close the circle</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    rimPts[nRimPts] = rimPts[0];</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <span class="keywordflow">return</span> rimPts;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  } <span class="comment">// PolyLineCircle</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6f1dfd766acf1ad504dbc95e79c99229"> 2857</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6f1dfd766acf1ad504dbc95e79c99229">RecoBaseDrawer::Vertex3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawVertices != 0) {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fVertexLabels.size(); ++imod) {</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fVertexLabels[imod];</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        art::PtrVector&lt;recob::Vertex&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e">GetVertices</a>(evt, which, vertex);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        art::FindManyP&lt;recob::Track&gt; fmt(vertex, evt, which);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        art::FindManyP&lt;recob::Shower&gt; fms(vertex, evt, which);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> v = 0; v &lt; vertex.size(); ++v) {</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;          <span class="keywordflow">if</span> (fmt.isValid()) {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            std::vector&lt;art::Ptr&lt;recob::Track&gt;&gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a> = fmt.at(v);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;            <span class="comment">// grab the Prongs from the vertex and draw those</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; tracks.size(); ++t)</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;              this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">DrawTrack3D</a>(*(tracks[t]), view, vertex[v]-&gt;ID());</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;          }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;          <span class="keywordflow">if</span> (fms.isValid()) {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            std::vector&lt;art::Ptr&lt;recob::Shower&gt;&gt; showers = fms.at(v);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; showers.size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;              this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378">DrawShower3D</a>(*(showers[<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>]), vertex[v]-&gt;ID(), view);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;          <span class="keywordtype">double</span> xyz[3] = {0.};</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;          vertex[v]-&gt;XYZ(xyz);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;          TPolyMarker3D&amp; pm =</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            view-&gt;AddPolyMarker3D(1, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[vertex[v]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>], 29, 6);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;          pm.SetPoint(0, xyz[0], xyz[1], xyz[2]);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        } <span class="comment">// end loop over vertices to draw from this label</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      }   <span class="comment">// end loop over vertex module lables</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    }     <span class="comment">// end if we are drawing vertices</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a240c99ce3493c1129943b2a9d3aff1e4"> 2907</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a240c99ce3493c1129943b2a9d3aff1e4">RecoBaseDrawer::Event3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawEvents != 0) {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fEventLabels.size(); ++imod) {</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fEventLabels[imod];</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        art::PtrVector&lt;recob::Event&gt; event;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab80f3650b8b09d1583b9f79f052e5f3f">GetEvents</a>(evt, which, event);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        <span class="keywordflow">if</span> (event.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        art::FindManyP&lt;recob::Vertex&gt; fmvp(event, evt, which);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        art::FindMany&lt;recob::Vertex&gt; fmv(event, evt, which);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a> = 0; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a> &lt; <span class="keyword">event</span>.size(); ++<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          <span class="comment">// grab the vertices for this event</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;          std::vector&lt;art::Ptr&lt;recob::Vertex&gt;&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a> = fmvp.at(<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;          <span class="keywordflow">if</span> (vertex.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          art::FindManyP&lt;recob::Track&gt; fmt(vertex, evt, recoOpt-&gt;fVertexLabels[0]);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;          art::FindManyP&lt;recob::Shower&gt; fms(vertex, evt, recoOpt-&gt;fVertexLabels[0]);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> v = 0; v &lt; vertex.size(); ++v) {</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment">            /// \todo need a better way to grab the vertex module labels,</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment"></span>            <span class="comment">// right now assume there is only 1 in the list</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            std::vector&lt;art::Ptr&lt;recob::Track&gt;&gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a> = fmt.at(v);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            std::vector&lt;art::Ptr&lt;recob::Shower&gt;&gt; showers = fms.at(v);</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            <span class="comment">// grab the Prongs from the vertex and draw those</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; tracks.size(); ++t)</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;              this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">DrawTrack3D</a>(*(tracks[t]), view, <span class="keyword">event</span>[<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>]-&gt;ID());</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; showers.size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;              this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378">DrawShower3D</a>(*(showers[<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>]), <span class="keyword">event</span>[<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>]-&gt;ID(), view);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;          } <span class="comment">// end loop over vertices from this event</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="keywordtype">double</span> xyz[3] = {0.};</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          std::vector&lt;const recob::Vertex*&gt; vts = fmv.at(<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          <span class="keyword">event</span>[<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>]-&gt;PrimaryVertex(vts)-&gt;XYZ(xyz);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;          TPolyMarker3D&amp; pm =</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            view-&gt;AddPolyMarker3D(1, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[event[<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>], 29, 6);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;          pm.SetPoint(0, xyz[0], xyz[1], xyz[2]);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        } <span class="comment">// end loop over events</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      }   <span class="comment">// end loop over event module lables</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    }     <span class="comment">// end if we are drawing events</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  }</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a68dd45591fae87a346ccd7aab72f1381"> 2968</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a68dd45591fae87a346ccd7aab72f1381">RecoBaseDrawer::Slice3D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, evdb::View3D* view)</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  {</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSlices &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSliceSpacePoints &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSliceLabels.size(); ++imod) {</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fSliceLabels[imod];</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      art::PtrVector&lt;recob::Slice&gt; <a class="code" href="../../de/d0f/namespacetca.html#a0898183aa6813a6ab2cbaede7d31e4d1">slices</a>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a93222627e36c5913a7aed3ade5c68f3d">GetSlices</a>(evt, which, slices);</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;      <span class="keywordflow">if</span> (slices.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      art::FindManyP&lt;recob::SpacePoint&gt; fmsp(slices, evt, which);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> isl = 0; isl &lt; slices.size(); ++isl) {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordtype">int</span> slcID = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(slices[isl]-&gt;ID());</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[slcID % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts = fmsp.at(isl);</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">fSpacePointDrawer</a>-&gt;Draw(spts, view, color, kFullDotLarge, 2);</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      }</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    }</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  }</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a88cf095de28d125a2b818aa59a89d33d"> 2992</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a88cf095de28d125a2b818aa59a89d33d">RecoBaseDrawer::OpFlashOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                               <a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                               <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                               <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                               evdb::View2D* view)</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawOpFlashes == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a> pid(rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, 0);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="keywordtype">double</span> minx = 1e9;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordtype">double</span> maxx = -1e9;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; geo-&gt;NTPC(); ++i) {</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a>[3] = {0., 0., 0.};</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="keywordtype">double</span> world[3] = {0., 0., 0.};</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; tpc = geo-&gt;TPC(i);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      tpc.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(local, world);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <span class="keywordflow">if</span> (minx &gt; world[0] - geo-&gt;DetHalfWidth(i)) minx = world[0] - geo-&gt;DetHalfWidth(i);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keywordflow">if</span> (maxx &lt; world[0] + geo-&gt;DetHalfWidth(i)) maxx = world[0] + geo-&gt;DetHalfWidth(i);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    }</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fOpFlashLabels.size(); ++imod) {</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      <span class="keyword">const</span> art::InputTag which = recoOpt-&gt;fOpFlashLabels[imod];</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      art::PtrVector&lt;recob::OpFlash&gt; opflashes;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab023442ffe9c0c0b6129119af1cb2a88">GetOpFlashes</a>(evt, which, opflashes);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">if</span> (opflashes.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <span class="keywordtype">int</span> NFlashes = opflashes.size();</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <span class="comment">// project each seed into this view</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iof = 0; iof &lt; NFlashes; ++iof) {</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;TotalPE() &lt; recoOpt-&gt;fFlashMinPE) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;Time() &lt; recoOpt-&gt;fFlashTMin) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="keywordflow">if</span> (opflashes[iof]-&gt;Time() &gt; recoOpt-&gt;fFlashTMax) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordtype">double</span> YCentre = opflashes[iof]-&gt;YCenter();</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        <span class="keywordtype">double</span> YHalfWidth = opflashes[iof]-&gt;YWidth();</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keywordtype">double</span> ZCentre = opflashes[iof]-&gt;ZCenter();</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        <span class="keywordtype">double</span> ZHalfWidth = opflashes[iof]-&gt;ZWidth();</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        <span class="keywordtype">int</span> Colour = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[(iof) % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          TBox&amp; b1 = view-&gt;AddBox(YCentre - YHalfWidth, minx, YCentre + YHalfWidth, maxx);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;          b1.SetFillStyle(3004 + (iof % 3));</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;          b1.SetFillColor(Colour);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        }</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;          <span class="keywordtype">float</span> xflash = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            opflashes[iof]-&gt;Time() / <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1e3 + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">GetXTicksOffset</a>(pid),</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            pid);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          TLine&amp; line = view-&gt;AddLine(ZCentre - ZHalfWidth, xflash, ZCentre + ZHalfWidth, xflash);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;          line.SetLineWidth(2);</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;          line.SetLineStyle(2);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          line.SetLineColor(Colour);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;        }</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>) {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;          TBox&amp; b1 = view-&gt;AddBox(</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;            ZCentre - ZHalfWidth, YCentre - YHalfWidth, ZCentre + ZHalfWidth, YCentre + YHalfWidth);</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          b1.SetFillStyle(3004 + (iof % 3));</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;          b1.SetFillColor(Colour);</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;          view-&gt;AddMarker(ZCentre, YCentre, Colour, 4, 1.5);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      } <span class="comment">// Flashes with this label</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    }   <span class="comment">// Vector of OpFlash labels</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  }</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1c1599cdbb2e91320e7fddff00f4b6ad"> 3069</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1c1599cdbb2e91320e7fddff00f4b6ad">RecoBaseDrawer::VertexOrtho</a>(<span class="keyword">const</span> art::PtrVector&lt;recob::Vertex&gt;&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>,</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                              <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                              evdb::View2D* view,</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                              <span class="keywordtype">int</span> marker)</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  {</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> v = 0; v &lt; vertex.size(); ++v) {</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      <span class="keywordtype">double</span> xyz[3] = {0.};</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      vertex[v]-&gt;XYZ(xyz);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="keywordtype">int</span> color = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[vertex[v]-&gt;ID() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(xyz[1], xyz[0], color, marker, 1.0);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      }</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(xyz[2], xyz[0], color, marker, 1.0);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      }</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>) {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        TMarker&amp; strt = view-&gt;AddMarker(xyz[2], xyz[1], color, marker, 1.0);</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        strt.SetMarkerColor(color);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      }</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  }</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1ed420ce57d586e41eb704f7f63d2a53"> 3096</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1c1599cdbb2e91320e7fddff00f4b6ad">RecoBaseDrawer::VertexOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj, evdb::View2D* view)</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawVertices == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fVertexLabels.size(); ++imod) {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fVertexLabels[imod];</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      art::PtrVector&lt;recob::Vertex&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e">GetVertices</a>(evt, which, vertex);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1c1599cdbb2e91320e7fddff00f4b6ad">VertexOrtho</a>(vertex, proj, view, 24);</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      <span class="comment">//this-&gt;GetVertices(evt, art::InputTag(which.label(), &quot;kink&quot;, which.process()), vertex);</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <span class="comment">//this-&gt;VertexOrtho(vertex, proj, view, 27);</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      <span class="comment">//this-&gt;GetVertices(evt, art::InputTag(which.label(), &quot;node&quot;, which.process()), vertex);</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="comment">//this-&gt;VertexOrtho(vertex, proj, view, 22);</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    }</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  }</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad258c88a6ba00baa7494c561e048c2d7"> 3123</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad258c88a6ba00baa7494c561e048c2d7">RecoBaseDrawer::SpacePointOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                  <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                                  <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                                  evdb::View2D* view)</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  {</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    std::vector&lt;art::InputTag&gt; <a class="code" href="../../d9/d76/build-larbase-py2_8sh.html#af6b3895e39ae33d4633d338ed2ddf9e3">labels</a>;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawSpacePoints != 0) {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fSpacePointLabels.size(); ++imod)</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        labels.push_back(recoOpt-&gt;fSpacePointLabels[imod]);</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; labels.size(); ++imod) {</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      art::InputTag <span class="keyword">const</span> which = labels[imod];</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">GetSpacePoints</a>(evt, which, spts);</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;      <span class="keywordtype">int</span> color = imod;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1">DrawSpacePointOrtho</a>(spts, color, proj, msize, view);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    }</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0b824162860b687bc88cfe97c048437d"> 3154</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0b824162860b687bc88cfe97c048437d">RecoBaseDrawer::PFParticleOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                                  <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                                  <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                                  evdb::View2D* view)</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawPFParticles &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="comment">// The plan is to loop over the list of possible particles</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fPFParticleLabels.size(); ++imod) {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fPFParticleLabels[imod];</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <span class="comment">// Start off by recovering our 3D Clusters for this label</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;      art::PtrVector&lt;recob::PFParticle&gt; pfParticleVec;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa33c29aecd1e81defa8d5c729d4da9c5">GetPFParticles</a>(evt, which, pfParticleVec);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <span class="comment">// Make sure we have some clusters</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="keywordflow">if</span> (pfParticleVec.size() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      <span class="comment">// Add the relations to recover associations cluster hits</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      art::FindMany&lt;recob::SpacePoint&gt; spacePointAssnVec(pfParticleVec, evt, which);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      <span class="comment">// If no valid space point associations then nothing to do</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      <span class="keywordflow">if</span> (!spacePointAssnVec.isValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;      <span class="comment">// Need the PCA info as well</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      art::FindMany&lt;recob::PCAxis&gt; pcAxisAssnVec(pfParticleVec, evt, which);</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keywordflow">if</span> (!pcAxisAssnVec.isValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <span class="comment">// Commence looping over possible clusters</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; pfParticleVec.size(); idx++) {</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        <span class="comment">// Recover cluster</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        <span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt; pfParticle(pfParticleVec.at(idx));</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        <span class="comment">// Drawing will be done recursively down the chain of hieirarchy... so we want to begin</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        <span class="comment">// with only &quot;primary&quot; particles, if we find one that isn&#39;t then we skip</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="keywordflow">if</span> (!pfParticle-&gt;IsPrimary()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        <span class="comment">// Call the recursive drawing routine</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4b6bfeabfabcef393b6669957d537845">DrawPFParticleOrtho</a>(</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;          pfParticle, pfParticleVec, spacePointAssnVec, pcAxisAssnVec, 0, proj, view);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    }</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;  }</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4b6bfeabfabcef393b6669957d537845"> 3206</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4b6bfeabfabcef393b6669957d537845">RecoBaseDrawer::DrawPFParticleOrtho</a>(<span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt;&amp; pfPart,</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                                      <span class="keyword">const</span> art::PtrVector&lt;recob::PFParticle&gt;&amp; pfParticleVec,</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                                      <span class="keyword">const</span> art::FindMany&lt;recob::SpacePoint&gt;&amp; spacePointAssnVec,</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                                      <span class="keyword">const</span> art::FindMany&lt;recob::PCAxis&gt;&amp; pcAxisAssnVec,</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                                      <span class="keywordtype">int</span> depth,</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                                      <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                                      evdb::View2D* view)</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  {</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    <span class="comment">// First let&#39;s draw the hits associated to this cluster</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="keyword">const</span> std::vector&lt;const recob::SpacePoint*&gt;&amp; hitsVec(spacePointAssnVec.at(pfPart-&gt;Self()));</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="comment">// Use the particle ID to determine the color to draw the points</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="comment">// Ok, this is what we would like to do eventually but currently all particles are the same...</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="comment">//        int colorIdx = evd::Style::ColorFromPDG(pfPart-&gt;PdgCode());</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordtype">int</span> colorIdx = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[pfPart-&gt;Self() % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    <span class="keywordflow">if</span> (!hitsVec.empty()) {</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; hitPosVec;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; skeletonPosVec;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; skelEdgePosVec;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; edgePosVec;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; seedPosVec;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      std::vector&lt;const recob::SpacePoint*&gt; pairPosVec;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spacePoint : hitsVec) {</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        <span class="keywordflow">if</span> (spacePoint-&gt;Chisq() &gt; 0.)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;          hitPosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spacePoint-&gt;Chisq() == -1.)</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;          skeletonPosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spacePoint-&gt;Chisq() == -3.)</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;          skelEdgePosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spacePoint-&gt;Chisq() == -4.)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;          seedPosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spacePoint-&gt;Chisq() &gt; -10.)</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;          edgePosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;          pairPosVec.push_back(spacePoint);</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      }</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      <span class="keywordtype">int</span> hitIdx(0);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;      <span class="keywordflow">if</span> (!recoOpt-&gt;fSkeletonOnly) {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        TPolyMarker&amp; pm1 = view-&gt;AddPolyMarker(hitPosVec.size(), colorIdx, kFullDotMedium, 1);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : hitPosVec) {</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;          <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            pm1.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            pm1.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;            pm1.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        }</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;        hitIdx = 0;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        TPolyMarker&amp; pm2 = view-&gt;AddPolyMarker(edgePosVec.size(), 28, kFullDotMedium, 1);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : edgePosVec) {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;          <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            pm2.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            pm2.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;            pm2.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        }</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        hitIdx = 0;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;        TPolyMarker&amp; pm3 = view-&gt;AddPolyMarker(pairPosVec.size(), 2, kFullDotMedium, 1);</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : pairPosVec) {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;          <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            pm3.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            pm3.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;            pm3.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        }</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      }</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      hitIdx = 0;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      TPolyMarker&amp; pm4 = view-&gt;AddPolyMarker(skeletonPosVec.size(), 1, kFullDotMedium, 1);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : skeletonPosVec) {</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;          pm4.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;          pm4.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;          pm4.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      }</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      hitIdx = 0;</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      TPolyMarker&amp; pm5 = view-&gt;AddPolyMarker(skelEdgePosVec.size(), 3, kFullDotMedium, 1);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : skelEdgePosVec) {</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;          pm5.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;          pm5.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;          pm5.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      }</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      hitIdx = 0;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      TPolyMarker&amp; pm6 = view-&gt;AddPolyMarker(seedPosVec.size(), 6, kFullDotMedium, 1);</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>* spacePoint : seedPosVec) {</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>* pos = spacePoint-&gt;XYZ();</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;          pm6.SetPoint(hitIdx++, pos[0], pos[1]);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;          pm6.SetPoint(hitIdx++, pos[2], pos[0]);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;          pm6.SetPoint(hitIdx++, pos[2], pos[1]);</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      }</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    }</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="comment">// Look up the PCA info</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    <span class="keywordflow">if</span> (pcAxisAssnVec.isValid()) {</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      std::vector&lt;const recob::PCAxis*&gt; pcaVec(pcAxisAssnVec.at(pfPart-&gt;Self()));</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      <span class="keywordflow">if</span> (!pcaVec.empty()) {</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        <span class="comment">// For each axis we are going to draw a solid line between two points</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        <span class="keywordtype">int</span> numPoints(2);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        <span class="keywordtype">int</span> lineWidth[2] = {3, 1};</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;        <span class="keywordtype">int</span> lineStyle[2] = {1, 13};</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        <span class="keywordtype">int</span> lineColor[2] = {colorIdx, 18};</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <span class="keywordtype">int</span> markStyle[2] = {4, 4};</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="keywordtype">int</span> pcaIdx(0);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        <span class="comment">// The order of axes in the returned association vector is arbitrary... the &quot;first&quot; axis is</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <span class="comment">// better and we can divine that by looking at the axis id&#39;s (the best will have been made first)</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        <span class="keywordflow">if</span> (pcaVec.size() &gt; 1 &amp;&amp; pcaVec.front()-&gt;getID() &gt; pcaVec.back()-&gt;getID())</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;          std::reverse(pcaVec.begin(), pcaVec.end());</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pca : pcaVec) {</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;          <span class="comment">// We need the mean position</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>* avePosition = pca-&gt;getAvePosition();</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;          <span class="comment">// Let&#39;s draw a marker at the interesting points</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;          <span class="keywordtype">int</span> pmrkIdx(0);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;          TPolyMarker&amp; pmrk = view-&gt;AddPolyMarker(7, lineColor[pcaIdx], markStyle[pcaIdx], 1);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;          <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;            pmrk.SetPoint(pmrkIdx++, avePosition[0], avePosition[1]);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>)</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;            pmrk.SetPoint(pmrkIdx++, avePosition[2], avePosition[0]);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>)</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            pmrk.SetPoint(pmrkIdx++, avePosition[2], avePosition[1]);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;          <span class="comment">// Loop over pca dimensions</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dimIdx = 0; dimIdx &lt; 3; dimIdx++) {</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;            <span class="comment">// Oh please oh please give me an instance of a poly line...</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;            TPolyLine&amp; pl =</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;              view-&gt;AddPolyLine(numPoints, lineColor[pcaIdx], lineWidth[pcaIdx], lineStyle[pcaIdx]);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;            <span class="comment">// We will use the eigen value to give the length of the line we&#39;re going to plot</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            <span class="keywordtype">double</span> eigenValue = pca-&gt;getEigenValues()[dimIdx];</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            <span class="comment">// Make sure a valid eigenvalue</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;            <span class="keywordflow">if</span> (eigenValue &gt; 0) {</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;              <span class="comment">// Really want the root of the eigen value</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;              eigenValue = 3. * sqrt(eigenValue);</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;              <span class="comment">// Recover the eigenvector</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;              <span class="keyword">const</span> std::vector&lt;double&gt;&amp; eigenVector = pca-&gt;getEigenVectors()[dimIdx];</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;              <span class="comment">// Set the first point</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;              <span class="keywordtype">double</span> xl = avePosition[0] - 0.5 * eigenValue * eigenVector[0];</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;              <span class="keywordtype">double</span> yl = avePosition[1] - 0.5 * eigenValue * eigenVector[1];</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;              <span class="keywordtype">double</span> zl = avePosition[2] - 0.5 * eigenValue * eigenVector[2];</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;              <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                pl.SetPoint(0, xl, yl);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                pmrk.SetPoint(pmrkIdx++, xl, yl);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;              }</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                pl.SetPoint(0, zl, xl);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                pmrk.SetPoint(pmrkIdx++, zl, xl);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;              }</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>) {</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                pl.SetPoint(0, zl, yl);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                pmrk.SetPoint(pmrkIdx++, zl, yl);</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;              }</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;              <span class="comment">// Set the second point</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;              <span class="keywordtype">double</span> xu = avePosition[0] + 0.5 * eigenValue * eigenVector[0];</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;              <span class="keywordtype">double</span> yu = avePosition[1] + 0.5 * eigenValue * eigenVector[1];</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;              <span class="keywordtype">double</span> zu = avePosition[2] + 0.5 * eigenValue * eigenVector[2];</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;              <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                pl.SetPoint(1, xu, yu);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                pmrk.SetPoint(pmrkIdx++, xu, yu);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;              }</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                pl.SetPoint(1, zu, xu);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                pmrk.SetPoint(pmrkIdx++, zu, xu);</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;              }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>) {</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                pl.SetPoint(1, zu, yu);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                pmrk.SetPoint(pmrkIdx++, zu, yu);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;              }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;            }</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;          }</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;          <span class="comment">// By convention we will have drawn the &quot;best&quot; axis first</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;          <span class="keywordflow">if</span> (recoOpt-&gt;fBestPCAAxisOnly) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;          pcaIdx++;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        }</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      }</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    }</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    <span class="comment">// Now let&#39;s loop over daughters and call drawing routine for them</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">if</span> (pfPart-&gt;NumDaughters() &gt; 0) {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      depth++;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; daughterIdx : pfPart-&gt;Daughters()) {</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4b6bfeabfabcef393b6669957d537845">DrawPFParticleOrtho</a>(pfParticleVec.at(daughterIdx),</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                            pfParticleVec,</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                            spacePointAssnVec,</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                            pcAxisAssnVec,</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                            depth,</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                            proj,</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                            view);</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      }</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    }</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  }</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af39df3f291064ea41a036f6fc93be1fd"> 3450</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af39df3f291064ea41a036f6fc93be1fd">RecoBaseDrawer::ProngOrtho</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                             <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                             <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                             evdb::View2D* view)</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="comment">// annoying for now, but have to have multiple copies of basically the</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="comment">// same code to draw prongs, showers and tracks so that we can use</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <span class="comment">// the art::Assns to get the hits and clusters.</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <span class="comment">// Tracks.</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTracks != 0) {</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fTrackLabels.size(); ++imod) {</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        art::InputTag which = recoOpt-&gt;fTrackLabels[imod];</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        art::View&lt;recob::Track&gt; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">GetTracks</a>(evt, which, track);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; track.vals().size(); ++t) {</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>* ptrack = track.vals().at(t);</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          <span class="keywordtype">int</span> color = ptrack-&gt;<a class="code" href="../../d9/dca/classrecob_1_1Track.html#ab0d5a4fa186436915e63a4d54ca407fa">ID</a>() &amp; 65535;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;          <span class="comment">// Draw track using only embedded information.</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;          <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aef3884624866ecc5440b976b7ebd58e8">DrawTrackOrtho</a>(*ptrack, color, proj, msize, view);</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        }</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      }</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    }</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    <span class="comment">// Showers.</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawShowers != 0) {</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fShowerLabels.size(); ++imod) {</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        art::InputTag which = recoOpt-&gt;fShowerLabels[imod];</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        art::View&lt;recob::Shower&gt; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4">GetShowers</a>(evt, which, shower);</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; shower.vals().size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>) {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d4/d14/classrecob_1_1Shower.html">recob::Shower</a>* pshower = shower.vals().at(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>);</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;          <span class="keywordtype">int</span> color = pshower-&gt;<a class="code" href="../../d4/d14/classrecob_1_1Shower.html#abfea12b63bb7f09a5f6f2d0e65e321d2">ID</a>();</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;          <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2b1e161580991e48fad66303333b96b">DrawShowerOrtho</a>(*pshower, color, proj, msize, view);</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;        }</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      }</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    }</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;  }</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1"> 3504</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1">RecoBaseDrawer::DrawSpacePointOrtho</a>(<a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; spts,</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                                      <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                                      <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                                      <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;                                      evdb::View2D* view,</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                                      <span class="keywordtype">int</span> <a class="code" href="../../d4/d03/noise__ana_8cxx.html#a166889fdc8b9a698a68cedffc20aed31">mode</a>)</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  {</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <span class="comment">// Get services.</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    <span class="comment">// Organize space points into separate collections according to the color</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    <span class="comment">// we want them to be.</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <span class="comment">// If option If option fColorSpacePointsByChisq is false, this means</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    <span class="comment">// having a single collection with color inherited from the prong</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <span class="comment">// (specified by the argument color).</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    std::map&lt;int, std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&gt; spmap; <span class="comment">// Indexed by color.</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; pspt : spts) {</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="comment">// By default use event display palette.</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="keywordtype">int</span> spcolor = <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keywordflow">if</span> (mode == 1) { <span class="comment">//shower hits</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        spcolor = <a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>];</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;      }</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <span class="comment">// For rainbow effect, choose root colors in range [51,100].</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      <span class="comment">// We are using 100=best (red), 51=worst (blue).</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <span class="keywordflow">if</span> (recoOpt-&gt;fColorSpacePointsByChisq) {</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        spcolor = 100 - 2.5 * pspt-&gt;Chisq();</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        <span class="keywordflow">if</span> (spcolor &lt; 51) spcolor = 51;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        <span class="keywordflow">if</span> (spcolor &gt; 100) spcolor = 100;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      }</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      spmap[spcolor].push_back(pspt);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    <span class="comment">// Loop over colors.</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <span class="comment">// Note that larger (=better) space points are plotted on</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="comment">// top for optimal visibility.</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> icolor : spmap) {</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      <span class="keywordtype">int</span> spcolor = icolor.first;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; psps = icolor.second;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      <span class="comment">// Make and fill a polymarker.</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      TPolyMarker&amp; pm = view-&gt;AddPolyMarker(psps.size(), spcolor, kFullCircle, msize);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = 0; <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> &lt; psps.size(); ++<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>) {</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a>&amp; spt = *psps[<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>];</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>* xyz = spt.<a class="code" href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">XYZ</a>();</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;        <span class="keywordflow">switch</span> (proj) {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>: pm.SetPoint(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, xyz[0], xyz[1]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>: pm.SetPoint(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, xyz[2], xyz[0]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>: pm.SetPoint(<a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a>, xyz[2], xyz[1]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;          <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;            &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot;: unknown projection #&quot;</span> &lt;&lt; ((int)proj) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        } <span class="comment">// switch</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;      }</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    }</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  }</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aef3884624866ecc5440b976b7ebd58e8"> 3572</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aef3884624866ecc5440b976b7ebd58e8">RecoBaseDrawer::DrawTrackOrtho</a>(<span class="keyword">const</span> <a class="code" href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a>&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>,</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                                 <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                                 <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                                 <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                                 evdb::View2D* view)</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  {</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <span class="comment">// Get options.</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTrackSpacePoints) {</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <span class="comment">// Use brute force to find the module label and index of this</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <span class="comment">// track, so that we can find associated space points and draw</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <span class="comment">// them.</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <span class="keyword">const</span> art::Event* <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a> = evdb::EventHolder::Instance()-&gt;GetEvent();</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      <span class="comment">//std::vector&lt;art::Handle&lt;std::vector&lt;recob::Track&gt;&gt;&gt; handles;</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      <span class="comment">//evt-&gt;getManyByType(handles);</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="keyword">auto</span> handles = evt-&gt;getMany&lt;std::vector&lt;recob::Track&gt;&gt;();</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ih : handles) {</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        <span class="keyword">const</span> art::Handle&lt;std::vector&lt;recob::Track&gt;&gt; handle = ih;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;        <span class="keywordflow">if</span> (handle.isValid()) {</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;          <span class="keyword">const</span> std::string&amp; which = handle.provenance()-&gt;moduleLabel();</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;          art::FindManyP&lt;recob::SpacePoint&gt; fmsp(handle, *evt, which);</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;          <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = handle-&gt;size();</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            art::Ptr&lt;recob::Track&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>(handle, i);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            <span class="keywordflow">if</span> (&amp;*p == &amp;track) {</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;              std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts = fmsp.at(i);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;              <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1">DrawSpacePointOrtho</a>(spts, color, proj, msize, view);</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;            }</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          }</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;        }</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      }</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    }</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTrackTrajectoryPoints) {</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      <span class="comment">// Draw trajectory points.</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="keywordtype">int</span> np = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a9128436d1a2465fc9f5393898b6fa236">NumberTrajectoryPoints</a>();</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      <span class="keywordtype">int</span> vp = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0baed39cc12dfe2586761840d31fc225">CountValidPoints</a>();</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      <span class="comment">// Make and fill a polymarker.</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      TPolyMarker&amp; pm =</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        view-&gt;AddPolyMarker(vp, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>], kFullCircle, msize);</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      TPolyLine&amp; pl = view-&gt;AddPolyLine(vp, <a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[color % evd::kNCOLS], 2, 0);</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; np; ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;        <span class="keywordflow">if</span> (track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">HasValidPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pos = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">LocationAtPoint</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;        <span class="keywordflow">switch</span> (proj) {</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>:</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;          pm.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.X(), pos.Y());</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;          pl.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.X(), pos.Y());</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>:</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;          pm.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.Z(), pos.X());</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;          pl.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.Z(), pos.X());</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>:</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;          pm.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.Z(), pos.Y());</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;          pl.SetPoint(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>, pos.Z(), pos.Y());</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;          <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot;: unknown projection #&quot;</span> &lt;&lt; ((int)proj) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;        } <span class="comment">// switch</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;      }   <span class="comment">// p</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      <span class="comment">// BB: draw the track ID at the end of the track</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      <span class="keywordflow">if</span> (recoOpt-&gt;fDrawTracks &gt; 1) {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        <span class="keywordtype">int</span> tid =</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;          track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#ab0d5a4fa186436915e63a4d54ca407fa">ID</a>() &amp;</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;          65535; <span class="comment">//this is a hack for PMA track id which uses the 16th bit to identify shower-like track.</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;        std::string <a class="code" href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a> = <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(tid);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        <span class="keywordtype">char</span> <span class="keyword">const</span>* txt = s.c_str();</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a3ec5be13d5a39d2e3ec55480b64250e3">End</a>().X();</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a> = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a3ec5be13d5a39d2e3ec55480b64250e3">End</a>().Y();</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a> = track.<a class="code" href="../../d9/dca/classrecob_1_1Track.html#a3ec5be13d5a39d2e3ec55480b64250e3">End</a>().Z();</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>) {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;          TText&amp; trkID = view-&gt;AddText(x, y, txt);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;          trkID.SetTextColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[tid % evd::kNCOLS]);</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;          trkID.SetTextSize(0.03);</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        }</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>) {</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;          TText&amp; trkID = view-&gt;AddText(z, x, txt);</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;          trkID.SetTextColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[tid % evd::kNCOLS]);</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;          trkID.SetTextSize(0.03);</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;        }</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (proj == <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>) {</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;          TText&amp; trkID = view-&gt;AddText(z, y, txt);</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;          trkID.SetTextColor(<a class="code" href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a>[tid % evd::kNCOLS]);</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;          trkID.SetTextSize(0.03);</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        } <span class="comment">// proj</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;      }   <span class="comment">// recoOpt-&gt;fDrawTracks &gt; 1</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    }</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  }</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2b1e161580991e48fad66303333b96b"> 3675</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2b1e161580991e48fad66303333b96b">RecoBaseDrawer::DrawShowerOrtho</a>(<span class="keyword">const</span> <a class="code" href="../../d4/d14/classrecob_1_1Shower.html">recob::Shower</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>,</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                                  <span class="keywordtype">int</span> color,</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;                                  <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a> proj,</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;                                  <span class="keywordtype">double</span> msize,</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                                  evdb::View2D* view)</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  {</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    <span class="comment">// Use brute force to find the module label and index of this</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    <span class="comment">// shower, so that we can find associated space points and draw</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="comment">// them.</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    <span class="keyword">const</span> art::Event* <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a> = evdb::EventHolder::Instance()-&gt;GetEvent();</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <span class="comment">//std::vector&lt;art::Handle&lt;std::vector&lt;recob::Shower&gt;&gt;&gt; handles;</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <span class="comment">//evt-&gt;getManyByType(handles);</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    <span class="keyword">auto</span> handles = evt-&gt;getMany&lt;std::vector&lt;recob::Shower&gt;&gt;();</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> ih : handles) {</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      <span class="keyword">const</span> art::Handle&lt;std::vector&lt;recob::Shower&gt;&gt; handle = ih;</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      <span class="keywordflow">if</span> (handle.isValid()) {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        <span class="keyword">const</span> std::string&amp; which = handle.provenance()-&gt;moduleLabel();</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;        art::FindManyP&lt;recob::SpacePoint&gt; fmsp(handle, *evt, which);</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;        <span class="keywordflow">if</span> (!fmsp.isValid()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = handle-&gt;size();</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;          art::Ptr&lt;recob::Shower&gt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>(handle, i);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;          <span class="keywordflow">if</span> (&amp;*p == &amp;shower) {</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;            <span class="keywordflow">switch</span> (proj) {</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a>:</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;              view-&gt;AddMarker(p-&gt;ShowerStart().X(),</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                              p-&gt;ShowerStart().Y(),</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                              <a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>],</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                              5,</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                              2.0);</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a>:</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;              view-&gt;AddMarker(p-&gt;ShowerStart().Z(),</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                              p-&gt;ShowerStart().X(),</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                              <a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>],</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                              5,</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;                              2.0);</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a>:</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;              view-&gt;AddMarker(p-&gt;ShowerStart().Z(),</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                              p-&gt;ShowerStart().Y(),</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                              <a class="code" href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a>[color % <a class="code" href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a>],</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                              5,</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                              2.0);</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;              <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;RecoBaseDrawer&quot;</span>)</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot;: unknown projection #&quot;</span> &lt;&lt; ((int)proj) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;            } <span class="comment">// switch</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;            <span class="keywordflow">if</span> (fmsp.isValid()) {</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;              std::vector&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt; spts = fmsp.at(i);</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;              <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1">DrawSpacePointOrtho</a>(spts, color, proj, msize, view, 1);</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            }</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;          }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        }</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;  }</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9"> 3740</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">RecoBaseDrawer::GetWires</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;                           <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;                           art::PtrVector&lt;recob::Wire&gt;&amp; wires)</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  {</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    wires.clear();</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    art::Handle&lt;std::vector&lt;recob::Wire&gt;&gt; wcol;</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    art::PtrVector&lt;recob::Wire&gt; temp;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;      evt.getByLabel(which, wcol);</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; wcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        art::Ptr&lt;recob::Wire&gt; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>(wcol, i);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        temp.push_back(w);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      }</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      temp.swap(wires);</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    }</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetWires&quot;</span>, e);</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    }</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    <span class="keywordflow">return</span> wires.size();</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  }</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6a602cd2b200227e5d3bb462601fb57a"> 3767</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6a602cd2b200227e5d3bb462601fb57a">RecoBaseDrawer::GetHits</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;                          <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                          std::vector&lt;const recob::Hit*&gt;&amp; hits,</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  {</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    hits.clear();</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;    std::vector&lt;const recob::Hit*&gt; temp;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      evt.getView(which, temp);</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> : temp) {</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <span class="comment">// Note that the WireID in the hit object is useless for those detectors where a channel can correspond to</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        <span class="comment">// more than one plane/wire. So our plan is to recover the list of wire IDs from the channel number and</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        <span class="comment">// loop over those (if there are any)</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        <span class="keyword">const</span> std::vector&lt;geo::WireID&gt;&amp; wireIDs = geo-&gt;ChannelToWire(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>-&gt;Channel());</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        <span class="comment">// Loop to find match</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; wireID : wireIDs) {</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;          <span class="keywordflow">if</span> (wireID.Plane == plane &amp;&amp; wireID.TPC == rawOpt-&gt;fTPC &amp;&amp;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;              wireID.Cryostat == rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            hits.push_back(<a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a>);</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      }</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    }</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetHits&quot;</span>, e);</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    <span class="keywordflow">return</span> hits.size();</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;  }</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a93222627e36c5913a7aed3ade5c68f3d"> 3804</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a93222627e36c5913a7aed3ade5c68f3d">RecoBaseDrawer::GetSlices</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                            <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                            art::PtrVector&lt;recob::Slice&gt;&amp; <a class="code" href="../../de/d0f/namespacetca.html#a0898183aa6813a6ab2cbaede7d31e4d1">slices</a>)</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;  {</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    slices.clear();</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    art::PtrVector&lt;recob::Slice&gt; temp;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;    art::Handle&lt;std::vector&lt;recob::Slice&gt;&gt; slcCol;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      evt.getByLabel(which, slcCol);</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      temp.reserve(slcCol-&gt;size());</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; slcCol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        art::Ptr&lt;recob::Slice&gt; slc(slcCol, i);</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        temp.push_back(slc);</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;      }</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;      temp.swap(slices);</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;    }</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetSlices&quot;</span>, e);</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    }</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    <span class="keywordflow">return</span> slices.size();</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  }</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ace0bb80462a10ee526f5aaefb70b8415"> 3831</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ace0bb80462a10ee526f5aaefb70b8415">RecoBaseDrawer::GetClusters</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                              <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                              art::PtrVector&lt;recob::Cluster&gt;&amp; clust)</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  {</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;    clust.clear();</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;    art::PtrVector&lt;recob::Cluster&gt; temp;</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;    art::Handle&lt;std::vector&lt;recob::Cluster&gt;&gt; clcol;</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      evt.getByLabel(which, clcol);</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      temp.reserve(clcol-&gt;size());</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; clcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;        art::Ptr&lt;recob::Cluster&gt; cl(clcol, i);</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        temp.push_back(cl);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      }</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      temp.swap(clust);</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    }</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetClusters&quot;</span>, e);</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;    }</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;    <span class="keywordflow">return</span> clust.size();</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa33c29aecd1e81defa8d5c729d4da9c5"> 3858</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa33c29aecd1e81defa8d5c729d4da9c5">RecoBaseDrawer::GetPFParticles</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                                 <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                                 art::PtrVector&lt;recob::PFParticle&gt;&amp; clust)</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;  {</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    clust.clear();</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;    art::PtrVector&lt;recob::PFParticle&gt; temp;</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    art::Handle&lt;std::vector&lt;recob::PFParticle&gt;&gt; clcol;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      evt.getByLabel(which, clcol);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; clcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        art::Ptr&lt;recob::PFParticle&gt; cl(clcol, i);</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        temp.push_back(cl);</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;      }</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      temp.swap(clust);</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    }</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetPFParticles&quot;</span>, e);</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    }</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <span class="keywordflow">return</span> clust.size();</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;  }</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7aefd268b12e72bb9b50f772434e2e46"> 3884</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7aefd268b12e72bb9b50f772434e2e46">RecoBaseDrawer::GetEndPoint2D</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                                <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                                art::PtrVector&lt;recob::EndPoint2D&gt;&amp; ep2d)</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;  {</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    ep2d.clear();</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    art::PtrVector&lt;recob::EndPoint2D&gt; temp;</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    art::Handle&lt;std::vector&lt;recob::EndPoint2D&gt;&gt; epcol;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      evt.getByLabel(which, epcol);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; epcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        art::Ptr&lt;recob::EndPoint2D&gt; ep(epcol, i);</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;        temp.push_back(ep);</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      }</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      temp.swap(ep2d);</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    }</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetEndPoint2D&quot;</span>, e);</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    }</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    <span class="keywordflow">return</span> ep2d.size();</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;  }</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab023442ffe9c0c0b6129119af1cb2a88"> 3911</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab023442ffe9c0c0b6129119af1cb2a88">RecoBaseDrawer::GetOpFlashes</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                               <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                               art::PtrVector&lt;recob::OpFlash&gt;&amp; opflashes)</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;  {</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;    opflashes.clear();</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    art::PtrVector&lt;recob::OpFlash&gt; temp;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    art::Handle&lt;std::vector&lt;recob::OpFlash&gt;&gt; opflashcol;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      evt.getByLabel(which, opflashcol);</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; opflashcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        art::Ptr&lt;recob::OpFlash&gt; opf(opflashcol, i);</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        temp.push_back(opf);</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      }</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;      temp.swap(opflashes);</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    }</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetOpFlashes&quot;</span>, e);</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    }</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    <span class="keywordflow">return</span> opflashes.size();</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  }</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0"> 3938</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0">RecoBaseDrawer::GetSeeds</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                           <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                           art::PtrVector&lt;recob::Seed&gt;&amp; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>)</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;  {</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    seeds.clear();</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    art::PtrVector&lt;recob::Seed&gt; temp;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    art::Handle&lt;std::vector&lt;recob::Seed&gt;&gt; seedcol;</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      evt.getByLabel(which, seedcol);</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; seedcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        art::Ptr&lt;recob::Seed&gt; sd(seedcol, i);</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        temp.push_back(sd);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      }</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;      temp.swap(seeds);</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    }</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetSeeds&quot;</span>, e);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    }</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    <span class="keywordflow">return</span> seeds.size();</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  }</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653"> 3964</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">RecoBaseDrawer::GetSpacePoints</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;                                 <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                 <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::SpacePoint&gt;&gt;&amp; spts)</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  {</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    spts.clear();</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    art::Handle&lt;std::vector&lt;recob::SpacePoint&gt;&gt; spcol;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;    <span class="keywordflow">if</span> (evt.getByLabel(which, spcol)) art::fill_ptr_vector(spts, spcol);</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="keywordflow">return</span> spts.size();</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;  }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acd4bc8ec002beecf2f843077df96b70f"> 3977</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acd4bc8ec002beecf2f843077df96b70f">RecoBaseDrawer::GetEdges</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                           <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                           <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Edge&gt;&gt;&amp; edges)</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  {</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    edges.clear();</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    art::Handle&lt;std::vector&lt;recob::Edge&gt;&gt; edgeCol;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    evt.getByLabel(which, edgeCol);</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; edgeCol-&gt;size(); ++i)</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      edges.emplace_back(edgeCol, i);</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="keywordflow">return</span> edges.size();</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7"> 3995</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">RecoBaseDrawer::GetTracks</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;                            <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                            art::View&lt;recob::Track&gt;&amp; <a class="code" href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a>)</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      evt.getView(which, track);</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    }</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetTracks&quot;</span>, e);</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    }</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="keywordflow">return</span> track.vals().size();</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  }</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4"> 4011</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4">RecoBaseDrawer::GetShowers</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;                             <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;                             art::View&lt;recob::Shower&gt;&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a>)</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      evt.getView(which, shower);</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    }</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetShowers&quot;</span>, e);</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    }</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <span class="keywordflow">return</span> shower.vals().size();</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  }</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e"> 4027</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e">RecoBaseDrawer::GetVertices</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                              <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                              art::PtrVector&lt;recob::Vertex&gt;&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a>)</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  {</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    vertex.clear();</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    art::PtrVector&lt;recob::Vertex&gt; temp;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    art::Handle&lt;std::vector&lt;recob::Vertex&gt;&gt; vcol;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      evt.getByLabel(which, vcol);</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; vcol-&gt;size(); ++i) {</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        art::Ptr&lt;recob::Vertex&gt; v(vcol, i);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        temp.push_back(v);</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      }</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      temp.swap(vertex);</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetVertices&quot;</span>, e);</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    }</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <span class="keywordflow">return</span> vertex.size();</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;  }</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab80f3650b8b09d1583b9f79f052e5f3f"> 4053</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab80f3650b8b09d1583b9f79f052e5f3f">RecoBaseDrawer::GetEvents</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                            <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                            art::PtrVector&lt;recob::Event&gt;&amp; event)</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  {</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="keyword">event</span>.clear();</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    art::PtrVector&lt;recob::Event&gt; temp;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    art::Handle&lt;std::vector&lt;recob::Event&gt;&gt; ecol;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;      evt.getByLabel(which, ecol);</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ecol-&gt;size(); ++i) {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        art::Ptr&lt;recob::Event&gt; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>(ecol, i);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        temp.push_back(e);</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      }</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;      temp.swap(event);</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    }</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;      writeErrMsg(<span class="stringliteral">&quot;GetEvents&quot;</span>, e);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    }</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">event</span>.size();</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  }</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae60bfd9ea65492c03832839dc1319673"> 4079</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae60bfd9ea65492c03832839dc1319673">RecoBaseDrawer::CountHits</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                            <span class="keyword">const</span> art::InputTag&amp; which,</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cryostat,</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc,</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane)</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  {</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    std::vector&lt;const recob::Hit*&gt; temp;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <span class="keywordtype">int</span> NumberOfHitsBeforeThisPlane = 0;</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    evt.getView(</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      which,</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      temp); <span class="comment">//temp.size() = total number of hits for this event (number of all hits in all Cryostats, TPC&#39;s, planes and wires)</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; temp.size(); ++t) {</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      <span class="keywordflow">if</span> (temp[t]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat == cryostat &amp;&amp; temp[t]-&gt;WireID().TPC == tpc &amp;&amp;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;          temp[t]-&gt;WireID().Plane == plane)</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      NumberOfHitsBeforeThisPlane++;</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    }</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    <span class="keywordflow">return</span> NumberOfHitsBeforeThisPlane;</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  }</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a3b2fed71b7c2c859a737db1fdf942267"> 4101</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a3b2fed71b7c2c859a737db1fdf942267">RecoBaseDrawer::FillTQHisto</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane,</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire,</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;                              TH1F* histo)</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  {</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    <span class="keywordtype">float</span> minSig(std::numeric_limits&lt;float&gt;::max());</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    <span class="keywordtype">float</span> maxSig(std::numeric_limits&lt;float&gt;::lowest());</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    <span class="keywordtype">bool</span> setLimits(<span class="keyword">false</span>);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    <span class="comment">// Check if we&#39;re supposed to draw raw hits at all</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fWireLabels.size(); ++imod) {</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fWireLabels[imod];</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      art::PtrVector&lt;recob::Wire&gt; wires;</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">GetWires</a>(evt, which, wires);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; wires.size(); ++i) {</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;        std::vector&lt;geo::WireID&gt; wireids = geo-&gt;ChannelToWire(wires[i]-&gt;Channel());</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        <span class="keywordtype">bool</span> goodWID = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; wid : wireids) {</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;          <span class="comment">// check for correct plane, wire and tpc</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;          <span class="keywordflow">if</span> (wid.Plane == plane &amp;&amp; wid.Wire == wire &amp;&amp; wid.TPC == rawOpt-&gt;fTPC &amp;&amp;</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;              wid.Cryostat == rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;            goodWID = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;        }</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;        <span class="keywordflow">if</span> (!goodWID) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        std::vector&lt;float&gt; wirSig = wires[i]-&gt;Signal();</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; wirSig.size(); ++ii) {</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;          <span class="comment">//                histo-&gt;SetLineColor(imod+4);</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;          <span class="comment">//                histo-&gt;Fill(1.*ii, wirSig[ii]);</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;          minSig = std::min(minSig, wirSig[ii]);</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;          maxSig = std::max(maxSig, wirSig[ii]);</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;        setLimits = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;      } <span class="comment">//end loop over wires</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    }   <span class="comment">//end loop over wire modules</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;    <span class="keywordflow">if</span> (setLimits) {</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      histo-&gt;SetMaximum(1.2 * maxSig);</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;      histo-&gt;SetMinimum(1.2 * minSig);</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    }</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;  }</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a85a02e64d2ef3f9d9930e7e658f2ded5"> 4158</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a85a02e64d2ef3f9d9930e7e658f2ded5">RecoBaseDrawer::FillQHisto</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane, TH1F* histo)</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;  {</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    <span class="comment">// Check if we&#39;re supposed to draw raw hits at all</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fWireLabels.size(); ++imod) {</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fWireLabels[imod];</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;      art::PtrVector&lt;recob::Wire&gt; wires;</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">GetWires</a>(evt, which, wires);</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; wires.size(); ++i) {</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;        std::vector&lt;geo::WireID&gt; wireids = geo-&gt;ChannelToWire(wires[i]-&gt;Channel());</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;        <span class="keywordtype">bool</span> goodWID = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; wid : wireids) {</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;          <span class="comment">// check for correct plane, wire and tpc</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;          <span class="keywordflow">if</span> (wid.Plane == plane &amp;&amp; wid.TPC == rawOpt-&gt;fTPC &amp;&amp; wid.Cryostat == rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;            goodWID = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        }</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        <span class="keywordflow">if</span> (!goodWID) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        std::vector&lt;float&gt; wirSig = wires[i]-&gt;Signal();</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; wirSig.size(); ++ii)</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;          histo-&gt;Fill(wirSig[ii]);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="comment">        for(size_t s = 0; s &lt; wires[i]-&gt;NSignal(); ++s)</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="comment">          histo-&gt;Fill(wires[i]-&gt;Signal()[s]);</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;      } <span class="comment">//end loop over raw hits</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    }   <span class="comment">//end loop over Wire modules</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  }</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"><a class="line" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4e85acba3f9a728dd7e9ac8d2268d6d9"> 4200</a></span>&#160;  <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4e85acba3f9a728dd7e9ac8d2268d6d9">RecoBaseDrawer::FillTQHistoDP</a>(<span class="keyword">const</span> art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>,</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane,</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire,</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                                TH1F* histo,</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                                std::vector&lt;double&gt;&amp; htau1,</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                                std::vector&lt;double&gt;&amp; htau2,</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                                std::vector&lt;double&gt;&amp; hitamplitudes,</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                std::vector&lt;double&gt;&amp; hpeaktimes,</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                                std::vector&lt;int&gt;&amp; hstartT,</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                                std::vector&lt;int&gt;&amp; hendT,</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                                std::vector&lt;int&gt;&amp; hNMultiHit,</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                std::vector&lt;int&gt;&amp; hLocalHitIndex)</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  {</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    art::ServiceHandle&lt;evd::RawDrawingOptions const&gt; rawOpt;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    art::ServiceHandle&lt;evd::RecoDrawingOptions const&gt; recoOpt;</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    art::ServiceHandle&lt;geo::Geometry const&gt; geo;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    <span class="comment">// Check if we&#39;re supposed to draw raw hits at all</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    <span class="keywordflow">if</span> (rawOpt-&gt;fDrawRawDataOrCalibWires == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fWireLabels.size(); ++imod) {</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fWireLabels[imod];</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;      art::PtrVector&lt;recob::Wire&gt; wires;</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">GetWires</a>(evt, which, wires);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; wires.size(); ++i) {</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        std::vector&lt;geo::WireID&gt; wireids = geo-&gt;ChannelToWire(wires[i]-&gt;Channel());</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;        <span class="keywordtype">bool</span> goodWID = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; wid : wireids) {</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;          <span class="keywordflow">if</span> (wid.Plane == plane &amp;&amp; wid.Wire == wire &amp;&amp; wid.TPC == rawOpt-&gt;fTPC &amp;&amp;</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;              wid.Cryostat == rawOpt-&gt;fCryostat)</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;            goodWID = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        }</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        <span class="keywordflow">if</span> (!goodWID) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        std::vector&lt;float&gt; wirSig = wires[i]-&gt;Signal();</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; wirSig.size(); ++ii)</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;          histo-&gt;Fill(1. * ii, wirSig[ii]);</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      } <span class="comment">//end loop over wires</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    }   <span class="comment">//end loop over wire modules</span></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imod = 0; imod &lt; recoOpt-&gt;fHitLabels.size(); ++imod) {</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;      art::InputTag <span class="keyword">const</span> which = recoOpt-&gt;fHitLabels[imod];</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      std::vector&lt;const recob::Hit*&gt; hits;</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      this-&gt;<a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6a602cd2b200227e5d3bb462601fb57a">GetHits</a>(evt, which, hits, plane);</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;      <span class="keyword">auto</span> hitResults = <a class="code" href="../../d8/df4/classanab_1_1FVectorReader.html#a6c242378ee12dc9efb6272ce2b728864">anab::FVectorReader&lt;recob::Hit, 4&gt;::create</a>(evt, <span class="stringliteral">&quot;dprawhit&quot;</span>);</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; fitParams = hitResults-&gt;vectors();</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      <span class="keywordtype">int</span> FitParamsOffset = <a class="code" href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae60bfd9ea65492c03832839dc1319673">CountHits</a>(evt, which, rawOpt-&gt;fCryostat, rawOpt-&gt;fTPC, plane);</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; hits.size(); ++i) {</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        <span class="comment">// check for correct wire. Plane, cryostat and tpc were checked in GetHits</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <span class="keywordflow">if</span> (hits[i]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Wire != wire) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        hpeaktimes.push_back(fitParams[FitParamsOffset + i][0]);</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        htau1.push_back(fitParams[FitParamsOffset + i][1]);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;        htau2.push_back(fitParams[FitParamsOffset + i][2]);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        hitamplitudes.push_back(fitParams[FitParamsOffset + i][3]);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        hstartT.push_back(hits[i]-&gt;<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a>());</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;        hendT.push_back(hits[i]-&gt;EndTick());</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        hNMultiHit.push_back(hits[i]-&gt;Multiplicity());</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        hLocalHitIndex.push_back(hits[i]-&gt;LocalIndex());</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      } <span class="comment">//end loop over reco hits</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    }   <span class="comment">//end loop over HitFinding modules</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  }</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <span class="comment">//double RecoBaseDrawer::EvalExpoFit(double x,</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;  <span class="comment">//                               double tau1,</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;  <span class="comment">//                               double tau2,</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;  <span class="comment">//                               double amplitude,</span></div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  <span class="comment">//                               double peaktime)</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <span class="comment">//{</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  <span class="comment">//return (amplitude * exp(0.4*(x-peaktime)/tau1) / ( 1 + exp(0.4*(x-peaktime)/tau2) ) );</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;  <span class="comment">//......................................................................</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  <span class="comment">//double RecoBaseDrawer::EvalMultiExpoFit(double x,</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  <span class="comment">//                                    int HitNumber,</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;  <span class="comment">//                                    int NHits,</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;  <span class="comment">//                                    std::vector&lt;double&gt; tau1,</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  <span class="comment">//                                    std::vector&lt;double&gt; tau2,</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;  <span class="comment">//                                    std::vector&lt;double&gt; amplitude,</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <span class="comment">//                                    std::vector&lt;double&gt; peaktime)</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  <span class="comment">//{</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  <span class="comment">//    double x_sum = 0.;</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;  <span class="comment">//    for(int i = HitNumber; i &lt; HitNumber+NHits; i++)</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  <span class="comment">//    {</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;  <span class="comment">//    x_sum += (amplitude[i] * exp(0.4*(x-peaktime[i])/tau1[i]) / ( 1 + exp(0.4*(x-peaktime[i])/tau2[i]) ) );</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <span class="comment">//    }</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  <span class="comment">//return x_sum;</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;} <span class="comment">// namespace evd</span><span class="comment"></span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a2f805d3ed7b4ef3143d780ba32d0a81c"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2f805d3ed7b4ef3143d780ba32d0a81c">evd::RecoBaseDrawer::fSpacePointDrawer</a></div><div class="ttdeci">ISpacePointDrawerPtr fSpacePointDrawer</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00327">RecoBaseDrawer.h:327</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ad258c88a6ba00baa7494c561e048c2d7"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad258c88a6ba00baa7494c561e048c2d7">evd::RecoBaseDrawer::SpacePointOrtho</a></div><div class="ttdeci">void SpacePointOrtho(const art::Event &amp;evt, evd::OrthoProj_t proj, double msize, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03123">RecoBaseDrawer.cxx:3123</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_a2e91c077dea2ff30aae790c67de81ea2"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#a2e91c077dea2ff30aae790c67de81ea2">vertex</a></div><div class="ttdeci">process_name vertex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ac2b1e161580991e48fad66303333b96b"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2b1e161580991e48fad66303333b96b">evd::RecoBaseDrawer::DrawShowerOrtho</a></div><div class="ttdeci">void DrawShowerOrtho(const recob::Shower &amp;shower, int color, evd::OrthoProj_t proj, double msize, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03675">RecoBaseDrawer.cxx:3675</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a39914e49813de128adf2932d191a6712"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a39914e49813de128adf2932d191a6712">evd::RecoBaseDrawer::SpacePoint3D</a></div><div class="ttdeci">void SpacePoint3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01986">RecoBaseDrawer.cxx:1986</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_ae40184b0245025a43c56daa3261d5e3c"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#ae40184b0245025a43c56daa3261d5e3c">z</a></div><div class="ttdeci">process_name opflash particleana ie ie ie z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00092">run_opflash_electron.fcl:92</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a0556a5a876ab091cfc3a00585f65d1f7"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0556a5a876ab091cfc3a00585f65d1f7">evd::RecoBaseDrawer::GetTracks</a></div><div class="ttdeci">int GetTracks(const art::Event &amp;evt, const art::InputTag &amp;which, art::View&lt; recob::Track &gt; &amp;track)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03995">RecoBaseDrawer.cxx:3995</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_aca509cf9eb38370c75f173f769e56fd9"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aca509cf9eb38370c75f173f769e56fd9">evd::RecoBaseDrawer::fRawCharge</a></div><div class="ttdeci">std::vector&lt; double &gt; fRawCharge</div><div class="ttdoc">Sum of Raw Charge. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00334">RecoBaseDrawer.h:334</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a3b2fed71b7c2c859a737db1fdf942267"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a3b2fed71b7c2c859a737db1fdf942267">evd::RecoBaseDrawer::FillTQHisto</a></div><div class="ttdeci">void FillTQHisto(const art::Event &amp;evt, unsigned int plane, unsigned int wire, TH1F *histo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04101">RecoBaseDrawer.cxx:4101</a></div></div>
<div class="ttc" id="ISpacePoints3D_8h_html"><div class="ttname"><a href="../../d1/d55/ISpacePoints3D_8h.html">ISpacePoints3D.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a0b824162860b687bc88cfe97c048437d"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a0b824162860b687bc88cfe97c048437d">evd::RecoBaseDrawer::PFParticleOrtho</a></div><div class="ttdeci">void PFParticleOrtho(const art::Event &amp;evt, evd::OrthoProj_t proj, double msize, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03154">RecoBaseDrawer.cxx:3154</a></div></div>
<div class="ttc" id="build-larbase-py2_8sh_html_af6b3895e39ae33d4633d338ed2ddf9e3"><div class="ttname"><a href="../../d9/d76/build-larbase-py2_8sh.html#af6b3895e39ae33d4633d338ed2ddf9e3">labels</a></div><div class="ttdeci">* labels</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d76/build-larbase-py2_8sh_source.html#l00059">build-larbase-py2.sh:59</a></div></div>
<div class="ttc" id="namespacelariov_1_1DataSource_html_a9877bcd384b60abd8cbe121d11f43b5b"><div class="ttname"><a href="../../d9/d69/namespacelariov_1_1DataSource.html#a9877bcd384b60abd8cbe121d11f43b5b">lariov::DataSource::ds</a></div><div class="ttdeci">ds</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dca/IOVDataConstants_8h_source.html#l00015">IOVDataConstants.h:15</a></div></div>
<div class="ttc" id="Edge_8h_html"><div class="ttname"><a href="../../d5/de0/Edge_8h.html">Edge.h</a></div><div class="ttdoc">An object to define a &amp;quot;edge&amp;quot; which is used to connect space points in a triangulation algorithm...</div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a5a02fec244ed9b665033a5a1173915ee"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5a02fec244ed9b665033a5a1173915ee">evd::RecoBaseDrawer::DrawProng2D</a></div><div class="ttdeci">void DrawProng2D(detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; const recob::Hit * &gt; &amp;hits, evdb::View2D *view, unsigned int plane, TVector3 const &amp;startPos, TVector3 const &amp;startDir, int id, float cscore=-5)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01232">RecoBaseDrawer.cxx:1232</a></div></div>
<div class="ttc" id="rawdigitfilter__icarus_8fcl_html_aa2b9cfdf9a8f294302be0cdf6affea22"><div class="ttname"><a href="../../d6/d5e/rawdigitfilter__icarus_8fcl.html#aa2b9cfdf9a8f294302be0cdf6affea22">Plane</a></div><div class="ttdeci">BEGIN_PROLOG true icarus_rawdigitfilter FilterTools FilterPlane1 Plane</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5e/rawdigitfilter__icarus_8fcl_source.html#l00008">rawdigitfilter_icarus.fcl:8</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_a35e5c47d5dd67e3d1226f060e610ff65"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#a35e5c47d5dd67e3d1226f060e610ff65">recob::Shower::has_length</a></div><div class="ttdeci">bool has_length() const </div><div class="ttdoc">Returns whether the shower has a valid length. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00211">Shower.h:211</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a82a23a008fc0616b5f8b3c6d685d4558"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a82a23a008fc0616b5f8b3c6d685d4558">evd::RecoBaseDrawer::fAllSpacePointDrawer</a></div><div class="ttdeci">ISpacePointDrawerPtr fAllSpacePointDrawer</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00326">RecoBaseDrawer.h:326</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a5204d4188eee282d2235cd231d828bd2"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a></div><div class="ttdeci">ClusterModuleLabel join with tracks</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00056">trackfinderalgorithms.fcl:56</a></div></div>
<div class="ttc" id="PFParticle_8h_html"><div class="ttname"><a href="../../d8/d5c/PFParticle_8h.html">PFParticle.h</a></div></div>
<div class="ttc" id="CryostatGeo_8h_html"><div class="ttname"><a href="../../df/d13/CryostatGeo_8h.html">CryostatGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single cyostat. </div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classlariov_1_1ChannelStatusProvider_html_abda9787c4790d2e8a5cfbd5d3a806fb1"><div class="ttname"><a href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html#abda9787c4790d2e8a5cfbd5d3a806fb1">lariov::ChannelStatusProvider::IsBad</a></div><div class="ttdeci">virtual bool IsBad(raw::ChannelID_t channel) const =0</div><div class="ttdoc">Returns whether the specified channel is bad in the current run. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_adbd5182f0115106ccdaa84b12a4108e0"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adbd5182f0115106ccdaa84b12a4108e0">evd::RecoBaseDrawer::Prong3D</a></div><div class="ttdeci">void Prong3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02560">RecoBaseDrawer.cxx:2560</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a8d3d943de6e7a164ef2606026e1e7d56"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8d3d943de6e7a164ef2606026e1e7d56">evd::RecoBaseDrawer::SpacePointChiSq</a></div><div class="ttdeci">float SpacePointChiSq(const std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02112">RecoBaseDrawer.cxx:2112</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ac2003879d584c11e1ef8d5189caba068"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac2003879d584c11e1ef8d5189caba068">evd::RecoBaseDrawer::DrawPFParticle3D</a></div><div class="ttdeci">void DrawPFParticle3D(const art::Ptr&lt; recob::PFParticle &gt; &amp;pfPart, const art::PtrVector&lt; recob::PFParticle &gt; &amp;pfParticleVec, const std::vector&lt; art::Ptr&lt; recob::SpacePoint &gt;&gt; &amp;spacePointVec, const art::FindManyP&lt; recob::Edge &gt; &amp;edgeAssnsVec, const art::FindManyP&lt; recob::SpacePoint &gt; &amp;spacePointAssnsVec, const art::FindManyP&lt; recob::SpacePoint &gt; &amp;edgeSPAssnVec, const art::FindManyP&lt; recob::Hit &gt; &amp;spHitAssnVec, const art::FindMany&lt; recob::Track &gt; &amp;trackAssnVec, const art::FindMany&lt; recob::PCAxis &gt; &amp;pcAxisAssnVec, const art::FindMany&lt; anab::CosmicTag &gt; &amp;cosmicTagAssnVec, int depth, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02158">RecoBaseDrawer.cxx:2158</a></div></div>
<div class="ttc" id="namespacegeo_html_a6baec40eaf3ff161f7eb1a5f0779794f"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6baec40eaf3ff161f7eb1a5f0779794f">geo::View_t</a></div><div class="ttdeci">enum geo::_plane_proj View_t</div><div class="ttdoc">Enumerate the possible plane projections. </div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ac7238622e359794ba201f5b978fec653"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ac7238622e359794ba201f5b978fec653">evd::RecoBaseDrawer::GetSpacePoints</a></div><div class="ttdeci">int GetSpacePoints(const art::Event &amp;evt, const art::InputTag &amp;which, std::vector&lt; art::Ptr&lt; recob::SpacePoint &gt;&gt; &amp;spts)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03964">RecoBaseDrawer.cxx:3964</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_aab70d56abcbcbda28f66353a7a92a588"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">detinfo::DetectorPropertiesData::GetXTicksOffset</a></div><div class="ttdeci">double GetXTicksOffset(int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00148">DetectorPropertiesData.cc:148</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ab323b58143fff95be3e1572324e182c2"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab323b58143fff95be3e1572324e182c2">evd::RecoBaseDrawer::SeedOrtho</a></div><div class="ttdeci">void SeedOrtho(const art::Event &amp;evt, evd::OrthoProj_t proj, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01926">RecoBaseDrawer.cxx:1926</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_ae4d84452d662dac7ddb3337803d02fcd"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#ae4d84452d662dac7ddb3337803d02fcd">recob::Shower::Direction</a></div><div class="ttdeci">const TVector3 &amp; Direction() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00189">Shower.h:189</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a0f79353d3ee5824fa80770901d1686a9"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a0f79353d3ee5824fa80770901d1686a9">recob::Track::LocationAtPoint</a></div><div class="ttdeci">Point_t const &amp; LocationAtPoint(size_t i) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00126">bj/lardataobj/RecoBase/Track.h:126</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_a55f7e431fda14081ca764a38a264506c"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#a55f7e431fda14081ca764a38a264506c">recob::Shower::has_open_angle</a></div><div class="ttdeci">bool has_open_angle() const </div><div class="ttdoc">Returns whether the shower has a valid opening angle. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00210">Shower.h:210</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_a9723da439d0c12ccbe2e4dc669c4cc99"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#a9723da439d0c12ccbe2e4dc669c4cc99">recob::Shower::dEdx</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; dEdx() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00203">Shower.h:203</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html">geo::PlaneID</a></div><div class="ttdoc">The data type to uniquely identify a Plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00472">geo_types.h:472</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a6f1dfd766acf1ad504dbc95e79c99229"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6f1dfd766acf1ad504dbc95e79c99229">evd::RecoBaseDrawer::Vertex3D</a></div><div class="ttdeci">void Vertex3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02857">RecoBaseDrawer.cxx:2857</a></div></div>
<div class="ttc" id="namespaceevd_html_a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823aa292a9baa847e99b0cf46f6b68d5d609">evd::kXY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc7/OrthoProj_8h_source.html#l00012">OrthoProj.h:12</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a98b528b4fd2230652784752e6842d1d8"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a98b528b4fd2230652784752e6842d1d8">recob::Track::HasValidPoint</a></div><div class="ttdeci">bool HasValidPoint(size_t i) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00111">bj/lardataobj/RecoBase/Track.h:111</a></div></div>
<div class="ttc" id="classanab_1_1CosmicTag_html"><div class="ttname"><a href="../../d1/d0e/classanab_1_1CosmicTag.html">anab::CosmicTag</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d86/CosmicTag_8h_source.html#l00036">CosmicTag.h:36</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a240c99ce3493c1129943b2a9d3aff1e4"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a240c99ce3493c1129943b2a9d3aff1e4">evd::RecoBaseDrawer::Event3D</a></div><div class="ttdeci">void Event3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02907">RecoBaseDrawer.cxx:2907</a></div></div>
<div class="ttc" id="classanab_1_1FVectorReader_html_a6c242378ee12dc9efb6272ce2b728864"><div class="ttname"><a href="../../d8/df4/classanab_1_1FVectorReader.html#a6c242378ee12dc9efb6272ce2b728864">anab::FVectorReader::create</a></div><div class="ttdeci">static std::unique_ptr&lt; FVectorReader &gt; create(const art::Event &amp;evt, const art::InputTag &amp;tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1b/MVAReader_8h_source.html#l00029">MVAReader.h:29</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a9128436d1a2465fc9f5393898b6fa236"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a9128436d1a2465fc9f5393898b6fa236">recob::Track::NumberTrajectoryPoints</a></div><div class="ttdeci">size_t NumberTrajectoryPoints() const </div><div class="ttdoc">Various functions related to the presence and the number of (valid) points. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00102">bj/lardataobj/RecoBase/Track.h:102</a></div></div>
<div class="ttc" id="decoderTools__icarus_8fcl_html_a354f38d9de96bb61d859209df29980d8"><div class="ttname"><a href="../../d5/d79/decoderTools__icarus_8fcl.html#a354f38d9de96bb61d859209df29980d8">StartTick</a></div><div class="ttdeci">BEGIN_PROLOG StartTick</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d79/decoderTools__icarus_8fcl_source.html#l00007">decoderTools_icarus.fcl:7</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_aa8edf54b2357ba4e9f19ff23a4880156"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#aa8edf54b2357ba4e9f19ff23a4880156">recob::Track::VertexDirection</a></div><div class="ttdeci">Vector_t VertexDirection() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00132">bj/lardataobj/RecoBase/Track.h:132</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_af39df3f291064ea41a036f6fc93be1fd"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af39df3f291064ea41a036f6fc93be1fd">evd::RecoBaseDrawer::ProngOrtho</a></div><div class="ttdeci">void ProngOrtho(const art::Event &amp;evt, evd::OrthoProj_t proj, double msize, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03450">RecoBaseDrawer.cxx:3450</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ace0bb80462a10ee526f5aaefb70b8415"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ace0bb80462a10ee526f5aaefb70b8415">evd::RecoBaseDrawer::GetClusters</a></div><div class="ttdeci">int GetClusters(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Cluster &gt; &amp;clust)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03831">RecoBaseDrawer.cxx:3831</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ad788a0a8bdf8d07a57432fc50650a378"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad788a0a8bdf8d07a57432fc50650a378">evd::RecoBaseDrawer::DrawShower3D</a></div><div class="ttdeci">void DrawShower3D(const recob::Shower &amp;shower, int color, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02750">RecoBaseDrawer.cxx:2750</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ac303d2971eb9697f3a65821bb92bb934"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">geo::WireID::Wire</a></div><div class="ttdeci">WireID_t Wire</div><div class="ttdoc">Index of the wire within its plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00580">geo_types.h:580</a></div></div>
<div class="ttc" id="namespaceevd_html_a949f4b5263e8cdfeb2ff35d942d75379"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a949f4b5263e8cdfeb2ff35d942d75379">evd::kNCOLS</a></div><div class="ttdeci">static const int kNCOLS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db5/eventdisplay_8h_source.html#l00010">eventdisplay.h:10</a></div></div>
<div class="ttc" id="standard__reco_8fcl_html_a8e7c4631bab825a68b0a82d8223c2ec2"><div class="ttname"><a href="../../df/df2/standard__reco_8fcl.html#a8e7c4631bab825a68b0a82d8223c2ec2">track</a></div><div class="ttdeci">process_name use argoneut_mc_hitfinder track</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df2/standard__reco_8fcl_source.html#l00036">standard_reco.fcl:36</a></div></div>
<div class="ttc" id="namespaceutil_html_a3bf4876cc648f293505a82b303ad1ad0"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a3bf4876cc648f293505a82b303ad1ad0">util.style</a></div><div class="ttdeci">def style</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5e/util_8py_source.html#l00237">util.py:237</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a4bdebfc96d83b4474ff41fef2cc47ea1"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4bdebfc96d83b4474ff41fef2cc47ea1">evd::RecoBaseDrawer::DrawSpacePointOrtho</a></div><div class="ttdeci">void DrawSpacePointOrtho(std::vector&lt; art::Ptr&lt; recob::SpacePoint &gt;&gt; &amp;spts, int color, evd::OrthoProj_t proj, double msize, evdb::View2D *view, int mode=0)</div><div class="ttdoc">0: track, 1: shower </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03504">RecoBaseDrawer.cxx:3504</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a97403b94ef044c188c9ac5bd640a7386"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a97403b94ef044c188c9ac5bd640a7386">evd::RecoBaseDrawer::Edge3D</a></div><div class="ttdeci">void Edge3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02453">RecoBaseDrawer.cxx:2453</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="namespaceevd_html_a6b471d71d8fab72f1eff49a8abec5823"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823">evd::OrthoProj_t</a></div><div class="ttdeci">OrthoProj_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc7/OrthoProj_8h_source.html#l00012">OrthoProj.h:12</a></div></div>
<div class="ttc" id="Seed_8h_html"><div class="ttname"><a href="../../de/d34/Seed_8h.html">Seed.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ab80f3650b8b09d1583b9f79f052e5f3f"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab80f3650b8b09d1583b9f79f052e5f3f">evd::RecoBaseDrawer::GetEvents</a></div><div class="ttdeci">int GetEvents(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Event &gt; &amp;event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04053">RecoBaseDrawer.cxx:4053</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a500d95aebfe430b6826e14b6a5733e1f"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a500d95aebfe430b6826e14b6a5733e1f">evd::RecoBaseDrawer::Prong2D</a></div><div class="ttdeci">void Prong2D(const art::Event &amp;evt, detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01391">RecoBaseDrawer.cxx:1391</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_ad36c739018def8e4e44032f4cf395c9d"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#ad36c739018def8e4e44032f4cf395c9d">shower</a></div><div class="ttdeci">process_name shower</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classanab_1_1CosmicTag_html_a2093a8d7c5b81f6c92ae72bcbeb209e3"><div class="ttname"><a href="../../d1/d0e/classanab_1_1CosmicTag.html#a2093a8d7c5b81f6c92ae72bcbeb209e3">anab::CosmicTag::CosmicScore</a></div><div class="ttdeci">float &amp; CosmicScore()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d86/CosmicTag_8h_source.html#l00061">CosmicTag.h:61</a></div></div>
<div class="ttc" id="lardata_2RecoBaseProxy_2Track_8h_html"><div class="ttname"><a href="../../d0/dfd/lardata_2RecoBaseProxy_2Track_8h.html">Track.h</a></div><div class="ttdoc">Offers proxy::Tracks and proxy::Track class for recob::Track access. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a63b5559274acba10be7199ea53fc9e85"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a63b5559274acba10be7199ea53fc9e85">evd::RecoBaseDrawer::fConvertedCharge</a></div><div class="ttdeci">std::vector&lt; double &gt; fConvertedCharge</div><div class="ttdoc">Sum of Charge Converted using Birks&amp;#39; formula. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00335">RecoBaseDrawer.h:335</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_a12283404f48c3daf15ca201ffbc7bbe6"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#a12283404f48c3daf15ca201ffbc7bbe6">recob::Shower::Length</a></div><div class="ttdeci">double Length() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00201">Shower.h:201</a></div></div>
<div class="ttc" id="MVAReader_8h_html"><div class="ttname"><a href="../../dc/d1b/MVAReader_8h.html">MVAReader.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_afdc8cc789422cc2ebc34e38af10b0d61"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#afdc8cc789422cc2ebc34e38af10b0d61">evd::RecoBaseDrawer::Slice2D</a></div><div class="ttdeci">void Slice2D(const art::Event &amp;evt, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00726">RecoBaseDrawer.cxx:726</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a32be06137aa5a6386e54ff2858e04f64"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a32be06137aa5a6386e54ff2858e04f64">evd::RecoBaseDrawer::Cluster2D</a></div><div class="ttdeci">void Cluster2D(const art::Event &amp;evt, detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00818">RecoBaseDrawer.cxx:818</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a69c8ed84c3f7b0f98a004c55891a3be5"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a69c8ed84c3f7b0f98a004c55891a3be5">evd::RecoBaseDrawer::DrawTrackVertexAssns2D</a></div><div class="ttdeci">void DrawTrackVertexAssns2D(const art::Event &amp;evt, detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01612">RecoBaseDrawer.cxx:1612</a></div></div>
<div class="ttc" id="namespaceevd_html_a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a930cc29dd0de2d6c4b777412a7c06918">evd::kYZ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc7/OrthoProj_8h_source.html#l00012">OrthoProj.h:12</a></div></div>
<div class="ttc" id="ColorDrawingOptions_8h_html"><div class="ttname"><a href="../../d8/da2/ColorDrawingOptions_8h.html">ColorDrawingOptions.h</a></div><div class="ttdoc">The color scales used by the event display. </div></div>
<div class="ttc" id="make__xml__premcc1_80_8sh_html_a6a381711e6b60dd64d5ecdb1d135c1b8"><div class="ttname"><a href="../../d5/d61/make__xml__premcc1_80_8sh.html#a6a381711e6b60dd64d5ecdb1d135c1b8">local</a></div><div class="ttdeci">then local</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d61/make__xml__premcc1_80_8sh_source.html#l00085">make_xml_premcc1.0.sh:85</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a0baed39cc12dfe2586761840d31fc225"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a0baed39cc12dfe2586761840d31fc225">recob::Track::CountValidPoints</a></div><div class="ttdeci">unsigned int CountValidPoints() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00112">bj/lardataobj/RecoBase/Track.h:112</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="PCAxis_8h_html"><div class="ttname"><a href="../../d1/d06/PCAxis_8h.html">PCAxis.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a33ba464fcae581883d1bd08e1c6e66ca"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a33ba464fcae581883d1bd08e1c6e66ca">evd::RecoBaseDrawer::Seed3D</a></div><div class="ttdeci">void Seed3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01880">RecoBaseDrawer.cxx:1880</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ae60bfd9ea65492c03832839dc1319673"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae60bfd9ea65492c03832839dc1319673">evd::RecoBaseDrawer::CountHits</a></div><div class="ttdeci">int CountHits(const art::Event &amp;evt, const art::InputTag &amp;which, unsigned int cryostat, unsigned int tpc, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04079">RecoBaseDrawer.cxx:4079</a></div></div>
<div class="ttc" id="Exceptions_8h_html"><div class="ttname"><a href="../../df/d7c/Exceptions_8h.html">Exceptions.h</a></div><div class="ttdoc">Collection of exceptions for Geometry system. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a98da87c62b4fa46729695eef731877db"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a98da87c62b4fa46729695eef731877db">evd::RecoBaseDrawer::Seed2D</a></div><div class="ttdeci">void Seed2D(const art::Event &amp;evt, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00632">RecoBaseDrawer.cxx:632</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a1e5aaaf25e8609a835e8c7c6fda71456"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div><div class="ttdeci">process_name opflash particleana ie ie y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00091">run_opflash_electron.fcl:91</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a7aefd268b12e72bb9b50f772434e2e46"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7aefd268b12e72bb9b50f772434e2e46">evd::RecoBaseDrawer::GetEndPoint2D</a></div><div class="ttdeci">int GetEndPoint2D(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::EndPoint2D &gt; &amp;ep2d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03884">RecoBaseDrawer.cxx:3884</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_a48509e22b6681725c899fc354de43ae2"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">geo::fhicl::WireID</a></div><div class="ttdeci">IDparameter&lt; geo::WireID &gt; WireID</div><div class="ttdoc">Member type of validated geo::WireID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00407">geo_types_fhicl.h:407</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a7ebbe05d1c84aa780ee9bf26950ffab4"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7ebbe05d1c84aa780ee9bf26950ffab4">evd::RecoBaseDrawer::~RecoBaseDrawer</a></div><div class="ttdeci">~RecoBaseDrawer()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00118">RecoBaseDrawer.cxx:118</a></div></div>
<div class="ttc" id="EndPoint2D_8h_html"><div class="ttname"><a href="../../d5/d62/EndPoint2D_8h.html">EndPoint2D.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a4e85acba3f9a728dd7e9ac8d2268d6d9"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4e85acba3f9a728dd7e9ac8d2268d6d9">evd::RecoBaseDrawer::FillTQHistoDP</a></div><div class="ttdeci">void FillTQHistoDP(const art::Event &amp;evt, unsigned int plane, unsigned int wire, TH1F *histo, std::vector&lt; double &gt; &amp;htau1, std::vector&lt; double &gt; &amp;htau2, std::vector&lt; double &gt; &amp;hitamplitudes, std::vector&lt; double &gt; &amp;hpeaktimes, std::vector&lt; int &gt; &amp;hstartT, std::vector&lt; int &gt; &amp;hendT, std::vector&lt; int &gt; &amp;hNMultiHit, std::vector&lt; int &gt; &amp;hLocalHitIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04200">RecoBaseDrawer.cxx:4200</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_a0adafeec7c6f10509c7b6315906d677e"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#a0adafeec7c6f10509c7b6315906d677e">recob::Shower::OpenAngle</a></div><div class="ttdeci">double OpenAngle() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00202">Shower.h:202</a></div></div>
<div class="ttc" id="namespacegeo_html_a59a0688ea6aaa04f0ffa6451f8083ca1"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a59a0688ea6aaa04f0ffa6451f8083ca1">geo::SigType_t</a></div><div class="ttdeci">enum geo::_plane_sigtype SigType_t</div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_adc22b92b0c39376fe4e9a9afe412d189"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adc22b92b0c39376fe4e9a9afe412d189">evd::RecoBaseDrawer::PFParticle3D</a></div><div class="ttdeci">void PFParticle3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02024">RecoBaseDrawer.cxx:2024</a></div></div>
<div class="ttc" id="noise__ana_8cxx_html_a166889fdc8b9a698a68cedffc20aed31"><div class="ttname"><a href="../../d4/d03/noise__ana_8cxx.html#a166889fdc8b9a698a68cedffc20aed31">mode</a></div><div class="ttdeci">const char mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d03/noise__ana_8cxx_source.html#l00020">noise_ana.cxx:20</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_abd3012d1d373cd4f76874c36315c6170"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#abd3012d1d373cd4f76874c36315c6170">evd::RecoBaseDrawer::Draw2DSlopeEndPoints</a></div><div class="ttdeci">void Draw2DSlopeEndPoints(double xStart, double yStart, double xEnd, double yEnd, double slope, int color, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01030">RecoBaseDrawer.cxx:1030</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_af3d605dc3abfa9dfc98923bb584beb08"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#af3d605dc3abfa9dfc98923bb584beb08">recob::Track::Vertex</a></div><div class="ttdeci">Point_t const &amp; Vertex() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00124">bj/lardataobj/RecoBase/Track.h:124</a></div></div>
<div class="ttc" id="namespaceevd_html_a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a6b471d71d8fab72f1eff49a8abec5823a0ad9c9066c3ed6574254cd03fc727de8">evd::kXZ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc7/OrthoProj_8h_source.html#l00012">OrthoProj.h:12</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a7af76391ec447a62f3bd02a96278a629"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a7af76391ec447a62f3bd02a96278a629">evd::RecoBaseDrawer::Hit2D</a></div><div class="ttdeci">int Hit2D(const art::Event &amp;evt, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00259">RecoBaseDrawer.cxx:259</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a1a08bc762b79d6e1d7816c34d3e36f78"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">util::quantities::tick</a></div><div class="ttdeci">tick_as&lt;&gt; tick</div><div class="ttdoc">Tick number, represented by std::ptrdiff_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00075">electronics.h:75</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a359d6255bb14f321d76e6085204ea52a"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">detinfo::DetectorPropertiesData::ConvertXToTicks</a></div><div class="ttdeci">double ConvertXToTicks(double X, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00099">DetectorPropertiesData.cc:99</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a93222627e36c5913a7aed3ade5c68f3d"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a93222627e36c5913a7aed3ade5c68f3d">evd::RecoBaseDrawer::GetSlices</a></div><div class="ttdeci">int GetSlices(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Slice &gt; &amp;slices)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03804">RecoBaseDrawer.cxx:3804</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a68dd45591fae87a346ccd7aab72f1381"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a68dd45591fae87a346ccd7aab72f1381">evd::RecoBaseDrawer::Slice3D</a></div><div class="ttdeci">void Slice3D(const art::Event &amp;evt, evdb::View3D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02968">RecoBaseDrawer.cxx:2968</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_adcc02edd92e7e037bbe545c81e9ac8db"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#adcc02edd92e7e037bbe545c81e9ac8db">evd::RecoBaseDrawer::DrawTrack2D</a></div><div class="ttdeci">void DrawTrack2D(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; const recob::Hit * &gt; &amp;hits, evdb::View2D *view, unsigned int plane, const recob::Track *track, int color, int lineWidth)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01302">RecoBaseDrawer.cxx:1302</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_acbc8fa634456b403b9e441f3af2615cc"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acbc8fa634456b403b9e441f3af2615cc">evd::RecoBaseDrawer::fWireMax</a></div><div class="ttdeci">std::vector&lt; int &gt; fWireMax</div><div class="ttdoc">highest wire in interesting region for each plane </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00330">RecoBaseDrawer.h:330</a></div></div>
<div class="ttc" id="RecoDrawingOptions_8h_html"><div class="ttname"><a href="../../d3/da8/RecoDrawingOptions_8h.html">RecoDrawingOptions.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a6a602cd2b200227e5d3bb462601fb57a"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a6a602cd2b200227e5d3bb462601fb57a">evd::RecoBaseDrawer::GetHits</a></div><div class="ttdeci">int GetHits(const art::Event &amp;evt, const art::InputTag &amp;which, std::vector&lt; const recob::Hit * &gt; &amp;hits, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03767">RecoBaseDrawer.cxx:3767</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ad570ecf8ccef879c571c16c54a429fa4"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ad570ecf8ccef879c571c16c54a429fa4">evd::RecoBaseDrawer::Circle3D</a></div><div class="ttdeci">std::vector&lt; std::array&lt; double, 3 &gt; &gt; Circle3D(const TVector3 &amp;pos, const TVector3 &amp;axisDir, const double &amp;radius)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02828">RecoBaseDrawer.cxx:2828</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a5e78353a8fba0f668965d343ec866db9"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a5e78353a8fba0f668965d343ec866db9">evd::RecoBaseDrawer::GetWires</a></div><div class="ttdeci">int GetWires(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Wire &gt; &amp;wires)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03740">RecoBaseDrawer.cxx:3740</a></div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html_a46ff8f390cf4ec3381f1e9d840edbe7c"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html#a46ff8f390cf4ec3381f1e9d840edbe7c">recob::SpacePoint::XYZ</a></div><div class="ttdeci">const Double32_t * XYZ() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00076">SpacePoint.h:76</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ab023442ffe9c0c0b6129119af1cb2a88"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ab023442ffe9c0c0b6129119af1cb2a88">evd::RecoBaseDrawer::GetOpFlashes</a></div><div class="ttdeci">int GetOpFlashes(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::OpFlash &gt; &amp;opflash)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03911">RecoBaseDrawer.cxx:3911</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_aa154d640035cf4376eea7abaf421f0a0"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa154d640035cf4376eea7abaf421f0a0">evd::RecoBaseDrawer::GetSeeds</a></div><div class="ttdeci">int GetSeeds(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Seed &gt; &amp;seed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03938">RecoBaseDrawer.cxx:3938</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_ad6560a8ce8546dfa7ffa69ad009cb13a"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#ad6560a8ce8546dfa7ffa69ad009cb13a">detinfo::DetectorPropertiesData::ElectronsToADC</a></div><div class="ttdeci">double ElectronsToADC() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00051">DetectorPropertiesData.cc:51</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a9d13715275d124a11d0ee4d376a949f4"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a9d13715275d124a11d0ee4d376a949f4">evd::RecoBaseDrawer::GetShowers</a></div><div class="ttdeci">int GetShowers(const art::Event &amp;evt, const art::InputTag &amp;which, art::View&lt; recob::Shower &gt; &amp;shower)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04011">RecoBaseDrawer.cxx:4011</a></div></div>
<div class="ttc" id="classlariov_1_1ChannelStatusProvider_html"><div class="ttname"><a href="../../d8/d7e/classlariov_1_1ChannelStatusProvider.html">lariov::ChannelStatusProvider</a></div><div class="ttdoc">Class providing information about the quality of channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/ChannelStatusProvider_8h_source.html#l00049">ChannelStatusProvider.h:49</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a5667a83a4014a59ccd6c2a0d0fbb58c1"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">detinfo::DetectorPropertiesData::DriftVelocity</a></div><div class="ttdeci">double DriftVelocity(double efield=0., double temperature=0.) const </div><div class="ttdoc">cm/us </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00023">DetectorPropertiesData.cc:23</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a2cbbbea174335e24d91f12847e7662d8"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2cbbbea174335e24d91f12847e7662d8">evd::RecoBaseDrawer::fWireMin</a></div><div class="ttdeci">std::vector&lt; int &gt; fWireMin</div><div class="ttdoc">lowest wire in interesting region for each plane </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00329">RecoBaseDrawer.h:329</a></div></div>
<div class="ttc" id="Cluster_8h_html"><div class="ttname"><a href="../../d8/d77/Cluster_8h.html">Cluster.h</a></div><div class="ttdoc">Declaration of cluster object. </div></div>
<div class="ttc" id="Vertex_8h_html"><div class="ttname"><a href="../../d9/d2d/Vertex_8h.html">Vertex.h</a></div></div>
<div class="ttc" id="RecoBaseDrawer_8h_html"><div class="ttname"><a href="../../dd/d96/RecoBaseDrawer_8h.html">RecoBaseDrawer.h</a></div><div class="ttdoc">Class to aid in the rendering of RecoBase objects. </div></div>
<div class="ttc" id="classrecob_1_1Shower_html"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html">recob::Shower</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00019">Shower.h:19</a></div></div>
<div class="ttc" id="namespaceevd_html_ad58792992abe8a372fbaffee10dace3c"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#ad58792992abe8a372fbaffee10dace3c">evd::kColor</a></div><div class="ttdeci">static const int kColor[kNCOLS]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db5/eventdisplay_8h_source.html#l00011">eventdisplay.h:11</a></div></div>
<div class="ttc" id="bj_2lardataobj_2RecoBase_2Track_8h_html"><div class="ttname"><a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h.html">Track.h</a></div><div class="ttdoc">Provides recob::Track data product. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a2a10bd9fa8de0950d18b8ff52ffd18ca"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a2a10bd9fa8de0950d18b8ff52ffd18ca">evd::RecoBaseDrawer::GetChargeSum</a></div><div class="ttdeci">void GetChargeSum(int plane, double &amp;charge, double &amp;convcharge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00478">RecoBaseDrawer.cxx:478</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="namespacetca_html_a0898183aa6813a6ab2cbaede7d31e4d1"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a0898183aa6813a6ab2cbaede7d31e4d1">tca::slices</a></div><div class="ttdeci">std::vector&lt; TCSlice &gt; slices</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00013">DataStructs.cxx:13</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="WireGeo_8h_html"><div class="ttname"><a href="../../da/de5/WireGeo_8h.html">WireGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of a wire. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8e4b4b8d755ffded5a9f956ae7c9c1ec"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">detinfo::DetectorPropertiesData::ConvertTicksToX</a></div><div class="ttdeci">double ConvertTicksToX(double ticks, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00115">DetectorPropertiesData.cc:115</a></div></div>
<div class="ttc" id="namespacetca_html_ae43e3da1b2fe6dca15e19b1c78031e36"><div class="ttname"><a href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">tca::seeds</a></div><div class="ttdeci">std::vector&lt; TrajPoint &gt; seeds</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00014">DataStructs.cxx:14</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_ae49e042f269165e7ecebdcc04a5e0700"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#ae49e042f269165e7ecebdcc04a5e0700">evd::RecoBaseDrawer::DrawTrack3D</a></div><div class="ttdeci">void DrawTrack3D(const recob::Track &amp;track, evdb::View3D *view, int color, int marker=1, float size=2.)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02639">RecoBaseDrawer.cxx:2639</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_ab0d5a4fa186436915e63a4d54ca407fa"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#ab0d5a4fa186436915e63a4d54ca407fa">recob::Track::ID</a></div><div class="ttdeci">int ID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00198">bj/lardataobj/RecoBase/Track.h:198</a></div></div>
<div class="ttc" id="eventdisplay_8h_html"><div class="ttname"><a href="../../dc/db5/eventdisplay_8h.html">eventdisplay.h</a></div><div class="ttdoc">Place to keep constants for event display. </div></div>
<div class="ttc" id="SpacePoint_8h_html"><div class="ttname"><a href="../../d9/d12/SpacePoint_8h.html">SpacePoint.h</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_abfea12b63bb7f09a5f6f2d0e65e321d2"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#abfea12b63bb7f09a5f6f2d0e65e321d2">recob::Shower::ID</a></div><div class="ttdeci">int ID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00187">Shower.h:187</a></div></div>
<div class="ttc" id="PlaneGeo_8h_html"><div class="ttname"><a href="../../d8/d80/PlaneGeo_8h.html">PlaneGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="Event_8h_html"><div class="ttname"><a href="../../d6/d8d/Event_8h.html">Event.h</a></div><div class="ttdoc">Represents the Event implemented as a self balancing binary search tree. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="OpFlash_8h_html"><div class="ttname"><a href="../../d8/d34/OpFlash_8h.html">OpFlash.h</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00102">WindowPattern.h:102</a></div></div>
<div class="ttc" id="file__to__url_8sh_html_a096ad3d3698082826189c839d7a6e46f"><div class="ttname"><a href="../../d0/dea/file__to__url_8sh.html#a096ad3d3698082826189c839d7a6e46f">s</a></div><div class="ttdeci">then echo File list $list not found else cat $list while read file do echo $file sed s</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dea/file__to__url_8sh_source.html#l00060">file_to_url.sh:60</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a000e5163d4ea999d9e3f6006609c5be8"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a000e5163d4ea999d9e3f6006609c5be8">evd::RecoBaseDrawer::RecoBaseDrawer</a></div><div class="ttdeci">RecoBaseDrawer()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00081">RecoBaseDrawer.cxx:81</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a85a02e64d2ef3f9d9930e7e658f2ded5"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a85a02e64d2ef3f9d9930e7e658f2ded5">evd::RecoBaseDrawer::FillQHisto</a></div><div class="ttdeci">void FillQHisto(const art::Event &amp;evt, unsigned int plane, TH1F *histo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04158">RecoBaseDrawer.cxx:4158</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8b47b2cbaecee116c0043583918ef5c9"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8b47b2cbaecee116c0043583918ef5c9">detinfo::DetectorPropertiesData::BirksCorrection</a></div><div class="ttdeci">double BirksCorrection(double dQdX) const </div><div class="ttdoc">dQ/dX in electrons/cm, returns dE/dX in MeV/cm. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00029">DetectorPropertiesData.cc:29</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_aa33c29aecd1e81defa8d5c729d4da9c5"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aa33c29aecd1e81defa8d5c729d4da9c5">evd::RecoBaseDrawer::GetPFParticles</a></div><div class="ttdeci">int GetPFParticles(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::PFParticle &gt; &amp;pfpart)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03858">RecoBaseDrawer.cxx:3858</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_af9022c4d08737109415cd31ff6fd283f"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#af9022c4d08737109415cd31ff6fd283f">evd::RecoBaseDrawer::EndPoint2D</a></div><div class="ttdeci">void EndPoint2D(const art::Event &amp;evt, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00488">RecoBaseDrawer.cxx:488</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_affc20d2127c406b93c85ce849bcc2960"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#affc20d2127c406b93c85ce849bcc2960">evd::RecoBaseDrawer::Wire2D</a></div><div class="ttdeci">void Wire2D(const art::Event &amp;evt, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00122">RecoBaseDrawer.cxx:122</a></div></div>
<div class="ttc" id="DetectorClocksService_8h_html"><div class="ttname"><a href="../../d3/dba/DetectorClocksService_8h.html">DetectorClocksService.h</a></div></div>
<div class="ttc" id="ChannelStatusProvider_8h_html"><div class="ttname"><a href="../../d7/ded/ChannelStatusProvider_8h.html">ChannelStatusProvider.h</a></div><div class="ttdoc">Interface for experiment-specific channel quality info provider. </div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a4b6bfeabfabcef393b6669957d537845"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a4b6bfeabfabcef393b6669957d537845">evd::RecoBaseDrawer::DrawPFParticleOrtho</a></div><div class="ttdeci">void DrawPFParticleOrtho(const art::Ptr&lt; recob::PFParticle &gt; &amp;pfPart, const art::PtrVector&lt; recob::PFParticle &gt; &amp;pfParticleVec, const art::FindMany&lt; recob::SpacePoint &gt; &amp;spacePointAssnsVec, const art::FindMany&lt; recob::PCAxis &gt; &amp;pcAxisAssnVec, int depth, evd::OrthoProj_t proj, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03206">RecoBaseDrawer.cxx:3206</a></div></div>
<div class="ttc" id="classgeo_1_1InvalidWireError_html"><div class="ttname"><a href="../../d6/d6c/classgeo_1_1InvalidWireError.html">geo::InvalidWireError</a></div><div class="ttdoc">Exception thrown on invalid wire number. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7c/Exceptions_8h_source.html#l00042">Exceptions.h:42</a></div></div>
<div class="ttc" id="classrecob_1_1Shower_html_aae9b151ad4c88ba45d45071be198637b"><div class="ttname"><a href="../../d4/d14/classrecob_1_1Shower.html#aae9b151ad4c88ba45d45071be198637b">recob::Shower::ShowerStart</a></div><div class="ttdeci">const TVector3 &amp; ShowerStart() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d69/Shower_8h_source.html#l00192">Shower.h:192</a></div></div>
<div class="ttc" id="RawDrawingOptions_8h_html"><div class="ttname"><a href="../../d2/d83/RawDrawingOptions_8h.html">RawDrawingOptions.h</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a3ec5be13d5a39d2e3ec55480b64250e3"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a3ec5be13d5a39d2e3ec55480b64250e3">recob::Track::End</a></div><div class="ttdeci">Point_t const &amp; End() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00125">bj/lardataobj/RecoBase/Track.h:125</a></div></div>
<div class="ttc" id="Wire_8h_html"><div class="ttname"><a href="../../da/d9f/Wire_8h.html">Wire.h</a></div><div class="ttdoc">Declaration of basic channel signal object. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a49743948284a3b91b98c43475f6537e3"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a49743948284a3b91b98c43475f6537e3">evd::RecoBaseDrawer::OpFlash2D</a></div><div class="ttdeci">void OpFlash2D(const art::Event &amp;evt, detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00543">RecoBaseDrawer.cxx:543</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a42bb65d8393a6a2579f36441b53a3d59"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a42bb65d8393a6a2579f36441b53a3d59">evd::RecoBaseDrawer::GetRegionOfInterest</a></div><div class="ttdeci">int GetRegionOfInterest(int plane, int &amp;minw, int &amp;maxw, int &amp;mint, int &amp;maxt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l00448">RecoBaseDrawer.cxx:448</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html_a931081e58a8c41b2d0e1473d2fb6bdb2"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html#a931081e58a8c41b2d0e1473d2fb6bdb2">recob::Track::DirectionAtPoint</a></div><div class="ttdeci">Vector_t DirectionAtPoint(size_t i) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00134">bj/lardataobj/RecoBase/Track.h:134</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a618cb12da47a4ef4371a8c5f4a8a9407"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a618cb12da47a4ef4371a8c5f4a8a9407">evd::RecoBaseDrawer::Event2D</a></div><div class="ttdeci">void Event2D(const art::Event &amp;evt, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01835">RecoBaseDrawer.cxx:1835</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_aff2e3940c9e158fb7ee9c70aa3457848"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aff2e3940c9e158fb7ee9c70aa3457848">evd::RecoBaseDrawer::GetClusterOutlines</a></div><div class="ttdeci">void GetClusterOutlines(std::vector&lt; const recob::Hit * &gt; &amp;hits, std::vector&lt; double &gt; &amp;tpts, std::vector&lt; double &gt; &amp;wpts, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01165">RecoBaseDrawer.cxx:1165</a></div></div>
<div class="ttc" id="Shower_8h_html"><div class="ttname"><a href="../../dc/d69/Shower_8h.html">Shower.h</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a88cf095de28d125a2b818aa59a89d33d"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a88cf095de28d125a2b818aa59a89d33d">evd::RecoBaseDrawer::OpFlashOrtho</a></div><div class="ttdeci">void OpFlashOrtho(const art::Event &amp;evt, detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, evd::OrthoProj_t proj, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l02992">RecoBaseDrawer.cxx:2992</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00008">DataStructs.cxx:8</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a8509b4e0dd59d79aedd6cd4ec88c7552"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a8509b4e0dd59d79aedd6cd4ec88c7552">evd::RecoBaseDrawer::Vertex2D</a></div><div class="ttdeci">void Vertex2D(const art::Event &amp;evt, detinfo::DetectorPropertiesData const &amp;detProp, evdb::View2D *view, unsigned int plane)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l01761">RecoBaseDrawer.cxx:1761</a></div></div>
<div class="ttc" id="ChannelStatusService_8h_html"><div class="ttname"><a href="../../d8/da1/ChannelStatusService_8h.html">ChannelStatusService.h</a></div><div class="ttdoc">Interface for experiment-specific service for channel quality info. </div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_aef3884624866ecc5440b976b7ebd58e8"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#aef3884624866ecc5440b976b7ebd58e8">evd::RecoBaseDrawer::DrawTrackOrtho</a></div><div class="ttdeci">void DrawTrackOrtho(const recob::Track &amp;track, int color, evd::OrthoProj_t proj, double msize, evdb::View2D *view)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03572">RecoBaseDrawer.cxx:3572</a></div></div>
<div class="ttc" id="namespaceevd_html_acda7b298c780ef8b1086b10294305360"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#acda7b298c780ef8b1086b10294305360">evd::kColor2</a></div><div class="ttdeci">static const int kColor2[kNCOLS]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db5/eventdisplay_8h_source.html#l00013">eventdisplay.h:13</a></div></div>
<div class="ttc" id="classgeo_1_1InvalidWireError_html_a174c7f48dc6c32f680e033c960fbc9eb"><div class="ttname"><a href="../../d6/d6c/classgeo_1_1InvalidWireError.html#a174c7f48dc6c32f680e033c960fbc9eb">geo::InvalidWireError::suggestedWireID</a></div><div class="ttdeci">geo::WireID suggestedWireID() const </div><div class="ttdoc">Returns a better wire ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7c/Exceptions_8h_source.html#l00120">Exceptions.h:120</a></div></div>
<div class="ttc" id="namespacedetinfo_html_a0c4d3d5b85e37497364174c3513ffcae"><div class="ttname"><a href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">detinfo::sampling_rate</a></div><div class="ttdeci">double sampling_rate(DetectorClocksData const &amp;data)</div><div class="ttdoc">Returns the period of the TPC readout electronics clock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00643">DetectorClocksData.h:643</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a140e0fd03121b33dd9163d9268073675"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a140e0fd03121b33dd9163d9268073675">evd::RecoBaseDrawer::fTimeMax</a></div><div class="ttdeci">std::vector&lt; int &gt; fTimeMax</div><div class="ttdoc">highest time in interesting region for each plane </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00332">RecoBaseDrawer.h:332</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3f663d96f6fe0ad88a84fa7dd0c9fc77"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">geo::TPCGeo::LocalToWorld</a></div><div class="ttdeci">void LocalToWorld(const double *tpc, double *world) const </div><div class="ttdoc">Transform point from local TPC frame to world frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00563">TPCGeo.h:563</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a518fa2da9c52a9c9321c069e0634e53e"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a518fa2da9c52a9c9321c069e0634e53e">evd::RecoBaseDrawer::GetVertices</a></div><div class="ttdeci">int GetVertices(const art::Event &amp;evt, const art::InputTag &amp;which, art::PtrVector&lt; recob::Vertex &gt; &amp;vertex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l04027">RecoBaseDrawer.cxx:4027</a></div></div>
<div class="ttc" id="test__associatedgroupswithleft__full_8fcl_html_a4814f2598ed6acdb806473d732f33889"><div class="ttname"><a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a></div><div class="ttdeci">physics associatedGroupsWithLeft p1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl_source.html#l00024">test_associatedgroupswithleft_full.fcl:24</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="CosmicTag_8h_html"><div class="ttname"><a href="../../dc/d86/CosmicTag_8h.html">CosmicTag.h</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00157">SimWire_module.cc:157</a></div></div>
<div class="ttc" id="classrecob_1_1Track_html"><div class="ttname"><a href="../../d9/dca/classrecob_1_1Track.html">recob::Track</a></div><div class="ttdoc">Track from a non-cascading particle.A recob::Track consists of a recob::TrackTrajectory, plus additional members relevant for a &amp;quot;fitted&amp;quot; track: </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d53/bj_2lardataobj_2RecoBase_2Track_8h_source.html#l00049">bj/lardataobj/RecoBase/Track.h:49</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a1c1599cdbb2e91320e7fddff00f4b6ad"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a1c1599cdbb2e91320e7fddff00f4b6ad">evd::RecoBaseDrawer::VertexOrtho</a></div><div class="ttdeci">void VertexOrtho(const art::PtrVector&lt; recob::Vertex &gt; &amp;vertex, evd::OrthoProj_t proj, evdb::View2D *view, int marker)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03069">RecoBaseDrawer.cxx:3069</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_acd4bc8ec002beecf2f843077df96b70f"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#acd4bc8ec002beecf2f843077df96b70f">evd::RecoBaseDrawer::GetEdges</a></div><div class="ttdeci">int GetEdges(const art::Event &amp;evt, const art::InputTag &amp;which, std::vector&lt; art::Ptr&lt; recob::Edge &gt;&gt; &amp;edges)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d53/RecoBaseDrawer_8cxx_source.html#l03977">RecoBaseDrawer.cxx:3977</a></div></div>
<div class="ttc" id="TPCGeo_8h_html"><div class="ttname"><a href="../../df/de9/TPCGeo_8h.html">TPCGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="classrecob_1_1SpacePoint_html"><div class="ttname"><a href="../../db/d88/classrecob_1_1SpacePoint.html">recob::SpacePoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/SpacePoint_8h_source.html#l00023">SpacePoint.h:23</a></div></div>
<div class="ttc" id="classevd_1_1RecoBaseDrawer_html_a21eb3aee0b20d512dcba23375bbbdbd1"><div class="ttname"><a href="../../da/d61/classevd_1_1RecoBaseDrawer.html#a21eb3aee0b20d512dcba23375bbbdbd1">evd::RecoBaseDrawer::fTimeMin</a></div><div class="ttdeci">std::vector&lt; int &gt; fTimeMin</div><div class="ttdoc">lowest time in interesting region for each plane </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d96/RecoBaseDrawer_8h_source.html#l00331">RecoBaseDrawer.h:331</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
