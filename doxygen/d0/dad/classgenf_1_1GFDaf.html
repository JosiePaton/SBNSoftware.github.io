<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>genf::GFDaf Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/dc1/namespacegenf.html">genf</a></li><li class="navelem"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html">GFDaf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dd/df4/classgenf_1_1GFDaf-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">genf::GFDaf Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a719a533bcba9916fdd55b029618acf43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a719a533bcba9916fdd55b029618acf43">GFDaf</a> ()</td></tr>
<tr class="memdesc:a719a533bcba9916fdd55b029618acf43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard CTOR. Sets default values for annealing scheme and probablity cut.  <a href="#a719a533bcba9916fdd55b029618acf43">More...</a><br/></td></tr>
<tr class="separator:a719a533bcba9916fdd55b029618acf43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4712a4c0ee61c0077213a27143927be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#ac4712a4c0ee61c0077213a27143927be">~GFDaf</a> ()</td></tr>
<tr class="separator:ac4712a4c0ee61c0077213a27143927be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c661416b4809ddc43bb546e518e7a70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a7c661416b4809ddc43bb546e518e7a70">processTrack</a> (<a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a> *)</td></tr>
<tr class="memdesc:a7c661416b4809ddc43bb546e518e7a70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs DAF fit on all track representations in a <a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a>.  <a href="#a7c661416b4809ddc43bb546e518e7a70">More...</a><br/></td></tr>
<tr class="separator:a7c661416b4809ddc43bb546e518e7a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b735678ffb85c414d434442dccb364c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a6b735678ffb85c414d434442dccb364c">setBlowUpFactor</a> (double f)</td></tr>
<tr class="memdesc:a6b735678ffb85c414d434442dccb364c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the blowup factor (see <a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1" title="This is needed to blow up the covariance matrix before a fitting pass. The method drops off-diagonal ...">blowUpCovs()</a> )  <a href="#a6b735678ffb85c414d434442dccb364c">More...</a><br/></td></tr>
<tr class="separator:a6b735678ffb85c414d434442dccb364c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f8646a5ff6f3a36ae10d0ef41d0ff7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a49f8646a5ff6f3a36ae10d0ef41d0ff7">setProbCut</a> (double val)</td></tr>
<tr class="memdesc:a49f8646a5ff6f3a36ae10d0ef41d0ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the probabilty cut for the weight calculation for the hits. Currently supported are the values 0.01 0.005, and 0.001. The corresponding chi2 cuts for different hits dimensionalities are hardcoded in the implementation because I did not yet figure out how to calculate them. Please feel very welcome to change the implementtion if you know how to do it.  <a href="#a49f8646a5ff6f3a36ae10d0ef41d0ff7">More...</a><br/></td></tr>
<tr class="separator:a49f8646a5ff6f3a36ae10d0ef41d0ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea70a6170db6c140aebef7fcb9d46457"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#aea70a6170db6c140aebef7fcb9d46457">setBetas</a> (double b1, double b2, double b3=-1., double b4=-1., double b5=-1., double b6=-1., double b7=-1., double b8=-1., double b9=-1., double b10=-1.)</td></tr>
<tr class="memdesc:aea70a6170db6c140aebef7fcb9d46457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the annealing scheme. In the current implementation you need to provide at least two temperatures. The maximum would ten tempertatures.  <a href="#aea70a6170db6c140aebef7fcb9d46457">More...</a><br/></td></tr>
<tr class="separator:aea70a6170db6c140aebef7fcb9d46457"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9ec6604501029b69d6f5d3bac172de06"><td class="memItemLeft" align="right" valign="top">TMatrixT&lt; Double_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a9ec6604501029b69d6f5d3bac172de06">calcGain</a> (const TMatrixT&lt; Double_t &gt; &amp;cov, const TMatrixT&lt; Double_t &gt; &amp;HitCov, const TMatrixT&lt; Double_t &gt; &amp;H, const double &amp;<a class="el" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</td></tr>
<tr class="memdesc:a9ec6604501029b69d6f5d3bac172de06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Kalman Gain.  <a href="#a9ec6604501029b69d6f5d3bac172de06">More...</a><br/></td></tr>
<tr class="separator:a9ec6604501029b69d6f5d3bac172de06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5914028620dc3df737f8e685c13024f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1">blowUpCovs</a> (<a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a> *trk)</td></tr>
<tr class="memdesc:a5914028620dc3df737f8e685c13024f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is needed to blow up the covariance matrix before a fitting pass. The method drops off-diagonal elements and blows up diagonal by blowUpFactor.  <a href="#a5914028620dc3df737f8e685c13024f1">More...</a><br/></td></tr>
<tr class="separator:a5914028620dc3df737f8e685c13024f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a04f1d436d1e3d478ef16ae76dc93f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a> (const TMatrixT&lt; Double_t &gt; &amp;, TMatrixT&lt; Double_t &gt; &amp;)</td></tr>
<tr class="memdesc:a2a04f1d436d1e3d478ef16ae76dc93f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">invert a matrix. First argument is matrix to be inverted, second is return by ref.  <a href="#a2a04f1d436d1e3d478ef16ae76dc93f8">More...</a><br/></td></tr>
<tr class="separator:a2a04f1d436d1e3d478ef16ae76dc93f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae8245bcb3ecb6419299925251204412d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">fBlowUpFactor</a></td></tr>
<tr class="separator:ae8245bcb3ecb6419299925251204412d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040eb0a6fe854487ee6da852bb353a95"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a></td></tr>
<tr class="separator:a040eb0a6fe854487ee6da852bb353a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4d1684e822f0cf81676a86f2074359"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a></td></tr>
<tr class="separator:adb4d1684e822f0cf81676a86f2074359"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../dd/de3/GFDaf_8h_source.html#l00050">50</a> of file <a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a719a533bcba9916fdd55b029618acf43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genf::GFDaf::GFDaf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard CTOR. Sets default values for annealing scheme and probablity cut. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00044">44</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                :<a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">fBlowUpFactor</a>(500.){</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a49f8646a5ff6f3a36ae10d0ef41d0ff7">setProbCut</a>(0.01);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#aea70a6170db6c140aebef7fcb9d46457">setBetas</a>(81,8,4,1,1,1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="classgenf_1_1GFDaf_html_aea70a6170db6c140aebef7fcb9d46457"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#aea70a6170db6c140aebef7fcb9d46457">genf::GFDaf::setBetas</a></div><div class="ttdeci">void setBetas(double b1, double b2, double b3=-1., double b4=-1., double b5=-1., double b6=-1., double b7=-1., double b8=-1., double b9=-1., double b10=-1.)</div><div class="ttdoc">Configure the annealing scheme. In the current implementation you need to provide at least two temper...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00451">GFDaf.cxx:451</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_ae8245bcb3ecb6419299925251204412d"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">genf::GFDaf::fBlowUpFactor</a></div><div class="ttdeci">double fBlowUpFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00106">GFDaf.h:106</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a49f8646a5ff6f3a36ae10d0ef41d0ff7"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a49f8646a5ff6f3a36ae10d0ef41d0ff7">genf::GFDaf::setProbCut</a></div><div class="ttdeci">void setProbCut(double val)</div><div class="ttdoc">Set the probabilty cut for the weight calculation for the hits. Currently supported are the values 0...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00421">GFDaf.cxx:421</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac4712a4c0ee61c0077213a27143927be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genf::GFDaf::~GFDaf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00050">50</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a5914028620dc3df737f8e685c13024f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::blowUpCovs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a> *&#160;</td>
          <td class="paramname"><em>trk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is needed to blow up the covariance matrix before a fitting pass. The method drops off-diagonal elements and blows up diagonal by blowUpFactor. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00355">355</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                      {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">int</span> nreps=trk-&gt;getNumReps();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> irep=0; irep&lt;nreps; ++irep){</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    GFAbsTrackRep* arep=trk-&gt;getTrackRep(irep);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//dont do it for already compromsied reps, since they wont be fitted anyway</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span>(arep-&gt;getStatusFlag()==0) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      TMatrixT&lt;Double_t&gt; cov = arep-&gt;getCov();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;cov.GetNrows();++i){</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;cov.GetNcols();++j){</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keywordflow">if</span>(i!=j){<span class="comment">//off diagonal</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            cov[i][j]=0.;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">else</span>{<span class="comment">//diagonal</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            cov[i][j] = cov[i][j] * <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">fBlowUpFactor</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      arep-&gt;setCov(cov);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="ttc" id="classgenf_1_1GFDaf_html_ae8245bcb3ecb6419299925251204412d"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">genf::GFDaf::fBlowUpFactor</a></div><div class="ttdeci">double fBlowUpFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00106">GFDaf.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ec6604501029b69d6f5d3bac172de06"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixT&lt; Double_t &gt; genf::GFDaf::calcGain </td>
          <td>(</td>
          <td class="paramtype">const TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>HitCov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate Kalman Gain. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00399">399</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                  {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="comment">//get C^-1</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   TMatrixT&lt;Double_t&gt; Cinv;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(C,Cinv);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   TMatrixT&lt;Double_t&gt; Vinv;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>,Vinv);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="comment">//get H^T</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   TMatrixT&lt;Double_t&gt; Htransp(H);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   Htransp.T();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   TMatrixT&lt;Double_t&gt; covsum = Cinv + (<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>*Htransp*Vinv*H);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   TMatrixT&lt;Double_t&gt; covsumInv;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(covsum,covsumInv);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordflow">return</span> (covsumInv*Htransp*Vinv);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; }</div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a2a04f1d436d1e3d478ef16ae76dc93f8"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">genf::GFDaf::invertMatrix</a></div><div class="ttdeci">void invertMatrix(const TMatrixT&lt; Double_t &gt; &amp;, TMatrixT&lt; Double_t &gt; &amp;)</div><div class="ttdoc">invert a matrix. First argument is matrix to be inverted, second is return by ref. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00380">GFDaf.cxx:380</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a7171bc20f34cc335ec48c7f2e2615e6f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a></div><div class="ttdeci">BEGIN_PROLOG V</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a04f1d436d1e3d478ef16ae76dc93f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::invertMatrix </td>
          <td>(</td>
          <td class="paramtype">const TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixT&lt; Double_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>invert a matrix. First argument is matrix to be inverted, second is return by ref. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00380">380</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  inv.ResizeTo(mat);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  inv = (mat);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">double</span> det=0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  inv.Invert(&amp;det);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span>(TMath::IsNaN(det)) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../df/d55/classGFException.html">GFException</a> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>(<span class="stringliteral">&quot;Daf Gain: det of matrix is nan&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.setFatal();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">if</span>(det==0){</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="../../df/d55/classGFException.html">GFException</a> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>(<span class="stringliteral">&quot;cannot invert matrix in Daf - det=0&quot;</span>,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                  __LINE__,__FILE__);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.setFatal();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="ttc" id="classGFException_html"><div class="ttname"><a href="../../df/d55/classGFException.html">GFException</a></div><div class="ttdoc">Exception class for error handling in GENFIT (provides storage for diagnostic information) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00048">GFException.h:48</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c661416b4809ddc43bb546e518e7a70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::processTrack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a> *&#160;</td>
          <td class="paramname"><em>trk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs DAF fit on all track representations in a <a class="el" href="../../d6/d69/classgenf_1_1GFTrack.html">GFTrack</a>. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00052">52</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                        {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  trk-&gt;clearBookkeeping();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nreps=trk-&gt;getNumReps();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nhits=trk-&gt;getNumHits();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nreps; ++i){</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    GFBookkeeping *bk = trk-&gt;getBK(i);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    bk-&gt;setNhits(nhits);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;fPredSt&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;fPredCov&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;bPredSt&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;bPredCov&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;m&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;V&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    bk-&gt;bookGFDetPlanes(<span class="stringliteral">&quot;pl&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    bk-&gt;bookMatrices(<span class="stringliteral">&quot;smooResid&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    bk-&gt;bookNumbers(<span class="stringliteral">&quot;p&quot;</span>,1.);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//plane grouping</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  std::vector&lt; std::vector&lt;int&gt;* &gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  trk-&gt;getHitsByPlane(planes);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> nPlanes = planes.size();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  trk-&gt;clearFailedHits();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iBeta=0; iBeta&lt;<a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.size(); iBeta++){</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;@@ beta &quot; &lt;&lt; fBeta.at(iBeta) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span>(iBeta&gt;0) <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1">blowUpCovs</a>(trk);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipl=0; ipl&lt;nPlanes; ++ipl){</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;@@ plane &quot; &lt;&lt; ipl &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      std::vector&lt; GFAbsRecoHit* &gt; hits;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nhitsInPlane = planes.at(ipl)-&gt;size();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihitInPl=0;ihitInPl&lt;nhitsInPlane;++ihitInPl){</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        hits.push_back( trk-&gt;getHit(planes.at(ipl)-&gt;at(ihitInPl)) );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">//now hits contains pointers to all hits in the next plane</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">//for non-planar detectors this will always be just one hit</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irep=0; irep&lt;nreps; ++irep){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        GFAbsTrackRep* rep=trk-&gt;getTrackRep(irep);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span>(rep-&gt;getStatusFlag()!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;@@ rep &quot; &lt;&lt; irep &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        GFBookkeeping *bk = trk-&gt;getBK(irep);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span>(bk-&gt;hitFailed(planes.at(ipl)-&gt;at(0))&gt;0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        GFDetPlane pl;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// get prototypes for matrices</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordtype">int</span> repDim=rep-&gt;getDim();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        TMatrixT&lt;Double_t&gt; <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>(repDim,1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        TMatrixT&lt;Double_t&gt; cov(repDim,repDim);;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span>(ipl&gt;0 || (ipl==0 &amp;&amp; iBeta==0) ){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <span class="comment">// get the (virtual) detector plane</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;forward ### iBeta, ipl, irep &quot; &lt;&lt; iBeta&lt;&lt; &quot; &quot; &lt;&lt; ipl &lt;&lt; &quot; &quot; &lt;&lt; irep &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="comment">//      rep-&gt;getState().Print();</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            hits.at(0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            pl=hits.at(0)-&gt;getDetPlane(rep);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="comment">//do the extrapolation</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            rep-&gt;extrapolate(pl,<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>,cov);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span>(cov[0][0]&lt;1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-50){</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <a class="code" href="../../df/d55/classGFException.html">GFException</a> exc(<a class="code" href="../../d7/de5/GFDaf_8cxx.html#ad10ab8b5d1c4ed0d2404266a1604a85f">COVEXC</a>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordflow">catch</span> (<a class="code" href="../../df/d55/classGFException.html">GFException</a>&amp; exc){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a8d1a8a85a0b2a30cac1090ea528dd015">std::cerr</a> &lt;&lt; exc.<a class="code" href="../../df/d55/classGFException.html#a03021ecb7c2326e8dc1f0ac6e4017efa">what</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            exc.<a class="code" href="../../df/d55/classGFException.html#a0a8577e865b120352bde062ba6b98f3a">info</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;planes.at(ipl)-&gt;size();++i) trk-&gt;addFailedHit(irep,planes.at(ipl)-&gt;at(i));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span>(exc.<a class="code" href="../../df/d55/classGFException.html#a960c87f12f60e4d6664f6c830917ce84">isFatal</a>()){</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;              rep-&gt;setStatusFlag(1);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;              <span class="comment">//abort();</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">continue</span>;<span class="comment">//go to next rep immediately</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          pl = rep-&gt;getReferencePlane();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a> = rep-&gt;getState();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          cov = rep-&gt;getCov();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">//the H matrix has to be identical for all hits in the plane</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        TMatrixT&lt;Double_t&gt; H=hits.at(0)-&gt;getHMatrix(rep);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;fPredSt&quot;</span>,planes.at(ipl)-&gt;at(0),<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;fPredCov&quot;</span>,planes.at(ipl)-&gt;at(0),cov);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        TMatrixT&lt;Double_t&gt; covInv;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(cov,covInv);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        TMatrixT&lt;Double_t&gt; Htransp(H);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        Htransp.T();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;H&quot;</span>,planes.at(ipl)-&gt;at(0),H);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        bk-&gt;setDetPlane(<span class="stringliteral">&quot;pl&quot;</span>,planes.at(ipl)-&gt;at(0),pl);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        TMatrixT&lt;Double_t&gt; stMod(<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>.GetNrows(),1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">double</span> sumPk(0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;nhitsInPlane;++ihit){</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordtype">double</span> pki;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          bk-&gt;getNumber(<span class="stringliteral">&quot;p&quot;</span>,planes.at(ipl)-&gt;at(ihit),pki);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          sumPk+=pki;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        TMatrixT&lt;Double_t&gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a> = hits.at(0)-&gt;getHitCov(pl);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        TMatrixT&lt;Double_t&gt; Vinv;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(V,Vinv);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;V&quot;</span>,planes.at(ipl)-&gt;at(0),<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;nhitsInPlane;++ihit){</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;%%%% forward hit &quot; &lt;&lt; planes.at(ipl)-&gt;at(ihit) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          TMatrixT&lt;Double_t&gt; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a> = hits.at(ihit)-&gt;getHitCoord(pl);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          bk-&gt;setMatrix(<span class="stringliteral">&quot;m&quot;</span>,planes.at(ipl)-&gt;at(ihit),<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordtype">double</span> pki;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          bk-&gt;getNumber(<span class="stringliteral">&quot;p&quot;</span>,planes.at(ipl)-&gt;at(ihit),pki);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          TMatrixT&lt;Double_t&gt; Gain = <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a9ec6604501029b69d6f5d3bac172de06">calcGain</a>(cov,V,H,sumPk);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;using weight &quot; &lt;&lt; pki &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          stMod += pki*Gain*(m-H*<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a> += stMod;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>( covInv + sumPk*Htransp*Vinv*H ,cov);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        rep-&gt;setData(<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>,pl,&amp;cov);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }<span class="comment">//loop over reps</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }<span class="comment">//loop over planes for forward fit</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1">blowUpCovs</a>(trk);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//now do the loop over the planes in backward direction</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipl=nPlanes-1; ipl&gt;=0; --ipl){</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;@bw@ plane &quot; &lt;&lt; ipl &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      std::vector&lt; GFAbsRecoHit* &gt; hits;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nhitsInPlane = planes.at(ipl)-&gt;size();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihitInPl=0;ihitInPl&lt;nhitsInPlane;++ihitInPl){</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        hits.push_back( trk-&gt;getHit(planes.at(ipl)-&gt;at(ihitInPl)) );</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">//now hits contains pointers to all hits in the next plane</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">//for non-planar detectors this will always be just one hit</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irep=0; irep&lt;nreps; ++irep){</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        GFAbsTrackRep* rep=trk-&gt;getTrackRep(irep);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span>(rep-&gt;getStatusFlag()!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;@bw@ rep &quot; &lt;&lt; irep &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        GFBookkeeping *bk = trk-&gt;getBK(irep);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span>(bk-&gt;hitFailed(planes.at(ipl)-&gt;at(0))&gt;0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// get prototypes for matrices</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">int</span> repDim=rep-&gt;getDim();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        TMatrixT&lt;Double_t&gt; <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>(repDim,1);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        TMatrixT&lt;Double_t&gt; cov(repDim,repDim);;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        TMatrixT&lt;Double_t&gt; H;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;H&quot;</span>,planes.at(ipl)-&gt;at(0),H);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        TMatrixT&lt;Double_t&gt; Htransp(H);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        Htransp.T();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        GFDetPlane pl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        bk-&gt;getDetPlane(<span class="stringliteral">&quot;pl&quot;</span>,planes.at(ipl)-&gt;at(0),pl);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;backward ### iBeta, ipl, irep &quot; &lt;&lt; iBeta&lt;&lt; &quot; &quot; &lt;&lt; ipl &lt;&lt; &quot; &quot; &lt;&lt; irep &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span>(ipl&lt;(nPlanes-1)){</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">//do the extrapolation</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            rep-&gt;extrapolate(pl,<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>,cov);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span>(cov[0][0]&lt;1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-50){</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              <a class="code" href="../../df/d55/classGFException.html">GFException</a> exc(<a class="code" href="../../d7/de5/GFDaf_8cxx.html#ad10ab8b5d1c4ed0d2404266a1604a85f">COVEXC</a>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">catch</span>(<a class="code" href="../../df/d55/classGFException.html">GFException</a>&amp; exc){</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">//std::cout &lt;&lt; __FILE__ &lt;&lt; &quot; &quot; &lt;&lt; __LINE__ &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <a class="code" href="../../d8/df5/messageservice_8fcl.html#a8d1a8a85a0b2a30cac1090ea528dd015">std::cerr</a> &lt;&lt; exc.<a class="code" href="../../df/d55/classGFException.html#a03021ecb7c2326e8dc1f0ac6e4017efa">what</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            exc.<a class="code" href="../../df/d55/classGFException.html#a0a8577e865b120352bde062ba6b98f3a">info</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="comment">//TAG</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;planes.at(ipl)-&gt;size();++i) trk-&gt;addFailedHit(irep,planes.at(ipl)-&gt;at(i));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">if</span>(exc.<a class="code" href="../../df/d55/classGFException.html#a960c87f12f60e4d6664f6c830917ce84">isFatal</a>()){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              rep-&gt;setStatusFlag(1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">continue</span>;<span class="comment">//go to next rep immediately</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a> = rep-&gt;getState();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          cov = rep-&gt;getCov();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        TMatrixT&lt;Double_t&gt; covInv;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(cov,covInv);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;bPredSt&quot;</span>,planes.at(ipl)-&gt;at(0),<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        bk-&gt;setMatrix(<span class="stringliteral">&quot;bPredCov&quot;</span>,planes.at(ipl)-&gt;at(0),cov);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        TMatrixT&lt;Double_t&gt; stMod(<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>.GetNrows(),1);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordtype">double</span> sumPk(0);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;nhitsInPlane;++ihit){</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <span class="keywordtype">double</span> pki;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          bk-&gt;getNumber(<span class="stringliteral">&quot;p&quot;</span>,planes.at(ipl)-&gt;at(ihit),pki);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          sumPk+=pki;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        TMatrixT&lt;Double_t&gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;V&quot;</span>,planes.at(ipl)-&gt;at(0),<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        TMatrixT&lt;Double_t&gt; Vinv;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(V,Vinv);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;nhitsInPlane;++ihit){</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;%%bw%% hit &quot; &lt;&lt; planes.at(ipl)-&gt;at(ihit) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          TMatrixT&lt;Double_t&gt; <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          bk-&gt;getMatrix(<span class="stringliteral">&quot;m&quot;</span>,planes.at(ipl)-&gt;at(ihit),<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keywordtype">double</span> pki;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          bk-&gt;getNumber(<span class="stringliteral">&quot;p&quot;</span>,planes.at(ipl)-&gt;at(ihit),pki);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          TMatrixT&lt;Double_t&gt; Gain = <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a9ec6604501029b69d6f5d3bac172de06">calcGain</a>(cov,V,H,sumPk);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;using pki &quot; &lt;&lt; pki &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          stMod += pki*Gain*(m-H*<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a> += stMod;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>( covInv + sumPk*Htransp*Vinv*H , cov);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        rep-&gt;setData(<a class="code" href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">state</a>,pl,&amp;cov);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      }<span class="comment">//done with loop over reps</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }<span class="comment">//loop over planes for backward</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">//calculate smoothed states and covs</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    TMatrixT&lt;Double_t&gt; fSt,fCov,bSt,bCov,smooSt,smooCov,fCovInv,bCovInv,<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a>,H,smooResid;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipl=0; ipl&lt;nPlanes; ++ipl){</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irep=0; irep&lt;nreps; ++irep){</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">if</span>(trk-&gt;getTrackRep(irep)-&gt;getStatusFlag()!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        GFBookkeeping *bk = trk-&gt;getBK(irep);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span>(bk-&gt;hitFailed(planes.at(ipl)-&gt;at(0))&gt;0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;fPredSt&quot;</span>,planes.at(ipl)-&gt;at(0),fSt);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;bPredSt&quot;</span>,planes.at(ipl)-&gt;at(0),bSt);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;fPredCov&quot;</span>,planes.at(ipl)-&gt;at(0),fCov);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;bPredCov&quot;</span>,planes.at(ipl)-&gt;at(0),bCov);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        fCovInv.ResizeTo(fCov);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        bCovInv.ResizeTo(bCov);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(fCov,fCovInv);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(bCov,bCovInv);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        smooCov.ResizeTo(fCov);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>( fCovInv + bCovInv , smooCov);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        smooSt.ResizeTo(fSt.GetNrows(),1);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        smooSt = smooCov * (fCovInv*fSt + bCovInv*bSt);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;#@#@#@#@#@# smooResid ipl, irep &quot; &lt;&lt; ipl &lt;&lt; &quot; &quot; &lt;&lt; irep &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        bk-&gt;getMatrix(<span class="stringliteral">&quot;H&quot;</span>,planes.at(ipl)-&gt;at(0),H);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;planes.at(ipl)-&gt;size();++ihit){</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <span class="comment">//TAG</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          bk-&gt;getMatrix(<span class="stringliteral">&quot;m&quot;</span>,planes.at(ipl)-&gt;at(ihit),<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          smooResid.ResizeTo(m.GetNrows(),1);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          smooResid = m - H*smooSt;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;%%%% hit &quot; &lt;&lt; planes.at(ipl)-&gt;at(ihit) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="comment">//smooResid.Print();</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          bk-&gt;setMatrix(<span class="stringliteral">&quot;smooResid&quot;</span>,planes.at(ipl)-&gt;at(ihit),smooResid);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }<span class="comment">//end loop over planes for smoothed state calculation</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">//calculate the new weights</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(iBeta!=<a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.size()-1){<span class="comment">//dont do it for the last beta, ause fitting will stop</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irep=0; irep&lt;nreps; ++irep){</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        GFBookkeeping *bk = trk-&gt;getBK(irep);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipl=0; ipl&lt;nPlanes; ++ipl){</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="keywordflow">if</span>(trk-&gt;getTrackRep(irep)-&gt;getStatusFlag()!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <span class="keywordflow">if</span>(bk-&gt;hitFailed(planes.at(ipl)-&gt;at(0))&gt;0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordtype">double</span> sumPhi=0.;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <span class="keywordtype">double</span> sumPhiCut=0.;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          std::vector&lt;double&gt; phi;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          TMatrixT&lt;Double_t&gt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          bk-&gt;getMatrix(<span class="stringliteral">&quot;V&quot;</span>,planes.at(ipl)-&gt;at(0),<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          V *= <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.at(iBeta);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          TMatrixT&lt;Double_t&gt; Vinv;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">invertMatrix</a>(V,Vinv);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;planes.at(ipl)-&gt;size();++ihit){</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="comment">//TMatrixT&lt;Double_t&gt; smooResid;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            bk-&gt;getMatrix(<span class="stringliteral">&quot;smooResid&quot;</span>,planes.at(ipl)-&gt;at(ihit),smooResid);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            TMatrixT&lt;Double_t&gt; smooResidTransp(smooResid);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            smooResidTransp.T();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordtype">int</span> dimV = V.GetNrows();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordtype">double</span> detV = V.Determinant();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            TMatrixT&lt;Double_t&gt; expArg = smooResidTransp*Vinv*smooResid;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">if</span> (expArg.GetNrows() != 1)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;              <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::processTrack(): wrong matrix dimensions!&quot;</span>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordtype">double</span> thisPhi = 1./(pow(2.*TMath::Pi(),dimV/2.)*sqrt(detV))*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5*expArg[0][0]);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            phi.push_back(thisPhi);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            sumPhi += thisPhi;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordtype">double</span> cutVal = <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[dimV];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">if</span> (cutVal &lt;= 1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-6)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::processTrack(): chi2 cut too low&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            sumPhiCut += 1./(2*TMath::Pi()*sqrt(detV))*<a class="code" href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">exp</a>(-0.5*cutVal/<a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.at(iBeta));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihit=0;ihit&lt;planes.at(ipl)-&gt;size();++ihit){</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            bk-&gt;setNumber(<span class="stringliteral">&quot;p&quot;</span>,planes.at(ipl)-&gt;at(ihit), phi.at(ihit)/(sumPhi+sumPhiCut));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }<span class="comment">//loop over betas</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="ttc" id="messageservice_8fcl_html_a8d1a8a85a0b2a30cac1090ea528dd015"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a8d1a8a85a0b2a30cac1090ea528dd015">cerr</a></div><div class="ttdeci">BEGIN_PROLOG could also be cerr</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a2a04f1d436d1e3d478ef16ae76dc93f8"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a2a04f1d436d1e3d478ef16ae76dc93f8">genf::GFDaf::invertMatrix</a></div><div class="ttdeci">void invertMatrix(const TMatrixT&lt; Double_t &gt; &amp;, TMatrixT&lt; Double_t &gt; &amp;)</div><div class="ttdoc">invert a matrix. First argument is matrix to be inverted, second is return by ref. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00380">GFDaf.cxx:380</a></div></div>
<div class="ttc" id="classGFException_html_a03021ecb7c2326e8dc1f0ac6e4017efa"><div class="ttname"><a href="../../df/d55/classGFException.html#a03021ecb7c2326e8dc1f0ac6e4017efa">GFException::what</a></div><div class="ttdeci">virtual const char * what() const </div><div class="ttdoc">standard error message handling for exceptions. use like &amp;quot;std::cerr &amp;lt;&amp;lt; e.what();&amp;quot; ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/GFException_8cxx_source.html#l00048">GFException.cxx:48</a></div></div>
<div class="ttc" id="rawtorootconvert_8fcl_html_a073d3febd81cab639f2a8aa357dc5ef1"><div class="ttname"><a href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a></div><div class="ttdeci">process_name E</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3a/rawtorootconvert_8fcl_source.html#l00026">rawtorootconvert.fcl:26</a></div></div>
<div class="ttc" id="namespacerun__simTestPulse_html_a4cef4374034bd70ad18185ff49d1dc64"><div class="ttname"><a href="../../d0/d8d/namespacerun__simTestPulse.html#a4cef4374034bd70ad18185ff49d1dc64">run_simTestPulse.state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/run__simTestPulse_8py_source.html#l00023">run_simTestPulse.py:23</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a55a56854d78e363691470c7297fde77c"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">gen_crt_frags.m</a></div><div class="ttdeci">tuple m</div><div class="ttdoc">now if test mode generate materials, CRT shell, world, gdml header else just generate CRT shell for u...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01347">gen_crt_frags.py:1347</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_adb4d1684e822f0cf81676a86f2074359"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">genf::GFDaf::chi2Cuts</a></div><div class="ttdeci">std::map&lt; int, double &gt; chi2Cuts</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00108">GFDaf.h:108</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a7171bc20f34cc335ec48c7f2e2615e6f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a7171bc20f34cc335ec48c7f2e2615e6f">V</a></div><div class="ttdeci">BEGIN_PROLOG V</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a040eb0a6fe854487ee6da852bb353a95"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">genf::GFDaf::fBeta</a></div><div class="ttdeci">std::vector&lt; double &gt; fBeta</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00107">GFDaf.h:107</a></div></div>
<div class="ttc" id="classGFException_html_a960c87f12f60e4d6664f6c830917ce84"><div class="ttname"><a href="../../df/d55/classGFException.html#a960c87f12f60e4d6664f6c830917ce84">GFException::isFatal</a></div><div class="ttdeci">bool isFatal()</div><div class="ttdoc">get fatal flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00080">GFException.h:80</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a9ec6604501029b69d6f5d3bac172de06"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a9ec6604501029b69d6f5d3bac172de06">genf::GFDaf::calcGain</a></div><div class="ttdeci">TMatrixT&lt; Double_t &gt; calcGain(const TMatrixT&lt; Double_t &gt; &amp;cov, const TMatrixT&lt; Double_t &gt; &amp;HitCov, const TMatrixT&lt; Double_t &gt; &amp;H, const double &amp;p)</div><div class="ttdoc">Calculate Kalman Gain. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00399">GFDaf.cxx:399</a></div></div>
<div class="ttc" id="classGFException_html_a0a8577e865b120352bde062ba6b98f3a"><div class="ttname"><a href="../../df/d55/classGFException.html#a0a8577e865b120352bde062ba6b98f3a">GFException::info</a></div><div class="ttdeci">void info()</div><div class="ttdoc">print information in the exception object </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/GFException_8cxx_source.html#l00058">GFException.cxx:58</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_ada2bd95dba6a990f1012b56dacc20b0e"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#ada2bd95dba6a990f1012b56dacc20b0e">make_calib_df.exp</a></div><div class="ttdeci">def exp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00043">make_calib_df.py:43</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_ac996980052e16111a1efc913778a5f5f"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#ac996980052e16111a1efc913778a5f5f">planes</a></div><div class="ttdeci">BEGIN_PROLOG Z planes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00026">trackfinderalgorithms.fcl:26</a></div></div>
<div class="ttc" id="classGFException_html"><div class="ttname"><a href="../../df/d55/classGFException.html">GFException</a></div><div class="ttdoc">Exception class for error handling in GENFIT (provides storage for diagnostic information) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00048">GFException.h:48</a></div></div>
<div class="ttc" id="GFDaf_8cxx_html_ad10ab8b5d1c4ed0d2404266a1604a85f"><div class="ttname"><a href="../../d7/de5/GFDaf_8cxx.html#ad10ab8b5d1c4ed0d2404266a1604a85f">COVEXC</a></div><div class="ttdeci">#define COVEXC</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00041">GFDaf.cxx:41</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a5914028620dc3df737f8e685c13024f1"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1">genf::GFDaf::blowUpCovs</a></div><div class="ttdeci">void blowUpCovs(GFTrack *trk)</div><div class="ttdoc">This is needed to blow up the covariance matrix before a fitting pass. The method drops off-diagonal ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de5/GFDaf_8cxx_source.html#l00355">GFDaf.cxx:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea70a6170db6c140aebef7fcb9d46457"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::setBetas </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b3</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b4</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b5</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b6</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b7</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b8</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b9</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b10</em> = <code>-1.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the annealing scheme. In the current implementation you need to provide at least two temperatures. The maximum would ten tempertatures. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00451">451</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">/* // asserting version</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">  assert(b1&gt;0);fBeta.push_back(b1);</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">  assert(b2&gt;0 &amp;&amp; b2&lt;=b1);fBeta.push_back(b2);</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">  if(b3&gt;=0.) {</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">    assert(b3&lt;=b2);fBeta.push_back(b3);</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">    if(b4&gt;=0.) {</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">      assert(b4&lt;=b3);fBeta.push_back(b4);</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">      if(b5&gt;=0.) {</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">        assert(b5&lt;=b4);fBeta.push_back(b5);</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">        if(b6&gt;=0.) {</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">          assert(b6&lt;=b5);fBeta.push_back(b6);</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">          if(b7&gt;=0.) {</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">            assert(b7&lt;=b6);fBeta.push_back(b7);</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">            if(b8&gt;=0.) {</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">              assert(b8&lt;=b7);fBeta.push_back(b8);</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">              if(b9&gt;=0.) {</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">                assert(b9&lt;=b8);fBeta.push_back(b9);</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">                if(b10&gt;=0.) {</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">                  assert(b10&lt;=b9);fBeta.push_back(b10);</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">              }</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">          }</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span> (b1 &lt;= 0)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b1 &lt;= 0&quot;</span>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b1);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span> (b2 &lt;= 0 || b2 &gt; b1)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b2 in wrong range&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b2);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span>(b3 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (b3 &gt; b2)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b3 &gt; b2&quot;</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b3);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">if</span>(b4 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (b4 &gt; b3)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b4 &gt; b3&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b4);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">if</span>(b5 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (b5 &gt; b4)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b5 &gt; b4&quot;</span>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b5);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">if</span>(b6 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (b6 &gt; b5)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b6 &gt; b5&quot;</span>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b6);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span>(b7 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (b7 &gt; b6)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b7 &gt; b6&quot;</span>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b7);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">if</span>(b8 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (b8 &gt; b7)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b8 &gt; b7&quot;</span>);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b8);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span>(b9 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span> (b9 &gt; b8)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b9 &gt; b8&quot;</span>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b9);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span>(b10 &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">if</span> (b10 &gt; b9)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;genf::GFDaf::setBetas(): b10 &gt; b9&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">fBeta</a>.push_back(b10);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="ttc" id="classgenf_1_1GFDaf_html_a040eb0a6fe854487ee6da852bb353a95"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#a040eb0a6fe854487ee6da852bb353a95">genf::GFDaf::fBeta</a></div><div class="ttdeci">std::vector&lt; double &gt; fBeta</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00107">GFDaf.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b735678ffb85c414d434442dccb364c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::setBlowUpFactor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the blowup factor (see <a class="el" href="../../d0/dad/classgenf_1_1GFDaf.html#a5914028620dc3df737f8e685c13024f1" title="This is needed to blow up the covariance matrix before a fitting pass. The method drops off-diagonal ...">blowUpCovs()</a> ) </p>

<p>Definition at line <a class="el" href="../../dd/de3/GFDaf_8h_source.html#l00071">71</a> of file <a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{<a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">fBlowUpFactor</a>=f;}</div>
<div class="ttc" id="classgenf_1_1GFDaf_html_ae8245bcb3ecb6419299925251204412d"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#ae8245bcb3ecb6419299925251204412d">genf::GFDaf::fBlowUpFactor</a></div><div class="ttdeci">double fBlowUpFactor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00106">GFDaf.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49f8646a5ff6f3a36ae10d0ef41d0ff7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genf::GFDaf::setProbCut </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the probabilty cut for the weight calculation for the hits. Currently supported are the values 0.01 0.005, and 0.001. The corresponding chi2 cuts for different hits dimensionalities are hardcoded in the implementation because I did not yet figure out how to calculate them. Please feel very welcome to change the implementtion if you know how to do it. </p>

<p>Definition at line <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html#l00421">421</a> of file <a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                    {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span>(fabs(val-0.01)&lt;1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-10){</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[1] = 6.63;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[2] = 9.21;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[3] = 11.34;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[4] = 13.23;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[5] = 15.09;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">else</span>   <span class="keywordflow">if</span>(fabs(val-0.005)&lt;1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-10){</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[1] = 7.88;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[2] = 10.60;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[3] = 12.84;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[4] = 14.86;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[5] = 16.75;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">else</span>   <span class="keywordflow">if</span>(fabs(val-0.001)&lt;1.<a class="code" href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a>-10){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[1] = 10.83;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[2] = 13.82;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[3] = 16.27;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[4] = 18.47;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">chi2Cuts</a>[5] = 20.51;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../df/d55/classGFException.html">GFException</a>(<span class="stringliteral">&quot;genf::GFTrackCand::GFDafsetProbCut(): value not supported&quot;</span>, __LINE__, __FILE__)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      .<a class="code" href="../../df/d55/classGFException.html#aee050fdd461df6d030961758ce801adc">setFatal</a>().<a class="code" href="../../df/d55/classGFException.html#ac84ad0b97d14d4d9c0557deeaaf60d47">setNumbers</a>(<span class="stringliteral">&quot;value&quot;</span>, { val });</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
<div class="ttc" id="classGFException_html_ac84ad0b97d14d4d9c0557deeaaf60d47"><div class="ttname"><a href="../../df/d55/classGFException.html#ac84ad0b97d14d4d9c0557deeaaf60d47">GFException::setNumbers</a></div><div class="ttdeci">GFException &amp; setNumbers(std::string, const std::vector&lt; double &gt; &amp;)</div><div class="ttdoc">set list of numbers with description </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/GFException_8cxx_source.html#l00034">GFException.cxx:34</a></div></div>
<div class="ttc" id="rawtorootconvert_8fcl_html_a073d3febd81cab639f2a8aa357dc5ef1"><div class="ttname"><a href="../../d4/d3a/rawtorootconvert_8fcl.html#a073d3febd81cab639f2a8aa357dc5ef1">E</a></div><div class="ttdeci">process_name E</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3a/rawtorootconvert_8fcl_source.html#l00026">rawtorootconvert.fcl:26</a></div></div>
<div class="ttc" id="classgenf_1_1GFDaf_html_adb4d1684e822f0cf81676a86f2074359"><div class="ttname"><a href="../../d0/dad/classgenf_1_1GFDaf.html#adb4d1684e822f0cf81676a86f2074359">genf::GFDaf::chi2Cuts</a></div><div class="ttdeci">std::map&lt; int, double &gt; chi2Cuts</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/GFDaf_8h_source.html#l00108">GFDaf.h:108</a></div></div>
<div class="ttc" id="classGFException_html"><div class="ttname"><a href="../../df/d55/classGFException.html">GFException</a></div><div class="ttdoc">Exception class for error handling in GENFIT (provides storage for diagnostic information) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00048">GFException.h:48</a></div></div>
<div class="ttc" id="classGFException_html_aee050fdd461df6d030961758ce801adc"><div class="ttname"><a href="../../df/d55/classGFException.html#aee050fdd461df6d030961758ce801adc">GFException::setFatal</a></div><div class="ttdeci">GFException &amp; setFatal(bool b=true)</div><div class="ttdoc">set fatal flag. if this is true, the fit stops for this current track repr. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/GFException_8h_source.html#l00078">GFException.h:78</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="adb4d1684e822f0cf81676a86f2074359"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int,double&gt; genf::GFDaf::chi2Cuts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/de3/GFDaf_8h_source.html#l00108">108</a> of file <a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>.</p>

</div>
</div>
<a class="anchor" id="a040eb0a6fe854487ee6da852bb353a95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; genf::GFDaf::fBeta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/de3/GFDaf_8h_source.html#l00107">107</a> of file <a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae8245bcb3ecb6419299925251204412d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genf::GFDaf::fBlowUpFactor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/de3/GFDaf_8h_source.html#l00106">106</a> of file <a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../dd/de3/GFDaf_8h_source.html">GFDaf.h</a></li>
<li><a class="el" href="../../d7/de5/GFDaf_8cxx_source.html">GFDaf.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
