<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>CosmicTrackerAlg.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_a92975983e87729a773cfa3b8109c8c3.html">RecoAlg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CosmicTrackerAlg.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d33/CosmicTrackerAlg_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">// CosmicTrackerAlg.cxx</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// tjyang@fnal.gov</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// CosmicTrackerAlg class</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d33/CosmicTrackerAlg_8h.html">CosmicTrackerAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2e/ServiceUtil_8h.html">larcore/CoreUtils/ServiceUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d13/CryostatGeo_8h.html">larcorealg/Geometry/CryostatGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/de9/TPCGeo_8h.html">larcorealg/Geometry/TPCGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d48/geo__types_8h.html">larcoreobj/SimpleTypesAndConstants/geo_types.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dba/DetectorClocksService_8h.html">lardata/DetectorInfoServices/DetectorClocksService.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d9f/LArPropertiesService_8h.html">lardata/DetectorInfoServices/LArPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dbc/DetectorProperties_8h.html">lardataalg/DetectorInfo/DetectorProperties.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">struct </span>PlnLen {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> index;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">float</span> length;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  };</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  greaterThan1(PlnLen <a class="code" href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a>, PlnLen p2)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">return</span> p1.length &gt; p2.length;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>trkf {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae5703e0734ac5f293f546c5407f97a86">   41</a></span>&#160;  <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae5703e0734ac5f293f546c5407f97a86">CosmicTrackerAlg::CosmicTrackerAlg</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; pset)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a391674a3860f4a6cd0b5cbb66ec6f508">fSPTAlg</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;SPTAlg&quot;</span>, 0);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#adcf164a6f1dd441c5bc73779552e583e">fTrajOnly</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;TrajOnly&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;TMatch&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8ed3d7a059f58a49436b4e944c6d9e84">fsmatch</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;SMatch&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">//---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5edd69557460af6a0600338078e08a7c">   51</a></span>&#160;  <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5edd69557460af6a0600338078e08a7c">CosmicTrackerAlg::SPTReco</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                            <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                            <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; fHits)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.clear();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>.clear();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae8a7838533ad74df90aafb501eae24f6">trajHit</a>.clear();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a1b222bd14b03b1d54416ed89e0f085c3">trkPos</a>.clear();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkDir</a>.clear();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a391674a3860f4a6cd0b5cbb66ec6f508">fSPTAlg</a> == 0) { <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a871eb067bb738331244e8d9acce64285">TrackTrajectory</a>(detProp, fHits); }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a391674a3860f4a6cd0b5cbb66ec6f508">fSPTAlg</a> == 1) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac74d428aa7aac29787ff12796af51d1e">Track3D</a>(clockData, detProp, fHits);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;CosmicTrackerAlg&quot;</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Unknown SPTAlg &quot;</span> &lt;&lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a391674a3860f4a6cd0b5cbb66ec6f508">fSPTAlg</a> &lt;&lt; <span class="stringliteral">&quot;, needs to be 0 or 1&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#adcf164a6f1dd441c5bc73779552e583e">fTrajOnly</a> &amp;&amp; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.size())</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a709a93cd662ed31dce040114640b5c3c">MakeSPT</a>(clockData, detProp, fHits);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a1b222bd14b03b1d54416ed89e0f085c3">trkPos</a> = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkDir</a> = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">//---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a871eb067bb738331244e8d9acce64285">   81</a></span>&#160;  <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a871eb067bb738331244e8d9acce64285">CosmicTrackerAlg::TrackTrajectory</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                    <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; fHits)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Track hit vectors for fitting the trajectory</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::array&lt;std::vector&lt;geo::WireID&gt;, 3&gt; trkWID;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::array&lt;std::vector&lt;double&gt;, 3&gt; trkX;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::array&lt;std::vector&lt;double&gt;, 3&gt; trkXErr;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    std::array&lt;std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt;, 3&gt; trajHits;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; fHits.size(); ++i) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      trajHits[fHits[i]-&gt;WireID().Plane].push_back(fHits[i]);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    std::vector&lt;PlnLen&gt; spl;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    PlnLen plnlen;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      plnlen.index = ipl;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      plnlen.length = trajHits[ipl].size();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      spl.push_back(plnlen);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    std::sort(spl.begin(), spl.end(), greaterThan1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// spl[0] has the most hits and spl.back() has the least</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span> (!trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordtype">double</span> xbeg0 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(trajHits[spl[0].index][0]-&gt;PeakTime(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                             trajHits[spl[0].index][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                             trajHits[spl[0].index][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                             trajHits[spl[0].index][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">double</span> xend0 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(trajHits[spl[0].index].back()-&gt;PeakTime(),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                             trajHits[spl[0].index].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a>,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                             trajHits[spl[0].index].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                             trajHits[spl[0].index].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">double</span> xbeg1 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(trajHits[ipl][0]-&gt;PeakTime(),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                             trajHits[ipl][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                             trajHits[ipl][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                             trajHits[ipl][0]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">double</span> xend1 = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(trajHits[ipl].back()-&gt;PeakTime(),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                             trajHits[ipl].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                             trajHits[ipl].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                             trajHits[ipl].back()-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordtype">double</span> dx1 = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xbeg0 - xbeg1) + <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xend0 - xend1);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordtype">double</span> dx2 = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xbeg0 - xend1) + <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xend0 - xbeg1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(xbeg1 - xend1) &gt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            0.2 <span class="comment">// this is to make sure the track is not completely flat in t,</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="comment">// different by ~2.5 ticks</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          &amp;&amp; dx2 &lt; dx1) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        std::reverse(trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(), trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>());</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// make the track trajectory</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ipl = 0; ipl &lt; 3; ++ipl) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// if (ipl == spl.back().index) continue;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      trkWID[ipl].resize(trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      trkX[ipl].resize(trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      trkXErr[ipl].resize(trajHits[ipl].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iht = 0; iht &lt; trajHits[ipl].size(); ++iht) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        trkWID[ipl][iht] = trajHits[ipl][iht]-&gt;WireID();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        trkX[ipl][iht] = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(trajHits[ipl][iht]-&gt;PeakTime(),</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                                 ipl,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                                 trajHits[ipl][iht]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                 trajHits[ipl][iht]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        trkXErr[ipl][iht] = 0.2 * trajHits[ipl][iht]-&gt;RMS() * trajHits[ipl][iht]-&gt;Multiplicity();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      } <span class="comment">// iht</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }   <span class="comment">// ip</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a0e6a4ffbf4351e549c9da068c2a15447">fTrackTrajectoryAlg</a>.<a class="code" href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html#a10fb05f930beefa0e0a7da711e35edb9">TrackTrajectory</a>(trkWID, trkX, trkXErr, <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>, <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.size() || !<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>.size()) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;CosmicTrackerAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Failed to reconstruct trajectory points.&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">//remove duplicated points</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> ipos = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.begin(), idir = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>.begin(); ipos != <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.end() - 1;) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keyword">auto</span> ipos1 = ipos + 1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (*ipos1 == *ipos) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        ipos = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.erase(ipos);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        idir = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>.erase(idir);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        ++ipos;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        ++idir;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>.clear();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>.clear();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>.clear();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>.resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Ncryostats());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>.resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Ncryostats());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>.resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Ncryostats());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> cstat = 0; cstat &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Ncryostats(); ++cstat) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat].resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Cryostat(cstat).NTPC());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat].resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Cryostat(cstat).NTPC());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat].resize(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Cryostat(cstat).NTPC());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tpc = 0; tpc &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Cryostat(cstat).NTPC(); ++tpc) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; tpcgeom = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;Cryostat(cstat).TPC(tpc);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc].resize(tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc].resize(tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat][tpc].resize(tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>());</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> plane = 0; plane &lt; tpcgeom.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>(); ++plane) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.size(); ++i) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordtype">double</span> wirecord =</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;WireCoordinate(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[i].Y(), <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[i].Z(), plane, tpc, cstat);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">tick</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">ConvertXToTicks</a>(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[i].<a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a>(), plane, tpc, cstat);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane].push_back(wirecord);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane].push_back(tick);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat][tpc][plane].push_back(i);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          } <span class="comment">// trajPos.size()</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }   <span class="comment">// plane</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }     <span class="comment">// tpc</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }       <span class="comment">// cstat</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">//---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac74d428aa7aac29787ff12796af51d1e">  195</a></span>&#160;  <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac74d428aa7aac29787ff12796af51d1e">CosmicTrackerAlg::Track3D</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                            <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                            <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; fHits)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5b05ed07fb1fd4d2a26ef429f01e3e58">larprop</a> = lar::providerFrom&lt;detinfo::LArPropertiesService&gt;();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//save time/hit information along track trajectory</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    std::vector&lt;std::map&lt;int, double&gt;&gt; vtimemap(3);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    std::vector&lt;std::map&lt;int, art::Ptr&lt;recob::Hit&gt;&gt;&gt; vhitmap(3);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">//find hit on each wire along the fitted line</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ihit = 0; ihit &lt; fHits.size(); ++ihit) { <span class="comment">//loop over hits</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> hitWireID = fHits[ihit]-&gt;<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">WireID</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = hitWireID.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pl = hitWireID.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordtype">double</span> time = fHits[ihit]-&gt;PeakTime();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      time -= detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">GetXTicksOffset</a>(</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        fHits[ihit]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">Plane</a>, fHits[ihit]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().<a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a>, fHits[ihit]-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      vtimemap[pl][<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>] = time;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      vhitmap[pl][<a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>] = fHits[ihit];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// Find two clusters with the most numbers of hits, and time ranges</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">int</span> iclu1 = -1;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> iclu2 = -1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">int</span> iclu3 = -1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">unsigned</span> maxnumhits0 = 0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">unsigned</span> maxnumhits1 = 0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    std::vector&lt;double&gt; tmin(vtimemap.size());</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::vector&lt;double&gt; tmax(vtimemap.size());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iclu = 0; iclu &lt; vtimemap.size(); ++iclu) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      tmin[iclu] = 1e9;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      tmax[iclu] = -1e9;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iclu = 0; iclu &lt; vtimemap.size(); ++iclu) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> itime = vtimemap[iclu].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(); itime != vtimemap[iclu].end(); ++itime) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (itime-&gt;second &gt; tmax[iclu]) { tmax[iclu] = itime-&gt;second; }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (itime-&gt;second &lt; tmin[iclu]) { tmin[iclu] = itime-&gt;second; }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">if</span> (vtimemap[iclu].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; maxnumhits0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> (iclu1 != -1) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          iclu2 = iclu1;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          maxnumhits1 = maxnumhits0;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        iclu1 = iclu;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        maxnumhits0 = vtimemap[iclu].size();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vtimemap[iclu].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() &gt; maxnumhits1) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        iclu2 = iclu;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        maxnumhits1 = vtimemap[iclu].size();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    std::swap(iclu1, iclu2); <span class="comment">//now iclu1 has fewer hits than iclu2</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//find iclu3</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iclu = 0; iclu &lt; (int)vtimemap.size(); ++iclu) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">if</span> (iclu != iclu1 &amp;&amp; iclu != iclu2) iclu3 = iclu;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (iclu1 != -1 &amp;&amp; iclu2 != -1) { <span class="comment">//at least two good clusters</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">//select hits in a common time range</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keyword">auto</span> ihit = vhitmap[iclu1].begin();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">auto</span> itime = vtimemap[iclu1].begin();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">while</span> (itime != vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>()) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> (itime-&gt;second &lt; std::max(tmin[iclu1], tmin[iclu2]) - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a> ||</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            itime-&gt;second &gt; std::min(tmax[iclu1], tmax[iclu2]) + <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a>) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          vtimemap[iclu1].erase(itime++);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          vhitmap[iclu1].erase(ihit++);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          ++itime;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          ++ihit;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      ihit = vhitmap[iclu2].begin();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      itime = vtimemap[iclu2].begin();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">while</span> (itime != vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>()) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> (itime-&gt;second &lt; std::max(tmin[iclu1], tmin[iclu2]) - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a> ||</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            itime-&gt;second &gt; std::min(tmax[iclu1], tmax[iclu2]) + <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          vtimemap[iclu2].erase(itime++);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          vhitmap[iclu2].erase(ihit++);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          ++itime;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          ++ihit;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="comment">//if one cluster is empty, replace it with iclu3</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">if</span> (!vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span> (iclu3 != -1) { std::swap(iclu3, iclu1); }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (!vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (iclu3 != -1) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          std::swap(iclu3, iclu2);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          std::swap(iclu1, iclu2);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">if</span> ((!vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>()) || (!vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>())) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordtype">bool</span> rev = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keyword">auto</span> times1 = vtimemap[iclu1].begin();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keyword">auto</span> timee1 = vtimemap[iclu1].end();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      --timee1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keyword">auto</span> times2 = vtimemap[iclu2].begin();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keyword">auto</span> timee2 = vtimemap[iclu2].end();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      --timee2;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">double</span> ts1 = times1-&gt;second;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordtype">double</span> te1 = timee1-&gt;second;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordtype">double</span> ts2 = times2-&gt;second;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordtype">double</span> te2 = timee2-&gt;second;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">//find out if we need to flip ends</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ts1 - ts2) + <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(te1 - te2) &gt; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(ts1 - te2) + <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(te1 - ts2)) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        rev = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordtype">double</span> timetick = <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-3; <span class="comment">// time sample in us</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordtype">double</span> Efield_drift = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">Efield</a>(0);    <span class="comment">// Electric Field in the drift region in kV/cm</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordtype">double</span> Temperature = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">Temperature</a>(); <span class="comment">// LAr Temperature in K</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordtype">double</span> driftvelocity = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>(</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        Efield_drift, Temperature); <span class="comment">//drift velocity in the drift region (cm/us)</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordtype">double</span> timepitch = driftvelocity * timetick;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordtype">double</span> wire_pitch =</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;WirePitch(vhitmap[0].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>()-&gt;<a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a>-&gt;WireID().Plane,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        vhitmap[0].begin()-&gt;second-&gt;WireID().TPC,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        vhitmap[0].begin()-&gt;second-&gt;WireID().Cryostat); <span class="comment">//wire pitch in cm</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">//find out 2d track length for all clusters associated with track candidate</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      std::vector&lt;double&gt; vtracklength;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iclu = 0; iclu &lt; vtimemap.size(); ++iclu) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordtype">double</span> tracklength = 0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> (vtimemap[iclu].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 1) { tracklength = wire_pitch; }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!vtimemap[iclu].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>()) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          std::map&lt;int, double&gt;::const_iterator iw = vtimemap[iclu].cbegin(),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                wend = vtimemap[iclu].cend();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">t0</a> = iw-&gt;first, w0 = iw-&gt;second;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordflow">while</span> (++iw != wend) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            tracklength += std::hypot((iw-&gt;first - w0) * wire_pitch, (iw-&gt;second - t0) * timepitch);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            w0 = iw-&gt;first;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            t0 = iw-&gt;second;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          } <span class="comment">// while</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        vtracklength.push_back(tracklength);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      std::map&lt;int, int&gt; maxhitsMatch;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">auto</span> ihit1 = vhitmap[iclu1].begin();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> itime1 = vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(); itime1 != vtimemap[iclu1].end();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;           ++itime1, ++ihit1) { <span class="comment">//loop over min-hits</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        std::vector&lt;art::Ptr&lt;recob::Hit&gt;&gt; sp_hits;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        sp_hits.push_back(ihit1-&gt;second);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordtype">double</span> hitcoord[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordtype">double</span> length1 = 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">if</span> (vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 1) { length1 = wire_pitch; }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> iw1 = vtimemap[iclu1].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(); iw1 != itime1; ++iw1) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keyword">auto</span> iw2 = iw1;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            ++iw2;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            length1 += std::hypot((iw1-&gt;first - iw2-&gt;first) * wire_pitch,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                  (iw1-&gt;second - iw2-&gt;second) * timepitch);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">double</span> difference = 1<a class="code" href="../../d0/d99/find__fhicl_8sh.html#aa4aecb6cd354969e2c1a2583d6f45ac9">e10</a>; <span class="comment">//distance between two matched hits</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keyword">auto</span> matchedtime = vtimemap[iclu2].end();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keyword">auto</span> matchedhit = vhitmap[iclu2].end();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keyword">auto</span> ihit2 = vhitmap[iclu2].begin();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> itime2 = vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(); itime2 != vtimemap[iclu2].end();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;             ++itime2, ++ihit2) { <span class="comment">//loop over max-hits</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="keywordflow">if</span> (maxhitsMatch[itime2-&gt;first]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <span class="keywordtype">double</span> length2 = 0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="keywordflow">if</span> (vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>() == 1) { length2 = wire_pitch; }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iw1 = vtimemap[iclu2].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">begin</a>(); iw1 != itime2; ++iw1) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;              <span class="keyword">auto</span> iw2 = iw1;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;              ++iw2;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              length2 += std::hypot((iw1-&gt;first - iw2-&gt;first) * wire_pitch,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                    (iw1-&gt;second - iw2-&gt;second) * timepitch);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordflow">if</span> (rev) length2 = vtracklength[iclu2] - length2;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          length2 = vtracklength[iclu1] / vtracklength[iclu2] * length2;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="keywordtype">bool</span> timematch = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(itime1-&gt;second - itime2-&gt;second) &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">ftmatch</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <span class="keywordflow">if</span> (timematch &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(length2 - length1) &lt; difference) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            difference = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(length2 - length1);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            matchedtime = itime2;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            matchedhit = ihit2;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        } <span class="comment">//loop over hits2</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (difference &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8ed3d7a059f58a49436b4e944c6d9e84">fsmatch</a>) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          hitcoord[0] = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            matchedtime-&gt;second + detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">GetXTicksOffset</a>((matchedhit-&gt;second)-&gt;WireID().Plane,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                          (matchedhit-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().TPC,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                          (matchedhit-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat),</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            (matchedhit-&gt;second)-&gt;WireID().Plane,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            (matchedhit-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().TPC,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            (matchedhit-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>().Cryostat);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          hitcoord[1] = -1<a class="code" href="../../d0/d99/find__fhicl_8sh.html#aa4aecb6cd354969e2c1a2583d6f45ac9">e10</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          hitcoord[2] = -1<a class="code" href="../../d0/d99/find__fhicl_8sh.html#aa4aecb6cd354969e2c1a2583d6f45ac9">e10</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="comment">//WireID is the exact segment of the wire where the hit is on (1 out of 3 for the 35t)</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> c1 = (ihit1-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> c2 = (matchedhit-&gt;second)-&gt;<a class="code" href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">WireID</a>();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a> tmpWIDI;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="keywordtype">bool</span> sameTpcOrNot = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;WireIDsIntersect(c1, c2, tmpWIDI);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="keywordflow">if</span> (sameTpcOrNot) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            hitcoord[1] = tmpWIDI.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">y</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            hitcoord[2] = tmpWIDI.<a class="code" href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">z</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          <span class="keywordflow">if</span> (hitcoord[1] &gt; -1e9 &amp;&amp; hitcoord[2] &gt; -1e9) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            maxhitsMatch[matchedtime-&gt;first] = 1;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            sp_hits.push_back(matchedhit-&gt;second);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        } <span class="comment">//if (difference&lt;fsmatch)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span> (sp_hits.size() &gt; 1) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>.push_back(TVector3(hitcoord));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae8a7838533ad74df90aafb501eae24f6">trajHit</a>.push_back(sp_hits);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      } <span class="comment">//loop over hits1</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }   <span class="comment">//if (iclu1!=-1&amp;&amp;iclu2!=-1){//at least two good clusters</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">//---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a709a93cd662ed31dce040114640b5c3c">  434</a></span>&#160;  <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a709a93cd662ed31dce040114640b5c3c">CosmicTrackerAlg::MakeSPT</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                            <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>&lt;art::Ptr&lt;recob::Hit&gt;&gt;&amp; fHits)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5b05ed07fb1fd4d2a26ef429f01e3e58">larprop</a> = lar::providerFrom&lt;detinfo::LArPropertiesService&gt;();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">double</span> timetick = <a class="code" href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">sampling_rate</a>(clockData) * 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-3; <span class="comment">// time sample in us</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">double</span> Efield_drift = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">Efield</a>(0);    <span class="comment">// Electric Field in the drift region in kV/cm</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">double</span> Temperature = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">Temperature</a>(); <span class="comment">// LAr Temperature in K</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">double</span> driftvelocity =</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>(Efield_drift, Temperature); <span class="comment">//drift velocity in the drift region (cm/us)</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">double</span> time_pitch = driftvelocity * timetick;       <span class="comment">//time sample (cm)</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; fHits.size(); ++i) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordtype">int</span> ip1 = -1;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordtype">int</span> ip2 = -1;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordtype">int</span> ip2p = -1;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">int</span> ih1 = -1;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordtype">int</span> ih2 = -1;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordtype">int</span> ih2p = -1;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordtype">double</span> mindis1 = 1e9;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordtype">double</span> mindis2 = 1e9;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordtype">double</span> mindis2p = 1e9;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> wireid = fHits[i]-&gt;<a class="code" href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">WireID</a>();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> wire = wireid.<a class="code" href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">Wire</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plane = wireid.<a class="code" href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">Plane</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tpc = wireid.<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">TPC</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cstat = wireid.<a class="code" href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">Cryostat</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordtype">double</span> wire_pitch = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">geom</a>-&gt;WirePitch(plane, tpc, cstat); <span class="comment">//wire pitch in cm</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="comment">//find the two trajectory points that enclose the hit</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">//find the nearest trajectory point first</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane].size(); ++j) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordtype">double</span> dis = std::hypot(wire_pitch * (wire - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][j]),</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                time_pitch * (fHits[i]-&gt;PeakTime() - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][j]));</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span> (dis &lt; mindis1) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          mindis1 = dis;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          ip1 = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat][tpc][plane][j];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          ih1 = j;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="comment">//find the second nearest trajectory point, prefer the point on the other side</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane].size(); ++j) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(j) == ih1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordtype">double</span> dis = std::hypot(wire_pitch * (wire - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][j]),</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                time_pitch * (fHits[i]-&gt;PeakTime() - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][j]));</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (dis &lt; mindis2) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          mindis2 = dis;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          ip2 = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat][tpc][plane][j];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          ih2 = j;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        TVector3 v1(wire_pitch * (wire - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][ih1]),</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    time_pitch * (fHits[i]-&gt;PeakTime() - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][j]),</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    0);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        TVector3 v2(wire_pitch * (wire - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][j]),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    time_pitch * (fHits[i]-&gt;PeakTime() - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][j]),</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">if</span> (v1.Dot(v2) &lt; 0) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          <span class="keywordflow">if</span> (dis &lt; mindis2p) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            mindis2p = dis;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            ip2p = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">vtraj</a>[cstat][tpc][plane][j];</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            ih2p = j;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> (ip2p != -1) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        ip2 = ip2p;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        ih2 = ih2p;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (ip1 == -1 || ip2 == -1) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;CosmicTrackerAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Cannot find two nearest trajectory points.&quot;</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      TVector3 v1(wire_pitch * (wire - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][ih1]),</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  time_pitch * (fHits[i]-&gt;PeakTime() - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][ih1]),</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                  0);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      TVector3 v2(wire_pitch * (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][ih2] - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">vw</a>[cstat][tpc][plane][ih1]),</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  time_pitch * (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][ih2] - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">vt</a>[cstat][tpc][plane][ih1]),</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                  0);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">if</span> (!v2.Mag()) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;CosmicTrackerAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Two identical trajectory points.&quot;</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordtype">double</span> ratio = v1.Dot(v2) / v2.Mag2();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      TVector3 pos = <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[ip1] + ratio * (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[ip2] - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[ip1]);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a1b222bd14b03b1d54416ed89e0f085c3">trkPos</a>.push_back(pos);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>[ip1].Mag()) { <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkDir</a>.push_back(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>[ip1]); }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>[ip2].Mag()) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkDir</a>.push_back(<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trajDir</a>[ip2]);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">else</span> { <span class="comment">//only got two trajectory points?</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkDir</a>.push_back((<a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[ip2] - <a class="code" href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trajPos</a>[ip1]).Unit());</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    } <span class="comment">//i</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;} <span class="comment">//namespace trkf</span></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_af657debe6fd8311b148a5a96fd865c37"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#af657debe6fd8311b148a5a96fd865c37">trkf::CosmicTrackerAlg::vw</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &gt; vw</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00077">CosmicTrackerAlg.h:77</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html_a99e74ffcbcfd46cdb9754cde0a2019a1"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a99e74ffcbcfd46cdb9754cde0a2019a1">geo::WireIDIntersection::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">z position of intersection </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00805">geo_types.h:805</a></div></div>
<div class="ttc" id="detectorproperties__icarus_8fcl_html_acfd440223f806c44323dbd1053b99123"><div class="ttname"><a href="../../d1/d33/detectorproperties__icarus_8fcl.html#acfd440223f806c44323dbd1053b99123">second</a></div><div class="ttdeci">second</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d33/detectorproperties__icarus_8fcl_source.html#l00008">detectorproperties_icarus.fcl:8</a></div></div>
<div class="ttc" id="ServiceUtil_8h_html"><div class="ttname"><a href="../../d4/d2e/ServiceUtil_8h.html">ServiceUtil.h</a></div><div class="ttdoc">Utilities related to art service access. </div></div>
<div class="ttc" id="CryostatGeo_8h_html"><div class="ttname"><a href="../../df/d13/CryostatGeo_8h.html">CryostatGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single cyostat. </div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a7c11e12fc7a7a4acb78edf575d746fa2"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a7c11e12fc7a7a4acb78edf575d746fa2">trkf::CosmicTrackerAlg::vt</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &gt; vt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00078">CosmicTrackerAlg.h:78</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_aab70d56abcbcbda28f66353a7a92a588"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#aab70d56abcbcbda28f66353a7a92a588">detinfo::DetectorPropertiesData::GetXTicksOffset</a></div><div class="ttdeci">double GetXTicksOffset(int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00148">DetectorPropertiesData.cc:148</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ab3391de99203f6a60eeeef152d3adb35"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">geo::TPCGeo::Nplanes</a></div><div class="ttdeci">unsigned int Nplanes() const </div><div class="ttdoc">Number of planes in this tpc. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00165">TPCGeo.h:165</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_ac265e2c265f30f49c56639a1182040e0"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac265e2c265f30f49c56639a1182040e0">trkf::CosmicTrackerAlg::ftmatch</a></div><div class="ttdeci">double ftmatch</div><div class="ttdoc">tolerance for time matching (in ticks) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00065">CosmicTrackerAlg.h:65</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a726fd2493300deadcdf94ca80bbbc9a0"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">detinfo::DetectorPropertiesData::Temperature</a></div><div class="ttdeci">double Temperature() const </div><div class="ttdoc">In kelvin. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00081">DetectorPropertiesData.cc:81</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a8c6192b9e2074a543078c03d84869fad"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8c6192b9e2074a543078c03d84869fad">trkf::CosmicTrackerAlg::trajPos</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; trajPos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00042">CosmicTrackerAlg.h:42</a></div></div>
<div class="ttc" id="structgeo_1_1CryostatID_html_a2bfb744818e075d94be15dd18c950441"><div class="ttname"><a href="../../d9/d73/structgeo_1_1CryostatID.html#a2bfb744818e075d94be15dd18c950441">geo::CryostatID::Cryostat</a></div><div class="ttdeci">CryostatID_t Cryostat</div><div class="ttdoc">Index of cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00212">geo_types.h:212</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a09ed79d833f1a3021084dbf9abb66760"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a09ed79d833f1a3021084dbf9abb66760">trkf::CosmicTrackerAlg::trkDir</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; trkDir</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00048">CosmicTrackerAlg.h:48</a></div></div>
<div class="ttc" id="DetectorProperties_8h_html"><div class="ttname"><a href="../../d5/dbc/DetectorProperties_8h.html">DetectorProperties.h</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_ac303d2971eb9697f3a65821bb92bb934"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#ac303d2971eb9697f3a65821bb92bb934">geo::WireID::Wire</a></div><div class="ttdeci">WireID_t Wire</div><div class="ttdoc">Index of the wire within its plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00580">geo_types.h:580</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="sbnd__flashalgo_8fcl_html_a648c7afac4085c93cd1ba4a75dfe8818"><div class="ttname"><a href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a></div><div class="ttdeci">BEGIN_PROLOG TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d22/sbnd__flashalgo_8fcl_source.html#l00014">sbnd_flashalgo.fcl:14</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a87dfb4de332731a6219f2393ac5d11d5"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">detinfo::DetectorPropertiesData::Efield</a></div><div class="ttdeci">double Efield(unsigned int planegap=0) const </div><div class="ttdoc">kV/cm </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00017">DetectorPropertiesData.cc:17</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a871eb067bb738331244e8d9acce64285"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a871eb067bb738331244e8d9acce64285">trkf::CosmicTrackerAlg::TrackTrajectory</a></div><div class="ttdeci">void TrackTrajectory(detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;fHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/CosmicTrackerAlg_8cxx_source.html#l00081">CosmicTrackerAlg.cxx:81</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="namespacemake__calib__df_html_a2b8237bac57d5c373c623869ad4513c8"><div class="ttname"><a href="../../d6/d11/namespacemake__calib__df.html#a2b8237bac57d5c373c623869ad4513c8">make_calib_df.t0</a></div><div class="ttdeci">int t0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d0e/make__calib__df_8py_source.html#l00042">make_calib_df.py:42</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a93cf5d0f75389b5f6a8e1d1c1478d169"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a93cf5d0f75389b5f6a8e1d1c1478d169">trkf::CosmicTrackerAlg::vtraj</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; unsigned int &gt; &gt; &gt; &gt; vtraj</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00079">CosmicTrackerAlg.h:79</a></div></div>
<div class="ttc" id="namespacegeo_1_1fhicl_html_a48509e22b6681725c899fc354de43ae2"><div class="ttname"><a href="../../d2/d66/namespacegeo_1_1fhicl.html#a48509e22b6681725c899fc354de43ae2">geo::fhicl::WireID</a></div><div class="ttdeci">IDparameter&lt; geo::WireID &gt; WireID</div><div class="ttdoc">Member type of validated geo::WireID parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddc/geo__types__fhicl_8h_source.html#l00407">geo_types_fhicl.h:407</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a0e6a4ffbf4351e549c9da068c2a15447"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a0e6a4ffbf4351e549c9da068c2a15447">trkf::CosmicTrackerAlg::fTrackTrajectoryAlg</a></div><div class="ttdeci">TrackTrajectoryAlg fTrackTrajectoryAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00074">CosmicTrackerAlg.h:74</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="namespaceutil_1_1quantities_html_a1a08bc762b79d6e1d7816c34d3e36f78"><div class="ttname"><a href="../../d3/d63/namespaceutil_1_1quantities.html#a1a08bc762b79d6e1d7816c34d3e36f78">util::quantities::tick</a></div><div class="ttdeci">tick_as&lt;&gt; tick</div><div class="ttdoc">Tick number, represented by std::ptrdiff_t. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d57/electronics_8h_source.html#l00075">electronics.h:75</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a359d6255bb14f321d76e6085204ea52a"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a359d6255bb14f321d76e6085204ea52a">detinfo::DetectorPropertiesData::ConvertXToTicks</a></div><div class="ttdeci">double ConvertXToTicks(double X, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00099">DetectorPropertiesData.cc:99</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html">geo::WireIDIntersection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00803">geo_types.h:803</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_ae5703e0734ac5f293f546c5407f97a86"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae5703e0734ac5f293f546c5407f97a86">trkf::CosmicTrackerAlg::CosmicTrackerAlg</a></div><div class="ttdeci">CosmicTrackerAlg(fhicl::ParameterSet const &amp;pset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/CosmicTrackerAlg_8cxx_source.html#l00041">CosmicTrackerAlg.cxx:41</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a5667a83a4014a59ccd6c2a0d0fbb58c1"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">detinfo::DetectorPropertiesData::DriftVelocity</a></div><div class="ttdeci">double DriftVelocity(double efield=0., double temperature=0.) const </div><div class="ttdoc">cm/us </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00023">DetectorPropertiesData.cc:23</a></div></div>
<div class="ttc" id="structgeo_1_1PlaneID_html_a02c2afa6841ef86ea8ab49478cdf5b29"><div class="ttname"><a href="../../d4/d41/structgeo_1_1PlaneID.html#a02c2afa6841ef86ea8ab49478cdf5b29">geo::PlaneID::Plane</a></div><div class="ttdeci">PlaneID_t Plane</div><div class="ttdoc">Index of the plane within its TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00493">geo_types.h:493</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a8ed3d7a059f58a49436b4e944c6d9e84"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a8ed3d7a059f58a49436b4e944c6d9e84">trkf::CosmicTrackerAlg::fsmatch</a></div><div class="ttdeci">double fsmatch</div><div class="ttdoc">tolerance for distance matching (in cm) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00066">CosmicTrackerAlg.h:66</a></div></div>
<div class="ttc" id="classtrkf_1_1TrackTrajectoryAlg_html_a10fb05f930beefa0e0a7da711e35edb9"><div class="ttname"><a href="../../d9/d5b/classtrkf_1_1TrackTrajectoryAlg.html#a10fb05f930beefa0e0a7da711e35edb9">trkf::TrackTrajectoryAlg::TrackTrajectory</a></div><div class="ttdeci">void TrackTrajectory(std::array&lt; std::vector&lt; geo::WireID &gt;, 3 &gt; trkWID, std::array&lt; std::vector&lt; double &gt;, 3 &gt; trkX, std::array&lt; std::vector&lt; double &gt;, 3 &gt; trkXErr, std::vector&lt; TVector3 &gt; &amp;TrajPos, std::vector&lt; TVector3 &gt; &amp;TrajDir)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d02/TrackTrajectoryAlg_8cxx_source.html#l00023">TrackTrajectoryAlg.cxx:23</a></div></div>
<div class="ttc" id="geo__types_8h_html"><div class="ttname"><a href="../../d8/d48/geo__types_8h.html">geo_types.h</a></div><div class="ttdoc">Definition of data types for geometry description. </div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="CosmicTrackerAlg_8h_html"><div class="ttname"><a href="../../dc/d33/CosmicTrackerAlg_8h.html">CosmicTrackerAlg.h</a></div></div>
<div class="ttc" id="classrecob_1_1tracking_1_1Plane_html"><div class="ttname"><a href="../../d9/dff/classrecob_1_1tracking_1_1Plane.html">recob::tracking::Plane</a></div><div class="ttdoc">Class defining a plane for tracking. It provides various functionalities to convert track parameters ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1e/TrackingPlane_8h_source.html#l00037">TrackingPlane.h:37</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8e4b4b8d755ffded5a9f956ae7c9c1ec"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">detinfo::DetectorPropertiesData::ConvertTicksToX</a></div><div class="ttdeci">double ConvertTicksToX(double ticks, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00115">DetectorPropertiesData.cc:115</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a2ca6bc6c36013dddc54383620e0d7db1"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a2ca6bc6c36013dddc54383620e0d7db1">trkf::CosmicTrackerAlg::geom</a></div><div class="ttdeci">art::ServiceHandle&lt; geo::Geometry const  &gt; geom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00081">CosmicTrackerAlg.h:81</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a5b05ed07fb1fd4d2a26ef429f01e3e58"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5b05ed07fb1fd4d2a26ef429f01e3e58">trkf::CosmicTrackerAlg::larprop</a></div><div class="ttdeci">const detinfo::LArProperties * larprop</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00082">CosmicTrackerAlg.h:82</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a1b222bd14b03b1d54416ed89e0f085c3"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a1b222bd14b03b1d54416ed89e0f085c3">trkf::CosmicTrackerAlg::trkPos</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; trkPos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00047">CosmicTrackerAlg.h:47</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a391674a3860f4a6cd0b5cbb66ec6f508"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a391674a3860f4a6cd0b5cbb66ec6f508">trkf::CosmicTrackerAlg::fSPTAlg</a></div><div class="ttdeci">int fSPTAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00051">CosmicTrackerAlg.h:51</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a709a93cd662ed31dce040114640b5c3c"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a709a93cd662ed31dce040114640b5c3c">trkf::CosmicTrackerAlg::MakeSPT</a></div><div class="ttdeci">void MakeSPT(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;fHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/CosmicTrackerAlg_8cxx_source.html#l00434">CosmicTrackerAlg.cxx:434</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_adcf164a6f1dd441c5bc73779552e583e"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#adcf164a6f1dd441c5bc73779552e583e">trkf::CosmicTrackerAlg::fTrajOnly</a></div><div class="ttdeci">bool fTrajOnly</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00054">CosmicTrackerAlg.h:54</a></div></div>
<div class="ttc" id="structgeo_1_1WireIDIntersection_html_a10d38a5448d172ff4c9879e0a349fbc3"><div class="ttname"><a href="../../da/d3d/structgeo_1_1WireIDIntersection.html#a10d38a5448d172ff4c9879e0a349fbc3">geo::WireIDIntersection::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">y position of intersection </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00804">geo_types.h:804</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_a5edd69557460af6a0600338078e08a7c"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#a5edd69557460af6a0600338078e08a7c">trkf::CosmicTrackerAlg::SPTReco</a></div><div class="ttdeci">void SPTReco(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;fHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/CosmicTrackerAlg_8cxx_source.html#l00051">CosmicTrackerAlg.cxx:51</a></div></div>
<div class="ttc" id="DetectorClocksService_8h_html"><div class="ttname"><a href="../../d3/dba/DetectorClocksService_8h.html">DetectorClocksService.h</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html_a27e19a98be832681be8967bb9da9b6e6"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html#a27e19a98be832681be8967bb9da9b6e6">geo::WireID::WireID</a></div><div class="ttdeci">constexpr WireID()=default</div><div class="ttdoc">Default constructor: an invalid TPC ID. </div></div>
<div class="ttc" id="find__fhicl_8sh_html_aa4aecb6cd354969e2c1a2583d6f45ac9"><div class="ttname"><a href="../../d0/d99/find__fhicl_8sh.html#aa4aecb6cd354969e2c1a2583d6f45ac9">e10</a></div><div class="ttdeci">then echo ***************************************echo Variable FHICL_FILE_PATH not found echo You porbably haven t set up larsoft echo Try setup uboonecode vXX_XX_XX q e10</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/find__fhicl_8sh_source.html#l00006">find_fhicl.sh:6</a></div></div>
<div class="ttc" id="LArPropertiesService_8h_html"><div class="ttname"><a href="../../da/d9f/LArPropertiesService_8h.html">LArPropertiesService.h</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html_a4a7f86b46d9d48a040b7ef5d65973811"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html#a4a7f86b46d9d48a040b7ef5d65973811">geo::TPCID::TPC</a></div><div class="ttdeci">TPCID_t TPC</div><div class="ttdoc">Index of the TPC within its cryostat. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00406">geo_types.h:406</a></div></div>
<div class="ttc" id="namespacedetinfo_html_a0c4d3d5b85e37497364174c3513ffcae"><div class="ttname"><a href="../../d7/d8a/namespacedetinfo.html#a0c4d3d5b85e37497364174c3513ffcae">detinfo::sampling_rate</a></div><div class="ttdeci">double sampling_rate(DetectorClocksData const &amp;data)</div><div class="ttdoc">Returns the period of the TPC readout electronics clock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00643">DetectorClocksData.h:643</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_afc0f6f45707370727959980f496bffd2"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#afc0f6f45707370727959980f496bffd2">trkf::CosmicTrackerAlg::trajDir</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; trajDir</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00043">CosmicTrackerAlg.h:43</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a74da18d4f0023feee71c1352a99b3910"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">icarus::ns::util::empty</a></div><div class="ttdeci">bool empty(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00555">FixedBins.h:555</a></div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_ac74d428aa7aac29787ff12796af51d1e"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ac74d428aa7aac29787ff12796af51d1e">trkf::CosmicTrackerAlg::Track3D</a></div><div class="ttdeci">void Track3D(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, std::vector&lt; art::Ptr&lt; recob::Hit &gt;&gt; &amp;fHits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/CosmicTrackerAlg_8cxx_source.html#l00195">CosmicTrackerAlg.cxx:195</a></div></div>
<div class="ttc" id="test__associatedgroupswithleft__full_8fcl_html_a4814f2598ed6acdb806473d732f33889"><div class="ttname"><a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl.html#a4814f2598ed6acdb806473d732f33889">p1</a></div><div class="ttdeci">physics associatedGroupsWithLeft p1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dab/test__associatedgroupswithleft__full_8fcl_source.html#l00024">test_associatedgroupswithleft_full.fcl:24</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="TPCGeo_8h_html"><div class="ttname"><a href="../../df/de9/TPCGeo_8h.html">TPCGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
<div class="ttc" id="classtrkf_1_1CosmicTrackerAlg_html_ae8a7838533ad74df90aafb501eae24f6"><div class="ttname"><a href="../../d4/d3e/classtrkf_1_1CosmicTrackerAlg.html#ae8a7838533ad74df90aafb501eae24f6">trkf::CosmicTrackerAlg::trajHit</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; art::Ptr&lt; recob::Hit &gt; &gt; &gt; trajHit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/CosmicTrackerAlg_8h_source.html#l00044">CosmicTrackerAlg.h:44</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
