<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>larg4::LArVoxelReadout Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d7/d6f/namespacelarg4.html">larg4</a></li><li class="navelem"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html">LArVoxelReadout</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="../../d0/db9/classlarg4_1_1LArVoxelReadout-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">larg4::LArVoxelReadout Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Transports energy depositions from GEANT4 to TPC channels.  
 <a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for larg4::LArVoxelReadout:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../db/d19/classlarg4_1_1LArVoxelReadout.png" usemap="#larg4::LArVoxelReadout_map" alt=""/>
  <map id="larg4::LArVoxelReadout_map" name="larg4::LArVoxelReadout_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d95/structlarg4_1_1LArVoxelReadout_1_1Setup__t.html">Setup_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection of what it takes to set a <code><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html" title="Transports energy depositions from GEANT4 to TPC channels. ">LArVoxelReadout</a></code> up.  <a href="../../dd/d95/structlarg4_1_1LArVoxelReadout_1_1Setup__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:acafbc91c93e8f5ca9250acf814044566"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; unsigned int, <br class="typebreak"/>
<a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a></td></tr>
<tr class="memdesc:acafbc91c93e8f5ca9250acf814044566"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of map channel -&gt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html" title="Energy deposited on a readout channel by simulated tracks. ">sim::SimChannel</a>.  <a href="#acafbc91c93e8f5ca9250acf814044566">More...</a><br/></td></tr>
<tr class="separator:acafbc91c93e8f5ca9250acf814044566"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afead9969f96667affbbb8033caca0ae1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#afead9969f96667affbbb8033caca0ae1">LArVoxelReadout</a> (std::string const &amp;<a class="el" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)</td></tr>
<tr class="memdesc:afead9969f96667affbbb8033caca0ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Can detect which TPC to cover by the name.  <a href="#afead9969f96667affbbb8033caca0ae1">More...</a><br/></td></tr>
<tr class="separator:afead9969f96667affbbb8033caca0ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5371cf7160900b940be251cb4a0159"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8c5371cf7160900b940be251cb4a0159">LArVoxelReadout</a> (std::string const &amp;<a class="el" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>, unsigned int cryostat, unsigned int tpc)</td></tr>
<tr class="memdesc:a8c5371cf7160900b940be251cb4a0159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Sets which TPC to work on.  <a href="#a8c5371cf7160900b940be251cb4a0159">More...</a><br/></td></tr>
<tr class="separator:a8c5371cf7160900b940be251cb4a0159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210d61419d79baa0ae82f44fdb215087"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a210d61419d79baa0ae82f44fdb215087">Setup</a> (<a class="el" href="../../dd/d95/structlarg4_1_1LArVoxelReadout_1_1Setup__t.html">Setup_t</a> const &amp;setupData)</td></tr>
<tr class="memdesc:a210d61419d79baa0ae82f44fdb215087"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads all the configuration elements from <code>setupData</code>  <a href="#a210d61419d79baa0ae82f44fdb215087">More...</a><br/></td></tr>
<tr class="separator:a210d61419d79baa0ae82f44fdb215087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f4f3e5c2a6b4305e448a0aa9b687e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a86f4f3e5c2a6b4305e448a0aa9b687e9">SetSingleTPC</a> (unsigned int cryostat, unsigned int tpc)</td></tr>
<tr class="memdesc:a86f4f3e5c2a6b4305e448a0aa9b687e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associates this readout to one specific TPC.  <a href="#a86f4f3e5c2a6b4305e448a0aa9b687e9">More...</a><br/></td></tr>
<tr class="separator:a86f4f3e5c2a6b4305e448a0aa9b687e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4baefb0b5bea1fba1bae52369dc0fe31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a4baefb0b5bea1fba1bae52369dc0fe31">SetDiscoverTPC</a> ()</td></tr>
<tr class="memdesc:a4baefb0b5bea1fba1bae52369dc0fe31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets this readout to discover the TPC of each processed hit.  <a href="#a4baefb0b5bea1fba1bae52369dc0fe31">More...</a><br/></td></tr>
<tr class="separator:a4baefb0b5bea1fba1bae52369dc0fe31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97270855ea4fc9fc01325dc72853e635"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a97270855ea4fc9fc01325dc72853e635">Initialize</a> (G4HCofThisEvent *)</td></tr>
<tr class="separator:a97270855ea4fc9fc01325dc72853e635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada30a2907209e2d945c2af2b7409afb4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ada30a2907209e2d945c2af2b7409afb4">EndOfEvent</a> (G4HCofThisEvent *)</td></tr>
<tr class="separator:ada30a2907209e2d945c2af2b7409afb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908d217089ea27a1a5a1de3c674953c2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a908d217089ea27a1a5a1de3c674953c2">clear</a> ()</td></tr>
<tr class="separator:a908d217089ea27a1a5a1de3c674953c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c47c388c5b4489e5e9e30ed4c4a655"><td class="memItemLeft" align="right" valign="top">virtual G4bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ae9c47c388c5b4489e5e9e30ed4c4a655">ProcessHits</a> (G4Step *, G4TouchableHistory *)</td></tr>
<tr class="separator:ae9c47c388c5b4489e5e9e30ed4c4a655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e44ebaef434ff7cd210943fd30a074"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a10e44ebaef434ff7cd210943fd30a074">DrawAll</a> ()</td></tr>
<tr class="separator:a10e44ebaef434ff7cd210943fd30a074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e83ca5e22f67a5749c4dbc724d50aa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a77e83ca5e22f67a5749c4dbc724d50aa">PrintAll</a> ()</td></tr>
<tr class="separator:a77e83ca5e22f67a5749c4dbc724d50aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb6bf94ff348655f450286b1b0f6784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#abeb6bf94ff348655f450286b1b0f6784">ClearSimChannels</a> ()</td></tr>
<tr class="separator:abeb6bf94ff348655f450286b1b0f6784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77902d52af2aa452f219a1f4cb584fdd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a77902d52af2aa452f219a1f4cb584fdd">GetSimChannels</a> () const </td></tr>
<tr class="memdesc:a77902d52af2aa452f219a1f4cb584fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a list with the accumulated information for the single TPC.  <a href="#a77902d52af2aa452f219a1f4cb584fdd">More...</a><br/></td></tr>
<tr class="separator:a77902d52af2aa452f219a1f4cb584fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d89daf72fb17cc98d767608598d333"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a50d89daf72fb17cc98d767608598d333">GetSimChannels</a> (unsigned short cryo, unsigned short tpc) const </td></tr>
<tr class="memdesc:a50d89daf72fb17cc98d767608598d333"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a list with the accumulated information for specified TPC.  <a href="#a50d89daf72fb17cc98d767608598d333">More...</a><br/></td></tr>
<tr class="separator:a50d89daf72fb17cc98d767608598d333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:af9c8e8bc595e3332b23acd2014704828"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af9c8e8bc595e3332b23acd2014704828">GetSimChannelMap</a> () const </td></tr>
<tr class="memdesc:af9c8e8bc595e3332b23acd2014704828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the accumulated channel -&gt; SimChannel map for the single TPC.  <a href="#af9c8e8bc595e3332b23acd2014704828">More...</a><br/></td></tr>
<tr class="separator:af9c8e8bc595e3332b23acd2014704828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28202b3028d0c38f291ded76a9a076e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa28202b3028d0c38f291ded76a9a076e">GetSimChannelMap</a> ()</td></tr>
<tr class="separator:aa28202b3028d0c38f291ded76a9a076e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:aca7382e0c2eecbea44cd61db366d4d69"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aca7382e0c2eecbea44cd61db366d4d69">GetSimChannelMap</a> (unsigned short cryo, unsigned short tpc) const </td></tr>
<tr class="memdesc:aca7382e0c2eecbea44cd61db366d4d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the accumulated channel -&gt; SimChannel map for the specified TPC.  <a href="#aca7382e0c2eecbea44cd61db366d4d69">More...</a><br/></td></tr>
<tr class="separator:aca7382e0c2eecbea44cd61db366d4d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada1461c2fadcf13d85285ecc5541a910"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ada1461c2fadcf13d85285ecc5541a910">GetSimChannelMap</a> (unsigned short cryo, unsigned short tpc)</td></tr>
<tr class="separator:ada1461c2fadcf13d85285ecc5541a910"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a6cfa9ce8e7f1f072f570ef3a4f3af418"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a6cfa9ce8e7f1f072f570ef3a4f3af418">SetClockData</a> (<a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const *const clockData) noexcept</td></tr>
<tr class="separator:a6cfa9ce8e7f1f072f570ef3a4f3af418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349d6937c797a4db5038a01a98a41dc3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a349d6937c797a4db5038a01a98a41dc3">SetPropertiesData</a> (<a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const *const detProp) noexcept</td></tr>
<tr class="separator:a349d6937c797a4db5038a01a98a41dc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c468c3f742afca6e944d63c289eb46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa6c468c3f742afca6e944d63c289eb46">SetOffPlaneChargeRecoveryMargin</a> (double margin)</td></tr>
<tr class="memdesc:aa6c468c3f742afca6e944d63c289eb46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the margin for recovery of charge drifted off-plane.  <a href="#aa6c468c3f742afca6e944d63c289eb46">More...</a><br/></td></tr>
<tr class="separator:aa6c468c3f742afca6e944d63c289eb46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1fbe4db5635b18fc88264444457a7ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ae1fbe4db5635b18fc88264444457a7ae">SetRandomEngines</a> (CLHEP::HepRandomEngine *pPropGen)</td></tr>
<tr class="memdesc:ae1fbe4db5635b18fc88264444457a7ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the random generators to be used.  <a href="#ae1fbe4db5635b18fc88264444457a7ae">More...</a><br/></td></tr>
<tr class="separator:ae1fbe4db5635b18fc88264444457a7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690d0c3f4cead092c218eddd2d740e8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a690d0c3f4cead092c218eddd2d740e8c">RecoverOffPlaneDeposit</a> (<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;pos, <a class="el" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> const &amp;plane) const </td></tr>
<tr class="memdesc:a690d0c3f4cead092c218eddd2d740e8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the point on the specified plane closest to position.  <a href="#a690d0c3f4cead092c218eddd2d740e8c">More...</a><br/></td></tr>
<tr class="separator:a690d0c3f4cead092c218eddd2d740e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18751342a6908cff9f4cae2f8a09d0cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a18751342a6908cff9f4cae2f8a09d0cb">DriftIonizationElectrons</a> (<a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;clockData, G4ThreeVector stepMidPoint, const double simTime, int trackID, unsigned short int cryostat, unsigned short int tpc, int origTrackID)</td></tr>
<tr class="separator:a18751342a6908cff9f4cae2f8a09d0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c32ebc7e54397b0c4e0bdb2ffdef7ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5c32ebc7e54397b0c4e0bdb2ffdef7ae">Has</a> (std::vector&lt; unsigned short int &gt; v, unsigned short int tpc) const </td></tr>
<tr class="separator:a5c32ebc7e54397b0c4e0bdb2ffdef7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a522a5eb1d9ff52e7cf8940a006117e27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a522a5eb1d9ff52e7cf8940a006117e27">ProcessStep</a> (G4Step *)</td></tr>
<tr class="separator:a522a5eb1d9ff52e7cf8940a006117e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a2f77225788d26f6107b7ec76a24ffe90"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a> [3]</td></tr>
<tr class="separator:a2f77225788d26f6107b7ec76a24ffe90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067d51ee11da93000365b8e287560176"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a067d51ee11da93000365b8e287560176">fLongitudinalDiffusion</a></td></tr>
<tr class="separator:a067d51ee11da93000365b8e287560176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546addc57fb02296ae7392fe23e20fa4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a546addc57fb02296ae7392fe23e20fa4">fTransverseDiffusion</a></td></tr>
<tr class="separator:a546addc57fb02296ae7392fe23e20fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf5e78cd901a16fa2e2a92108f6ba51a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">fElectronLifetime</a></td></tr>
<tr class="separator:adf5e78cd901a16fa2e2a92108f6ba51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39d8dd444c28c75086e6c98df4944e8b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a39d8dd444c28c75086e6c98df4944e8b">fElectronClusterSize</a></td></tr>
<tr class="separator:a39d8dd444c28c75086e6c98df4944e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0a9f3e61578f6cdf1a82e040a99c260"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">fMinNumberOfElCluster</a></td></tr>
<tr class="separator:af0a9f3e61578f6cdf1a82e040a99c260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5356095138172c0de94b65826bc256d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">fDontDriftThem</a></td></tr>
<tr class="separator:a5356095138172c0de94b65826bc256d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f42a7eb85774deb0c4608f02d42b0f3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned short int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8f42a7eb85774deb0c4608f02d42b0f3">fSkipWireSignalInTPCs</a></td></tr>
<tr class="separator:a8f42a7eb85774deb0c4608f02d42b0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824a9d9db87dda3b652d7c6bcf90e7db"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">fOffPlaneMargin</a> = 0.0</td></tr>
<tr class="memdesc:a824a9d9db87dda3b652d7c6bcf90e7db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charge deposited within this many [cm] from the plane is lead onto it.  <a href="#a824a9d9db87dda3b652d7c6bcf90e7db">More...</a><br/></td></tr>
<tr class="separator:a824a9d9db87dda3b652d7c6bcf90e7db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57fcc476dae18ae30eece54df28a6a48"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a></td></tr>
<tr class="memdesc:a57fcc476dae18ae30eece54df28a6a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps of cryostat, tpc to channel data.  <a href="#a57fcc476dae18ae30eece54df28a6a48">More...</a><br/></td></tr>
<tr class="separator:a57fcc476dae18ae30eece54df28a6a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515a61c5bc2e106de404883f7809c814"><td class="memItemLeft" align="right" valign="top">art::ServiceHandle<br class="typebreak"/>
&lt; <a class="el" href="../../d8/df3/classgeo_1_1Geometry.html">geo::Geometry</a> const  &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">fGeoHandle</a></td></tr>
<tr class="memdesc:a515a61c5bc2e106de404883f7809c814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to the Geometry service.  <a href="#a515a61c5bc2e106de404883f7809c814">More...</a><br/></td></tr>
<tr class="separator:a515a61c5bc2e106de404883f7809c814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6c8ad91fb43edeab8b1dbbf9befb5ce"><td class="memItemLeft" align="right" valign="top">art::ServiceHandle<br class="typebreak"/>
&lt; <a class="el" href="../../d2/d7f/classsim_1_1LArG4Parameters.html">sim::LArG4Parameters</a> const  &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a></td></tr>
<tr class="memdesc:ad6c8ad91fb43edeab8b1dbbf9befb5ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to the <a class="el" href="../../d9/d64/classlarg4_1_1LArG4.html" title="Runs Geant4 simulation and propagation of electrons and photons to readout. ">LArG4</a> parameters service.  <a href="#ad6c8ad91fb43edeab8b1dbbf9befb5ce">More...</a><br/></td></tr>
<tr class="separator:ad6c8ad91fb43edeab8b1dbbf9befb5ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe49871fd8578efdbcfb5dc93476914"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a></td></tr>
<tr class="memdesc:affe49871fd8578efdbcfb5dc93476914"><td class="mdescLeft">&#160;</td><td class="mdescRight">which TPC this <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html" title="Transports energy depositions from GEANT4 to TPC channels. ">LArVoxelReadout</a> corresponds to  <a href="#affe49871fd8578efdbcfb5dc93476914">More...</a><br/></td></tr>
<tr class="separator:affe49871fd8578efdbcfb5dc93476914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c6fd500b94ba6a6b0bc920ba5bfed2"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a></td></tr>
<tr class="memdesc:ac9c6fd500b94ba6a6b0bc920ba5bfed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">and in which cryostat (if bSingleTPC is true)  <a href="#ac9c6fd500b94ba6a6b0bc920ba5bfed2">More...</a><br/></td></tr>
<tr class="separator:ac9c6fd500b94ba6a6b0bc920ba5bfed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b256b8a003d3253f2b267c1a63c45a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a></td></tr>
<tr class="memdesc:a8b256b8a003d3253f2b267c1a63c45a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">true if this readout is associated with a single TPC  <a href="#a8b256b8a003d3253f2b267c1a63c45a9">More...</a><br/></td></tr>
<tr class="separator:a8b256b8a003d3253f2b267c1a63c45a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a810e9c2441c76c710c75529632b25674"><td class="memItemLeft" align="right" valign="top">CLHEP::HepRandomEngine *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">fPropGen</a> = nullptr</td></tr>
<tr class="memdesc:a810e9c2441c76c710c75529632b25674"><td class="mdescLeft">&#160;</td><td class="mdescRight">random engine for charge propagation  <a href="#a810e9c2441c76c710c75529632b25674">More...</a><br/></td></tr>
<tr class="separator:a810e9c2441c76c710c75529632b25674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91a373be28431a5aafab69d0c49480a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">fClockData</a> {nullptr}</td></tr>
<tr class="separator:aa91a373be28431a5aafab69d0c49480a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe2868777a176d36caf3c7fefd39e17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <br class="typebreak"/>
const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a> {nullptr}</td></tr>
<tr class="separator:affe2868777a176d36caf3c7fefd39e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e5c94ce29b98ebe7541f8611ad0ee3"><td class="memItemLeft" align="right" valign="top">G4ThreeVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a09e5c94ce29b98ebe7541f8611ad0ee3">fStepStart</a></td></tr>
<tr class="separator:a09e5c94ce29b98ebe7541f8611ad0ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d89e31c36dbd9958638462e43c72c85"><td class="memItemLeft" align="right" valign="top">G4ThreeVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a4d89e31c36dbd9958638462e43c72c85">fStepEnd</a></td></tr>
<tr class="separator:a4d89e31c36dbd9958638462e43c72c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e0036d4cd0225f8c0fad77c5ffb7c5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">fNSteps</a></td></tr>
<tr class="separator:a26e0036d4cd0225f8c0fad77c5ffb7c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a88c5cf9f84630f68abd402f3a4d28c89"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a88c5cf9f84630f68abd402f3a4d28c89">LArVoxelReadoutGeometry</a></td></tr>
<tr class="separator:a88c5cf9f84630f68abd402f3a4d28c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Transports energy depositions from GEANT4 to TPC channels. </p>
<p>This class acts on single energy depositions from GEANT4, simulating the transportation of the ensuing ionisation electrons to the readout channels:</p>
<ol type="1">
<li>the number of ionisation electrons is read from the current <code><a class="el" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html">larg4::IonizationAndScintillation</a></code> instance</li>
<li>space charge displacement is optionally applied</li>
<li>lifetime correction is applied</li>
<li>charge is split in small electron clusters</li>
<li>each cluster is subject to longitudinal and transverse diffusion</li>
<li>each cluster is assigned to one TPC channel for each wire plane</li>
<li>optionally, charge is forced to stay on the planes; otherwise charge drifting outside the plane is lost</li>
</ol>
<p>For each energy deposition, entries on the appropriate <code><a class="el" href="../../d0/daf/classsim_1_1SimChannel.html" title="Energy deposited on a readout channel by simulated tracks. ">sim::SimChannel</a></code> are added, with the information of the position where the energy deposit happened (in global coordinates, centimeters), the ID of the Geant4 track which produced the deposition, and the quantized time of arrival to the channel (in global TDC tick units). At most one entry is added for each electron cluster, but entries from the same energy deposit can be compacted if falling on the same TDC tick.</p>
<p>The main entry point of this class is the method <code><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ae9c47c388c5b4489e5e9e30ed4c4a655">ProcessHits()</a></code>.</p>
<h2>Options </h2>
<p>A few optional behaviours are supported:</p>
<ul>
<li>lead off-plane charge to the planes: regulated by <code><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a690d0c3f4cead092c218eddd2d740e8c" title="Returns the point on the specified plane closest to position. ">RecoverOffPlaneDeposit()</a></code>, if charge which reaches a wire plane is actually off it by less than the chosen margin, it's accounted for by that plane; by default the margin is 0 and all the charge off the plane is lost (with a warning) </li>
</ul>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00170">170</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="acafbc91c93e8f5ca9250acf814044566"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;unsigned int, <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a>&gt; <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">larg4::LArVoxelReadout::ChannelMap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of map channel -&gt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html" title="Energy deposited on a readout channel by simulated tracks. ">sim::SimChannel</a>. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00173">173</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afead9969f96667affbbb8033caca0ae1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">larg4::LArVoxelReadout::LArVoxelReadout </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. Can detect which TPC to cover by the name. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00049">49</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                        : G4VSensitiveDetector(<a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// Initialize values for the electron-cluster calculation.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#abeb6bf94ff348655f450286b1b0f6784">ClearSimChannels</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// the standard name contains cryostat and TPC;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// if we don&#39;t find it, we will detect the TPC at each Geant hit</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cryostat, tpc;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (std::sscanf(<a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>.c_str(), <span class="stringliteral">&quot;%*19s%1u%*4s%u&quot;</span>, &amp;cryostat, &amp;tpc) == 2)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a86f4f3e5c2a6b4305e448a0aa9b687e9">SetSingleTPC</a>(cryostat, tpc);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a4baefb0b5bea1fba1bae52369dc0fe31">SetDiscoverTPC</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  } <span class="comment">// LArVoxelReadout::LArVoxelReadout()</span></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a86f4f3e5c2a6b4305e448a0aa9b687e9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a86f4f3e5c2a6b4305e448a0aa9b687e9">larg4::LArVoxelReadout::SetSingleTPC</a></div><div class="ttdeci">void SetSingleTPC(unsigned int cryostat, unsigned int tpc)</div><div class="ttdoc">Associates this readout to one specific TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00083">LArVoxelReadout.cxx:83</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a4baefb0b5bea1fba1bae52369dc0fe31"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a4baefb0b5bea1fba1bae52369dc0fe31">larg4::LArVoxelReadout::SetDiscoverTPC</a></div><div class="ttdeci">void SetDiscoverTPC()</div><div class="ttdoc">Sets this readout to discover the TPC of each processed hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00092">LArVoxelReadout.cxx:92</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a19dd16849ed641adb2aff777fdc4bd8b"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div><div class="ttdeci">then echo fcl name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_abeb6bf94ff348655f450286b1b0f6784"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#abeb6bf94ff348655f450286b1b0f6784">larg4::LArVoxelReadout::ClearSimChannels</a></div><div class="ttdeci">void ClearSimChannels()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00151">LArVoxelReadout.cxx:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8c5371cf7160900b940be251cb4a0159"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">larg4::LArVoxelReadout::LArVoxelReadout </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>cryostat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. Sets which TPC to work on. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00067">67</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    : <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#afead9969f96667affbbb8033caca0ae1">LArVoxelReadout</a>(<a class="code" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a86f4f3e5c2a6b4305e448a0aa9b687e9">SetSingleTPC</a>(cryostat, tpc);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_afead9969f96667affbbb8033caca0ae1"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#afead9969f96667affbbb8033caca0ae1">larg4::LArVoxelReadout::LArVoxelReadout</a></div><div class="ttdeci">LArVoxelReadout(std::string const &amp;name)</div><div class="ttdoc">Constructor. Can detect which TPC to cover by the name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00049">LArVoxelReadout.cxx:49</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a86f4f3e5c2a6b4305e448a0aa9b687e9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a86f4f3e5c2a6b4305e448a0aa9b687e9">larg4::LArVoxelReadout::SetSingleTPC</a></div><div class="ttdeci">void SetSingleTPC(unsigned int cryostat, unsigned int tpc)</div><div class="ttdoc">Associates this readout to one specific TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00083">LArVoxelReadout.cxx:83</a></div></div>
<div class="ttc" id="sbndpoms__genfclwithrunnumber__maker_8sh_html_a19dd16849ed641adb2aff777fdc4bd8b"><div class="ttname"><a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a></div><div class="ttdeci">then echo fcl name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh_source.html#l00220">sbndpoms_genfclwithrunnumber_maker.sh:220</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a908d217089ea27a1a5a1de3c674953c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00146">146</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  {}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abeb6bf94ff348655f450286b1b0f6784"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::ClearSimChannels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00151">151</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>.resize(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">fGeoHandle</a>-&gt;Ncryostats());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">size_t</span> cryo = 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cryoData : <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>) { <span class="comment">// each, a vector of maps</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      cryoData.resize(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">fGeoHandle</a>-&gt;NTPC(cryo++));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; channelsMap : cryoData)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        channelsMap.clear(); <span class="comment">// each, a map</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }                        <span class="comment">// for cryostats</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }                          <span class="comment">// LArVoxelReadout::ClearSimChannels()</span></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a515a61c5bc2e106de404883f7809c814"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">larg4::LArVoxelReadout::fGeoHandle</a></div><div class="ttdeci">art::ServiceHandle&lt; geo::Geometry const  &gt; fGeoHandle</div><div class="ttdoc">Handle to the Geometry service. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00351">LArVoxelReadout.h:351</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a57fcc476dae18ae30eece54df28a6a48"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">larg4::LArVoxelReadout::fChannelMaps</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; ChannelMap_t &gt; &gt; fChannelMaps</div><div class="ttdoc">Maps of cryostat, tpc to channel data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">LArVoxelReadout.h:350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a10e44ebaef434ff7cd210943fd30a074"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::DrawAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00595">595</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  {}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a18751342a6908cff9f4cae2f8a09d0cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::DriftIonizationElectrons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const &amp;&#160;</td>
          <td class="paramname"><em>clockData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4ThreeVector&#160;</td>
          <td class="paramname"><em>stepMidPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>simTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trackID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>cryostat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>tpc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>origTrackID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000143">Todo:</a></b></dt><dd>think about effects of drift between planes </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000144">Todo:</a></b></dt><dd>think about effects of drift between planes </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000145">Todo:</a></b></dt><dd>check on what happens if we allow the tdc value to be </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000146">Todo:</a></b></dt><dd>beyond the end of the expected number of ticks </dd></dl>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00340">340</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> tpcClock = clockData.TPCClock();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// this must be always true, unless caller has been sloppy</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    assert(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">fPropGen</a>); <span class="comment">// No propagation random generator provided?!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    CLHEP::RandGauss PropRand(*<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">fPropGen</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// This routine gets called frequently, once per every particle</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// traveling through every voxel. Use whatever tricks we can to</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// increase its execution speed.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> LifetimeCorr_const = -1000. * <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">fElectronLifetime</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> LDiff_const = std::sqrt(2. * <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a067d51ee11da93000365b8e287560176">fLongitudinalDiffusion</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> TDiff_const = std::sqrt(2. * <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a546addc57fb02296ae7392fe23e20fa4">fTransverseDiffusion</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> RecipDriftVel[3] = {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      1. / <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[0], 1. / <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[1], 1. / <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[2]};</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">struct </span>Deposit_t {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordtype">double</span> energy = 0.;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#a6c3ed9156cb6e7b7a7b21d4c7409cb39">electrons</a> = 0.;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordtype">void</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      add(<span class="keywordtype">double</span> more_energy, <span class="keywordtype">double</span> more_electrons)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        energy += more_energy;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="../../d1/d33/detectorproperties__icarus_8fcl.html#a6c3ed9156cb6e7b7a7b21d4c7409cb39">electrons</a> += more_electrons;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }; <span class="comment">// Deposit_t</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Map of electrons to store - catalogued by map[channel][tdc]</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    std::map&lt;raw::ChannelID_t, std::map&lt;unsigned int, Deposit_t&gt;&gt; DepositsToStore;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">double</span> xyz1[3] = {0.};</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> xyz[3] = {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      stepMidPoint.x() / CLHEP::cm, stepMidPoint.y() / CLHEP::cm, stepMidPoint.z() / CLHEP::cm};</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// Already know which TPC we&#39;re in because we have been told</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a>&amp; tpcg = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">fGeoHandle</a>-&gt;TPC(tpc, cryostat);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="comment">// X drift distance - the drift direction can be either in</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">// the positive or negative direction, so use std::abs</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">      /// \todo think about effects of drift between planes</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span>      <span class="keywordtype">double</span> XDrift = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(stepMidPoint.x() / CLHEP::cm - tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">PlaneLocation</a>(0)[0]);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">//std::cout&lt;&lt;tpcg.DriftDirection()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a37b4d0a99be8c2324273589fda87b851">DriftDirection</a>() == <a class="code" href="../../d6/d23/namespacegeo.html#a1b5150a78645f276a21647cc0b48fb69ab6ea94727ba423afbde5dbd7e9306bdf">geo::kNegX</a>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        XDrift = stepMidPoint.x() / CLHEP::cm - tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">PlaneLocation</a>(0)[0];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a37b4d0a99be8c2324273589fda87b851">DriftDirection</a>() == <a class="code" href="../../d6/d23/namespacegeo.html#a1b5150a78645f276a21647cc0b48fb69a540355ba5bfe18985f585e362f847483">geo::kPosX</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        XDrift = tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">PlaneLocation</a>(0)[0] - stepMidPoint.x() / CLHEP::cm;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span> (XDrift &lt; 0.) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">// Get SCE {x,y,z} offsets for particular location in TPC</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="../../d6/d23/namespacegeo.html#a22d2a7c73b2795146b92cd54ded9e817">geo::Vector_t</a> posOffsets;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>* SCE = lar::providerFrom&lt;spacecharge::SpaceChargeService&gt;();</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">if</span> (SCE-&gt;EnableSimSpatialSCE() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        posOffsets = SCE-&gt;GetPosOffsets({xyz[0], xyz[1], xyz[2]});</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/db8/namespacelarsim_1_1Utils_1_1SCE.html#a240a7a5f32e276f3c21c5cbc09d46e4a">larsim::Utils::SCE::out_of_bounds</a>(posOffsets)) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      posOffsets.SetX(-posOffsets.X());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="comment">// Drift time (nano-sec)</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordtype">double</span> TDrift;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      XDrift += posOffsets.X();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// Space charge distortion could push the energy deposit beyond the wire</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// plane (see issue #15131). Given that we don&#39;t have any subtlety in the</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">// simulation of this region, bringing the deposit exactly on the plane</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="comment">// should be enough for the time being.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (XDrift &lt; 0.) XDrift = 0.;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      TDrift = XDrift * RecipDriftVel[0];</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">if</span> (tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() == 2) { <span class="comment">// special case for ArgoNeuT (plane 0 is the second wire plane)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        TDrift = ((XDrift - tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">PlanePitch</a>(0, 1)) * RecipDriftVel[0] +</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                  tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">PlanePitch</a>(0, 1) * RecipDriftVel[1]);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> lifetimecorrection = TMath::Exp(TDrift / LifetimeCorr_const);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nIonizedElectrons =</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#afe936c80db503c3dddf751ec201af5f7">NumberIonizationElectrons</a>();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> energy = <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a84f2796016f90a4cbbe444c64cbbb77e">EnergyDeposit</a>();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">// if we have no electrons (too small energy or too large recombination)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">// we are done already here</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (nIonizedElectrons &lt;= 0) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;No electrons drifted to readout, &quot;</span> &lt;&lt; energy &lt;&lt; <span class="stringliteral">&quot; MeV lost.&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="comment">// includes the effect of lifetime</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> nElectrons = nIonizedElectrons * lifetimecorrection;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">// Longitudinal &amp; transverse diffusion sigma (cm)</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordtype">double</span> SqrtT = std::sqrt(TDrift);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordtype">double</span> LDiffSig = SqrtT * LDiff_const;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordtype">double</span> TDiffSig = SqrtT * TDiff_const;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordtype">double</span> electronclsize = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a39d8dd444c28c75086e6c98df4944e8b">fElectronClusterSize</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">int</span> nClus = (int)std::ceil(nElectrons / electronclsize);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span> (nClus &lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">fMinNumberOfElCluster</a>) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        electronclsize = nElectrons / <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">fMinNumberOfElCluster</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (electronclsize &lt; 1.0) { electronclsize = 1.0; }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        nClus = (int)std::ceil(nElectrons / electronclsize);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="comment">// Compute arrays of values as quickly as possible.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      std::vector&lt;double&gt; XDiff(nClus);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      std::vector&lt;double&gt; YDiff(nClus);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      std::vector&lt;double&gt; ZDiff(nClus);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      std::vector&lt;double&gt; nElDiff(nClus, electronclsize);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      std::vector&lt;double&gt; nEnDiff(nClus);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">// fix the number of electrons in the last cluster, that has smaller size</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      nElDiff.back() = nElectrons - (nClus - 1) * electronclsize;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xx = 0; xx &lt; nElDiff.size(); ++xx) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> (nElectrons &gt; 0)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          nEnDiff[xx] = energy / nElectrons * nElDiff[xx];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          nEnDiff[xx] = 0.;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordtype">double</span> <span class="keyword">const</span> avegageYtransversePos = (stepMidPoint.y() / CLHEP::cm) + posOffsets.Y();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordtype">double</span> <span class="keyword">const</span> avegageZtransversePos = (stepMidPoint.z() / CLHEP::cm) + posOffsets.Z();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">// Smear drift times by x position and drift time</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">if</span> (LDiffSig &gt; 0.0)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        PropRand.fireArray(nClus, &amp;XDiff[0], 0., LDiffSig);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        XDiff.assign(nClus, 0.0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">if</span> (TDiffSig &gt; 0.0) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">// Smear the Y,Z position by the transverse diffusion</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        PropRand.fireArray(nClus, &amp;YDiff[0], avegageYtransversePos, TDiffSig);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        PropRand.fireArray(nClus, &amp;ZDiff[0], avegageZtransversePos, TDiffSig);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        YDiff.assign(nClus, avegageYtransversePos);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        ZDiff.assign(nClus, avegageZtransversePos);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// make a collection of electrons for each plane</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> &lt; tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>(); ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> <span class="keyword">const</span>&amp; plane = tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">Plane</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordtype">double</span> Plane0Pitch = tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a8a67d792308b4298d3c782bd219e508a">Plane0Pitch</a>(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// &quot;-&quot; sign is because Plane0Pitch output is positive. Andrzej</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        xyz1[0] = tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">PlaneLocation</a>(0)[0] - Plane0Pitch;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// Drift nClus electron clusters to the induction plane</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a> = 0; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a> &lt; nClus; ++<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="comment">// Correct drift time for longitudinal diffusion and plane</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="keywordtype">double</span> TDiff = TDrift + XDiff[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>] * RecipDriftVel[0];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          <span class="comment">// Take into account different Efields between planes</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <span class="comment">// Also take into account special case for ArgoNeuT where Nplanes = 2.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ip = 0; ip &lt; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>; ++ip) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            TDiff +=</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">PlanePitch</a>(ip, ip + 1) * RecipDriftVel[tpcg.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">Nplanes</a>() == 3 ? ip + 1 : ip + 2];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          xyz1[1] = YDiff[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>];</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          xyz1[2] = ZDiff[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">          /// \todo think about effects of drift between planes</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          <span class="comment">// grab the nearest channel to the xyz1 position</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">fOffPlaneMargin</a> != 0) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;              <span class="comment">// get the effective position where to consider the charge landed;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              <span class="comment">//</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;              <span class="comment">// Some optimisations are possible; in particular, this method</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="comment">// could be extended to inform us if the point was too far.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;              <span class="comment">// Currently, if that is the case the code will proceed, find the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              <span class="comment">// point is off plane, emit a warning and skip the deposition.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;              <span class="comment">//</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;              <span class="keyword">auto</span> <span class="keyword">const</span> landingPos = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a690d0c3f4cead092c218eddd2d740e8c">RecoverOffPlaneDeposit</a>({xyz1[0], xyz1[1], xyz1[2]}, plane);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;              xyz1[0] = landingPos.X();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              xyz1[1] = landingPos.Y();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;              xyz1[2] = landingPos.Z();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            } <span class="comment">// if charge lands off plane</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            uint32_t channel = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">fGeoHandle</a>-&gt;NearestChannel(xyz1, p, tpc, cryostat);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">            /// \todo check on what happens if we allow the tdc value to be</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">            /// \todo beyond the end of the expected number of ticks</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span>            <span class="comment">// Add potential decay/capture/etc delay effect, simTime.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tdc = tpcClock.Ticks(clockData.G4ToElecTime(TDiff + simTime));</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment">// Add electrons produced by each cluster to the map</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            DepositsToStore[channel][tdc].add(nEnDiff[<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>], nElDiff[k]);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;unable to drift electrons from point (&quot;</span> &lt;&lt; xyz[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xyz[1] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;              &lt;&lt; xyz[2] &lt;&lt; <span class="stringliteral">&quot;) with exception &quot;</span> &lt;&lt; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        } <span class="comment">// end loop over clusters</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      }   <span class="comment">// end loop over planes</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">// Now store them in SimChannels</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a>&amp; ChannelDataMap = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>[cryostat][tpc];</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="comment">// browse deposited data on each channel: (channel; deposit data in time)</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; deposit_per_channel : DepositsToStore) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a> channel = deposit_per_channel.first;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// find whether we already have this channel</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keyword">auto</span> iChannelData = ChannelDataMap.find(channel);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// channelData is the SimChannel these deposits are going to be added to</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment">// If there is such a channel already, use it (first beanch).</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="comment">// If it&#39;s a new channel, the inner assignment creates a new SimChannel</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">// in the map, and we save its reference in channelData</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a>&amp; channelData = (iChannelData == ChannelDataMap.end()) ?</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                         (ChannelDataMap[channel] = <a class="code" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a>(channel)) :</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                         iChannelData-&gt;second;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">// go through all deposits, one for each TDC: (TDC, deposit data)</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a566ec0b645c019fdab1b56a230a4b24d">for</a> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; deposit_per_tdc : deposit_per_channel.second) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;          channelData.<a class="code" href="../../d0/daf/classsim_1_1SimChannel.html#a1350027cd6b6e590083c04dd60e37c58">AddIonizationElectrons</a>(trackID,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                             deposit_per_tdc.first,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                             deposit_per_tdc.second.electrons,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                             xyz,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                             deposit_per_tdc.second.energy,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                             origTrackID);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        } <span class="comment">// for deposit on TDCs</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }   <span class="comment">// for deposit on channels</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    } <span class="comment">// end try intended to catch points where TPC can&#39;t be found</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">catch</span> (cet::exception&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;step cannot be found in a TPC\n&quot;</span> &lt;&lt; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="ttc" id="namespacegeo_html_a22d2a7c73b2795146b92cd54ded9e817"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a22d2a7c73b2795146b92cd54ded9e817">geo::Vector_t</a></div><div class="ttdeci">ROOT::Math::DisplacementVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Vector_t</div><div class="ttdoc">Type for representation of momenta in 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00164">geo_vectors.h:164</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_afe936c80db503c3dddf751ec201af5f7"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#afe936c80db503c3dddf751ec201af5f7">larg4::IonizationAndScintillation::NumberIonizationElectrons</a></div><div class="ttdeci">double NumberIonizationElectrons() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/IonizationAndScintillation_8h_source.html#l00053">IonizationAndScintillation.h:53</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a546addc57fb02296ae7392fe23e20fa4"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a546addc57fb02296ae7392fe23e20fa4">larg4::LArVoxelReadout::fTransverseDiffusion</a></div><div class="ttdeci">double fTransverseDiffusion</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00341">LArVoxelReadout.h:341</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a697df19a5c945ce5622c50f80e60fbce"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a697df19a5c945ce5622c50f80e60fbce">geo::TPCGeo::PlanePitch</a></div><div class="ttdeci">double PlanePitch(unsigned int p1=0, unsigned int p2=1) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00388">TPCGeo.cxx:388</a></div></div>
<div class="ttc" id="classsim_1_1SimChannel_html"><div class="ttname"><a href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a></div><div class="ttdoc">Energy deposited on a readout channel by simulated tracks. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dde/SimChannel_8h_source.html#l00145">SimChannel.h:145</a></div></div>
<div class="ttc" id="namespacelarsim_1_1Utils_1_1SCE_html_a240a7a5f32e276f3c21c5cbc09d46e4a"><div class="ttname"><a href="../../d9/db8/namespacelarsim_1_1Utils_1_1SCE.html#a240a7a5f32e276f3c21c5cbc09d46e4a">larsim::Utils::SCE::out_of_bounds</a></div><div class="ttdeci">bool out_of_bounds(geo::Vector_t const &amp;offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d13/SCEOffsetBounds_8cxx_source.html#l00014">SCEOffsetBounds.cxx:14</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a2f77225788d26f6107b7ec76a24ffe90"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">larg4::LArVoxelReadout::fDriftVelocity</a></div><div class="ttdeci">double fDriftVelocity[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00339">LArVoxelReadout.h:339</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_adf5e78cd901a16fa2e2a92108f6ba51a"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">larg4::LArVoxelReadout::fElectronLifetime</a></div><div class="ttdeci">double fElectronLifetime</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00342">LArVoxelReadout.h:342</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ab3391de99203f6a60eeeef152d3adb35"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ab3391de99203f6a60eeeef152d3adb35">geo::TPCGeo::Nplanes</a></div><div class="ttdeci">unsigned int Nplanes() const </div><div class="ttdoc">Number of planes in this tpc. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00165">TPCGeo.h:165</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a515a61c5bc2e106de404883f7809c814"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a515a61c5bc2e106de404883f7809c814">larg4::LArVoxelReadout::fGeoHandle</a></div><div class="ttdeci">art::ServiceHandle&lt; geo::Geometry const  &gt; fGeoHandle</div><div class="ttdoc">Handle to the Geometry service. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00351">LArVoxelReadout.h:351</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_af0a9f3e61578f6cdf1a82e040a99c260"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">larg4::LArVoxelReadout::fMinNumberOfElCluster</a></div><div class="ttdeci">int fMinNumberOfElCluster</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00344">LArVoxelReadout.h:344</a></div></div>
<div class="ttc" id="namespacegeo_html_a1b5150a78645f276a21647cc0b48fb69ab6ea94727ba423afbde5dbd7e9306bdf"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a1b5150a78645f276a21647cc0b48fb69ab6ea94727ba423afbde5dbd7e9306bdf">geo::kNegX</a></div><div class="ttdoc">Drift towards negative X values. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00162">geo_types.h:162</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a067d51ee11da93000365b8e287560176"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a067d51ee11da93000365b8e287560176">larg4::LArVoxelReadout::fLongitudinalDiffusion</a></div><div class="ttdeci">double fLongitudinalDiffusion</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00340">LArVoxelReadout.h:340</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a690d0c3f4cead092c218eddd2d740e8c"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a690d0c3f4cead092c218eddd2d740e8c">larg4::LArVoxelReadout::RecoverOffPlaneDeposit</a></div><div class="ttdeci">geo::Point_t RecoverOffPlaneDeposit(geo::Point_t const &amp;pos, geo::PlaneGeo const &amp;plane) const </div><div class="ttdoc">Returns the point on the specified plane closest to position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00303">LArVoxelReadout.cxx:303</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_acafbc91c93e8f5ca9250acf814044566"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">larg4::LArVoxelReadout::ChannelMap_t</a></div><div class="ttdeci">std::map&lt; unsigned int, sim::SimChannel &gt; ChannelMap_t</div><div class="ttdoc">Type of map channel -&amp;gt; sim::SimChannel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00173">LArVoxelReadout.h:173</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a39d8dd444c28c75086e6c98df4944e8b"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a39d8dd444c28c75086e6c98df4944e8b">larg4::LArVoxelReadout::fElectronClusterSize</a></div><div class="ttdeci">double fElectronClusterSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00343">LArVoxelReadout.h:343</a></div></div>
<div class="ttc" id="generate__icarus__geometry__splitwire_8pl_html_a566ec0b645c019fdab1b56a230a4b24d"><div class="ttname"><a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl.html#a566ec0b645c019fdab1b56a230a4b24d">for</a></div><div class="ttdeci">for($it=0;$it&lt; $RaceTrack_number;$it++)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ddc/generate__icarus__geometry__splitwire_8pl_source.html#l01671">generate_icarus_geometry_splitwire.pl:1671</a></div></div>
<div class="ttc" id="classgeo_1_1PlaneGeo_html"><div class="ttname"><a href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a></div><div class="ttdoc">Geometry information for a single wire plane.The plane is represented in the geometry by a solid whic...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/PlaneGeo_8h_source.html#l00082">PlaneGeo.h:82</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a30d440651b97effb3a48f67d3ad4d5f1"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a></div><div class="ttdeci">static IonizationAndScintillation * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00044">IonizationAndScintillation.cxx:44</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a8a67d792308b4298d3c782bd219e508a"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a8a67d792308b4298d3c782bd219e508a">geo::TPCGeo::Plane0Pitch</a></div><div class="ttdeci">double Plane0Pitch(unsigned int p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00324">TPCGeo.cxx:324</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a37b4d0a99be8c2324273589fda87b851"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a37b4d0a99be8c2324273589fda87b851">geo::TPCGeo::DriftDirection</a></div><div class="ttdeci">DriftDirection_t DriftDirection() const </div><div class="ttdoc">Returns an enumerator value describing the drift direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00144">TPCGeo.h:144</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a57fcc476dae18ae30eece54df28a6a48"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">larg4::LArVoxelReadout::fChannelMaps</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; ChannelMap_t &gt; &gt; fChannelMaps</div><div class="ttdoc">Maps of cryostat, tpc to channel data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">LArVoxelReadout.h:350</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a824a9d9db87dda3b652d7c6bcf90e7db"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">larg4::LArVoxelReadout::fOffPlaneMargin</a></div><div class="ttdeci">double fOffPlaneMargin</div><div class="ttdoc">Charge deposited within this many [cm] from the plane is lead onto it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00348">LArVoxelReadout.h:348</a></div></div>
<div class="ttc" id="namespacegeo_html_a1b5150a78645f276a21647cc0b48fb69a540355ba5bfe18985f585e362f847483"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a1b5150a78645f276a21647cc0b48fb69a540355ba5bfe18985f585e362f847483">geo::kPosX</a></div><div class="ttdoc">Drift towards positive X values. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00161">geo_types.h:161</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a84f2796016f90a4cbbe444c64cbbb77e"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a84f2796016f90a4cbbe444c64cbbb77e">larg4::IonizationAndScintillation::EnergyDeposit</a></div><div class="ttdeci">double EnergyDeposit() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/IonizationAndScintillation_8h_source.html#l00043">IonizationAndScintillation.h:43</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a810e9c2441c76c710c75529632b25674"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">larg4::LArVoxelReadout::fPropGen</a></div><div class="ttdeci">CLHEP::HepRandomEngine * fPropGen</div><div class="ttdoc">random engine for charge propagation </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00358">LArVoxelReadout.h:358</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="detectorproperties__icarus_8fcl_html_a6c3ed9156cb6e7b7a7b21d4c7409cb39"><div class="ttname"><a href="../../d1/d33/detectorproperties__icarus_8fcl.html#a6c3ed9156cb6e7b7a7b21d4c7409cb39">electrons</a></div><div class="ttdeci">electrons</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d33/detectorproperties__icarus_8fcl_source.html#l00008">detectorproperties_icarus.fcl:8</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a411eea9dd765636914a618ded267558c"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a411eea9dd765636914a618ded267558c">geo::TPCGeo::Plane</a></div><div class="ttdeci">PlaneGeo const &amp; Plane(geo::View_t view) const </div><div class="ttdoc">Return the plane in the tpc with View_t view. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00263">TPCGeo.cxx:263</a></div></div>
<div class="ttc" id="classsim_1_1SimChannel_html_a1350027cd6b6e590083c04dd60e37c58"><div class="ttname"><a href="../../d0/daf/classsim_1_1SimChannel.html#a1350027cd6b6e590083c04dd60e37c58">sim::SimChannel::AddIonizationElectrons</a></div><div class="ttdeci">void AddIonizationElectrons(TrackID_t trackID, TDC_t tdc, double numberElectrons, double const *xyz, double energy, TrackID_t origTrackID=util::kBogusI)</div><div class="ttdoc">Add ionization electrons and energy to this channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1c/SimChannel_8cxx_source.html#l00055">SimChannel.cxx:55</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a122a7b8666811f02fba2c0fcdc485d17"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a></div><div class="ttdeci">pdgs k</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="namespaceraw_html_abfe7badfcad7fe0e9474829fbd1408b2"><div class="ttname"><a href="../../d9/d63/namespaceraw.html#abfe7badfcad7fe0e9474829fbd1408b2">raw::ChannelID_t</a></div><div class="ttdeci">unsigned int ChannelID_t</div><div class="ttdoc">Type representing the ID of a readout channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d38/RawTypes_8h_source.html#l00028">RawTypes.h:28</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_ad48eecd625c1d023828570dfeea497dd"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#ad48eecd625c1d023828570dfeea497dd">geo::TPCGeo::PlaneLocation</a></div><div class="ttdeci">const double * PlaneLocation(unsigned int p) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/TPCGeo_8cxx_source.html#l00382">TPCGeo.cxx:382</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada30a2907209e2d945c2af2b7409afb4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::EndOfEvent </td>
          <td>(</td>
          <td class="paramtype">G4HCofThisEvent *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00139">139</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Total number of steps was &quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">fNSteps</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a26e0036d4cd0225f8c0fad77c5ffb7c5"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">larg4::LArVoxelReadout::fNSteps</a></div><div class="ttdeci">size_t fNSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00368">LArVoxelReadout.h:368</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af9c8e8bc595e3332b23acd2014704828"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">LArVoxelReadout::ChannelMap_t</a> &amp; larg4::LArVoxelReadout::GetSimChannelMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the accumulated channel -&gt; SimChannel map for the single TPC. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00163">163</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a>) <span class="keywordflow">return</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af9c8e8bc595e3332b23acd2014704828">GetSimChannelMap</a>(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a>, <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;TPC not specified&quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_af9c8e8bc595e3332b23acd2014704828"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af9c8e8bc595e3332b23acd2014704828">larg4::LArVoxelReadout::GetSimChannelMap</a></div><div class="ttdeci">const ChannelMap_t &amp; GetSimChannelMap() const </div><div class="ttdoc">Returns the accumulated channel -&amp;gt; SimChannel map for the single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00163">LArVoxelReadout.cxx:163</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa28202b3028d0c38f291ded76a9a076e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">LArVoxelReadout::ChannelMap_t</a> &amp; larg4::LArVoxelReadout::GetSimChannelMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00170">170</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a>) <span class="keywordflow">return</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af9c8e8bc595e3332b23acd2014704828">GetSimChannelMap</a>(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a>, <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;TPC not specified&quot;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_af9c8e8bc595e3332b23acd2014704828"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af9c8e8bc595e3332b23acd2014704828">larg4::LArVoxelReadout::GetSimChannelMap</a></div><div class="ttdeci">const ChannelMap_t &amp; GetSimChannelMap() const </div><div class="ttdoc">Returns the accumulated channel -&amp;gt; SimChannel map for the single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00163">LArVoxelReadout.cxx:163</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca7382e0c2eecbea44cd61db366d4d69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">LArVoxelReadout::ChannelMap_t</a> &amp; larg4::LArVoxelReadout::GetSimChannelMap </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>cryo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the accumulated channel -&gt; SimChannel map for the specified TPC. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00177">177</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>.at(cryo).at(tpc);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a57fcc476dae18ae30eece54df28a6a48"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">larg4::LArVoxelReadout::fChannelMaps</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; ChannelMap_t &gt; &gt; fChannelMaps</div><div class="ttdoc">Maps of cryostat, tpc to channel data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">LArVoxelReadout.h:350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada1461c2fadcf13d85285ecc5541a910"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">LArVoxelReadout::ChannelMap_t</a> &amp; larg4::LArVoxelReadout::GetSimChannelMap </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>cryo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00183">183</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>.at(cryo).at(tpc);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a57fcc476dae18ae30eece54df28a6a48"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">larg4::LArVoxelReadout::fChannelMaps</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; ChannelMap_t &gt; &gt; fChannelMaps</div><div class="ttdoc">Maps of cryostat, tpc to channel data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">LArVoxelReadout.h:350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a77902d52af2aa452f219a1f4cb584fdd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a> &gt; larg4::LArVoxelReadout::GetSimChannels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a list with the accumulated information for the single TPC. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00189">189</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a>) <span class="keywordflow">return</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a77902d52af2aa452f219a1f4cb584fdd">GetSimChannels</a>(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a>, <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;TPC not specified&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a77902d52af2aa452f219a1f4cb584fdd"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a77902d52af2aa452f219a1f4cb584fdd">larg4::LArVoxelReadout::GetSimChannels</a></div><div class="ttdeci">std::vector&lt; sim::SimChannel &gt; GetSimChannels() const </div><div class="ttdoc">Creates a list with the accumulated information for the single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00189">LArVoxelReadout.cxx:189</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50d89daf72fb17cc98d767608598d333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d0/daf/classsim_1_1SimChannel.html">sim::SimChannel</a> &gt; larg4::LArVoxelReadout::GetSimChannels </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>cryo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a list with the accumulated information for specified TPC. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00196">196</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    std::vector&lt;sim::SimChannel&gt; channels;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a>&amp; chmap = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">fChannelMaps</a>.at(cryo).at(tpc);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    channels.reserve(chmap.size());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; chpair : chmap)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      channels.push_back(chpair.second);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> channels;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_acafbc91c93e8f5ca9250acf814044566"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">larg4::LArVoxelReadout::ChannelMap_t</a></div><div class="ttdeci">std::map&lt; unsigned int, sim::SimChannel &gt; ChannelMap_t</div><div class="ttdoc">Type of map channel -&amp;gt; sim::SimChannel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00173">LArVoxelReadout.h:173</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a57fcc476dae18ae30eece54df28a6a48"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a57fcc476dae18ae30eece54df28a6a48">larg4::LArVoxelReadout::fChannelMaps</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; ChannelMap_t &gt; &gt; fChannelMaps</div><div class="ttdoc">Maps of cryostat, tpc to channel data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">LArVoxelReadout.h:350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c32ebc7e54397b0c4e0bdb2ffdef7ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::LArVoxelReadout::Has </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned short int &gt;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00329">329</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : v)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> (c == tpc) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97270855ea4fc9fc01325dc72853e635"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::Initialize </td>
          <td>(</td>
          <td class="paramtype">G4HCofThisEvent *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00103">103</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    assert(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">fClockData</a> != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;           <span class="stringliteral">&quot;You must use set the clock data pointer at the beginning &quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           <span class="stringliteral">&quot;of each module&#39;s event-level call.  This might be done through the &quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;           <span class="stringliteral">&quot;LArVoxelReadoutGeometry::Sentry class.&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    assert(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a> != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;           <span class="stringliteral">&quot;You must use set the detector-properties data pointer at the beginning &quot;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;           <span class="stringliteral">&quot;of each module&#39;s event-level call.  This might be done through the &quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;           <span class="stringliteral">&quot;LArVoxelReadoutGeometry::Sentry class.&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">fElectronLifetime</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a>-&gt;<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#ab7d3839ac53abcbf54a5764d8cc3a278">ElectronLifetime</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[i] =</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a>-&gt;<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">DriftVelocity</a>(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a>-&gt;<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">Efield</a>(i), <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a>-&gt;<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">Temperature</a>()) / 1000.;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a39d8dd444c28c75086e6c98df4944e8b">fElectronClusterSize</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;ElectronClusterSize();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">fMinNumberOfElCluster</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;MinNumberOfElCluster();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a067d51ee11da93000365b8e287560176">fLongitudinalDiffusion</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;LongitudinalDiffusion();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a546addc57fb02296ae7392fe23e20fa4">fTransverseDiffusion</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;TransverseDiffusion();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">fDontDriftThem</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;DisableWireplanes();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8f42a7eb85774deb0c4608f02d42b0f3">fSkipWireSignalInTPCs</a> = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;SkipWireSignalInTPCs();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; e lifetime: &quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">fElectronLifetime</a> &lt;&lt; <span class="stringliteral">&quot;\n Temperature: &quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a>-&gt;<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">Temperature</a>()</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n Drift velocity: &quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">fDriftVelocity</a>[2];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">fDontDriftThem</a> = (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">fDontDriftThem</a> || <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">fLgpHandle</a>-&gt;NoElectronPropagation());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">fNSteps</a> = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a546addc57fb02296ae7392fe23e20fa4"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a546addc57fb02296ae7392fe23e20fa4">larg4::LArVoxelReadout::fTransverseDiffusion</a></div><div class="ttdeci">double fTransverseDiffusion</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00341">LArVoxelReadout.h:341</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ad6c8ad91fb43edeab8b1dbbf9befb5ce"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ad6c8ad91fb43edeab8b1dbbf9befb5ce">larg4::LArVoxelReadout::fLgpHandle</a></div><div class="ttdeci">art::ServiceHandle&lt; sim::LArG4Parameters const  &gt; fLgpHandle</div><div class="ttdoc">Handle to the LArG4 parameters service. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00353">LArVoxelReadout.h:353</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a2f77225788d26f6107b7ec76a24ffe90"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a2f77225788d26f6107b7ec76a24ffe90">larg4::LArVoxelReadout::fDriftVelocity</a></div><div class="ttdeci">double fDriftVelocity[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00339">LArVoxelReadout.h:339</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_adf5e78cd901a16fa2e2a92108f6ba51a"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#adf5e78cd901a16fa2e2a92108f6ba51a">larg4::LArVoxelReadout::fElectronLifetime</a></div><div class="ttdeci">double fElectronLifetime</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00342">LArVoxelReadout.h:342</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a726fd2493300deadcdf94ca80bbbc9a0"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a726fd2493300deadcdf94ca80bbbc9a0">detinfo::DetectorPropertiesData::Temperature</a></div><div class="ttdeci">double Temperature() const </div><div class="ttdoc">In kelvin. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00081">DetectorPropertiesData.cc:81</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_af0a9f3e61578f6cdf1a82e040a99c260"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#af0a9f3e61578f6cdf1a82e040a99c260">larg4::LArVoxelReadout::fMinNumberOfElCluster</a></div><div class="ttdeci">int fMinNumberOfElCluster</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00344">LArVoxelReadout.h:344</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_ab7d3839ac53abcbf54a5764d8cc3a278"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#ab7d3839ac53abcbf54a5764d8cc3a278">detinfo::DetectorPropertiesData::ElectronLifetime</a></div><div class="ttdeci">double ElectronLifetime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00069">DetectorPropertiesData.cc:69</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_aa91a373be28431a5aafab69d0c49480a"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">larg4::LArVoxelReadout::fClockData</a></div><div class="ttdeci">detinfo::DetectorClocksData const * fClockData</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00360">LArVoxelReadout.h:360</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a067d51ee11da93000365b8e287560176"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a067d51ee11da93000365b8e287560176">larg4::LArVoxelReadout::fLongitudinalDiffusion</a></div><div class="ttdeci">double fLongitudinalDiffusion</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00340">LArVoxelReadout.h:340</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a87dfb4de332731a6219f2393ac5d11d5"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a87dfb4de332731a6219f2393ac5d11d5">detinfo::DetectorPropertiesData::Efield</a></div><div class="ttdeci">double Efield(unsigned int planegap=0) const </div><div class="ttdoc">kV/cm </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00017">DetectorPropertiesData.cc:17</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a39d8dd444c28c75086e6c98df4944e8b"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a39d8dd444c28c75086e6c98df4944e8b">larg4::LArVoxelReadout::fElectronClusterSize</a></div><div class="ttdeci">double fElectronClusterSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00343">LArVoxelReadout.h:343</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a5356095138172c0de94b65826bc256d3"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">larg4::LArVoxelReadout::fDontDriftThem</a></div><div class="ttdeci">bool fDontDriftThem</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00345">LArVoxelReadout.h:345</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8f42a7eb85774deb0c4608f02d42b0f3"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8f42a7eb85774deb0c4608f02d42b0f3">larg4::LArVoxelReadout::fSkipWireSignalInTPCs</a></div><div class="ttdeci">std::vector&lt; unsigned short int &gt; fSkipWireSignalInTPCs</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00346">LArVoxelReadout.h:346</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a26e0036d4cd0225f8c0fad77c5ffb7c5"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">larg4::LArVoxelReadout::fNSteps</a></div><div class="ttdeci">size_t fNSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00368">LArVoxelReadout.h:368</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe2868777a176d36caf3c7fefd39e17"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">larg4::LArVoxelReadout::fDetProp</a></div><div class="ttdeci">detinfo::DetectorPropertiesData const * fDetProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00361">LArVoxelReadout.h:361</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a5667a83a4014a59ccd6c2a0d0fbb58c1"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a5667a83a4014a59ccd6c2a0d0fbb58c1">detinfo::DetectorPropertiesData::DriftVelocity</a></div><div class="ttdeci">double DriftVelocity(double efield=0., double temperature=0.) const </div><div class="ttdoc">cm/us </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00023">DetectorPropertiesData.cc:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a77e83ca5e22f67a5749c4dbc724d50aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::PrintAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00598">598</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  {}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae9c47c388c5b4489e5e9e30ed4c4a655"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4bool larg4::LArVoxelReadout::ProcessHits </td>
          <td>(</td>
          <td class="paramtype">G4Step *&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4TouchableHistory *&#160;</td>
          <td class="paramname"><em>pHistory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00209">209</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// All work done for the &quot;parallel world&quot; &quot;box of voxels&quot; in</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// LArVoxelReadoutGeometry makes this a fairly simple routine.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// First, the usual check for non-zero energy:</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// Only process the hit if the step is inside the active volume and</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// it has deposited energy.  The hit being inside the active volume</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// is virtually sure to happen because the LArVoxelReadoutGeometry</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// that this class makes use of only has voxels for inside the TPC.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// The step can be no bigger than the size of the voxel,</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// because of the geometry set up in LArVoxelGeometry and the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// transportation set up in PhysicsList.  Find the mid-point</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// of the step.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (step-&gt;GetTotalEnergyDeposit() &gt; 0) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// Make sure we have the IonizationAndScintillation singleton</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// reset to this step</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a>()-&gt;<a class="code" href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a36d3b1ef43576b020ca130e80f069e84">Reset</a>(step);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">fNSteps</a>++;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">fDontDriftThem</a>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        G4ThreeVector midPoint =</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          0.5 * (step-&gt;GetPreStepPoint()-&gt;GetPosition() + step-&gt;GetPostStepPoint()-&gt;GetPosition());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordtype">double</span> g4time = step-&gt;GetPreStepPoint()-&gt;GetGlobalTime();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// Find the Geant4 track ID for the particle responsible for depositing the</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">// energy.  if we are only storing primary EM shower particles, and this energy</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">// is from a secondary etc EM shower particle, the ID returned is the primary</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> trackID = <a class="code" href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">ParticleListAction::GetCurrentTrackID</a>();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// For all particles but shower daughters, origTrackID is the same as trackID.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// For shower daughters it contains their original trackID instead of the</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// shower primary&#39;s trackID.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> origTrackID = <a class="code" href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#a8708bc1856d228f028e6cfae55c540d8">ParticleListAction::GetCurrentOrigTrackID</a>();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">// Find out which TPC we are in.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// If this readout object covers just one, we already know it.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// Otherwise, we have to ask Geant where we are.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> cryostat = 0, tpc = 0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          cryostat = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          tpc = <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          <span class="comment">// detect the TPC we are in</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keyword">const</span> G4VTouchable* pTouchable = step-&gt;GetPreStepPoint()-&gt;GetTouchable();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordflow">if</span> (!pTouchable) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArG4&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Untouchable step in LArVoxelReadout::ProcessHits()&quot;</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="comment">// one of the ancestors of the touched volume is supposed to be</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="comment">// actually a G4PVPlacementInTPC that knows which TPC it covers;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="comment">// currently, it&#39;s the 4th in the ladder:</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="comment">// [0] voxel [1] voxel tower [2] voxel plane [3] the full box;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          G4int depth = 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordflow">while</span> (depth &lt; pTouchable-&gt;GetHistoryDepth()) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d7/d6f/namespacelarg4.html#a881353f0f9c2859d39c7d2ae76481bad">G4PVPlacementInTPC</a>* pPVinTPC =</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d7/d6f/namespacelarg4.html#a881353f0f9c2859d39c7d2ae76481bad">G4PVPlacementInTPC</a>*<span class="keyword">&gt;</span>(pTouchable-&gt;GetVolume(depth++));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (!pPVinTPC) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            cryostat = pPVinTPC-&gt;ID.Cryostat;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            tpc = pPVinTPC-&gt;ID.TPC;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5c32ebc7e54397b0c4e0bdb2ffdef7ae">Has</a>(<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8f42a7eb85774deb0c4608f02d42b0f3">fSkipWireSignalInTPCs</a>, tpc)) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          } <span class="comment">// while</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">if</span> (depth &lt; pTouchable-&gt;GetHistoryDepth()) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="comment">// this is a fundamental error where the step does not happen in</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">// any TPC; this should not happen in the readout geometry!</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;LArG4&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;No TPC ID found in LArVoxelReadout::ProcessHits()&quot;</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          } <span class="comment">// if</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadoutHit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; hit in C=&quot;</span> &lt;&lt; cryostat &lt;&lt; <span class="stringliteral">&quot; T=&quot;</span> &lt;&lt; tpc;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        } <span class="comment">// if more than one TPC</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// Note that if there is no particle ID for this energy deposit, the</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// trackID will be sim::NoParticleId.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a18751342a6908cff9f4cae2f8a09d0cb">DriftIonizationElectrons</a>(*<a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">fClockData</a>, midPoint, g4time, trackID, cryostat, tpc, origTrackID);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      } <span class="comment">// end we are drifting</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }   <span class="comment">// end there is non-zero energy deposition</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1ParticleListAction_html_a8708bc1856d228f028e6cfae55c540d8"><div class="ttname"><a href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#a8708bc1856d228f028e6cfae55c540d8">larg4::ParticleListAction::GetCurrentOrigTrackID</a></div><div class="ttdeci">static int GetCurrentOrigTrackID()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/ParticleListAction_8h_source.html#l00126">ParticleListAction.h:126</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_aa91a373be28431a5aafab69d0c49480a"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">larg4::LArVoxelReadout::fClockData</a></div><div class="ttdeci">detinfo::DetectorClocksData const * fClockData</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00360">LArVoxelReadout.h:360</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a36d3b1ef43576b020ca130e80f069e84"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a36d3b1ef43576b020ca130e80f069e84">larg4::IonizationAndScintillation::Reset</a></div><div class="ttdeci">void Reset(const G4Step *step)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00098">IonizationAndScintillation.cxx:98</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a5356095138172c0de94b65826bc256d3"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5356095138172c0de94b65826bc256d3">larg4::LArVoxelReadout::fDontDriftThem</a></div><div class="ttdeci">bool fDontDriftThem</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00345">LArVoxelReadout.h:345</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8f42a7eb85774deb0c4608f02d42b0f3"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8f42a7eb85774deb0c4608f02d42b0f3">larg4::LArVoxelReadout::fSkipWireSignalInTPCs</a></div><div class="ttdeci">std::vector&lt; unsigned short int &gt; fSkipWireSignalInTPCs</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00346">LArVoxelReadout.h:346</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a18751342a6908cff9f4cae2f8a09d0cb"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a18751342a6908cff9f4cae2f8a09d0cb">larg4::LArVoxelReadout::DriftIonizationElectrons</a></div><div class="ttdeci">void DriftIonizationElectrons(detinfo::DetectorClocksData const &amp;clockData, G4ThreeVector stepMidPoint, const double simTime, int trackID, unsigned short int cryostat, unsigned short int tpc, int origTrackID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00340">LArVoxelReadout.cxx:340</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a26e0036d4cd0225f8c0fad77c5ffb7c5"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a26e0036d4cd0225f8c0fad77c5ffb7c5">larg4::LArVoxelReadout::fNSteps</a></div><div class="ttdeci">size_t fNSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00368">LArVoxelReadout.h:368</a></div></div>
<div class="ttc" id="classlarg4_1_1IonizationAndScintillation_html_a30d440651b97effb3a48f67d3ad4d5f1"><div class="ttname"><a href="../../d5/de6/classlarg4_1_1IonizationAndScintillation.html#a30d440651b97effb3a48f67d3ad4d5f1">larg4::IonizationAndScintillation::Instance</a></div><div class="ttdeci">static IonizationAndScintillation * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc3/IonizationAndScintillation_8cxx_source.html#l00044">IonizationAndScintillation.cxx:44</a></div></div>
<div class="ttc" id="namespacelarg4_html_a881353f0f9c2859d39c7d2ae76481bad"><div class="ttname"><a href="../../d7/d6f/namespacelarg4.html#a881353f0f9c2859d39c7d2ae76481bad">larg4::G4PVPlacementInTPC</a></div><div class="ttdeci">G4PVPlacementWithID&lt; TPCID_t &gt; G4PVPlacementInTPC</div><div class="ttdoc">A physical volume with a TPC ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00130">LArVoxelReadout.h:130</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a5c32ebc7e54397b0c4e0bdb2ffdef7ae"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a5c32ebc7e54397b0c4e0bdb2ffdef7ae">larg4::LArVoxelReadout::Has</a></div><div class="ttdeci">bool Has(std::vector&lt; unsigned short int &gt; v, unsigned short int tpc) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00329">LArVoxelReadout.h:329</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
<div class="ttc" id="classlarg4_1_1ParticleListAction_html_adbeb4f865250923b00533c44136ff9a3"><div class="ttname"><a href="../../d0/dc3/classlarg4_1_1ParticleListAction.html#adbeb4f865250923b00533c44136ff9a3">larg4::ParticleListAction::GetCurrentTrackID</a></div><div class="ttdeci">static int GetCurrentTrackID()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/ParticleListAction_8h_source.html#l00121">ParticleListAction.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a522a5eb1d9ff52e7cf8940a006117e27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::ProcessStep </td>
          <td>(</td>
          <td class="paramtype">G4Step *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a690d0c3f4cead092c218eddd2d740e8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> larg4::LArVoxelReadout::RecoverOffPlaneDeposit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d67/classgeo_1_1PlaneGeo.html">geo::PlaneGeo</a> const &amp;&#160;</td>
          <td class="paramname"><em>plane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the point on the specified plane closest to position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>the position to be tested (global coordinates, centimeters) </td></tr>
    <tr><td class="paramname">plane</td><td>the plane to test the position against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a position on plane, unless pos is too far from it</dd></dl>
<p>This method considers the distance of the position <code>pos</code> from the active part of the <code>plane</code> (see <code>geo::Plane::DeltaFromActivePlane()</code>). If the position is less than a configurable margin far from the plane, the closest point on the plane to that position is returned. Otherwise, the position itself is returned.</p>
<p>Ionization charge may be drifted so that when it arrives to the plane, it actually does not hit the area covered by wires. This can happen for many reasons:</p>
<ul>
<li>space charge distortion led the point outside the fiducial volume (this may be prevented by specific code)</li>
<li>diffusion pushes the charge outside the instrumented region</li>
<li>the geometry of the wire planes is such that planes have different coverage and what one plane can cover, the next can't</li>
</ul>
<p>The "recovery" consists in forcing the charge to the instrumented area covered by the plane wires. The distance of the drifted charge from each plane border is computed and compared to the margin. If that distance is smaller than the margin, it is neglected and the charge is assigned a new position on that border.</p>
<p>This method provides the position that should be used for the charge deposition.</p>
<p>This is a simplistic approach to the simulation of border effects, assuming that in fact the electric field, which is continuous and pointing to the collection wires, will drive the charge to the wires even when they are "off track". No correction is applied for the additional time that such deviation would take. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00303">303</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// translate the landing position on the two frame coordinates</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// (&quot;width&quot; and &quot;depth&quot;)</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> landingPos = plane.PointWidthDepthProjection(pos);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// compute the distance of the landing position on the two frame</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// coordinates (&quot;width&quot; and &quot;depth&quot;);</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// keep the point within 10 micrometers (0.001 cm) from the border</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> offPlane = plane.DeltaFromActivePlane(landingPos, 0.001);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// if both the distances are below the margin, move the point to</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// the border</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// nothing to recover: landing is inside</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> ((offPlane.X() == 0.0) &amp;&amp; (offPlane.Y() == 0.0)) <span class="keywordflow">return</span> pos;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// won&#39;t recover: too far</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(offPlane.X()) &gt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">fOffPlaneMargin</a>) || (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(offPlane.Y()) &gt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">fOffPlaneMargin</a>))</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">return</span> pos;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// we didn&#39;t fully decompose because it might be unnecessary;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// now we need the full thing</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> = plane.DistanceFromPlane(pos);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> plane.ComposePoint&lt;<a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>&gt;(<a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a>, landingPos + offPlane);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  } <span class="comment">// LArVoxelReadout::RecoverOffPlaneDeposit()</span></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="namespaceicarus_html_a6ad3253842c1a0803df7cd600b60c35f"><div class="ttname"><a href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">icarus::distance</a></div><div class="ttdeci">double distance(geo::Point_t const &amp;point, CathodeDesc_t const &amp;cathode)</div><div class="ttdoc">Returns the distance of a point from the cathode. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd1/CathodeCrossingUtils_8cxx_source.html#l00035">CathodeCrossingUtils.cxx:35</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a824a9d9db87dda3b652d7c6bcf90e7db"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">larg4::LArVoxelReadout::fOffPlaneMargin</a></div><div class="ttdeci">double fOffPlaneMargin</div><div class="ttdoc">Charge deposited within this many [cm] from the plane is lead onto it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00348">LArVoxelReadout.h:348</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6cfa9ce8e7f1f072f570ef3a4f3af418"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetClockData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const *const&#160;</td>
          <td class="paramname"><em>clockData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00251">251</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">fClockData</a> = clockData;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_aa91a373be28431a5aafab69d0c49480a"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa91a373be28431a5aafab69d0c49480a">larg4::LArVoxelReadout::fClockData</a></div><div class="ttdeci">detinfo::DetectorClocksData const * fClockData</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00360">LArVoxelReadout.h:360</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4baefb0b5bea1fba1bae52369dc0fe31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetDiscoverTPC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets this readout to discover the TPC of each processed hit. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00092">92</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a> = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a> = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; GetName() &lt;&lt; <span class="stringliteral">&quot; autodetects TPC&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6c468c3f742afca6e944d63c289eb46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetOffPlaneChargeRecoveryMargin </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>margin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the margin for recovery of charge drifted off-plane. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">margin</td><td>the extent of the margin on each frame coordinate [cm]</td></tr>
  </table>
  </dd>
</dl>
<p>This method sets the margin for the recovery of off-plane ionization charge. See <code><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a690d0c3f4cead092c218eddd2d740e8c" title="Returns the point on the specified plane closest to position. ">RecoverOffPlaneDeposit()</a></code> for a description of that feature.</p>
<p>This method is used by <code><a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a210d61419d79baa0ae82f44fdb215087" title="Reads all the configuration elements from setupData ">LArVoxelReadout::Setup()</a></code>. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00272">272</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">fOffPlaneMargin</a> = std::max(margin, 0.0);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a824a9d9db87dda3b652d7c6bcf90e7db"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a824a9d9db87dda3b652d7c6bcf90e7db">larg4::LArVoxelReadout::fOffPlaneMargin</a></div><div class="ttdeci">double fOffPlaneMargin</div><div class="ttdoc">Charge deposited within this many [cm] from the plane is lead onto it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00348">LArVoxelReadout.h:348</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a349d6937c797a4db5038a01a98a41dc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetPropertiesData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const *const&#160;</td>
          <td class="paramname"><em>detProp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00257">257</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">fDetProp</a> = <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe2868777a176d36caf3c7fefd39e17"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe2868777a176d36caf3c7fefd39e17">larg4::LArVoxelReadout::fDetProp</a></div><div class="ttdeci">detinfo::DetectorPropertiesData const * fDetProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00361">LArVoxelReadout.h:361</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00157">SimWire_module.cc:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1fbe4db5635b18fc88264444457a7ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetRandomEngines </td>
          <td>(</td>
          <td class="paramtype">CLHEP::HepRandomEngine *&#160;</td>
          <td class="paramname"><em>pPropGen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the random generators to be used. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00295">295</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    assert(pPropGen); <span class="comment">// random engine must be present</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">fPropGen</a> = pPropGen;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a810e9c2441c76c710c75529632b25674"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a810e9c2441c76c710c75529632b25674">larg4::LArVoxelReadout::fPropGen</a></div><div class="ttdeci">CLHEP::HepRandomEngine * fPropGen</div><div class="ttdoc">random engine for charge propagation </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00358">LArVoxelReadout.h:358</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86f4f3e5c2a6b4305e448a0aa9b687e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::SetSingleTPC </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>cryostat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Associates this readout to one specific TPC. </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00083">83</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">bSingleTPC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a> = cryostat;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a> = tpc;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    MF_LOG_DEBUG(<span class="stringliteral">&quot;LArVoxelReadout&quot;</span>) &lt;&lt; GetName() &lt;&lt; <span class="stringliteral">&quot;covers C=&quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">fCstat</a> &lt;&lt; <span class="stringliteral">&quot; T=&quot;</span> &lt;&lt; <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">fTPC</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_affe49871fd8578efdbcfb5dc93476914"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#affe49871fd8578efdbcfb5dc93476914">larg4::LArVoxelReadout::fTPC</a></div><div class="ttdeci">unsigned int fTPC</div><div class="ttdoc">which TPC this LArVoxelReadout corresponds to </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">LArVoxelReadout.h:354</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_a8b256b8a003d3253f2b267c1a63c45a9"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#a8b256b8a003d3253f2b267c1a63c45a9">larg4::LArVoxelReadout::bSingleTPC</a></div><div class="ttdeci">bool bSingleTPC</div><div class="ttdoc">true if this readout is associated with a single TPC </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">LArVoxelReadout.h:356</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ac9c6fd500b94ba6a6b0bc920ba5bfed2"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ac9c6fd500b94ba6a6b0bc920ba5bfed2">larg4::LArVoxelReadout::fCstat</a></div><div class="ttdeci">unsigned int fCstat</div><div class="ttdoc">and in which cryostat (if bSingleTPC is true) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">LArVoxelReadout.h:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a210d61419d79baa0ae82f44fdb215087"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void larg4::LArVoxelReadout::Setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/structlarg4_1_1LArVoxelReadout_1_1Setup__t.html">Setup_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>setupData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads all the configuration elements from <code>setupData</code> </p>

<p>Definition at line <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00075">75</a> of file <a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa6c468c3f742afca6e944d63c289eb46">SetOffPlaneChargeRecoveryMargin</a>(setupData.offPlaneMargin);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ae1fbe4db5635b18fc88264444457a7ae">SetRandomEngines</a>(setupData.propGen);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_ae1fbe4db5635b18fc88264444457a7ae"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#ae1fbe4db5635b18fc88264444457a7ae">larg4::LArVoxelReadout::SetRandomEngines</a></div><div class="ttdeci">void SetRandomEngines(CLHEP::HepRandomEngine *pPropGen)</div><div class="ttdoc">Sets the random generators to be used. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d99/LArVoxelReadout_8cxx_source.html#l00295">LArVoxelReadout.cxx:295</a></div></div>
<div class="ttc" id="classlarg4_1_1LArVoxelReadout_html_aa6c468c3f742afca6e944d63c289eb46"><div class="ttname"><a href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#aa6c468c3f742afca6e944d63c289eb46">larg4::LArVoxelReadout::SetOffPlaneChargeRecoveryMargin</a></div><div class="ttdeci">void SetOffPlaneChargeRecoveryMargin(double margin)</div><div class="ttdoc">Sets the margin for recovery of charge drifted off-plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/LArVoxelReadout_8h_source.html#l00272">LArVoxelReadout.h:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a88c5cf9f84630f68abd402f3a4d28c89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d1/d1b/classlarg4_1_1LArVoxelReadoutGeometry.html">LArVoxelReadoutGeometry</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00248">248</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8b256b8a003d3253f2b267c1a63c45a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::LArVoxelReadout::bSingleTPC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>true if this readout is associated with a single TPC </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00356">356</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57fcc476dae18ae30eece54df28a6a48"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html#acafbc91c93e8f5ca9250acf814044566">ChannelMap_t</a>&gt; &gt; larg4::LArVoxelReadout::fChannelMaps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maps of cryostat, tpc to channel data. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00350">350</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa91a373be28431a5aafab69d0c49480a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> const* larg4::LArVoxelReadout::fClockData {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00360">360</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac9c6fd500b94ba6a6b0bc920ba5bfed2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int larg4::LArVoxelReadout::fCstat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>and in which cryostat (if bSingleTPC is true) </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00355">355</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="affe2868777a176d36caf3c7fefd39e17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> const* larg4::LArVoxelReadout::fDetProp {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00361">361</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5356095138172c0de94b65826bc256d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d6f/namespacelarg4.html#a42b3ada02e272fe2fa2b641ba06ab7d4">bool</a> larg4::LArVoxelReadout::fDontDriftThem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00345">345</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2f77225788d26f6107b7ec76a24ffe90"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fDriftVelocity[3]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00339">339</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a39d8dd444c28c75086e6c98df4944e8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fElectronClusterSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00343">343</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="adf5e78cd901a16fa2e2a92108f6ba51a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fElectronLifetime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00342">342</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a515a61c5bc2e106de404883f7809c814"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">art::ServiceHandle&lt;<a class="el" href="../../d8/df3/classgeo_1_1Geometry.html">geo::Geometry</a> const&gt; larg4::LArVoxelReadout::fGeoHandle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle to the Geometry service. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00351">351</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6c8ad91fb43edeab8b1dbbf9befb5ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">art::ServiceHandle&lt;<a class="el" href="../../d2/d7f/classsim_1_1LArG4Parameters.html">sim::LArG4Parameters</a> const&gt; larg4::LArVoxelReadout::fLgpHandle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle to the <a class="el" href="../../d9/d64/classlarg4_1_1LArG4.html" title="Runs Geant4 simulation and propagation of electrons and photons to readout. ">LArG4</a> parameters service. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00353">353</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a067d51ee11da93000365b8e287560176"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fLongitudinalDiffusion</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00340">340</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="af0a9f3e61578f6cdf1a82e040a99c260"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int larg4::LArVoxelReadout::fMinNumberOfElCluster</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00344">344</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a26e0036d4cd0225f8c0fad77c5ffb7c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t larg4::LArVoxelReadout::fNSteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00368">368</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a824a9d9db87dda3b652d7c6bcf90e7db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fOffPlaneMargin = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Charge deposited within this many [cm] from the plane is lead onto it. </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00348">348</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a810e9c2441c76c710c75529632b25674"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CLHEP::HepRandomEngine* larg4::LArVoxelReadout::fPropGen = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>random engine for charge propagation </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00358">358</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f42a7eb85774deb0c4608f02d42b0f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned short int&gt; larg4::LArVoxelReadout::fSkipWireSignalInTPCs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00346">346</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4d89e31c36dbd9958638462e43c72c85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4ThreeVector larg4::LArVoxelReadout::fStepEnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00367">367</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a09e5c94ce29b98ebe7541f8611ad0ee3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4ThreeVector larg4::LArVoxelReadout::fStepStart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00366">366</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="affe49871fd8578efdbcfb5dc93476914"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int larg4::LArVoxelReadout::fTPC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>which TPC this <a class="el" href="../../db/d19/classlarg4_1_1LArVoxelReadout.html" title="Transports energy depositions from GEANT4 to TPC channels. ">LArVoxelReadout</a> corresponds to </p>

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00354">354</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<a class="anchor" id="a546addc57fb02296ae7392fe23e20fa4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double larg4::LArVoxelReadout::fTransverseDiffusion</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html#l00341">341</a> of file <a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d42/LArVoxelReadout_8h_source.html">LArVoxelReadout.h</a></li>
<li><a class="el" href="../../d0/d99/LArVoxelReadout_8cxx_source.html">LArVoxelReadout.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
