<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Track3DKalmanHitAlg.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_a92975983e87729a773cfa3b8109c8c3.html">RecoAlg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Track3DKalmanHitAlg.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../db/d36/Track3DKalmanHitAlg_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \file   Track3DKalmanHitAlg.cxx</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment">/// \brief  Track3DKalmanHitAlg.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="comment">/// \author</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span><span class="comment">///</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span><span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd3/Track3DKalmanHitAlg_8h.html">larreco/RecoAlg/Track3DKalmanHitAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;canvas/Persistency/Common/PtrVector.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;cetlib_except/exception.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2e/ServiceUtil_8h.html">larcore/CoreUtils/ServiceUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/de5/WireGeo_8h.html">larcorealg/Geometry/WireGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d48/geo__types_8h.html">larcoreobj/SimpleTypesAndConstants/geo_types.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d0f/KETrack_8h.html">lardata/RecoObjects/KETrack.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d4b/KHitContainerWireLine_8h.html">lardata/RecoObjects/KHitContainerWireLine.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/df6/KHitContainerWireX_8h.html">lardata/RecoObjects/KHitContainerWireX.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d9d/KHitTrack_8h.html">lardata/RecoObjects/KHitTrack.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d96/KTrack_8h.html">lardata/RecoObjects/KTrack.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d7d/KalmanLinearAlgebra_8h.html">lardata/RecoObjects/KalmanLinearAlgebra.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/def/SurfXYZPlane_8h.html">lardata/RecoObjects/SurfXYZPlane.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dbc/DetectorProperties_8h.html">lardataalg/DetectorInfo/DetectorProperties.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7a/DetectorPropertiesData_8h.html">lardataalg/DetectorInfo/DetectorPropertiesData.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd3/Track3DKalmanHitAlg_8h.html">larreco/RecoAlg/Track3DKalmanHitAlg.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// Local functions.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  calcMagnitude(<span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> std::hypot(x[0], x[1], x[2]);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// Filter a collection of hits (set difference).</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Arguments:</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// hits      - Hit collection from which hits should be removed.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// used_hits - Hits to remove.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  filterHits(<a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">trkf::Hits</a>&amp; hits, <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">trkf::Hits</a>&amp; used_hits)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (used_hits.size() &gt; 0) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="comment">// Make sure both hit collections are sorted.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      std::stable_sort(hits.begin(), hits.end());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      std::stable_sort(used_hits.begin(), used_hits.end());</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">// Do set difference operation.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      trkf::Hits::iterator it = std::set_difference(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        hits.begin(), hits.end(), used_hits.begin(), used_hits.end(), hits.begin());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="comment">// Truncate hit collection.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      hits.erase(it, hits.end());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/// Constructor.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a496e6f2a554e7d40613e812720f3c050">   84</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a496e6f2a554e7d40613e812720f3c050">trkf::Track3DKalmanHitAlg::Track3DKalmanHitAlg</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp; pset)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  : fDoDedx{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;DoDedx&quot;</span>)}</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a2e7b106b25e2a5d85a3a83c5c5081e48">fSelfSeed</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;SelfSeed&quot;</span>)}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ae6e2651bdc3e38a17e875a0acdc00920">fMaxTcut</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxTcut&quot;</span>)}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a78ebe9ab9934e0f2d7d93905d957abce">fLineSurface</a>{pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;LineSurface&quot;</span>)}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a534573e0b8e07f723c5161a52f78d4f2">fMinSeedHits</a>{pset.get&lt;<span class="keywordtype">size_t</span>&gt;(<span class="stringliteral">&quot;MinSeedHits&quot;</span>)}</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a029e468bbdb8958b339d88a46af76925">fMinSeedChopHits</a>{pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;MinSeedChopHits&quot;</span>)}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a17446800338b8c6d37c885235c01356f">fMaxChopHits</a>{pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;MaxChopHits&quot;</span>)}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a5a31656ab98a70d70e1cef4fc49149e7">fMaxSeedChiDF</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxSeedChiDF&quot;</span>)}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#adc4bf23bfc3ccb9ac3ceae1d6391eb3d">fMinSeedSlope</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MinSeedSlope&quot;</span>)}</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a14d3accbf64d22ec29aff9781329e2e2">fInitialMomentum</a>{pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;InitialMomentum&quot;</span>)}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>(pset.get&lt;fhicl::ParameterSet&gt;(<span class="stringliteral">&quot;KalmanFilterAlg&quot;</span>))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab0127c7e092991ed8186ec420b4a6af6">fSeedFinderAlg</a>(pset.get&lt;fhicl::ParameterSet&gt;(<span class="stringliteral">&quot;SeedFinderAlg&quot;</span>))</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  , <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aa7162c8b5e386c5835513edc2ad48d93">fNumTrack</a>(0)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;Track3DKalmanHitAlg&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Track3DKalmanHitAlg instantiated.&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//makeTracks</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;std::vector&lt;trkf::KalmanOutput&gt;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9aa8e7b824081bd95d6e6750848b1fbc">  105</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9aa8e7b824081bd95d6e6750848b1fbc">trkf::Track3DKalmanHitAlg::makeTracks</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                      <a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                      <a class="code" href="../../d0/da2/namespacetrkf.html#a68df189a006469d8e524dc5f499b53af">KalmanInputs</a>&amp; inputs)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  std::vector&lt;KalmanOutput&gt; <a class="code" href="../../dd/d08/triggersim__singlewindow__icarus_8fcl.html#a0cfd9e1c19570259ad279d6a291a27f8">outputs</a>(inputs.size());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Loop over input vectors.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; inputs.size(); ++i) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits = inputs[i].hits;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// The hit collection &quot;hits&quot; (just filled), initially containing all</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// hits, represents hits available for making tracks.  Now we will</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// fill a second hit collection called &quot;unusedhits&quot;, also initially</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// containing all hits, which will represent hits available for</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// making track seeds.  These collections are not necessarily the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// same, since hits that are not suitable for seeds may still be</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// suitable for tracks.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> unusedhits = hits;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Start of loop.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      std::vector&lt;Hits&gt; hitsperseed;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      std::vector&lt;recob::Seed&gt; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">// On the first trip through this loop, try to use pfparticle-associated seeds.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// Do this, provided the list of pfparticle-associated seeds and associated</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">// hits are not empty.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordtype">bool</span> pfseed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> seedsize = inputs[i].seeds.size();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> (first &amp;&amp; seedsize &gt; 0 &amp;&amp; inputs[i].seedhits.size() &gt; 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        seeds.reserve(seedsize);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a216d57e2482b728ae71772b8db62f179">fetchPFParticleSeeds</a>(inputs[i].seeds, inputs[i].seedhits, seeds, hitsperseed);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        pfseed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">// On subsequent trips, or if there were no usable pfparticle-associated seeds,</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// attempt to generate our own seeds.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (unusedhits.size() &gt; 0) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a2e7b106b25e2a5d85a3a83c5c5081e48">fSelfSeed</a>) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">// Self seed - convert all hits into one big seed.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            seeds.emplace_back(<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a4493e9c336dc480e2ef4378523d36bc3">makeSeed</a>(detProp, unusedhits));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            hitsperseed.emplace_back();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            hitsperseed.back().insert(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;              hitsperseed.back().end(), unusedhits.begin(), unusedhits.end());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            seeds =</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab0127c7e092991ed8186ec420b4a6af6">fSeedFinderAlg</a>.<a class="code" href="../../d5/d24/classtrkf_1_1SeedFinderAlgorithm.html#aeb0ee2bf723febea42e21a4af56ceec1">GetSeedsFromUnSortedHits</a>(clockData, detProp, unusedhits, hitsperseed);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      assert(seeds.size() == hitsperseed.size());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">empty</a>(seeds)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a0921bcf5caff483f7e25b6b9d70cc90f">growSeedsIntoTracks</a>(detProp, pfseed, seeds, hitsperseed, unusedhits, hits, <a class="code" href="../../dd/d08/triggersim__singlewindow__icarus_8fcl.html#a0cfd9e1c19570259ad279d6a291a27f8">outputs</a>[i].<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d08/triggersim__singlewindow__icarus_8fcl.html#a0cfd9e1c19570259ad279d6a291a27f8">outputs</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">/// Fetch Seeds method.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a216d57e2482b728ae71772b8db62f179">  168</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a216d57e2482b728ae71772b8db62f179">trkf::Track3DKalmanHitAlg::fetchPFParticleSeeds</a>(<span class="keyword">const</span> art::PtrVector&lt;recob::Seed&gt;&amp; pfseeds,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                                <span class="keyword">const</span> std::vector&lt;Hits&gt;&amp; pfseedhits,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                std::vector&lt;recob::Seed&gt;&amp; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                                std::vector&lt;Hits&gt;&amp; hitsperseed)<span class="keyword"> const</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pseed : pfseeds) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    seeds.push_back(*pseed);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  hitsperseed.insert(hitsperseed.end(), pfseedhits.begin(), pfseedhits.end());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/// Grow Seeds method.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a0921bcf5caff483f7e25b6b9d70cc90f">  183</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a0921bcf5caff483f7e25b6b9d70cc90f">trkf::Track3DKalmanHitAlg::growSeedsIntoTracks</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">bool</span> pfseed,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                               <span class="keyword">const</span> std::vector&lt;recob::Seed&gt;&amp; <a class="code" href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">seeds</a>,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                               <span class="keyword">const</span> std::vector&lt;Hits&gt;&amp; hitsperseed,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                               <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; unusedhits,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                               <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                               std::deque&lt;KGTrack&gt;&amp; kgtracks)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// check for size of both containers</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">if</span> (seeds.size() != hitsperseed.size()) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;Track3DKalmanHitAlg&quot;</span>)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Different size containers for Seeds and Hits/Seed.\n&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; seeds.size(); ++i) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab848ede08844c413cee0792876c7a597">growSeedIntoTracks</a>(detProp, pfseed, seeds[i], hitsperseed[i], unusedhits, hits, kgtracks);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab848ede08844c413cee0792876c7a597">  203</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab848ede08844c413cee0792876c7a597">trkf::Track3DKalmanHitAlg::growSeedIntoTracks</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span> pfseed,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a>&amp; <a class="code" href="../../d5/d56/NeutronOsc__module_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hpsit,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                              <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; unusedhits,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                              <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                              std::deque&lt;KGTrack&gt;&amp; kgtracks)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> trimmedhits;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Chop a couple of hits off each end of the seed.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7f7aad27d4eb12db4c1848b785462882">chopHitsOffSeeds</a>(hpsit, pfseed, trimmedhits);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// Filter hits used by (chopped) seed from hits available to make future seeds.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// No matter what, we will never use these hits for another seed.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// This eliminates the possibility of an infinite loop.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">size_t</span> initial_unusedhits = unusedhits.size();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  filterHits(unusedhits, trimmedhits);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// Require that this seed be fully disjoint from existing tracks.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">//SS: replace this test with a method with appropriate name</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (!(trimmedhits.size() + unusedhits.size() == initial_unusedhits)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// Convert seed into initial KTracks on surface located at seed point,</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// and normal to seed direction.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>[3];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  std::shared_ptr&lt;Surface&gt; psurf = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9a6da3a31fdc23c0516486dc304e7c72">makeSurface</a>(seed, dir);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// Cut on the seed slope dx/ds.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">//SS: replace test name with a reasonable name</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a6fc2f1d0b6a258377aaf4a870ad569ab">testSeedSlope</a>(dir)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// Make one or two initial KTracks for forward and backward directions.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// The build_both flag specifies whether we should attempt to make</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// tracks from all both FORWARD and BACKWARD initial tracks,</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// or alternatively, whether we</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// should declare victory and quit after getting a successful</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// track from one initial track.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> build_both = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#acf48222d7b48edad5fd660db282ffa96">fDoDedx</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ninit = 2;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">auto</span> ntracks = kgtracks.size(); <span class="comment">// Remember original track count.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">bool</span> ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9f8eef8c2cc8aad5d9dc2b4a08b2a17a">makeKalmanTracks</a>(detProp, psurf, <a class="code" href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0ae28a181a03c111a1327ae23f506a2392">Surface::FORWARD</a>, trimmedhits, hits, kgtracks);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> ((!ok || build_both) &amp;&amp; ninit == 2) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9f8eef8c2cc8aad5d9dc2b4a08b2a17a">makeKalmanTracks</a>(detProp, psurf, <a class="code" href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0a9c8d3a4153e80a53b739ea4dd9734a66">Surface::BACKWARD</a>, trimmedhits, hits, kgtracks);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// Loop over newly added tracks and remove hits contained on</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// these tracks from hits available for making additional</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// tracks or track seeds.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itrk = ntracks; itrk &lt; kgtracks.size(); ++itrk) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg = kgtracks[itrk];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7887ae7fa850cf6594619f78825fc832">filterHitsOnKalmanTrack</a>(trg, hits, unusedhits);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/// method to return a seed to surface.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;std::shared_ptr&lt;trkf::Surface&gt;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9a6da3a31fdc23c0516486dc304e7c72">  263</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9a6da3a31fdc23c0516486dc304e7c72">trkf::Track3DKalmanHitAlg::makeSurface</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a>&amp; <a class="code" href="../../d5/d56/NeutronOsc__module_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a>, <span class="keywordtype">double</span>* <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a>[3]; <span class="comment">// Dummy.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  seed.<a class="code" href="../../d5/d76/classrecob_1_1Seed.html#ad0ce837273a9c2f56ca0d7011cd71fb6">GetPoint</a>(xyz, err);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  seed.<a class="code" href="../../d5/d76/classrecob_1_1Seed.html#ad5f7f7926ad4141833770a2d34a8694d">GetDirection</a>(dir, err);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (mf::isDebugEnabled()) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    mf::LogDebug(<span class="stringliteral">&quot;Track3DKalmanHit&quot;</span>)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">//&lt;&lt; &quot;Seed found with &quot; &lt;&lt; seedhits.size() &lt;&lt;&quot; hits.\n&quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;(x,y,z) = &quot;</span> &lt;&lt; xyz[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xyz[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xyz[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;(dx,dy,dz) = &quot;</span> &lt;&lt; dir[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dir[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dir[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  } <span class="comment">// if debug</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;SurfXYZPlane&gt;(xyz[0], xyz[1], xyz[2], dir[0], dir[1], dir[2]);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9f8eef8c2cc8aad5d9dc2b4a08b2a17a">  282</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9f8eef8c2cc8aad5d9dc2b4a08b2a17a">trkf::Track3DKalmanHitAlg::makeKalmanTracks</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                            <span class="keyword">const</span> std::shared_ptr&lt;trkf::Surface&gt; psurf,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0">Surface::TrackDirection</a> trkdir,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                            <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; seedhits,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                            <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                            std::deque&lt;KGTrack&gt;&amp; kgtracks)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a> = 13; <span class="comment">//SS: FIXME another constant?</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// SS: FIXME</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// It is a contant value inside a loop so I took it out</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// revisit the linear algebra stuff used here (use of ublas)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// make a lambda here ... const TrackVector</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="../../d0/da2/namespacetrkf.html#a555831e3768c272dc5eb7be07c1bf96b">TrackVector</a> vec(5);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  vec(0) = 0.;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  vec(1) = 0.;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  vec(2) = 0.;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  vec(3) = 0.;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  vec(4) = (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a14d3accbf64d22ec29aff9781329e2e2">fInitialMomentum</a> != 0. ? 1. / <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a14d3accbf64d22ec29aff9781329e2e2">fInitialMomentum</a> : 2.);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="../../da/dcf/classtrkf_1_1KTrack.html">KTrack</a> initial_track(psurf, vec, trkdir, pdg);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// Fill hit container with current seed hits.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// KHitContainer may not be cheaply movabale thats why unique_ptr</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  std::unique_ptr&lt;KHitContainer&gt; pseedcont = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a3a316dd9fb20ecf7e9c34ae428fe3697">fillHitContainer</a>(detProp, seedhits);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// Set the preferred plane to be the one with the most hits.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prefplane = pseedcont-&gt;getPreferredPlane();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a659e75ed385886b11601361421b7a3a9">setPlane</a>(prefplane);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> (mf::isDebugEnabled())</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    mf::LogDebug(<span class="stringliteral">&quot;Track3DKalmanHit&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Preferred plane = &quot;</span> &lt;&lt; prefplane &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="../../d7/d4f/classtrkf_1_1PropAny.html">PropAny</a> <span class="keyword">const</span> propagator{<a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>, <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ae6e2651bdc3e38a17e875a0acdc00920">fMaxTcut</a>, <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#acf48222d7b48edad5fd660db282ffa96">fDoDedx</a>};</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Build and smooth seed track.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a> trg0(prefplane);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">bool</span> ok =</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a5ef684650695df5d3f1bf71552576ab6">buildTrack</a>(initial_track, trg0, propagator, <a class="code" href="../../d3/d02/classtrkf_1_1Propagator.html#af689f4b8a505b7a64dcd9c7e6c824354a75a7893a288d2eadaba054cc056b2fed">Propagator::FORWARD</a>, *pseedcont, <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a2e7b106b25e2a5d85a3a83c5c5081e48">fSelfSeed</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span> (ok) ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aea1935f1899c77ae536364e06affa37f">smoothandextendTrack</a>(detProp, propagator, trg0, hits, prefplane, kgtracks);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (mf::isDebugEnabled())</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    mf::LogDebug(<span class="stringliteral">&quot;Track3DKalmanHit&quot;</span>)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      &lt;&lt; (ok ? <span class="stringliteral">&quot;Find track succeeded.&quot;</span> : <span class="stringliteral">&quot;Find track failed.&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a6fc2f1d0b6a258377aaf4a870ad569ab">  331</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a6fc2f1d0b6a258377aaf4a870ad569ab">trkf::Track3DKalmanHitAlg::testSeedSlope</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dir[0]) &gt;= <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#adc4bf23bfc3ccb9ac3ceae1d6391eb3d">fMinSeedSlope</a> * calcMagnitude(dir);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// Filter hits that are on kalman tracks.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span><span class="keywordtype">void</span></div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7887ae7fa850cf6594619f78825fc832">  339</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7887ae7fa850cf6594619f78825fc832">trkf::Track3DKalmanHitAlg::filterHitsOnKalmanTrack</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                   <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                                   <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; seederhits)<span class="keyword"> const</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> track_used_hits;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  std::vector&lt;unsigned int&gt; hittpindex;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  trg.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#ab9d0c5e3d792c88a5c9046ea049a625a">fillHits</a>(track_used_hits, hittpindex);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  filterHits(hits, track_used_hits);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  filterHits(seederhits, track_used_hits);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/// Fill hit container with either seedhits or filtered hits i.e. recob::Hit</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span>std::unique_ptr&lt;trkf::KHitContainer&gt;</div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a3a316dd9fb20ecf7e9c34ae428fe3697">  353</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a3a316dd9fb20ecf7e9c34ae428fe3697">trkf::Track3DKalmanHitAlg::fillHitContainer</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits)<span class="keyword"> const</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  std::unique_ptr&lt;KHitContainer&gt; hitcont(<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a78ebe9ab9934e0f2d7d93905d957abce">fLineSurface</a> ?</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                           static_cast&lt;KHitContainer*&gt;(<span class="keyword">new</span> <a class="code" href="../../d5/d69/classtrkf_1_1KHitContainerWireLine.html">KHitContainerWireLine</a>) :</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                           static_cast&lt;KHitContainer*&gt;(<span class="keyword">new</span> <a class="code" href="../../de/dc0/classtrkf_1_1KHitContainerWireX.html">KHitContainerWireX</a>));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  hitcont-&gt;fill(detProp, hits, -1);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">return</span> hitcont;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/// Quality cuts on seed track.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span><span class="comment">// not sure if this function will be a candidate for generic interface</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ad9e6090eac79cc0d822e2ad52cec73fb">  368</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ad9e6090eac79cc0d822e2ad52cec73fb">trkf::Track3DKalmanHitAlg::qualityCutsOnSeedTrack</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg0)<span class="keyword"> const</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">double</span> mom0[3];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">double</span> mom1[3];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  trg0.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#a772814934aff91037c4fcb28e9b15db4">startTrack</a>().<a class="code" href="../../da/dcf/classtrkf_1_1KTrack.html#aed9baa6aa5e94a5671d97abbaa8afd85">getMomentum</a>(mom0);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  trg0.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#afb899cc6f64efd1e3eb257168caade22">endTrack</a>().<a class="code" href="../../da/dcf/classtrkf_1_1KTrack.html#aed9baa6aa5e94a5671d97abbaa8afd85">getMomentum</a>(mom1);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">double</span> dxds0 = mom0[0] / calcMagnitude(mom0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">double</span> dxds1 = mom1[0] / calcMagnitude(mom1);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dxds0) &gt; <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#adc4bf23bfc3ccb9ac3ceae1d6391eb3d">fMinSeedSlope</a> &amp;&amp; <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(dxds1) &gt; <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#adc4bf23bfc3ccb9ac3ceae1d6391eb3d">fMinSeedSlope</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">/// Chop hits off of the end of seeds.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span><span class="comment">// Seems like seeds often end at delta rays, Michel electrons,</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">// or other pathologies.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">// Don&#39;t chop pfparticle seeds or self seeds.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7f7aad27d4eb12db4c1848b785462882">  389</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7f7aad27d4eb12db4c1848b785462882">trkf::Track3DKalmanHitAlg::chopHitsOffSeeds</a>(<a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> <span class="keyword">const</span>&amp; hpsit, <span class="keywordtype">bool</span> pfseed, <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; seedhits)<span class="keyword"> const</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nchopmax =</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    (pfseed || <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a2e7b106b25e2a5d85a3a83c5c5081e48">fSelfSeed</a>) ? 0 : <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(0, <span class="keywordtype">int</span>((hpsit.size() - <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a029e468bbdb8958b339d88a46af76925">fMinSeedChopHits</a>) / 2));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//SS: FIXME</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nchop = std::min(nchopmax, <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a17446800338b8c6d37c885235c01356f">fMaxChopHits</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  Hits::const_iterator itb = hpsit.begin();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  Hits::const_iterator ite = hpsit.end();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  itb += nchop;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  ite -= nchop;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  seedhits.reserve(hpsit.size());</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">for</span> (Hits::const_iterator it = itb; it != ite; ++it)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    seedhits.push_back(*it);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// SMooth and extend track</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span></div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aea1935f1899c77ae536364e06affa37f">  408</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aea1935f1899c77ae536364e06affa37f">trkf::Track3DKalmanHitAlg::smoothandextendTrack</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                                <a class="code" href="../../d3/d02/classtrkf_1_1Propagator.html">Propagator</a> <span class="keyword">const</span>&amp; propagator,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                                <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg0,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> hits,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prefplane,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                std::deque&lt;KGTrack&gt;&amp; kalman_tracks)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a> trg1(prefplane);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">bool</span> ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#ae241a8a34643e37524cdec9b8fd2f7b5">smoothTrack</a>(trg0, &amp;trg1, propagator);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Now we have the seed track in the form of a KGTrack.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// Do additional quality cuts.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = trg1.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#a64b84e88ece84a8b21d71b9c675d731c">numHits</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> chisq = <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> * <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a5a31656ab98a70d70e1cef4fc49149e7">fMaxSeedChiDF</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  ok = <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> &gt;= <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a534573e0b8e07f723c5161a52f78d4f2">fMinSeedHits</a> &amp;&amp; trg1.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#a772814934aff91037c4fcb28e9b15db4">startTrack</a>().<a class="code" href="../../d2/df5/classtrkf_1_1KFitTrack.html#a6023570c5f9e6e3cca12b984a619b6fa">getChisq</a>() &lt;= chisq &amp;&amp;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;       trg1.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#afb899cc6f64efd1e3eb257168caade22">endTrack</a>().<a class="code" href="../../d2/df5/classtrkf_1_1KFitTrack.html#a6023570c5f9e6e3cca12b984a619b6fa">getChisq</a>() &lt;= chisq &amp;&amp; trg0.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#a772814934aff91037c4fcb28e9b15db4">startTrack</a>().<a class="code" href="../../d2/df5/classtrkf_1_1KFitTrack.html#a6023570c5f9e6e3cca12b984a619b6fa">getChisq</a>() &lt;= chisq &amp;&amp;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;       trg0.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#afb899cc6f64efd1e3eb257168caade22">endTrack</a>().<a class="code" href="../../d2/df5/classtrkf_1_1KFitTrack.html#a6023570c5f9e6e3cca12b984a619b6fa">getChisq</a>() &lt;= chisq &amp;&amp; <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ad9e6090eac79cc0d822e2ad52cec73fb">qualityCutsOnSeedTrack</a>(trg0);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// Make a copy of the original hit collection of all</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// available track hits.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> trackhits = hits;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// Do an extend + smooth loop here.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// Exit after two consecutive failures to extend (i.e. from each end),</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// or if the iteration count reaches the maximum.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span> (ok) ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9cf39752fe6bc71c04cec6616b1a9c56">extendandsmoothLoop</a>(detProp, propagator, trg1, prefplane, trackhits);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// Do a final smooth.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#ae241a8a34643e37524cdec9b8fd2f7b5">smoothTrack</a>(trg1, 0, propagator);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">// Skip momentum estimate for constant-momentum tracks.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#acf48222d7b48edad5fd660db282ffa96">fDoDedx</a>) { <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#af69a96d00b9f43fe865cebd81bedd154">fitnupdateMomentum</a>(propagator, trg1, trg1); }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// Save this track.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  ++<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aa7162c8b5e386c5835513edc2ad48d93">fNumTrack</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  kalman_tracks.push_back(trg1);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">/// SMooth and extend a track in a loop</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9cf39752fe6bc71c04cec6616b1a9c56">  459</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9cf39752fe6bc71c04cec6616b1a9c56">trkf::Track3DKalmanHitAlg::extendandsmoothLoop</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                               <a class="code" href="../../d3/d02/classtrkf_1_1Propagator.html">Propagator</a> <span class="keyword">const</span>&amp; propagator,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                               <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg1,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                               <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prefplane,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                               <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; trackhits)<span class="keyword"> const</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> niter = 6;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">int</span> nfail = 0; <span class="comment">// Number of consecutive extend fails.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ok &amp;&amp; ix &lt; niter &amp;&amp; nfail &lt; 2; ++ix) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// Fill a collection of hits from the last good track</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// (initially the seed track).</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a> goodhits;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    std::vector&lt;unsigned int&gt; hittpindex;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    trg1.<a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html#ab9d0c5e3d792c88a5c9046ea049a625a">fillHits</a>(goodhits, hittpindex);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Filter hits already on the track out of the available hits.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    filterHits(trackhits, goodhits);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// Fill hit container using filtered hits.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    std::unique_ptr&lt;KHitContainer&gt; ptrackcont = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a3a316dd9fb20ecf7e9c34ae428fe3697">fillHitContainer</a>(detProp, trackhits);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Extend the track.  It is not an error for the</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// extend operation to fail, meaning that no new hits</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// were added.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a2f8e9a720427a64e88b24d109da0bfd6">extendTrack</a>(trg1, propagator, *ptrackcont))</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      nfail = 0;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      ++nfail;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// Smooth the extended track, and make a new</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// unidirectionally fit track in the opposite</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// direction.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a> trg2(prefplane);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    ok = <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#ae241a8a34643e37524cdec9b8fd2f7b5">smoothTrack</a>(trg1, &amp;trg2, propagator);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (ok) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">// Skip momentum estimate for constant-momentum tracks.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#acf48222d7b48edad5fd660db282ffa96">fDoDedx</a>) { <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#af69a96d00b9f43fe865cebd81bedd154">fitnupdateMomentum</a>(propagator, trg1, trg2); }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      trg1 = trg2;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">/// fit and update method, used twice.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span><span class="keywordtype">void</span></div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#af69a96d00b9f43fe865cebd81bedd154">  508</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#af69a96d00b9f43fe865cebd81bedd154">trkf::Track3DKalmanHitAlg::fitnupdateMomentum</a>(<a class="code" href="../../d3/d02/classtrkf_1_1Propagator.html">Propagator</a> <span class="keyword">const</span>&amp; propagator,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                              <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg1,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                              <a class="code" href="../../d6/d5c/classtrkf_1_1KGTrack.html">KGTrack</a>&amp; trg2)<span class="keyword"> const</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="../../df/db0/classtrkf_1_1KETrack.html">KETrack</a> tremom;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a4f95ca6dd70252aa52effbcf378e7288">fitMomentum</a>(trg1, propagator, tremom)) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">fKFAlg</a>.<a class="code" href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a2a5a5f4ed347ca0dad0faefae9adec93">updateMomentum</a>(tremom, propagator, trg2);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">//----------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/// Make seed method.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span><a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a></div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a4493e9c336dc480e2ef4378523d36bc3">  521</a></span>&#160;<a class="code" href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a4493e9c336dc480e2ef4378523d36bc3">trkf::Track3DKalmanHitAlg::makeSeed</a>(<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a>,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">Hits</a>&amp; hits)<span class="keyword"> const</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  art::ServiceHandle&lt;geo::Geometry const&gt; geom;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Do a linear 3D least squares for of y and z vs. x.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// y = y0 + ay*(x-x0)</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// z = z0 + az*(x-x0)</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">// Here x0 is the global average x coordinate of all hits in all planes.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// Parameters y0, z0, ay, and az are determined by a simultaneous least squares</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// fit in all planes.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// First, determine x0 by looping over every hit.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordtype">double</span> x0 = 0.;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; phit : hits) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = *phit;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> wire_id = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">double</span> time = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(time, wire_id);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    x0 += <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// If there are no hits, return invalid seed.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">if</span> (n == 0) <span class="keywordflow">return</span> <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a>();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// Find the average x.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  x0 /= <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Now do the least squares fit proper.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <a class="code" href="../../d0/d9b/structtrkf_1_1KSymMatrix.html#a7a9c12cce1bdc8e6765fdcc10903b876">KSymMatrix&lt;4&gt;::type</a> sm(4);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="../../d1/d04/structtrkf_1_1KVector.html#a7627145cc5c55f039ee604f69bdfb235">KVector&lt;4&gt;::type</a> sv(4);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  sm.clear();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  sv.clear();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// Loop over hits (again).</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; phit : hits) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a>&amp; <a class="code" href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a> = *phit;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// Extract the angle, w and x coordinates from hit.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a> wire_id = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">WireID</a>();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a>&amp; wgeom = geom-&gt;Wire(wire_id);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">double</span> xyz[3];</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">GetCenter</a>(xyz);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// Phi convention is the one documented in SurfYZPlane.h.</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">double</span> phi = TMath::PiOver2() - wgeom.<a class="code" href="../../de/dce/classgeo_1_1WireGeo.html#a0607dce1b981e52fc158ad5cbfd343d0">ThetaZ</a>();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">double</span> sphi = std::sin(phi);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">double</span> cphi = std::cos(phi);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a> = -xyz[1] * sphi + xyz[2] * cphi;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">double</span> time = hit.<a class="code" href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">PeakTime</a>();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = detProp.<a class="code" href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">ConvertTicksToX</a>(time, wire_id);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// Accumulate data for least squares fit.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">double</span> dx = x - x0;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    sm(0, 0) += sphi * sphi;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    sm(1, 0) -= sphi * cphi;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    sm(1, 1) += cphi * cphi;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    sm(2, 0) += sphi * sphi * dx;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    sm(2, 1) -= sphi * cphi * dx;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    sm(2, 2) += sphi * sphi * dx * dx;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    sm(3, 0) -= sphi * cphi * dx;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    sm(3, 1) += cphi * cphi * dx;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    sm(3, 2) -= sphi * cphi * dx * dx;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    sm(3, 3) += cphi * cphi * dx * dx;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    sv(0) -= sphi * <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    sv(1) += cphi * <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">w</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    sv(2) -= sphi * w * dx;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    sv(3) += cphi * w * dx;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// Solve.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">bool</span> ok = <a class="code" href="../../d0/da2/namespacetrkf.html#a7045ebd9562cc068f603055fb46450cf">syminvert</a>(sm);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="../../d1/d04/structtrkf_1_1KVector.html#a7627145cc5c55f039ee604f69bdfb235">KVector&lt;4&gt;::type</a> par(4);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  par = prod(sm, sv);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">double</span> y0 = par(0);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordtype">double</span> z0 = par(1);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordtype">double</span> dydx = par(2);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordtype">double</span> dzdx = par(3);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// Make seed.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">double</span> dsdx = std::hypot(1., std::hypot(dydx, dzdx));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordtype">double</span> pos[3] = {x0, y0, z0};</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>[3] = {1. / dsdx, dydx / dsdx, dzdx / dsdx};</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">double</span> poserr[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordtype">double</span> direrr[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a> result(pos, dir, poserr, direrr);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
<div class="ttc" id="structtrkf_1_1KSymMatrix_html_a7a9c12cce1bdc8e6765fdcc10903b876"><div class="ttname"><a href="../../d0/d9b/structtrkf_1_1KSymMatrix.html#a7a9c12cce1bdc8e6765fdcc10903b876">trkf::KSymMatrix::type</a></div><div class="ttdeci">ublas::symmetric_matrix&lt; double, ublas::lower, ublas::row_major, ublas::bounded_array&lt; double, N *(N+1)/2 &gt; &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/KalmanLinearAlgebra_8h_source.html#l00065">KalmanLinearAlgebra.h:65</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html">geo::WireGeo</a></div><div class="ttdoc">Geometry description of a TPC wireThe wire is a single straight segment on a wire plane...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00065">WireGeo.h:65</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_ab848ede08844c413cee0792876c7a597"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab848ede08844c413cee0792876c7a597">trkf::Track3DKalmanHitAlg::growSeedIntoTracks</a></div><div class="ttdeci">void growSeedIntoTracks(detinfo::DetectorPropertiesData const &amp;detProp, const bool pfseed, const recob::Seed &amp;seed, const Hits &amp;hpsit, Hits &amp;unusedhits, Hits &amp;hits, std::deque&lt; KGTrack &gt; &amp;kgtracks)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00203">Track3DKalmanHitAlg.cxx:203</a></div></div>
<div class="ttc" id="classtrkf_1_1Surface_html_a0eb375ab07c8df6ad82b6a0b6df80ba0"><div class="ttname"><a href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0">trkf::Surface::TrackDirection</a></div><div class="ttdeci">TrackDirection</div><div class="ttdoc">Track direction enum. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/lardata_2lardata_2RecoObjects_2Surface_8h_source.html#l00056">lardata/lardata/RecoObjects/Surface.h:56</a></div></div>
<div class="ttc" id="KHitTrack_8h_html"><div class="ttname"><a href="../../d8/d9d/KHitTrack_8h.html">KHitTrack.h</a></div><div class="ttdoc">Basic Kalman filter track class, plus one measurement on same surface. </div></div>
<div class="ttc" id="ServiceUtil_8h_html"><div class="ttname"><a href="../../d4/d2e/ServiceUtil_8h.html">ServiceUtil.h</a></div><div class="ttdoc">Utilities related to art service access. </div></div>
<div class="ttc" id="selectors_8fcl_html_a697017f6ca07cbb4f47653babf318012"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a697017f6ca07cbb4f47653babf318012">pdg</a></div><div class="ttdeci">var pdg</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00014">selectors.fcl:14</a></div></div>
<div class="ttc" id="classtrkf_1_1KGTrack_html_ab9d0c5e3d792c88a5c9046ea049a625a"><div class="ttname"><a href="../../d6/d5c/classtrkf_1_1KGTrack.html#ab9d0c5e3d792c88a5c9046ea049a625a">trkf::KGTrack::fillHits</a></div><div class="ttdeci">void fillHits(art::PtrVector&lt; recob::Hit &gt; &amp;hits, std::vector&lt; unsigned int &gt; &amp;hittpindex) const </div><div class="ttdoc">Fill a PtrVector of Hits. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da8/KGTrack_8cxx_source.html#l00224">KGTrack.cxx:224</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a5204d4188eee282d2235cd231d828bd2"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a></div><div class="ttdeci">ClusterModuleLabel join with tracks</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00056">trackfinderalgorithms.fcl:56</a></div></div>
<div class="ttc" id="SurfXYZPlane_8h_html"><div class="ttname"><a href="../../dc/def/SurfXYZPlane_8h.html">SurfXYZPlane.h</a></div><div class="ttdoc">General planar surface. </div></div>
<div class="ttc" id="KHitContainerWireLine_8h_html"><div class="ttname"><a href="../../d3/d4b/KHitContainerWireLine_8h.html">KHitContainerWireLine.h</a></div><div class="ttdoc">A KHitContainer for KHitWireLine type measurements. </div></div>
<div class="ttc" id="KHitContainerWireX_8h_html"><div class="ttname"><a href="../../df/df6/KHitContainerWireX_8h.html">KHitContainerWireX.h</a></div><div class="ttdoc">A KHitContainer for KHitWireX type measurements. </div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classtrkf_1_1KGTrack_html_afb899cc6f64efd1e3eb257168caade22"><div class="ttname"><a href="../../d6/d5c/classtrkf_1_1KGTrack.html#afb899cc6f64efd1e3eb257168caade22">trkf::KGTrack::endTrack</a></div><div class="ttdeci">const KHitTrack &amp; endTrack() const </div><div class="ttdoc">Track at end point. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da8/KGTrack_8cxx_source.html#l00042">KGTrack.cxx:42</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a534573e0b8e07f723c5161a52f78d4f2"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a534573e0b8e07f723c5161a52f78d4f2">trkf::Track3DKalmanHitAlg::fMinSeedHits</a></div><div class="ttdeci">size_t fMinSeedHits</div><div class="ttdoc">Minimum number of hits per track seed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00115">Track3DKalmanHitAlg.h:115</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_af481fa22253619167bce75a37e10ec34"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#af481fa22253619167bce75a37e10ec34">channelDBConverter.first</a></div><div class="ttdeci">first</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00146">channelDBConverter.py:146</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_ac490abcf98854d93cf2fa85eadf4d469"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#ac490abcf98854d93cf2fa85eadf4d469">recob::Hit::WireID</a></div><div class="ttdeci">geo::WireID WireID() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00233">Hit.h:233</a></div></div>
<div class="ttc" id="classrecob_1_1Seed_html"><div class="ttname"><a href="../../d5/d76/classrecob_1_1Seed.html">recob::Seed</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d34/Seed_8h_source.html#l00020">Seed.h:20</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a7887ae7fa850cf6594619f78825fc832"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7887ae7fa850cf6594619f78825fc832">trkf::Track3DKalmanHitAlg::filterHitsOnKalmanTrack</a></div><div class="ttdeci">void filterHitsOnKalmanTrack(const KGTrack &amp;trg, Hits &amp;hits, Hits &amp;seederhits) const </div><div class="ttdoc">Filter hits that are on kalman tracks. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00339">Track3DKalmanHitAlg.cxx:339</a></div></div>
<div class="ttc" id="namespaceevd_html_a911fe581afad27a720ee200bd61362a6"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">evd::err</a></div><div class="ttdeci">EResult err(const char *call)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2a/WebEVDServer_8cxx_source.html#l00138">WebEVDServer.cxx:138</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html">detinfo::DetectorPropertiesData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/DetectorPropertiesData_8h_source.html#l00011">DetectorPropertiesData.h:11</a></div></div>
<div class="ttc" id="classrecob_1_1Seed_html_ad0ce837273a9c2f56ca0d7011cd71fb6"><div class="ttname"><a href="../../d5/d76/classrecob_1_1Seed.html#ad0ce837273a9c2f56ca0d7011cd71fb6">recob::Seed::GetPoint</a></div><div class="ttdeci">void GetPoint(double *Pt, double *Err) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d58/Seed_8cxx_source.html#l00108">Seed.cxx:108</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a9aa8e7b824081bd95d6e6750848b1fbc"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9aa8e7b824081bd95d6e6750848b1fbc">trkf::Track3DKalmanHitAlg::makeTracks</a></div><div class="ttdeci">std::vector&lt; trkf::KalmanOutput &gt; makeTracks(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, KalmanInputs &amp;kalman_inputs)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00105">Track3DKalmanHitAlg.cxx:105</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_acf48222d7b48edad5fd660db282ffa96"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#acf48222d7b48edad5fd660db282ffa96">trkf::Track3DKalmanHitAlg::fDoDedx</a></div><div class="ttdeci">bool fDoDedx</div><div class="ttdoc">Global dE/dx enable flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00111">Track3DKalmanHitAlg.h:111</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="DetectorProperties_8h_html"><div class="ttname"><a href="../../d5/dbc/DetectorProperties_8h.html">DetectorProperties.h</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a5a31656ab98a70d70e1cef4fc49149e7"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a5a31656ab98a70d70e1cef4fc49149e7">trkf::Track3DKalmanHitAlg::fMaxSeedChiDF</a></div><div class="ttdeci">double fMaxSeedChiDF</div><div class="ttdoc">Maximum seed track chisquare/dof. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00118">Track3DKalmanHitAlg.h:118</a></div></div>
<div class="ttc" id="structgeo_1_1WireID_html"><div class="ttname"><a href="../../de/db1/structgeo_1_1WireID.html">geo::WireID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00560">geo_types.h:560</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a496e6f2a554e7d40613e812720f3c050"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a496e6f2a554e7d40613e812720f3c050">trkf::Track3DKalmanHitAlg::Track3DKalmanHitAlg</a></div><div class="ttdeci">Track3DKalmanHitAlg(const fhicl::ParameterSet &amp;pset)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00084">Track3DKalmanHitAlg.cxx:84</a></div></div>
<div class="ttc" id="cheaterreco_8fcl_html_abf2e819dbf4c327e098bebd4b2dc0597"><div class="ttname"><a href="../../d2/d36/cheaterreco_8fcl.html#abf2e819dbf4c327e098bebd4b2dc0597">hit</a></div><div class="ttdeci">process_name hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/cheaterreco_8fcl_source.html#l00051">cheaterreco.fcl:51</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a029e468bbdb8958b339d88a46af76925"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a029e468bbdb8958b339d88a46af76925">trkf::Track3DKalmanHitAlg::fMinSeedChopHits</a></div><div class="ttdeci">int fMinSeedChopHits</div><div class="ttdoc">Potentially chop seeds that exceed this length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00116">Track3DKalmanHitAlg.h:116</a></div></div>
<div class="ttc" id="Track3DKalmanHitAlg_8h_html"><div class="ttname"><a href="../../d4/dd3/Track3DKalmanHitAlg_8h.html">Track3DKalmanHitAlg.h</a></div><div class="ttdoc">Track3DKalmanHit Algorithm. </div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a0607dce1b981e52fc158ad5cbfd343d0"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a0607dce1b981e52fc158ad5cbfd343d0">geo::WireGeo::ThetaZ</a></div><div class="ttdeci">double ThetaZ() const </div><div class="ttdoc">Returns angle of wire with respect to z axis in the Y-Z plane in radians. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/de5/WireGeo_8h_source.html#l00250">WireGeo.h:250</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a7f7aad27d4eb12db4c1848b785462882"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a7f7aad27d4eb12db4c1848b785462882">trkf::Track3DKalmanHitAlg::chopHitsOffSeeds</a></div><div class="ttdeci">void chopHitsOffSeeds(Hits const &amp;hpsit, bool pfseed, Hits &amp;seedhits) const </div><div class="ttdoc">Chop hits off of the end of seeds. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00389">Track3DKalmanHitAlg.cxx:389</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a14d3accbf64d22ec29aff9781329e2e2"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a14d3accbf64d22ec29aff9781329e2e2">trkf::Track3DKalmanHitAlg::fInitialMomentum</a></div><div class="ttdeci">double fInitialMomentum</div><div class="ttdoc">Initial (or constant) momentum. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00120">Track3DKalmanHitAlg.h:120</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a4493e9c336dc480e2ef4378523d36bc3"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a4493e9c336dc480e2ef4378523d36bc3">trkf::Track3DKalmanHitAlg::makeSeed</a></div><div class="ttdeci">recob::Seed makeSeed(detinfo::DetectorPropertiesData const &amp;detProp, const Hits &amp;hits) const </div><div class="ttdoc">Make seed method. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00521">Track3DKalmanHitAlg.cxx:521</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a9f8eef8c2cc8aad5d9dc2b4a08b2a17a"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9f8eef8c2cc8aad5d9dc2b4a08b2a17a">trkf::Track3DKalmanHitAlg::makeKalmanTracks</a></div><div class="ttdeci">bool makeKalmanTracks(detinfo::DetectorPropertiesData const &amp;detProp, const std::shared_ptr&lt; trkf::Surface &gt; psurf, const Surface::TrackDirection trkdir, Hits &amp;seedhits, Hits &amp;hits, std::deque&lt; KGTrack &gt; &amp;kalman_tracks)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00282">Track3DKalmanHitAlg.cxx:282</a></div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_a5ef684650695df5d3f1bf71552576ab6"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a5ef684650695df5d3f1bf71552576ab6">trkf::KalmanFilterAlg::buildTrack</a></div><div class="ttdeci">bool buildTrack(const KTrack &amp;trk, KGTrack &amp;trg, const Propagator &amp;prop, const Propagator::PropDirection dir, KHitContainer &amp;hits, bool linear) const </div><div class="ttdoc">Make a new track. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dab/KalmanFilterAlg_8cxx_source.html#l00308">KalmanFilterAlg.cxx:308</a></div></div>
<div class="ttc" id="DetectorPropertiesData_8h_html"><div class="ttname"><a href="../../d5/d7a/DetectorPropertiesData_8h.html">DetectorPropertiesData.h</a></div></div>
<div class="ttc" id="classtrkf_1_1Surface_html_a0eb375ab07c8df6ad82b6a0b6df80ba0a9c8d3a4153e80a53b739ea4dd9734a66"><div class="ttname"><a href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0a9c8d3a4153e80a53b739ea4dd9734a66">trkf::Surface::BACKWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/lardata_2lardata_2RecoObjects_2Surface_8h_source.html#l00056">lardata/lardata/RecoObjects/Surface.h:56</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a0921bcf5caff483f7e25b6b9d70cc90f"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a0921bcf5caff483f7e25b6b9d70cc90f">trkf::Track3DKalmanHitAlg::growSeedsIntoTracks</a></div><div class="ttdeci">void growSeedsIntoTracks(detinfo::DetectorPropertiesData const &amp;detProp, const bool pfseed, const std::vector&lt; recob::Seed &gt; &amp;seeds, const std::vector&lt; Hits &gt; &amp;hitsperseed, Hits &amp;unusedhits, Hits &amp;hits, std::deque&lt; KGTrack &gt; &amp;kalman_tracks)</div><div class="ttdoc">Grow Seeds method. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00183">Track3DKalmanHitAlg.cxx:183</a></div></div>
<div class="ttc" id="structtrkf_1_1KVector_html_a7627145cc5c55f039ee604f69bdfb235"><div class="ttname"><a href="../../d1/d04/structtrkf_1_1KVector.html#a7627145cc5c55f039ee604f69bdfb235">trkf::KVector::type</a></div><div class="ttdeci">ublas::vector&lt; double, ublas::bounded_array&lt; double, N &gt; &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/KalmanLinearAlgebra_8h_source.html#l00058">KalmanLinearAlgebra.h:58</a></div></div>
<div class="ttc" id="namespacetrkf_html_a7045ebd9562cc068f603055fb46450cf"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a7045ebd9562cc068f603055fb46450cf">trkf::syminvert</a></div><div class="ttdeci">bool syminvert(ublas::symmetric_matrix&lt; T, TRI, L, A &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/KalmanLinearAlgebra_8h_source.html#l00109">KalmanLinearAlgebra.h:109</a></div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_a2f8e9a720427a64e88b24d109da0bfd6"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a2f8e9a720427a64e88b24d109da0bfd6">trkf::KalmanFilterAlg::extendTrack</a></div><div class="ttdeci">bool extendTrack(KGTrack &amp;trg, const Propagator &amp;prop, KHitContainer &amp;hits) const </div><div class="ttdoc">Add hits to existing track. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dab/KalmanFilterAlg_8cxx_source.html#l01156">KalmanFilterAlg.cxx:1156</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a3a316dd9fb20ecf7e9c34ae428fe3697"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a3a316dd9fb20ecf7e9c34ae428fe3697">trkf::Track3DKalmanHitAlg::fillHitContainer</a></div><div class="ttdeci">std::unique_ptr&lt; KHitContainer &gt; fillHitContainer(detinfo::DetectorPropertiesData const &amp;detProp, const Hits &amp;hits) const </div><div class="ttdoc">Fill hit container with either seedhits or filtered hits i.e. recob::Hit. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00353">Track3DKalmanHitAlg.cxx:353</a></div></div>
<div class="ttc" id="classtrkf_1_1PropAny_html"><div class="ttname"><a href="../../d7/d4f/classtrkf_1_1PropAny.html">trkf::PropAny</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/da5/PropAny_8h_source.html#l00025">PropAny.h:25</a></div></div>
<div class="ttc" id="NeutronOsc__module_8cc_html_ae21f357c223957d36046a0d71cc6aed7"><div class="ttname"><a href="../../d5/d56/NeutronOsc__module_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a></div><div class="ttdeci">unsigned int seed</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d56/NeutronOsc__module_8cc_source.html#l00128">NeutronOsc_module.cc:128</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a216d57e2482b728ae71772b8db62f179"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a216d57e2482b728ae71772b8db62f179">trkf::Track3DKalmanHitAlg::fetchPFParticleSeeds</a></div><div class="ttdeci">void fetchPFParticleSeeds(const art::PtrVector&lt; recob::Seed &gt; &amp;pfseeds, const std::vector&lt; Hits &gt; &amp;pfseedhits, std::vector&lt; recob::Seed &gt; &amp;seeds, std::vector&lt; Hits &gt; &amp;hitsperseed) const </div><div class="ttdoc">Fetch Seeds method. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00168">Track3DKalmanHitAlg.cxx:168</a></div></div>
<div class="ttc" id="classtrkf_1_1Propagator_html_af689f4b8a505b7a64dcd9c7e6c824354a75a7893a288d2eadaba054cc056b2fed"><div class="ttname"><a href="../../d3/d02/classtrkf_1_1Propagator.html#af689f4b8a505b7a64dcd9c7e6c824354a75a7893a288d2eadaba054cc056b2fed">trkf::Propagator::FORWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df9/Propagator_8h_source.html#l00094">Propagator.h:94</a></div></div>
<div class="ttc" id="classtrkf_1_1KETrack_html"><div class="ttname"><a href="../../df/db0/classtrkf_1_1KETrack.html">trkf::KETrack</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d0f/KETrack_8h_source.html#l00029">KETrack.h:29</a></div></div>
<div class="ttc" id="namespacetrkf_html_a555831e3768c272dc5eb7be07c1bf96b"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a555831e3768c272dc5eb7be07c1bf96b">trkf::TrackVector</a></div><div class="ttdeci">KVector&lt; 5 &gt;::type TrackVector</div><div class="ttdoc">Track state vector, dimension 5. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/KalmanLinearAlgebra_8h_source.html#l00090">KalmanLinearAlgebra.h:90</a></div></div>
<div class="ttc" id="classtrkf_1_1KHitContainerWireLine_html"><div class="ttname"><a href="../../d5/d69/classtrkf_1_1KHitContainerWireLine.html">trkf::KHitContainerWireLine</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d4b/KHitContainerWireLine_8h_source.html#l00025">KHitContainerWireLine.h:25</a></div></div>
<div class="ttc" id="classtrkf_1_1Surface_html_a0eb375ab07c8df6ad82b6a0b6df80ba0ae28a181a03c111a1327ae23f506a2392"><div class="ttname"><a href="../../d5/d75/classtrkf_1_1Surface.html#a0eb375ab07c8df6ad82b6a0b6df80ba0ae28a181a03c111a1327ae23f506a2392">trkf::Surface::FORWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/lardata_2lardata_2RecoObjects_2Surface_8h_source.html#l00056">lardata/lardata/RecoObjects/Surface.h:56</a></div></div>
<div class="ttc" id="geo__types_8h_html"><div class="ttname"><a href="../../d8/d48/geo__types_8h.html">geo_types.h</a></div><div class="ttdoc">Definition of data types for geometry description. </div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_ae241a8a34643e37524cdec9b8fd2f7b5"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#ae241a8a34643e37524cdec9b8fd2f7b5">trkf::KalmanFilterAlg::smoothTrack</a></div><div class="ttdeci">bool smoothTrack(KGTrack &amp;trg, KGTrack *trg1, const Propagator &amp;prop) const </div><div class="ttdoc">Smooth track. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dab/KalmanFilterAlg_8cxx_source.html#l00848">KalmanFilterAlg.cxx:848</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_aaeb1b37867ebfa19b2c8027c82f455e0"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aaeb1b37867ebfa19b2c8027c82f455e0">trkf::Track3DKalmanHitAlg::fKFAlg</a></div><div class="ttdeci">KalmanFilterAlg fKFAlg</div><div class="ttdoc">Kalman filter algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00124">Track3DKalmanHitAlg.h:124</a></div></div>
<div class="ttc" id="KalmanLinearAlgebra_8h_html"><div class="ttname"><a href="../../d0/d7d/KalmanLinearAlgebra_8h.html">KalmanLinearAlgebra.h</a></div><div class="ttdoc">Kalman filter linear algebra typedefs. </div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_aea1935f1899c77ae536364e06affa37f"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aea1935f1899c77ae536364e06affa37f">trkf::Track3DKalmanHitAlg::smoothandextendTrack</a></div><div class="ttdeci">bool smoothandextendTrack(detinfo::DetectorPropertiesData const &amp;detProp, Propagator const &amp;propagator, KGTrack &amp;trg0, const Hits hits, unsigned int prefplane, std::deque&lt; KGTrack &gt; &amp;kalman_tracks)</div><div class="ttdoc">SMooth and extend track. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00408">Track3DKalmanHitAlg.cxx:408</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a8cdc67339147aad209b4122a38d7e246"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a8cdc67339147aad209b4122a38d7e246">gen_crt_frags.w</a></div><div class="ttdeci">tuple w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01416">gen_crt_frags.py:1416</a></div></div>
<div class="ttc" id="classtrkf_1_1KHitContainerWireX_html"><div class="ttname"><a href="../../de/dc0/classtrkf_1_1KHitContainerWireX.html">trkf::KHitContainerWireX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/df6/KHitContainerWireX_8h_source.html#l00025">KHitContainerWireX.h:25</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classtrkf_1_1SeedFinderAlgorithm_html_aeb0ee2bf723febea42e21a4af56ceec1"><div class="ttname"><a href="../../d5/d24/classtrkf_1_1SeedFinderAlgorithm.html#aeb0ee2bf723febea42e21a4af56ceec1">trkf::SeedFinderAlgorithm::GetSeedsFromUnSortedHits</a></div><div class="ttdeci">std::vector&lt; recob::Seed &gt; GetSeedsFromUnSortedHits(detinfo::DetectorClocksData const &amp;clockData, detinfo::DetectorPropertiesData const &amp;detProp, art::PtrVector&lt; recob::Hit &gt; const &amp;, std::vector&lt; art::PtrVector&lt; recob::Hit &gt;&gt; &amp;, unsigned int StopAfter=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/SeedFinderAlgorithm_8cxx_source.html#l00975">SeedFinderAlgorithm.cxx:975</a></div></div>
<div class="ttc" id="WireGeo_8h_html"><div class="ttname"><a href="../../da/de5/WireGeo_8h.html">WireGeo.h</a></div><div class="ttdoc">Encapsulate the geometry of a wire. </div></div>
<div class="ttc" id="classdetinfo_1_1DetectorPropertiesData_html_a8e4b4b8d755ffded5a9f956ae7c9c1ec"><div class="ttname"><a href="../../d1/d11/classdetinfo_1_1DetectorPropertiesData.html#a8e4b4b8d755ffded5a9f956ae7c9c1ec">detinfo::DetectorPropertiesData::ConvertTicksToX</a></div><div class="ttdeci">double ConvertTicksToX(double ticks, int p, int t, int c) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d64/DetectorPropertiesData_8cc_source.html#l00115">DetectorPropertiesData.cc:115</a></div></div>
<div class="ttc" id="classtrkf_1_1KGTrack_html"><div class="ttname"><a href="../../d6/d5c/classtrkf_1_1KGTrack.html">trkf::KGTrack</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd5/KGTrack_8h_source.html#l00047">KGTrack.h:47</a></div></div>
<div class="ttc" id="namespacetca_html_ae43e3da1b2fe6dca15e19b1c78031e36"><div class="ttname"><a href="../../de/d0f/namespacetca.html#ae43e3da1b2fe6dca15e19b1c78031e36">tca::seeds</a></div><div class="ttdeci">std::vector&lt; TrajPoint &gt; seeds</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00013">DataStructs.cxx:13</a></div></div>
<div class="ttc" id="namespacetrkf_html_a47064731a234d3269641abf56cc75b08"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a47064731a234d3269641abf56cc75b08">trkf::Hits</a></div><div class="ttdeci">art::PtrVector&lt; recob::Hit &gt; Hits</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d39/Track3DKalmanHit_8h_source.html#l00042">Track3DKalmanHit.h:42</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_af69a96d00b9f43fe865cebd81bedd154"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#af69a96d00b9f43fe865cebd81bedd154">trkf::Track3DKalmanHitAlg::fitnupdateMomentum</a></div><div class="ttdeci">void fitnupdateMomentum(Propagator const &amp;propagator, KGTrack &amp;trg1, KGTrack &amp;trg2) const </div><div class="ttdoc">fit and update method, used twice. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00508">Track3DKalmanHitAlg.cxx:508</a></div></div>
<div class="ttc" id="classrecob_1_1Hit_html_a46ddaf21b6eec49d205220f7daf3a85c"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html#a46ddaf21b6eec49d205220f7daf3a85c">recob::Hit::PeakTime</a></div><div class="ttdeci">float PeakTime() const </div><div class="ttdoc">Time of the signal peak, in tick units. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00218">Hit.h:218</a></div></div>
<div class="ttc" id="classtrkf_1_1KTrack_html"><div class="ttname"><a href="../../da/dcf/classtrkf_1_1KTrack.html">trkf::KTrack</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d96/KTrack_8h_source.html#l00032">KTrack.h:32</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_aa7162c8b5e386c5835513edc2ad48d93"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#aa7162c8b5e386c5835513edc2ad48d93">trkf::Track3DKalmanHitAlg::fNumTrack</a></div><div class="ttdeci">int fNumTrack</div><div class="ttdoc">Number of tracks produced. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00128">Track3DKalmanHitAlg.h:128</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a6fc2f1d0b6a258377aaf4a870ad569ab"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a6fc2f1d0b6a258377aaf4a870ad569ab">trkf::Track3DKalmanHitAlg::testSeedSlope</a></div><div class="ttdeci">bool testSeedSlope(const double *dir) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00331">Track3DKalmanHitAlg.cxx:331</a></div></div>
<div class="ttc" id="classtrkf_1_1KTrack_html_aed9baa6aa5e94a5671d97abbaa8afd85"><div class="ttname"><a href="../../da/dcf/classtrkf_1_1KTrack.html#aed9baa6aa5e94a5671d97abbaa8afd85">trkf::KTrack::getMomentum</a></div><div class="ttdeci">void getMomentum(double mom[3]) const </div><div class="ttdoc">Get momentum vector of track. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbe/KTrack_8cxx_source.html#l00218">KTrack.cxx:218</a></div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_a659e75ed385886b11601361421b7a3a9"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a659e75ed385886b11601361421b7a3a9">trkf::KalmanFilterAlg::setPlane</a></div><div class="ttdeci">void setPlane(int plane)</div><div class="ttdoc">Set preferred view plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d35/KalmanFilterAlg_8h_source.html#l00093">KalmanFilterAlg.h:93</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a78ebe9ab9934e0f2d7d93905d957abce"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a78ebe9ab9934e0f2d7d93905d957abce">trkf::Track3DKalmanHitAlg::fLineSurface</a></div><div class="ttdeci">bool fLineSurface</div><div class="ttdoc">Line surface flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00114">Track3DKalmanHitAlg.h:114</a></div></div>
<div class="ttc" id="classtrkf_1_1KGTrack_html_a64b84e88ece84a8b21d71b9c675d731c"><div class="ttname"><a href="../../d6/d5c/classtrkf_1_1KGTrack.html#a64b84e88ece84a8b21d71b9c675d731c">trkf::KGTrack::numHits</a></div><div class="ttdeci">size_t numHits() const </div><div class="ttdoc">Number of measurements in track. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd5/KGTrack_8h_source.html#l00066">KGTrack.h:66</a></div></div>
<div class="ttc" id="classtrkf_1_1Propagator_html"><div class="ttname"><a href="../../d3/d02/classtrkf_1_1Propagator.html">trkf::Propagator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df9/Propagator_8h_source.html#l00091">Propagator.h:91</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_ab0127c7e092991ed8186ec420b4a6af6"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ab0127c7e092991ed8186ec420b4a6af6">trkf::Track3DKalmanHitAlg::fSeedFinderAlg</a></div><div class="ttdeci">SeedFinderAlgorithm fSeedFinderAlg</div><div class="ttdoc">Seed finder. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00125">Track3DKalmanHitAlg.h:125</a></div></div>
<div class="ttc" id="KETrack_8h_html"><div class="ttname"><a href="../../dc/d0f/KETrack_8h.html">KETrack.h</a></div><div class="ttdoc">Basic Kalman filter track class, with error. </div></div>
<div class="ttc" id="classrecob_1_1Hit_html"><div class="ttname"><a href="../../db/d4e/classrecob_1_1Hit.html">recob::Hit</a></div><div class="ttdoc">2D representation of charge deposited in the TDC/wire plane </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/Hit_8h_source.html#l00048">Hit.h:48</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_ad9e6090eac79cc0d822e2ad52cec73fb"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ad9e6090eac79cc0d822e2ad52cec73fb">trkf::Track3DKalmanHitAlg::qualityCutsOnSeedTrack</a></div><div class="ttdeci">bool qualityCutsOnSeedTrack(const KGTrack &amp;trg0) const </div><div class="ttdoc">Quality cuts on seed track. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00368">Track3DKalmanHitAlg.cxx:368</a></div></div>
<div class="ttc" id="classgeo_1_1WireGeo_html_a967f3f96296bf6953f8405ac4e5e7427"><div class="ttname"><a href="../../de/dce/classgeo_1_1WireGeo.html#a967f3f96296bf6953f8405ac4e5e7427">geo::WireGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdoc">Fills the world coordinate of a point on the wire. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d05/WireGeo_8cxx_source.html#l00073">WireGeo.cxx:73</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a17446800338b8c6d37c885235c01356f"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a17446800338b8c6d37c885235c01356f">trkf::Track3DKalmanHitAlg::fMaxChopHits</a></div><div class="ttdeci">int fMaxChopHits</div><div class="ttdoc">Maximum number of hits to chop from each end of seed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00117">Track3DKalmanHitAlg.h:117</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_a74da18d4f0023feee71c1352a99b3910"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#a74da18d4f0023feee71c1352a99b3910">icarus::ns::util::empty</a></div><div class="ttdeci">bool empty(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00555">FixedBins.h:555</a></div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_a4f95ca6dd70252aa52effbcf378e7288"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a4f95ca6dd70252aa52effbcf378e7288">trkf::KalmanFilterAlg::fitMomentum</a></div><div class="ttdeci">bool fitMomentum(const KGTrack &amp;trg, const Propagator &amp;prop, KETrack &amp;tremom) const </div><div class="ttdoc">Estimate track momentum using either range or multiple scattering. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dab/KalmanFilterAlg_8cxx_source.html#l01858">KalmanFilterAlg.cxx:1858</a></div></div>
<div class="ttc" id="classtrkf_1_1KalmanFilterAlg_html_a2a5a5f4ed347ca0dad0faefae9adec93"><div class="ttname"><a href="../../d7/dd7/classtrkf_1_1KalmanFilterAlg.html#a2a5a5f4ed347ca0dad0faefae9adec93">trkf::KalmanFilterAlg::updateMomentum</a></div><div class="ttdeci">bool updateMomentum(const KETrack &amp;tremom, const Propagator &amp;prop, KGTrack &amp;trg) const </div><div class="ttdoc">Set track momentum at each track surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dab/KalmanFilterAlg_8cxx_source.html#l01940">KalmanFilterAlg.cxx:1940</a></div></div>
<div class="ttc" id="namespacetrkf_html_a68df189a006469d8e524dc5f499b53af"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a68df189a006469d8e524dc5f499b53af">trkf::KalmanInputs</a></div><div class="ttdeci">std::vector&lt; KalmanInput &gt; KalmanInputs</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d39/Track3DKalmanHit_8h_source.html#l00041">Track3DKalmanHit.h:41</a></div></div>
<div class="ttc" id="KTrack_8h_html"><div class="ttname"><a href="../../df/d96/KTrack_8h.html">KTrack.h</a></div><div class="ttdoc">Basic Kalman filter track class, without error. </div></div>
<div class="ttc" id="classrecob_1_1Seed_html_ad5f7f7926ad4141833770a2d34a8694d"><div class="ttname"><a href="../../d5/d76/classrecob_1_1Seed.html#ad5f7f7926ad4141833770a2d34a8694d">recob::Seed::GetDirection</a></div><div class="ttdeci">void GetDirection(double *Dir, double *Err) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d58/Seed_8cxx_source.html#l00098">Seed.cxx:98</a></div></div>
<div class="ttc" id="classtrkf_1_1KFitTrack_html_a6023570c5f9e6e3cca12b984a619b6fa"><div class="ttname"><a href="../../d2/df5/classtrkf_1_1KFitTrack.html#a6023570c5f9e6e3cca12b984a619b6fa">trkf::KFitTrack::getChisq</a></div><div class="ttdeci">double getChisq() const </div><div class="ttdoc">Fit chisquare. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db4/KFitTrack_8h_source.html#l00067">KFitTrack.h:67</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a2e7b106b25e2a5d85a3a83c5c5081e48"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a2e7b106b25e2a5d85a3a83c5c5081e48">trkf::Track3DKalmanHitAlg::fSelfSeed</a></div><div class="ttdeci">bool fSelfSeed</div><div class="ttdoc">Self seed flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00112">Track3DKalmanHitAlg.h:112</a></div></div>
<div class="ttc" id="triggersim__singlewindow__icarus_8fcl_html_a0cfd9e1c19570259ad279d6a291a27f8"><div class="ttname"><a href="../../dd/d08/triggersim__singlewindow__icarus_8fcl.html#a0cfd9e1c19570259ad279d6a291a27f8">outputs</a></div><div class="ttdeci">BEGIN_PROLOG sequence::SlidingWindowTriggerPatternsWindowPair END_PROLOG trigslidewindowOR6m output outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/triggersim__singlewindow__icarus_8fcl_source.html#l00200">triggersim_singlewindow_icarus.fcl:200</a></div></div>
<div class="ttc" id="classtrkf_1_1KGTrack_html_a772814934aff91037c4fcb28e9b15db4"><div class="ttname"><a href="../../d6/d5c/classtrkf_1_1KGTrack.html#a772814934aff91037c4fcb28e9b15db4">trkf::KGTrack::startTrack</a></div><div class="ttdeci">const KHitTrack &amp; startTrack() const </div><div class="ttdoc">Track at start point. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da8/KGTrack_8cxx_source.html#l00031">KGTrack.cxx:31</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00154">SimWire_module.cc:154</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_adc4bf23bfc3ccb9ac3ceae1d6391eb3d"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#adc4bf23bfc3ccb9ac3ceae1d6391eb3d">trkf::Track3DKalmanHitAlg::fMinSeedSlope</a></div><div class="ttdeci">double fMinSeedSlope</div><div class="ttdoc">Minimum seed slope (dx/dz). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00119">Track3DKalmanHitAlg.h:119</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a9cf39752fe6bc71c04cec6616b1a9c56"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9cf39752fe6bc71c04cec6616b1a9c56">trkf::Track3DKalmanHitAlg::extendandsmoothLoop</a></div><div class="ttdeci">bool extendandsmoothLoop(detinfo::DetectorPropertiesData const &amp;detProp, Propagator const &amp;propagator, KGTrack &amp;trg1, unsigned int prefplane, Hits &amp;trackhits) const </div><div class="ttdoc">SMooth and extend a track in a loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00459">Track3DKalmanHitAlg.cxx:459</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_ae6e2651bdc3e38a17e875a0acdc00920"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#ae6e2651bdc3e38a17e875a0acdc00920">trkf::Track3DKalmanHitAlg::fMaxTcut</a></div><div class="ttdeci">double fMaxTcut</div><div class="ttdoc">Maximum delta ray energy in MeV for restricted dE/dx. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/Track3DKalmanHitAlg_8h_source.html#l00113">Track3DKalmanHitAlg.h:113</a></div></div>
<div class="ttc" id="classtrkf_1_1Track3DKalmanHitAlg_html_a9a6da3a31fdc23c0516486dc304e7c72"><div class="ttname"><a href="../../d0/dce/classtrkf_1_1Track3DKalmanHitAlg.html#a9a6da3a31fdc23c0516486dc304e7c72">trkf::Track3DKalmanHitAlg::makeSurface</a></div><div class="ttdeci">std::shared_ptr&lt; Surface &gt; makeSurface(const recob::Seed &amp;seed, double *dir) const </div><div class="ttdoc">method to return a seed to surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d36/Track3DKalmanHitAlg_8cxx_source.html#l00263">Track3DKalmanHitAlg.cxx:263</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
