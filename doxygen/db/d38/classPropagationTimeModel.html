<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>PropagationTimeModel Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d0/dcb/classPropagationTimeModel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PropagationTimeModel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afb2a1327678757d21b97ce7fc9342160"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#afb2a1327678757d21b97ce7fc9342160">PropagationTimeModel</a> (fhicl::ParameterSet VUVTimingParams, fhicl::ParameterSet VISTimingParams, CLHEP::HepRandomEngine &amp;ScintTimeEngine, bool doReflectedLight=false, bool GeoPropTimeOnly=false)</td></tr>
<tr class="separator:afb2a1327678757d21b97ce7fc9342160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e84d1e37466923b45b1ba72aa9efa49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a0e84d1e37466923b45b1ba72aa9efa49">propagationTime</a> (std::vector&lt; double &gt; &amp;arrival_time_dist, <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;x0, const size_t OpChannel, bool Reflected=false)</td></tr>
<tr class="separator:a0e84d1e37466923b45b1ba72aa9efa49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a033195912515696ec8eaf25fc690734e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a033195912515696ec8eaf25fc690734e">Initialization</a> ()</td></tr>
<tr class="separator:a033195912515696ec8eaf25fc690734e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357dc68f0c3928b43cbcf3cc334a9654"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a357dc68f0c3928b43cbcf3cc334a9654">getVUVTimes</a> (std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</td></tr>
<tr class="separator:a357dc68f0c3928b43cbcf3cc334a9654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd0e19bfc9675732a7346092676b5f34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#afd0e19bfc9675732a7346092676b5f34">getVUVTimesGeo</a> (std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm)</td></tr>
<tr class="separator:afd0e19bfc9675732a7346092676b5f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ceae2e802c7cfa8983c030dd062d2c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a4ceae2e802c7cfa8983c030dd062d2c4">generateParam</a> (const size_t index, const size_t angle_bin)</td></tr>
<tr class="separator:a4ceae2e802c7cfa8983c030dd062d2c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd05892f3b25554ba975681bf190f8c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#acd05892f3b25554ba975681bf190f8c6">getVISTimes</a> (std::vector&lt; double &gt; &amp;arrivalTimes, const TVector3 &amp;ScintPoint, const TVector3 &amp;OpDetPoint)</td></tr>
<tr class="separator:acd05892f3b25554ba975681bf190f8c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85df48a361c80cc488e32dcfd6e11131"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a85df48a361c80cc488e32dcfd6e11131">fast_acos</a> (double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>) const </td></tr>
<tr class="separator:a85df48a361c80cc488e32dcfd6e11131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0fa020e781702bed90cb3a0ee4c6f3d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a> (const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, bool extrapolate, size_t i=0) const </td></tr>
<tr class="separator:ac0fa020e781702bed90cb3a0ee4c6f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1979693ac3454c2542064ad6dbf88fc3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a1979693ac3454c2542064ad6dbf88fc3">interpolate3</a> (<a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; &amp;inter, const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData1, const std::vector&lt; double &gt; &amp;yData2, const std::vector&lt; double &gt; &amp;yData3, double <a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, bool extrapolate)</td></tr>
<tr class="separator:a1979693ac3454c2542064ad6dbf88fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:abd175e654d41b029e6646352c384dae6"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#abd175e654d41b029e6646352c384dae6">finter_d</a> (const double *<a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, const double *par)</td></tr>
<tr class="separator:abd175e654d41b029e6646352c384dae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a486033c3f0b1e5fefce00a737efc96be"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a486033c3f0b1e5fefce00a737efc96be">model_close</a> (const double *<a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, const double *par)</td></tr>
<tr class="separator:a486033c3f0b1e5fefce00a737efc96be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ce9d794b7c0ee371699b998f4230c7"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a80ce9d794b7c0ee371699b998f4230c7">model_far</a> (const double *<a class="el" href="../../d1/d01/singles_8fcl.html#aa2441c6f4af6ae1d48f43c716144deac">x</a>, const double *par)</td></tr>
<tr class="separator:a80ce9d794b7c0ee371699b998f4230c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a098b0ecbec017d9ede29ca82c7da5298"><td class="memItemLeft" align="right" valign="top">const fhicl::ParameterSet&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a></td></tr>
<tr class="separator:a098b0ecbec017d9ede29ca82c7da5298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7c8364d257519a11b40f7ef97901e3"><td class="memItemLeft" align="right" valign="top">const fhicl::ParameterSet&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a></td></tr>
<tr class="separator:a1f7c8364d257519a11b40f7ef97901e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81aaa18f7af3cb8908172fc6109e41b1"><td class="memItemLeft" align="right" valign="top">const bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a81aaa18f7af3cb8908172fc6109e41b1">fdoReflectedLight</a></td></tr>
<tr class="separator:a81aaa18f7af3cb8908172fc6109e41b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4885a51a778182db46b48d1bac73430e"><td class="memItemLeft" align="right" valign="top">const bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a></td></tr>
<tr class="separator:a4885a51a778182db46b48d1bac73430e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeaf06e12238cd3add1433454fce4034"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d78/classlarg4_1_1ISTPC.html">larg4::ISTPC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#aaeaf06e12238cd3add1433454fce4034">fISTPC</a></td></tr>
<tr class="separator:aaeaf06e12238cd3add1433454fce4034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8440d488462f03761f050a487ba4dabd"><td class="memItemLeft" align="right" valign="top">CLHEP::HepRandomEngine &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a8440d488462f03761f050a487ba4dabd">fScintTimeEngine</a></td></tr>
<tr class="separator:a8440d488462f03761f050a487ba4dabd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a81d7f9a1c19c3d6462a5318a80823"><td class="memItemLeft" align="right" valign="top">CLHEP::RandFlat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#ac4a81d7f9a1c19c3d6462a5318a80823">fUniformGen</a></td></tr>
<tr class="separator:ac4a81d7f9a1c19c3d6462a5318a80823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674b10f2cd21e8f116c0720cb855de9a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">fplane_depth</a></td></tr>
<tr class="separator:a674b10f2cd21e8f116c0720cb855de9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a612b1648de73222ef2989195b5ec9ef0"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">fcathode_centre</a></td></tr>
<tr class="separator:a612b1648de73222ef2989195b5ec9ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab925178489d192d0899a91d36a13cbc3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#ab925178489d192d0899a91d36a13cbc3">fActiveVolumes</a></td></tr>
<tr class="separator:ab925178489d192d0899a91d36a13cbc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59521b791aa38df07a6848d9b0246456"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">nOpDets</a></td></tr>
<tr class="separator:a59521b791aa38df07a6848d9b0246456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8459f3d5d78b0fb1ab9e3728261a2396"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">fOpDetCenter</a></td></tr>
<tr class="separator:a8459f3d5d78b0fb1ab9e3728261a2396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56463b12e0f3b6ecc52e52cd391425b7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a></td></tr>
<tr class="separator:a56463b12e0f3b6ecc52e52cd391425b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a74278821d0ed209f9708f46d7a7ec7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">fstep_size</a></td></tr>
<tr class="separator:a4a74278821d0ed209f9708f46d7a7ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38303a4689c7c02faf1d673b8d868e87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a38303a4689c7c02faf1d673b8d868e87">fmax_d</a></td></tr>
<tr class="separator:a38303a4689c7c02faf1d673b8d868e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f67fe1653b106b675e1b4bab655030"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a></td></tr>
<tr class="separator:a60f67fe1653b106b675e1b4bab655030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190aeaac94c6c18adffce2ad638e7ffb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">fvuv_vgroup_mean</a></td></tr>
<tr class="separator:a190aeaac94c6c18adffce2ad638e7ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28f2011448240cd14df8a8751b20e2a9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">fvuv_vgroup_max</a></td></tr>
<tr class="separator:a28f2011448240cd14df8a8751b20e2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5684411a071a4e076e61fd37e4594c92"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a5684411a071a4e076e61fd37e4594c92">finflexion_point_distance</a></td></tr>
<tr class="separator:a5684411a071a4e076e61fd37e4594c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acff1ff1356f83d8ec9ae8a3a3c7995f5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#acff1ff1356f83d8ec9ae8a3a3c7995f5">fangle_bin_timing_vuv</a></td></tr>
<tr class="separator:acff1ff1356f83d8ec9ae8a3a3c7995f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cae8232dc44eeb17f6baa6f138a34ad"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a> [7]</td></tr>
<tr class="separator:a6cae8232dc44eeb17f6baa6f138a34ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643942130830aa9311cdde480567d661"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TF1 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">fVUV_timing</a></td></tr>
<tr class="separator:a643942130830aa9311cdde480567d661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ebf13ee0a9a18aca98405e6e911efe"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">fVUV_max</a></td></tr>
<tr class="separator:ae9ebf13ee0a9a18aca98405e6e911efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a517cf70ecb8a3346ab9452b58469cf04"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">fVUV_min</a></td></tr>
<tr class="separator:a517cf70ecb8a3346ab9452b58469cf04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29eb3183f0bfe7a2f0b098a7f808f77d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">fvis_vmean</a></td></tr>
<tr class="separator:a29eb3183f0bfe7a2f0b098a7f808f77d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95faa663f906fd6e7d1347b3731ebec4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a95faa663f906fd6e7d1347b3731ebec4">fangle_bin_timing_vis</a></td></tr>
<tr class="separator:a95faa663f906fd6e7d1347b3731ebec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110bd3acd8d034e66ead4c13bb414302"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">fdistances_refl</a></td></tr>
<tr class="separator:a110bd3acd8d034e66ead4c13bb414302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f37f390822bd8d76b8a34a5908aa935"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">fradial_distances_refl</a></td></tr>
<tr class="separator:a1f37f390822bd8d76b8a34a5908aa935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513fe4c95dc2c8027bef73e178ba0017"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">fcut_off_pars</a></td></tr>
<tr class="separator:a513fe4c95dc2c8027bef73e178ba0017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac1e292ac79e901e9a798dd24efc6d7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">ftau_pars</a></td></tr>
<tr class="separator:a4ac1e292ac79e901e9a798dd24efc6d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00034">34</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afb2a1327678757d21b97ce7fc9342160"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PropagationTimeModel::PropagationTimeModel </td>
          <td>(</td>
          <td class="paramtype">fhicl::ParameterSet&#160;</td>
          <td class="paramname"><em>VUVTimingParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fhicl::ParameterSet&#160;</td>
          <td class="paramname"><em>VISTimingParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CLHEP::HepRandomEngine &amp;&#160;</td>
          <td class="paramname"><em>ScintTimeEngine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doReflectedLight</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>GeoPropTimeOnly</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00021">21</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  :</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>(VUVTimingParams)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>(VISTimingParams)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#a81aaa18f7af3cb8908172fc6109e41b1">fdoReflectedLight</a>(doReflectedLight)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a>(GeoPropTimeOnly)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#aaeaf06e12238cd3add1433454fce4034">fISTPC</a>{*(lar::providerFrom&lt;geo::Geometry&gt;())}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#a8440d488462f03761f050a487ba4dabd">fScintTimeEngine</a>(ScintTimeEngine)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  , <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac4a81d7f9a1c19c3d6462a5318a80823">fUniformGen</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a8440d488462f03761f050a487ba4dabd">fScintTimeEngine</a>)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// initialise parameters and geometry</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Photon propagation time model initalized.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a033195912515696ec8eaf25fc690734e">Initialization</a>();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_aaeaf06e12238cd3add1433454fce4034"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#aaeaf06e12238cd3add1433454fce4034">PropagationTimeModel::fISTPC</a></div><div class="ttdeci">larg4::ISTPC fISTPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00104">PropagationTimeModel.h:104</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a8440d488462f03761f050a487ba4dabd"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a8440d488462f03761f050a487ba4dabd">PropagationTimeModel::fScintTimeEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fScintTimeEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00107">PropagationTimeModel.h:107</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a81aaa18f7af3cb8908172fc6109e41b1"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a81aaa18f7af3cb8908172fc6109e41b1">PropagationTimeModel::fdoReflectedLight</a></div><div class="ttdeci">const bool fdoReflectedLight</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00100">PropagationTimeModel.h:100</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a033195912515696ec8eaf25fc690734e"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a033195912515696ec8eaf25fc690734e">PropagationTimeModel::Initialization</a></div><div class="ttdeci">void Initialization()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00038">PropagationTimeModel.cxx:38</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4885a51a778182db46b48d1bac73430e"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">PropagationTimeModel::fGeoPropTimeOnly</a></div><div class="ttdeci">const bool fGeoPropTimeOnly</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00101">PropagationTimeModel.h:101</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a098b0ecbec017d9ede29ca82c7da5298"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">PropagationTimeModel::fVUVTimingParams</a></div><div class="ttdeci">const fhicl::ParameterSet fVUVTimingParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00096">PropagationTimeModel.h:96</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ac4a81d7f9a1c19c3d6462a5318a80823"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ac4a81d7f9a1c19c3d6462a5318a80823">PropagationTimeModel::fUniformGen</a></div><div class="ttdeci">CLHEP::RandFlat fUniformGen</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00108">PropagationTimeModel.h:108</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a1f7c8364d257519a11b40f7ef97901e3"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">PropagationTimeModel::fVISTimingParams</a></div><div class="ttdeci">const fhicl::ParameterSet fVISTimingParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00097">PropagationTimeModel.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a85df48a361c80cc488e32dcfd6e11131"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fast_acos </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00425">425</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordtype">double</span> negate = double(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; 0);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> -= double(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; 1.0) * (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - 1.0); <span class="comment">// &lt;- equivalent to min(1.0,x), but faster</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordtype">double</span> ret = -0.0187293;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  ret = ret * <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  ret = ret + 0.0742610;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  ret = ret * <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  ret = ret - 0.2121144;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  ret = ret * <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  ret = ret + 1.5707288;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  ret = ret * std::sqrt(1.0 - x);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  ret = ret - 2. * negate * ret;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">return</span> negate * 3.14159265358979 + ret;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd175e654d41b029e6646352c384dae6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::finter_d </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00526">526</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">double</span> y1 = par[2] * TMath::Landau(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0], par[0], par[1]);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">double</span> y2 = TMath::Exp(par[3] + <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] * par[4]);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">return</span> TMath::Abs(y1 - y2);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ceae2e802c7cfa8983c030dd062d2c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::generateParam </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>angle_bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00212">212</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// get distance</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">double</span> distance_in_cm = (index * <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">fstep_size</a>) + <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// time range</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> signal_t_range = 5000.;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// parameterisation TF1</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  TF1 VUVTiming;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// direct path transport time</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">double</span> t_direct_mean = distance_in_cm / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">fvuv_vgroup_mean</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">double</span> t_direct_min = distance_in_cm / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">fvuv_vgroup_max</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// Defining the model function(s) describing the photon transportation timing vs distance</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// Getting the landau parameters from the time parametrization</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  std::array&lt;double, 3&gt; pars_landau;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1979693ac3454c2542064ad6dbf88fc3">interpolate3</a>(pars_landau,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;               <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[0][0],</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[2][angle_bin],</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[3][angle_bin],</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;               <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[1][angle_bin],</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;               distance_in_cm,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;               <span class="keyword">true</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Deciding which time model to use (depends on the distance)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// defining useful times for the VUV arrival time shapes</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (distance_in_cm &gt;= <a class="code" href="../../db/d38/classPropagationTimeModel.html#a5684411a071a4e076e61fd37e4594c92">finflexion_point_distance</a>) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">double</span> pars_far[4] = {t_direct_min, pars_landau[0], pars_landau[1], pars_landau[2]};</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// Set model: Landau</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    VUVTiming = TF1(<span class="stringliteral">&quot;VUVTiming&quot;</span>, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a80ce9d794b7c0ee371699b998f4230c7">model_far</a>, 0, signal_t_range, 4);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    VUVTiming.SetParameters(pars_far);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Set model: Landau + Exponential</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    VUVTiming = TF1(<span class="stringliteral">&quot;VUVTiming&quot;</span>, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a486033c3f0b1e5fefce00a737efc96be">model_close</a>, 0, signal_t_range, 7);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Exponential parameters</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">double</span> pars_expo[2];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Getting the exponential parameters from the time parametrization</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    pars_expo[1] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[4][0], <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[5][angle_bin], distance_in_cm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    pars_expo[0] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[4][0], <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[6][angle_bin], distance_in_cm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    pars_expo[0] *= pars_landau[2];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    pars_expo[0] = std::log(pars_expo[0]);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// this is to find the intersection point between the two functions:</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    TF1 fint = TF1(<span class="stringliteral">&quot;fint&quot;</span>, <a class="code" href="../../db/d38/classPropagationTimeModel.html#abd175e654d41b029e6646352c384dae6">finter_d</a>, pars_landau[0], 4 * t_direct_mean, 5);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">double</span> parsInt[5] = {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      pars_landau[0], pars_landau[1], pars_landau[2], pars_expo[0], pars_expo[1]};</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    fint.SetParameters(parsInt);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">double</span> t_int = fint.GetMinimumX();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">double</span> minVal = fint.Eval(t_int);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// the functions must intersect - output warning if they don&#39;t</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (minVal &gt; 0.015) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;WARNING: Parametrization of VUV light discontinuous for distance = &quot;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        &lt;&lt; distance_in_cm &lt;&lt; std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      mf::LogWarning(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;WARNING: This shouldn&#39;t be happening &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">double</span> parsfinal[7] = {t_int,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                           pars_landau[0],</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                           pars_landau[1],</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                           pars_landau[2],</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                           pars_expo[0],</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                           pars_expo[1],</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                           t_direct_min};</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    VUVTiming.SetParameters(parsfinal);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// set the number of points used to sample parameterisation</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// for shorter distances, peak is sharper so more sensitive sampling required</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">int</span> fsampling;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (distance_in_cm &lt; 50) fsampling = 10000;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (distance_in_cm &lt; 100) fsampling = 5000;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">else</span> fsampling = 1000;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  VUVTiming.SetNpx(fsampling);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// calculate max and min distance relevant to sample parameterisation</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// max</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> nq_max = 1;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">double</span> xq_max[nq_max];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordtype">double</span> yq_max[nq_max];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  xq_max[0] = 0.975; <span class="comment">// include 97.5% of tail</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  VUVTiming.GetQuantiles(nq_max, yq_max, xq_max);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">double</span> max = yq_max[0];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// min</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">double</span> min = t_direct_min;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// store TF1 and min/max, this allows identical TF1 to be used every time sampling</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// the first call of GetRandom generates the timing sampling and stores it in the TF1 object, this is the slow part</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// all subsequent calls check if it has been generated previously and are ~100+ times quicker</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">fVUV_timing</a>[angle_bin][index] = VUVTiming;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">fVUV_max</a>[angle_bin][index] = max;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">fVUV_min</a>[angle_bin][index] = min;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_a486033c3f0b1e5fefce00a737efc96be"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a486033c3f0b1e5fefce00a737efc96be">PropagationTimeModel::model_close</a></div><div class="ttdeci">static double model_close(const double *x, const double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00536">PropagationTimeModel.cxx:536</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a190aeaac94c6c18adffce2ad638e7ffb"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">PropagationTimeModel::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_abd175e654d41b029e6646352c384dae6"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#abd175e654d41b029e6646352c384dae6">PropagationTimeModel::finter_d</a></div><div class="ttdeci">static double finter_d(const double *x, const double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00526">PropagationTimeModel.cxx:526</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a1979693ac3454c2542064ad6dbf88fc3"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a1979693ac3454c2542064ad6dbf88fc3">PropagationTimeModel::interpolate3</a></div><div class="ttdeci">void interpolate3(std::array&lt; double, 3 &gt; &amp;inter, const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData1, const std::vector&lt; double &gt; &amp;yData2, const std::vector&lt; double &gt; &amp;yData3, double x, bool extrapolate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00478">PropagationTimeModel.cxx:478</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ac0fa020e781702bed90cb3a0ee4c6f3d"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">PropagationTimeModel::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00448">PropagationTimeModel.cxx:448</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a28f2011448240cd14df8a8751b20e2a9"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">PropagationTimeModel::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a80ce9d794b7c0ee371699b998f4230c7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a80ce9d794b7c0ee371699b998f4230c7">PropagationTimeModel::model_far</a></div><div class="ttdeci">static double model_far(const double *x, const double *par)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00556">PropagationTimeModel.cxx:556</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a5684411a071a4e076e61fd37e4594c92"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a5684411a071a4e076e61fd37e4594c92">PropagationTimeModel::finflexion_point_distance</a></div><div class="ttdeci">double finflexion_point_distance</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a60f67fe1653b106b675e1b4bab655030"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">PropagationTimeModel::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ae9ebf13ee0a9a18aca98405e6e911efe"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">PropagationTimeModel::fVUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00126">PropagationTimeModel.h:126</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a6cae8232dc44eeb17f6baa6f138a34ad"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">PropagationTimeModel::fparameters</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fparameters[7]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00122">PropagationTimeModel.h:122</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4a74278821d0ed209f9708f46d7a7ec7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">PropagationTimeModel::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a643942130830aa9311cdde480567d661"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">PropagationTimeModel::fVUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; fVUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00124">PropagationTimeModel.h:124</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a517cf70ecb8a3346ab9452b58469cf04"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">PropagationTimeModel::fVUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00127">PropagationTimeModel.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd05892f3b25554ba975681bf190f8c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::getVISTimes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrivalTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>ScintPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>OpDetPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00310">310</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">//     Calculation of earliest arrival times and corresponding unsmeared</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">//     distribution</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// set plane_depth for correct TPC:</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">double</span> plane_depth;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span> (ScintPoint[0] &lt; 0) plane_depth = -<a class="code" href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">fplane_depth</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">else</span> plane_depth = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">fplane_depth</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// calculate point of reflection for shortest path</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  TVector3 bounce_point(plane_depth,ScintPoint[1],ScintPoint[2]);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// calculate distance travelled by VUV light and by vis light</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">double</span> VUVdist = (bounce_point - ScintPoint).Mag();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">double</span> Visdist = (OpDetPoint - bounce_point).Mag();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// calculate times taken by VUV part of path</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">int</span> angle_bin_vuv = 0; <span class="comment">// on-axis by definition</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a357dc68f0c3928b43cbcf3cc334a9654">getVUVTimes</a>(arrivalTimes, VUVdist, angle_bin_vuv);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// sum parts to get total transport times times</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    arrivalTimes[i] += Visdist / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">fvis_vmean</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">//      Smearing of arrival time distribution</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// calculate fastest time possible</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// vis part</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">double</span> vis_time = Visdist / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">fvis_vmean</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// vuv part</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">double</span> vuv_time;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">if</span> (VUVdist &lt; <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    vuv_time = VUVdist / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">fvuv_vgroup_max</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// find index of required parameterisation</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = std::round((VUVdist - <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>) / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">fstep_size</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// find shortest time</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    vuv_time = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">fVUV_min</a>[angle_bin_vuv][index];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// sum</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">double</span> fastest_time = vis_time + vuv_time;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// calculate angle theta between bound_point and optical detector</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">double</span> cosine_theta = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(OpDetPoint[0] - bounce_point[0]) / Visdist;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">double</span> theta = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a85df48a361c80cc488e32dcfd6e11131">fast_acos</a>(cosine_theta) * 180. / <a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// determine smearing parameters using interpolation of generated points:</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// 1). tau = exponential smearing factor, varies with distance and angle</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// 2). cutoff = largest smeared time allowed, preventing excessively large</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">//     times caused by exponential distance to cathode</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">double</span> distance_cathode_plane = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(plane_depth - ScintPoint[0]);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// angular bin</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">size_t</span> theta_bin = theta / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a95faa663f906fd6e7d1347b3731ebec4">fangle_bin_timing_vis</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// radial distance from centre of TPC (y,z plane)</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a> = std::hypot(ScintPoint[1] - <a class="code" href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">fcathode_centre</a>[1], ScintPoint[2] - <a class="code" href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">fcathode_centre</a>[2]);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// cut-off and tau</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// cut-off</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// interpolate in d_c for each r bin</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  std::vector&lt;double&gt; interp_vals(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">fcut_off_pars</a>[theta_bin].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>(), 0.0);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">fcut_off_pars</a>[theta_bin].size(); i++){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    interp_vals[i] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">fdistances_refl</a>, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">fcut_off_pars</a>[theta_bin][i], distance_cathode_plane, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">double</span> cutoff = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">fradial_distances_refl</a>, interp_vals, r, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// tau</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// interpolate in x for each r bin</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  std::vector&lt;double&gt; interp_vals_tau(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">ftau_pars</a>[theta_bin].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a>(), 0.0);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">ftau_pars</a>[theta_bin].size(); i++){</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    interp_vals_tau[i] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">fdistances_refl</a>, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">ftau_pars</a>[theta_bin][i], distance_cathode_plane, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// interpolate in r</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">double</span> tau = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">interpolate</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">fradial_distances_refl</a>, interp_vals_tau, r, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// apply smearing:</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">double</span> arrival_time_smeared;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// if time is already greater than cutoff, do not apply smearing</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (arrivalTimes[i] &gt;= cutoff) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// otherwise smear</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">counter</a> = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// loop until time generated is within cutoff limit</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">// most are within single attempt, very few take more than two</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// don&#39;t attempt smearings too many times</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (counter &gt;= 10) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          arrival_time_smeared = arrivalTimes[i]; <span class="comment">// don&#39;t smear</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="comment">// generate random number in appropriate range</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = <a class="code" href="../../db/d38/classPropagationTimeModel.html#ac4a81d7f9a1c19c3d6462a5318a80823">fUniformGen</a>.fire(0.5, 1.0);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="comment">// apply the exponential smearing</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          arrival_time_smeared =</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            arrivalTimes[i] + (arrivalTimes[i] - fastest_time) * (std::pow(x, -tau) - 1);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        counter++;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      } <span class="keywordflow">while</span> (arrival_time_smeared &gt; cutoff);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    arrivalTimes[i] = arrival_time_smeared;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_a674b10f2cd21e8f116c0720cb855de9a"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">PropagationTimeModel::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00111">PropagationTimeModel.h:111</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a357dc68f0c3928b43cbcf3cc334a9654"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a357dc68f0c3928b43cbcf3cc334a9654">PropagationTimeModel::getVUVTimes</a></div><div class="ttdeci">void getVUVTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00178">PropagationTimeModel.cxx:178</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a95faa663f906fd6e7d1347b3731ebec4"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a95faa663f906fd6e7d1347b3731ebec4">PropagationTimeModel::fangle_bin_timing_vis</a></div><div class="ttdeci">double fangle_bin_timing_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">PropagationTimeModel.h:130</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ac0fa020e781702bed90cb3a0ee4c6f3d"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ac0fa020e781702bed90cb3a0ee4c6f3d">PropagationTimeModel::interpolate</a></div><div class="ttdeci">double interpolate(const std::vector&lt; double &gt; &amp;xData, const std::vector&lt; double &gt; &amp;yData, double x, bool extrapolate, size_t i=0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00448">PropagationTimeModel.cxx:448</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4ac1e292ac79e901e9a798dd24efc6d7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">PropagationTimeModel::ftau_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; ftau_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00134">PropagationTimeModel.h:134</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a28f2011448240cd14df8a8751b20e2a9"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">PropagationTimeModel::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a1f37f390822bd8d76b8a34a5908aa935"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">PropagationTimeModel::fradial_distances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fradial_distances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00132">PropagationTimeModel.h:132</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a29eb3183f0bfe7a2f0b098a7f808f77d"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">PropagationTimeModel::fvis_vmean</a></div><div class="ttdeci">double fvis_vmean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">PropagationTimeModel.h:130</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a85df48a361c80cc488e32dcfd6e11131"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a85df48a361c80cc488e32dcfd6e11131">PropagationTimeModel::fast_acos</a></div><div class="ttdeci">double fast_acos(double x) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00425">PropagationTimeModel.cxx:425</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a612b1648de73222ef2989195b5ec9ef0"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">PropagationTimeModel::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00112">PropagationTimeModel.h:112</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a60f67fe1653b106b675e1b4bab655030"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">PropagationTimeModel::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a513fe4c95dc2c8027bef73e178ba0017"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">PropagationTimeModel::fcut_off_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fcut_off_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00133">PropagationTimeModel.h:133</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4a74278821d0ed209f9708f46d7a7ec7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">PropagationTimeModel::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a517cf70ecb8a3346ab9452b58469cf04"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">PropagationTimeModel::fVUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00127">PropagationTimeModel.h:127</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a110bd3acd8d034e66ead4c13bb414302"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">PropagationTimeModel::fdistances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fdistances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00131">PropagationTimeModel.h:131</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ac4a81d7f9a1c19c3d6462a5318a80823"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ac4a81d7f9a1c19c3d6462a5318a80823">PropagationTimeModel::fUniformGen</a></div><div class="ttdeci">CLHEP::RandFlat fUniformGen</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00108">PropagationTimeModel.h:108</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a357dc68f0c3928b43cbcf3cc334a9654"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::getVUVTimes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrivalTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>distance_in_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>angle_bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00178">178</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> &lt; <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// times are fixed shift i.e. direct path only</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">double</span> t_prop_correction = <a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">fvuv_vgroup_mean</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      arrivalTimes[i] = t_prop_correction;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// determine nearest parameterisation in discretisation</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">int</span> index = std::round((<a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> - <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>) / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">fstep_size</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// randomly sample parameterisation for each photon</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      arrivalTimes[i] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">fVUV_timing</a>[angle_bin][index].GetRandom(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">fVUV_min</a>[angle_bin][index], <a class="code" href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">fVUV_max</a>[angle_bin][index]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_a190aeaac94c6c18adffce2ad638e7ffb"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">PropagationTimeModel::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="namespaceicarus_html_a6ad3253842c1a0803df7cd600b60c35f"><div class="ttname"><a href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">icarus::distance</a></div><div class="ttdeci">double distance(geo::Point_t const &amp;point, CathodeDesc_t const &amp;cathode)</div><div class="ttdoc">Returns the distance of a point from the cathode. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd1/CathodeCrossingUtils_8cxx_source.html#l00035">CathodeCrossingUtils.cxx:35</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a60f67fe1653b106b675e1b4bab655030"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">PropagationTimeModel::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ae9ebf13ee0a9a18aca98405e6e911efe"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">PropagationTimeModel::fVUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00126">PropagationTimeModel.h:126</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4a74278821d0ed209f9708f46d7a7ec7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">PropagationTimeModel::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a643942130830aa9311cdde480567d661"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">PropagationTimeModel::fVUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; fVUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00124">PropagationTimeModel.h:124</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a517cf70ecb8a3346ab9452b58469cf04"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">PropagationTimeModel::fVUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00127">PropagationTimeModel.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afd0e19bfc9675732a7346092676b5f34"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::getVUVTimesGeo </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrivalTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>distance_in_cm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00200">200</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// times are fixed shift i.e. direct path only</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">double</span> t_prop_correction = <a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> / <a class="code" href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">fvuv_vgroup_mean</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; arrivalTimes.size(); ++i) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    arrivalTimes[i] = t_prop_correction;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_a190aeaac94c6c18adffce2ad638e7ffb"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">PropagationTimeModel::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="namespaceicarus_html_a6ad3253842c1a0803df7cd600b60c35f"><div class="ttname"><a href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">icarus::distance</a></div><div class="ttdeci">double distance(geo::Point_t const &amp;point, CathodeDesc_t const &amp;cathode)</div><div class="ttdoc">Returns the distance of a point from the cathode. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd1/CathodeCrossingUtils_8cxx_source.html#l00035">CathodeCrossingUtils.cxx:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a033195912515696ec8eaf25fc690734e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::Initialization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00038">38</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// load photon propagation time model parameters</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Direct / VUV</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Using VUV timing parameterization&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[0] = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(1, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;Distances_landau&quot;</span>));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[1] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;Norm_over_entries&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">fparameters</a>[2] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;Mpv&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    fparameters[3] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;Width&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    fparameters[4] = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(1, <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;Distances_exp&quot;</span>));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    fparameters[5] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;Slope&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    fparameters[6] = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;Expo_over_Landau_norm&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">fstep_size</a>                = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;step_size&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a38303a4689c7c02faf1d673b8d868e87">fmax_d</a>                    = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;max_d&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>                    = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;min_d&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">fvuv_vgroup_mean</a>          = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;vuv_vgroup_mean&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">fvuv_vgroup_max</a>           = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;vuv_vgroup_max&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a5684411a071a4e076e61fd37e4594c92">finflexion_point_distance</a> = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;inflexion_point_distance&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#acff1ff1356f83d8ec9ae8a3a3c7995f5">fangle_bin_timing_vuv</a>     = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;angle_bin_timing_vuv&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// create vector of empty TF1s that will be replaced with the sampled</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// parameterisations that are generated as they are required</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_params = (fmax_d - <a class="code" href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">fmin_d</a>) / fstep_size; <span class="comment">// for d &lt; fmin_d, no parameterisaton, a delta function is used instead</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_angles = std::round(90/fangle_bin_timing_vuv);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">fVUV_timing</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, TF1()));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// initialise vectors to contain range parameterisations sampled to in each case</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// when using TF1-&gt;GetRandom(xmin,xmax), must be in same range otherwise sampling</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// is regenerated, this is the slow part!</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">fVUV_max</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, 0.0));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">fVUV_min</a> = <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_angles, <a class="code" href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">std::vector</a>(num_params, 0.0));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// generate VUV parameters</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> angle_bin=0; angle_bin &lt; num_angles; ++angle_bin) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index=0; index &lt; num_params; ++index) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4ceae2e802c7cfa8983c030dd062d2c4">generateParam</a>(index, angle_bin);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Reflected / Visible</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d38/classPropagationTimeModel.html#a81aaa18f7af3cb8908172fc6109e41b1">fdoReflectedLight</a>) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      mf::LogInfo(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Using VIS (reflected) timing parameterization&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">fdistances_refl</a>        = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;Distances_refl&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">fradial_distances_refl</a> = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;Distances_radial_refl&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">fcut_off_pars</a>          = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;&gt;(<span class="stringliteral">&quot;Cut_off&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">ftau_pars</a>              = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;&gt;(<span class="stringliteral">&quot;Tau&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">fvis_vmean</a>             = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;vis_vmean&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a95faa663f906fd6e7d1347b3731ebec4">fangle_bin_timing_vis</a>  = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">fVISTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;angle_bin_timing_vis&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    mf::LogInfo(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Using geometric VUV time propagation&quot;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      fvuv_vgroup_mean          = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">fVUVTimingParams</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;vuv_vgroup_mean&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// access information from the geometry service</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> <span class="keyword">const</span>&amp; geom = *(lar::providerFrom&lt;geo::Geometry&gt;());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// get TPC information</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">fplane_depth</a> = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(0, 0).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">GetCathodeCenter</a>().X());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#ab925178489d192d0899a91d36a13cbc3">fActiveVolumes</a> = <a class="code" href="../../db/d38/classPropagationTimeModel.html#aaeaf06e12238cd3add1433454fce4034">fISTPC</a>.<a class="code" href="../../da/d78/classlarg4_1_1ISTPC.html#a3f4df626c34d0e1eef2a81b893b2eb84">extractActiveLArVolume</a>(geom);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">fcathode_centre</a> = {geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">TPC</a>(0, 0).<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">GetCathodeCenter</a>().X(),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                     fActiveVolumes[0].CenterY(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                     fActiveVolumes[0].CenterZ()};</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// get PDS information</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">nOpDets</a> = geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">NOpDets</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>.reserve(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">nOpDets</a>); <a class="code" href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">fOpDetCenter</a>.reserve(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">nOpDets</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <span class="keyword">const</span> i : <a class="code" href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a>(<a class="code" href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">nOpDets</a>)) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html">geo::OpDetGeo</a> <span class="keyword">const</span>&amp; opDet = geom.<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">OpDetGeoFromOpDet</a>(i);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">fOpDetCenter</a>.push_back(opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a0a09bf2d6710fe7ce6fe42416a2d13f9">GetCenter</a>());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a4a24ac66b67064c283defecd394729fd">isSphere</a>()) {  <span class="comment">// dome PMTs</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>.push_back(0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7dd253348db6b605f8c324a0624ee311">isBar</a>()) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// determine orientation to get correction OpDet dimensions</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> (opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#a3e2a466a0426f1b48e6550169f4e01cc">Width</a>() &gt; opDet.<a class="code" href="../../d7/d68/classgeo_1_1OpDetGeo.html#ae3261a6a3db55fa07cf04775f98c2edf">Height</a>()) { <span class="comment">// laterals, Y dimension smallest</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>.push_back(1);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">else</span> {  <span class="comment">// anode/cathode (default), X dimension smallest</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>.push_back(0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>.push_back(0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html">geo::OpDetGeo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00043">OpDetGeo.h:43</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a59521b791aa38df07a6848d9b0246456"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a59521b791aa38df07a6848d9b0246456">PropagationTimeModel::nOpDets</a></div><div class="ttdeci">size_t nOpDets</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00116">PropagationTimeModel.h:116</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_aaeaf06e12238cd3add1433454fce4034"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#aaeaf06e12238cd3add1433454fce4034">PropagationTimeModel::fISTPC</a></div><div class="ttdeci">larg4::ISTPC fISTPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00104">PropagationTimeModel.h:104</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_acff1ff1356f83d8ec9ae8a3a3c7995f5"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#acff1ff1356f83d8ec9ae8a3a3c7995f5">PropagationTimeModel::fangle_bin_timing_vuv</a></div><div class="ttdeci">double fangle_bin_timing_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a03c3be304c290d57f8909c25e70cfd81"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a03c3be304c290d57f8909c25e70cfd81">geo::GeometryCore::OpDetGeoFromOpDet</a></div><div class="ttdeci">OpDetGeo const &amp; OpDetGeoFromOpDet(unsigned int OpDet) const </div><div class="ttdoc">Returns the geo::OpDetGeo object for the given detector number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l01919">GeometryCore.cxx:1919</a></div></div>
<div class="ttc" id="classlarg4_1_1ISTPC_html_a3f4df626c34d0e1eef2a81b893b2eb84"><div class="ttname"><a href="../../da/d78/classlarg4_1_1ISTPC.html#a3f4df626c34d0e1eef2a81b893b2eb84">larg4::ISTPC::extractActiveLArVolume</a></div><div class="ttdeci">static std::vector&lt; geo::BoxBoundedGeo &gt; extractActiveLArVolume(geo::GeometryCore const &amp;geom)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d76/ISTPC_8cxx_source.html#l00051">ISTPC.cxx:51</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a674b10f2cd21e8f116c0720cb855de9a"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a674b10f2cd21e8f116c0720cb855de9a">PropagationTimeModel::fplane_depth</a></div><div class="ttdeci">double fplane_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00111">PropagationTimeModel.h:111</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a38303a4689c7c02faf1d673b8d868e87"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a38303a4689c7c02faf1d673b8d868e87">PropagationTimeModel::fmax_d</a></div><div class="ttdeci">double fmax_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a7dd253348db6b605f8c324a0624ee311"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a7dd253348db6b605f8c324a0624ee311">geo::OpDetGeo::isBar</a></div><div class="ttdeci">bool isBar() const </div><div class="ttdoc">Returns whether the detector shape is a bar (TGeoBBox). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00195">OpDetGeo.h:195</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_aa10ecaf40f48331dc005d6ae9e5f6ab5"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#aa10ecaf40f48331dc005d6ae9e5f6ab5">geo::TPCGeo::GetCathodeCenter</a></div><div class="ttdeci">Point GetCathodeCenter() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00298">TPCGeo.h:298</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a95faa663f906fd6e7d1347b3731ebec4"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a95faa663f906fd6e7d1347b3731ebec4">PropagationTimeModel::fangle_bin_timing_vis</a></div><div class="ttdeci">double fangle_bin_timing_vis</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">PropagationTimeModel.h:130</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a0a09bf2d6710fe7ce6fe42416a2d13f9"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a0a09bf2d6710fe7ce6fe42416a2d13f9">geo::OpDetGeo::GetCenter</a></div><div class="ttdeci">void GetCenter(double *xyz, double localz=0.0) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dfb/OpDetGeo_8cxx_source.html#l00040">OpDetGeo.cxx:40</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a190aeaac94c6c18adffce2ad638e7ffb"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a190aeaac94c6c18adffce2ad638e7ffb">PropagationTimeModel::fvuv_vgroup_mean</a></div><div class="ttdeci">double fvuv_vgroup_mean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a8459f3d5d78b0fb1ab9e3728261a2396"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">PropagationTimeModel::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00117">PropagationTimeModel.h:117</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a81aaa18f7af3cb8908172fc6109e41b1"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a81aaa18f7af3cb8908172fc6109e41b1">PropagationTimeModel::fdoReflectedLight</a></div><div class="ttdeci">const bool fdoReflectedLight</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00100">PropagationTimeModel.h:100</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a4a24ac66b67064c283defecd394729fd"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a4a24ac66b67064c283defecd394729fd">geo::OpDetGeo::isSphere</a></div><div class="ttdeci">bool isSphere() const </div><div class="ttdoc">Returns whether the detector shape is a hemisphere (TGeoSphere). </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00198">OpDetGeo.h:198</a></div></div>
<div class="ttc" id="namespacelar_1_1dump_html_a71d4403edbac4d265176f8677118194f"><div class="ttname"><a href="../../db/dfa/namespacelar_1_1dump.html#a71d4403edbac4d265176f8677118194f">lar::dump::vector</a></div><div class="ttdeci">auto vector(Vector const &amp;v)</div><div class="ttdoc">Returns a manipulator which will print the specified array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/DumpUtils_8h_source.html#l00265">DumpUtils.h:265</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4ac1e292ac79e901e9a798dd24efc6d7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4ac1e292ac79e901e9a798dd24efc6d7">PropagationTimeModel::ftau_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; ftau_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00134">PropagationTimeModel.h:134</a></div></div>
<div class="ttc" id="namespaceutil_html_a9462a726cd010ab8ada5eead879a4b9f"><div class="ttname"><a href="../../d6/d72/namespaceutil.html#a9462a726cd010ab8ada5eead879a4b9f">util::counter</a></div><div class="ttdeci">auto counter(T begin, T end)</div><div class="ttdoc">Returns an object to iterate values from begin to end in a range-for loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da2/counter_8h_source.html#l00285">counter.h:285</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a28f2011448240cd14df8a8751b20e2a9"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a28f2011448240cd14df8a8751b20e2a9">PropagationTimeModel::fvuv_vgroup_max</a></div><div class="ttdeci">double fvuv_vgroup_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a29eb3183f0bfe7a2f0b098a7f808f77d"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a29eb3183f0bfe7a2f0b098a7f808f77d">PropagationTimeModel::fvis_vmean</a></div><div class="ttdeci">double fvis_vmean</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">PropagationTimeModel.h:130</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a1f37f390822bd8d76b8a34a5908aa935"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a1f37f390822bd8d76b8a34a5908aa935">PropagationTimeModel::fradial_distances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fradial_distances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00132">PropagationTimeModel.h:132</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4885a51a778182db46b48d1bac73430e"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">PropagationTimeModel::fGeoPropTimeOnly</a></div><div class="ttdeci">const bool fGeoPropTimeOnly</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00101">PropagationTimeModel.h:101</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ab925178489d192d0899a91d36a13cbc3"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ab925178489d192d0899a91d36a13cbc3">PropagationTimeModel::fActiveVolumes</a></div><div class="ttdeci">std::vector&lt; geo::BoxBoundedGeo &gt; fActiveVolumes</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00113">PropagationTimeModel.h:113</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a5684411a071a4e076e61fd37e4594c92"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a5684411a071a4e076e61fd37e4594c92">PropagationTimeModel::finflexion_point_distance</a></div><div class="ttdeci">double finflexion_point_distance</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a612b1648de73222ef2989195b5ec9ef0"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a612b1648de73222ef2989195b5ec9ef0">PropagationTimeModel::fcathode_centre</a></div><div class="ttdeci">TVector3 fcathode_centre</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00112">PropagationTimeModel.h:112</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a56463b12e0f3b6ecc52e52cd391425b7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">PropagationTimeModel::fOpDetOrientation</a></div><div class="ttdeci">std::vector&lt; int &gt; fOpDetOrientation</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00118">PropagationTimeModel.h:118</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a></div><div class="ttdoc">Description of geometry of one entire detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01476">GeometryCore.h:1476</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a60f67fe1653b106b675e1b4bab655030"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a60f67fe1653b106b675e1b4bab655030">PropagationTimeModel::fmin_d</a></div><div class="ttdeci">double fmin_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_ae9ebf13ee0a9a18aca98405e6e911efe"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#ae9ebf13ee0a9a18aca98405e6e911efe">PropagationTimeModel::fVUV_max</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_max</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00126">PropagationTimeModel.h:126</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a00e36e8597fcf5d5059e4768f42f5362"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a00e36e8597fcf5d5059e4768f42f5362">geo::GeometryCore::NOpDets</a></div><div class="ttdeci">unsigned int NOpDets() const </div><div class="ttdoc">Number of OpDets in the whole detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00244">GeometryCore.cxx:244</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a6cae8232dc44eeb17f6baa6f138a34ad"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a6cae8232dc44eeb17f6baa6f138a34ad">PropagationTimeModel::fparameters</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fparameters[7]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00122">PropagationTimeModel.h:122</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a098b0ecbec017d9ede29ca82c7da5298"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a098b0ecbec017d9ede29ca82c7da5298">PropagationTimeModel::fVUVTimingParams</a></div><div class="ttdeci">const fhicl::ParameterSet fVUVTimingParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00096">PropagationTimeModel.h:96</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a513fe4c95dc2c8027bef73e178ba0017"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a513fe4c95dc2c8027bef73e178ba0017">PropagationTimeModel::fcut_off_pars</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; fcut_off_pars</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00133">PropagationTimeModel.h:133</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4a74278821d0ed209f9708f46d7a7ec7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4a74278821d0ed209f9708f46d7a7ec7">PropagationTimeModel::fstep_size</a></div><div class="ttdeci">double fstep_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a643942130830aa9311cdde480567d661"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a643942130830aa9311cdde480567d661">PropagationTimeModel::fVUV_timing</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1 &gt; &gt; fVUV_timing</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00124">PropagationTimeModel.h:124</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a517cf70ecb8a3346ab9452b58469cf04"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a517cf70ecb8a3346ab9452b58469cf04">PropagationTimeModel::fVUV_min</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; fVUV_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00127">PropagationTimeModel.h:127</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_a84aba48f49cf9add6cf0641a4527e45b"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#a84aba48f49cf9add6cf0641a4527e45b">geo::GeometryCore::TPC</a></div><div class="ttdeci">TPCGeo const &amp; TPC(unsigned int const tpc=0, unsigned int const cstat=0) const </div><div class="ttdoc">Returns the specified TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l02431">GeometryCore.h:2431</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a110bd3acd8d034e66ead4c13bb414302"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a110bd3acd8d034e66ead4c13bb414302">PropagationTimeModel::fdistances_refl</a></div><div class="ttdeci">std::vector&lt; double &gt; fdistances_refl</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00131">PropagationTimeModel.h:131</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_a3e2a466a0426f1b48e6550169f4e01cc"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#a3e2a466a0426f1b48e6550169f4e01cc">geo::OpDetGeo::Width</a></div><div class="ttdeci">double Width() const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00082">OpDetGeo.h:82</a></div></div>
<div class="ttc" id="classgeo_1_1OpDetGeo_html_ae3261a6a3db55fa07cf04775f98c2edf"><div class="ttname"><a href="../../d7/d68/classgeo_1_1OpDetGeo.html#ae3261a6a3db55fa07cf04775f98c2edf">geo::OpDetGeo::Height</a></div><div class="ttdeci">double Height() const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d38/OpDetGeo_8h_source.html#l00083">OpDetGeo.h:83</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4ceae2e802c7cfa8983c030dd062d2c4"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4ceae2e802c7cfa8983c030dd062d2c4">PropagationTimeModel::generateParam</a></div><div class="ttdeci">void generateParam(const size_t index, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00212">PropagationTimeModel.cxx:212</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a1f7c8364d257519a11b40f7ef97901e3"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a1f7c8364d257519a11b40f7ef97901e3">PropagationTimeModel::fVISTimingParams</a></div><div class="ttdeci">const fhicl::ParameterSet fVISTimingParams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00097">PropagationTimeModel.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0fa020e781702bed90cb3a0ee4c6f3d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::interpolate </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>extrapolate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00448">448</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = xData.size();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt;= xData[size - 2]) { <span class="comment">// special case: beyond right end</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      i = size - 2;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xData[i + 1])</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        i++;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">double</span> xL = xData[i];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">double</span> xR = xData[i + 1];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordtype">double</span> yL = yData[i];</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">double</span> yR = yData[i + 1]; <span class="comment">// points on either side (unless beyond ends)</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span> (!extrapolate) {       <span class="comment">// if beyond ends of array and not extrapolating</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; xL) <span class="keywordflow">return</span> yL;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xR) <span class="keywordflow">return</span> yL;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dydx = (yR - yL) / (xR - xL); <span class="comment">// gradient</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">return</span> yL + dydx * (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - xL);               <span class="comment">// linear interpolation</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1979693ac3454c2542064ad6dbf88fc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::interpolate3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>inter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yData3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>extrapolate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00478">478</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">size</a> = xData.size();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">size_t</span> i = 0;               <span class="comment">// find left end of interval for interpolation</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt;= xData[size - 2]) { <span class="comment">// special case: beyond right end</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    i = size - 2;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xData[i + 1])</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      i++;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">double</span> xL = xData[i];</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">double</span> xR = xData[i + 1]; <span class="comment">// points on either side (unless beyond ends)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordtype">double</span> yL1 = yData1[i];</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">double</span> yR1 = yData1[i + 1];</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordtype">double</span> yL2 = yData2[i];</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordtype">double</span> yR2 = yData2[i + 1];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordtype">double</span> yL3 = yData3[i];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">double</span> yR3 = yData3[i + 1];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">if</span> (!extrapolate) { <span class="comment">// if beyond ends of array and not extrapolating</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &lt; xL) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      inter[0] = yL1;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      inter[1] = yL2;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      inter[2] = yL3;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> &gt; xR) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      inter[0] = yL1;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      inter[1] = yL2;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      inter[2] = yL3;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">m</a> = (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> - xL) / (xR - xL);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  inter[0] = m * (yR1 - yL1) + yL1;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  inter[1] = m * (yR2 - yL2) + yL2;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  inter[2] = m * (yR3 - yL3) + yL3;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aaae74cf315284bc0f44c2e050c119781"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aaae74cf315284bc0f44c2e050c119781">icarus::ns::util::size</a></div><div class="ttdeci">std::size_t size(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00561">FixedBins.h:561</a></div></div>
<div class="ttc" id="namespacegen__crt__frags_html_a55a56854d78e363691470c7297fde77c"><div class="ttname"><a href="../../d8/ddf/namespacegen__crt__frags.html#a55a56854d78e363691470c7297fde77c">gen_crt_frags.m</a></div><div class="ttdeci">tuple m</div><div class="ttdoc">now if test mode generate materials, CRT shell, world, gdml header else just generate CRT shell for u...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8c/gen__crt__frags_8py_source.html#l01347">gen_crt_frags.py:1347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a486033c3f0b1e5fefce00a737efc96be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::model_close </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00536">536</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// par0 = joining point</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// par1 = Landau MPV</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// par2 = Landau width</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// par3 = normalization</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// par4 = Expo cte</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// par5 = Expo tau</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// par6 = t_min</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">double</span> y1 = par[3] * TMath::Landau(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0], par[1], par[2]);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">double</span> y2 = TMath::Exp(par[4] + <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] * par[5]);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] &lt;= par[6] || <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] &gt; par[0]) y1 = 0.;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] &lt; par[0]) y2 = 0.;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">return</span> (y1 + y2);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80ce9d794b7c0ee371699b998f4230c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::model_far </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00556">556</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// par1 = Landau MPV</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// par2 = Landau width</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// par3 = normalization</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// par0 = t_min</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a> = par[3] * TMath::Landau(<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0], par[1], par[2]);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>[0] &lt;= par[0]) y = 0.;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a1e5aaaf25e8609a835e8c7c6fda71456"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a1e5aaaf25e8609a835e8c7c6fda71456">y</a></div><div class="ttdeci">process_name opflash particleana ie ie y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00091">run_opflash_electron.fcl:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e84d1e37466923b45b1ba72aa9efa49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PropagationTimeModel::propagationTime </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>arrival_time_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>OpChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Reflected</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00140">140</a> of file <a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Get VUV photons transport time distribution from the parametrization</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; opDetCenter = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">fOpDetCenter</a>[OpChannel];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!Reflected) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">distance</a> = std::hypot(x0.X() - opDetCenter.X(), x0.Y() - opDetCenter.Y(), x0.Z() - opDetCenter.Z());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">double</span> cosine;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">fOpDetOrientation</a>[OpChannel] == 1) cosine = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(x0.Y() - opDetCenter.Y()) / distance;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">else</span> cosine = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">std::abs</a>(x0.X() - opDetCenter.X()) / distance;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">double</span> theta = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a85df48a361c80cc488e32dcfd6e11131">fast_acos</a>(cosine)*180./<a class="code" href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">CLHEP::pi</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">int</span> angle_bin = theta/<a class="code" href="../../db/d38/classPropagationTimeModel.html#acff1ff1356f83d8ec9ae8a3a3c7995f5">fangle_bin_timing_vuv</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#a357dc68f0c3928b43cbcf3cc334a9654">getVUVTimes</a>(arrival_time_dist, distance, angle_bin); <span class="comment">// in ns</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="../../db/d38/classPropagationTimeModel.html#acd05892f3b25554ba975681bf190f8c6">getVISTimes</a>(arrival_time_dist, <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a>(x0),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                  <a class="code" href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a>(opDetCenter)); <span class="comment">// in ns</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">fGeoPropTimeOnly</a> &amp;&amp; !Reflected) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Get VUV photons arrival time geometrically</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a> <span class="keyword">const</span>&amp; opDetCenter = <a class="code" href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">fOpDetCenter</a>[OpChannel];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">double</span> distance = std::hypot(x0.X() - opDetCenter.X(), x0.Y() - opDetCenter.Y(), x0.Z() - opDetCenter.Z());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../db/d38/classPropagationTimeModel.html#afd0e19bfc9675732a7346092676b5f34">getVUVTimesGeo</a>(arrival_time_dist, distance); <span class="comment">// in ns</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;PropagationTimeModel&quot;</span>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Propagation time model not found.&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="classPropagationTimeModel_html_acff1ff1356f83d8ec9ae8a3a3c7995f5"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#acff1ff1356f83d8ec9ae8a3a3c7995f5">PropagationTimeModel::fangle_bin_timing_vuv</a></div><div class="ttdeci">double fangle_bin_timing_vuv</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">PropagationTimeModel.h:121</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a357dc68f0c3928b43cbcf3cc334a9654"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a357dc68f0c3928b43cbcf3cc334a9654">PropagationTimeModel::getVUVTimes</a></div><div class="ttdeci">void getVUVTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm, const size_t angle_bin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00178">PropagationTimeModel.cxx:178</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_acd05892f3b25554ba975681bf190f8c6"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#acd05892f3b25554ba975681bf190f8c6">PropagationTimeModel::getVISTimes</a></div><div class="ttdeci">void getVISTimes(std::vector&lt; double &gt; &amp;arrivalTimes, const TVector3 &amp;ScintPoint, const TVector3 &amp;OpDetPoint)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00310">PropagationTimeModel.cxx:310</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a8459f3d5d78b0fb1ab9e3728261a2396"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a8459f3d5d78b0fb1ab9e3728261a2396">PropagationTimeModel::fOpDetCenter</a></div><div class="ttdeci">std::vector&lt; geo::Point_t &gt; fOpDetCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00117">PropagationTimeModel.h:117</a></div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="namespaceicarus_html_a6ad3253842c1a0803df7cd600b60c35f"><div class="ttname"><a href="../../da/d4d/namespaceicarus.html#a6ad3253842c1a0803df7cd600b60c35f">icarus::distance</a></div><div class="ttdeci">double distance(geo::Point_t const &amp;point, CathodeDesc_t const &amp;cathode)</div><div class="ttdoc">Returns the distance of a point from the cathode. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd1/CathodeCrossingUtils_8cxx_source.html#l00035">CathodeCrossingUtils.cxx:35</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a4885a51a778182db46b48d1bac73430e"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a4885a51a778182db46b48d1bac73430e">PropagationTimeModel::fGeoPropTimeOnly</a></div><div class="ttdeci">const bool fGeoPropTimeOnly</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00101">PropagationTimeModel.h:101</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a877355c0633159be39561763c248e53a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a877355c0633159be39561763c248e53a">pi</a></div><div class="ttdeci">pdgs pi</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a85df48a361c80cc488e32dcfd6e11131"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a85df48a361c80cc488e32dcfd6e11131">PropagationTimeModel::fast_acos</a></div><div class="ttdeci">double fast_acos(double x) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00425">PropagationTimeModel.cxx:425</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_a56463b12e0f3b6ecc52e52cd391425b7"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#a56463b12e0f3b6ecc52e52cd391425b7">PropagationTimeModel::fOpDetOrientation</a></div><div class="ttdeci">std::vector&lt; int &gt; fOpDetOrientation</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00118">PropagationTimeModel.h:118</a></div></div>
<div class="ttc" id="classPropagationTimeModel_html_afd0e19bfc9675732a7346092676b5f34"><div class="ttname"><a href="../../db/d38/classPropagationTimeModel.html#afd0e19bfc9675732a7346092676b5f34">PropagationTimeModel::getVUVTimesGeo</a></div><div class="ttdeci">void getVUVTimesGeo(std::vector&lt; double &gt; &amp;arrivalTimes, const double distance_in_cm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d26/PropagationTimeModel_8cxx_source.html#l00200">PropagationTimeModel.cxx:200</a></div></div>
<div class="ttc" id="namespacegeo_1_1vect_html_a2de0745d12bd608fe66a141667764c69"><div class="ttname"><a href="../../d0/d8e/namespacegeo_1_1vect.html#a2de0745d12bd608fe66a141667764c69">geo::vect::toTVector3</a></div><div class="ttdeci">TVector3 toTVector3(Vector const &amp;v)</div><div class="ttdoc">Converts a vector into a TVector3. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/geo__vectors__utils__TVector_8h_source.html#l00043">geo_vectors_utils_TVector.h:43</a></div></div>
<div class="ttc" id="namespacegeo_html_a5a6f22c2aa9d0ccf6ca08bf2773a0541"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a></div><div class="ttdeci">ROOT::Math::PositionVector3D&lt; ROOT::Math::Cartesian3D&lt; double &gt;, ROOT::Math::GlobalCoordinateSystemTag &gt; Point_t</div><div class="ttdoc">Type for representation of position in physical 3D space. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00184">geo_vectors.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ab925178489d192d0899a91d36a13cbc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>&gt; PropagationTimeModel::fActiveVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00113">113</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a95faa663f906fd6e7d1347b3731ebec4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fangle_bin_timing_vis</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">130</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="acff1ff1356f83d8ec9ae8a3a3c7995f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fangle_bin_timing_vuv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a612b1648de73222ef2989195b5ec9ef0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 PropagationTimeModel::fcathode_centre</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00112">112</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a513fe4c95dc2c8027bef73e178ba0017"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; PropagationTimeModel::fcut_off_pars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00133">133</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a110bd3acd8d034e66ead4c13bb414302"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; PropagationTimeModel::fdistances_refl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00131">131</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a81aaa18f7af3cb8908172fc6109e41b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const bool PropagationTimeModel::fdoReflectedLight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00100">100</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4885a51a778182db46b48d1bac73430e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const bool PropagationTimeModel::fGeoPropTimeOnly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00101">101</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5684411a071a4e076e61fd37e4594c92"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::finflexion_point_distance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaeaf06e12238cd3add1433454fce4034"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d78/classlarg4_1_1ISTPC.html">larg4::ISTPC</a> PropagationTimeModel::fISTPC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00104">104</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a38303a4689c7c02faf1d673b8d868e87"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fmax_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a60f67fe1653b106b675e1b4bab655030"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fmin_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8459f3d5d78b0fb1ab9e3728261a2396"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d6/d23/namespacegeo.html#a5a6f22c2aa9d0ccf6ca08bf2773a0541">geo::Point_t</a>&gt; PropagationTimeModel::fOpDetCenter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00117">117</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a56463b12e0f3b6ecc52e52cd391425b7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; PropagationTimeModel::fOpDetOrientation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00118">118</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6cae8232dc44eeb17f6baa6f138a34ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; PropagationTimeModel::fparameters[7]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00122">122</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a674b10f2cd21e8f116c0720cb855de9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fplane_depth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00111">111</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1f37f390822bd8d76b8a34a5908aa935"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; PropagationTimeModel::fradial_distances_refl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00132">132</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8440d488462f03761f050a487ba4dabd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CLHEP::HepRandomEngine&amp; PropagationTimeModel::fScintTimeEngine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00107">107</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4a74278821d0ed209f9708f46d7a7ec7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fstep_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4ac1e292ac79e901e9a798dd24efc6d7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;double&gt; &gt; &gt; PropagationTimeModel::ftau_pars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00134">134</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac4a81d7f9a1c19c3d6462a5318a80823"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CLHEP::RandFlat PropagationTimeModel::fUniformGen</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00108">108</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a29eb3183f0bfe7a2f0b098a7f808f77d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fvis_vmean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00130">130</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1f7c8364d257519a11b40f7ef97901e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const fhicl::ParameterSet PropagationTimeModel::fVISTimingParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00097">97</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae9ebf13ee0a9a18aca98405e6e911efe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; PropagationTimeModel::fVUV_max</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00126">126</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a517cf70ecb8a3346ab9452b58469cf04"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; PropagationTimeModel::fVUV_min</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00127">127</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a643942130830aa9311cdde480567d661"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TF1&gt; &gt; PropagationTimeModel::fVUV_timing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00124">124</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28f2011448240cd14df8a8751b20e2a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fvuv_vgroup_max</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a190aeaac94c6c18adffce2ad638e7ffb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PropagationTimeModel::fvuv_vgroup_mean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00121">121</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a098b0ecbec017d9ede29ca82c7da5298"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const fhicl::ParameterSet PropagationTimeModel::fVUVTimingParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00096">96</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59521b791aa38df07a6848d9b0246456"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t PropagationTimeModel::nOpDets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html#l00116">116</a> of file <a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d8/ddf/PropagationTimeModel_8h_source.html">PropagationTimeModel.h</a></li>
<li><a class="el" href="../../d1/d26/PropagationTimeModel_8cxx_source.html">PropagationTimeModel.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
