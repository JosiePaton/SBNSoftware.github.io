<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Solver.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_5b15bbda45fd32b1a5b5215b4901c029.html">SpacePointSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Solver.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;vector&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../df/d68/QuadExpr_8h_source.html">QuadExpr.h</a>&quot;</code><br/>
</div>
<p><a href="../../db/dc5/Solver_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dbc/classWireHit.html">WireHit</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d9f/classNeighbour.html">Neighbour</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a80f066ef1d380548b46b9661ffdd1f38"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a80f066ef1d380548b46b9661ffdd1f38">Metric</a> (const std::vector&lt; <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> * &gt; &amp;scs, double alpha)</td></tr>
<tr class="separator:a80f066ef1d380548b46b9661ffdd1f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadb42603719e68e9d792392d97a76ce8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#aadb42603719e68e9d792392d97a76ce8">Metric</a> (const std::vector&lt; <a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> * &gt; &amp;cwires, double alpha)</td></tr>
<tr class="separator:aadb42603719e68e9d792392d97a76ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a859294c4b68628a57f2c6a96ab8a17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d0d/classQuadExpr.html">QuadExpr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a6a859294c4b68628a57f2c6a96ab8a17">Metric</a> (const <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *<a class="el" href="../../d1/d27/preparseGDML_8cpp.html#a1a6924538c6652bbc6325981e60e0c68">sci</a>, const <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *scj, double alpha)</td></tr>
<tr class="separator:a6a859294c4b68628a57f2c6a96ab8a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5460807116ba31c68cebb735007ed494"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a5460807116ba31c68cebb735007ed494">SolvePair</a> (<a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> *cwire, <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *<a class="el" href="../../d1/d27/preparseGDML_8cpp.html#a1a6924538c6652bbc6325981e60e0c68">sci</a>, <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *scj, double <a class="el" href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a>, double xmax, double alpha)</td></tr>
<tr class="separator:a5460807116ba31c68cebb735007ed494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0483ebf37911dce7988b6184539f279f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a0483ebf37911dce7988b6184539f279f">Iterate</a> (<a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> *cwire, double alpha)</td></tr>
<tr class="separator:a0483ebf37911dce7988b6184539f279f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a918f3112c963afb82a1634e149142900"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a918f3112c963afb82a1634e149142900">Iterate</a> (<a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *sc, double alpha)</td></tr>
<tr class="separator:a918f3112c963afb82a1634e149142900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c23a828915e6c3986d7cdc770eb827b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/Solver_8h.html#a8c23a828915e6c3986d7cdc770eb827b">Iterate</a> (const std::vector&lt; <a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> * &gt; &amp;cwires, const std::vector&lt; <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> * &gt; &amp;orphanSCs, double alpha)</td></tr>
<tr class="separator:a8c23a828915e6c3986d7cdc770eb827b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0483ebf37911dce7988b6184539f279f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Iterate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> *&#160;</td>
          <td class="paramname"><em>cwire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00263">263</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Consider all pairs of crossings</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a> = cwire-&gt;<a class="code" href="../../d7/dc4/classCollectionWireHit.html#abcb9a616accdb03dff8dc2d1a1cd7473">fCrossings</a>.size();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i+1 &lt; <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>; ++i){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a>* <a class="code" href="../../d1/d27/preparseGDML_8cpp.html#a1a6924538c6652bbc6325981e60e0c68">sci</a> = cwire-&gt;<a class="code" href="../../d7/dc4/classCollectionWireHit.html#abcb9a616accdb03dff8dc2d1a1cd7473">fCrossings</a>[i];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i+1; j &lt; <a class="code" href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a>; ++j){</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a>* scj = cwire-&gt;<a class="code" href="../../d7/dc4/classCollectionWireHit.html#abcb9a616accdb03dff8dc2d1a1cd7473">fCrossings</a>[j];</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = <a class="code" href="../../d6/db4/Solver_8cxx.html#a4a3a100264c38605e8fb9a10b32f34c6">SolvePair</a>(cwire, sci, scj, alpha);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span>(x == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// Actually make the update</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">AddCharge</a>(+x);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      scj-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">AddCharge</a>(-x);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    } <span class="comment">// end for j</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  } <span class="comment">// end for i</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="classSpaceCharge_html_a16c513eddf7e4498aca1d158cd239ac9"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">SpaceCharge::AddCharge</a></div><div class="ttdeci">void AddCharge(double dq)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00035">Solver.cxx:35</a></div></div>
<div class="ttc" id="preparseGDML_8cpp_html_a1a6924538c6652bbc6325981e60e0c68"><div class="ttname"><a href="../../d1/d27/preparseGDML_8cpp.html#a1a6924538c6652bbc6325981e60e0c68">sci</a></div><div class="ttdeci">bool sci</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d27/preparseGDML_8cpp_source.html#l00015">preparseGDML.cpp:15</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classSpaceCharge_html"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00042">Solver.h:42</a></div></div>
<div class="ttc" id="classCollectionWireHit_html_abcb9a616accdb03dff8dc2d1a1cd7473"><div class="ttname"><a href="../../d7/dc4/classCollectionWireHit.html#abcb9a616accdb03dff8dc2d1a1cd7473">CollectionWireHit::fCrossings</a></div><div class="ttdeci">std::vector&lt; SpaceCharge * &gt; fCrossings</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00073">Solver.h:73</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a4a3a100264c38605e8fb9a10b32f34c6"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a4a3a100264c38605e8fb9a10b32f34c6">SolvePair</a></div><div class="ttdeci">double SolvePair(CollectionWireHit *cwire, SpaceCharge *sci, SpaceCharge *scj, double alpha)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00217">Solver.cxx:217</a></div></div>
<div class="ttc" id="prova__source_8fcl_html_ab58e1ede8542ac672a1c146fb3870f2e"><div class="ttname"><a href="../../d7/ded/prova__source_8fcl.html#ab58e1ede8542ac672a1c146fb3870f2e">N</a></div><div class="ttdeci">process_name largeant stream1 can override from command line with o or output physics producers generator N</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ded/prova__source_8fcl_source.html#l00033">prova_source.fcl:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a918f3112c963afb82a1634e149142900"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Iterate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00286">286</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;{</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d0d/classQuadExpr.html">QuadExpr</a> chisq = <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(sc, alpha);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// Find the minimum of a quadratic expression</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = -chisq.<a class="code" href="../../d7/d0d/classQuadExpr.html#acab7ef54c0b61791812a923e11bb7480">Linear</a>()/(2*chisq.<a class="code" href="../../d7/d0d/classQuadExpr.html#a0fef5faa4cef448b3bd6f305614e829b">Quadratic</a>());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Don&#39;t allow the SpaceCharge to go negative</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a> = -sc-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#ad1d56fb636c394847c29a317dc5f73ad">fPred</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Clamp to allowed range</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  x = <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">std::max</a>(xmin, x);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> chisq_new = chisq.<a class="code" href="../../d7/d0d/classQuadExpr.html#a167b1aa7e4b80e45403f7d0a59ee602e">Eval</a>(x);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// Should try here too, because the function might be convex not concave, so</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// d/dx=0 gives the max not the min, and the true min is at one extreme of</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// the range.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> chisq_n = chisq.<a class="code" href="../../d7/d0d/classQuadExpr.html#a167b1aa7e4b80e45403f7d0a59ee602e">Eval</a>(xmin);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">if</span>(chisq_n &lt; chisq_new)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    sc-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">AddCharge</a>(xmin);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    sc-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">AddCharge</a>(x);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="ttc" id="classSpaceCharge_html_a16c513eddf7e4498aca1d158cd239ac9"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#a16c513eddf7e4498aca1d158cd239ac9">SpaceCharge::AddCharge</a></div><div class="ttdeci">void AddCharge(double dq)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00035">Solver.cxx:35</a></div></div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classQuadExpr_html_acab7ef54c0b61791812a923e11bb7480"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html#acab7ef54c0b61791812a923e11bb7480">QuadExpr::Linear</a></div><div class="ttdeci">double Linear() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d68/QuadExpr_8h_source.html#l00016">QuadExpr.h:16</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="run__vertexcharge__icarus_8fcl_html_a0bb005bed46cb3379a0703e7b92b23c5"><div class="ttname"><a href="../../d4/d48/run__vertexcharge__icarus_8fcl.html#a0bb005bed46cb3379a0703e7b92b23c5">xmin</a></div><div class="ttdeci">process_name pandoraGausCryo1 vertexChargeCryo1 vertexStubCryo1 xmin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d48/run__vertexcharge__icarus_8fcl_source.html#l00109">run_vertexcharge_icarus.fcl:109</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a19d8f202216830672ccbd944969dd958"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a></div><div class="ttdeci">double Metric(double q, double p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00071">Solver.cxx:71</a></div></div>
<div class="ttc" id="classQuadExpr_html_a167b1aa7e4b80e45403f7d0a59ee602e"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html#a167b1aa7e4b80e45403f7d0a59ee602e">QuadExpr::Eval</a></div><div class="ttdeci">double Eval(double x) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/QuadExpr_8cxx_source.html#l00069">QuadExpr.cxx:69</a></div></div>
<div class="ttc" id="classQuadExpr_html"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html">QuadExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d68/QuadExpr_8h_source.html#l00008">QuadExpr.h:8</a></div></div>
<div class="ttc" id="classSpaceCharge_html_ad1d56fb636c394847c29a317dc5f73ad"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#ad1d56fb636c394847c29a317dc5f73ad">SpaceCharge::fPred</a></div><div class="ttdeci">double fPred</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00058">Solver.h:58</a></div></div>
<div class="ttc" id="classQuadExpr_html_a0fef5faa4cef448b3bd6f305614e829b"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html#a0fef5faa4cef448b3bd6f305614e829b">QuadExpr::Quadratic</a></div><div class="ttdeci">double Quadratic() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d68/QuadExpr_8h_source.html#l00015">QuadExpr.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8c23a828915e6c3986d7cdc770eb827b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Iterate </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>cwires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>orphanSCs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00313">313</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// Visiting in a &quot;random&quot; order helps prevent local artefacts that are slow</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// to break up.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cwireIdx = 0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span> (!cwires.empty()){</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="../../d6/db4/Solver_8cxx.html#a0483ebf37911dce7988b6184539f279f">Iterate</a>(cwires[cwireIdx], alpha);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prime = 1299827;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      cwireIdx = (cwireIdx+prime)%cwires.size();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    } <span class="keywordflow">while</span>(cwireIdx != 0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a>* sc: orphanSCs) <a class="code" href="../../d6/db4/Solver_8cxx.html#a0483ebf37911dce7988b6184539f279f">Iterate</a>(sc, alpha);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="ttc" id="classSpaceCharge_html"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00042">Solver.h:42</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a0483ebf37911dce7988b6184539f279f"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a0483ebf37911dce7988b6184539f279f">Iterate</a></div><div class="ttdeci">void Iterate(CollectionWireHit *cwire, double alpha)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00263">Solver.cxx:263</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80f066ef1d380548b46b9661ffdd1f38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Metric </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>scs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00083">83</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">double</span> ret = 0;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  std::set&lt;InductionWireHit*&gt; iwires;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a>* sc: scs){</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span>(sc-&gt;fWire1) iwires.insert(sc-&gt;fWire1);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span>(sc-&gt;fWire2) iwires.insert(sc-&gt;fWire2);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span>(alpha != 0){</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      ret -= alpha*<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(sc-&gt;fPred);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">// &quot;Double-counting&quot; of the two ends of the connection is</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// intentional. Otherwise we&#39;d have a half in the line above.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      ret -= alpha * sc-&gt;fPred * sc-&gt;fNeiPotential;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a>* iwire: iwires){</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(iwire-&gt;fCharge, iwire-&gt;fPred);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="ttc" id="classSpaceCharge_html"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00042">Solver.h:42</a></div></div>
<div class="ttc" id="ComputePi__module_8cc_html_a51cbff124162962a948e82258a33a415"><div class="ttname"><a href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a></div><div class="ttdeci">constexpr T sqr(T v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/ComputePi__module_8cc_source.html#l00097">ComputePi_module.cc:97</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a19d8f202216830672ccbd944969dd958"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a></div><div class="ttdeci">double Metric(double q, double p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00071">Solver.cxx:71</a></div></div>
<div class="ttc" id="classInductionWireHit_html"><div class="ttname"><a href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00017">Solver.h:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aadb42603719e68e9d792392d97a76ce8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Metric </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>cwires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00108">108</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  std::vector&lt;SpaceCharge*&gt; scs;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a>* cwire: cwires)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    scs.insert(scs.end(), cwire-&gt;fCrossings.begin(), cwire-&gt;fCrossings.end());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(scs, alpha);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="ttc" id="classCollectionWireHit_html"><div class="ttname"><a href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00062">Solver.h:62</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a19d8f202216830672ccbd944969dd958"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a></div><div class="ttdeci">double Metric(double q, double p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00071">Solver.cxx:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a859294c4b68628a57f2c6a96ab8a17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d0d/classQuadExpr.html">QuadExpr</a> Metric </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *&#160;</td>
          <td class="paramname"><em>sci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *&#160;</td>
          <td class="paramname"><em>scj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/db4/Solver_8cxx_source.html#l00117">117</a> of file <a class="el" href="../../d6/db4/Solver_8cxx_source.html">Solver.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="../../d7/d0d/classQuadExpr.html">QuadExpr</a> ret = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// How much charge moves from scj to sci</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="../../d7/d0d/classQuadExpr.html">QuadExpr</a> <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a> = <a class="code" href="../../d7/d0d/classQuadExpr.html#aebd434d58928b2f8541f74e6be494421">QuadExpr::X</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span>(alpha != 0){</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> scip = sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#ad1d56fb636c394847c29a317dc5f73ad">fPred</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> scjp = scj-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#ad1d56fb636c394847c29a317dc5f73ad">fPred</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Self energy. SpaceCharges are never the same object</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    ret -= alpha*<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(scip + x);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ret -= alpha*<a class="code" href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a>(scjp - x);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Interaction. We&#39;re only seeing one end of the double-ended connection</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// here, so multiply by two.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    ret -= 2 * alpha * (scip + <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>) * sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a2ac491236cad32ed0c0bd7d165ade867">fNeiPotential</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    ret -= 2 * alpha * (scjp - x) * scj-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a2ac491236cad32ed0c0bd7d165ade867">fNeiPotential</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// This miscounts if i and j are neighbours of each other</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code" href="../../de/d9f/classNeighbour.html">Neighbour</a>&amp; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>: sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a35da34028db45bdcb8e35cde8578ad35">fNeighbours</a>){</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span>(n.<a class="code" href="../../de/d9f/classNeighbour.html#a23c99243ede4910d69e436d0cedff87f">fSC</a> == scj){</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// If we detect that case, remove the erroneous terms</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        ret += 2 * alpha * (scip + <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>) * scjp * n.<a class="code" href="../../de/d9f/classNeighbour.html#a3c93fbb4bff95e0d0bf555481b84b1f1">fCoupling</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        ret += 2 * alpha * (scjp - x) * scip * n.<a class="code" href="../../de/d9f/classNeighbour.html#a3c93fbb4bff95e0d0bf555481b84b1f1">fCoupling</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// And replace with the correct interaction terms</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        ret -= 2 * alpha * (scip + <a class="code" href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a>) * (scjp - x) * n.<a class="code" href="../../de/d9f/classNeighbour.html#a3c93fbb4bff95e0d0bf555481b84b1f1">fCoupling</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a>* iwire1 = sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a6cc5873f3cd27f8d55d746699d433746">fWire1</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a>* jwire1 = scj-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#a6cc5873f3cd27f8d55d746699d433746">fWire1</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qi1 = iwire1 ? iwire1-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#afe8c029f4806769217bd5889371146fd">fCharge</a> : 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pi1 = iwire1 ? iwire1-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#aa5e36274abee0983af6c6380debe598b">fPred</a> : 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qj1 = jwire1 ? jwire1-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#afe8c029f4806769217bd5889371146fd">fCharge</a> : 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pj1 = jwire1 ? jwire1-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#aa5e36274abee0983af6c6380debe598b">fPred</a> : 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">if</span>(iwire1 == jwire1){</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// Same wire means movement of charge cancels itself out</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span>(iwire1) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qi1, pi1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span>(iwire1) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qi1, pi1 + x);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span>(jwire1) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qj1, pj1 - x);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a>* iwire2 = sci-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#adec355bdc2b5006992d1e1a990d13dec">fWire2</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a>* jwire2 = scj-&gt;<a class="code" href="../../d3/d3c/classSpaceCharge.html#adec355bdc2b5006992d1e1a990d13dec">fWire2</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qi2 = iwire2 ? iwire2-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#afe8c029f4806769217bd5889371146fd">fCharge</a> : 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pi2 = iwire2 ? iwire2-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#aa5e36274abee0983af6c6380debe598b">fPred</a> : 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qj2 = jwire2 ? jwire2-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#afe8c029f4806769217bd5889371146fd">fCharge</a> : 0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pj2 = jwire2 ? jwire2-&gt;<a class="code" href="../../de/d7d/classInductionWireHit.html#aa5e36274abee0983af6c6380debe598b">fPred</a> : 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span>(iwire2 == jwire2){</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span>(iwire2) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qi2, pi2);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span>(iwire2) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qi2, pi2 + x);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>(jwire2) ret += <a class="code" href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a>(qj2, pj2 - x);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="ttc" id="run__opflash__electron_8fcl_html_a6673f03521899f7844189bcfd8ee5941"><div class="ttname"><a href="../../d0/d84/run__opflash__electron_8fcl.html#a6673f03521899f7844189bcfd8ee5941">x</a></div><div class="ttdeci">process_name opflash particleana ie x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/run__opflash__electron_8fcl_source.html#l00090">run_opflash_electron.fcl:90</a></div></div>
<div class="ttc" id="classInductionWireHit_html_afe8c029f4806769217bd5889371146fd"><div class="ttname"><a href="../../de/d7d/classInductionWireHit.html#afe8c029f4806769217bd5889371146fd">InductionWireHit::fCharge</a></div><div class="ttdeci">double fCharge</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00025">Solver.h:25</a></div></div>
<div class="ttc" id="classInductionWireHit_html_aa5e36274abee0983af6c6380debe598b"><div class="ttname"><a href="../../de/d7d/classInductionWireHit.html#aa5e36274abee0983af6c6380debe598b">InductionWireHit::fPred</a></div><div class="ttdeci">double fPred</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00027">Solver.h:27</a></div></div>
<div class="ttc" id="classNeighbour_html_a3c93fbb4bff95e0d0bf555481b84b1f1"><div class="ttname"><a href="../../de/d9f/classNeighbour.html#a3c93fbb4bff95e0d0bf555481b84b1f1">Neighbour::fCoupling</a></div><div class="ttdeci">double fCoupling</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00037">Solver.h:37</a></div></div>
<div class="ttc" id="classSpaceCharge_html_a35da34028db45bdcb8e35cde8578ad35"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#a35da34028db45bdcb8e35cde8578ad35">SpaceCharge::fNeighbours</a></div><div class="ttdeci">std::vector&lt; Neighbour &gt; fNeighbours</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00056">Solver.h:56</a></div></div>
<div class="ttc" id="classSpaceCharge_html_a2ac491236cad32ed0c0bd7d165ade867"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#a2ac491236cad32ed0c0bd7d165ade867">SpaceCharge::fNeiPotential</a></div><div class="ttdeci">double fNeiPotential</div><div class="ttdoc">Neighbour-induced potential. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00059">Solver.h:59</a></div></div>
<div class="ttc" id="classSpaceCharge_html_adec355bdc2b5006992d1e1a990d13dec"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#adec355bdc2b5006992d1e1a990d13dec">SpaceCharge::fWire2</a></div><div class="ttdeci">InductionWireHit * fWire2</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00054">Solver.h:54</a></div></div>
<div class="ttc" id="classQuadExpr_html_aebd434d58928b2f8541f74e6be494421"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html#aebd434d58928b2f8541f74e6be494421">QuadExpr::X</a></div><div class="ttdeci">static QuadExpr X()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/QuadExpr_8cxx_source.html#l00008">QuadExpr.cxx:8</a></div></div>
<div class="ttc" id="ComputePi__module_8cc_html_a51cbff124162962a948e82258a33a415"><div class="ttname"><a href="../../d8/d39/ComputePi__module_8cc.html#a51cbff124162962a948e82258a33a415">sqr</a></div><div class="ttdeci">constexpr T sqr(T v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/ComputePi__module_8cc_source.html#l00097">ComputePi_module.cc:97</a></div></div>
<div class="ttc" id="classSpaceCharge_html_a6cc5873f3cd27f8d55d746699d433746"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#a6cc5873f3cd27f8d55d746699d433746">SpaceCharge::fWire1</a></div><div class="ttdeci">InductionWireHit * fWire1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00054">Solver.h:54</a></div></div>
<div class="ttc" id="Solver_8cxx_html_a19d8f202216830672ccbd944969dd958"><div class="ttname"><a href="../../d6/db4/Solver_8cxx.html#a19d8f202216830672ccbd944969dd958">Metric</a></div><div class="ttdeci">double Metric(double q, double p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/Solver_8cxx_source.html#l00071">Solver.cxx:71</a></div></div>
<div class="ttc" id="classNeighbour_html"><div class="ttname"><a href="../../de/d9f/classNeighbour.html">Neighbour</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00031">Solver.h:31</a></div></div>
<div class="ttc" id="classQuadExpr_html"><div class="ttname"><a href="../../d7/d0d/classQuadExpr.html">QuadExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d68/QuadExpr_8h_source.html#l00008">QuadExpr.h:8</a></div></div>
<div class="ttc" id="classSpaceCharge_html_ad1d56fb636c394847c29a317dc5f73ad"><div class="ttname"><a href="../../d3/d3c/classSpaceCharge.html#ad1d56fb636c394847c29a317dc5f73ad">SpaceCharge::fPred</a></div><div class="ttdeci">double fPred</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00058">Solver.h:58</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classInductionWireHit_html"><div class="ttname"><a href="../../de/d7d/classInductionWireHit.html">InductionWireHit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00017">Solver.h:17</a></div></div>
<div class="ttc" id="classNeighbour_html_a23c99243ede4910d69e436d0cedff87f"><div class="ttname"><a href="../../de/d9f/classNeighbour.html#a23c99243ede4910d69e436d0cedff87f">Neighbour::fSC</a></div><div class="ttdeci">SpaceCharge * fSC</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc5/Solver_8h_source.html#l00036">Solver.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5460807116ba31c68cebb735007ed494"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SolvePair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dc4/classCollectionWireHit.html">CollectionWireHit</a> *&#160;</td>
          <td class="paramname"><em>cwire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *&#160;</td>
          <td class="paramname"><em>sci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d3c/classSpaceCharge.html">SpaceCharge</a> *&#160;</td>
          <td class="paramname"><em>scj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
