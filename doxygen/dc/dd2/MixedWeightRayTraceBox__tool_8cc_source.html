<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MixedWeightRayTraceBox_tool.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_5f678ef99ea6f964b236b90db12a4ab6.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_9c2e8b3a7cfa1f7937f5a112e04e3409.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_1ffba7274604d06a154edb7c31d4b2fb.html">EventGenerator</a></li><li class="navelem"><a class="el" href="../../dir_d74c697a6a73baa0f5d1153b35f3b37c.html">MeVPrtl</a></li><li class="navelem"><a class="el" href="../../dir_3645f04d96c235a080c20e91e51881ed.html">Tools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MixedWeightRayTraceBox_tool.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Framework Includes</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;art/Persistency/Common/PtrMaker.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;art/Utilities/ToolMacros.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;cetlib/cpu_timer.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// local includes</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/deb/IRayTrace_8h.html">IRayTrace.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dbd/MeVPrtlFlux_8h.html">sbnobj/Common/EventGen/MeVPrtl/MeVPrtlFlux.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d45/Constants_8h.html">sbncode/EventGenerator/MeVPrtl/Tools/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// LArSoft includes</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d92/BoxBoundedGeo_8h.html">larcorealg/Geometry/BoxBoundedGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de7/GeometryCore_8h.html">larcorealg/Geometry/GeometryCore.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2e/ServiceUtil_8h.html">larcore/CoreUtils/ServiceUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// std includes</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// implementation follows</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span>evgen {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span>ldm {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// Helper struct retruned by some internal functions</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">   39</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> {</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">   40</a></span>&#160;  std::vector&lt;std::vector&lt;TVector3&gt;&gt; <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">allIntersections</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">   41</a></span>&#160;  std::vector&lt;TLorentzVector&gt; <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">allPrtlMom</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">   42</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">weight</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">   43</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">pass</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *  @brief  MixedWeightRayTraceBox class definiton</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html">   49</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html">MixedWeightRayTraceBox</a> : <span class="keyword">public</span> <a class="code" href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html">IRayTrace</a></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">     *  @brief  Constructor</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aadbbf9eaacf82f87def0d15b7cfae249">MixedWeightRayTraceBox</a>(fhicl::ParameterSet <span class="keyword">const</span> &amp;pset);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">     *  @brief  Destructor</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a4bc043fb3d7eecdfd17d2342dea7ead9">~MixedWeightRayTraceBox</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">configure</a>(<span class="keyword">const</span> fhicl::ParameterSet&amp;) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a14f53a6ecbf321de84e81415ca75db23">IntersectDetector</a>(<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, std::array&lt;TVector3, 2&gt; &amp;intersection, <span class="keywordtype">double</span> &amp;weight) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// always thrown at least once</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#abb44133e902e0f05982554cd914ef55b">   67</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#abb44133e902e0f05982554cd914ef55b">MaxWeight</a>()<span class="keyword"> override </span>{ </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">   72</a></span>&#160;  <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">   73</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">   74</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">   75</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">   76</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">   77</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">   79</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">   80</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">   81</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">   83</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">CalculateMaxWeight</a>();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  std::pair&lt;double, double&gt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">DeltaPhi</a>(TVector3 <a class="code" href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">origin</a>, TRotation &amp;R);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  TLorentzVector <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">ThrowFixedSuccess</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">ThrowFixedThrows</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;};</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// Helpers</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// Minimum Variance Unbiased Estimator for the Negative Binomial Distribution</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">   96</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">QEstimator</a>(<span class="keywordtype">unsigned</span> nsuccess, <span class="keywordtype">unsigned</span> nfail, <span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (nsuccess &lt; r) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">return</span> ((<span class="keywordtype">double</span>)(r - 1) / (r+nfail-1));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aadbbf9eaacf82f87def0d15b7cfae249">  102</a></span>&#160;<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aadbbf9eaacf82f87def0d15b7cfae249">MixedWeightRayTraceBox::MixedWeightRayTraceBox</a>(fhicl::ParameterSet <span class="keyword">const</span> &amp;pset):</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html">IMeVPrtlStage</a>(<span class="stringliteral">&quot;MixedWeightRayTraceBox&quot;</span>) </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this-&gt;<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">configure</a>(pset);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a4bc043fb3d7eecdfd17d2342dea7ead9">  110</a></span>&#160;<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a4bc043fb3d7eecdfd17d2342dea7ead9">MixedWeightRayTraceBox::~MixedWeightRayTraceBox</a>()</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">//------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">  115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">MixedWeightRayTraceBox::configure</a>(fhicl::ParameterSet <span class="keyword">const</span> &amp;pset)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (pset.has_key(<span class="stringliteral">&quot;Box&quot;</span>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    std::array&lt;double, 6&gt; box_config = pset.get&lt;std::array&lt;double, 6&gt;&gt;(<span class="stringliteral">&quot;Box&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// xmin, xmax, ymin, ymax, zmin, zmax</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a> = <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>(box_config[0], box_config[1], box_config[2], box_config[3], box_config[4], box_config[5]);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> *<a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#ad544178eb97bd705ef1dc4dc3e72b405">geometry</a> = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a> = geometry-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">DetectorEnclosureBox</a>(pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;Volume&quot;</span>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Detector Box.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;X &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">MinX</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">MaxX</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Y &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">MinY</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">MaxY</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Z &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">MinZ</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">MaxZ</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferenceLabSolidAngle&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferencePrtlMass&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;ReferenceScndPDG&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferenceKaonEnergy&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxWeightFudge&quot;</span>, 1.);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">CalculateMaxWeight</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a> = pset.get&lt;<span class="keywordtype">unsigned</span>&gt;(<span class="stringliteral">&quot;NThrow&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;FixNSuccess&quot;</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a> = pset.get&lt;<span class="keywordtype">unsigned</span>&gt;(<span class="stringliteral">&quot;NSuccess&quot;</span>, 2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">  146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">MixedWeightRayTraceBox::CalculateMaxWeight</a>() {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">double</span> kplus_mass = <a class="code" href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a4e701b1472af8294941b604d87c91e79">Constants::Instance</a>().<a class="code" href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a29e433efa8a67770a4c84fd987e9e666">kplus_mass</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> secondary_mass = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a3ece59c67b8783ba89e2d8eaa4528457">secPDG2Mass</a>(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa7df79d2a7fb1636430aab727d5b9a39">twobody_momentum</a>(kplus_mass, secondary_mass, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">double</span> beta = sqrt(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a>*<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a> - kplus_mass*kplus_mass) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// Doen&#39;t affect weight</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">double</span> rand = 1.;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// For the maxweight, make the kaon and daughter direction aligned</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>(1, 0, 0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  TVector3 boost(beta, 0., 0.);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> lab_frame_p, costh_rest, weight;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a> = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a6a04c2558cbc6972f5b5021d5607de00">calcPrtlRayWgt</a>(p, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a>, dir, boost, rand, lab_frame_p, costh_rest, weight);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (err) { <span class="comment">// Shouldn&#39;t happen</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;Weighted Ray Trace: Bad max weight calculation.&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// Normalize the weight</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Cap at 100% intersection probability</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a> = std::min(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a> * weight * <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a> / (4*M_PI), 1.);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">  173</a></span>&#160;TLorentzVector <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">MixedWeightRayTraceBox::ThrowMeVPrtlMomentum</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// Pick a direction vector with the parent-direction along the z-axis</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> costh = <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">GetRandom</a>()*2 - 1.;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">double</span> sinth = sqrt(1 - costh*costh);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>(cos(phi)*sinth, sin(phi)*sinth, costh);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// Rotate to the lab direction</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  dir = RInv * <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// make the mevprtl momentum this</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  TLorentzVector mevprtl_mom = flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  mevprtl_mom.Boost(-flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.BoostVector());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  mevprtl_mom = TLorentzVector(mevprtl_mom.P() * <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>, mevprtl_mom.E());</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// boost back</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  mevprtl_mom.Boost(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.BoostVector());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> mevprtl_mom;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">  194</a></span>&#160;std::pair&lt;double, double&gt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">MixedWeightRayTraceBox::DeltaPhi</a>(TVector3 <a class="code" href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">origin</a>, TRotation &amp;R) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// If the parent hits the detector, then delta-phi is 2Pi </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  TVector3 pdir = R.Inverse()*TVector3(0, 0, 1);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">GetIntersections</a>(origin, pdir).size()) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Parent Direction: &quot;</span> &lt;&lt; pdir.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pdir.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pdir.Z() &lt;&lt; <span class="stringliteral">&quot; at location: &quot;</span> &lt;&lt; origin.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; origin.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; origin.Z() &lt;&lt; <span class="stringliteral">&quot; hits detector!\n&quot;</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> {-M_PI, M_PI};</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// Iterate over all corners and compute the limits of Phi</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">double</span> phihi = -M_PI;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">double</span> philo = M_PI;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; 8; i++) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a> = (i &amp; 1) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">MaxX</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">MinX</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">double</span> Y = (i &amp; 2) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">MaxY</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">MinY</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">double</span> Z = (i &amp; 4) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">MaxZ</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">MinZ</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    TVector3 corner(X, Y, Z);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">double</span> phi = (R * (corner - <a class="code" href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">origin</a>)).Phi();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (phi &gt; phihi) phihi = phi;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (phi &lt; philo) philo = phi;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Now figure out if the bounds should go philo -&gt; phihi or phihi -&gt; philo</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// Whichever has the smaller length is correct</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">bool</span> order_is_up = (phihi - philo) &lt; (M_PI - phihi) + (philo + M_PI);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// If we should go phihi -&gt; philo switch them and re-order them around</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (!order_is_up) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FLIP PHILIM! &quot;</span> &lt;&lt; philo &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; phihi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">double</span> temp = phihi;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    phihi = philo + 2*M_PI;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    philo = temp;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">return</span> {philo, phihi};</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">  234</a></span>&#160;<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">MixedWeightRayTraceBox::ThrowFixedThrows</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> ret;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">unsigned</span> ithrow = 0;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">unsigned</span> nfail = 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">unsigned</span> nsuccess = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">while</span> (ithrow &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    ithrow ++;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    TLorentzVector mevprtl_mom = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    std::vector&lt;TVector3&gt; box_intersections = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">GetIntersections</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect(), mevprtl_mom.Vect().Unit());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Does this ray intersect the box?</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (box_intersections.size() != 2) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// if the ray points the wrong way, it doesn&#39;t intersect</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (mevprtl_mom.Vect().Unit().Dot((A - flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect()).Unit()) &lt; 0.) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// if we&#39;re here, we have a valid ray</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">allIntersections</a>.push_back(box_intersections);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">allPrtlMom</a>.push_back(mevprtl_mom);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    nsuccess ++;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NTHROW: &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NSUCCESS: &quot;</span> &lt;&lt; nsuccess &lt;&lt; std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;P: &quot;</span> &lt;&lt; (((double)nsuccess) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">weight</a> = ((double)nsuccess) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">pass</a> = nsuccess &gt; 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">  276</a></span>&#160;<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">MixedWeightRayTraceBox::ThrowFixedSuccess</a>(<span class="keyword">const</span> <a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, <span class="keywordtype">double</span> phi) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> ret;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">unsigned</span> ithrow = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">unsigned</span> nfail = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordtype">unsigned</span> nsuccess = 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">while</span> (nsuccess &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a> &amp;&amp; ithrow &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    ithrow ++;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    TLorentzVector mevprtl_mom = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    std::vector&lt;TVector3&gt; box_intersections = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">GetIntersections</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect(), mevprtl_mom.Vect().Unit());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Does this ray intersect the box?</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (box_intersections.size() != 2) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// if the ray points the wrong way, it doesn&#39;t intersect</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (mevprtl_mom.Vect().Unit().Dot((A - flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect()).Unit()) &lt; 0.) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// if we&#39;re here, we have a valid ray</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">allIntersections</a>.push_back(box_intersections);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">allPrtlMom</a>.push_back(mevprtl_mom);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    nsuccess ++;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NFAIL: &quot;</span> &lt;&lt; nfail &lt;&lt; std::endl;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NSUCCESS: &quot;</span> &lt;&lt; nsuccess &lt;&lt; std::endl;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Q: &quot;</span> &lt;&lt; <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">QEstimator</a>(nsuccess, nfail, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (nsuccess == <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">weight</a> = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">QEstimator</a>(nsuccess, nfail, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">pass</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">weight</a> = 0.;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    ret.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">pass</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a14f53a6ecbf321de84e81415ca75db23">  322</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a14f53a6ecbf321de84e81415ca75db23">MixedWeightRayTraceBox::IntersectDetector</a>(<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, std::array&lt;TVector3, 2&gt; &amp;intersection, <span class="keywordtype">double</span> &amp;weight) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// We want to pick an orientation in the lab frame (th, phi)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// that intersects with the detector. </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// In the lab frame, the angular distribution is not uniform. In the</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// parent-rest-rame (th&#39;, phi&#39;), it is. Picking directions in the </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// parent-rest-frame until a direction which hits the detector is very inefficient.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// We can draw from the lab frame and weight using d(th, phi) / d(th&#39;, phi&#39;).</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// (This is what is done for neutrino simulation). However, in the massive</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// case there is a (integrable) singularity which leads to an unbounded max weight.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// This is undesirable for the Monte-Carlo and makes application of a &quot;accept-reject&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// algorithm to de-weight impossible. </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// So here we apply a mixed algorithm. We pick (phi, th&#39;). I.e. we pick phi in the lab</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// frame (forced to hit the detector) and th&#39; in the parent-rest-frame. This reduces </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// the MC to one dimension instead of two, and so should be much more efficient. And,</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">// to weight we just need dphi/dphi&#39; = 1.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// Setup the axes so that the parent Momentum is along the z axis</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  TVector3 parent_dir = flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.Vect().Unit();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  TVector3 zdir(0, 0, 1);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  TVector3 perp_parent_dir = zdir.Cross(parent_dir);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a> = acos(parent_dir.Z());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  TRotation R;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Setup the rotation if we need to</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">if</span> (perp_parent_dir.Mag() &gt; 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-4) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    R.Rotate(-angle, perp_parent_dir);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  TRotation RInv = R.Inverse();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PARENT DIR: &quot;</span> &lt;&lt; parent_dir.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir.Z() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  TVector3 parent_dir_rotated = R * parent_dir;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PARENT DIR ROTATED: &quot;</span> &lt;&lt; parent_dir_rotated.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir_rotated.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir_rotated.Z() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// Compute the Delta Phi of the detector</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  std::pair&lt;double, double&gt; philim = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">DeltaPhi</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect(), R);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">double</span> philo = philim.first;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">double</span> phihi = philim.second;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PHILIM: &quot;</span> &lt;&lt; philo &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; phihi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;DELTAPHI: &quot;</span> &lt;&lt; (phihi - philo) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// Pick a phi</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">double</span> phi = <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">GetRandom</a>() * (phihi - philo) + philo;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;THISPHI: &quot;</span> &lt;&lt; phi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#aabcd6b22cdd9f4c3c9c394a72f90183a">info</a> = (<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a>) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">ThrowFixedSuccess</a>(flux, RInv, phi) : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">ThrowFixedThrows</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> (!info.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">pass</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">unsigned</span> ind = CLHEP::RandFlat::shootInt(<a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a32b9d4c9fde5f7716f228f58e24e5378">fEngine</a>, 0, info.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">allIntersections</a>.size()-1); <span class="comment">// inclusive?</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  TLorentzVector mevprtl_mom = info.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">allPrtlMom</a>[ind];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  std::vector&lt;TVector3&gt; box_intersections = info.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">allIntersections</a>[ind];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  TVector3 B = box_intersections[1];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// make sure that the flux start lies outside the detector</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> ((flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect() - <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>).Mag() &lt; (A-B).Mag() &amp;&amp; (flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect() - B).Mag() &lt; (A-B).Mag()) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;ReThrowRayTraceBox Exception&quot;</span>, <span class="stringliteral">&quot;Input mevprtl flux starts inside detector volume: &quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="stringliteral">&quot;MeVPrtl start At: (&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Z()) + <span class="stringliteral">&quot;). &quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="stringliteral">&quot;Intersection A At: &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.Z()) + <span class="stringliteral">&quot;). &quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="stringliteral">&quot;Intersection B At: &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.Z()) + <span class="stringliteral">&quot;).\n&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    );</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// weight from forcing phi</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordtype">double</span> phiweight = (phihi - philo) / (2*M_PI);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// Total weight</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  weight = phiweight * info.<a class="code" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">weight</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Final WEIGHT: &quot;</span> &lt;&lt; weight &lt;&lt; std::endl;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a> = mevprtl_mom;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// transform to beam-coord frame</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1a35e704f3a044e3a9ea700fee9524fc">mom_beamcoord</a> = mevprtl_mom;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1a35e704f3a044e3a9ea700fee9524fc">mom_beamcoord</a>.Boost(-flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.BoostVector()); <span class="comment">// Boost to kaon rest frame</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1a35e704f3a044e3a9ea700fee9524fc">mom_beamcoord</a>.Boost(flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a52f87d1c1120f1d833c2686efc7508f7">kmom_beamcoord</a>.BoostVector()); <span class="comment">// And to beam coordinate frame</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// Two boosts make a rotation!</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// Set the secondary 4-momentum</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">sec</a> = flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a> - flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a39a47e790310f6300a2a94b0b199bba2">sec_beamcoord</a> = flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a52f87d1c1120f1d833c2686efc7508f7">kmom_beamcoord</a> - flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1a35e704f3a044e3a9ea700fee9524fc">mom_beamcoord</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">if</span> ((flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect() - <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>).Mag() &lt; (flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">pos</a>.Vect() - B).Mag()) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    intersection = {<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>, B}; <span class="comment">// A is entry, B is exit</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    intersection = {B, A}; <span class="comment">// reversed</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Kaon 4P: &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">kmom</a>.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Selected Prtl 4P: &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">mom</a>.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Selected Scdy 4P: &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">sec</a>.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">sec</a>.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">sec</a>.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.<a class="code" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">sec</a>.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;DEFINE_ART_CLASS_TOOL(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html">MixedWeightRayTraceBox</a>)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;} <span class="comment">// namespace ldm</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;} <span class="comment">// namespace evgen</span></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac4476f77629dc0a22f5feac03fb259a7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">evgen::ldm::MixedWeightRayTraceBox::fReferenceScndPDG</a></div><div class="ttdeci">int fReferenceScndPDG</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00075">MixedWeightRayTraceBox_tool.cc:75</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a39a47e790310f6300a2a94b0b199bba2"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a39a47e790310f6300a2a94b0b199bba2">evgen::ldm::MeVPrtlFlux::sec_beamcoord</a></div><div class="ttdeci">TLorentzVector sec_beamcoord</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00017">MeVPrtlFlux.h:17</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9e9680ab19df22846d27cbc2a6f3ec6a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">evgen::ldm::MixedWeightRayTraceBox::fMaxWeightFudge</a></div><div class="ttdeci">double fMaxWeightFudge</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00077">MixedWeightRayTraceBox_tool.cc:77</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a4bc043fb3d7eecdfd17d2342dea7ead9"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a4bc043fb3d7eecdfd17d2342dea7ead9">evgen::ldm::MixedWeightRayTraceBox::~MixedWeightRayTraceBox</a></div><div class="ttdeci">~MixedWeightRayTraceBox()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00110">MixedWeightRayTraceBox_tool.cc:110</a></div></div>
<div class="ttc" id="structevgen_1_1ldm_1_1RayWeightInfo_html_a296ed5400494ba78255ccf7059db3317"><div class="ttname"><a href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a296ed5400494ba78255ccf7059db3317">evgen::ldm::RayWeightInfo::allPrtlMom</a></div><div class="ttdeci">std::vector&lt; TLorentzVector &gt; allPrtlMom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00041">MixedWeightRayTraceBox_tool.cc:41</a></div></div>
<div class="ttc" id="ServiceUtil_8h_html"><div class="ttname"><a href="../../d4/d2e/ServiceUtil_8h.html">ServiceUtil.h</a></div><div class="ttdoc">Utilities related to art service access. </div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_aa208834661f5314774c16fc97d4bbeb9"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">evgen::ldm::QEstimator</a></div><div class="ttdeci">double QEstimator(unsigned nsuccess, unsigned nfail, unsigned r)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00096">MixedWeightRayTraceBox_tool.cc:96</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a13c70a3315c57bdf536e7bd9f919955e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">evgen::ldm::MixedWeightRayTraceBox::ThrowFixedSuccess</a></div><div class="ttdeci">RayWeightInfo ThrowFixedSuccess(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00276">MixedWeightRayTraceBox_tool.cc:276</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_adcf2e4fcc32174cef7be5a7ceca6de0d"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#adcf2e4fcc32174cef7be5a7ceca6de0d">evgen::ldm::MeVPrtlFlux::mom</a></div><div class="ttdeci">TLorentzVector mom</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00014">MeVPrtlFlux.h:14</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_ad544178eb97bd705ef1dc4dc3e72b405"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#ad544178eb97bd705ef1dc4dc3e72b405">geometry</a></div><div class="ttdeci">const geo::GeometryCore * geometry</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00373">NuVertexChargeTree_module.cc:373</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a3ece59c67b8783ba89e2d8eaa4528457"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a3ece59c67b8783ba89e2d8eaa4528457">evgen::ldm::secPDG2Mass</a></div><div class="ttdeci">double secPDG2Mass(int pdg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00236">Constants.cpp:236</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac695a1d40f69b2b8665e046652d1d62e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">evgen::ldm::MixedWeightRayTraceBox::fNThrow</a></div><div class="ttdeci">unsigned fNThrow</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00079">MixedWeightRayTraceBox_tool.cc:79</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a1a35e704f3a044e3a9ea700fee9524fc"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1a35e704f3a044e3a9ea700fee9524fc">evgen::ldm::MeVPrtlFlux::mom_beamcoord</a></div><div class="ttdeci">TLorentzVector mom_beamcoord</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00015">MeVPrtlFlux.h:15</a></div></div>
<div class="ttc" id="namespaceevd_html_a911fe581afad27a720ee200bd61362a6"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">evd::err</a></div><div class="ttdeci">EResult err(const char *call)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2a/WebEVDServer_8cxx_source.html#l00140">WebEVDServer.cxx:140</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_afd042da19afb090ba80e93ee64d4dec5"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">geo::BoxBoundedGeo::MinX</a></div><div class="ttdeci">double MinX() const </div><div class="ttdoc">Returns the world x coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00088">BoxBoundedGeo.h:88</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad65f61eddd8ae3f03c1727507bac7b82"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">geo::GeometryCore::DetectorEnclosureBox</a></div><div class="ttdeci">geo::BoxBoundedGeo DetectorEnclosureBox(std::string const &amp;name=&quot;volDetEnclosure&quot;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00650">GeometryCore.cxx:650</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a80dabaf6ff35f8cdd0a512cffd92ae49"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">evgen::ldm::MixedWeightRayTraceBox::CalculateMaxWeight</a></div><div class="ttdeci">void CalculateMaxWeight()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00146">MixedWeightRayTraceBox_tool.cc:146</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a0df6401d1ecf390e674efc6479afd140"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">evgen::ldm::MixedWeightRayTraceBox::fFixNSuccess</a></div><div class="ttdeci">bool fFixNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00081">MixedWeightRayTraceBox_tool.cc:81</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_aa7df79d2a7fb1636430aab727d5b9a39"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#aa7df79d2a7fb1636430aab727d5b9a39">evgen::ldm::twobody_momentum</a></div><div class="ttdeci">double twobody_momentum(double parent_mass, double childA_mass, double childB_mass)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00073">Constants.cpp:73</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ae141949f30631ded82199f4375c21b7e"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">geo::BoxBoundedGeo::MaxX</a></div><div class="ttdeci">double MaxX() const </div><div class="ttdoc">Returns the world x coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00091">BoxBoundedGeo.h:91</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_abb44133e902e0f05982554cd914ef55b"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#abb44133e902e0f05982554cd914ef55b">evgen::ldm::MixedWeightRayTraceBox::MaxWeight</a></div><div class="ttdeci">double MaxWeight() override</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00067">MixedWeightRayTraceBox_tool.cc:67</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_aa79b3fd8e8d3fa8d791d75dbac3d4064"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">evgen::ldm::MixedWeightRayTraceBox::fReferenceKaonEnergy</a></div><div class="ttdeci">double fReferenceKaonEnergy</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00076">MixedWeightRayTraceBox_tool.cc:76</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_a32b9d4c9fde5f7716f228f58e24e5378"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a32b9d4c9fde5f7716f228f58e24e5378">evgen::ldm::IMeVPrtlStage::fEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine * fEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00079">IMeVPrtlStage.h:79</a></div></div>
<div class="ttc" id="GeometryCore_8h_html"><div class="ttname"><a href="../../db/de7/GeometryCore_8h.html">GeometryCore.h</a></div><div class="ttdoc">Access the description of detector geometry. </div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a59da5d5d36de55cb688b0af89db5ff9c"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a59da5d5d36de55cb688b0af89db5ff9c">evgen::ldm::MeVPrtlFlux::kmom</a></div><div class="ttdeci">TLorentzVector kmom</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00013">MeVPrtlFlux.h:13</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ab1276448a2ba9351f7b923db1e8fb1e7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">evgen::ldm::MixedWeightRayTraceBox::fReferenceLabSolidAngle</a></div><div class="ttdeci">double fReferenceLabSolidAngle</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00073">MixedWeightRayTraceBox_tool.cc:73</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a897eb98a5c5c5bd9325ee82ff3df3b87"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">evgen::ldm::MixedWeightRayTraceBox::ThrowFixedThrows</a></div><div class="ttdeci">RayWeightInfo ThrowFixedThrows(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00234">MixedWeightRayTraceBox_tool.cc:234</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a297740186a9d6825a4a05003c3d408b3"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">evgen::ldm::MixedWeightRayTraceBox::ThrowMeVPrtlMomentum</a></div><div class="ttdeci">TLorentzVector ThrowMeVPrtlMomentum(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00173">MixedWeightRayTraceBox_tool.cc:173</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1Constants_html_a29e433efa8a67770a4c84fd987e9e666"><div class="ttname"><a href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a29e433efa8a67770a4c84fd987e9e666">evgen::ldm::Constants::kplus_mass</a></div><div class="ttdeci">double kplus_mass</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d45/Constants_8h_source.html#l00028">Constants.h:28</a></div></div>
<div class="ttc" id="Constants_8h_html"><div class="ttname"><a href="../../d1/d45/Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a7e587da60c695749e2ec21f1e4f47661"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">evgen::ldm::MixedWeightRayTraceBox::fMaxWeight</a></div><div class="ttdeci">double fMaxWeight</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00083">MixedWeightRayTraceBox_tool.cc:83</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9692993194494126ac8163593a8f1134"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">evgen::ldm::MixedWeightRayTraceBox::fBox</a></div><div class="ttdeci">geo::BoxBoundedGeo fBox</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">MixedWeightRayTraceBox_tool.cc:72</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a67f01c76c031e29c5bcc610f23a0be85"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">geo::BoxBoundedGeo::MinZ</a></div><div class="ttdeci">double MinZ() const </div><div class="ttdoc">Returns the world z coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00118">BoxBoundedGeo.h:118</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_aadbbf9eaacf82f87def0d15b7cfae249"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aadbbf9eaacf82f87def0d15b7cfae249">evgen::ldm::MixedWeightRayTraceBox::MixedWeightRayTraceBox</a></div><div class="ttdeci">MixedWeightRayTraceBox(fhicl::ParameterSet const &amp;pset)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00102">MixedWeightRayTraceBox_tool.cc:102</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html">evgen::ldm::IMeVPrtlStage</a></div><div class="ttdoc">IMeVPrtlStage interface class definiton. General interface behind each stage. Provides random number ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00036">IMeVPrtlStage.h:36</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a></div><div class="ttdoc">Description of geometry of one entire detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01476">GeometryCore.h:1476</a></div></div>
<div class="ttc" id="MeVPrtlFlux_8h_html"><div class="ttname"><a href="../../d5/dbd/MeVPrtlFlux_8h.html">MeVPrtlFlux.h</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IRayTrace_html"><div class="ttname"><a href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html">evgen::ldm::IRayTrace</a></div><div class="ttdoc">IRayTrace interface class definiton. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/deb/IRayTrace_8h_source.html#l00039">IRayTrace.h:39</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a8573510798e85798bfdaae54d7a17a2d"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">evgen::ldm::MixedWeightRayTraceBox::configure</a></div><div class="ttdeci">void configure(const fhicl::ParameterSet &amp;) override</div><div class="ttdoc">Interface for configuring the particular algorithm tool. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00115">MixedWeightRayTraceBox_tool.cc:115</a></div></div>
<div class="ttc" id="structevgen_1_1ldm_1_1RayWeightInfo_html_aab8156ddca03b13a1c5b2ed5e6cdbe78"><div class="ttname"><a href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#aab8156ddca03b13a1c5b2ed5e6cdbe78">evgen::ldm::RayWeightInfo::weight</a></div><div class="ttdeci">double weight</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00042">MixedWeightRayTraceBox_tool.cc:42</a></div></div>
<div class="ttc" id="BoxBoundedGeo_8h_html"><div class="ttname"><a href="../../d9/d92/BoxBoundedGeo_8h.html">BoxBoundedGeo.h</a></div><div class="ttdoc">Provides a base class aware of world box coordinates. </div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a71626e62af098d6a8c09dd97bbf4812b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">geo::BoxBoundedGeo::MaxY</a></div><div class="ttdeci">double MaxY() const </div><div class="ttdoc">Returns the world y coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00106">BoxBoundedGeo.h:106</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1Constants_html_a4e701b1472af8294941b604d87c91e79"><div class="ttname"><a href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a4e701b1472af8294941b604d87c91e79">evgen::ldm::Constants::Instance</a></div><div class="ttdeci">static const Constants &amp; Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d45/Constants_8h_source.html#l00068">Constants.h:68</a></div></div>
<div class="ttc" id="structevgen_1_1ldm_1_1RayWeightInfo_html"><div class="ttname"><a href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">evgen::ldm::RayWeightInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00039">MixedWeightRayTraceBox_tool.cc:39</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_af2b55701a3d3ea31c426176843c377aa"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">evgen::ldm::MixedWeightRayTraceBox::fReferencePrtlMass</a></div><div class="ttdeci">double fReferencePrtlMass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00074">MixedWeightRayTraceBox_tool.cc:74</a></div></div>
<div class="ttc" id="structevgen_1_1ldm_1_1RayWeightInfo_html_a4ed770ac97ca23c8dc28a25ad2c8f2b9"><div class="ttname"><a href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a4ed770ac97ca23c8dc28a25ad2c8f2b9">evgen::ldm::RayWeightInfo::allIntersections</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TVector3 &gt; &gt; allIntersections</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00040">MixedWeightRayTraceBox_tool.cc:40</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a></div><div class="ttdoc">A base class aware of world box coordinatesAn object describing a simple shape can inherit from this ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00033">BoxBoundedGeo.h:33</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00115">WindowPattern.h:115</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_aff3c6d62c880e387d35ab093bdbdcffc"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">geo::BoxBoundedGeo::MaxZ</a></div><div class="ttdeci">double MaxZ() const </div><div class="ttdoc">Returns the world z coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00121">BoxBoundedGeo.h:121</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a1d711334523448561e99baaa2f0bdf50"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1d711334523448561e99baaa2f0bdf50">evgen::ldm::MeVPrtlFlux::pos</a></div><div class="ttdeci">TLorentzVector pos</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00011">MeVPrtlFlux.h:11</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ab65b62b7003d7806a8c700d2f690a14b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">geo::BoxBoundedGeo::GetIntersections</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; GetIntersections(TVector3 const &amp;TrajectoryStart, TVector3 const &amp;TrajectoryDirect) const </div><div class="ttdoc">Calculates the entry and exit points of a trajectory on the box surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d09/BoxBoundedGeo_8cxx_source.html#l00126">BoxBoundedGeo.cxx:126</a></div></div>
<div class="ttc" id="structevgen_1_1ldm_1_1RayWeightInfo_html_a39dc426075b0a3e0d3e4c6ca2c94f0aa"><div class="ttname"><a href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html#a39dc426075b0a3e0d3e4c6ca2c94f0aa">evgen::ldm::RayWeightInfo::pass</a></div><div class="ttdeci">bool pass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00043">MixedWeightRayTraceBox_tool.cc:43</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a14f53a6ecbf321de84e81415ca75db23"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a14f53a6ecbf321de84e81415ca75db23">evgen::ldm::MixedWeightRayTraceBox::IntersectDetector</a></div><div class="ttdeci">bool IntersectDetector(MeVPrtlFlux &amp;flux, std::array&lt; TVector3, 2 &gt; &amp;intersection, double &amp;weight) override</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00322">MixedWeightRayTraceBox_tool.cc:322</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html">evgen::ldm::MixedWeightRayTraceBox</a></div><div class="ttdoc">MixedWeightRayTraceBox class definiton. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00049">MixedWeightRayTraceBox_tool.cc:49</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_abfae2e504dfa44c403614b6cd601f99e"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a></div><div class="ttdeci">finds tracks best matching by angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00064">trackfinderalgorithms.fcl:64</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="IRayTrace_8h_html"><div class="ttname"><a href="../../d8/deb/IRayTrace_8h.html">IRayTrace.h</a></div><div class="ttdoc">This provides an interface for an art tool which ray traces &amp;quot;Prtl&amp;quot; (massive) particles from their pro...</div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_abc0cab4f0fcd826d11aaa8b3dfb2de02"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">geo::BoxBoundedGeo::MinY</a></div><div class="ttdeci">double MinY() const </div><div class="ttdoc">Returns the world y coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00103">BoxBoundedGeo.h:103</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a52f87d1c1120f1d833c2686efc7508f7"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a52f87d1c1120f1d833c2686efc7508f7">evgen::ldm::MeVPrtlFlux::kmom_beamcoord</a></div><div class="ttdeci">TLorentzVector kmom_beamcoord</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00012">MeVPrtlFlux.h:12</a></div></div>
<div class="ttc" id="condor__lar__pubs_8sh_html_aace24c54f354f24f1dec3b4fd3a15d10"><div class="ttname"><a href="../../da/dc6/condor__lar__pubs_8sh.html#aace24c54f354f24f1dec3b4fd3a15d10">r</a></div><div class="ttdeci">esac echo uname r</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc6/condor__lar__pubs_8sh_source.html#l00698">condor_lar_pubs.sh:698</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a1fdecaa2baebf8476e8b152f5836cd3a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">evgen::ldm::MixedWeightRayTraceBox::fNSuccess</a></div><div class="ttdeci">unsigned fNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00080">MixedWeightRayTraceBox_tool.cc:80</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_afe4744bee473ef3740e170ebf196d063"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">evgen::ldm::IMeVPrtlStage::GetRandom</a></div><div class="ttdeci">double GetRandom()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00072">IMeVPrtlStage.h:72</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">evgen::ldm::MeVPrtlFlux</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00008">MeVPrtlFlux.h:8</a></div></div>
<div class="ttc" id="namespacegeo_html_a6155d04d62c8bb11135137324ab26b5c"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">geo::origin</a></div><div class="ttdeci">constexpr Point origin()</div><div class="ttdoc">Returns a origin position with a point of the specified type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00227">geo_vectors.h:227</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac96bf9a3a8adcc5ff3428044bc1ae82b"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">evgen::ldm::MixedWeightRayTraceBox::DeltaPhi</a></div><div class="ttdeci">std::pair&lt; double, double &gt; DeltaPhi(TVector3 origin, TRotation &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00194">MixedWeightRayTraceBox_tool.cc:194</a></div></div>
<div class="ttc" id="namespacesortDataLoggerFiles_html_aabcd6b22cdd9f4c3c9c394a72f90183a"><div class="ttname"><a href="../../d3/d46/namespacesortDataLoggerFiles.html#aabcd6b22cdd9f4c3c9c394a72f90183a">sortDataLoggerFiles.info</a></div><div class="ttdeci">tuple info</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc8/sortDataLoggerFiles_8py_source.html#l00393">sortDataLoggerFiles.py:393</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MeVPrtlFlux_html_a1b524103945bd2797a5d0dcb36884d20"><div class="ttname"><a href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html#a1b524103945bd2797a5d0dcb36884d20">evgen::ldm::MeVPrtlFlux::sec</a></div><div class="ttdeci">TLorentzVector sec</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbd/MeVPrtlFlux_8h_source.html#l00016">MeVPrtlFlux.h:16</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a6a04c2558cbc6972f5b5021d5607de00"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a6a04c2558cbc6972f5b5021d5607de00">evgen::ldm::calcPrtlRayWgt</a></div><div class="ttdeci">int calcPrtlRayWgt(double rest_frame_p, double M, TVector3 dir, TVector3 boost, double rand, double &amp;lab_frame_p_out, double &amp;costh_rest_out, double &amp;wgt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00102">Constants.cpp:102</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
