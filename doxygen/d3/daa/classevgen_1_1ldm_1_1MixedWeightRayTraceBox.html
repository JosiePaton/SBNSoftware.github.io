<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>evgen::ldm::MixedWeightRayTraceBox Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d4/d4d/namespaceevgen.html">evgen</a></li><li class="navelem"><a class="el" href="../../d7/df2/namespaceevgen_1_1ldm.html">ldm</a></li><li class="navelem"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html">MixedWeightRayTraceBox</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d9/da6/classevgen_1_1ldm_1_1MixedWeightRayTraceBox-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">evgen::ldm::MixedWeightRayTraceBox Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html" title="MixedWeightRayTraceBox class definiton. ">MixedWeightRayTraceBox</a> class definiton.  
 <a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for evgen::ldm::MixedWeightRayTraceBox:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.png" usemap="#evgen::ldm::MixedWeightRayTraceBox_map" alt=""/>
  <map id="evgen::ldm::MixedWeightRayTraceBox_map" name="evgen::ldm::MixedWeightRayTraceBox_map">
<area href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html" title="IRayTrace interface class definiton. " alt="evgen::ldm::IRayTrace" shape="rect" coords="0,56,226,80"/>
<area href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html" title="IMeVPrtlStage interface class definiton. General interface behind each stage. Provides random number ..." alt="evgen::ldm::IMeVPrtlStage" shape="rect" coords="0,0,226,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aadbbf9eaacf82f87def0d15b7cfae249"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aadbbf9eaacf82f87def0d15b7cfae249">MixedWeightRayTraceBox</a> (fhicl::ParameterSet const &amp;pset)</td></tr>
<tr class="memdesc:aadbbf9eaacf82f87def0d15b7cfae249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#aadbbf9eaacf82f87def0d15b7cfae249">More...</a><br/></td></tr>
<tr class="separator:aadbbf9eaacf82f87def0d15b7cfae249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc043fb3d7eecdfd17d2342dea7ead9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a4bc043fb3d7eecdfd17d2342dea7ead9">~MixedWeightRayTraceBox</a> ()</td></tr>
<tr class="memdesc:a4bc043fb3d7eecdfd17d2342dea7ead9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a4bc043fb3d7eecdfd17d2342dea7ead9">More...</a><br/></td></tr>
<tr class="separator:a4bc043fb3d7eecdfd17d2342dea7ead9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8573510798e85798bfdaae54d7a17a2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">configure</a> (const fhicl::ParameterSet &amp;) override</td></tr>
<tr class="memdesc:a8573510798e85798bfdaae54d7a17a2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for configuring the particular algorithm tool.  <a href="#a8573510798e85798bfdaae54d7a17a2d">More...</a><br/></td></tr>
<tr class="separator:a8573510798e85798bfdaae54d7a17a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f53a6ecbf321de84e81415ca75db23"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a14f53a6ecbf321de84e81415ca75db23">IntersectDetector</a> (<a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, <a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; TVector3, 2 &gt; &amp;intersection, double &amp;weight) override</td></tr>
<tr class="separator:a14f53a6ecbf321de84e81415ca75db23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb44133e902e0f05982554cd914ef55b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#abb44133e902e0f05982554cd914ef55b">MaxWeight</a> () override</td></tr>
<tr class="separator:abb44133e902e0f05982554cd914ef55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classevgen_1_1ldm_1_1IRayTrace"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classevgen_1_1ldm_1_1IRayTrace')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html">evgen::ldm::IRayTrace</a></td></tr>
<tr class="memitem:aeace099d37391a325fbcf31b8c83dd87 inherit pub_methods_classevgen_1_1ldm_1_1IRayTrace"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html#aeace099d37391a325fbcf31b8c83dd87">~IRayTrace</a> () noexcept=<a class="el" href="../../de/d36/crtt0matchingalg__sbnd_8fcl.html#a6c2384a9e3f7a8c21ae6f762a8ee0ece">default</a></td></tr>
<tr class="memdesc:aeace099d37391a325fbcf31b8c83dd87 inherit pub_methods_classevgen_1_1ldm_1_1IRayTrace"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual Destructor.  <a href="#aeace099d37391a325fbcf31b8c83dd87">More...</a><br/></td></tr>
<tr class="separator:aeace099d37391a325fbcf31b8c83dd87 inherit pub_methods_classevgen_1_1ldm_1_1IRayTrace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html">evgen::ldm::IMeVPrtlStage</a></td></tr>
<tr class="memitem:a1c3c6cd3ed311b02871142858d0beb84 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a1c3c6cd3ed311b02871142858d0beb84">~IMeVPrtlStage</a> () noexcept</td></tr>
<tr class="memdesc:a1c3c6cd3ed311b02871142858d0beb84 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual Destructor.  <a href="#a1c3c6cd3ed311b02871142858d0beb84">More...</a><br/></td></tr>
<tr class="separator:a1c3c6cd3ed311b02871142858d0beb84 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a209f718f943aeba71952e03bae9e2565 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a209f718f943aeba71952e03bae9e2565">IMeVPrtlStage</a> (const char *<a class="el" href="../../d6/d30/sbndpoms__genfclwithrunnumber__maker_8sh.html#a19dd16849ed641adb2aff777fdc4bd8b">name</a>)</td></tr>
<tr class="separator:a209f718f943aeba71952e03bae9e2565 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e17842528caeaaabceb581a8a44340 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#ae1e17842528caeaaabceb581a8a44340">RandomUnitVector</a> ()</td></tr>
<tr class="separator:ae1e17842528caeaaabceb581a8a44340 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4744bee473ef3740e170ebf196d063 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">GetRandom</a> ()</td></tr>
<tr class="separator:afe4744bee473ef3740e170ebf196d063 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8458dc55703f5fa6d21ce26d02b5d0c7 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a8458dc55703f5fa6d21ce26d02b5d0c7">Name</a> ()</td></tr>
<tr class="separator:a8458dc55703f5fa6d21ce26d02b5d0c7 inherit pub_methods_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a80dabaf6ff35f8cdd0a512cffd92ae49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">CalculateMaxWeight</a> ()</td></tr>
<tr class="separator:a80dabaf6ff35f8cdd0a512cffd92ae49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac96bf9a3a8adcc5ff3428044bc1ae82b"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">DeltaPhi</a> (TVector3 origin, TRotation &amp;R)</td></tr>
<tr class="separator:ac96bf9a3a8adcc5ff3428044bc1ae82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a297740186a9d6825a4a05003c3d408b3"><td class="memItemLeft" align="right" valign="top">TLorentzVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a> (const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, double phi)</td></tr>
<tr class="separator:a297740186a9d6825a4a05003c3d408b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13c70a3315c57bdf536e7bd9f919955e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">ThrowFixedSuccess</a> (const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, double phi)</td></tr>
<tr class="separator:a13c70a3315c57bdf536e7bd9f919955e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897eb98a5c5c5bd9325ee82ff3df3b87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">ThrowFixedThrows</a> (const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;flux, TRotation &amp;RInv, double phi)</td></tr>
<tr class="separator:a897eb98a5c5c5bd9325ee82ff3df3b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9692993194494126ac8163593a8f1134"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a></td></tr>
<tr class="separator:a9692993194494126ac8163593a8f1134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1276448a2ba9351f7b923db1e8fb1e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a></td></tr>
<tr class="separator:ab1276448a2ba9351f7b923db1e8fb1e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b55701a3d3ea31c426176843c377aa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a></td></tr>
<tr class="separator:af2b55701a3d3ea31c426176843c377aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4476f77629dc0a22f5feac03fb259a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a></td></tr>
<tr class="separator:ac4476f77629dc0a22f5feac03fb259a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79b3fd8e8d3fa8d791d75dbac3d4064"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a></td></tr>
<tr class="separator:aa79b3fd8e8d3fa8d791d75dbac3d4064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9680ab19df22846d27cbc2a6f3ec6a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a></td></tr>
<tr class="separator:a9e9680ab19df22846d27cbc2a6f3ec6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac695a1d40f69b2b8665e046652d1d62e"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a></td></tr>
<tr class="separator:ac695a1d40f69b2b8665e046652d1d62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fdecaa2baebf8476e8b152f5836cd3a"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a></td></tr>
<tr class="separator:a1fdecaa2baebf8476e8b152f5836cd3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0df6401d1ecf390e674efc6479afd140"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a></td></tr>
<tr class="separator:a0df6401d1ecf390e674efc6479afd140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e587da60c695749e2ec21f1e4f47661"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a></td></tr>
<tr class="separator:a7e587da60c695749e2ec21f1e4f47661"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html">evgen::ldm::IMeVPrtlStage</a></td></tr>
<tr class="memitem:a32b9d4c9fde5f7716f228f58e24e5378 inherit pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">CLHEP::HepRandomEngine *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a32b9d4c9fde5f7716f228f58e24e5378">fEngine</a></td></tr>
<tr class="separator:a32b9d4c9fde5f7716f228f58e24e5378 inherit pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacce049c8ae87067362015d4197b98d4 inherit pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#aacce049c8ae87067362015d4197b98d4">fName</a></td></tr>
<tr class="separator:aacce049c8ae87067362015d4197b98d4 inherit pro_attribs_classevgen_1_1ldm_1_1IMeVPrtlStage"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html" title="MixedWeightRayTraceBox class definiton. ">MixedWeightRayTraceBox</a> class definiton. </p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00049">49</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aadbbf9eaacf82f87def0d15b7cfae249"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">evgen::ldm::MixedWeightRayTraceBox::MixedWeightRayTraceBox </td>
          <td>(</td>
          <td class="paramtype">fhicl::ParameterSet const &amp;&#160;</td>
          <td class="paramname"><em>pset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00102">102</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                                           :</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a209f718f943aeba71952e03bae9e2565">IMeVPrtlStage</a>(<span class="stringliteral">&quot;MixedWeightRayTraceBox&quot;</span>) </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this-&gt;<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">configure</a>(pset);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a8573510798e85798bfdaae54d7a17a2d"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a8573510798e85798bfdaae54d7a17a2d">evgen::ldm::MixedWeightRayTraceBox::configure</a></div><div class="ttdeci">void configure(const fhicl::ParameterSet &amp;) override</div><div class="ttdoc">Interface for configuring the particular algorithm tool. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00115">MixedWeightRayTraceBox_tool.cc:115</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_a209f718f943aeba71952e03bae9e2565"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a209f718f943aeba71952e03bae9e2565">evgen::ldm::IMeVPrtlStage::IMeVPrtlStage</a></div><div class="ttdeci">IMeVPrtlStage(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00046">IMeVPrtlStage.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4bc043fb3d7eecdfd17d2342dea7ead9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">evgen::ldm::MixedWeightRayTraceBox::~MixedWeightRayTraceBox </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00110">110</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a80dabaf6ff35f8cdd0a512cffd92ae49"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::ldm::MixedWeightRayTraceBox::CalculateMaxWeight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00146">146</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                                {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">double</span> kplus_mass = <a class="code" href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a4e701b1472af8294941b604d87c91e79">Constants::Instance</a>().<a class="code" href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a29e433efa8a67770a4c84fd987e9e666">kplus_mass</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> secondary_mass = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a3ece59c67b8783ba89e2d8eaa4528457">secPDG2Mass</a>(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa7df79d2a7fb1636430aab727d5b9a39">twobody_momentum</a>(kplus_mass, secondary_mass, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">double</span> beta = sqrt(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a>*<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a> - kplus_mass*kplus_mass) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// Doen&#39;t affect weight</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">double</span> rand = 1.;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// For the maxweight, make the kaon and daughter direction aligned</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>(1, 0, 0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  TVector3 boost(beta, 0., 0.);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> lab_frame_p, costh_rest, weight;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">err</a> = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#a6a04c2558cbc6972f5b5021d5607de00">calcPrtlRayWgt</a>(p, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a>, <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>, boost, rand, lab_frame_p, costh_rest, weight);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (err) { <span class="comment">// Shouldn&#39;t happen</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;Weighted Ray Trace: Bad max weight calculation.&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// Normalize the weight</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Cap at 100% intersection probability</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a> = std::min(<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a> * weight * <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a> / (4*M_PI), 1.);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac4476f77629dc0a22f5feac03fb259a7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">evgen::ldm::MixedWeightRayTraceBox::fReferenceScndPDG</a></div><div class="ttdeci">int fReferenceScndPDG</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00075">MixedWeightRayTraceBox_tool.cc:75</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9e9680ab19df22846d27cbc2a6f3ec6a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">evgen::ldm::MixedWeightRayTraceBox::fMaxWeightFudge</a></div><div class="ttdeci">double fMaxWeightFudge</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00077">MixedWeightRayTraceBox_tool.cc:77</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a3ece59c67b8783ba89e2d8eaa4528457"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a3ece59c67b8783ba89e2d8eaa4528457">evgen::ldm::secPDG2Mass</a></div><div class="ttdeci">double secPDG2Mass(int pdg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00236">Constants.cpp:236</a></div></div>
<div class="ttc" id="namespaceevd_html_a911fe581afad27a720ee200bd61362a6"><div class="ttname"><a href="../../da/d2d/namespaceevd.html#a911fe581afad27a720ee200bd61362a6">evd::err</a></div><div class="ttdeci">EResult err(const char *call)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2a/WebEVDServer_8cxx_source.html#l00140">WebEVDServer.cxx:140</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_aa7df79d2a7fb1636430aab727d5b9a39"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#aa7df79d2a7fb1636430aab727d5b9a39">evgen::ldm::twobody_momentum</a></div><div class="ttdeci">double twobody_momentum(double parent_mass, double childA_mass, double childB_mass)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00073">Constants.cpp:73</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_aa79b3fd8e8d3fa8d791d75dbac3d4064"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">evgen::ldm::MixedWeightRayTraceBox::fReferenceKaonEnergy</a></div><div class="ttdeci">double fReferenceKaonEnergy</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00076">MixedWeightRayTraceBox_tool.cc:76</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ab1276448a2ba9351f7b923db1e8fb1e7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">evgen::ldm::MixedWeightRayTraceBox::fReferenceLabSolidAngle</a></div><div class="ttdeci">double fReferenceLabSolidAngle</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00073">MixedWeightRayTraceBox_tool.cc:73</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1Constants_html_a29e433efa8a67770a4c84fd987e9e666"><div class="ttname"><a href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a29e433efa8a67770a4c84fd987e9e666">evgen::ldm::Constants::kplus_mass</a></div><div class="ttdeci">double kplus_mass</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d45/Constants_8h_source.html#l00028">Constants.h:28</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a7e587da60c695749e2ec21f1e4f47661"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">evgen::ldm::MixedWeightRayTraceBox::fMaxWeight</a></div><div class="ttdeci">double fMaxWeight</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00083">MixedWeightRayTraceBox_tool.cc:83</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1Constants_html_a4e701b1472af8294941b604d87c91e79"><div class="ttname"><a href="../../dd/dce/classevgen_1_1ldm_1_1Constants.html#a4e701b1472af8294941b604d87c91e79">evgen::ldm::Constants::Instance</a></div><div class="ttdeci">static const Constants &amp; Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d45/Constants_8h_source.html#l00068">Constants.h:68</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_af2b55701a3d3ea31c426176843c377aa"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">evgen::ldm::MixedWeightRayTraceBox::fReferencePrtlMass</a></div><div class="ttdeci">double fReferencePrtlMass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00074">MixedWeightRayTraceBox_tool.cc:74</a></div></div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_a6a04c2558cbc6972f5b5021d5607de00"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#a6a04c2558cbc6972f5b5021d5607de00">evgen::ldm::calcPrtlRayWgt</a></div><div class="ttdeci">int calcPrtlRayWgt(double rest_frame_p, double M, TVector3 dir, TVector3 boost, double rand, double &amp;lab_frame_p_out, double &amp;costh_rest_out, double &amp;wgt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/Constants_8cpp_source.html#l00102">Constants.cpp:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8573510798e85798bfdaae54d7a17a2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void evgen::ldm::MixedWeightRayTraceBox::configure </td>
          <td>(</td>
          <td class="paramtype">const fhicl::ParameterSet &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interface for configuring the particular algorithm tool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParameterSet</td><td>The input set of parameters for configuration </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a0a76be2fce3174d8b4d7e93c78afcacf">evgen::ldm::IMeVPrtlStage</a>.</p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00115">115</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (pset.has_key(<span class="stringliteral">&quot;Box&quot;</span>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    std::array&lt;double, 6&gt; box_config = pset.get&lt;std::array&lt;double, 6&gt;&gt;(<span class="stringliteral">&quot;Box&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// xmin, xmax, ymin, ymax, zmin, zmax</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a> = <a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a>(box_config[0], box_config[1], box_config[2], box_config[3], box_config[4], box_config[5]);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a> *<a class="code" href="../../dd/d33/NuVertexChargeTree__module_8cc.html#ad544178eb97bd705ef1dc4dc3e72b405">geometry</a> = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a> = geometry-&gt;<a class="code" href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">DetectorEnclosureBox</a>(pset.get&lt;std::string&gt;(<span class="stringliteral">&quot;Volume&quot;</span>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Detector Box.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;X &quot;</span> &lt;&lt; fBox.MinX() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; fBox.MaxX() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Y &quot;</span> &lt;&lt; fBox.MinY() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; fBox.MaxY() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Z &quot;</span> &lt;&lt; fBox.MinZ() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; fBox.MaxZ() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">fReferenceLabSolidAngle</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferenceLabSolidAngle&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">fReferencePrtlMass</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferencePrtlMass&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">fReferenceScndPDG</a> = pset.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;ReferenceScndPDG&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">fReferenceKaonEnergy</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ReferenceKaonEnergy&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">fMaxWeightFudge</a> = pset.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;MaxWeightFudge&quot;</span>, 1.);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">CalculateMaxWeight</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a> = pset.get&lt;<span class="keywordtype">unsigned</span>&gt;(<span class="stringliteral">&quot;NThrow&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a> = pset.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;FixNSuccess&quot;</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a> = pset.get&lt;<span class="keywordtype">unsigned</span>&gt;(<span class="stringliteral">&quot;NSuccess&quot;</span>, 2);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac4476f77629dc0a22f5feac03fb259a7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac4476f77629dc0a22f5feac03fb259a7">evgen::ldm::MixedWeightRayTraceBox::fReferenceScndPDG</a></div><div class="ttdeci">int fReferenceScndPDG</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00075">MixedWeightRayTraceBox_tool.cc:75</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9e9680ab19df22846d27cbc2a6f3ec6a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9e9680ab19df22846d27cbc2a6f3ec6a">evgen::ldm::MixedWeightRayTraceBox::fMaxWeightFudge</a></div><div class="ttdeci">double fMaxWeightFudge</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00077">MixedWeightRayTraceBox_tool.cc:77</a></div></div>
<div class="ttc" id="NuVertexChargeTree__module_8cc_html_ad544178eb97bd705ef1dc4dc3e72b405"><div class="ttname"><a href="../../dd/d33/NuVertexChargeTree__module_8cc.html#ad544178eb97bd705ef1dc4dc3e72b405">geometry</a></div><div class="ttdeci">const geo::GeometryCore * geometry</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/NuVertexChargeTree__module_8cc_source.html#l00373">NuVertexChargeTree_module.cc:373</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac695a1d40f69b2b8665e046652d1d62e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">evgen::ldm::MixedWeightRayTraceBox::fNThrow</a></div><div class="ttdeci">unsigned fNThrow</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00079">MixedWeightRayTraceBox_tool.cc:79</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html_ad65f61eddd8ae3f03c1727507bac7b82"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html#ad65f61eddd8ae3f03c1727507bac7b82">geo::GeometryCore::DetectorEnclosureBox</a></div><div class="ttdeci">geo::BoxBoundedGeo DetectorEnclosureBox(std::string const &amp;name=&quot;volDetEnclosure&quot;) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6a/GeometryCore_8cxx_source.html#l00629">GeometryCore.cxx:629</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a80dabaf6ff35f8cdd0a512cffd92ae49"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a80dabaf6ff35f8cdd0a512cffd92ae49">evgen::ldm::MixedWeightRayTraceBox::CalculateMaxWeight</a></div><div class="ttdeci">void CalculateMaxWeight()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00146">MixedWeightRayTraceBox_tool.cc:146</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a0df6401d1ecf390e674efc6479afd140"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">evgen::ldm::MixedWeightRayTraceBox::fFixNSuccess</a></div><div class="ttdeci">bool fFixNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00081">MixedWeightRayTraceBox_tool.cc:81</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_aa79b3fd8e8d3fa8d791d75dbac3d4064"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#aa79b3fd8e8d3fa8d791d75dbac3d4064">evgen::ldm::MixedWeightRayTraceBox::fReferenceKaonEnergy</a></div><div class="ttdeci">double fReferenceKaonEnergy</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00076">MixedWeightRayTraceBox_tool.cc:76</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ab1276448a2ba9351f7b923db1e8fb1e7"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ab1276448a2ba9351f7b923db1e8fb1e7">evgen::ldm::MixedWeightRayTraceBox::fReferenceLabSolidAngle</a></div><div class="ttdeci">double fReferenceLabSolidAngle</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00073">MixedWeightRayTraceBox_tool.cc:73</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9692993194494126ac8163593a8f1134"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">evgen::ldm::MixedWeightRayTraceBox::fBox</a></div><div class="ttdeci">geo::BoxBoundedGeo fBox</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">MixedWeightRayTraceBox_tool.cc:72</a></div></div>
<div class="ttc" id="classgeo_1_1GeometryCore_html"><div class="ttname"><a href="../../d7/d63/classgeo_1_1GeometryCore.html">geo::GeometryCore</a></div><div class="ttdoc">Description of geometry of one entire detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de7/GeometryCore_8h_source.html#l01468">GeometryCore.h:1468</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_af2b55701a3d3ea31c426176843c377aa"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#af2b55701a3d3ea31c426176843c377aa">evgen::ldm::MixedWeightRayTraceBox::fReferencePrtlMass</a></div><div class="ttdeci">double fReferencePrtlMass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00074">MixedWeightRayTraceBox_tool.cc:74</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a></div><div class="ttdoc">A base class aware of world box coordinatesAn object describing a simple shape can inherit from this ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00033">BoxBoundedGeo.h:33</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a1fdecaa2baebf8476e8b152f5836cd3a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">evgen::ldm::MixedWeightRayTraceBox::fNSuccess</a></div><div class="ttdeci">unsigned fNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00080">MixedWeightRayTraceBox_tool.cc:80</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac96bf9a3a8adcc5ff3428044bc1ae82b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; evgen::ldm::MixedWeightRayTraceBox::DeltaPhi </td>
          <td>(</td>
          <td class="paramtype">TVector3&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TRotation &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00194">194</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                                                      {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Iterate over all corners and compute the limits of Phi</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">double</span> phihi = -M_PI;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">double</span> philo = M_PI;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; 8; i++) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a> = (i &amp; 1) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">MaxX</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">MinX</a>();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">double</span> Y = (i &amp; 2) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">MaxY</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">MinY</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">double</span> Z = (i &amp; 4) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">MaxZ</a>() : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">MinZ</a>();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    TVector3 corner(X, Y, Z);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">double</span> phi = (R * (corner - <a class="code" href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">origin</a>)).Phi();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (phi &gt; phihi) phihi = phi;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (phi &lt; philo) philo = phi;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Now figure out if the bounds should go philo -&gt; phihi or phihi -&gt; philo</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Whichever has the smaller length is correct</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">bool</span> order_is_up = (phihi - philo) &lt; (M_PI - phihi) + (philo + M_PI);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// If we should go phihi -&gt; philo switch them and re-order them around</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">if</span> (!order_is_up) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;FLIP PHILIM! &quot;</span> &lt;&lt; philo &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; phihi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">double</span> temp = phihi;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    phihi = philo + 2*M_PI;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    philo = temp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> {philo, phihi};</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_afd042da19afb090ba80e93ee64d4dec5"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#afd042da19afb090ba80e93ee64d4dec5">geo::BoxBoundedGeo::MinX</a></div><div class="ttdeci">double MinX() const </div><div class="ttdoc">Returns the world x coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00088">BoxBoundedGeo.h:88</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ae141949f30631ded82199f4375c21b7e"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ae141949f30631ded82199f4375c21b7e">geo::BoxBoundedGeo::MaxX</a></div><div class="ttdeci">double MaxX() const </div><div class="ttdoc">Returns the world x coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00091">BoxBoundedGeo.h:91</a></div></div>
<div class="ttc" id="find__global__symbol_8sh_html_ae2fcd9af85e9525dadab1ac2cb45a22d"><div class="ttname"><a href="../../d5/df9/find__global__symbol_8sh.html#ae2fcd9af85e9525dadab1ac2cb45a22d">X</a></div><div class="ttdeci">then echo echo For and will not be changed by echo further linking echo echo B echo The symbol is in the uninitialized data multiple common symbols may appear with the echo same name If the symbol is defined the common echo symbols are treated as undefined references For more echo details on common see the discussion of warn common echo in *Note Linker see the discussion of warn common echo in *Note Linker such as a global int variable echo as opposed to a large global array echo echo I echo The symbol is an indirect reference to another symbol This echo is a GNU extension to the a out object file format which is echo rarely used echo echo N echo The symbol is a debugging symbol echo echo R echo The symbol is in a read only data section echo echo S echo The symbol is in an uninitialized data section for small echo objects echo echo T echo The symbol is in the the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo W echo The symbol is a weak symbol that has not been specifically echo tagged as a weak object symbol When a weak defined symbol echo is linked with a normal defined the normal defined echo symbol is used with no error When a weak undefined symbol echo is linked and the symbol is not the value of the echo weak symbol becomes zero with no error echo echo echo The symbol is a stabs symbol in an a out object file In echo this the next values printed are the stabs other echo the stabs desc and the stab type Stabs symbols are echo used to hold debugging information For more echo see *Note or object file format specific echo echo For Mac OS X</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df9/find__global__symbol_8sh_source.html#l00107">find_global_symbol.sh:107</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9692993194494126ac8163593a8f1134"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">evgen::ldm::MixedWeightRayTraceBox::fBox</a></div><div class="ttdeci">geo::BoxBoundedGeo fBox</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">MixedWeightRayTraceBox_tool.cc:72</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a67f01c76c031e29c5bcc610f23a0be85"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a67f01c76c031e29c5bcc610f23a0be85">geo::BoxBoundedGeo::MinZ</a></div><div class="ttdeci">double MinZ() const </div><div class="ttdoc">Returns the world z coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00118">BoxBoundedGeo.h:118</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_a71626e62af098d6a8c09dd97bbf4812b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#a71626e62af098d6a8c09dd97bbf4812b">geo::BoxBoundedGeo::MaxY</a></div><div class="ttdeci">double MaxY() const </div><div class="ttdoc">Returns the world y coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00106">BoxBoundedGeo.h:106</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_aff3c6d62c880e387d35ab093bdbdcffc"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#aff3c6d62c880e387d35ab093bdbdcffc">geo::BoxBoundedGeo::MaxZ</a></div><div class="ttdeci">double MaxZ() const </div><div class="ttdoc">Returns the world z coordinate of the end of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00121">BoxBoundedGeo.h:121</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_abc0cab4f0fcd826d11aaa8b3dfb2de02"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#abc0cab4f0fcd826d11aaa8b3dfb2de02">geo::BoxBoundedGeo::MinY</a></div><div class="ttdeci">double MinY() const </div><div class="ttdoc">Returns the world y coordinate of the start of the box. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d92/BoxBoundedGeo_8h_source.html#l00103">BoxBoundedGeo.h:103</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="namespacegeo_html_a6155d04d62c8bb11135137324ab26b5c"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">geo::origin</a></div><div class="ttdeci">constexpr Point origin()</div><div class="ttdoc">Returns a origin position with a point of the specified type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00227">geo_vectors.h:227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a14f53a6ecbf321de84e81415ca75db23"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool evgen::ldm::MixedWeightRayTraceBox::IntersectDetector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d99/find__fhicl_8sh.html#a0e50d715b86162838c8a191974455ae0">std::array</a>&lt; TVector3, 2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>intersection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../d2/da4/classevgen_1_1ldm_1_1IRayTrace.html#a72b60b7fe8ab31ff13ba4a23f7b90983">evgen::ldm::IRayTrace</a>.</p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00315">315</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                                                                                                     {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// We want to pick an orientation in the lab frame (th, phi)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// that intersects with the detector. </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// In the lab frame, the angular distribution is not uniform. In the</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// parent-rest-rame (th&#39;, phi&#39;), it is. Picking directions in the </span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// parent-rest-frame until a direction which hits the detector is very inefficient.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// We can draw from the lab frame and weight using d(th, phi) / d(th&#39;, phi&#39;).</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// (This is what is done for neutrino simulation). However, in the massive</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// case there is a (integrable) singularity which leads to an unbounded max weight.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// This is undesirable for the Monte-Carlo and makes application of a &quot;accept-reject&quot;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// algorithm to de-weight impossible. </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// So here we apply a mixed algorithm. We pick (phi, th&#39;). I.e. we pick phi in the lab</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// frame (forced to hit the detector) and th&#39; in the parent-rest-frame. This reduces </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// the MC to one dimension instead of two, and so should be much more efficient. And,</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// to weight we just need dphi/dphi&#39; = 1.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Setup the axes so that the parent Momentum is along the z axis</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  TVector3 parent_dir = flux.kmom.Vect().Unit();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  TVector3 zdir(0, 0, 1);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  TVector3 perp_parent_dir = zdir.Cross(parent_dir);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a> = acos(parent_dir.Z());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  TRotation R;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// Setup the rotation if we need to</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">if</span> (perp_parent_dir.Mag() &gt; 1<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>-4) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    R.Rotate(-angle, perp_parent_dir);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  TRotation RInv = R.Inverse();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PARENT DIR: &quot;</span> &lt;&lt; parent_dir.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir.Z() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  TVector3 parent_dir_rotated = R * parent_dir;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PARENT DIR ROTATED: &quot;</span> &lt;&lt; parent_dir_rotated.X() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir_rotated.Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; parent_dir_rotated.Z() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// Compute the Delta Phi of the detector</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  std::pair&lt;double, double&gt; philim = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">DeltaPhi</a>(flux.pos.Vect(), R);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">double</span> philo = philim.first;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">double</span> phihi = philim.second;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;PHILIM: &quot;</span> &lt;&lt; philo &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; phihi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;DELTAPHI: &quot;</span> &lt;&lt; (phihi - philo) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// Pick a phi</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">double</span> phi = <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">GetRandom</a>() * (phihi - philo) + philo;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;THISPHI: &quot;</span> &lt;&lt; phi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  RayWeightInfo <a class="code" href="../../d3/d46/namespacesortDataLoggerFiles.html#aabcd6b22cdd9f4c3c9c394a72f90183a">info</a> = (<a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">fFixNSuccess</a>) ? <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">ThrowFixedSuccess</a>(flux, RInv, phi) : <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">ThrowFixedThrows</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (!info.pass) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">unsigned</span> ind = CLHEP::RandFlat::shootInt(<a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a32b9d4c9fde5f7716f228f58e24e5378">fEngine</a>, 0, info.allIntersections.size()-1); <span class="comment">// inclusive?</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  TLorentzVector mevprtl_mom = info.allPrtlMom[ind];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  std::vector&lt;TVector3&gt; box_intersections = info.allIntersections[ind];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  TVector3 B = box_intersections[1];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// make sure that the flux start lies outside the detector</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">if</span> ((flux.pos.Vect() - <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>).Mag() &lt; (A-B).Mag() &amp;&amp; (flux.pos.Vect() - B).Mag() &lt; (A-B).Mag()) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;ReThrowRayTraceBox Exception&quot;</span>, <span class="stringliteral">&quot;Input mevprtl flux starts inside detector volume: &quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="stringliteral">&quot;MeVPrtl start At: (&quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.pos.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.pos.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(flux.pos.Z()) + <span class="stringliteral">&quot;). &quot;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="stringliteral">&quot;Intersection A At: &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(A.Z()) + <span class="stringliteral">&quot;). &quot;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="stringliteral">&quot;Intersection B At: &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.X()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.Y()) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">std::to_string</a>(B.Z()) + <span class="stringliteral">&quot;).\n&quot;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// weight from forcing phi</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">double</span> phiweight = (phihi - philo) / (2*M_PI);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// Total weight</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  weight = phiweight * info.weight;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Final WEIGHT: &quot;</span> &lt;&lt; weight &lt;&lt; std::endl;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  flux.mom = mevprtl_mom;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// transform to beam-coord frame</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  flux.mom_beamcoord = mevprtl_mom;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  flux.mom_beamcoord.Boost(-flux.kmom.BoostVector()); <span class="comment">// Boost to kaon rest frame</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  flux.mom_beamcoord.Boost(flux.kmom_beamcoord.BoostVector()); <span class="comment">// And to beam coordinate frame</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// Two boosts make a rotation!</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// Set the secondary 4-momentum</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  flux.sec = flux.kmom - flux.mom;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  flux.sec_beamcoord = flux.kmom_beamcoord - flux.mom_beamcoord;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> ((flux.pos.Vect() - <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>).Mag() &lt; (flux.pos.Vect() - B).Mag()) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    intersection = {<a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a>, B}; <span class="comment">// A is entry, B is exit</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    intersection = {B, A}; <span class="comment">// reversed</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Kaon 4P: &quot;</span> &lt;&lt; flux.kmom.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.kmom.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.kmom.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.kmom.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Selected Prtl 4P: &quot;</span> &lt;&lt; flux.mom.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.mom.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.mom.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.mom.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Selected Scdy 4P: &quot;</span> &lt;&lt; flux.sec.E() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.sec.Px() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.sec.Py() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux.sec.Pz() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a13c70a3315c57bdf536e7bd9f919955e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a13c70a3315c57bdf536e7bd9f919955e">evgen::ldm::MixedWeightRayTraceBox::ThrowFixedSuccess</a></div><div class="ttdeci">RayWeightInfo ThrowFixedSuccess(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00269">MixedWeightRayTraceBox_tool.cc:269</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a0df6401d1ecf390e674efc6479afd140"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a0df6401d1ecf390e674efc6479afd140">evgen::ldm::MixedWeightRayTraceBox::fFixNSuccess</a></div><div class="ttdeci">bool fFixNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00081">MixedWeightRayTraceBox_tool.cc:81</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_a32b9d4c9fde5f7716f228f58e24e5378"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#a32b9d4c9fde5f7716f228f58e24e5378">evgen::ldm::IMeVPrtlStage::fEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine * fEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00079">IMeVPrtlStage.h:79</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a897eb98a5c5c5bd9325ee82ff3df3b87"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a897eb98a5c5c5bd9325ee82ff3df3b87">evgen::ldm::MixedWeightRayTraceBox::ThrowFixedThrows</a></div><div class="ttdeci">RayWeightInfo ThrowFixedThrows(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00227">MixedWeightRayTraceBox_tool.cc:227</a></div></div>
<div class="ttc" id="namespaceicarus_1_1trigger_html_a7718dbf2e5e4aa346e7fbabaa451457f"><div class="ttname"><a href="../../dd/df6/namespaceicarus_1_1trigger.html#a7718dbf2e5e4aa346e7fbabaa451457f">icarus::trigger::to_string</a></div><div class="ttdeci">std::string to_string(WindowPattern const &amp;pattern)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d48/WindowPattern_8h_source.html#l00102">WindowPattern.h:102</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_abfae2e504dfa44c403614b6cd601f99e"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a></div><div class="ttdeci">finds tracks best matching by angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00064">trackfinderalgorithms.fcl:64</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_afe4744bee473ef3740e170ebf196d063"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">evgen::ldm::IMeVPrtlStage::GetRandom</a></div><div class="ttdeci">double GetRandom()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00072">IMeVPrtlStage.h:72</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac96bf9a3a8adcc5ff3428044bc1ae82b"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac96bf9a3a8adcc5ff3428044bc1ae82b">evgen::ldm::MixedWeightRayTraceBox::DeltaPhi</a></div><div class="ttdeci">std::pair&lt; double, double &gt; DeltaPhi(TVector3 origin, TRotation &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00194">MixedWeightRayTraceBox_tool.cc:194</a></div></div>
<div class="ttc" id="namespacesortDataLoggerFiles_html_aabcd6b22cdd9f4c3c9c394a72f90183a"><div class="ttname"><a href="../../d3/d46/namespacesortDataLoggerFiles.html#aabcd6b22cdd9f4c3c9c394a72f90183a">sortDataLoggerFiles.info</a></div><div class="ttdeci">tuple info</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc8/sortDataLoggerFiles_8py_source.html#l00386">sortDataLoggerFiles.py:386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abb44133e902e0f05982554cd914ef55b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::MaxWeight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#abc11d98d41c8d204425ceb9363639800">evgen::ldm::IMeVPrtlStage</a>.</p>

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00067">67</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                { </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">fMaxWeight</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a7e587da60c695749e2ec21f1e4f47661"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a7e587da60c695749e2ec21f1e4f47661">evgen::ldm::MixedWeightRayTraceBox::fMaxWeight</a></div><div class="ttdeci">double fMaxWeight</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00083">MixedWeightRayTraceBox_tool.cc:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13c70a3315c57bdf536e7bd9f919955e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> evgen::ldm::MixedWeightRayTraceBox::ThrowFixedSuccess </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TRotation &amp;&#160;</td>
          <td class="paramname"><em>RInv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00269">269</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                                                                            {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  RayWeightInfo ret;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">unsigned</span> ithrow = 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">unsigned</span> nfail = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">unsigned</span> nsuccess = 0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">while</span> (nsuccess &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a> &amp;&amp; ithrow &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ithrow ++;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    TLorentzVector mevprtl_mom = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    std::vector&lt;TVector3&gt; box_intersections = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">GetIntersections</a>(flux.pos.Vect(), mevprtl_mom.Vect().Unit());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// Does this ray intersect the box?</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (box_intersections.size() != 2) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// if the ray points the wrong way, it doesn&#39;t intersect</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (mevprtl_mom.Vect().Unit().Dot((A - flux.pos.Vect()).Unit()) &lt; 0.) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// if we&#39;re here, we have a valid ray</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    ret.allIntersections.push_back(box_intersections);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    ret.allPrtlMom.push_back(mevprtl_mom);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    nsuccess ++;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NFAIL: &quot;</span> &lt;&lt; nfail &lt;&lt; std::endl;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NSUCCESS: &quot;</span> &lt;&lt; nsuccess &lt;&lt; std::endl;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Q: &quot;</span> &lt;&lt; <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">QEstimator</a>(nsuccess, nfail, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span> (nsuccess == <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    ret.weight = <a class="code" href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">QEstimator</a>(nsuccess, nfail, <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">fNSuccess</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    ret.pass = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    ret.weight = 0.;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    ret.pass = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="ttc" id="namespaceevgen_1_1ldm_html_aa208834661f5314774c16fc97d4bbeb9"><div class="ttname"><a href="../../d7/df2/namespaceevgen_1_1ldm.html#aa208834661f5314774c16fc97d4bbeb9">evgen::ldm::QEstimator</a></div><div class="ttdeci">double QEstimator(unsigned nsuccess, unsigned nfail, unsigned r)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00096">MixedWeightRayTraceBox_tool.cc:96</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac695a1d40f69b2b8665e046652d1d62e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">evgen::ldm::MixedWeightRayTraceBox::fNThrow</a></div><div class="ttdeci">unsigned fNThrow</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00079">MixedWeightRayTraceBox_tool.cc:79</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a297740186a9d6825a4a05003c3d408b3"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">evgen::ldm::MixedWeightRayTraceBox::ThrowMeVPrtlMomentum</a></div><div class="ttdeci">TLorentzVector ThrowMeVPrtlMomentum(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00173">MixedWeightRayTraceBox_tool.cc:173</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9692993194494126ac8163593a8f1134"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">evgen::ldm::MixedWeightRayTraceBox::fBox</a></div><div class="ttdeci">geo::BoxBoundedGeo fBox</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">MixedWeightRayTraceBox_tool.cc:72</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ab65b62b7003d7806a8c700d2f690a14b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">geo::BoxBoundedGeo::GetIntersections</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; GetIntersections(TVector3 const &amp;TrajectoryStart, TVector3 const &amp;TrajectoryDirect) const </div><div class="ttdoc">Calculates the entry and exit points of a trajectory on the box surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d09/BoxBoundedGeo_8cxx_source.html#l00126">BoxBoundedGeo.cxx:126</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a1fdecaa2baebf8476e8b152f5836cd3a"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a1fdecaa2baebf8476e8b152f5836cd3a">evgen::ldm::MixedWeightRayTraceBox::fNSuccess</a></div><div class="ttdeci">unsigned fNSuccess</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00080">MixedWeightRayTraceBox_tool.cc:80</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a897eb98a5c5c5bd9325ee82ff3df3b87"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/dae/structevgen_1_1ldm_1_1RayWeightInfo.html">RayWeightInfo</a> evgen::ldm::MixedWeightRayTraceBox::ThrowFixedThrows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TRotation &amp;&#160;</td>
          <td class="paramname"><em>RInv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00227">227</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                                                                                           {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  RayWeightInfo ret;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">unsigned</span> ithrow = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">unsigned</span> nfail = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">unsigned</span> nsuccess = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">while</span> (ithrow &lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    ithrow ++;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    TLorentzVector mevprtl_mom = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">ThrowMeVPrtlMomentum</a>(flux, RInv, phi);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    std::vector&lt;TVector3&gt; box_intersections = <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">fBox</a>.<a class="code" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">GetIntersections</a>(flux.pos.Vect(), mevprtl_mom.Vect().Unit());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Does this ray intersect the box?</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (box_intersections.size() != 2) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// if the ray points the wrong way, it doesn&#39;t intersect</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    TVector3 <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = box_intersections[0];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (mevprtl_mom.Vect().Unit().Dot((A - flux.pos.Vect()).Unit()) &lt; 0.) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      nfail ++;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// if we&#39;re here, we have a valid ray</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    ret.allIntersections.push_back(box_intersections);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    ret.allPrtlMom.push_back(mevprtl_mom);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    nsuccess ++;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NTHROW: &quot;</span> &lt;&lt; <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NSUCCESS: &quot;</span> &lt;&lt; nsuccess &lt;&lt; std::endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;P: &quot;</span> &lt;&lt; (((double)nsuccess) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  ret.weight = ((double)nsuccess) / <a class="code" href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">fNThrow</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  ret.pass = nsuccess &gt; 0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_ac695a1d40f69b2b8665e046652d1d62e"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#ac695a1d40f69b2b8665e046652d1d62e">evgen::ldm::MixedWeightRayTraceBox::fNThrow</a></div><div class="ttdeci">unsigned fNThrow</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00079">MixedWeightRayTraceBox_tool.cc:79</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a297740186a9d6825a4a05003c3d408b3"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a297740186a9d6825a4a05003c3d408b3">evgen::ldm::MixedWeightRayTraceBox::ThrowMeVPrtlMomentum</a></div><div class="ttdeci">TLorentzVector ThrowMeVPrtlMomentum(const MeVPrtlFlux &amp;flux, TRotation &amp;RInv, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00173">MixedWeightRayTraceBox_tool.cc:173</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1MixedWeightRayTraceBox_html_a9692993194494126ac8163593a8f1134"><div class="ttname"><a href="../../d3/daa/classevgen_1_1ldm_1_1MixedWeightRayTraceBox.html#a9692993194494126ac8163593a8f1134">evgen::ldm::MixedWeightRayTraceBox::fBox</a></div><div class="ttdeci">geo::BoxBoundedGeo fBox</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">MixedWeightRayTraceBox_tool.cc:72</a></div></div>
<div class="ttc" id="classgeo_1_1BoxBoundedGeo_html_ab65b62b7003d7806a8c700d2f690a14b"><div class="ttname"><a href="../../db/d54/classgeo_1_1BoxBoundedGeo.html#ab65b62b7003d7806a8c700d2f690a14b">geo::BoxBoundedGeo::GetIntersections</a></div><div class="ttdeci">std::vector&lt; TVector3 &gt; GetIntersections(TVector3 const &amp;TrajectoryStart, TVector3 const &amp;TrajectoryDirect) const </div><div class="ttdoc">Calculates the entry and exit points of a trajectory on the box surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d09/BoxBoundedGeo_8cxx_source.html#l00126">BoxBoundedGeo.cxx:126</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a297740186a9d6825a4a05003c3d408b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLorentzVector evgen::ldm::MixedWeightRayTraceBox::ThrowMeVPrtlMomentum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/db2/classevgen_1_1ldm_1_1MeVPrtlFlux.html">MeVPrtlFlux</a> &amp;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TRotation &amp;&#160;</td>
          <td class="paramname"><em>RInv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00173">173</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                                                                                {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// Pick a direction vector with the parent-direction along the z-axis</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> costh = <a class="code" href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">GetRandom</a>()*2 - 1.;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">double</span> sinth = sqrt(1 - costh*costh);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>(cos(phi)*sinth, sin(phi)*sinth, costh);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// Rotate to the lab direction</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = RInv * <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// make the mevprtl momentum this</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  TLorentzVector mevprtl_mom = flux.mom;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  mevprtl_mom.Boost(-flux.kmom.BoostVector());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  mevprtl_mom = TLorentzVector(mevprtl_mom.P() * <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>, mevprtl_mom.E());</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// boost back</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  mevprtl_mom.Boost(flux.kmom.BoostVector());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> mevprtl_mom;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="classevgen_1_1ldm_1_1IMeVPrtlStage_html_afe4744bee473ef3740e170ebf196d063"><div class="ttname"><a href="../../da/d5c/classevgen_1_1ldm_1_1IMeVPrtlStage.html#afe4744bee473ef3740e170ebf196d063">evgen::ldm::IMeVPrtlStage::GetRandom</a></div><div class="ttdeci">double GetRandom()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3f/IMeVPrtlStage_8h_source.html#l00072">IMeVPrtlStage.h:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9692993194494126ac8163593a8f1134"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d54/classgeo_1_1BoxBoundedGeo.html">geo::BoxBoundedGeo</a> evgen::ldm::MixedWeightRayTraceBox::fBox</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00072">72</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a0df6401d1ecf390e674efc6479afd140"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool evgen::ldm::MixedWeightRayTraceBox::fFixNSuccess</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00081">81</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a7e587da60c695749e2ec21f1e4f47661"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::fMaxWeight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00083">83</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9e9680ab19df22846d27cbc2a6f3ec6a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::fMaxWeightFudge</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00077">77</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1fdecaa2baebf8476e8b152f5836cd3a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned evgen::ldm::MixedWeightRayTraceBox::fNSuccess</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00080">80</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ac695a1d40f69b2b8665e046652d1d62e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned evgen::ldm::MixedWeightRayTraceBox::fNThrow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00079">79</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa79b3fd8e8d3fa8d791d75dbac3d4064"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::fReferenceKaonEnergy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00076">76</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ab1276448a2ba9351f7b923db1e8fb1e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::fReferenceLabSolidAngle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00073">73</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af2b55701a3d3ea31c426176843c377aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double evgen::ldm::MixedWeightRayTraceBox::fReferencePrtlMass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00074">74</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ac4476f77629dc0a22f5feac03fb259a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int evgen::ldm::MixedWeightRayTraceBox::fReferenceScndPDG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html#l00075">75</a> of file <a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../dc/dd2/MixedWeightRayTraceBox__tool_8cc_source.html">MixedWeightRayTraceBox_tool.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
