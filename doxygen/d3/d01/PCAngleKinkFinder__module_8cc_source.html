<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>PCAngleKinkFinder_module.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_5f678ef99ea6f964b236b90db12a4ab6.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_9c2e8b3a7cfa1f7937f5a112e04e3409.html">sbncode</a></li><li class="navelem"><a class="el" href="../../dir_17fd13acbb9577160d096f97c64b435e.html">TPCReco</a></li><li class="navelem"><a class="el" href="../../dir_373e4f542184b615f4268ec23640ddf8.html">KinkExp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PCAngleKinkFinder_module.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">// Class:       PCAngleKinkFinderFinder</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Plugin Type: producer (art v3_02_06)</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// File:        PCAngleKinkFinder_module.cc</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Generated at Wed Feb 19 17:38:21 2020 by Gray Putnam using cetskelgen</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// from cetlib version v3_07_02.</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/EDProducer.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Core/ModuleMacros.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Event.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Handle.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/Run.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;art/Framework/Principal/SubRun.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;canvas/Utilities/InputTag.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;fhiclcpp/ParameterSet.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">lardata/Utilities/AssociationUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5c/PFParticle_8h.html">lardataobj/RecoBase/PFParticle.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d9f/Wire_8h.html">lardataobj/RecoBase/Wire.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d2d/Vertex_8h.html">lardataobj/RecoBase/Vertex.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d26/Hit_8h.html">lardataobj/RecoBase/Hit.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d77/Cluster_8h.html">lardataobj/RecoBase/Cluster.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de7/GeometryCore_8h.html">larcorealg/Geometry/GeometryCore.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/df8/DetectorPropertiesStandard_8h.html">lardataalg/DetectorInfo/DetectorPropertiesStandard.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df8/DetectorPropertiesService_8h.html">lardata/DetectorInfoServices/DetectorPropertiesService.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d5c/PFParticle_8h.html">lardataobj/RecoBase/PFParticle.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;sbnobj/Common/Reco/PCAnglePlane.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;sbnobj/Common/Reco/PCAngleKink.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;TFitter.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;TMinuit.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">namespace </span>sbn {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keyword">class </span>PCAngleKinkFinder;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">   46</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">sbn::PCAngleKinkFinder</a> : <span class="keyword">public</span> art::EDProducer {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">PCAngleKinkFinder</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// The compiler-generated destructor is fine for non-base</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// classes without bare pointers or other resource use.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// Plugins should not be copied or assigned.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">PCAngleKinkFinder</a>(<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a> <span class="keyword">const</span>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">PCAngleKinkFinder</a>(<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a>&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a>&amp; <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a122582b454387a1aa6d654e40cac6d14">operator=</a>(<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a> <span class="keyword">const</span>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a>&amp; <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a122582b454387a1aa6d654e40cac6d14">operator=</a>(<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">PCAngleKinkFinder</a>&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Required functions.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a4ebfae48bdf6693a15625fa99aff5469">produce</a>(art::Event&amp; <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">   61</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">FitResult</a> {</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a4fee8f8bc0f72f37c7f98a4e73aa5eac">   62</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a4fee8f8bc0f72f37c7f98a4e73aa5eac">chi2</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">   63</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">angle</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a1b198eac587b5c33e7a0483ee570e4bc">   64</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a1b198eac587b5c33e7a0483ee570e4bc">pitch</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  };</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// config</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#aa3c2c1d9c1952453f05d25d0697e6a94">   69</a></span>&#160;  std::string <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#aa3c2c1d9c1952453f05d25d0697e6a94">fPFParticleLabel</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1895d3f5c1ab079c94bf13d03c21d830">   70</a></span>&#160;  std::string <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1895d3f5c1ab079c94bf13d03c21d830">fAngleLabel</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1b5c386b81890c9373bbb1169d2cd422">   71</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1b5c386b81890c9373bbb1169d2cd422">fHitThreshold</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae106a143ae4766aaab9de1e430809a0d">   72</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae106a143ae4766aaab9de1e430809a0d">fMinDist</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ad7a5c9e90fa48257a45b2035244d4e04">   73</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ad7a5c9e90fa48257a45b2035244d4e04">fAllowIncomplete</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a0ddbf6173a6f039fb658d358693ab499">   74</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a0ddbf6173a6f039fb658d358693ab499">fPCARadius</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1dcc0d53fb4534dcbea8095beb456e67">   75</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1dcc0d53fb4534dcbea8095beb456e67">fFitResolution</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// private helpers</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">FitResult</a> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae2b5536cd1ea70fb89f128a2ec531390">Fit</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> lo, <span class="keywordtype">unsigned</span> hi, <span class="keywordtype">unsigned</span> center, <span class="keywordtype">float</span> est_angle, <span class="keywordtype">float</span> est_pitch);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// TODO: FIX</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// TMinuit sux, so we have to define the data as a static global variable</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// private data</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a5330823f7b678cfbf0eb77c41ee8f664">   86</a></span>&#160;<span class="keyword">static</span> std::vector&lt;float&gt; <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a5330823f7b678cfbf0eb77c41ee8f664">fFitDataX</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#aa02ba07957cbc77d7d82fd4b0f4b0f2e">   87</a></span>&#160;<span class="keyword">static</span> std::vector&lt;float&gt; <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#aa02ba07957cbc77d7d82fd4b0f4b0f2e">fFitDataY</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#ab1efb71b6287662017ad303105dcb562">   88</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#ab1efb71b6287662017ad303105dcb562">fFitCenter</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">// static helper functions</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a08f410413cd36a5d871cd3ef29a7ad8f">   91</a></span>&#160;sbn::PCAngleKink <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a08f410413cd36a5d871cd3ef29a7ad8f">BuildKink</a>(<span class="keyword">const</span> sbn::PCAngle &amp;<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a>, <span class="keyword">const</span> sbn::PCAngle &amp;lo, <span class="keyword">const</span> sbn::PCAngle &amp;hi, <span class="keyword">const</span> <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">sbn::PCAngleKinkFinder::FitResult</a> &amp;fit, <span class="keywordtype">float</span> est_angle) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  sbn::PCAngleKink kink;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  kink.maxWire = max.wire;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  kink.fwhm_distance = sqrt((hi.hit_time_cm - lo.hit_time_cm) * (hi.hit_time_cm - lo.hit_time_cm) </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      + (hi.hit_wire_cm - lo.hit_wire_cm) * (hi.hit_wire_cm - lo.hit_wire_cm)); </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  kink.max_angle = max.angle;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  kink.est_angle = est_angle;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  kink.position_max = {max.hit_time_cm, max.hit_wire_cm};</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  kink.position_lo = {lo.hit_time_cm, lo.hit_wire_cm};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  kink.position_hi = {hi.hit_time_cm, hi.hit_wire_cm};</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  kink.vec_lo_at_max = max.lo_vector;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  kink.vec_hi_at_max = max.hi_vector;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  kink.vec_lo_at_halfmax_lo = lo.lo_vector;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  kink.vec_hi_at_halfmax_lo = lo.hi_vector;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  kink.vec_lo_at_halfmax_hi = hi.lo_vector;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  kink.vec_hi_at_halfmax_hi = hi.hi_vector;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  kink.fit_chi2 = fit.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a4fee8f8bc0f72f37c7f98a4e73aa5eac">chi2</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  kink.fit_angle = fit.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">angle</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  kink.fit_pitch = fit.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a1b198eac587b5c33e7a0483ee570e4bc">pitch</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> kink;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// flatten the structure of each branch</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a292c3a6e1161e561e421985ed6bc4f6f">  121</a></span>&#160;std::tuple&lt;std::vector&lt;sbn::PCAngle&gt;, <span class="keywordtype">unsigned</span>&gt; <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a292c3a6e1161e561e421985ed6bc4f6f">FlattenBranch</a>(<span class="keyword">const</span> sbn::PCAnglePlane &amp;plane, <span class="keywordtype">unsigned</span> i_branch, <span class="keywordtype">bool</span> allow_incomplete, <span class="keywordtype">float</span> min_dist) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  std::vector&lt;sbn::PCAngle&gt; ret;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Flattening angles for branch: &quot;</span> &lt;&lt; i_branch &lt;&lt; <span class="stringliteral">&quot; plane: &quot;</span> &lt;&lt; plane.plane.Plane &lt;&lt; <span class="stringliteral">&quot; hierarchy: &quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span>: plane.branchHierarchy[i_branch]) <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// start at the end of the branch and count backwards</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_branch_hierarchy = 0; i_branch_hierarchy &lt; plane.branchHierarchy[i_branch].size(); i_branch_hierarchy++) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// look up the index of the current branch</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">unsigned</span> this_branch = std::distance(plane.branchIDs.begin(), std::find(plane.branchIDs.begin(), plane.branchIDs.end(), plane.branchHierarchy[i_branch][i_branch_hierarchy])); </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (this_branch == plane.branchIDs.size()) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;BAD: UNFOUND BRANCH ID\n&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;BRANCH CHECK: &quot;</span> &lt;&lt; plane.branchHierarchy[i_branch][i_branch_hierarchy] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; this_branch &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; i_branch &lt;&lt; std::endl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = plane.angles[this_branch].size()-1; i &gt;= 0; i--) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// invalid if incomplete</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">bool</span> is_complete = (plane.angles[this_branch][i].complete || allow_incomplete) &amp;&amp;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;           plane.angles[this_branch][i].dist_to_lo &gt; min_dist &amp;&amp; plane.angles[this_branch][i].dist_to_hi &gt; min_dist &amp;&amp;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;           plane.angles[this_branch][i].angle &gt; -99.;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;       </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="../../de/d71/neoSmazza_8sh.html#ae55989c903f0c76190facfb5e5211732">if</a> (!is_complete) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// Check if this hit is replicated in the following branch</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">bool</span> found_hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">if</span> (i_branch_hierarchy &gt; 0) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> i_check_branch_hierarchy = i_branch_hierarchy - 1;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">unsigned</span> chk_branch = plane.branchIDs.size();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">int</span> check_hitID = plane.angles[this_branch][i].hitID;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">while</span> (i_check_branch_hierarchy &gt;= 0 &amp;&amp; chk_branch == plane.branchIDs.size()) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          chk_branch = std::distance(plane.branchIDs.begin(), std::find(plane.branchIDs.begin(), plane.branchIDs.end(), plane.branchHierarchy[i_branch][i_check_branch_hierarchy]));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          i_check_branch_hierarchy --;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (chk_branch &lt; plane.branchIDs.size()) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; plane.angles[chk_branch].size(); j++) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (plane.angles[chk_branch][j].hitID == check_hitID) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              found_hit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// invalid if replicated</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">if</span> (found_hit) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">// Valid!</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      ret.push_back(plane.angles[this_branch][i]);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// reverse the angles</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  std::reverse(ret.begin(), ret.end());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// get the number of valid hits in the main branch</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">unsigned</span> n_branch_hits = 0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; plane.angles[i_branch].size(); i++) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    n_branch_hits += (plane.angles[i_branch][i].complete || allow_incomplete) &amp;&amp;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;           plane.angles[i_branch][i].dist_to_lo &gt; min_dist &amp;&amp; plane.angles[i_branch][i].dist_to_hi &gt; min_dist &amp;&amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;           plane.angles[i_branch][i].angle &gt; -99.;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// get the index of the start of this branch</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">unsigned</span> branch_start = ret.size() - n_branch_hits;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">return</span> {ret, branch_start};</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">// Estimate peak height -- try the mean of the three largest points</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a9cccea9fc3b9a3b647eff572d77f0ca9">  189</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a9cccea9fc3b9a3b647eff572d77f0ca9">EstimateHeight</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> lo, <span class="keywordtype">unsigned</span> hi) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NAVG = 3;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> IAVG = (NAVG - 1) / 2;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// if the &quot;peak is too small -- ignore</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">if</span> (hi - lo + 1 &lt; NAVG) <span class="keywordflow">return</span> -1.;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  std::vector&lt;float&gt; avgd;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// average out the vector</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = IAVG + lo; i &lt;= hi - IAVG; i++) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">float</span> sum = 0.;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i - IAVG; j &lt; i - IAVG + NAVG; j++) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      sum += angles[j].angle;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    avgd.push_back(sum / NAVG);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">return</span> *std::max_element(avgd.begin(), avgd.end());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a926789424fe52300af0524f76d546657">  211</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a926789424fe52300af0524f76d546657">FindMaxIndex</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> lo, <span class="keywordtype">unsigned</span> hi) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NAVG = 3;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> IAVG = (NAVG - 1) / 2;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// if the &quot;peak is too small -- ignore</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (hi - lo + 1 &lt; (<span class="keywordtype">int</span>)NAVG) <span class="keywordflow">return</span> -1.;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  std::vector&lt;float&gt; avgd;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// average out the vector</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = lo + IAVG; i &lt;= hi - IAVG; i++) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">float</span> sum = 0.;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i - IAVG; j &lt; i - IAVG + NAVG; j++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      sum += angles[j].angle;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    avgd.push_back(sum / NAVG);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// index of the averaged</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">unsigned</span> avgd_index = std::distance(avgd.begin(), std::max_element(avgd.begin(), avgd.end()));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// convert this to index in angles list</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">unsigned</span> angles_index = avgd_index + IAVG + lo;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">return</span> angles_index;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;} </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af488db0731259cf1b4cde77f0a9d4066">  238</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af488db0731259cf1b4cde77f0a9d4066">FindFWHMHiIndex</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> start, <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, <span class="keywordtype">float</span> amp, <span class="keywordtype">float</span> threshold) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// handle bad amplitude</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (amp &lt; 0.) <span class="keywordflow">return</span> -1; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// go below half-the amplitude</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">int</span> halfmax_ind = -1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// forward track to the end of this branch</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// We always identify hits on the last part of any branch, so we don&#39;t need </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// to worry about forward tracking to any other part of the branch</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = end; i &lt; angles.size(); i++) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (angles[i].<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a> &lt; amp/2.) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      halfmax_ind = i;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    } </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">return</span> halfmax_ind;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;} </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2103e3388fd7f7dba9f956e9689854bb">  258</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2103e3388fd7f7dba9f956e9689854bb">FindFWHMLoIndex</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> start, <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>, <span class="keywordtype">float</span> amp, <span class="keywordtype">float</span> threshold) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// handle bad amplitude</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (amp &lt; 0.) <span class="keywordflow">return</span> -1; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// backtrack</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">int</span> halfmax_ind = -1;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i &gt;= 0; i--) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (angles[i].<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a> &lt; amp / 2.) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      halfmax_ind = i;      </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> halfmax_ind;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">  275</a></span>&#160;<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">sbn::PCAngleKinkFinder::PCAngleKinkFinder</a>(fhicl::ParameterSet <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  : EDProducer{p},</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    fPFParticleLabel(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;std::string&gt;(<span class="stringliteral">&quot;PFParticleLabel&quot;</span>)),</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    fAngleLabel(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;std::string&gt;(<span class="stringliteral">&quot;AngleLabel&quot;</span>)),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    fHitThreshold(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;HitThreshold&quot;</span>)),</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    fMinDist(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;MinDist&quot;</span>)),</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    fAllowIncomplete(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;AllowIncomplete&quot;</span>)),</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    fPCARadius(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;PCARadius&quot;</span>)),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    fFitResolution(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;FitResolution&quot;</span>, 0.05))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  produces&lt;std::vector&lt;sbn::PCAngleKink&gt;&gt;();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  produces&lt;art::Assns&lt;recob::PFParticle, sbn::PCAngleKink&gt;&gt;();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af619d7120baf900f2fab4cfc4a287315">  290</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af619d7120baf900f2fab4cfc4a287315">ExpectedCosAngle</a>(<span class="keywordtype">double</span> dist_to_center, <span class="keywordtype">double</span> radius, <span class="keywordtype">double</span> mean_distance, <span class="keywordtype">double</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (dist_to_center &gt;= radius) <span class="keywordflow">return</span> 1.;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">double</span> theta = <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">A</a> = dist_to_center;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">double</span> B = radius - dist_to_center;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">double</span> R = radius;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">double</span> l = mean_distance;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// double M01 = (B*(B + lB)*(3*A*(A + lA)*lB + (B*B*lA + B*(4*A - lA)*lB + 2*A*lB*lB)*cos(theta))*sin(theta))/(12.*lB*(B*lA + A*lB));</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">//double M00 = (A*(A + lA)*lB*(2*B*lA*(2*A + lA) + A*(A - lA)*lB) + B*(B + lB)*cos(theta)*(6*A*lA*(A + lA)*lB + lA*(B*B*lA + B*(4*A - lA)*lB + 2*A*lB*lB)*cos(theta)))/(12.*lA*lB*(B*lA + A*lB));</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">//double M11 = (B*(B + lB)*(B*B*lA + B*(4*A - lA)*lB + 2*A*lB*lB)*sin(theta)*sin(theta))/(12.*lB*(B*lA + A*lB));</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">double</span> M01 = (B*(B + l)*(-6*A*(A + l)*(A + B - 2*R)*sin(theta) + (3*B*(A + B)*(B + l) - 6*B*(B + l)*R + 2*(2*B + l)*R*R)*sin(2*theta)))/(24.*l*R*R);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">double</span> M00 = (A*(A + l)*(3*A*(A + B)*(A + l) - 6*A*(A + l)*R + 2*(2*A + l)*R*R) + B*(B + l)*cos(theta)*(-6*A*(A + l)*(A + B - 2*R) + (3*B*(A + B)*(B + l) - 6*B*(B + l)*R + 2*(2*B + l)*R*R)*cos(theta)))/(12.*l*R*R);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordtype">double</span> M11 = (B*(B + l)*(3*B*(A + B)*(B + l) - 6*B*(B + l)*R + 2*(2*B + l)*R*R)*sin(theta)*sin(theta))/(12.*l*R*R);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d0/da2/namespacetrkf.html#a02fec8e0cecf3305fca58a71de0d42c1">trace</a> = M00 + M11;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordtype">double</span> det = M00 * M11 - M01 * M01;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">double</span> eigen = 0.5 * (trace + sqrt(trace * trace - 4 *det));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">double</span> vecA = M01;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">double</span> vecB = eigen - M00;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">return</span> vecA / sqrt(vecA * vecA + vecB * vecB);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2c284bd01d283cd0362ccd747621459c">  316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2c284bd01d283cd0362ccd747621459c">FitLikelihood</a>(<span class="keywordtype">int</span> &amp;npar, <span class="keywordtype">double</span> *<a class="code" href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a>, <span class="keywordtype">double</span> &amp;result, <span class="keywordtype">double</span> *par, <span class="keywordtype">int</span> <a class="code" href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a> = par[0];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">double</span> res = par[1];</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">double</span> radius = par[2];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">double</span> mean_distance = par[3];</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordtype">double</span> chi2 = 0.;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; fFitDataX.size(); i++) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">double</span> expectation = acos(<a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af619d7120baf900f2fab4cfc4a287315">ExpectedCosAngle</a>(fFitDataX[i], radius, mean_distance, angle));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    chi2 += (expectation - fFitDataY[i]) * (expectation - fFitDataY[i]) / (fFitDataY[i] * fFitDataY[i] * res * res);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  result = chi2 / fFitDataX.size();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae2b5536cd1ea70fb89f128a2ec531390">  331</a></span>&#160;<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">sbn::PCAngleKinkFinder::FitResult</a> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae2b5536cd1ea70fb89f128a2ec531390">sbn::PCAngleKinkFinder::Fit</a>(<span class="keyword">const</span> std::vector&lt;sbn::PCAngle&gt; &amp;angles, <span class="keywordtype">unsigned</span> lo, <span class="keywordtype">unsigned</span> hi, <span class="keywordtype">unsigned</span> center, <span class="keywordtype">float</span> est_angle, <span class="keywordtype">float</span> est_pitch) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// setup the fitdata</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  fFitDataX.clear();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  fFitDataY.clear();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = lo; i &lt;= hi; i++) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    fFitDataX.push_back( sqrt((angles[i].hit_time_cm - angles[center].hit_time_cm) * (angles[i].hit_time_cm - angles[center].hit_time_cm) +</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      (angles[i].hit_wire_cm - angles[center].hit_wire_cm) * (angles[i].hit_wire_cm - angles[center].hit_wire_cm)) );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    fFitDataY.push_back(angles[i].<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#ab1efb71b6287662017ad303105dcb562">fFitCenter</a> = center;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// setup the fitter</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  TFitter fitter(5); <span class="comment">// 5 param</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  fitter.SetFCN(&amp;<a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2c284bd01d283cd0362ccd747621459c">FitLikelihood</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  fitter.SetParameter(0, <span class="stringliteral">&quot;angle&quot;</span>, est_angle, 0.1, 0, M_PI);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  fitter.SetParameter(1, <span class="stringliteral">&quot;resolution&quot;</span>, fFitResolution, 0., fFitResolution, fFitResolution);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  fitter.SetParameter(2, <span class="stringliteral">&quot;radius&quot;</span>, fPCARadius, 0., fPCARadius, fPCARadius);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  fitter.SetParameter(3, <span class="stringliteral">&quot;pitch&quot;</span>, est_pitch, 0., est_pitch, est_pitch);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  fitter.GetMinuit()-&gt;FixParameter(1);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  fitter.GetMinuit()-&gt;FixParameter(2);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  fitter.GetMinuit()-&gt;FixParameter(3);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  fitter.ExecuteCommand(<span class="stringliteral">&quot;MIGRAD&quot;</span>, 0, 0);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">sbn::PCAngleKinkFinder::FitResult</a> ret;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  ret.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">angle</a> = fitter.GetParameter(0);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  ret.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a1b198eac587b5c33e7a0483ee570e4bc">pitch</a> = fitter.GetParameter(3);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">double</span> chi2;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">double</span> edm;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">double</span> errdef;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">int</span> nvpar;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">int</span> nparx;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  fitter.GetStats(chi2, edm, errdef, nvpar, nparx);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Fit chi2: &quot;</span> &lt;&lt; chi2 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Fit angle: &quot;</span> &lt;&lt; ret.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">angle</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  ret.<a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a4fee8f8bc0f72f37c7f98a4e73aa5eac">chi2</a> = chi2;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a4ebfae48bdf6693a15625fa99aff5469">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a4ebfae48bdf6693a15625fa99aff5469">sbn::PCAngleKinkFinder::produce</a>(art::Event&amp; <a class="code" href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">evt</a>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// output stuff</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  std::unique_ptr&lt;std::vector&lt;sbn::PCAngleKink&gt;&gt; outKinks(<span class="keyword">new</span> std::vector&lt;sbn::PCAngleKink&gt;);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  std::unique_ptr&lt;art::Assns&lt;recob::PFParticle, sbn::PCAngleKink&gt;&gt; assn(<span class="keyword">new</span> art::Assns&lt;recob::PFParticle, sbn::PCAngleKink&gt;);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  art::PtrMaker&lt;sbn::PCAngleKink&gt; kinkPtrMaker {evt};</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// get the PFParticle&#39;s and the associated data</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  art::Handle&lt;std::vector&lt;recob::PFParticle&gt;&gt; pfparticle_handle;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  evt.getByLabel(fPFParticleLabel, pfparticle_handle);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  std::vector&lt;art::Ptr&lt;recob::PFParticle&gt;&gt; pfparticles;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  art::fill_ptr_vector(pfparticles, pfparticle_handle);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// organize the PFPlist into a map</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  std::map&lt;unsigned, art::Ptr&lt;recob::PFParticle&gt;&gt; id_to_pfp;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; pfparticles.size(); i++) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    id_to_pfp[pfparticles[i]-&gt;Self()] = pfparticles[i];</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  art::FindManyP&lt;sbn::PCAnglePlane&gt; pfparticleAngles(pfparticles, evt, fAngleLabel);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// iterate over each particle</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_part = 0; i_part &lt; pfparticles.size(); i_part++) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    art::Ptr&lt;recob::PFParticle&gt; thisPFP = pfparticles[i_part];</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NEW Particle: &quot;</span> &lt;&lt; thisPFP-&gt;Self() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> std::vector&lt;art::Ptr&lt;sbn::PCAnglePlane&gt;&gt; &amp;thisAngles = pfparticleAngles.at(i_part);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (!thisAngles.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    std::vector&lt;sbn::PCAngleKink&gt; thisKinks;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> art::Ptr&lt;sbn::PCAnglePlane&gt; &amp;<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>: thisAngles) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_branch = 0; i_branch &lt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>-&gt;nBranches; i_branch++) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">// flatten the structure of this branch</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keyword">auto</span> [branchAngles, branch_start] = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a292c3a6e1161e561e421985ed6bc4f6f">FlattenBranch</a>(*<a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>, i_branch, fAllowIncomplete, fMinDist);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordtype">bool</span> in_hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">int</span> hit_start_ind = -1;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_hit = branch_start; i_hit &lt; branchAngles.size(); i_hit++) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="keywordtype">bool</span> this_in_hit = branchAngles[i_hit].angle &gt; fHitThreshold;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="comment">// New hit! set it up</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="keywordflow">if</span> (!in_hit &amp;&amp; this_in_hit) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            hit_start_ind = i_hit;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          <span class="comment">// end of hit! finish it up</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in_hit &amp;&amp; (!this_in_hit || i_hit+1 == branchAngles.size())) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">float</span> height = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a9cccea9fc3b9a3b647eff572d77f0ca9">EstimateHeight</a>(branchAngles, hit_start_ind, i_hit);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">int</span> hi_hit_ind = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af488db0731259cf1b4cde77f0a9d4066">FindFWHMHiIndex</a>(branchAngles, hit_start_ind, i_hit, height, fHitThreshold);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">int</span> lo_hit_ind = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2103e3388fd7f7dba9f956e9689854bb">FindFWHMLoIndex</a>(branchAngles, hit_start_ind, i_hit, height, fHitThreshold);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="comment">// invalid hit</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// check if hit is valid</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">if</span> (hi_hit_ind &gt;= 0 &amp;&amp; lo_hit_ind &gt;= 0) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;NEW KINK: Particle: &quot;</span> &lt;&lt; thisPFP-&gt;Self() &lt;&lt; <span class="stringliteral">&quot; Branch Ind: &quot;</span> &lt;&lt; i_branch &lt;&lt; <span class="stringliteral">&quot; Plane: &quot;</span> &lt;&lt; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a>-&gt;plane.Plane &lt;&lt; std::endl;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;              <a class="code" href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;EST HEIGHT: &quot;</span> &lt;&lt; height &lt;&lt; <span class="stringliteral">&quot; IND LO: &quot;</span> &lt;&lt; lo_hit_ind &lt;&lt; <span class="stringliteral">&quot; IND HI: &quot;</span> &lt;&lt; hi_hit_ind &lt;&lt; std::endl;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;              <span class="comment">// build out the kink information</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;              <span class="keywordtype">int</span> max_ind = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a926789424fe52300af0524f76d546657">FindMaxIndex</a>(branchAngles, lo_hit_ind, hi_hit_ind);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;              <span class="comment">// estimate the track pitch -- distance between successive hits</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;              <span class="keywordtype">float</span> dist_lo_sum = 0.;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = lo_hit_ind; i &lt; max_ind; i++) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                dist_lo_sum += sqrt((branchAngles[i].hit_time_cm - branchAngles[i+1].hit_time_cm) * (branchAngles[i].hit_time_cm - branchAngles[i+1].hit_time_cm) +</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    (branchAngles[i].hit_wire_cm - branchAngles[i+1].hit_wire_cm) * (branchAngles[i].hit_wire_cm - branchAngles[i+1].hit_wire_cm)); </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              <span class="comment">// float pitch_lo = dist_lo_sum / (max_ind - lo_hit_ind);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;              <span class="keywordtype">float</span> dist_hi_sum = 0.;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = max_ind; i &lt; hi_hit_ind; i++) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                dist_hi_sum += sqrt((branchAngles[i].hit_time_cm - branchAngles[i+1].hit_time_cm) * (branchAngles[i].hit_time_cm - branchAngles[i+1].hit_time_cm) +</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    (branchAngles[i].hit_wire_cm - branchAngles[i+1].hit_wire_cm) * (branchAngles[i].hit_wire_cm - branchAngles[i+1].hit_wire_cm)); </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              <span class="comment">// float pitch_hi = dist_hi_sum / (hi_hit_ind - max_ind);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              <span class="keywordtype">float</span> pitch = (dist_lo_sum + dist_hi_sum) / (hi_hit_ind - lo_hit_ind);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <a class="code" href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">sbn::PCAngleKinkFinder::FitResult</a> fit = Fit(branchAngles, lo_hit_ind, hi_hit_ind, max_ind, height, pitch);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              <span class="keyword">const</span> sbn::PCAngle &amp;<a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a> = branchAngles[max_ind];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;              <span class="keyword">const</span> sbn::PCAngle &amp;lo = branchAngles[lo_hit_ind];</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;              <span class="keyword">const</span> sbn::PCAngle &amp;hi = branchAngles[hi_hit_ind];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;              sbn::PCAngleKink kink = <a class="code" href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a08f410413cd36a5d871cd3ef29a7ad8f">BuildKink</a>(max, lo, hi, fit, height);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;              thisKinks.push_back(kink);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;              <span class="comment">// update the hit index to the end of this hit</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;              i_hit = hi_hit_ind;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          in_hit = this_in_hit;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        } </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// save the kinks</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> sbn::PCAngleKink &amp;<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>: thisKinks) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      outKinks-&gt;push_back(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      art::Ptr&lt;sbn::PCAngleKink&gt; thisKinkPtr = kinkPtrMaker(outKinks-&gt;size()-1);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      assn-&gt;addSingle(thisPFP, thisKinkPtr);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  evt.put(std::move(outKinks));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  evt.put(std::move(assn));</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;DEFINE_ART_MODULE(<a class="code" href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">sbn::PCAngleKinkFinder</a>)</div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a122582b454387a1aa6d654e40cac6d14"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a122582b454387a1aa6d654e40cac6d14">sbn::PCAngleKinkFinder::operator=</a></div><div class="ttdeci">PCAngleKinkFinder &amp; operator=(PCAngleKinkFinder const &amp;)=delete</div></div>
<div class="ttc" id="neoSmazza_8sh_html_ae55989c903f0c76190facfb5e5211732"><div class="ttname"><a href="../../de/d71/neoSmazza_8sh.html#ae55989c903f0c76190facfb5e5211732">if</a></div><div class="ttdeci">then if[[&quot;$THISISATEST&quot;==1]]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d71/neoSmazza_8sh_source.html#l00095">neoSmazza.sh:95</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_ae2b5536cd1ea70fb89f128a2ec531390"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae2b5536cd1ea70fb89f128a2ec531390">sbn::PCAngleKinkFinder::Fit</a></div><div class="ttdeci">FitResult Fit(const std::vector&lt; sbn::PCAngle &gt; &amp;angles, unsigned lo, unsigned hi, unsigned center, float est_angle, float est_pitch)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00331">PCAngleKinkFinder_module.cc:331</a></div></div>
<div class="ttc" id="PFParticle_8h_html"><div class="ttname"><a href="../../d8/d5c/PFParticle_8h.html">PFParticle.h</a></div></div>
<div class="ttc" id="build-dunepdsprce_8sh_html_a7540356e7646404cc3d25929740df7e6"><div class="ttname"><a href="../../d6/d2d/build-dunepdsprce_8sh.html#a7540356e7646404cc3d25929740df7e6">flag</a></div><div class="ttdeci">then echo unknown compiler flag</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2d/build-dunepdsprce_8sh_source.html#l00066">build-dunepdsprce.sh:66</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a0ddbf6173a6f039fb658d358693ab499"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a0ddbf6173a6f039fb658d358693ab499">sbn::PCAngleKinkFinder::fPCARadius</a></div><div class="ttdeci">float fPCARadius</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00074">PCAngleKinkFinder_module.cc:74</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_adfd7f067c851e89e090dc30c9dfd3201"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#adfd7f067c851e89e090dc30c9dfd3201">sbn::PCAngleKinkFinder::PCAngleKinkFinder</a></div><div class="ttdeci">PCAngleKinkFinder(fhicl::ParameterSet const &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00275">PCAngleKinkFinder_module.cc:275</a></div></div>
<div class="ttc" id="Hit_8h_html"><div class="ttname"><a href="../../de/d26/Hit_8h.html">Hit.h</a></div><div class="ttdoc">Declaration of signal hit object. </div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a2103e3388fd7f7dba9f956e9689854bb"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2103e3388fd7f7dba9f956e9689854bb">FindFWHMLoIndex</a></div><div class="ttdeci">int FindFWHMLoIndex(const std::vector&lt; sbn::PCAngle &gt; &amp;angles, unsigned start, unsigned end, float amp, float threshold)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00258">PCAngleKinkFinder_module.cc:258</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a926789424fe52300af0524f76d546657"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a926789424fe52300af0524f76d546657">FindMaxIndex</a></div><div class="ttdeci">int FindMaxIndex(const std::vector&lt; sbn::PCAngle &gt; &amp;angles, unsigned lo, unsigned hi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00211">PCAngleKinkFinder_module.cc:211</a></div></div>
<div class="ttc" id="decoderTools__icarus_8fcl_html_a86703f8a44dd6742852257943d5a25c6"><div class="ttname"><a href="../../d5/d79/decoderTools__icarus_8fcl.html#a86703f8a44dd6742852257943d5a25c6">g</a></div><div class="ttdeci">BEGIN_PROLOG g</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d79/decoderTools__icarus_8fcl_source.html#l00007">decoderTools_icarus.fcl:7</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_aa02ba07957cbc77d7d82fd4b0f4b0f2e"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#aa02ba07957cbc77d7d82fd4b0f4b0f2e">fFitDataY</a></div><div class="ttdeci">static std::vector&lt; float &gt; fFitDataY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00087">PCAngleKinkFinder_module.cc:87</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a292c3a6e1161e561e421985ed6bc4f6f"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a292c3a6e1161e561e421985ed6bc4f6f">FlattenBranch</a></div><div class="ttdeci">std::tuple&lt; std::vector&lt; sbn::PCAngle &gt;, unsigned &gt; FlattenBranch(const sbn::PCAnglePlane &amp;plane, unsigned i_branch, bool allow_incomplete, float min_dist)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00121">PCAngleKinkFinder_module.cc:121</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a1895d3f5c1ab079c94bf13d03c21d830"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1895d3f5c1ab079c94bf13d03c21d830">sbn::PCAngleKinkFinder::fAngleLabel</a></div><div class="ttdeci">std::string fAngleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00070">PCAngleKinkFinder_module.cc:70</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_ae106a143ae4766aaab9de1e430809a0d"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ae106a143ae4766aaab9de1e430809a0d">sbn::PCAngleKinkFinder::fMinDist</a></div><div class="ttdeci">float fMinDist</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00072">PCAngleKinkFinder_module.cc:72</a></div></div>
<div class="ttc" id="DetectorPropertiesService_8h_html"><div class="ttname"><a href="../../de/df8/DetectorPropertiesService_8h.html">DetectorPropertiesService.h</a></div></div>
<div class="ttc" id="namespacetrkf_html_a02fec8e0cecf3305fca58a71de0d42c1"><div class="ttname"><a href="../../d0/da2/namespacetrkf.html#a02fec8e0cecf3305fca58a71de0d42c1">trkf::trace</a></div><div class="ttdeci">M::value_type trace(const M &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/KalmanLinearAlgebra_8h_source.html#l00231">KalmanLinearAlgebra.h:231</a></div></div>
<div class="ttc" id="GeometryCore_8h_html"><div class="ttname"><a href="../../db/de7/GeometryCore_8h.html">GeometryCore.h</a></div><div class="ttdoc">Access the description of detector geometry. </div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a2c284bd01d283cd0362ccd747621459c"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a2c284bd01d283cd0362ccd747621459c">FitLikelihood</a></div><div class="ttdeci">void FitLikelihood(int &amp;npar, double *g, double &amp;result, double *par, int flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00316">PCAngleKinkFinder_module.cc:316</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html">sbn::PCAngleKinkFinder</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00046">PCAngleKinkFinder_module.cc:46</a></div></div>
<div class="ttc" id="structsbn_1_1PCAngleKinkFinder_1_1FitResult_html_a1b198eac587b5c33e7a0483ee570e4bc"><div class="ttname"><a href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a1b198eac587b5c33e7a0483ee570e4bc">sbn::PCAngleKinkFinder::FitResult::pitch</a></div><div class="ttdeci">float pitch</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00064">PCAngleKinkFinder_module.cc:64</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_ab1efb71b6287662017ad303105dcb562"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#ab1efb71b6287662017ad303105dcb562">fFitCenter</a></div><div class="ttdeci">static unsigned fFitCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00088">PCAngleKinkFinder_module.cc:88</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="structsbn_1_1PCAngleKinkFinder_1_1FitResult_html_a7c9d1124432cbc58b16231a34783285a"><div class="ttname"><a href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a7c9d1124432cbc58b16231a34783285a">sbn::PCAngleKinkFinder::FitResult::angle</a></div><div class="ttdeci">float angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00063">PCAngleKinkFinder_module.cc:63</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a1b5c386b81890c9373bbb1169d2cd422"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1b5c386b81890c9373bbb1169d2cd422">sbn::PCAngleKinkFinder::fHitThreshold</a></div><div class="ttdeci">float fHitThreshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00071">PCAngleKinkFinder_module.cc:71</a></div></div>
<div class="ttc" id="Cluster_8h_html"><div class="ttname"><a href="../../d8/d77/Cluster_8h.html">Cluster.h</a></div><div class="ttdoc">Declaration of cluster object. </div></div>
<div class="ttc" id="Vertex_8h_html"><div class="ttname"><a href="../../d9/d2d/Vertex_8h.html">Vertex.h</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_af619d7120baf900f2fab4cfc4a287315"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af619d7120baf900f2fab4cfc4a287315">ExpectedCosAngle</a></div><div class="ttdeci">double ExpectedCosAngle(double dist_to_center, double radius, double mean_distance, double angle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00290">PCAngleKinkFinder_module.cc:290</a></div></div>
<div class="ttc" id="structsbn_1_1PCAngleKinkFinder_1_1FitResult_html_a4fee8f8bc0f72f37c7f98a4e73aa5eac"><div class="ttname"><a href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html#a4fee8f8bc0f72f37c7f98a4e73aa5eac">sbn::PCAngleKinkFinder::FitResult::chi2</a></div><div class="ttdeci">float chi2</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00062">PCAngleKinkFinder_module.cc:62</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_ad7a5c9e90fa48257a45b2035244d4e04"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#ad7a5c9e90fa48257a45b2035244d4e04">sbn::PCAngleKinkFinder::fAllowIncomplete</a></div><div class="ttdeci">bool fAllowIncomplete</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00073">PCAngleKinkFinder_module.cc:73</a></div></div>
<div class="ttc" id="lardata_2lardata_2Utilities_2AssociationUtil_8h_html"><div class="ttname"><a href="../../d5/d9c/lardata_2lardata_2Utilities_2AssociationUtil_8h.html">AssociationUtil.h</a></div></div>
<div class="ttc" id="structsbn_1_1PCAngleKinkFinder_1_1FitResult_html"><div class="ttname"><a href="../../d9/de3/structsbn_1_1PCAngleKinkFinder_1_1FitResult.html">sbn::PCAngleKinkFinder::FitResult</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00061">PCAngleKinkFinder_module.cc:61</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="Wire_8h_html"><div class="ttname"><a href="../../da/d9f/Wire_8h.html">Wire.h</a></div><div class="ttdoc">Declaration of basic channel signal object. </div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_abfae2e504dfa44c403614b6cd601f99e"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#abfae2e504dfa44c403614b6cd601f99e">angle</a></div><div class="ttdeci">finds tracks best matching by angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00064">trackfinderalgorithms.fcl:64</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a5330823f7b678cfbf0eb77c41ee8f664"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a5330823f7b678cfbf0eb77c41ee8f664">fFitDataX</a></div><div class="ttdeci">static std::vector&lt; float &gt; fFitDataX</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00086">PCAngleKinkFinder_module.cc:86</a></div></div>
<div class="ttc" id="namespacetca_html_a3bc30aeace71ea50324b602afa2155f2"><div class="ttname"><a href="../../de/d0f/namespacetca.html#a3bc30aeace71ea50324b602afa2155f2">tca::evt</a></div><div class="ttdeci">TCEvent evt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/DataStructs_8cxx_source.html#l00007">DataStructs.cxx:7</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a122a7b8666811f02fba2c0fcdc485d17"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a122a7b8666811f02fba2c0fcdc485d17">k</a></div><div class="ttdeci">pdgs k</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a4ebfae48bdf6693a15625fa99aff5469"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a4ebfae48bdf6693a15625fa99aff5469">sbn::PCAngleKinkFinder::produce</a></div><div class="ttdeci">void produce(art::Event &amp;e) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00375">PCAngleKinkFinder_module.cc:375</a></div></div>
<div class="ttc" id="namespacelib_1_1dedx_html_a62b15446ae03a5857d5e03fa30b03fd4"><div class="ttname"><a href="../../d3/d5d/namespacelib_1_1dedx.html#a62b15446ae03a5857d5e03fa30b03fd4">lib.dedx.A</a></div><div class="ttdeci">float A</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/dedx_8py_source.html#l00137">dedx.py:137</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a08f410413cd36a5d871cd3ef29a7ad8f"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a08f410413cd36a5d871cd3ef29a7ad8f">BuildKink</a></div><div class="ttdeci">sbn::PCAngleKink BuildKink(const sbn::PCAngle &amp;max, const sbn::PCAngle &amp;lo, const sbn::PCAngle &amp;hi, const sbn::PCAngleKinkFinder::FitResult &amp;fit, float est_angle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00091">PCAngleKinkFinder_module.cc:91</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_a9cccea9fc3b9a3b647eff572d77f0ca9"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#a9cccea9fc3b9a3b647eff572d77f0ca9">EstimateHeight</a></div><div class="ttdeci">float EstimateHeight(const std::vector&lt; sbn::PCAngle &gt; &amp;angles, unsigned lo, unsigned hi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00189">PCAngleKinkFinder_module.cc:189</a></div></div>
<div class="ttc" id="PCAngleKinkFinder__module_8cc_html_af488db0731259cf1b4cde77f0a9d4066"><div class="ttname"><a href="../../d3/d01/PCAngleKinkFinder__module_8cc.html#af488db0731259cf1b4cde77f0a9d4066">FindFWHMHiIndex</a></div><div class="ttdeci">int FindFWHMHiIndex(const std::vector&lt; sbn::PCAngle &gt; &amp;angles, unsigned start, unsigned end, float amp, float threshold)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00238">PCAngleKinkFinder_module.cc:238</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="messageservice_8fcl_html_a6699b4dbd72f548e48d81c88697d35a6"><div class="ttname"><a href="../../d8/df5/messageservice_8fcl.html#a6699b4dbd72f548e48d81c88697d35a6">cout</a></div><div class="ttdeci">BEGIN_PROLOG could also be cout</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df5/messageservice_8fcl_source.html#l00010">messageservice.fcl:10</a></div></div>
<div class="ttc" id="DetectorPropertiesStandard_8h_html"><div class="ttname"><a href="../../d7/df8/DetectorPropertiesStandard_8h.html">DetectorPropertiesStandard.h</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_aa3c2c1d9c1952453f05d25d0697e6a94"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#aa3c2c1d9c1952453f05d25d0697e6a94">sbn::PCAngleKinkFinder::fPFParticleLabel</a></div><div class="ttdeci">std::string fPFParticleLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00069">PCAngleKinkFinder_module.cc:69</a></div></div>
<div class="ttc" id="classsbn_1_1PCAngleKinkFinder_html_a1dcc0d53fb4534dcbea8095beb456e67"><div class="ttname"><a href="../../db/d2e/classsbn_1_1PCAngleKinkFinder.html#a1dcc0d53fb4534dcbea8095beb456e67">sbn::PCAngleKinkFinder::fFitResolution</a></div><div class="ttdeci">float fFitResolution</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d01/PCAngleKinkFinder__module_8cc_source.html#l00075">PCAngleKinkFinder_module.cc:75</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
