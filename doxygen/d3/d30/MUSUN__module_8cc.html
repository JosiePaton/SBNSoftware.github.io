<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MUSUN_module.cc File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_c1de2b5dcb01608846a246cb763d5e03.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_64cfb79233dad4b4de390a7389ba145b.html">larsim</a></li><li class="navelem"><a class="el" href="../../dir_1fc11aff3195d2e0fc7aa7adbcbf7259.html">EventGenerator</a></li><li class="navelem"><a class="el" href="../../dir_0616d0d2dcf5d264f9abe3aa595815cd.html">MuonPropagation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">MUSUN_module.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generator for underground muon propagation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;cstdlib&gt;</code><br/>
<code>#include &lt;exception&gt;</code><br/>
<code>#include &lt;fstream&gt;</code><br/>
<code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;memory&gt;</code><br/>
<code>#include &lt;sstream&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>
<code>#include &quot;art/Framework/Core/EDProducer.h&quot;</code><br/>
<code>#include &quot;art/Framework/Core/ModuleMacros.h&quot;</code><br/>
<code>#include &quot;art/Framework/Principal/Event.h&quot;</code><br/>
<code>#include &quot;art/Framework/Principal/Run.h&quot;</code><br/>
<code>#include &quot;art/Framework/Services/Registry/ServiceHandle.h&quot;</code><br/>
<code>#include &quot;art_root_io/TFileService.h&quot;</code><br/>
<code>#include &quot;cetlib_except/exception.h&quot;</code><br/>
<code>#include &quot;fhiclcpp/ParameterSet.h&quot;</code><br/>
<code>#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</code><br/>
<code>#include &quot;nurandom/RandomUtils/NuRandomService.h&quot;</code><br/>
<code>#include &quot;nusimdata/SimulationBase/MCParticle.h&quot;</code><br/>
<code>#include &quot;nusimdata/SimulationBase/MCTruth.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d3/d8b/Geometry_8h_source.html">larcore/Geometry/Geometry.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../da/d86/RunData_8h_source.html">larcoreobj/SummaryData/RunData.h</a>&quot;</code><br/>
<code>#include &quot;TDatabasePDG.h&quot;</code><br/>
<code>#include &quot;TTree.h&quot;</code><br/>
<code>#include &quot;CLHEP/Random/RandFlat.h&quot;</code><br/>
<code>#include &quot;CLHEP/Random/RandGaussQ.h&quot;</code><br/>
</div>
<p><a href="../../d3/d30/MUSUN__module_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d70/classevgen_1_1MUSUN.html">evgen::MUSUN</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">module to produce single or multiple specified particles in the detector  <a href="../../d3/d70/classevgen_1_1MUSUN.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:d3/d88/namespacesimb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d88/namespacesimb.html">simb</a></td></tr>
<tr class="memdesc:d3/d88/namespacesimb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Framework includes. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/d4d/namespaceevgen"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html">evgen</a></td></tr>
<tr class="memdesc:d4/d4d/namespaceevgen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event Generation using GENIE, cosmics or single particles. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a69f62af6e1d181d3e95e489a802c2319"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a69f62af6e1d181d3e95e489a802c2319">evgen::fChargeRatio</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;ChargeRatio&quot;)}</td></tr>
<tr class="separator:a69f62af6e1d181d3e95e489a802c2319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9274582d9ca3dd8c12ce364be04738"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a9e9274582d9ca3dd8c12ce364be04738">evgen::fInputFile1</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;std::string&gt;(&quot;InputFile1&quot;)}</td></tr>
<tr class="separator:a9e9274582d9ca3dd8c12ce364be04738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadf369bba16c5d972e7e54ffe1b968bf"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#aadf369bba16c5d972e7e54ffe1b968bf">evgen::fInputFile2</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;std::string&gt;(&quot;InputFile2&quot;)}</td></tr>
<tr class="separator:aadf369bba16c5d972e7e54ffe1b968bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adac8cf7df10e281ac00807adb1f2b32d"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#adac8cf7df10e281ac00807adb1f2b32d">evgen::fInputFile3</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;std::string&gt;(&quot;InputFile3&quot;)}</td></tr>
<tr class="separator:adac8cf7df10e281ac00807adb1f2b32d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887cb4dc38552db5456d0f40c6ae9db9"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a887cb4dc38552db5456d0f40c6ae9db9">evgen::fCavernAngle</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;CavernAngle&quot;)}</td></tr>
<tr class="separator:a887cb4dc38552db5456d0f40c6ae9db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d3c1db8c181cabbf72efe3dd849d138"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a1d3c1db8c181cabbf72efe3dd849d138">evgen::fRockDensity</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;RockDensity&quot;)}</td></tr>
<tr class="separator:a1d3c1db8c181cabbf72efe3dd849d138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b84c083709cf7518e1a38bd0dee11bf"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a2b84c083709cf7518e1a38bd0dee11bf">evgen::fPhimin</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Phimin&quot;)}</td></tr>
<tr class="separator:a2b84c083709cf7518e1a38bd0dee11bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7afc4ea0b6e94dc431ea5ad8ed99d818"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a7afc4ea0b6e94dc431ea5ad8ed99d818">evgen::fPhimax</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Phimax&quot;)}</td></tr>
<tr class="separator:a7afc4ea0b6e94dc431ea5ad8ed99d818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b225456d310586a8f57d52b5880e810"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a6b225456d310586a8f57d52b5880e810">evgen::figflag</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;int&gt;(&quot;igflag&quot;)}</td></tr>
<tr class="separator:a6b225456d310586a8f57d52b5880e810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fd7a8eafb615d160c1121bbd686134"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a53fd7a8eafb615d160c1121bbd686134">evgen::fXmin</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Xmin&quot;)}</td></tr>
<tr class="separator:a53fd7a8eafb615d160c1121bbd686134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636bea5102d2ef2e02954913a5d511ed"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a636bea5102d2ef2e02954913a5d511ed">evgen::fYmin</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Ymin&quot;)}</td></tr>
<tr class="separator:a636bea5102d2ef2e02954913a5d511ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850101ee23f49670ca3cd2ead2641a90"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a850101ee23f49670ca3cd2ead2641a90">evgen::fZmin</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Zmin&quot;)}</td></tr>
<tr class="separator:a850101ee23f49670ca3cd2ead2641a90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b83ab4555548975c249d95fab6bcce"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a62b83ab4555548975c249d95fab6bcce">evgen::fXmax</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Xmax&quot;)}</td></tr>
<tr class="separator:a62b83ab4555548975c249d95fab6bcce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c9589cd9e565b76bb7b7f59b066f843"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#a3c9589cd9e565b76bb7b7f59b066f843">evgen::fYmax</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Ymax&quot;)}</td></tr>
<tr class="separator:a3c9589cd9e565b76bb7b7f59b066f843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6f5b61cf3b77582451a031460757c6"><td class="memItemLeft" align="right" valign="top">createEngine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/namespaceevgen.html#aae6f5b61cf3b77582451a031460757c6">evgen::fZmax</a> {<a class="el" href="../../db/d87/PMTconfigurationExtraction__module_8cc.html#ac33ee765f5ad9f134540bac393721cfe">pset.get</a>&lt;double&gt;(&quot;Zmax&quot;)}</td></tr>
<tr class="separator:aae6f5b61cf3b77582451a031460757c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generator for underground muon propagation. </p>
<p>Module designed to propagate muons underground</p>
<p>For a description of how to use the module see <a class="el" href="../../dd/d47/namespaceDUNE.html">DUNE</a> DocDB It is highly recommended that you read it before use.....</p>
<p>Original MUSUN code was written by Vitaly A. Kudryavtsev (University of Sheffield). Conversion from Fortran to C was done by Kareem Kazkaz (LLNL) with help from David Woodward (Sheffield) Default slant depths and surface profile work done Martin Richardson (Sheffield) Notable contributions to surface map profiling also made by Chao Zhang (USD) and Jeff de Jong (Oxford) Interfaced with LArSoft by Karl Warburton (University of Sheffield) with necessary changes. ---------&mdash;START OF NECCESSARY CHANGES------------&mdash; Changing variables to fcl parameters Restructuring to fit LArSoft design Co-ordinate transformation... y -&gt; x, x -&gt; z, z -&gt; y ????SHOULD BE x -&gt; -z AS PER VITALY???? Restore cavern angle convention to Vitaly's definition. ---------&mdash;END OF NECCESSARY CHANGES--------------&mdash; </p>
<dl class="section author"><dt>Author</dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'k.w'+'ar'+'bur'+'to'+'n@s'+'he'+'ffi'+'el'+'d.a'+'c.'+'uk'; return false;">k.war<span style="display: none;">.nosp@m.</span>burt<span style="display: none;">.nosp@m.</span>on@sh<span style="display: none;">.nosp@m.</span>effi<span style="display: none;">.nosp@m.</span>eld.a<span style="display: none;">.nosp@m.</span>c.uk</a></dd></dl>
<p>Further Notes - Taken from Kareem Kazkaz;</p>
<p>This C++ code is a port of the musun-surf.f and test-musun-surf.f code written by Vitaly Kudryavtsev of the University of Sheffield. It generates muons with energy, position, and direction specific to the Davis cavern at the Sanford Underground Research Facility in Lead, South Dakota.</p>
<p>This C++ code was ported by Kareem Kazkaz, <a href="#" onclick="location.href='mai'+'lto:'+'kar'+'ee'+'m@l'+'ln'+'l.g'+'ov'; return false;">karee<span style="display: none;">.nosp@m.</span>m@ll<span style="display: none;">.nosp@m.</span>nl.go<span style="display: none;">.nosp@m.</span>v</a>, (925) 422-7208</p>
<p>Here are the notes from Vitaly:</p>
<p>c The code samples single atmospheric muons at the SURF c underground laboratory (Davis' cavern) c (taking into account the slant depth distribution) c in the energy range E1-E2, zenith angle range theta1-theta2 (0-90 degrees) c and azimuthal angle range phi1-phi2 (0-360 degrees). c At present only the following ranges of parameters are supported: c E1 = 1 GeV, E2 = 10^6 GeV, theta1 = 0, theta2 = 90 deg, phi1 = 0, phi2 = 360 deg. c c Program uses muon energy spectra at various depths and zenith c angles obtained with MUSIC code for muon propagation and Gaisser's c formula for muon spectrum at sea level c (T.K.Gaisser, Cosmic Rays and Particle Physics, Cambridge c University Press, 1990) modified for large zenith angles and c prompt muon flux with normalisation and spectral index c that fit LVD data: gamma = 2.77, A = 0.14. c Density of rock is assumed to be 2.70 g/cm^3 but can be changed c during initialisation (previous step, ask the author). c c Muon flux through a sphere (Chao's coordinates) = 6.33x10^(-9) cm^(-2) s^(-1) (gamma=2.77) - old c Muon flux through a sphere (Martin's coordinates) = 6.16x10^(-9) cm^(-2) s^(-1) (gamma=2.77) - new c Muon flux through the cuboid (30x22x24 m^3) = 0.0588 s^(-1) (gamma=2.77) c c Note: the muon spectrum at sea level does not take into account c the change of the primary spectrum slope at and above the knee c region (3*10^15-10^16 eV). c c Program uses the tables of muon energy spectra at various c zenith and azimuthal angles at SURF c calculated with the muon propagation code MUSIC and the c angular distribution of muon intensities at SURF (4850 ft level). c c Coordinate system for the muon intensities c is determined by the mountain profile provided c by Chao Zhang (USD, South Dakota): x-axis is pointing to the East. c Muons are sampled on a surface of a rectangular parallelepiped, c the planes of which are parallel to the walls of the cavern. c The long side of the cavern is pointing at 6.6 deg from the North c to the East (or 90 - 6.6 deg from the East to the North). c Muon coordinates and direction cosines are then given in the c coordinate system related to the cavern with x-axis c pointing along the long side of the cavern at 6.6 deg from the c North to the East. c The angle phi is measured from the positive x-axis towards c positive y-axis (0-360 deg). c Z-axis is pointing upwards.</p>
<p>Further notes taken from Vitaly's original code, as written for LBNE (note the differing definition for theta, which is used here, theta is measured from East to South, not North to East. c c The code samples single atmospheric muons at the LBNE c underground site (taking into account the slant depth c distribution calculated by Martin Richardson, Sheffield) c in the energy range E1-E2, zenith angle range theta1-theta2 (0-90 degrees) c and azimuthal angle range phi1-phi2 (0-360 degrees). c At present only the following ranges of parameters are supported: c E1 = 1 GeV, E2 = 10^6 GeV, theta1 = 0, theta2 = 90 deg, phi1 = 0, phi2 = 360 deg. c c The LBNE far detector site has coordinates: c Latitude = 44° 20' 45.21" N
c       Longitude = 103° 45' 16.13" W c Elevation = 355.8 ft (108.4 m) c from e-mail from Virgil Bocean on 30 May 2013 c confirmed by Tracy Lundin on 16 December 2013 c c For slant depth distribution and muon intensities the azimuthal c angle phi is calculated from East to North. c The long side of the cavern is assumed to be pointing to the c beam (Fermilab) at an angle of 7 deg to the South from the c East. c Muon direction cosines are given in the coordinate system c related to the cavern with positive x-axis pointing to the beam c so direction cosine wrt x-axis is -1 if a muon is coming in the c same direction (wrt to x-axis) as the neutrino beam. c c c Program uses muon energy spectra at various depths and zenith c angles obtained with MUSIC code for muon propagation and Gaisser's c formula for muon spectrum at sea level c (T.K.Gaisser, Cosmic Rays and Particle Physics, Cambridge c University Press, 1990) modified for large zenith angles and c prompt muon flux with parameters from the best fit to the LVD data. c c Muon flux through a sphere = 6.65x10^(-9) cm^(-2) s^(-1) (gamma=2.77) - old c Muon flux through a sphere = 6.65x10^(-9) cm^(-2) s^(-1) (gamma=2.77) - new c Muon flux through the cuboid (100x40x50 m^3) = 0.3074 s^(-1) (gamma=2.77) c c Note: the muon spectrum at sea level does not take into account c the change of the primary spectrum slope at and above the knee c region (3*10^15-10^16 eV). c c Program uses the tables of muon energy spectra at various c zenith and azimuthal angles at DUSEL c calculated with the muon propagation code MUSIC and the c angular distribution of muon intensities at 4850 ft level c (location of the LBNE far detector). c c Coordinate system is determined by the mountain profile provided c by Jeff de Jong (Cambridge) and Chao Zhang (USD, South Dakota). c This is done to allow the simulation of muons on a surface of c a rectangular parallelepiped, the planes of which are parallel c to the walls of the laboratory halls. c The angle phi in the slant depth distribution file is measured c from the positive x-axis towards positive y-axis. c Z-axis is pointing upwards. c Note that I use here the azimuthal angle range from 0 to 360 deg. c </p>

<p>Definition in file <a class="el" href="../../d3/d30/MUSUN__module_8cc_source.html">MUSUN_module.cc</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
