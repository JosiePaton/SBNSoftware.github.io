<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>phot::PhotonLibraryPropagation Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d7c/namespacephot.html">phot</a></li><li class="navelem"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d0/d5b/classphot_1_1PhotonLibraryPropagation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">phot::PhotonLibraryPropagation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Fast simulation of propagating the photons created from SimEnergyDeposits.  
 <a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for phot::PhotonLibraryPropagation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d3/d37/classphot_1_1PhotonLibraryPropagation.png" usemap="#phot::PhotonLibraryPropagation_map" alt=""/>
  <map id="phot::PhotonLibraryPropagation_map" name="phot::PhotonLibraryPropagation_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7fb4ea3e6a9d036168e4953d0bbf987b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a7fb4ea3e6a9d036168e4953d0bbf987b">PhotonLibraryPropagation</a> (fhicl::ParameterSet const &amp;)</td></tr>
<tr class="separator:a7fb4ea3e6a9d036168e4953d0bbf987b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873bbdd39a8a0fba0a2557d7cb8f79c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a873bbdd39a8a0fba0a2557d7cb8f79c2">PhotonLibraryPropagation</a> (<a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> const &amp;)=delete</td></tr>
<tr class="separator:a873bbdd39a8a0fba0a2557d7cb8f79c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ba8236095bd6e147a4c071df24b8ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a84ba8236095bd6e147a4c071df24b8ad">PhotonLibraryPropagation</a> (<a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a84ba8236095bd6e147a4c071df24b8ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4a5e06bfd003366c8424f15bfeadac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a7a4a5e06bfd003366c8424f15bfeadac">operator=</a> (<a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> const &amp;)=delete</td></tr>
<tr class="separator:a7a4a5e06bfd003366c8424f15bfeadac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcafc9bef863bd2ac0b1c1a7a683d83d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#adcafc9bef863bd2ac0b1c1a7a683d83d">operator=</a> (<a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:adcafc9bef863bd2ac0b1c1a7a683d83d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab866f179032c9c08090e511088af8a9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ab866f179032c9c08090e511088af8a9d">produce</a> (art::Event &amp;) override</td></tr>
<tr class="separator:ab866f179032c9c08090e511088af8a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad10836f9d99cea5f3f377fab7ade6fc5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">fRiseTimeFast</a></td></tr>
<tr class="separator:ad10836f9d99cea5f3f377fab7ade6fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df92026d584d746362ac35a78d7279a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">fRiseTimeSlow</a></td></tr>
<tr class="separator:a3df92026d584d746362ac35a78d7279a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674203360e09b4cba0d6cb3d889efe83"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">fDoSlowComponent</a></td></tr>
<tr class="separator:a674203360e09b4cba0d6cb3d889efe83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9474b2a5b7731b87ff34ed668bb6d4ba"><td class="memItemLeft" align="right" valign="top">vector&lt; art::InputTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a9474b2a5b7731b87ff34ed668bb6d4ba">fEDepTags</a></td></tr>
<tr class="separator:a9474b2a5b7731b87ff34ed668bb6d4ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1605728ef04b225a1ac29dae283301"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d26/classlarg4_1_1ISCalcSeparate.html">larg4::ISCalcSeparate</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#adf1605728ef04b225a1ac29dae283301">fISAlg</a></td></tr>
<tr class="separator:adf1605728ef04b225a1ac29dae283301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a807c70cce3f593daa3cb3a7e05720863"><td class="memItemLeft" align="right" valign="top">CLHEP::HepRandomEngine &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a807c70cce3f593daa3cb3a7e05720863">fPhotonEngine</a></td></tr>
<tr class="separator:a807c70cce3f593daa3cb3a7e05720863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d91be2f3bb482e517c47c4d85db8bc3"><td class="memItemLeft" align="right" valign="top">CLHEP::HepRandomEngine &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a1d91be2f3bb482e517c47c4d85db8bc3">fScintTimeEngine</a></td></tr>
<tr class="separator:a1d91be2f3bb482e517c47c4d85db8bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Fast simulation of propagating the photons created from SimEnergyDeposits. </p>
<p>This module does a fast simulation of propagating the photons created from SimEnergyDeposits, which is the Geant4 output after each step, to each of the optical detectors. This simulation is done using the <a class="el" href="../../d4/d30/classphot_1_1PhotonLibrary.html">PhotonLibrary</a>, which stores the visibilities of each optical channel with respect to each optical voxel in the TPC volume, to avoid propagating single photons using Geant4. At the end of this module a collection of the propagated photons either as <code><a class="el" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html" title="Compact representation of photons on a channel. ">sim::SimPhotonsLite</a></code> or as <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> is placed into the art event.</p>
<p>Keep in mind that at this stage the LArG4 main module is not capable of running the full optical simulation, because the necessary code has not yet been written.</p>
<p>In the future when the <a class="el" href="../../d4/d30/classphot_1_1PhotonLibrary.html">PhotonLibrary</a> has the propagation time included, it could be possible to enhance <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> and <code><a class="el" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html" title="Compact representation of photons on a channel. ">sim::SimPhotonsLite</a></code> to contain the propagation time. At this point the time recorded for the photon is the creation time of the photon.</p>
<p>The steps this module takes are:</p>
<ul>
<li>to take <code>sim::SimEnergyDeposits</code> produced by larg4Main,</li>
<li>use Ionisation and Scintillation to calculate the amount of scintillated photons,</li>
<li>use the <a class="el" href="../../d4/d30/classphot_1_1PhotonLibrary.html">PhotonLibrary</a> (visibilities) to determine the amount of visible photons at each optical channel,<ul>
<li>visible photons = the amount of scintillated photons calculated times the visibility at the middle of the Geant4 step for a given optical channel.</li>
</ul>
</li>
<li>and if <code><a class="el" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html" title="Compact representation of photons on a channel. ">sim::SimPhotonsLite</a></code> produced:<ul>
<li>since a <code><a class="el" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html" title="Compact representation of photons on a channel. ">sim::SimPhotonsLite</a></code> only keeps a set of times with the number of photons produced at each time for a given OpChannel number:<ul>
<li>for each time (as an integer in [ns]) photons are produced along the Geant4 step (taking into account the rise time and decay time of the fast and slow components of the scintillation process),</li>
<li>count the amount of photons emitted at that time.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>the total amount of visible photons produced during the current Geant4 step equals the sum of counts for each time.</p>
<ul>
<li>the total amount of visible photons produced during the current Geant4 step is determined by throwing a random number from a Poisson distribution with a mean of the amount of visible photons calculated above.</li>
</ul>
<p>and if <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> produced:</p>
<ul>
<li>since a <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> keeps a collection of photons (<code><a class="el" href="../../d4/d00/structsim_1_1OnePhoton.html" title="All information of a photon entering the sensitive optical detector volume. ">sim::OnePhoton</a></code>) for a given OpChannel number:<ul>
<li>each single photon produced by this algorithm is just a copy containing the same information about:<ul>
<li>energy (set to a constant value = 9.7e-6, which is equivalent to a wavelength of 128 nm, it should actually be 126.6 nm!!),</li>
<li>initial position,</li>
<li>time (as an integer in [ns]) the photon is produced along the Geant4 Step (taking into account the rise time and decay time of the fast and slow components of the scintillation process),</li>
</ul>
</li>
<li>the total amount of photon copies produced during the current Geant4 step is determined by throwing a random number from a Poisson distribution with a mean of the amount of visible photons calculated above.</li>
</ul>
</li>
</ul>
<p>This module should only be run for the fast optical simulation even though it can create <code><a class="el" href="../../d7/d6b/classsim_1_1SimPhotonsLite.html" title="Compact representation of photons on a channel. ">sim::SimPhotonsLite</a></code> and <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> as data products. If there is need to create <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code>, there are some considerations you must be aware of. Since the amount of <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> produced even at low energies and in small geometries quickly exceeds the memory capacity of the job, right now it is actually impossible to produce <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code> for any realistic geometry. A possible way around the problem is to implement a scaling of the produced <code><a class="el" href="../../d3/dd1/classsim_1_1SimPhotons.html" title="Collection of photons which recorded on one channel. ">sim::SimPhotons</a></code>, to only produce a fraction of them. </p>

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00145">145</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7fb4ea3e6a9d036168e4953d0bbf987b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">phot::PhotonLibraryPropagation::PhotonLibraryPropagation </td>
          <td>(</td>
          <td class="paramtype">fhicl::ParameterSet const &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00165">165</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    : art::EDProducer{<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>}</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    , <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">fRiseTimeFast</a>{<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;RiseTimeFast&quot;</span>, 0.0)}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    , <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">fRiseTimeSlow</a>{<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;RiseTimeSlow&quot;</span>, 0.0)}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    , <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">fDoSlowComponent</a>{<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;DoSlowComponent&quot;</span>)}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    , <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a9474b2a5b7731b87ff34ed668bb6d4ba">fEDepTags</a>{<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>.get&lt;vector&lt;art::InputTag&gt;&gt;(<span class="stringliteral">&quot;EDepModuleLabels&quot;</span>)}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    , <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a807c70cce3f593daa3cb3a7e05720863">fPhotonEngine</a>(art::ServiceHandle&lt;rndm::NuRandomService&gt; {}</div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_ad10836f9d99cea5f3f377fab7ade6fc5"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">phot::PhotonLibraryPropagation::fRiseTimeFast</a></div><div class="ttdeci">double fRiseTimeFast</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00147">PhotonLibraryPropagation_module.cc:147</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a3df92026d584d746362ac35a78d7279a"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">phot::PhotonLibraryPropagation::fRiseTimeSlow</a></div><div class="ttdeci">double fRiseTimeSlow</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00148">PhotonLibraryPropagation_module.cc:148</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a9474b2a5b7731b87ff34ed668bb6d4ba"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a9474b2a5b7731b87ff34ed668bb6d4ba">phot::PhotonLibraryPropagation::fEDepTags</a></div><div class="ttdeci">vector&lt; art::InputTag &gt; fEDepTags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00150">PhotonLibraryPropagation_module.cc:150</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a807c70cce3f593daa3cb3a7e05720863"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a807c70cce3f593daa3cb3a7e05720863">phot::PhotonLibraryPropagation::fPhotonEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fPhotonEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00152">PhotonLibraryPropagation_module.cc:152</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a674203360e09b4cba0d6cb3d889efe83"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">phot::PhotonLibraryPropagation::fDoSlowComponent</a></div><div class="ttdeci">bool fDoSlowComponent</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00149">PhotonLibraryPropagation_module.cc:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a873bbdd39a8a0fba0a2557d7cb8f79c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">phot::PhotonLibraryPropagation::PhotonLibraryPropagation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> const &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a84ba8236095bd6e147a4c071df24b8ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">phot::PhotonLibraryPropagation::PhotonLibraryPropagation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7a4a5e06bfd003366c8424f15bfeadac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a>&amp; phot::PhotonLibraryPropagation::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> const &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="adcafc9bef863bd2ac0b1c1a7a683d83d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a>&amp; phot::PhotonLibraryPropagation::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html">PhotonLibraryPropagation</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab866f179032c9c08090e511088af8a9d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void phot::PhotonLibraryPropagation::produce </td>
          <td>(</td>
          <td class="paramtype">art::Event &amp;&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00185">185</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    art::ServiceHandle&lt;PhotonVisibilityService const&gt; pvs;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    art::ServiceHandle&lt;sim::LArG4Parameters const&gt; lgp;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>* larp = lar::providerFrom&lt;detinfo::LArPropertiesService&gt;();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detProp</a> = art::ServiceHandle&lt;detinfo::DetectorPropertiesService const&gt;()-&gt;DataFor(<a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    CLHEP::RandPoissonQ randpoisphot{<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a807c70cce3f593daa3cb3a7e05720863">fPhotonEngine</a>};</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    CLHEP::RandFlat randflatscinttime{<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a1d91be2f3bb482e517c47c4d85db8bc3">fScintTimeEngine</a>};</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> nOpChannels = pvs-&gt;NOpChannels();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    unique_ptr&lt;vector&lt;sim::SimPhotons&gt;&gt; photCol{<span class="keyword">new</span> vector&lt;sim::SimPhotons&gt;{}};</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">auto</span>&amp; photonCollection{*photCol};</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    photonCollection.resize(nOpChannels);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    unique_ptr&lt;vector&lt;sim::SimPhotonsLite&gt;&gt; photLiteCol{<span class="keyword">new</span> vector&lt;sim::SimPhotonsLite&gt;{}};</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">auto</span>&amp; photonLiteCollection{*photLiteCol};</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    photonLiteCollection.resize(nOpChannels);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nOpChannels; ++i) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      photonLiteCollection[i].OpChannel = i;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      photonCollection[i].SetChannel(i);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    vector&lt;vector&lt;sim::SimEnergyDeposit&gt; <span class="keyword">const</span>*&gt; edep_vecs;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> label : <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a9474b2a5b7731b87ff34ed668bb6d4ba">fEDepTags</a>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; edep_handle = <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.getValidHandle&lt;vector&lt;sim::SimEnergyDeposit&gt;&gt;(label);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      edep_vecs.push_back(edep_handle);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; edeps : edep_vecs) { <span class="comment">//loop over modules</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; edep : *edeps) {   <span class="comment">//loop over energy deposits: one per step</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">//int count_onePhot =0; // unused</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a> = edep.MidPoint();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; Visibilities = pvs-&gt;GetAllVisibilities(<a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (!Visibilities) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;PhotonLibraryPropagation&quot;</span>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;There is no entry in the PhotonLibrary for this position in space. &quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;               <span class="stringliteral">&quot;Position: &quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            &lt;&lt; edep.MidPoint();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> isCalcData = <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#adf1605728ef04b225a1ac29dae283301">fISAlg</a>.<a class="code" href="../../de/d26/classlarg4_1_1ISCalcSeparate.html#a763e292f61c076363f562d6fbf686053">CalcIonAndScint</a>(detProp, edep);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">//total amount of scintillation photons</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordtype">double</span> nphot = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(isCalcData.numPhotons);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">//amount of scintillated photons created via the fast scintillation process</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordtype">double</span> nphot_fast = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(GetScintYield(edep, *larp) * nphot);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">//amount of scintillated photons created via the slow scintillation process</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">double</span> nphot_slow = nphot - nphot_fast;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel = 0; channel &lt; nOpChannels; ++channel) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keyword">auto</span> visibleFraction = Visibilities[channel];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">if</span> (visibleFraction == 0.0) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">// Voxel is not visible at this optical channel, skip doing anything for this channel.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          <span class="keywordflow">if</span> (lgp-&gt;UseLitePhotons()) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span> (nphot_fast &gt; 0) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              <span class="comment">//throwing a random number from a poisson distribution with a mean of the amount of photons visible at this channel</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              <span class="keyword">auto</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(randpoisphot.fire(nphot_fast * visibleFraction));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="comment">//calculates the time at which the photon was produced</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keyword">auto</span> time = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(edep.T0() + GetScintTime(<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">fRiseTimeFast</a>,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                                                      larp-&gt;ScintFastTimeConst(),</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                                                      randflatscinttime));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                ++photonLiteCollection[channel].DetectedPhotons[time];</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;              }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> ((nphot_slow &gt; 0) &amp;&amp; <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">fDoSlowComponent</a>) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              <span class="comment">//throwing a random number from a poisson distribution with a mean of the amount of photons visible at this channel</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;              <span class="keyword">auto</span> n = randpoisphot.fire(nphot_slow * visibleFraction);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i = 0; i &lt; <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>; ++i) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">//calculates the time at which the photon was produced</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keyword">auto</span> time = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(edep.T0() + GetScintTime(<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">fRiseTimeSlow</a>,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                                                      larp-&gt;ScintSlowTimeConst(),</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                                      randflatscinttime));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                ++photonLiteCollection[channel].DetectedPhotons[time];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html">sim::OnePhoton</a> <a class="code" href="../../d5/dbe/runPID_8fcl.html#aabb4fa2ad6efed7d03a95c66834213ae">photon</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            photon.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a9811e0658d83df0ea88ce0d60129c9e5">SetInSD</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            photon.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a2c524ee4618d5091358a4fba57d6bbd0">InitialPosition</a> = edep.End();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            photon.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#ade1e95cbc4acebdd2b61046b3035113b">Energy</a> = 9.7e-6;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (nphot_fast &gt; 0) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              <span class="comment">//throwing a random number from a poisson distribution with a mean of the amount of photons visible at this channel</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;              <span class="keyword">auto</span> n = randpoisphot.fire(nphot_fast * visibleFraction);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="comment">//calculates the time at which the photon was produced</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                photon.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a821c9e06cd12efb223004d78c9fcb57e">Time</a> =</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                  edep.T0() +</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                  GetScintTime(<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">fRiseTimeFast</a>, larp-&gt;ScintFastTimeConst(), randflatscinttime);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="comment">// add n copies of sim::OnePhoton photon to the photon collection for a given OpChannel</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                photonCollection[channel].insert(photonCollection[channel].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>(), n, photon);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;              }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> ((nphot_slow &gt; 0) &amp;&amp; <a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">fDoSlowComponent</a>) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              <span class="comment">//throwing a random number from a poisson distribution with a mean of the amount of photons visible at this channel</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;              <span class="keyword">auto</span> n = randpoisphot.fire(nphot_slow * visibleFraction);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;              <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="comment">//calculates the time at which the photon was produced</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                photon.<a class="code" href="../../d4/d00/structsim_1_1OnePhoton.html#a821c9e06cd12efb223004d78c9fcb57e">Time</a> =</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                  edep.T0() +</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                  GetScintTime(<a class="code" href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">fRiseTimeSlow</a>, larp-&gt;ScintSlowTimeConst(), randflatscinttime);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="comment">// add n copies of sim::OnePhoton photon to the photon collection for a given OpChannel</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                photonCollection[channel].insert(photonCollection[channel].<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a>(), n, photon);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (lgp-&gt;UseLitePhotons()) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="comment">// put the photon collection of LitePhotons into the art event</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.put(move(photLiteCol));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">//put the photon collection of SimPhotons into the art event</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <a class="code" href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a>.put(move(photCol));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="ttc" id="runPID_8fcl_html_aabb4fa2ad6efed7d03a95c66834213ae"><div class="ttname"><a href="../../d5/dbe/runPID_8fcl.html#aabb4fa2ad6efed7d03a95c66834213ae">photon</a></div><div class="ttdeci">process_name can override from command line with o or output photon</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbe/runPID_8fcl_source.html#l00028">runPID.fcl:28</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html">sim::OnePhoton</a></div><div class="ttdoc">All information of a photon entering the sensitive optical detector volume. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00064">SimPhotons.h:64</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a1d91be2f3bb482e517c47c4d85db8bc3"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a1d91be2f3bb482e517c47c4d85db8bc3">phot::PhotonLibraryPropagation::fScintTimeEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fScintTimeEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00153">PhotonLibraryPropagation_module.cc:153</a></div></div>
<div class="ttc" id="classlarg4_1_1ISCalcSeparate_html_a763e292f61c076363f562d6fbf686053"><div class="ttname"><a href="../../de/d26/classlarg4_1_1ISCalcSeparate.html#a763e292f61c076363f562d6fbf686053">larg4::ISCalcSeparate::CalcIonAndScint</a></div><div class="ttdeci">ISCalcData CalcIonAndScint(detinfo::DetectorPropertiesData const &amp;detProp, sim::SimEnergyDeposit const &amp;edep) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d20/ISCalcSeparate_8cxx_source.html#l00129">ISCalcSeparate.cxx:129</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_ad10836f9d99cea5f3f377fab7ade6fc5"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#ad10836f9d99cea5f3f377fab7ade6fc5">phot::PhotonLibraryPropagation::fRiseTimeFast</a></div><div class="ttdeci">double fRiseTimeFast</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00147">PhotonLibraryPropagation_module.cc:147</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a2c524ee4618d5091358a4fba57d6bbd0"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a2c524ee4618d5091358a4fba57d6bbd0">sim::OnePhoton::InitialPosition</a></div><div class="ttdeci">geo::Point_t InitialPosition</div><div class="ttdoc">Scintillation position in world coordinates [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00067">SimPhotons.h:67</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a821c9e06cd12efb223004d78c9fcb57e"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a821c9e06cd12efb223004d78c9fcb57e">sim::OnePhoton::Time</a></div><div class="ttdeci">float Time</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00079">SimPhotons.h:79</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a3df92026d584d746362ac35a78d7279a"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a3df92026d584d746362ac35a78d7279a">phot::PhotonLibraryPropagation::fRiseTimeSlow</a></div><div class="ttdeci">double fRiseTimeSlow</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00148">PhotonLibraryPropagation_module.cc:148</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_adf1605728ef04b225a1ac29dae283301"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#adf1605728ef04b225a1ac29dae283301">phot::PhotonLibraryPropagation::fISAlg</a></div><div class="ttdeci">larg4::ISCalcSeparate fISAlg</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00151">PhotonLibraryPropagation_module.cc:151</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a9474b2a5b7731b87ff34ed668bb6d4ba"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a9474b2a5b7731b87ff34ed668bb6d4ba">phot::PhotonLibraryPropagation::fEDepTags</a></div><div class="ttdeci">vector&lt; art::InputTag &gt; fEDepTags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00150">PhotonLibraryPropagation_module.cc:150</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a807c70cce3f593daa3cb3a7e05720863"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a807c70cce3f593daa3cb3a7e05720863">phot::PhotonLibraryPropagation::fPhotonEngine</a></div><div class="ttdeci">CLHEP::HepRandomEngine &amp; fPhotonEngine</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00152">PhotonLibraryPropagation_module.cc:152</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_a9811e0658d83df0ea88ce0d60129c9e5"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#a9811e0658d83df0ea88ce0d60129c9e5">sim::OnePhoton::SetInSD</a></div><div class="ttdeci">bool SetInSD</div><div class="ttdoc">Whether the photon reaches the sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00088">SimPhotons.h:88</a></div></div>
<div class="ttc" id="classphot_1_1PhotonLibraryPropagation_html_a674203360e09b4cba0d6cb3d889efe83"><div class="ttname"><a href="../../d3/d37/classphot_1_1PhotonLibraryPropagation.html#a674203360e09b4cba0d6cb3d889efe83">phot::PhotonLibraryPropagation::fDoSlowComponent</a></div><div class="ttdeci">bool fDoSlowComponent</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00149">PhotonLibraryPropagation_module.cc:149</a></div></div>
<div class="ttc" id="updateVersionList_8sh_html_a067a8c1534d6da9b2c501a6cf4ef89bd"><div class="ttname"><a href="../../d4/dca/updateVersionList_8sh.html#a067a8c1534d6da9b2c501a6cf4ef89bd">e</a></div><div class="ttdeci">do i e</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/updateVersionList_8sh_source.html#l00068">updateVersionList.sh:68</a></div></div>
<div class="ttc" id="structsim_1_1OnePhoton_html_ade1e95cbc4acebdd2b61046b3035113b"><div class="ttname"><a href="../../d4/d00/structsim_1_1OnePhoton.html#ade1e95cbc4acebdd2b61046b3035113b">sim::OnePhoton::Energy</a></div><div class="ttdeci">float Energy</div><div class="ttdoc">Scintillation photon energy [GeV]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/SimPhotons_8h_source.html#l00082">SimPhotons.h:82</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="namespacedetsim_html_a560adbb3abf95a23d45a53ed25d8c0c7"><div class="ttname"><a href="../../d2/d1a/namespacedetsim.html#a560adbb3abf95a23d45a53ed25d8c0c7">detsim::detProp</a></div><div class="ttdeci">auto const detProp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/SimWire__module_8cc_source.html#l00157">SimWire_module.cc:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a674203360e09b4cba0d6cb3d889efe83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool phot::PhotonLibraryPropagation::fDoSlowComponent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00149">149</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9474b2a5b7731b87ff34ed668bb6d4ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;art::InputTag&gt; phot::PhotonLibraryPropagation::fEDepTags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00150">150</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="adf1605728ef04b225a1ac29dae283301"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d26/classlarg4_1_1ISCalcSeparate.html">larg4::ISCalcSeparate</a> phot::PhotonLibraryPropagation::fISAlg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00151">151</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a807c70cce3f593daa3cb3a7e05720863"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CLHEP::HepRandomEngine&amp; phot::PhotonLibraryPropagation::fPhotonEngine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00152">152</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad10836f9d99cea5f3f377fab7ade6fc5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double phot::PhotonLibraryPropagation::fRiseTimeFast</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00147">147</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3df92026d584d746362ac35a78d7279a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double phot::PhotonLibraryPropagation::fRiseTimeSlow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00148">148</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1d91be2f3bb482e517c47c4d85db8bc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CLHEP::HepRandomEngine&amp; phot::PhotonLibraryPropagation::fScintTimeEngine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html#l00153">153</a> of file <a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../de/d11/PhotonLibraryPropagation__module_8cc_source.html">PhotonLibraryPropagation_module.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
