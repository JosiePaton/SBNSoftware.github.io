<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>PMAlgCosmicTagger.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b73b02d482d1c4a3db20c3d9ad52d395.html">srcs</a></li><li class="navelem"><a class="el" href="../../dir_f58b2474d7db671760af109c057c9f12.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_bfd42686fcf7bc0e8145fd17787a17cd.html">larreco</a></li><li class="navelem"><a class="el" href="../../dir_a92975983e87729a773cfa3b8109c8c3.html">RecoAlg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PMAlgCosmicTagger.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../df/dd2/PMAlgCosmicTagger_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">// Class:       PMAlgCosmicTagger</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Author:      L. Whitehead (leigh.howard.whitehead@cern.ch),</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//              R. Sulej (robert.sulej@cern.ch) March 2017</span><span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d2e/PMAlgCosmicTagger_8h.html">larreco/RecoAlg/PMAlgCosmicTagger.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2e/ServiceUtil_8h.html">larcore/CoreUtils/ServiceUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8b/Geometry_8h.html">larcore/Geometry/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de7/GeometryCore_8h.html">larcorealg/Geometry/GeometryCore.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/de9/TPCGeo_8h.html">larcorealg/Geometry/TPCGeo.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/dd8/PmaNode3D_8h.html">larreco/RecoAlg/PMAlg/PmaNode3D.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d67/PmaTrack3D_8h.html">larreco/RecoAlg/PMAlg/PmaTrack3D.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/ddb/PmaTrkCandidate_8h.html">larreco/RecoAlg/PMAlg/PmaTrkCandidate.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;messagefacility/MessageLogger/MessageLogger.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dba/DetectorClocksService_8h.html">lardata/DetectorInfoServices/DetectorClocksService.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span> <span class="comment">// std::accumulate</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#acec95d581bdaea7289a53066ce35ef4d">   23</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#acec95d581bdaea7289a53066ce35ef4d">pma::PMAlgCosmicTagger::tag</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                            <a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">// Get the detector dimensions</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab3a37752b7ca188de6b377a3b3111c6e">GetDimensions</a>();</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Passed &quot;</span> &lt;&lt; tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a0840fc44db12850e5da9663bbdf81bca">size</a>() &lt;&lt; <span class="stringliteral">&quot; tracks for tagging cosmics.&quot;</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a50a11ae21317eebfaa1a9c5d64cb3ade">fTagOutOfDriftTracks</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ad234c60024b511c8152fe84b04abd036">outOfDriftWindow</a>(tracks);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a23953c6d6ed390f73b663fbdcd249fc2">fTagFullHeightTracks</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a80fc0e086c62e2d5eeb56fe87adaa96c">fullHeightCrossing</a>(tracks);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a928141855dc15ddfdcdfe34b885acf64">fTagFullWidthTracks</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a993a62d64919d09578844104bb70eca9">fullWidthCrossing</a>(tracks);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab67fe0582e1d93dad006dca9e1e2bbbf">fTagFullLengthTracks</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a9d6729648bf059dcc34f2f2ba377c85d">fullLengthCrossing</a>(tracks);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a81cb76e6e9d6171655a34a50ffbbfb8e">fTagNonBeamT0Tracks</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a53427070b4780fa8e6f4380b9bbdac0f">nonBeamT0Tag</a>(clockData, tracks);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#aced5ac5900106a217d70d614828dbe64">fTagTopFrontBack</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae01ad4dfd8987a01feb6d606d76c5d2c">tagTopFrontBack</a>(tracks);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a840361b5a898fe42091f08a2aa2a7c59">fTagApparentStopper</a>) n += <a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#af87accf917049fd48fd3be556ae9139e">tagApparentStopper</a>(tracks);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;...tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; cosmic-like tracks.&quot;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ad234c60024b511c8152fe84b04abd036">   46</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ad234c60024b511c8152fe84b04abd036">pma::PMAlgCosmicTagger::outOfDriftWindow</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;   - tag tracks out of 1 drift window;&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html">pma::Track3D</a>&amp; trk = *(t.Track());</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">double</span> min, <a class="code" href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a>, <a class="code" href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">bool</span> node_out_of_drift_min = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> node_out_of_drift_max = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> nidx = 0; nidx &lt; trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a570b518d8e14a8cc0fdd4a8823553a0c">Nodes</a>().size(); ++nidx) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node = *(trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a570b518d8e14a8cc0fdd4a8823553a0c">Nodes</a>()[nidx]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; tpcGeo = geom-&gt;TPC(node.TPC(), node.Cryo());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// DetectDriftDirection returns a short int, but switch requires an int</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">int</span> driftDir = <a class="code" href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a>(tpcGeo.DetectDriftDirection());</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      p = node.Point3D()[driftDir - 1];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">switch</span> (driftDir) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        min = tpcGeo.MinX();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        max = tpcGeo.MaxX();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        min = tpcGeo.MinY();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        max = tpcGeo.MaxY();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        min = tpcGeo.MinZ();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        max = tpcGeo.MaxZ();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Drift direction unknown: &quot;</span> &lt;&lt; driftDir &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> (p &lt; min - fOutOfDriftMargin) { node_out_of_drift_min = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">if</span> (p &gt; max + fOutOfDriftMargin) { node_out_of_drift_max = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (node_out_of_drift_min &amp;&amp; node_out_of_drift_max) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a4a157f9f8fd188641322847c9bb5487f">SetTagFlag</a>(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a4a157f9f8fd188641322847c9bb5487f">SetTagFlag</a>(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a3f7c32ddc0e1635218c2a5f92b25620e">pma::Track3D::kOutsideDrift_Complete</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node_out_of_drift_min || node_out_of_drift_max) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a4a157f9f8fd188641322847c9bb5487f">SetTagFlag</a>(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      trk.<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a4a157f9f8fd188641322847c9bb5487f">SetTagFlag</a>(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a61beccb300f398021d82b3dcdc9c01af">pma::Track3D::kOutsideDrift_Partial</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks out of 1 drift window.&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// Leigh: Make use of the fact that our cathode and anode crossing tracks have a reconstructed T0.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// Check to see if this time is consistent with the beam</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a53427070b4780fa8e6f4380b9bbdac0f">  107</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a53427070b4780fa8e6f4380b9bbdac0f">pma::PMAlgCosmicTagger::nonBeamT0Tag</a>(<a class="code" href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a> <span class="keyword">const</span>&amp; clockData,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                     <a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// Search through all of the tracks</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Non zero T0 means we reconstructed it</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (t.Track()-&gt;GetT0() != 0.0) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; - track with T0 = &quot;</span> &lt;&lt; t.Track()-&gt;GetT0();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span> (fabs(t.Track()-&gt;GetT0() - <a class="code" href="../../d7/d8a/namespacedetinfo.html#a3d7c800dd526147cd2c0e43c6e34daa4">trigger_offset</a>(clockData)) &gt; fNonBeamT0Margin) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a59a95b5cbb3c0b2f43e7c2047d8d73ad">pma::Track3D::kBeamIncompatible</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; non-beam T0 tracks.&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae01ad4dfd8987a01feb6d606d76c5d2c">  132</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae01ad4dfd8987a01feb6d606d76c5d2c">pma::PMAlgCosmicTagger::tagTopFrontBack</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">short</span> <span class="keywordtype">int</span> hIdx = ConvertDirToInt(geom-&gt;TPC(0, 0).HeightDir());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">short</span> <span class="keywordtype">int</span> lIdx = ConvertDirToInt(geom-&gt;TPC(0, 0).LengthDir());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Loop over the tracks</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// Get the first and last positions from the track.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node0 = *(t.Track()-&gt;Nodes()[0]);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node1 = *(t.Track()-&gt;Nodes()[t.Track()-&gt;Nodes().size() - 1]);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Check which end is the vertex (assume the largest height)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    TVector3 vtx =</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      (node0.Point3D()[hIdx] &gt; node1.Point3D()[hIdx]) ? node0.Point3D() : node1.Point3D();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    TVector3 <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> =</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      (node0.Point3D()[hIdx] &lt;= node1.Point3D()[hIdx]) ? node0.Point3D() : node1.Point3D();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// Check we have a track starting at the top of the detector</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#ae8110c3ee063850eae21402b23f61114">top</a> = isTopVertex(vtx, fTopFrontBackMargin, hIdx);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Check the track ends at the front or back of the detector</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">bool</span> frontBack = isFrontBackVertex(end, fTopFrontBackMargin, lIdx);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Check we path both criteria but without letting either the start or end of the track fulfill both</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (top &amp;&amp; frontBack) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a5058814bc46a3601fd80835d9e000240">pma::Track3D::kGeometry_YZ</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks crossing from top to front/back.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#af87accf917049fd48fd3be556ae9139e">  176</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#af87accf917049fd48fd3be556ae9139e">pma::PMAlgCosmicTagger::tagApparentStopper</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// Tracks entering from the top of the detector that stop in the fiducial volume</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// are very likely to be cosmics that leave through the APA, but have their</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// drift coordinate incorrectly set due to lack of T0</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">short</span> <span class="keywordtype">int</span> hIdx = ConvertDirToInt(geom-&gt;TPC(0, 0).HeightDir());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// Loop over the tracks</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Get the first and last positions from the track.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node0 = *(t.Track()-&gt;Nodes()[0]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node1 = *(t.Track()-&gt;Nodes()[t.Track()-&gt;Nodes().size() - 1]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// Check which end is the vertex (assume the largest height)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    TVector3 vtx =</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      (node0.Point3D()[hIdx] &gt; node1.Point3D()[hIdx]) ? node0.Point3D() : node1.Point3D();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    TVector3 <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">end</a> =</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      (node0.Point3D()[hIdx] &lt;= node1.Point3D()[hIdx]) ? node0.Point3D() : node1.Point3D();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (fabs(vtx[hIdx] - fDimensionsMax[hIdx]) &lt; fApparentStopperMargin) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">// Check the other element to see if it ends away from the bottom of the detector</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (fabs(end[hIdx] - fDimensionsMin[hIdx]) &gt; 5. * fApparentStopperMargin) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// We now need to loop over all of the tracks to see if any start within fStopperBuffer of our end point.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordtype">bool</span> foundTrack = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; tt : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          <span class="comment">// Don&#39;t match with itself!</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">if</span> ((&amp;tt) == (&amp;t)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="comment">// Compare this track with our main track</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          TVector3 trkVtx = (tt.Track()-&gt;Nodes()[0])-&gt;<a class="code" href="../../d1/d4e/namespacelar_1_1fhicl_1_1geo.html#aff5db21a0b87718dbf7debb3cd62dbd0">Point3D</a>();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          TVector3 trkEnd = (tt.Track()-&gt;Nodes()[tt.Track()-&gt;Nodes().size() - 1])-&gt;<a class="code" href="../../d1/d4e/namespacelar_1_1fhicl_1_1geo.html#aff5db21a0b87718dbf7debb3cd62dbd0">Point3D</a>();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> ((end - trkVtx).Mag() &lt; fStopperBuffer || (end - trkEnd).Mag() &lt; fStopperBuffer) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            foundTrack = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (foundTrack) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="comment">// This isn&#39;t really a stopping particle, so move on</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">// If we don&#39;t mind about tagging all stopping particles then this satisfies our requirements</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (!fVetoActualStopper) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ac5da7c2b8449049d70953480e2ec4503">pma::Track3D::kGeometry_Y</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">// If we want to actually ignore the stopping particles, use de/dx...</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">// Store the number of sigma from the mean for the final dedx point in each view</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        std::vector&lt;float&gt; nSigmaPerView;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// Loop over the views</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> view : geom-&gt;Views()) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="comment">// Get the dedx for this track and view</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          std::map&lt;size_t, std::vector&lt;double&gt;&gt; dedx;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          t.Track()-&gt;GetRawdEdxSequence(dedx, view);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          std::vector&lt;double&gt; trk_dedx;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> = t.Track()-&gt;NextHit(-1, view); <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> != -1; <a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> = t.Track()-&gt;NextHit(<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>, view)) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// If this is the last hit then this method won&#39;t work</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a> &gt; t.Track()-&gt;PrevHit(t.Track()-&gt;size(), view)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">// Make sure we have a reasonable value</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">if</span> (dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][5] / dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][6] &lt;= 0 || dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][5] / dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][6] &gt; 1e6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            trk_dedx.push_back(dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][5] / dedx[<a class="code" href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a>][6]);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <span class="keywordflow">if</span> (trk_dedx.size() == 0) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;View &quot;</span> &lt;&lt; view &lt;&lt; <span class="stringliteral">&quot; has no hits.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keywordtype">double</span> sum = std::accumulate(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(trk_dedx), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(trk_dedx), 0.0);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a> = sum / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(trk_dedx.size());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keywordtype">double</span> accum = 0.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          std::for_each(<a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">std::begin</a>(trk_dedx), <a class="code" href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">std::end</a>(trk_dedx), [&amp;](<span class="keyword">const</span> <span class="keywordtype">double</span> d) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            accum += (d - <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>) * (d - mean);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          });</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordtype">double</span> stdev = sqrt(accum / static_cast&lt;double&gt;(trk_dedx.size() - 1));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; View &quot;</span> &lt;&lt; view &lt;&lt; <span class="stringliteral">&quot; has average dedx &quot;</span> &lt;&lt; mean &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt; stdev</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; and final dedx &quot;</span> &lt;&lt; trk_dedx[trk_dedx.size() - 1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          nSigmaPerView.push_back(fabs((trk_dedx[trk_dedx.size() - 1] - <a class="code" href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">mean</a>) / stdev));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordtype">bool</span> notStopper = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n2Sigma = 0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n3Sigma = 0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> nSigma : nSigmaPerView) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="keywordflow">if</span> (nSigma &gt;= 2.0) ++n2Sigma;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="keywordflow">if</span> (nSigma &gt;= 3.0) ++n3Sigma;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> (n3Sigma &gt; 0) notStopper = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (n2Sigma == nSigmaPerView.size()) notStopper = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">if</span> (notStopper) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ac5da7c2b8449049d70953480e2ec4503">pma::Track3D::kGeometry_Y</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      } <span class="comment">// Check on bottom position</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }   <span class="comment">// Check on top position</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }     <span class="comment">// End loop over tracks</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks stopping in the detector after starting at the top.&quot;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a80fc0e086c62e2d5eeb56fe87adaa96c">  303</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a80fc0e086c62e2d5eeb56fe87adaa96c">pma::PMAlgCosmicTagger::fullHeightCrossing</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// Just use the first tpc to get the height dimension (instead of assuming y).</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = geom-&gt;TPC(0, 0).HeightDir();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = fullCrossingTagger(tracks, ConvertDirToInt(dir));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks crossing the full detector height&quot;</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a993a62d64919d09578844104bb70eca9">  318</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a993a62d64919d09578844104bb70eca9">pma::PMAlgCosmicTagger::fullWidthCrossing</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// Just use the first tpc to get the width dimension (instead of assuming x).</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = geom-&gt;TPC(0, 0).WidthDir();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = fullCrossingTagger(tracks, ConvertDirToInt(dir));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks crossing the full detector width&quot;</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a9d6729648bf059dcc34f2f2ba377c85d">  333</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a9d6729648bf059dcc34f2f2ba377c85d">pma::PMAlgCosmicTagger::fullLengthCrossing</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// Just use the first tpc to get the length dimension (instead of assuming z).</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  TVector3 <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a> = geom-&gt;TPC(0, 0).LengthDir();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = fullCrossingTagger(tracks, ConvertDirToInt(dir));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; - Tagged &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; tracks crossing the full detector length&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordtype">size_t</span></div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a44d6a5755429abe97cb711f8e380fc29">  348</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a44d6a5755429abe97cb711f8e380fc29">pma::PMAlgCosmicTagger::fullCrossingTagger</a>(<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a>&amp; <a class="code" href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a>, <span class="keywordtype">int</span> direction)<span class="keyword"> const</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (direction == -1) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    mf::LogWarning(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; - Could not recognise direction, not attempting to perform fullCrossingTagger.&quot;</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a> = 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">double</span> detDim = fDimensionsMax[direction] - fDimensionsMin[direction];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0">pma::Track3D::ETag</a> dirTag = <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a40d880014f9a9bd7fc30d41fac0dc53c">pma::Track3D::kNotTagged</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">switch</span> (direction) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">case</span> 0: dirTag = <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a89efbbdc273b7cbd536a61cbe5733c30">pma::Track3D::kGeometry_XX</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">case</span> 1: dirTag = <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a6b24f9cab8f2bd120cb25d47232a9267">pma::Track3D::kGeometry_YY</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">case</span> 2: dirTag = <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a4522f6bf7980bca3d1f071a5e456868c">pma::Track3D::kGeometry_ZZ</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">default</span>: dirTag = <a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a40d880014f9a9bd7fc30d41fac0dc53c">pma::Track3D::kNotTagged</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// Loop over the tracks</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tracks.<a class="code" href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">tracks</a>()) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Get the first and last positions from the track.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node0 = *(t.Track()-&gt;Nodes()[0]);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; node1 = *(t.Track()-&gt;Nodes()[t.Track()-&gt;Nodes().size() - 1]);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Get the length of the track in the requested direction</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">double</span> trkDim = fabs(node0.Point3D()[direction] - node1.Point3D()[direction]);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> ((detDim - trkDim) &lt; fFullCrossingMargin) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      ++<a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      t.Track()-&gt;SetTagFlag(<a class="code" href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      t.Track()-&gt;SetTagFlag(dirTag);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      mf::LogInfo(<span class="stringliteral">&quot;pma::PMAlgCosmicTagger&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; -- track tagged in direction &quot;</span> &lt;&lt; direction</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; trkDim &lt;&lt; <span class="stringliteral">&quot; (c.f. &quot;</span> &lt;&lt; detDim &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">n</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a825831e451d351d04f9bc8600c60da3b">  392</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a825831e451d351d04f9bc8600c60da3b">pma::PMAlgCosmicTagger::isTopVertex</a>(<span class="keyword">const</span> TVector3&amp; pos, <span class="keywordtype">double</span> <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>, <span class="keywordtype">short</span> <span class="keywordtype">int</span> dirIndx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">return</span> (fabs(pos[dirIndx] - fDimensionsMax[dirIndx]) &lt; tolerance);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a1e06d228dcfb4a270b443dd46139958d">  399</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a1e06d228dcfb4a270b443dd46139958d">pma::PMAlgCosmicTagger::isFrontBackVertex</a>(<span class="keyword">const</span> TVector3&amp; pos,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                          <span class="keywordtype">double</span> <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                          <span class="keywordtype">short</span> <span class="keywordtype">int</span> dirIndx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d9/dd2/selectors_8fcl.html#a2602587bf9a1efd1e11d4fdeb2da110a">front</a> = (fabs(pos[dirIndx] - fDimensionsMin[dirIndx]) &lt; <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">bool</span> back = (fabs(pos[dirIndx] - fDimensionsMax[dirIndx]) &lt; <a class="code" href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">return</span> front || back;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab3a37752b7ca188de6b377a3b3111c6e">  411</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab3a37752b7ca188de6b377a3b3111c6e">pma::PMAlgCosmicTagger::GetDimensions</a>()</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// Need to find the minimum and maximum height values from the geometry.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">double</span> minX = 1.e6;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">double</span> maxX = -1.e6;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">double</span> minY = 1.e6;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">double</span> maxY = -1.e6;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">double</span> minZ = 1.e6;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">double</span> maxZ = -1.e6;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span>* geom = lar::providerFrom&lt;geo::Geometry&gt;();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Since we can stack TPCs, we can&#39;t just use geom::TPCGeom::Height()</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a> <span class="keyword">const</span>&amp; tID : geom-&gt;IterateTPCIDs()) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a> <span class="keyword">const</span>&amp; <a class="code" href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a> = geom-&gt;TPC(tID);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// We need to make sure we only include the real TPCs</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// We have dummy TPCs in the protoDUNE and DUNE geometries</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// The dummy ones have a drift distance of only ~13 cm.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a9696ac2c61e57bf62799989078d6eb87">DriftDistance</a>() &lt; 25.0) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// get center in world coordinates</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">origin</a>[3] = {0.};</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">double</span> center[3] = {0.};</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">LocalToWorld</a>(origin, center);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">double</span> tpcDim[3] = {TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a7ced3f8c920172d2b77f3d010cec6c1f">HalfWidth</a>(), TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a3a222b9dc08e40022cba2a0fcd194f30">HalfHeight</a>(), 0.5 * TPC.<a class="code" href="../../d9/dff/classgeo_1_1TPCGeo.html#a0e39141f154428669f715c957d3c5a5e">Length</a>()};</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (center[0] - tpcDim[0] &lt; minX) minX = center[0] - tpcDim[0];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">if</span> (center[0] + tpcDim[0] &gt; maxX) maxX = center[0] + tpcDim[0];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (center[1] - tpcDim[1] &lt; minY) minY = center[1] - tpcDim[1];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (center[1] + tpcDim[1] &gt; maxY) maxY = center[1] + tpcDim[1];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (center[2] - tpcDim[2] &lt; minZ) minZ = center[2] - tpcDim[2];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (center[2] + tpcDim[2] &gt; maxZ) maxZ = center[2] + tpcDim[2];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  } <span class="comment">// for all TPC</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  fDimensionsMin.clear();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  fDimensionsMax.clear();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  fDimensionsMin.push_back(minX);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  fDimensionsMin.push_back(minY);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  fDimensionsMin.push_back(minZ);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  fDimensionsMax.push_back(maxX);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  fDimensionsMax.push_back(maxY);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  fDimensionsMax.push_back(maxZ);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordtype">short</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae15ff404580f361cd1001e82453d4424">  458</a></span>&#160;<a class="code" href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae15ff404580f361cd1001e82453d4424">pma::PMAlgCosmicTagger::ConvertDirToInt</a>(<span class="keyword">const</span> TVector3&amp; <a class="code" href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dir</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span> (dir.X() &gt; 0.99) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span> (dir.Y() &gt; 0.99) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">if</span> (dir.Z() &gt; 0.99)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="ttc" id="classpma_1_1Track3D_html"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html">pma::Track3D</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00037">PmaTrack3D.h:37</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a993a62d64919d09578844104bb70eca9"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a993a62d64919d09578844104bb70eca9">pma::PMAlgCosmicTagger::fullWidthCrossing</a></div><div class="ttdeci">size_t fullWidthCrossing(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00318">PMAlgCosmicTagger.cxx:318</a></div></div>
<div class="ttc" id="classpma_1_1TrkCandidateColl_html_a0840fc44db12850e5da9663bbdf81bca"><div class="ttname"><a href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a0840fc44db12850e5da9663bbdf81bca">pma::TrkCandidateColl::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddb/PmaTrkCandidate_8h_source.html#l00158">PmaTrkCandidate.h:158</a></div></div>
<div class="ttc" id="ServiceUtil_8h_html"><div class="ttname"><a href="../../d4/d2e/ServiceUtil_8h.html">ServiceUtil.h</a></div><div class="ttdoc">Utilities related to art service access. </div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a50a11ae21317eebfaa1a9c5d64cb3ade"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a50a11ae21317eebfaa1a9c5d64cb3ade">pma::PMAlgCosmicTagger::fTagOutOfDriftTracks</a></div><div class="ttdeci">bool fTagOutOfDriftTracks</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00125">PMAlgCosmicTagger.h:125</a></div></div>
<div class="ttc" id="trackfinderalgorithms_8fcl_html_a5204d4188eee282d2235cd231d828bd2"><div class="ttname"><a href="../../d2/dbd/trackfinderalgorithms_8fcl.html#a5204d4188eee282d2235cd231d828bd2">tracks</a></div><div class="ttdeci">ClusterModuleLabel join with tracks</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dbd/trackfinderalgorithms_8fcl_source.html#l00056">trackfinderalgorithms.fcl:56</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a4a157f9f8fd188641322847c9bb5487f"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a4a157f9f8fd188641322847c9bb5487f">pma::Track3D::SetTagFlag</a></div><div class="ttdeci">void SetTagFlag(ETag value)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00074">PmaTrack3D.h:74</a></div></div>
<div class="ttc" id="PmaTrack3D_8h_html"><div class="ttname"><a href="../../df/d67/PmaTrack3D_8h.html">PmaTrack3D.h</a></div><div class="ttdoc">Implementation of the Projection Matching Algorithm. </div></div>
<div class="ttc" id="PMAlgCosmicTagger_8h_html"><div class="ttname"><a href="../../dd/d2e/PMAlgCosmicTagger_8h.html">PMAlgCosmicTagger.h</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a59a95b5cbb3c0b2f43e7c2047d8d73ad"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a59a95b5cbb3c0b2f43e7c2047d8d73ad">pma::Track3D::kBeamIncompatible</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00061">PmaTrack3D.h:61</a></div></div>
<div class="ttc" id="namespacelar_1_1fhicl_1_1geo_html_aff5db21a0b87718dbf7debb3cd62dbd0"><div class="ttname"><a href="../../d1/d4e/namespacelar_1_1fhicl_1_1geo.html#aff5db21a0b87718dbf7debb3cd62dbd0">lar::fhicl::geo::Point3D</a></div><div class="ttdeci">::fhicl::TupleAs&lt; Point(::geo::Length_t,::geo::Length_t,::geo::Length_t)&gt; Point3D</div><div class="ttdoc">Atom object for reading a 3D point or vector (centimeters). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0b/geo__vectors__fhicl_8h_source.html#l00038">geo_vectors_fhicl.h:38</a></div></div>
<div class="ttc" id="OpFlashAlg__test_8cc_html_a9831d5eb20e67514532655869f703820"><div class="ttname"><a href="../../d3/d3e/OpFlashAlg__test_8cc.html#a9831d5eb20e67514532655869f703820">tolerance</a></div><div class="ttdeci">auto const tolerance</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3e/OpFlashAlg__test_8cc_source.html#l00009">OpFlashAlg_test.cc:9</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a24c8335057af14a9b508d5ac18999ce5"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a24c8335057af14a9b508d5ac18999ce5">p</a></div><div class="ttdeci">pdgs p</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00022">selectors.fcl:22</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a89efbbdc273b7cbd536a61cbe5733c30"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a89efbbdc273b7cbd536a61cbe5733c30">pma::Track3D::kGeometry_XX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00051">PmaTrack3D.h:51</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html">geo::TPCGeo</a></div><div class="ttdoc">Geometry information for a single TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00038">TPCGeo.h:38</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_ab67fe0582e1d93dad006dca9e1e2bbbf"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab67fe0582e1d93dad006dca9e1e2bbbf">pma::PMAlgCosmicTagger::fTagFullLengthTracks</a></div><div class="ttdeci">bool fTagFullLengthTracks</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00131">PMAlgCosmicTagger.h:131</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a40d880014f9a9bd7fc30d41fac0dc53c"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a40d880014f9a9bd7fc30d41fac0dc53c">pma::Track3D::kNotTagged</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00042">PmaTrack3D.h:42</a></div></div>
<div class="ttc" id="pmttriggerproducer_8fcl_html_a527d89be40c3c20ca8162df059180fd9"><div class="ttname"><a href="../../d7/d5a/pmttriggerproducer_8fcl.html#a527d89be40c3c20ca8162df059180fd9">max</a></div><div class="ttdeci">BEGIN_PROLOG pmt_uncoated ideal single PE test page of manual option are OR or AND window for pmt trigger time start window for pmt trigger time end etc then what events all hists are saved for max</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/pmttriggerproducer_8fcl_source.html#l00023">pmttriggerproducer.fcl:23</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a570b518d8e14a8cc0fdd4a8823553a0c"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a570b518d8e14a8cc0fdd4a8823553a0c">pma::Track3D::Nodes</a></div><div class="ttdeci">std::vector&lt; pma::Node3D * &gt; const &amp; Nodes() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00335">PmaTrack3D.h:335</a></div></div>
<div class="ttc" id="PmaNode3D_8h_html"><div class="ttname"><a href="../../df/dd8/PmaNode3D_8h.html">PmaNode3D.h</a></div><div class="ttdoc">Implementation of the Projection Matching Algorithm. </div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a840361b5a898fe42091f08a2aa2a7c59"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a840361b5a898fe42091f08a2aa2a7c59">pma::PMAlgCosmicTagger::fTagApparentStopper</a></div><div class="ttdeci">bool fTagApparentStopper</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00141">PMAlgCosmicTagger.h:141</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a3f7c32ddc0e1635218c2a5f92b25620e"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a3f7c32ddc0e1635218c2a5f92b25620e">pma::Track3D::kOutsideDrift_Complete</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00060">PmaTrack3D.h:60</a></div></div>
<div class="ttc" id="sbnd__flashalgo_8fcl_html_a648c7afac4085c93cd1ba4a75dfe8818"><div class="ttname"><a href="../../d4/d22/sbnd__flashalgo_8fcl.html#a648c7afac4085c93cd1ba4a75dfe8818">TPC</a></div><div class="ttdeci">BEGIN_PROLOG TPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d22/sbnd__flashalgo_8fcl_source.html#l00014">sbnd_flashalgo.fcl:14</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a0e39141f154428669f715c957d3c5a5e"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a0e39141f154428669f715c957d3c5a5e">geo::TPCGeo::Length</a></div><div class="ttdeci">double Length() const </div><div class="ttdoc">Length is associated with z coordinate [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00115">TPCGeo.h:115</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_af87accf917049fd48fd3be556ae9139e"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#af87accf917049fd48fd3be556ae9139e">pma::PMAlgCosmicTagger::tagApparentStopper</a></div><div class="ttdeci">size_t tagApparentStopper(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00176">PMAlgCosmicTagger.cxx:176</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a81cb76e6e9d6171655a34a50ffbbfb8e"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a81cb76e6e9d6171655a34a50ffbbfb8e">pma::PMAlgCosmicTagger::fTagNonBeamT0Tracks</a></div><div class="ttdeci">bool fTagNonBeamT0Tracks</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00135">PMAlgCosmicTagger.h:135</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a5058814bc46a3601fd80835d9e000240"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a5058814bc46a3601fd80835d9e000240">pma::Track3D::kGeometry_YZ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00049">PmaTrack3D.h:49</a></div></div>
<div class="ttc" id="selectors_8fcl_html_ae8110c3ee063850eae21402b23f61114"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#ae8110c3ee063850eae21402b23f61114">top</a></div><div class="ttdeci">walls no top</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="getStatistics_8sh_html_a04d4c2131ccb24cc78386597e8a21c5b"><div class="ttname"><a href="../../dd/de2/getStatistics_8sh.html#a04d4c2131ccb24cc78386597e8a21c5b">h</a></div><div class="ttdeci">while getopts h</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/getStatistics_8sh_source.html#l00013">getStatistics.sh:13</a></div></div>
<div class="ttc" id="classpma_1_1TrkCandidateColl_html"><div class="ttname"><a href="../../d8/d1b/classpma_1_1TrkCandidateColl.html">pma::TrkCandidateColl</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddb/PmaTrkCandidate_8h_source.html#l00155">PmaTrkCandidate.h:155</a></div></div>
<div class="ttc" id="GeometryCore_8h_html"><div class="ttname"><a href="../../db/de7/GeometryCore_8h.html">GeometryCore.h</a></div><div class="ttdoc">Access the description of detector geometry. </div></div>
<div class="ttc" id="sparse__vector__test_8cc_html_a39f16bf854ba527dee7eba5bbbd93f3f"><div class="ttname"><a href="../../dd/d59/sparse__vector__test_8cc.html#a39f16bf854ba527dee7eba5bbbd93f3f">abs</a></div><div class="ttdeci">T abs(T value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d59/sparse__vector__test_8cc_source.html#l00030">sparse_vector_test.cc:30</a></div></div>
<div class="ttc" id="selectors_8fcl_html_a2602587bf9a1efd1e11d4fdeb2da110a"><div class="ttname"><a href="../../d9/dd2/selectors_8fcl.html#a2602587bf9a1efd1e11d4fdeb2da110a">front</a></div><div class="ttdeci">walls no front</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd2/selectors_8fcl_source.html#l00105">selectors.fcl:105</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_ad234c60024b511c8152fe84b04abd036"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ad234c60024b511c8152fe84b04abd036">pma::PMAlgCosmicTagger::outOfDriftWindow</a></div><div class="ttdeci">size_t outOfDriftWindow(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00046">PMAlgCosmicTagger.cxx:46</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0">pma::Track3D::ETag</a></div><div class="ttdeci">ETag</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00041">PmaTrack3D.h:41</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a1e06d228dcfb4a270b443dd46139958d"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a1e06d228dcfb4a270b443dd46139958d">pma::PMAlgCosmicTagger::isFrontBackVertex</a></div><div class="ttdeci">bool isFrontBackVertex(const TVector3 &amp;pos, double tolerance, short int dirIndx) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00399">PMAlgCosmicTagger.cxx:399</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a4522f6bf7980bca3d1f071a5e456868c"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a4522f6bf7980bca3d1f071a5e456868c">pma::Track3D::kGeometry_ZZ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00050">PmaTrack3D.h:50</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a23953c6d6ed390f73b663fbdcd249fc2"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a23953c6d6ed390f73b663fbdcd249fc2">pma::PMAlgCosmicTagger::fTagFullHeightTracks</a></div><div class="ttdeci">bool fTagFullHeightTracks</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00129">PMAlgCosmicTagger.h:129</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_ab3a37752b7ca188de6b377a3b3111c6e"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ab3a37752b7ca188de6b377a3b3111c6e">pma::PMAlgCosmicTagger::GetDimensions</a></div><div class="ttdeci">void GetDimensions()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00411">PMAlgCosmicTagger.cxx:411</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a53427070b4780fa8e6f4380b9bbdac0f"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a53427070b4780fa8e6f4380b9bbdac0f">pma::PMAlgCosmicTagger::nonBeamT0Tag</a></div><div class="ttdeci">size_t nonBeamT0Tag(detinfo::DetectorClocksData const &amp;clockData, pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00107">PMAlgCosmicTagger.cxx:107</a></div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_aac918da84f16d53ad17bab4f817da1c4"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#aac918da84f16d53ad17bab4f817da1c4">icarus::ns::util::end</a></div><div class="ttdeci">auto end(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00585">FixedBins.h:585</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_ae15ff404580f361cd1001e82453d4424"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae15ff404580f361cd1001e82453d4424">pma::PMAlgCosmicTagger::ConvertDirToInt</a></div><div class="ttdeci">short int ConvertDirToInt(const TVector3 &amp;dir) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00458">PMAlgCosmicTagger.cxx:458</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0ac5da7c2b8449049d70953480e2ec4503"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ac5da7c2b8449049d70953480e2ec4503">pma::Track3D::kGeometry_Y</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00055">PmaTrack3D.h:55</a></div></div>
<div class="ttc" id="structgeo_1_1TPCID_html"><div class="ttname"><a href="../../d2/d4d/structgeo_1_1TPCID.html">geo::TPCID</a></div><div class="ttdoc">The data type to uniquely identify a TPC. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d48/geo__types_8h_source.html#l00386">geo_types.h:386</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_acec95d581bdaea7289a53066ce35ef4d"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#acec95d581bdaea7289a53066ce35ef4d">pma::PMAlgCosmicTagger::tag</a></div><div class="ttdeci">void tag(detinfo::DetectorClocksData const &amp;clockData, pma::TrkCandidateColl &amp;tracks)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00023">PMAlgCosmicTagger.cxx:23</a></div></div>
<div class="ttc" id="namespacedropbox_html_a407b5b895ba9265893768748aaa73825"><div class="ttname"><a href="../../de/d9a/namespacedropbox.html#a407b5b895ba9265893768748aaa73825">dropbox.dir</a></div><div class="ttdeci">tuple dir</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d81/dropbox_8py_source.html#l00028">dropbox.py:28</a></div></div>
<div class="ttc" id="PmaTrkCandidate_8h_html"><div class="ttname"><a href="../../d3/ddb/PmaTrkCandidate_8h.html">PmaTrkCandidate.h</a></div><div class="ttdoc">Track finding helper for the Projection Matching Algorithm. </div></div>
<div class="ttc" id="namespaceicarus_1_1ns_1_1util_html_acc1957472e01a8d9ecd245e26338f0b9"><div class="ttname"><a href="../../d5/d62/namespaceicarus_1_1ns_1_1util.html#acc1957472e01a8d9ecd245e26338f0b9">icarus::ns::util::begin</a></div><div class="ttdeci">auto begin(FixedBins&lt; T, C &gt; const &amp;) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dbd/FixedBins_8h_source.html#l00573">FixedBins.h:573</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3a222b9dc08e40022cba2a0fcd194f30"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3a222b9dc08e40022cba2a0fcd194f30">geo::TPCGeo::HalfHeight</a></div><div class="ttdeci">double HalfHeight() const </div><div class="ttdoc">Height is associated with y coordinate [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00111">TPCGeo.h:111</a></div></div>
<div class="ttc" id="namespacepmtana_html_afea8da0c88fccc3252529b6a49284b4a"><div class="ttname"><a href="../../da/dc9/namespacepmtana.html#afea8da0c88fccc3252529b6a49284b4a">pmtana::mean</a></div><div class="ttdeci">double mean(const std::vector&lt; short &gt; &amp;wf, size_t start, size_t nsample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de4/UtilFunc_8cxx_source.html#l00013">UtilFunc.cxx:13</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a9696ac2c61e57bf62799989078d6eb87"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a9696ac2c61e57bf62799989078d6eb87">geo::TPCGeo::DriftDistance</a></div><div class="ttdeci">double DriftDistance() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00155">TPCGeo.h:155</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a6b24f9cab8f2bd120cb25d47232a9267"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a6b24f9cab8f2bd120cb25d47232a9267">pma::Track3D::kGeometry_YY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00048">PmaTrack3D.h:48</a></div></div>
<div class="ttc" id="classdetinfo_1_1DetectorClocksData_html"><div class="ttname"><a href="../../d0/dc3/classdetinfo_1_1DetectorClocksData.html">detinfo::DetectorClocksData</a></div><div class="ttdoc">Contains all timing reference information for the detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00283">DetectorClocksData.h:283</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_ae01ad4dfd8987a01feb6d606d76c5d2c"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#ae01ad4dfd8987a01feb6d606d76c5d2c">pma::PMAlgCosmicTagger::tagTopFrontBack</a></div><div class="ttdeci">size_t tagTopFrontBack(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00132">PMAlgCosmicTagger.cxx:132</a></div></div>
<div class="ttc" id="DetectorClocksService_8h_html"><div class="ttname"><a href="../../d3/dba/DetectorClocksService_8h.html">DetectorClocksService.h</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_aced5ac5900106a217d70d614828dbe64"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#aced5ac5900106a217d70d614828dbe64">pma::PMAlgCosmicTagger::fTagTopFrontBack</a></div><div class="ttdeci">bool fTagTopFrontBack</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00138">PMAlgCosmicTagger.h:138</a></div></div>
<div class="ttc" id="namespacedetinfo_html_a3d7c800dd526147cd2c0e43c6e34daa4"><div class="ttname"><a href="../../d7/d8a/namespacedetinfo.html#a3d7c800dd526147cd2c0e43c6e34daa4">detinfo::trigger_offset</a></div><div class="ttdeci">int trigger_offset(DetectorClocksData const &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5b/DetectorClocksData_8h_source.html#l00632">DetectorClocksData.h:632</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a80fc0e086c62e2d5eeb56fe87adaa96c"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a80fc0e086c62e2d5eeb56fe87adaa96c">pma::PMAlgCosmicTagger::fullHeightCrossing</a></div><div class="ttdeci">size_t fullHeightCrossing(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00303">PMAlgCosmicTagger.cxx:303</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a44d6a5755429abe97cb711f8e380fc29"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a44d6a5755429abe97cb711f8e380fc29">pma::PMAlgCosmicTagger::fullCrossingTagger</a></div><div class="ttdeci">size_t fullCrossingTagger(pma::TrkCandidateColl &amp;tracks, int direction) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00348">PMAlgCosmicTagger.cxx:348</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a928141855dc15ddfdcdfe34b885acf64"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a928141855dc15ddfdcdfe34b885acf64">pma::PMAlgCosmicTagger::fTagFullWidthTracks</a></div><div class="ttdeci">bool fTagFullWidthTracks</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2e/PMAlgCosmicTagger_8h_source.html#l00130">PMAlgCosmicTagger.h:130</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a825831e451d351d04f9bc8600c60da3b"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a825831e451d351d04f9bc8600c60da3b">pma::PMAlgCosmicTagger::isTopVertex</a></div><div class="ttdeci">bool isTopVertex(const TVector3 &amp;pos, double tolerance, short int dirIndx) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00392">PMAlgCosmicTagger.cxx:392</a></div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0ad36cb4e432e8b96478bf51d1b05975a1">pma::Track3D::kCosmic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00046">PmaTrack3D.h:46</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a3f663d96f6fe0ad88a84fa7dd0c9fc77"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a3f663d96f6fe0ad88a84fa7dd0c9fc77">geo::TPCGeo::LocalToWorld</a></div><div class="ttdeci">void LocalToWorld(const double *tpc, double *world) const </div><div class="ttdoc">Transform point from local TPC frame to world frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00563">TPCGeo.h:563</a></div></div>
<div class="ttc" id="namespacechannelDBConverter_html_ab6cfbbcbb53c275375289d47dec67f46"><div class="ttname"><a href="../../d4/d43/namespacechannelDBConverter.html#ab6cfbbcbb53c275375289d47dec67f46">channelDBConverter.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/channelDBConverter_8py_source.html#l00249">channelDBConverter.py:249</a></div></div>
<div class="ttc" id="classpma_1_1PMAlgCosmicTagger_html_a9d6729648bf059dcc34f2f2ba377c85d"><div class="ttname"><a href="../../dc/d90/classpma_1_1PMAlgCosmicTagger.html#a9d6729648bf059dcc34f2f2ba377c85d">pma::PMAlgCosmicTagger::fullLengthCrossing</a></div><div class="ttdeci">size_t fullLengthCrossing(pma::TrkCandidateColl &amp;tracks) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd2/PMAlgCosmicTagger_8cxx_source.html#l00333">PMAlgCosmicTagger.cxx:333</a></div></div>
<div class="ttc" id="Geometry_8h_html"><div class="ttname"><a href="../../d3/d8b/Geometry_8h.html">Geometry.h</a></div><div class="ttdoc">art framework interface to geometry description </div></div>
<div class="ttc" id="classpma_1_1Track3D_html_a3207c459cd71095bf048b0a8f1af53f0a61beccb300f398021d82b3dcdc9c01af"><div class="ttname"><a href="../../d6/d8e/classpma_1_1Track3D.html#a3207c459cd71095bf048b0a8f1af53f0a61beccb300f398021d82b3dcdc9c01af">pma::Track3D::kOutsideDrift_Partial</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/PmaTrack3D_8h_source.html#l00059">PmaTrack3D.h:59</a></div></div>
<div class="ttc" id="classgeo_1_1TPCGeo_html_a7ced3f8c920172d2b77f3d010cec6c1f"><div class="ttname"><a href="../../d9/dff/classgeo_1_1TPCGeo.html#a7ced3f8c920172d2b77f3d010cec6c1f">geo::TPCGeo::HalfWidth</a></div><div class="ttdeci">double HalfWidth() const </div><div class="ttdoc">Width is associated with x coordinate [cm]. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/TPCGeo_8h_source.html#l00107">TPCGeo.h:107</a></div></div>
<div class="ttc" id="classpma_1_1TrkCandidateColl_html_a4b0fff6bdba7eedec0cf5b06fad2588d"><div class="ttname"><a href="../../d8/d1b/classpma_1_1TrkCandidateColl.html#a4b0fff6bdba7eedec0cf5b06fad2588d">pma::TrkCandidateColl::tracks</a></div><div class="ttdeci">std::vector&lt; TrkCandidate &gt; const &amp; tracks() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddb/PmaTrkCandidate_8h_source.html#l00215">PmaTrkCandidate.h:215</a></div></div>
<div class="ttc" id="namespacegeo_html_a6155d04d62c8bb11135137324ab26b5c"><div class="ttname"><a href="../../d6/d23/namespacegeo.html#a6155d04d62c8bb11135137324ab26b5c">geo::origin</a></div><div class="ttdeci">constexpr Point origin()</div><div class="ttdoc">Returns a origin position with a point of the specified type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7d/geo__vectors_8h_source.html#l00227">geo_vectors.h:227</a></div></div>
<div class="ttc" id="TPCGeo_8h_html"><div class="ttname"><a href="../../df/de9/TPCGeo_8h.html">TPCGeo.h</a></div><div class="ttdoc">Encapsulate the construction of a single detector plane. </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
